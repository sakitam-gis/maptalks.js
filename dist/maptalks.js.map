{"version":3,"file":"maptalks.js","sources":["../src/core/Constants.js","../src/core/util/common.js","../src/core/util/env.js","../src/core/util/util.js","../node_modules/@maptalks/feature-filter/index.js","../node_modules/@maptalks/function-type/index.js","../src/core/util/resource.js","../src/core/util/style.js","../src/core/Browser.js","../src/geo/Position.js","../src/geo/Point.js","../src/geo/Size.js","../src/core/util/strings.js","../src/core/util/dom.js","../src/core/util/LRUCache.js","../src/core/Ajax.js","../src/core/Canvas.js","../node_modules/zousan/zousan-min.js","../src/core/Promise.js","../src/core/Eventable.js","../src/handler/Handler.js","../src/core/Class.js","../src/core/JSONAble.js","../node_modules/quickselect/quickselect.js","../node_modules/rbush/index.js","../src/core/CollisionIndex.js","../src/handler/Handlerable.js","../src/handler/Drag.js","../src/geo/Coordinate.js","../src/geo/CRS.js","../src/geo/Extent.js","../src/geo/PointExtent.js","../src/geo/transformation/Transformation.js","../src/geo/projection/Projection.js","../src/geo/measurer/Common.js","../src/geo/measurer/Identity.js","../src/geo/measurer/Sphere.js","../src/geo/measurer/index.js","../src/geo/projection/Projection.EPSG3857.js","../src/geo/projection/Projection.EPSG4326.js","../src/geo/projection/Projection.EPSG4490.js","../src/geo/projection/Projection.Baidu.js","../src/geo/projection/Projection.IDENTITY.js","../src/geo/projection/index.js","../src/renderer/Renderable.js","../src/renderer/layer/CanvasRenderer.js","../src/layer/Layer.js","../src/map/spatial-reference/SpatialReference.js","../src/map/Map.js","../src/map/handler/Map.DoubleClickZoom.js","../src/map/handler/Map.Drag.js","../src/core/util/path.js","../src/renderer/geometry/symbolizers/Symbolizer.js","../src/renderer/geometry/symbolizers/CanvasSymbolizer.js","../src/renderer/geometry/symbolizers/PointSymbolizer.js","../src/renderer/geometry/symbolizers/VectorMarkerSymbolizer.js","../src/renderer/geometry/symbolizers/DebugSymbolizer.js","../src/renderer/geometry/symbolizers/ImageMarkerSymbolizer.js","../src/renderer/geometry/symbolizers/StrokeAndFillSymbolizer.js","../src/renderer/geometry/symbolizers/TextMarkerSymbolizer.js","../src/renderer/geometry/symbolizers/VectorPathMarkerSymbolizer.js","../src/renderer/geometry/symbolizers/DrawAltitudeSymbolizer.js","../src/renderer/geometry/Painter.js","../src/renderer/geometry/CollectionPainter.js","../src/geometry/Geometry.js","../src/map/handler/Map.GeometryEvents.js","../src/map/handler/Map.ScrollWheelZoom.js","../src/map/handler/Map.Touch.js","../src/core/Animation.js","../node_modules/simplify-js/simplify.js","../src/geometry/Path.js","../src/geometry/Polygon.js","../src/geometry/CenterMixin.js","../src/geometry/Marker.js","../src/geometry/LineString.js","../src/geometry/GeometryCollection.js","../src/geometry/MultiGeometry.js","../src/geometry/MultiPoint.js","../src/geometry/MultiPath.js","../src/geometry/MultiLineString.js","../src/geometry/MultiPolygon.js","../src/geometry/GeoJSON.js","../src/geometry/Circle.js","../src/geometry/Ellipse.js","../src/geometry/Rectangle.js","../src/geometry/Sector.js","../src/geometry/Curve.js","../src/geometry/ArcCurve.js","../src/geometry/CubicBezierCurve.js","../src/geometry/QuadBezierCurve.js","../src/geometry/TextMarker.js","../src/geometry/TextBox.js","../src/geometry/Label.js","../src/geometry/ConnectorLine.js","../src/layer/OverlayLayer.js","../src/layer/VectorLayer.js","../src/map/tool/MapTool.js","../src/map/tool/DrawTool.js","../src/map/handler/Map.BoxZoom.js","../src/map/handler/Map.AutoPanAtEdge.js","../src/map/Map.Anim.js","../src/map/Map.DomEvents.js","../src/map/Map.FullScreen.js","../src/map/Map.Pan.js","../src/map/Map.Profile.js","../src/map/Map.Topo.js","../src/map/Map.Zoom.js","../src/core/util/mat4.js","../src/core/util/vec3.js","../src/core/util/math.js","../src/map/Map.Camera.js","../src/map/Map.ViewHistory.js","../src/map/Map.Collision.js","../src/map/tool/DistanceTool.js","../src/map/tool/AreaTool.js","../src/map/tool/DrawToolRegister.js","../src/map/spatial-reference/SpatialReference.Arc.js","../src/ui/UIComponent.js","../src/ui/UIMarker.js","../src/ui/InfoWindow.js","../src/ui/ToolTip.js","../src/ui/Menu.js","../src/ui/Menuable.js","../src/control/Control.js","../src/control/Control.Attribution.js","../src/control/Control.LayerSwitcher.js","../src/control/Control.Overview.js","../src/control/Control.Panel.js","../src/control/Control.Scale.js","../src/control/Control.Toolbar.js","../src/control/Control.Zoom.js","../src/layer/tile/tileinfo/TileSystem.js","../src/layer/tile/tileinfo/TileConfig.js","../src/layer/tile/TileLayer.js","../src/layer/tile/GroupTileLayer.js","../src/layer/tile/WMSTileLayer.js","../src/layer/tile/CanvasTileLayer.js","../src/core/util/gl.js","../src/renderer/layer/ImageGLRenderable.js","../src/layer/ImageLayer.js","../src/renderer/layer/canvaslayer/CanvasLayerRenderer.js","../src/layer/CanvasLayer.js","../src/layer/ParticleLayer.js","../src/geometry/editor/GeometryEditor.js","../src/geometry/editor/TextEditable.js","../src/geometry/ext/Geometry.Animation.js","../src/geometry/ext/Geometry.Drag.js","../src/geometry/ext/Geometry.Edit.js","../src/geometry/ext/Geometry.Events.js","../src/geometry/ext/Geometry.InfoWindow.js","../src/renderer/layer/tilelayer/TileLayerCanvasRenderer.js","../src/renderer/layer/tilelayer/TileLayerGLRenderer.js","../src/renderer/layer/tilelayer/CanvasTileLayerRenderer.js","../src/renderer/layer/tilelayer/QuadStencil.js","../src/renderer/layer/vectorlayer/OverlayLayerCanvasRenderer.js","../src/renderer/layer/vectorlayer/VectorLayerCanvasRenderer.js","../src/renderer/map/MapRenderer.js","../src/renderer/map/MapCanvasRenderer.js","../src/renderer/geometry/PointRenderer.js","../src/renderer/geometry/VectorRenderer.js","../src/core/worker/Worker.js","../src/core/worker/WorkerPool.js","../src/core/worker/Actor.js","../src/index.js"],"sourcesContent":["/**\n * INTERNAL_LAYER_PREFIX The id prefix of internal layers\n * @global\n */\nexport const INTERNAL_LAYER_PREFIX = '_maptalks__internal_layer_';\n\nexport const GEOMETRY_COLLECTION_TYPES = [\n    'MultiPoint',\n    'MultiLineString',\n    'MultiPolygon',\n    'GeometryCollection'\n];\n\nexport const GEOJSON_TYPES = ['FeatureCollection', 'Feature', 'Point', 'LineString', 'Polygon'].concat(GEOMETRY_COLLECTION_TYPES);\n\n/**\n * Symbol properties containing external resources\n */\nexport const RESOURCE_PROPERTIES = [\n    'markerFile', 'polygonPatternFile', 'linePatternFile', 'markerFillPatternFile', 'markerLinePatternFile'\n];\n\n/**\n * Corresponding size properties for the above resource properties\n */\nexport const RESOURCE_SIZE_PROPERTIES = [\n    ['markerWidth', 'markerHeight'],\n    [],\n    [null, 'lineWidth'],\n    [],\n    [null, 'markerLineWidth']\n];\n\n/**\n * numeric symbol properties\n */\nexport const NUMERICAL_PROPERTIES = {\n    'lineWidth': 1,\n    'lineOpacity': 1,\n    'lineDx': 1,\n    'lineDy': 1,\n    'polygonOpacity': 1,\n    'markerWidth': 1,\n    'markerHeight': 1,\n    'markerDx': 1,\n    'markerDy': 1,\n    'markerOpacity': 1,\n    'markerFillOpacity': 1,\n    'markerLineWidth': 1,\n    'markerLineOpacity': 1,\n    'textSize': 1,\n    'textOpacity': 1,\n    'textHaloRadius': 1,\n    'textWrapWidth': 1,\n    'textLineSpacing': 1,\n    'textDx': 1,\n    'textDy': 1\n};\n\n/**\n *  color symbol properties\n */\nexport const COLOR_PROPERTIES = [\n    'lineColor', 'polygonFill', 'markerFill', 'markerLineColor', 'textFill'\n];\n\nexport const colorNames = {\n    'aliceblue': [240, 248, 255],\n    'antiquewhite': [250, 235, 215],\n    'aqua': [0, 255, 255],\n    'aquamarine': [127, 255, 212],\n    'azure': [240, 255, 255],\n    'beige': [245, 245, 220],\n    'bisque': [255, 228, 196],\n    'black': [0, 0, 0],\n    'blanchedalmond': [255, 235, 205],\n    'blue': [0, 0, 255],\n    'blueviolet': [138, 43, 226],\n    'brown': [165, 42, 42],\n    'burlywood': [222, 184, 135],\n    'cadetblue': [95, 158, 160],\n    'chartreuse': [127, 255, 0],\n    'chocolate': [210, 105, 30],\n    'coral': [255, 127, 80],\n    'cornflowerblue': [100, 149, 237],\n    'cornsilk': [255, 248, 220],\n    'crimson': [220, 20, 60],\n    'cyan': [0, 255, 255],\n    'darkblue': [0, 0, 139],\n    'darkcyan': [0, 139, 139],\n    'darkgoldenrod': [184, 134, 11],\n    'darkgray': [169, 169, 169],\n    'darkgreen': [0, 100, 0],\n    'darkgrey': [169, 169, 169],\n    'darkkhaki': [189, 183, 107],\n    'darkmagenta': [139, 0, 139],\n    'darkolivegreen': [85, 107, 47],\n    'darkorange': [255, 140, 0],\n    'darkorchid': [153, 50, 204],\n    'darkred': [139, 0, 0],\n    'darksalmon': [233, 150, 122],\n    'darkseagreen': [143, 188, 143],\n    'darkslateblue': [72, 61, 139],\n    'darkslategray': [47, 79, 79],\n    'darkslategrey': [47, 79, 79],\n    'darkturquoise': [0, 206, 209],\n    'darkviolet': [148, 0, 211],\n    'deeppink': [255, 20, 147],\n    'deepskyblue': [0, 191, 255],\n    'dimgray': [105, 105, 105],\n    'dimgrey': [105, 105, 105],\n    'dodgerblue': [30, 144, 255],\n    'firebrick': [178, 34, 34],\n    'floralwhite': [255, 250, 240],\n    'forestgreen': [34, 139, 34],\n    'fuchsia': [255, 0, 255],\n    'gainsboro': [220, 220, 220],\n    'ghostwhite': [248, 248, 255],\n    'gold': [255, 215, 0],\n    'goldenrod': [218, 165, 32],\n    'gray': [128, 128, 128],\n    'green': [0, 128, 0],\n    'greenyellow': [173, 255, 47],\n    'grey': [128, 128, 128],\n    'honeydew': [240, 255, 240],\n    'hotpink': [255, 105, 180],\n    'indianred': [205, 92, 92],\n    'indigo': [75, 0, 130],\n    'ivory': [255, 255, 240],\n    'khaki': [240, 230, 140],\n    'lavender': [230, 230, 250],\n    'lavenderblush': [255, 240, 245],\n    'lawngreen': [124, 252, 0],\n    'lemonchiffon': [255, 250, 205],\n    'lightblue': [173, 216, 230],\n    'lightcoral': [240, 128, 128],\n    'lightcyan': [224, 255, 255],\n    'lightgoldenrodyellow': [250, 250, 210],\n    'lightgray': [211, 211, 211],\n    'lightgreen': [144, 238, 144],\n    'lightgrey': [211, 211, 211],\n    'lightpink': [255, 182, 193],\n    'lightsalmon': [255, 160, 122],\n    'lightseagreen': [32, 178, 170],\n    'lightskyblue': [135, 206, 250],\n    'lightslategray': [119, 136, 153],\n    'lightslategrey': [119, 136, 153],\n    'lightsteelblue': [176, 196, 222],\n    'lightyellow': [255, 255, 224],\n    'lime': [0, 255, 0],\n    'limegreen': [50, 205, 50],\n    'linen': [250, 240, 230],\n    'magenta': [255, 0, 255],\n    'maroon': [128, 0, 0],\n    'mediumaquamarine': [102, 205, 170],\n    'mediumblue': [0, 0, 205],\n    'mediumorchid': [186, 85, 211],\n    'mediumpurple': [147, 112, 219],\n    'mediumseagreen': [60, 179, 113],\n    'mediumslateblue': [123, 104, 238],\n    'mediumspringgreen': [0, 250, 154],\n    'mediumturquoise': [72, 209, 204],\n    'mediumvioletred': [199, 21, 133],\n    'midnightblue': [25, 25, 112],\n    'mintcream': [245, 255, 250],\n    'mistyrose': [255, 228, 225],\n    'moccasin': [255, 228, 181],\n    'navajowhite': [255, 222, 173],\n    'navy': [0, 0, 128],\n    'oldlace': [253, 245, 230],\n    'olive': [128, 128, 0],\n    'olivedrab': [107, 142, 35],\n    'orange': [255, 165, 0],\n    'orangered': [255, 69, 0],\n    'orchid': [218, 112, 214],\n    'palegoldenrod': [238, 232, 170],\n    'palegreen': [152, 251, 152],\n    'paleturquoise': [175, 238, 238],\n    'palevioletred': [219, 112, 147],\n    'papayawhip': [255, 239, 213],\n    'peachpuff': [255, 218, 185],\n    'peru': [205, 133, 63],\n    'pink': [255, 192, 203],\n    'plum': [221, 160, 221],\n    'powderblue': [176, 224, 230],\n    'purple': [128, 0, 128],\n    'rebeccapurple': [102, 51, 153],\n    'red': [255, 0, 0],\n    'rosybrown': [188, 143, 143],\n    'royalblue': [65, 105, 225],\n    'saddlebrown': [139, 69, 19],\n    'salmon': [250, 128, 114],\n    'sandybrown': [244, 164, 96],\n    'seagreen': [46, 139, 87],\n    'seashell': [255, 245, 238],\n    'sienna': [160, 82, 45],\n    'silver': [192, 192, 192],\n    'skyblue': [135, 206, 235],\n    'slateblue': [106, 90, 205],\n    'slategray': [112, 128, 144],\n    'slategrey': [112, 128, 144],\n    'snow': [255, 250, 250],\n    'springgreen': [0, 255, 127],\n    'steelblue': [70, 130, 180],\n    'tan': [210, 180, 140],\n    'teal': [0, 128, 128],\n    'thistle': [216, 191, 216],\n    'tomato': [255, 99, 71],\n    'turquoise': [64, 224, 208],\n    'violet': [238, 130, 238],\n    'wheat': [245, 222, 179],\n    'white': [255, 255, 255],\n    'whitesmoke': [245, 245, 245],\n    'yellow': [255, 255, 0],\n    'yellowgreen': [154, 205, 50]\n};\n","export function now() {\n    return Date.now();\n}\n\n/**\n * @classdesc\n * Utilities methods used internally. It is static and should not be initiated.\n * @class\n * @static\n * @category core\n * @name Util\n */\n\n/**\n * Merges the properties of sources into destination object.\n * @param  {Object} dest   - object to extend\n * @param  {...Object} src - sources\n * @return {Object}\n * @memberOf Util\n */\nexport function extend(dest) { // (Object[, Object, ...]) ->\n    for (let i = 1; i < arguments.length; i++) {\n        const src = arguments[i];\n        for (const k in src) {\n            dest[k] = src[k];\n        }\n    }\n    return dest;\n}\n\n/**\n * Whether the object is null or undefined.\n * @param  {Object}  obj - object\n * @return {Boolean}\n * @memberOf Util\n */\nexport function isNil(obj) {\n    return obj == null;\n}\n\n/**\n * Whether val is a number and not a NaN.\n * @param  {Object}  val - val\n * @return {Boolean}\n * @memberOf Util\n */\nexport function isNumber(val) {\n    return (typeof val === 'number') && !isNaN(val);\n}\n\n/**\n * Whether a number is an integer\n * @param  {Number}  n\n * @return {Boolean}\n * @memberOf Util\n */\nexport function isInteger(n) {\n    return (n | 0) === n;\n}\n\n/**\n * Whether the obj is a javascript object.\n * @param  {Object}  obj  - object\n * @return {Boolean}\n * @memberOf Util\n */\nexport function isObject(obj) {\n    return typeof obj === 'object' && !!obj;\n}\n\n/**\n * Check whether the object is a string\n * @param {Object} obj\n * @return {Boolean}\n * @memberOf Util\n */\nexport function isString(obj) {\n    if (isNil(obj)) {\n        return false;\n    }\n    return typeof obj === 'string' || (obj.constructor !== null && obj.constructor === String);\n}\n\n/**\n * Check whether the object is a function\n * @param {Object} obj\n * @return {Boolean}\n * @memberOf Util\n */\nexport function isFunction(obj) {\n    if (isNil(obj)) {\n        return false;\n    }\n    return typeof obj === 'function' || (obj.constructor !== null && obj.constructor === Function);\n}\n\nconst hasOwnProperty = Object.prototype.hasOwnProperty;\n/**\n * Check whether the object owns the property.\n * @param  {Object}  obj - object\n * @param  {String}  key - property\n * @return {Boolean}\n * @memberOf Util\n */\nexport function hasOwn(obj, key) {\n    return hasOwnProperty.call(obj, key);\n}\n\n/**\n * Join an array, standard or a typed one.\n * @param  {Object[]} arr       array to join\n * @param  {String} seperator  seperator\n * @return {String}           result string\n * @private\n * @memberOf Util\n */\nexport function join(arr, seperator) {\n    if (arr.join) {\n        return arr.join(seperator || ',');\n    } else {\n        return Array.prototype.join.call(arr, seperator || ',');\n    }\n}\n\nconst pi = Math.PI / 180;\n\nexport function toRadian(d) {\n    return d * pi;\n}\n\nexport function toDegree(r) {\n    return r / pi;\n}\n","/**\n * from detect-node\n * https://github.com/iliakan/detect-node\n *\n * @property {boolean} IS_NODE - whether running in nodejs but not on electron,node-webkit\n * @global\n * @name IS_NODE\n */\nexport const IS_NODE = Object.prototype.toString.call(typeof process !== 'undefined' ? process : 0) === '[object process]' && !process.versions['electron'] && !process.versions['nw'] && !process.versions['node-webkit'];\n","import { IS_NODE } from './env';\nimport { isString, isNil } from './common';\n\n// RequestAnimationFrame, inspired by Leaflet\nlet requestAnimFrame, cancelAnimFrame;\n/* istanbul ignore next */\n(function () {\n    if (IS_NODE) {\n        requestAnimFrame = function (fn) {\n            return setTimeout(fn, 16);\n        };\n\n        cancelAnimFrame = clearTimeout;\n        return;\n    }\n\n    let requestFn, cancelFn;\n    // slow down fps in IE9 for performance\n    const timeToCall = 1000 / 30;\n    function timeoutDefer(fn) {\n        return setTimeout(fn, timeToCall);\n    }\n\n    function getPrefixed(name) {\n        return window['webkit' + name] || window['moz' + name] || window['ms' + name];\n    }\n    if (typeof (window) != 'undefined') {\n        // inspired by http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n\n        requestFn = window['requestAnimationFrame'] || getPrefixed('RequestAnimationFrame') || timeoutDefer;\n        cancelFn = window['cancelAnimationFrame'] || getPrefixed('CancelAnimationFrame') ||\n            getPrefixed('CancelRequestAnimationFrame') || function (id) { window.clearTimeout(id); };\n    } else {\n        requestFn = timeoutDefer;\n        cancelFn = clearTimeout;\n    }\n    /**\n     * Polyfill of RequestAnimationFrame\n     * @param  {Function} fn callback\n     * @return {Number}      request id\n     * @memberOf Util\n     */\n    requestAnimFrame = function (fn) {\n        return requestFn(fn);\n    };\n\n    /**\n     * Polyfill of cancelAnimationFrame\n     * @param  {Number}      request id\n     * @memberOf Util\n     */\n    cancelAnimFrame = function (id) {\n        if (id) {\n            cancelFn(id);\n        }\n    };\n})();\nexport { requestAnimFrame, cancelAnimFrame };\n\nexport function isSVG(url) {\n    const prefix = 'data:image/svg+xml';\n    if (url.length > 4 && url.slice(-4) === '.svg') {\n        return 1;\n    } else if (url.slice(0, prefix.length) === prefix) {\n        return 2;\n    }\n    return 0;\n}\n\n/**\n * Load a image, can be a remote one or a local file. <br>\n * If in node, a SVG image will be converted to a png file by [svg2img]{@link https://github.com/FuZhenn/node-svg2img}<br>\n * @param  {Image} img  - the image object to load.\n * @param  {Object[]} imgDesc - image's descriptor, it's an array. imgUrl[0] is the url string, imgUrl[1] is the width, imgUrl[2] is the height.\n * @private\n * @memberOf Util\n */\nexport function loadImage(img, imgDesc) {\n    /* istanbul ignore next */\n    if (IS_NODE && loadImage.node) {\n        loadImage.node(img, imgDesc);\n        return;\n    }\n    img.src = imgDesc[0];\n}\n\nlet uid = 0;\n\nexport function UID() {\n    return uid++;\n}\nexport const GUID = UID;\n\n/**\n * Parse a JSON string to a object\n * @param {String} str      - a JSON string\n * @return {Object}\n * @memberOf Util\n */\nexport function parseJSON(str) {\n    if (!str || !isString(str)) {\n        return str;\n    }\n    return JSON.parse(str);\n}\n\nexport function pushIn(dest) {\n    for (let i = 1; i < arguments.length; i++) {\n        const src = arguments[i];\n        if (src) {\n            for (let ii = 0, ll = src.length; ii < ll; ii++) {\n                dest.push(src[ii]);\n            }\n        }\n    }\n    return dest.length;\n}\n\nexport function removeFromArray(obj, array) {\n    const i = array.indexOf(obj);\n    if (i > -1) {\n        array.splice(i, 1);\n    }\n}\n\nexport function forEachCoord(arr, fn, context) {\n    if (!Array.isArray(arr)) {\n        return context ? fn.call(context, arr) : fn(arr);\n    }\n    const result = [];\n    let p, pp;\n    for (let i = 0, len = arr.length; i < len; i++) {\n        p = arr[i];\n        if (isNil(p)) {\n            result.push(null);\n            continue;\n        }\n        if (Array.isArray(p)) {\n            result.push(forEachCoord(p, fn, context));\n        } else {\n            pp = context ? fn.call(context, p) : fn(p);\n            result.push(pp);\n        }\n\n    }\n    return result;\n}\n\nexport function getValueOrDefault(v, d) {\n    return v === undefined ? d : v;\n}\n\n/**\n * Polyfill for Math.sign\n * @param  {Number} x\n * @return {Number}\n * @memberOf Util\n */\n/* istanbul ignore next */\nexport function sign(x) {\n    if (Math.sign) {\n        return Math.sign(x);\n    }\n    x = +x; // convert to a number\n    if (x === 0 || isNaN(x)) {\n        return Number(x);\n    }\n    return x > 0 ? 1 : -1;\n}\n\nexport function log2(x) {\n    if (Math.log2) {\n        return Math.log2(x);\n    }\n    const v = Math.log(x) * Math.LOG2E;\n    const rounded = Math.round(v);\n    if (Math.abs(rounded - v) < 1E-14) {\n        return rounded;\n    } else {\n        return v;\n    }\n}\n\n/*\n * Interpolate between two number.\n *\n * @param {Number} from\n * @param {Number} to\n * @param {Number} t interpolation factor between 0 and 1\n * @returns {Number} interpolated color\n */\nexport function interpolate(a, b, t) {\n    return (a * (1 - t)) + (b * t);\n}\n\n/*\n * constrain n to the given range, via modular arithmetic\n * @param {Number} n value\n * @param {Number} min the minimum value to be returned, inclusive\n * @param {Number} max the maximum value to be returned, inclusive\n * @returns {Number} constrained number\n * @private\n */\nexport function wrap(n, min, max) {\n    if (n === max || n === min) {\n        return n;\n    }\n    const d = max - min;\n    const w = ((n - min) % d + d) % d + min;\n    return w;\n}\n\n/**\n * constrain n to the given range via min + max\n *\n * @param {Number} n value\n * @param {Number} min the minimum value to be returned\n * @param {Number} max the maximum value to be returned\n * @returns {Number} the clamped value\n * @private\n */\nexport function clamp(n, min, max) {\n    return Math.min(max, Math.max(min, n));\n}\n\n/*\n * Is object an array and not empty.\n * @param {Object} obj\n * @return {Boolean} true|false\n * @private\n * @memberOf Util\n */\nexport function isArrayHasData(obj) {\n    return Array.isArray(obj) && obj.length > 0;\n}\n\n/**\n * Whether the input string is a valid url.\n * @param  {String}  url - url to check\n * @return {Boolean}\n * @memberOf Util\n * @private\n */\nexport function isURL(url) {\n    if (!url) {\n        return false;\n    }\n    const head = url.slice(0, 6);\n    if (head === 'http:/' || head === 'https:' || head === 'file:/') {\n        return true;\n    }\n    return false;\n}\n\n//改原先的regex名字为xWithQuote；不带引号的regex，/^url\\(([^\\'\\\"].*[^\\'\\\"])\\)$/i，为xWithoutQuote。然后在is函数里||测试，extract函数里if...else处理。没引号的匹配后，取matches[1]\n\n// match: url('x'), url(\"x\").\n// TODO: url(x)\nconst cssUrlReWithQuote = /^url\\((['\"])(.+)\\1\\)$/i;\n\nconst cssUrlRe = /^url\\(([^'\"].*[^'\"])\\)$/i;\n\nexport function isCssUrl(str) {\n    if (!isString(str)) {\n        return 0;\n    }\n    const head = str.slice(0, 6);\n    if (head === 'http:/' || head === 'https:') {\n        return 3;\n    }\n    if (cssUrlRe.test(str)) {\n        return 1;\n    }\n    if (cssUrlReWithQuote.test(str)) {\n        return 2;\n    }\n    return 0;\n}\n\nexport function extractCssUrl(str) {\n    const test = isCssUrl(str);\n    let matches;\n    if (test === 3) {\n        return str;\n    }\n    if (test === 1) {\n        matches = cssUrlRe.exec(str);\n        return matches[1];\n    } else if (test === 2) {\n        matches = cssUrlReWithQuote.exec(str);\n        return matches[2];\n    } else {\n        // return as is if not an css url\n        return str;\n    }\n}\n\nconst b64chrs = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n\n/**\n * btoa or a polyfill in old browsers. <br>\n * Creates a base-64 encoded ASCII string from a String object in which each character in the string is treated as a byte of binary data.<br>\n * From https://github.com/davidchambers/Base64.js\n * @param  {Buffer} input - input string to convert\n * @return {String} ascii\n * @memberOf Util\n * @example\n *     const encodedData = Util.btoa(stringToEncode);\n */\n/* istanbul ignore next */\nexport function btoa(input) {\n    if ((typeof window !== 'undefined') && window.btoa) {\n        return window.btoa(input);\n    }\n    const str = String(input);\n    let output = '';\n    for (\n        // initialize result and counter\n        let block, charCode, idx = 0, map = b64chrs;\n        // if the next str index does not exist:\n        //   change the mapping table to \"=\"\n        //   check if d has no fractional digits\n        str.charAt(idx | 0) || (map = '=', idx % 1);\n        // \"8 - idx % 1 * 8\" generates the sequence 2, 4, 6, 8\n        output += map.charAt(63 & block >> 8 - idx % 1 * 8)\n    ) {\n        charCode = str.charCodeAt(idx += 3 / 4);\n        if (charCode > 0xFF) {\n            throw new Error('\\'btoa\\' failed: The string to be encoded contains characters outside of the Latin1 range.');\n        }\n        block = block << 8 | charCode;\n    }\n    return output;\n}\n\nexport function b64toBlob(b64Data, contentType) {\n    const byteCharacters = atob(b64Data);\n    const arraybuffer = new ArrayBuffer(byteCharacters.length);\n    const view = new Uint8Array(arraybuffer);\n    for (let i = 0; i < byteCharacters.length; i++) {\n        view[i] = byteCharacters.charCodeAt(i) & 0xff;\n    }\n    const blob = new Blob([arraybuffer], { type: contentType });\n    return blob;\n}\n\n/**\n * Compute degree bewteen 2 points.\n * @param  {Point} p1 point 1\n * @param  {Point} p2 point 2\n * @return {Number}    degree between 2 points\n * @memberOf Util\n */\nexport function computeDegree(x0, y0, x1, y1) {\n    const dx = x1 - x0;\n    const dy = y1 - y0;\n    return Math.atan2(dy, dx);\n}\n\n/**\n * Transparent 1X1 gif image\n * from https://css-tricks.com/snippets/html/base64-encode-of-1x1px-transparent-gif/\n * @type {String}\n * @memberOf Util\n */\nexport const emptyImageUrl = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';\n\n\n/**\n * shallow equal\n * @param  {Object} obj1\n * @param  {Object} obj2\n * @return {Boolean}\n * @private\n * @memberOf Util\n */\nexport function equalMapView(obj1, obj2) {\n    if (!obj1 && !obj2) {\n        return true;\n    } else if (!obj1 || !obj2) {\n        return false;\n    }\n    for (const p in obj1) {\n        if (p === 'center') {\n            if (!obj2[p] || !approx(obj1[p][0], obj2[p][0]) || !approx(obj1[p][1], obj2[p][1])) {\n                return false;\n            }\n        } else if (obj1[p] !== obj2[p]) {\n            return false;\n        }\n    }\n    return true;\n}\n\nfunction approx(val, expected, delta) {\n    if (delta == null) { delta = 1e-6; }\n    return val >= expected - delta && val <= expected + delta;\n}\n\n/**\n * Flash something, show and hide by certain internal for times of count.\n *\n * @param {Number} [interval=100]     - interval of flash, in millisecond (ms)\n * @param {Number} [count=4]          - flash times\n * @param {Function} [cb=null]        - callback function when flash ended\n * @param {*} [context=null]          - callback context\n * @return {*} this\n * @private\n * @memberOf Util\n */\nexport function flash(interval, count, cb, context) {\n    if (!interval) {\n        interval = 100;\n    }\n    if (!count) {\n        count = 4;\n    }\n    const me = this;\n    count *= 2;\n    if (this._flashTimeout) {\n        clearTimeout(this._flashTimeout);\n    }\n\n    function flashGeo() {\n        if (count === 0) {\n            me.show();\n            if (cb) {\n                if (context) {\n                    cb.call(context);\n                } else {\n                    cb();\n                }\n            }\n            return;\n        }\n\n        if (count % 2 === 0) {\n            me.hide();\n        } else {\n            me.show();\n        }\n        count--;\n        me._flashTimeout = setTimeout(flashGeo, interval);\n    }\n    this._flashTimeout = setTimeout(flashGeo, interval);\n    return this;\n}\n\nexport function _defaults(obj, defaults) {\n    const keys = Object.getOwnPropertyNames(defaults);\n    for (let i = 0; i < keys.length; i++) {\n        const key = keys[i];\n        const value = Object.getOwnPropertyDescriptor(defaults, key);\n        if (value && value.configurable && obj[key] === undefined) {\n            Object.defineProperty(obj, key, value);\n        }\n    }\n    return obj;\n}\n","/*!\r\n    Feature Filter by\r\n\r\n    (c) mapbox 2016 and maptalks 2018\r\n    www.mapbox.com | www.maptalks.org\r\n    License: MIT, header required.\r\n*/\r\nconst types = ['Unknown', 'Point', 'LineString', 'Polygon', 'MultiPoint', 'MultiLineString', 'MultiPolygon', 'GeometryCollection'];\r\n\r\n/**\r\n * Given a filter expressed as nested arrays, return a new function\r\n * that evaluates whether a given feature (with a .properties or .tags property)\r\n * passes its test.\r\n *\r\n * @param {Array} filter mapbox gl filter\r\n * @returns {Function} filter-evaluating function\r\n */\r\nexport function createFilter(filter) {\r\n    return new Function('f', `var p = (f && f.properties || {}); return ${compile(filter)}`);\r\n}\r\n\r\nfunction compile(filter) {\r\n    if (!filter) return 'true';\r\n    const op = filter[0];\r\n    if (filter.length <= 1) return op === 'any' ? 'false' : 'true';\r\n    const str =\r\n        op === '==' ? compileComparisonOp(filter[1], filter[2], '===', false) :\r\n            op === '!=' ? compileComparisonOp(filter[1], filter[2], '!==', false) :\r\n                op === '<' ||\r\n                    op === '>' ||\r\n        op === '<=' ||\r\n        op === '>=' ? compileComparisonOp(filter[1], filter[2], op, true) :\r\n                    op === 'any' ? compileLogicalOp(filter.slice(1), '||') :\r\n                        op === 'all' ? compileLogicalOp(filter.slice(1), '&&') :\r\n                            op === 'none' ? compileNegation(compileLogicalOp(filter.slice(1), '||')) :\r\n                                op === 'in' ? compileInOp(filter[1], filter.slice(2)) :\r\n                                    op === '!in' ? compileNegation(compileInOp(filter[1], filter.slice(2))) :\r\n                                        op === 'has' ? compileHasOp(filter[1]) :\r\n                                            op === '!has' ? compileNegation(compileHasOp(filter[1])) :\r\n                                                'true';\r\n    return `(${str})`;\r\n}\r\n\r\nfunction compilePropertyReference(property) {\r\n    // const ref =\r\n    //     property === '$type' ? 'f.type' :\r\n    //         property === '$id' ? 'f.id' : `p[${JSON.stringify(property)}]`;\r\n    // return ref;\r\n    return property[0] === '$' ? 'f.' + property.substring(1) : 'p[' + JSON.stringify(property) + ']';\r\n}\r\n\r\nfunction compileComparisonOp(property, value, op, checkType) {\r\n    const left = compilePropertyReference(property);\r\n    const right = property === '$type' ? types.indexOf(value) : JSON.stringify(value);\r\n    return (checkType ? `typeof ${left}=== typeof ${right}&&` : '') + left + op + right;\r\n}\r\n\r\nfunction compileLogicalOp(expressions, op) {\r\n    return expressions.map(compile).join(op);\r\n}\r\n\r\nfunction compileInOp(property, values) {\r\n    if (property === '$type') values = values.map((value) => {\r\n        return types.indexOf(value);\r\n    });\r\n    const left = JSON.stringify(values.sort(compare));\r\n    const right = compilePropertyReference(property);\r\n\r\n    if (values.length <= 200) return `${left}.indexOf(${right}) !== -1`;\r\n\r\n    return `function(v, a, i, j) {\r\n        while (i <= j) { var m = (i + j) >> 1;\r\n            if (a[m] === v) return true; if (a[m] > v) j = m - 1; else i = m + 1;\r\n        }\r\n    return false; }(${right}, ${left},0,${values.length - 1})`;\r\n}\r\n\r\nfunction compileHasOp(property) {\r\n    return property === '$id' ? '\"id\" in f' : `${JSON.stringify(property)} in p`;\r\n}\r\n\r\nfunction compileNegation(expression) {\r\n    return `!(${expression})`;\r\n}\r\n\r\n// Comparison function to sort numbers and strings\r\nfunction compare(a, b) {\r\n    return a < b ? -1 : a > b ? 1 : 0;\r\n}\r\n\r\n/**\r\n * Get feature object from a geometry for filter functions.\r\n * @param  {Geometry} geometry geometry\r\n * @return {Object}          feature for filter functions\r\n */\r\nexport function getFilterFeature(geometry) {\r\n    const json = geometry._toJSON(),\r\n        g = json['feature'];\r\n    g['type'] = types.indexOf(g['geometry']['type']);\r\n    g['subType'] = json['subType'];\r\n    return g;\r\n}\r\n\r\n/**\r\n * Compile layer's style, styles to symbolize layer's geometries, e.g.<br>\r\n * <pre>\r\n * [\r\n *   {\r\n *     'filter' : ['==', 'foo', 'val'],\r\n *     'symbol' : {'markerFile':'foo.png'}\r\n *   }\r\n * ]\r\n * </pre>\r\n * @param  {Object|Object[]} styles - style to compile\r\n * @return {Object[]}       compiled styles\r\n */\r\nexport function compileStyle(styles) {\r\n    if (!Array.isArray(styles)) {\r\n        return compileStyle([styles]);\r\n    }\r\n    const compiled = [];\r\n    for (let i = 0; i < styles.length; i++) {\r\n        let filter;\r\n        if (styles[i]['filter'] === true) {\r\n            filter = function () { return true; };\r\n        } else {\r\n            filter = createFilter(styles[i]['filter']);\r\n        }\r\n        compiled.push(extend({}, styles[i], {\r\n            filter : filter\r\n        }));\r\n    }\r\n    return compiled;\r\n}\r\n\r\nfunction extend(dest) { // (Object[, Object, ...]) ->\r\n    for (let i = 1; i < arguments.length; i++) {\r\n        const src = arguments[i];\r\n        for (const k in src) {\r\n            dest[k] = src[k];\r\n        }\r\n    }\r\n    return dest;\r\n}\r\n","/*eslint-disable no-var, prefer-const*/\r\nfunction createFunction(parameters, defaultType) {\r\n    var fun;\r\n\r\n    if (!isFunctionDefinition(parameters)) {\r\n        fun = function () { return parameters; };\r\n        // fun.isFeatureConstant = true;\r\n        // fun.isZoomConstant = true;\r\n\r\n    } else {\r\n        var zoomAndFeatureDependent = parameters.stops && typeof parameters.stops[0][0] === 'object';\r\n        var featureDependent = zoomAndFeatureDependent || parameters.property !== undefined;\r\n        var zoomDependent = zoomAndFeatureDependent || !featureDependent;\r\n        var type = parameters.type || defaultType || 'exponential';\r\n\r\n        var innerFun;\r\n        if (type === 'exponential') {\r\n            innerFun = evaluateExponentialFunction;\r\n        } else if (type === 'interval') {\r\n            innerFun = evaluateIntervalFunction;\r\n        } else if (type === 'categorical') {\r\n            innerFun = evaluateCategoricalFunction;\r\n        } else if (type === 'identity') {\r\n            innerFun = evaluateIdentityFunction;\r\n        } else {\r\n            throw new Error('Unknown function type \"' + type + '\"');\r\n        }\r\n\r\n        if (zoomAndFeatureDependent) {\r\n            var featureFunctions = {};\r\n            var featureFunctionStops = [];\r\n            for (let s = 0; s < parameters.stops.length; s++) {\r\n                var stop = parameters.stops[s];\r\n                if (featureFunctions[stop[0].zoom] === undefined) {\r\n                    featureFunctions[stop[0].zoom] = {\r\n                        zoom: stop[0].zoom,\r\n                        type: parameters.type,\r\n                        property: parameters.property,\r\n                        default: parameters.default,\r\n                        stops: []\r\n                    };\r\n                }\r\n                featureFunctions[stop[0].zoom].stops.push([stop[0].value, stop[1]]);\r\n            }\r\n\r\n            for (let z in featureFunctions) {\r\n                featureFunctionStops.push([featureFunctions[z].zoom, createFunction(featureFunctions[z])]);\r\n            }\r\n            fun = function (zoom, feature) {\r\n                return evaluateExponentialFunction({ stops: featureFunctionStops, base: parameters.base }, zoom)(zoom, feature);\r\n            };\r\n            // fun.isFeatureConstant = false;\r\n            // fun.isZoomConstant = false;\r\n\r\n        } else if (zoomDependent) {\r\n            fun = function (zoom) {\r\n                return innerFun(parameters, zoom);\r\n            };\r\n            // fun.isFeatureConstant = true;\r\n            // fun.isZoomConstant = false;\r\n        } else {\r\n            fun = function (zoom, feature) {\r\n                return innerFun(parameters, feature ? feature[parameters.property] : null);\r\n            };\r\n            // fun.isFeatureConstant = false;\r\n            // fun.isZoomConstant = true;\r\n        }\r\n    }\r\n\r\n    return fun;\r\n}\r\n\r\nfunction coalesce(a, b, c) {\r\n    if (a !== undefined) return a;\r\n    if (b !== undefined) return b;\r\n    if (c !== undefined) return c;\r\n    return null;\r\n}\r\n\r\nfunction evaluateCategoricalFunction(parameters, input) {\r\n    for (let i = 0; i < parameters.stops.length; i++) {\r\n        if (input === parameters.stops[i][0]) {\r\n            return parameters.stops[i][1];\r\n        }\r\n    }\r\n    return parameters.default;\r\n}\r\n\r\nfunction evaluateIntervalFunction(parameters, input) {\r\n    for (var i = 0; i < parameters.stops.length; i++) {\r\n        if (input < parameters.stops[i][0]) break;\r\n    }\r\n    return parameters.stops[Math.max(i - 1, 0)][1];\r\n}\r\n\r\nfunction evaluateExponentialFunction(parameters, input) {\r\n    var base = parameters.base !== undefined ? parameters.base : 1;\r\n\r\n    var i = 0;\r\n    while (true) {\r\n        if (i >= parameters.stops.length) break;\r\n        else if (input <= parameters.stops[i][0]) break;\r\n        else i++;\r\n    }\r\n\r\n    if (i === 0) {\r\n        return parameters.stops[i][1];\r\n\r\n    } else if (i === parameters.stops.length) {\r\n        return parameters.stops[i - 1][1];\r\n\r\n    } else {\r\n        return interpolate(\r\n            input,\r\n            base,\r\n            parameters.stops[i - 1][0],\r\n            parameters.stops[i][0],\r\n            parameters.stops[i - 1][1],\r\n            parameters.stops[i][1]\r\n        );\r\n    }\r\n}\r\n\r\nfunction evaluateIdentityFunction(parameters, input) {\r\n    return coalesce(input, parameters.default);\r\n}\r\n\r\nfunction interpolate(input, base, inputLower, inputUpper, outputLower, outputUpper) {\r\n    if (typeof outputLower === 'function') {\r\n        return function () {\r\n            var evaluatedLower = outputLower.apply(undefined, arguments);\r\n            var evaluatedUpper = outputUpper.apply(undefined, arguments);\r\n            return interpolate(input, base, inputLower, inputUpper, evaluatedLower, evaluatedUpper);\r\n        };\r\n    } else if (outputLower.length) {\r\n        return interpolateArray(input, base, inputLower, inputUpper, outputLower, outputUpper);\r\n    } else {\r\n        return interpolateNumber(input, base, inputLower, inputUpper, outputLower, outputUpper);\r\n    }\r\n}\r\n\r\nfunction interpolateNumber(input, base, inputLower, inputUpper, outputLower, outputUpper) {\r\n    var difference =  inputUpper - inputLower;\r\n    var progress = input - inputLower;\r\n\r\n    var ratio;\r\n    if (base === 1) {\r\n        ratio = progress / difference;\r\n    } else {\r\n        ratio = (Math.pow(base, progress) - 1) / (Math.pow(base, difference) - 1);\r\n    }\r\n\r\n    return (outputLower * (1 - ratio)) + (outputUpper * ratio);\r\n}\r\n\r\nfunction interpolateArray(input, base, inputLower, inputUpper, outputLower, outputUpper) {\r\n    var output = [];\r\n    for (let i = 0; i < outputLower.length; i++) {\r\n        output[i] = interpolateNumber(input, base, inputLower, inputUpper, outputLower[i], outputUpper[i]);\r\n    }\r\n    return output;\r\n}\r\n\r\n/**\r\n * Check if object is a definition of function type\r\n * @param  {Object}  obj object\r\n * @return {Boolean}\r\n * @memberOf MapboxUtil\r\n */\r\nexport function isFunctionDefinition(obj) {\r\n    return obj && typeof obj === 'object' && (obj.stops || obj.property && obj.type === 'identity');\r\n}\r\n\r\n/**\r\n * Check if obj's properties has function definition\r\n * @param  {Object}  obj object to check\r\n * @return {Boolean}\r\n * @memberOf MapboxUtil\r\n */\r\nexport function hasFunctionDefinition(obj) {\r\n    for (const p in obj) {\r\n        if (isFunctionDefinition(obj[p])) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nexport function interpolated(parameters) {\r\n    return createFunction(parameters, 'exponential');\r\n}\r\n\r\n\r\nexport function piecewiseConstant(parameters) {\r\n    return createFunction(parameters, 'interval');\r\n}\r\n\r\n/**\r\n * Load function types defined in object\r\n * @param  {Object[]} parameters parameters\r\n * @return {Object}   loaded object\r\n * @memberOf MapboxUtil\r\n */\r\nexport function loadFunctionTypes(obj, argFn) {\r\n    if (!obj) {\r\n        return null;\r\n    }\r\n    var hit = false;\r\n    if (Array.isArray(obj)) {\r\n        var multResult = [],\r\n            loaded;\r\n        for (let i = 0; i < obj.length; i++) {\r\n            loaded = loadFunctionTypes(obj[i], argFn);\r\n            if (!loaded) {\r\n                multResult.push(obj[i]);\r\n            } else {\r\n                multResult.push(loaded);\r\n                hit = true;\r\n            }\r\n        }\r\n        return hit ? multResult : obj;\r\n    }\r\n    var result = {\r\n            '__fn_types_loaded' : true\r\n        },\r\n        props = [],\r\n        p;\r\n    for (p in obj) {\r\n        if (obj.hasOwnProperty(p)) {\r\n            props.push(p);\r\n        }\r\n    }\r\n\r\n    const buildFn = function (p) {\r\n        Object.defineProperty(result, p, {\r\n            get: function () {\r\n                if (!this['__fn_' + p]) {\r\n                    this['__fn_' + p] = interpolated(this['_' + p]);\r\n                }\r\n                return this['__fn_' + p].apply(this, argFn());\r\n            },\r\n            set: function (v) {\r\n                this['_' + p] = v;\r\n            },\r\n            configurable: true,\r\n            enumerable: true\r\n        });\r\n    };\r\n\r\n    for (let i = 0, len = props.length; i < len; i++) {\r\n        p = props[i];\r\n        if (isFunctionDefinition(obj[p])) {\r\n            hit = true;\r\n            result['_' + p] = obj[p];\r\n            buildFn(p);\r\n        } else {\r\n            result[p] = obj[p];\r\n        }\r\n    }\r\n    return hit ? result : obj;\r\n}\r\n\r\n/**\r\n * Get external resources in the function type\r\n * @param  {Object} t Function type definition\r\n * @return {String[]}   resouces\r\n * @memberOf MapboxUtil\r\n */\r\nexport function getFunctionTypeResources(t) {\r\n    if (!t || !t.stops) {\r\n        return [];\r\n    }\r\n    const res = [];\r\n    for (let i = 0, l = t.stops.length; i < l; i++) {\r\n        res.push(t.stops[i][1]);\r\n    }\r\n    return res;\r\n}\r\n/*eslint-enable no-var, prefer-const*/\r\n","import { RESOURCE_PROPERTIES, RESOURCE_SIZE_PROPERTIES } from '../Constants';\nimport { IS_NODE } from './env';\nimport { extend, isNil, isNumber, isString } from './common';\nimport { isURL, extractCssUrl, btoa } from './util';\nimport { isFunctionDefinition, getFunctionTypeResources } from '../mapbox';\n\n\n/**\n * Translate symbol properties to SVG properties\n * @param  {Object} s - object with symbol properties\n * @return {Object}   object with SVG properties\n * @memberOf Util\n */\nexport function translateToSVGStyles(s) {\n    const result = {\n        'stroke': {\n            'stroke': s['markerLineColor'],\n            'stroke-width': s['markerLineWidth'],\n            'stroke-opacity': s['markerLineOpacity'],\n            'stroke-dasharray': null,\n            'stroke-linecap': 'butt',\n            'stroke-linejoin': 'round'\n        },\n        'fill': {\n            'fill': s['markerFill'],\n            'fill-opacity': s['markerFillOpacity']\n        }\n    };\n    if (result['stroke']['stroke-width'] === 0) {\n        result['stroke']['stroke-opacity'] = 0;\n    }\n    return result;\n}\n\n/**\n * Get SVG Base64 String from a marker symbol with (markerType : path)\n * @param  {Object} symbol - symbol with markerType of path\n * @return {String}        SVG Base64 String\n * @memberOf Util\n */\nexport function getMarkerPathBase64(symbol, width, height) {\n    if (!symbol['markerPath']) {\n        return null;\n    }\n    let op = 1;\n    const styles = translateToSVGStyles(symbol);\n    //context.globalAlpha doesn't take effect with drawing SVG in IE9/10/11 and EGDE, so set opacity in SVG element.\n    if (isNumber(symbol['markerOpacity'])) {\n        op = symbol['markerOpacity'];\n    }\n    if (isNumber(symbol['opacity'])) {\n        op *= symbol['opacity'];\n    }\n    const svgStyles = {};\n    if (styles) {\n        for (const p in styles['stroke']) {\n            if (styles['stroke'].hasOwnProperty(p)) {\n                if (!isNil(styles['stroke'][p])) {\n                    svgStyles[p] = styles['stroke'][p];\n                }\n            }\n        }\n        for (const p in styles['fill']) {\n            if (styles['fill'].hasOwnProperty(p)) {\n                if (!isNil(styles['fill'][p])) {\n                    svgStyles[p] = styles['fill'][p];\n                }\n            }\n        }\n    }\n\n    const pathes = Array.isArray(symbol['markerPath']) ? symbol['markerPath'] : [symbol['markerPath']];\n    let path;\n    const pathesToRender = [];\n    for (let i = 0; i < pathes.length; i++) {\n        path = isString(pathes[i]) ? {\n            'path': pathes[i]\n        } : pathes[i];\n        path = extend({}, path, svgStyles);\n        path['d'] = path['path'];\n        delete path['path'];\n        pathesToRender.push(path);\n    }\n    const svg = ['<svg version=\"1.1\"', 'xmlns=\"http://www.w3.org/2000/svg\"'];\n    if (op < 1) {\n        svg.push('opacity=\"' + op + '\"');\n    }\n    // if (symbol['markerWidth'] && symbol['markerHeight']) {\n    //     svg.push('height=\"' + symbol['markerHeight'] + '\" width=\"' + symbol['markerWidth'] + '\"');\n    // }\n    if (symbol['markerPathWidth'] && symbol['markerPathHeight']) {\n        svg.push('viewBox=\"0 0 ' + symbol['markerPathWidth'] + ' ' + symbol['markerPathHeight'] + '\"');\n    }\n    svg.push('preserveAspectRatio=\"none\"');\n    if (width) {\n        svg.push('width=\"' + width + '\"');\n    }\n    if (height) {\n        svg.push('height=\"' + height + '\"');\n    }\n    svg.push('><defs></defs>');\n\n    for (let i = 0; i < pathesToRender.length; i++) {\n        let strPath = '<path ';\n        for (const p in pathesToRender[i]) {\n            if (pathesToRender[i].hasOwnProperty(p)) {\n                strPath += ' ' + p + '=\"' + pathesToRender[i][p] + '\"';\n            }\n        }\n        strPath += '></path>';\n        svg.push(strPath);\n    }\n    svg.push('</svg>');\n    const b64 = 'data:image/svg+xml;base64,' + btoa(svg.join(' '));\n    return b64;\n}\n\n/**\n * Get external resources from the given symbol\n * @param  {Object} symbol      - symbol\n * @param  {Boolean} toAbsolute - whether convert url to aboslute\n * @return {String[]}           - resource urls\n * @memberOf Util\n */\nexport function getExternalResources(symbol, toAbsolute) {\n    if (!symbol) {\n        return [];\n    }\n    let symbols = symbol;\n    if (!Array.isArray(symbol)) {\n        symbols = [symbol];\n    }\n    const resources = [];\n    const props = RESOURCE_PROPERTIES;\n    let res, resSizeProp;\n    let w, h;\n    for (let i = symbols.length - 1; i >= 0; i--) {\n        symbol = symbols[i];\n        if (!symbol) {\n            continue;\n        }\n        if (toAbsolute) {\n            symbol = convertResourceUrl(symbol);\n        }\n        for (let ii = 0; ii < props.length; ii++) {\n            res = symbol[props[ii]];\n            if (isFunctionDefinition(res)) {\n                res = getFunctionTypeResources(res);\n            }\n            if (!res) {\n                continue;\n            }\n            if (!Array.isArray(res)) {\n                res = [res];\n            }\n            for (let iii = 0; iii < res.length; iii++) {\n                if (res[iii].slice(0, 4) === 'url(') {\n                    res[iii] = extractCssUrl(res[iii]);\n                }\n                resSizeProp = RESOURCE_SIZE_PROPERTIES[ii];\n                resources.push([res[iii], symbol[resSizeProp[0]], symbol[resSizeProp[1]]]);\n            }\n        }\n        if (symbol['markerType'] === 'path' && symbol['markerPath']) {\n            w = isFunctionDefinition(symbol['markerWidth']) ? 200 : symbol['markerWidth'];\n            h = isFunctionDefinition(symbol['markerHeight']) ? 200 : symbol['markerHeight'];\n            if (isFunctionDefinition(symbol['markerPath'])) {\n                res = getFunctionTypeResources(symbol['markerPath']);\n                const path = symbol['markerPath'];\n                for (let iii = 0; iii < res.length; iii++) {\n                    symbol['markerPath'] = res[iii];\n                    resources.push([getMarkerPathBase64(symbol), w, h]);\n                }\n                symbol['markerPath'] = path;\n            } else {\n                resources.push([getMarkerPathBase64(symbol), w, h]);\n            }\n        }\n    }\n    return resources;\n}\n\n/**\n * Convert symbol's resources' urls from relative path to an absolute path.\n * @param  {Object} symbol\n * @private\n * @memberOf Util\n */\nexport function convertResourceUrl(symbol) {\n    if (!symbol) {\n        return null;\n    }\n\n    const s = symbol;\n    if (IS_NODE) {\n        return s;\n    }\n    const props = RESOURCE_PROPERTIES;\n    let res;\n    for (let ii = 0, len = props.length; ii < len; ii++) {\n        res = s[props[ii]];\n        if (!res) {\n            continue;\n        }\n        s[props[ii]] = _convertUrlToAbsolute(res);\n    }\n    return s;\n}\n\nfunction _convertUrlToAbsolute(res) {\n    if (isFunctionDefinition(res)) {\n        const stops = res.stops;\n        for (let i = 0; i < stops.length; i++) {\n            stops[i][1] = _convertUrlToAbsolute(stops[i][1]);\n        }\n        return res;\n    }\n    const embed = 'data:';\n    if (res.slice(0, 4) === 'url(') {\n        res = extractCssUrl(res);\n    }\n    if (!isURL(res) &&\n        (res.length <= embed.length || res.substring(0, embed.length) !== embed)) {\n        res = _absolute(location.href, res);\n    }\n    return res;\n}\n\nfunction _absolute(base, relative) {\n    const stack = base.split('/'),\n        parts = relative.split('/');\n    if (relative.slice(0, 1) === 0) {\n        return stack.slice(0, 3).join('/') + relative;\n    } else {\n        stack.pop(); // remove current file name (or empty string)\n        // (omit if \"base\" is the current folder without trailing slash)\n        for (let i = 0; i < parts.length; i++) {\n            if (parts[i] === '.')\n                continue;\n            if (parts[i] === '..')\n                stack.pop();\n            else\n                stack.push(parts[i]);\n        }\n        return stack.join('/');\n    }\n}\n","import { extend, isNil, isFunction, hasOwn } from './common';\n\n/**\n * Whether the color is a gradient\n * @param  {Object}  g - color to test\n * @return {Boolean}\n * @memberOf Util\n */\nexport function isGradient(g) {\n    return g && g['colorStops'];\n}\n\n/**\n * Get stamp of a gradient color object.\n * @param  {Object} g gradient color object\n * @return {String}     gradient stamp\n * @memberOf Util\n */\nexport function getGradientStamp(g) {\n    const keys = [g['type']];\n    if (g['places']) {\n        keys.push(g['places'].join());\n    }\n    if (g['colorStops']) {\n        const stops = [];\n        for (let i = g['colorStops'].length - 1; i >= 0; i--) {\n            stops.push(g['colorStops'][i].join());\n        }\n        keys.push(stops.join(','));\n    }\n    return keys.join('_');\n}\n\n/**\n * Get stamp of a symbol\n * @param  {Object|Object[]} symbol symbol\n * @return {String}        symbol's stamp\n * @memberOf Util\n */\nexport function getSymbolStamp(symbol) {\n    const keys = [];\n    if (Array.isArray(symbol)) {\n        for (let i = 0; i < symbol.length; i++) {\n            keys.push(getSymbolStamp(symbol[i]));\n        }\n        return '[ ' + keys.join(' , ') + ' ]';\n    }\n    for (const p in symbol) {\n        if (hasOwn(symbol, p)) {\n            if (!isFunction(symbol[p])) {\n                if (isGradient(symbol[p])) {\n                    keys.push(p + '=' + getGradientStamp(symbol[p]));\n                } else {\n                    keys.push(p + '=' + symbol[p]);\n                }\n            }\n        }\n    }\n    return keys.join(';');\n}\n\n/**\n * Reduce opacity of the color by ratio\n * @param  {Object|Object[]} symbol symbols to set\n * @param  {Number} ratio  ratio of opacity to reduce\n * @return {Object|Object[]}      new symbol or symbols\n * @memberOf Util\n */\nexport function lowerSymbolOpacity(symbol, ratio) {\n    function s(_symbol, _ratio) {\n        const op = _symbol['opacity'];\n        if (isNil(op)) {\n            _symbol['opacity'] = _ratio;\n        } else {\n            _symbol['opacity'] *= _ratio;\n        }\n    }\n    let lower;\n    if (Array.isArray(symbol)) {\n        lower = [];\n        for (let i = 0; i < symbol.length; i++) {\n            const d = extend({}, symbol[i]);\n            s(d, ratio);\n            lower.push(d);\n        }\n    } else {\n        lower = extend({}, symbol);\n        s(lower, ratio);\n    }\n    return lower;\n}\n\n/**\n * Merges the properties of sources into the symbol. <br>\n * @param  {Object|Object[]} symbol symbol to extend\n * @param  {...Object} src - sources\n * @return {Object|Object[]}        merged symbol\n * @memberOf Util\n */\nexport function extendSymbol(symbol) {\n    let sources = Array.prototype.slice.call(arguments, 1);\n    if (!sources || !sources.length) {\n        sources = [{}];\n    }\n    if (Array.isArray(symbol)) {\n        let s, dest;\n        const result = [];\n        for (let i = 0, l = symbol.length; i < l; i++) {\n            s = symbol[i];\n            dest = {};\n            for (let ii = 0, ll = sources.length; ii < ll; ii++) {\n                if (!Array.isArray(sources[ii])) {\n                    extend(dest, s, sources[ii] ? sources[ii] : {});\n                } else if (!isNil(sources[ii][i])) {\n                    extend(dest, s, sources[ii][i]);\n                } else {\n                    extend(dest, s ? s : {});\n                }\n            }\n            result.push(dest);\n        }\n        return result;\n    } else {\n        const args = [{}, symbol];\n        args.push.apply(args, sources);\n        return extend.apply(this, args);\n    }\n}\n","import { IS_NODE } from './util';\n\nlet Browser = {};\n\nif (!IS_NODE) {\n    const ua = navigator.userAgent.toLowerCase(),\n        doc = document.documentElement,\n\n        ie = 'ActiveXObject' in window,\n\n        webkit = ua.indexOf('webkit') !== -1,\n        phantomjs = ua.indexOf('phantom') !== -1,\n        android23 = ua.search('android [23]') !== -1,\n        chrome = ua.indexOf('chrome') !== -1,\n        gecko = ua.indexOf('gecko') !== -1 && !webkit && !window.opera && !ie,\n\n        mobile = typeof orientation !== 'undefined' || ua.indexOf('mobile') !== -1,\n        msPointer = !window.PointerEvent && window.MSPointerEvent,\n        pointer = (window.PointerEvent && navigator.pointerEnabled) || msPointer,\n\n        ie3d = ie && ('transition' in doc.style),\n        webkit3d = ('WebKitCSSMatrix' in window) && ('m11' in new window.WebKitCSSMatrix()) && !android23,\n        gecko3d = 'MozPerspective' in doc.style,\n        opera12 = 'OTransition' in doc.style,\n        any3d = (ie3d || webkit3d || gecko3d) && !opera12 && !phantomjs;\n\n    let chromeVersion = 0;\n    if (chrome) {\n        chromeVersion = ua.match(/chrome\\/([\\d.]+)/)[1];\n    }\n\n    const touch = !phantomjs && (pointer || 'ontouchstart' in window ||\n        (window.DocumentTouch && document instanceof window.DocumentTouch));\n\n    let webgl;\n    try {\n        const canvas = document.createElement('canvas');\n        const gl = canvas.getContext('webgl') ||\n            canvas.getContext('experimental-webgl');\n        webgl = gl && gl instanceof WebGLRenderingContext;\n    } catch (err) {\n        webgl = false;\n    }\n\n    const devicePixelRatio = (window.devicePixelRatio || (window.screen.deviceXDPI / window.screen.logicalXDPI));\n\n    Browser = {\n        ie: ie,\n        ielt9: ie && !document.addEventListener,\n        edge: 'msLaunchUri' in navigator && !('documentMode' in document),\n        webkit: webkit,\n        gecko: gecko,\n        android: ua.indexOf('android') !== -1,\n        android23: android23,\n        chrome: chrome,\n        chromeVersion : chromeVersion,\n        safari: !chrome && ua.indexOf('safari') !== -1,\n        phantomjs: phantomjs,\n\n        ie3d: ie3d,\n        webkit3d: webkit3d,\n        gecko3d: gecko3d,\n        opera12: opera12,\n        any3d: any3d,\n\n        mobile: mobile,\n        mobileWebkit: mobile && webkit,\n        mobileWebkit3d: mobile && webkit3d,\n        mobileOpera: mobile && window.opera,\n        mobileGecko: mobile && gecko,\n\n        touch: !!touch,\n        msPointer: !!msPointer,\n        pointer: !!pointer,\n\n        retina: devicePixelRatio > 1,\n        devicePixelRatio,\n\n        language: navigator.browserLanguage ? navigator.browserLanguage : navigator.language,\n        ie9: (ie && document.documentMode === 9),\n        ie10: (ie && document.documentMode === 10),\n\n        webgl : webgl\n    };\n}\n\nexport default Browser;\n","import { isNil } from '../core/util';\n\n/**\n * Abstract parent class for Point and Coordinate\n * @abstract\n * @category basic types\n */\nclass Position {\n\n    constructor(x, y) {\n        if (!isNil(x) && !isNil(y)) {\n            /**\n             * @property x {Number} - x value\n             */\n            this.x = +(x);\n            /**\n             * @property y {Number} - y value\n             */\n            this.y = +(y);\n        } else if (!isNil(x.x) && !isNil(x.y)) {\n            this.x = +(x.x);\n            this.y = +(x.y);\n        } else if (Array.isArray(x)) {\n            this.x = +(x[0]);\n            this.y = +(x[1]);\n        }\n        if (this._isNaN()) {\n            throw new Error('Position is NaN');\n        }\n    }\n\n    /**\n     * Set point or coordinate's x, y value\n     * @params {Number} x - x value\n     * @params {Number} y - y value\n     * @return {Coordinate|Point} this\n     */\n    set(x, y) {\n        this.x = x;\n        this.y = y;\n        return this;\n    }\n\n    /**\n     * Return abs value of the point\n     * @return {Coordinate|Point} abs point\n     */\n    abs() {\n        return new this.constructor(Math.abs(this.x), Math.abs(this.y));\n    }\n\n    //destructive abs\n    _abs() {\n        this.x = Math.abs(this.x);\n        this.y = Math.abs(this.y);\n        return this;\n    }\n\n    _round() {\n        this.x = Math.round(this.x);\n        this.y = Math.round(this.y);\n        return this;\n    }\n\n    /**\n     * Like math.round, rounding the point's xy.\n     * @return {Coordinate|Point} rounded point\n     */\n    round() {\n        return new this.constructor(Math.round(this.x), Math.round(this.y));\n    }\n\n    _ceil() {\n        this.x = Math.ceil(this.x);\n        this.y = Math.ceil(this.y);\n        return this;\n    }\n\n    ceil() {\n        return new this.constructor(Math.ceil(this.x), Math.ceil(this.y));\n    }\n\n    _floor() {\n        this.x = Math.floor(this.x);\n        this.y = Math.floor(this.y);\n        return this;\n    }\n\n    floor() {\n        return new this.constructor(Math.floor(this.x), Math.floor(this.y));\n    }\n\n    /**\n     * Returns a copy of the coordinate\n     * @return {Coordinate|Point} copy\n     */\n    copy() {\n        return new this.constructor(this.x, this.y);\n    }\n\n    //destructive add\n    _add(x, y) {\n        if (!isNil(x.x)) {\n            this.x += x.x;\n            this.y += x.y;\n        } else if (!isNil(x[0])) {\n            this.x += x[0];\n            this.y += x[1];\n        } else {\n            this.x += x;\n            this.y += y;\n        }\n        return this;\n    }\n\n    /**\n     * Returns the result of addition of another coordinate.\n     * @param {Coordinate|Point|Array|Number} x - coordinate to add\n     * @param {Number} [y=undefined] - optional, coordinate to add\n     * @return {Coordinate|Point} result\n     */\n    add(x, y) {\n        let nx, ny;\n        if (!isNil(x.x)) {\n            nx = this.x + x.x;\n            ny = this.y + x.y;\n        } else if (!isNil(x[0])) {\n            nx = this.x + x[0];\n            ny = this.y + x[1];\n        } else {\n            nx = this.x + x;\n            ny = this.y + y;\n        }\n        return new this.constructor(nx, ny);\n    }\n\n    //destructive substract\n    _sub(x, y) {\n        if (!isNil(x.x)) {\n            this.x -= x.x;\n            this.y -= x.y;\n        } else if (!isNil(x[0])) {\n            this.x -= x[0];\n            this.y -= x[1];\n        } else {\n            this.x -= x;\n            this.y -= y;\n        }\n        return this;\n    }\n\n    _substract() {\n        return this._sub.apply(this, arguments);\n    }\n\n    /**\n     * Returns the result of subtraction of another coordinate.\n     * @param {Coordinate|Point|Array|Number} x - coordinate to add\n     * @param {Number} [y=undefined] - optional, coordinate to add\n     * @return {Coordinate|Point} result\n     */\n    sub(x, y) {\n        let nx, ny;\n        if (!isNil(x.x)) {\n            nx = this.x - x.x;\n            ny = this.y - x.y;\n        } else if (!isNil(x[0])) {\n            nx = this.x - x[0];\n            ny = this.y - x[1];\n        } else {\n            nx = this.x - x;\n            ny = this.y - y;\n        }\n        return new this.constructor(nx, ny);\n    }\n\n    /**\n     * Alias for sub\n     * @param {Coordinate|Point|Array|Number} x - coordinate to add\n     * @param {Number} [y=undefined] - optional, coordinate to add\n     * @return {Coordinate|Point} result\n     */\n    substract() {\n        return this.sub.apply(this, arguments);\n    }\n\n    /**\n     * Returns the result of multiplication of the current coordinate by the given number.\n     * @param {Number} ratio - ratio to multi\n     * @return {Coordinate|Point} result\n     */\n    multi(ratio) {\n        return new this.constructor(this.x * ratio, this.y * ratio);\n    }\n\n    _multi(ratio) {\n        this.x *= ratio;\n        this.y *= ratio;\n        return this;\n    }\n\n    /**\n     * Returns the result of division of the current point by the given number.\n     * @param {Number} n - number to div\n     * @return {Coordinate|Point} result\n     */\n    div(n) {\n        return this.multi(1 / n);\n    }\n\n    _div(n) {\n        return this._multi(1 / n);\n    }\n\n    /**\n     * Compare with another coordinate to see whether they are equal.\n     * @param {Coordinate|Point} c - coordinate to compare\n     * @return {Boolean}\n     */\n    equals(c) {\n        if (!(c instanceof this.constructor)) {\n            return false;\n        }\n        return this.x === c.x && this.y === c.y;\n    }\n\n    /**\n     * Whether the coordinate is NaN\n     * @return {Boolean}\n     * @private\n     */\n    _isNaN() {\n        return isNaN(this.x) || isNaN(this.y);\n    }\n\n    /**\n     * Whether the coordinate/point is zero\n     */\n    isZero() {\n        return this.x === 0 && this.y === 0;\n    }\n\n    /**\n     * Convert to a number array [x, y]\n     * @return {Number[]} number array\n     */\n    toArray() {\n        return [this.x, this.y];\n    }\n\n    /**\n     * Formats coordinate number using fixed-point notation.\n     * @param  {Number} n The number of digits to appear after the decimal point\n     * @return {Coordinate}   fixed coordinate\n     */\n    toFixed(n) {\n        return new this.constructor(this.x.toFixed(n), this.y.toFixed(n));\n    }\n\n    /**\n     * Convert to a json object {x : .., y : ..}\n     * @return {Object} json\n     */\n    toJSON() {\n        return {\n            x: this.x,\n            y: this.y\n        };\n    }\n}\n\nexport default Position;\n","import Position from './Position';\n\n/**\n * Represents a 2d point.<br>\n * Can be created in serveral ways:\n * @example\n * var point = new Point(1000, 1000);\n * @example\n * var point = new Point([1000,1000]);\n * @example\n * var point = new Point({x:1000, y:1000});\n * @category basic types\n */\nclass Point extends Position {\n\n    /**\n     * Compare with another point with a delta\n     * @param {Point} p\n     * @param {Number} delta\n     * @return {Boolean}\n     */\n    closeTo(p, delta) {\n        if (!delta) {\n            delta = 0;\n        }\n        return this.x >= (p.x - delta) && this.x <= (p.x + delta) &&\n            this.y >= (p.y - delta) && this.y <= (p.y + delta);\n    }\n\n    /**\n     * Returns the distance between the current and the given point.\n     * @param  {Point} point - another point\n     * @return {Number} distance\n     */\n    distanceTo(point) {\n        const x = point.x - this.x,\n            y = point.y - this.y;\n        return Math.sqrt(x * x + y * y);\n    }\n\n    /**\n     * Return the magitude of this point: this is the Euclidean\n     * distance from the 0, 0 coordinate to this point's x and y\n     * coordinates.\n     * @return {Number} magnitude\n     */\n    mag() {\n        return Math.sqrt(this.x * this.x + this.y * this.y);\n    }\n\n    /**\n     * Calculate this point but as a unit vector from 0, 0, meaning\n     * that the distance from the resulting point to the 0, 0\n     * coordinate will be equal to 1 and the angle from the resulting\n     * point to the 0, 0 coordinate will be the same as before.\n     * @return {Point} unit vector point\n     */\n    unit() {\n        return this.copy()._unit();\n    }\n\n    _unit() {\n        this._div(this.mag());\n        return this;\n    }\n\n    /**\n     * Compute a perpendicular point, where the new y coordinate\n     * is the old x coordinate and the new x coordinate is the old y\n     * coordinate multiplied by -1\n     * @return {Point} perpendicular point\n     */\n    perp() {\n        return this.copy()._perp();\n    }\n\n    _perp() {\n        const y = this.y;\n        this.y = this.x;\n        this.x = -y;\n        return this;\n    }\n\n\n\n    /**\n     * Get the angle between this point and another point, in radians\n     * from mapbox/point-geometry\n     * @param {Point} b the other point\n     * @return {Number} angle\n     */\n    angleWith(b) {\n        return this.angleWithSep(b.x, b.y);\n    }\n\n    /*\n     * Find the angle of the two vectors, solving the formula for\n     * the cross product a x b = |a||b|sin(θ) for θ.\n     * from mapbox/point-geometry\n     *\n     * @param {Number} x the x-coordinate\n     * @param {Number} y the y-coordinate\n     * @return {Number} the angle in radians\n     */\n    angleWithSep(x, y) {\n        return Math.atan2(\n            this.x * y - this.y * x,\n            this.x * x + this.y * y);\n    }\n\n    _rotate(angle) {\n        const cos = Math.cos(angle),\n            sin = Math.sin(angle),\n            x = cos * this.x - sin * this.y,\n            y = sin * this.x + cos * this.y;\n        this.x = x;\n        this.y = y;\n        return this;\n    }\n\n    /**\n     * Rotate this point around the 0, 0 origin by an angle a,\n     * given in radians\n     * from mapbox/point-geometry\n     *\n     * @param {Number} a angle to rotate around, in radians\n     * @return {Point} output point\n     */\n    rotate(a) {\n        return this.copy()._rotate(a);\n    }\n}\n\nexport default Point;\n","import Point from './Point';\nimport { isNumber } from '../core/util';\n\n/**\n * Represents a size.\n * @category basic types\n */\nclass Size {\n\n    /**\n     * @param {Number} width - width value\n     * @param {Number} height - height value\n     */\n    constructor(width, height) {\n        if (isNumber(width) && isNumber(height)) {\n            /**\n             * @property {Number} width - width\n             */\n            this.width = width;\n            /**\n             * @property {Number} height - height\n             */\n            this.height = height;\n        } else if (isNumber(width['width'])) {\n            this.width = width.width;\n            this.height = width.height;\n        } else if (Array.isArray(width)) {\n            this.width = width[0];\n            this.height = width[1];\n        }\n    }\n\n    /**\n     * Returns a copy of the size\n     * @return {Size} copy\n     */\n    copy() {\n        return new Size(this['width'], this['height']);\n    }\n\n    /**\n     * Returns the result of addition of another size.\n     * @param {Size} size - size to add\n     * @return {Size} result\n     */\n    add(x, y) {\n        let w, h;\n        if (x instanceof Size) {\n            w = this.width + x.width;\n            h = this.height + x.height;\n        } else {\n            w = this.width + x;\n            h = this.height + y;\n        }\n        return new Size(w, h);\n    }\n\n    /**\n     * Compare with another size to see whether they are equal.\n     * @param {Size} size - size to compare\n     * @return {Boolean}\n     */\n    equals(size) {\n        return this['width'] === size['width'] && this['height'] === size['height'];\n    }\n\n    /**\n     * Returns the result of multiplication of the current size by the given number.\n     * @param {Number} ratio - ratio to multi\n     * @return {Size} result\n     */\n    multi(ratio) {\n        return new Size(this['width'] * ratio, this['height'] * ratio);\n    }\n\n    _multi(ratio) {\n        this['width'] *= ratio;\n        this['height'] *= ratio;\n        return this;\n    }\n\n    _round() {\n        this['width'] = Math.round(this['width']);\n        this['height'] = Math.round(this['height']);\n        return this;\n    }\n\n    /**\n     * Converts the size object to a [Point]{Point}\n     * @return {Point} point\n     */\n    toPoint() {\n        return new Point(this['width'], this['height']);\n    }\n\n    /**\n     * Converts the size object to an array [width, height]\n     * @return {Number[]}\n     */\n    toArray() {\n        return [this['width'], this['height']];\n    }\n\n    /**\n     * Convert the size object to a json object {width : .., height : ..}\n     * @return {Object} json\n     */\n    toJSON() {\n        return {\n            'width': this['width'],\n            'height': this['height']\n        };\n    }\n}\n\nexport default Size;\n","import { isString, isNil } from './common';\nimport { getDomRuler, removeDomNode } from './dom';\nimport Point from '../../geo/Point';\nimport Size from '../../geo/Size';\n\n/**\n * @classdesc\n * Utilities methods for Strings used internally. It is static and should not be initiated.\n * @class\n * @static\n * @category core\n * @name StringUtil\n */\n\n/**\n * Trim the string\n * @param {String} str\n * @return {String}\n * @memberOf StringUtil\n */\nexport function trim(str) {\n    return str.trim ? str.trim() : str.replace(/^\\s+|\\s+$/g, '');\n}\n\nconst specialPattern = /[\\b\\t\\r\\v\\f]/igm;\n\n/**\n * Escape special characters from string.\n * Including: \\b \\t \\r \\v \\f\n * @param  {String} str string to escape\n * @return {String}\n * @memberOf StringUtil\n */\nexport function escapeSpecialChars(str) {\n    if (!isString(str)) {\n        return str;\n    }\n    return str.replace(specialPattern, '');\n}\n\n/**\n * Split string by specified char\n * @param {String} chr - char to split\n * @return {String[]}\n * @memberOf StringUtil\n */\nexport function splitWords(chr) {\n    return trim(chr).split(/\\s+/);\n}\n\nconst rulerCtx = typeof document !== 'undefined' ? document.createElement('canvas').getContext('2d') : null;\n\n/**\n * Gets width of the text with a certain font.\n * More performant than stringLength.\n * @param {String} text - text to measure\n * @param {String} font - font of the text, same as the CSS font.\n * @return {Number}\n * @memberOf StringUtil\n */\nexport function stringWidth(text, font) {\n    if (stringWidth.node) {\n        return stringWidth.node(text, font);\n    }\n    rulerCtx.font = font;\n    return rulerCtx.measureText(text).width;\n}\n\nconst fontHeight = {};\n\n/**\n * Gets size in pixel of the text with a certain font.\n * @param {String} text - text to measure\n * @param {String} font - font of the text, same as the CSS font.\n * @return {Size}\n * @memberOf StringUtil\n */\nexport function stringLength(text, font) {\n    if (stringLength.node) {\n        return stringLength.node(text, font);\n    } else {\n        const w = stringWidth(text, font);\n        if (!font) {\n            font = '_default_';\n        }\n        if (!fontHeight[font]) {\n            fontHeight[font] = getFontHeight(font);\n        }\n        return new Size(w, fontHeight[font]);\n    }\n}\n\nexport function getFontHeight(font) {\n    //dom\n    const domRuler = getDomRuler();\n    if (font !== '_default_') {\n        domRuler.style.font = font;\n    }\n    domRuler.innerHTML = '秦';\n    const h = domRuler.clientHeight;\n    //if not removed, the canvas container on chrome will turn to unexpected blue background.\n    // Reason is unknown.\n    removeDomNode(domRuler);\n    return h;\n}\n\n/**\n * Split text content by dom.\n * @param {String} content - content to split\n * @param {String} font - font of the text, same as the CSS font.\n * @return {Number} wrapWidth - width to wrap\n * @return {String[]}\n * @memberOf StringUtil\n */\nexport function splitContent(content, font, wrapWidth, textWidth) {\n    if (!content || content.length === 0) {\n        return [{ 'text' : '', 'width' : 0 }];\n    }\n    const width = isNil(textWidth) ? stringWidth(content, font) : textWidth;\n    const chrWidth = width / content.length,\n        minChrCount = Math.floor(wrapWidth / chrWidth / 2);\n    if (chrWidth >= wrapWidth || minChrCount <= 0) {\n        return [{ 'text' : '', 'width' : wrapWidth }];\n    }\n    if (width <= wrapWidth) return [{ 'text' : content, 'width' : width }];\n    const result = [];\n    let testStr = content.substring(0, minChrCount), prew = chrWidth * minChrCount;\n    for (let i = minChrCount, l = content.length; i < l; i++) {\n        const chr = content[i];\n        const w = stringWidth(testStr + chr);\n        if (w >= wrapWidth) {\n            result.push({ 'text' : testStr, 'width' : prew });\n            testStr = content.substring(i, minChrCount + i);\n            i += (minChrCount - 1);\n            prew = chrWidth * minChrCount;\n        } else {\n            testStr += chr;\n            prew = w;\n        }\n        if (i >= l - 1) {\n            prew = stringWidth(testStr);\n            result.push({ 'text' : testStr, 'width' : prew });\n        }\n    }\n    return result;\n}\n\nconst contentExpRe = /\\{([\\w_]+)\\}/g;\n\n/**\n * Replace variables wrapped by square brackets ({foo}) with actual values in props.\n * @example\n *     // will returns 'John is awesome'\n *     const actual = replaceVariable('{foo} is awesome', {'foo' : 'John'});\n * @param {String} str      - string to replace\n * @param {Object} props    - variable value properties\n * @return {String}\n * @memberOf StringUtil\n */\nexport function replaceVariable(str, props) {\n    if (!isString(str)) {\n        return str;\n    }\n    return str.replace(contentExpRe, function (str, key) {\n        if (!props) {\n            return '';\n        }\n        const value = props[key];\n        if (isNil(value)) {\n            return '';\n        } else if (Array.isArray(value)) {\n            return value.join();\n        }\n        return value;\n    });\n}\n\n/**\n * Gets text's align point according to the horizontalAlignment and verticalAlignment\n * @param  {Size} size                  - text size\n * @param  {String} horizontalAlignment - horizontalAlignment: left/middle/right\n * @param  {String} verticalAlignment   - verticalAlignment: top/middle/bottom\n * @return {Point}\n * @memberOf StringUtil\n */\nexport function getAlignPoint(size, horizontalAlignment, verticalAlignment) {\n    const width = size['width'],\n        height = size['height'];\n    let alignW, alignH;\n    if (horizontalAlignment === 'left') {\n        alignW = -width;\n    } else if (horizontalAlignment === 'right') {\n        alignW = 0;\n    } else {\n        alignW = -width / 2;\n    }\n    if (verticalAlignment === 'top') {\n        alignH = -height;\n    } else if (verticalAlignment === 'bottom') {\n        alignH = 0;\n    } else {\n        alignH = -height / 2;\n    }\n    return new Point(alignW, alignH);\n}\n\nconst DEFAULT_FONT = 'monospace';\n\n/**\n * Returns CSS Font from a symbol with text styles.\n * @param  {Object} style symbol with text styles\n * @return {String}       CSS Font String\n * @memberOf StringUtil\n */\nexport function getFont(style) {\n    if (style['textFont']) {\n        return style['textFont'];\n    } else {\n        return (style['textStyle'] && style['textStyle'] !== 'normal' ? style['textStyle'] + ' ' : '') +\n            (style['textWeight'] && style['textWeight'] !== 'normal' ? style['textWeight'] + ' ' : '') +\n            style['textSize'] + 'px ' +\n            (!style['textFaceName'] ? DEFAULT_FONT : (style['textFaceName'][0] === '\"' ? style['textFaceName'] : '\"' + style['textFaceName'] + '\"'));\n    }\n}\n\n/**\n * Split a text to multiple rows according to the style.\n * @param {String} text     - text to split\n * @param {Object} style    - text style\n * @return {Object[]} the object's structure: { rowNum: rowNum, textSize: textSize, rows: textRows, rawSize : rawSize }\n * @memberOf StringUtil\n */\nexport function splitTextToRow(text, style) {\n    const font = getFont(style),\n        lineSpacing = style['textLineSpacing'] || 0,\n        size = stringLength(text, font),\n        textWidth = size['width'],\n        textHeight = size['height'],\n        wrapChar = style['textWrapCharacter'],\n        textRows = [];\n    let wrapWidth = style['textWrapWidth'];\n    if (!wrapWidth || wrapWidth > textWidth) {\n        wrapWidth = textWidth;\n    }\n    if (!isString(text)) {\n        text += '';\n    }\n    let actualWidth = 0;\n    if (wrapChar && text.indexOf(wrapChar) >= 0) {\n        const texts = text.split(wrapChar);\n        for (let i = 0, l = texts.length; i < l; i++) {\n            const t = texts[i];\n            const tWidth = stringWidth(t, font);\n            if (tWidth > wrapWidth) {\n                const contents = splitContent(t, font, wrapWidth, tWidth);\n                for (let ii = 0, ll = contents.length; ii < ll; ii++) {\n                    const w = contents[ii].width;\n                    if (w > actualWidth) {\n                        actualWidth = w;\n                    }\n                    textRows.push({\n                        'text': contents[ii].text,\n                        'size': new Size(w, textHeight)\n                    });\n                }\n            } else {\n                if (tWidth > actualWidth) {\n                    actualWidth = tWidth;\n                }\n                textRows.push({\n                    'text': t,\n                    'size': new Size(tWidth, textHeight)\n                });\n            }\n        }\n    } else if (textWidth > wrapWidth) {\n        const contents = splitContent(text, font, wrapWidth, textWidth);\n        for (let i = 0; i < contents.length; i++) {\n            const w = contents[i].width;\n            if (w > actualWidth) {\n                actualWidth = w;\n            }\n            textRows.push({\n                'text': contents[i].text,\n                'size': new Size(w, textHeight)\n            });\n        }\n    } else {\n        if (textWidth > actualWidth) {\n            actualWidth = textWidth;\n        }\n        textRows.push({\n            'text': text,\n            'size': size\n        });\n    }\n\n    const rowNum = textRows.length;\n    const textSize = new Size(actualWidth, textHeight * rowNum + lineSpacing * (rowNum - 1));\n    return {\n        'total': rowNum,\n        'size': textSize,\n        'rows': textRows,\n        'rawSize': size\n    };\n}\n","/**\n * DOM utilities used internally.\n * Learned a lot from Leaflet.DomUtil\n * @class\n * @category core\n * @name DomUtil\n */\n\nimport Browser from  '../Browser';\nimport { IS_NODE } from './env';\nimport { isString, isNil } from './common';\nimport { splitWords } from './strings';\nimport Point from '../../geo/Point';\nimport Size from '../../geo/Size';\n\nconst first = (props) => {\n    return props[0];\n};\n\n/**\n * From Leaflet.DomUtil\n * Goes through the array of style names and returns the first name\n * that is a valid style name for an element. If no such name is found,\n * it returns false. Useful for vendor-prefixed styles like `transform`.\n * @param  {String[]} props\n * @return {Boolean}\n * @memberOf DomUtil\n * @private\n */\nconst testProp = IS_NODE ? first : (props) => {\n\n    const style = document.documentElement.style;\n\n    for (let i = 0; i < props.length; i++) {\n        if (props[i] in style) {\n            return props[i];\n        }\n    }\n    return false;\n};\n\n// prefix style property names\n\n/**\n * Vendor-prefixed fransform style name (e.g. `'webkitTransform'` for WebKit).\n * @property {String} TRANSFORM\n * @memberOf DomUtil\n * @type {String}\n */\nexport const TRANSFORM = testProp(\n    ['transform', 'WebkitTransform', 'OTransform', 'MozTransform', 'msTransform']);\n\n/**\n * Vendor-prefixed tfransform-origin name (e.g. `'webkitTransformOrigin'` for WebKit).\n * @property {String} TRANSFORMORIGIN\n * @memberOf DomUtil\n * @type {String}\n */\nexport const TRANSFORMORIGIN = testProp(\n    ['transformOrigin', 'WebkitTransformOrigin', 'OTransformOrigin', 'MozTransformOrigin', 'msTransformOrigin']);\n\n/**\n * Vendor-prefixed transition name (e.g. `'WebkitTransition'` for WebKit).\n * @property {String} TRANSITION\n * @memberOf DomUtil\n * @type {String}\n */\nexport const TRANSITION = testProp(\n    ['transition', 'WebkitTransition', 'OTransition', 'MozTransition', 'msTransition']);\n\n/**\n * Vendor-prefixed filter name (e.g. `'WebkitFilter'` for WebKit).\n * @property {String} FILTER\n * @memberOf DomUtil\n * @type {String}\n */\nexport const CSSFILTER = testProp(\n    ['filter', 'WebkitFilter', 'OFilter', 'MozFilter', 'msFilter']);\n\n/**\n * Create a html element.\n * @param {String} tagName\n * @returns {HTMLElement}\n * @memberOf DomUtil\n */\nexport function createEl(tagName, className) {\n    const el = document.createElement(tagName);\n    if (className) {\n        setClass(el, className);\n    }\n    return el;\n}\n\n/**\n * Create a html element on the specified container\n * @param {String} tagName\n * @param {String} style - css styles\n * @param {HTMLElement} container\n * @return {HTMLElement}\n * @memberOf DomUtil\n */\nexport function createElOn(tagName, style, container) {\n    const el = createEl(tagName);\n    if (style) {\n        setStyle(el, style);\n    }\n    if (container) {\n        container.appendChild(el);\n    }\n    return el;\n}\n\n/**\n * Removes a html element.\n * @param {HTMLElement} node\n * @memberOf DomUtil\n */\n/* istanbul ignore next */\nexport function removeDomNode(node) {\n    if (!node) {\n        return this;\n    }\n    if (Browser.ielt9 || Browser.ie9) {\n        //fix memory leak in IE9-\n        //http://com.hemiola.com/2009/11/23/memory-leaks-in-ie8/\n        let d = createEl('div');\n        d.appendChild(node);\n        d.innerHTML = '';\n        d = null;\n    } else if (node.parentNode) {\n        node.parentNode.removeChild(node);\n    }\n    return this;\n}\n\n/**\n * Adds a event listener to the dom element.\n * @param {HTMLElement} obj     - dom element to listen on\n * @param {String} typeArr      - event types, seperated by space\n * @param {Function} handler    - listener function\n * @param {Object} context      - function context\n * @memberOf DomUtil\n */\nexport function addDomEvent(obj, typeArr, handler, context) {\n    if (!obj || !obj.addEventListener || !typeArr || !handler) {\n        return this;\n    }\n    const eventHandler = function (e) {\n        if (!e) {\n            e = window.event;\n        }\n        handler.call(context || obj, e);\n        return;\n    };\n    const types = typeArr.split(' ');\n    for (let i = types.length - 1; i >= 0; i--) {\n        let type = types[i];\n        if (!type) {\n            continue;\n        }\n\n        if (!obj['Z__' + type]) {\n            obj['Z__' + type] = [];\n\n        }\n        const hit = listensDomEvent(obj, type, handler);\n        if (hit >= 0) {\n            removeDomEvent(obj, type, handler);\n        }\n        obj['Z__' + type].push({\n            callback: eventHandler,\n            src: handler\n        });\n        //firefox\n        if (type === 'mousewheel' && Browser.gecko) {\n            type = 'DOMMouseScroll';\n        }\n        obj.addEventListener(type, eventHandler, false);\n    }\n    return this;\n}\n\n/**\n * Removes event listener from a dom element\n * @param {HTMLElement} obj         - dom element\n * @param {String} typeArr          - event types, separated by space\n * @param {Function} handler        - listening function\n * @memberOf DomUtil\n */\nexport function removeDomEvent(obj, typeArr, handler) {\n    function doRemove(type, callback) {\n        //mouse wheel in firefox\n        if (type === 'mousewheel' && Browser.gecko) {\n            type = 'DOMMouseScroll';\n        }\n        obj.removeEventListener(type, callback, false);\n    }\n    if (!obj || !obj.removeEventListener || !typeArr) {\n        return this;\n    }\n    const types = typeArr.split(' ');\n    for (let i = types.length - 1; i >= 0; i--) {\n        const type = types[i];\n        if (!type) {\n            continue;\n        }\n        //remove all the listeners if handler is not given.\n        if (!handler && obj['Z__' + type]) {\n            const handlers = obj['Z__' + type];\n            for (let j = 0, jlen = handlers.length; j < jlen; j++) {\n                doRemove(handlers[j].callback);\n            }\n            delete obj['Z__' + type];\n            return this;\n        }\n        const hit = listensDomEvent(obj, type, handler);\n        if (hit < 0) {\n            return this;\n        }\n        const hitHandler = obj['Z__' + type][hit];\n        doRemove(type, hitHandler.callback);\n        obj['Z__' + type].splice(hit, 1);\n    }\n    return this;\n}\n\n/**\n * Check if event type of the dom is listened by the handler\n * @param {HTMLElement} obj     - dom element to check\n * @param {String} typeArr      - event\n * @param {Function} handler    - the listening function\n * @return {Number} - the handler's index in the listener chain, returns -1 if not.\n * @memberOf DomUtil\n */\nexport function listensDomEvent(obj, type, handler) {\n    if (!obj || !obj['Z__' + type] || !handler) {\n        return -1;\n    }\n    const handlers = obj['Z__' + type];\n    for (let i = 0, len = handlers.length; i < len; i++) {\n        if (handlers[i].src === handler) {\n            return i;\n        }\n    }\n    return -1;\n}\n\n/**\n * Prevent default behavior of the browser. <br/>\n * preventDefault Cancels the event if it is cancelable, without stopping further propagation of the event.\n * @param {Event} event - browser event\n * @memberOf DomUtil\n */\nexport function preventDefault(event) {\n    if (event.preventDefault) {\n        event.preventDefault();\n    } else {\n        event.returnValue = false;\n    }\n    return this;\n}\n\n/**\n * Stop browser event propagation\n * @param  {Event} e - browser event.\n * @memberOf DomUtil\n */\nexport function stopPropagation(e) {\n    if (e.stopPropagation) {\n        e.stopPropagation();\n    } else {\n        e.cancelBubble = true;\n    }\n    return this;\n}\n\nexport function preventSelection(dom) {\n    dom.onselectstart = function () {\n        return false;\n    };\n    dom.ondragstart = function () {\n        return false;\n    };\n    dom.setAttribute('unselectable', 'on');\n    return this;\n}\n\n/**\n * Get the dom element's current position or offset its position by offset\n * @param  {HTMLElement} dom - HTMLElement\n * @param  {Point} [offset=null] - position to set.\n * @return {Point} - dom element's current position if offset is null.\n * @memberOf DomUtil\n */\nexport function offsetDom(dom, offset) {\n    if (!dom) {\n        return null;\n    }\n\n    if (Browser.any3d) {\n        setTransform(dom, offset);\n    } else {\n        dom.style.left = offset.x + 'px';\n        dom.style.top = offset.y + 'px';\n    }\n    return offset;\n}\n\n/**\n * Compute dom's position\n * @param  {HTMLElement} dom\n * @return {Number[]}\n * @memberOf DomUtil\n */\nexport function computeDomPosition(dom) {\n    const style = window.getComputedStyle(dom);\n    const padding = [\n        parseInt(style['padding-left']),\n        parseInt(style['padding-top'])\n    ];\n    const rect = dom.getBoundingClientRect();\n    //fix #450, inspired by https://github.com/Leaflet/Leaflet/pull/5794/files\n    const offsetWidth = dom.offsetWidth,\n        offsetHeight = dom.offsetHeight;\n    const scaleX = offsetWidth ? rect.width / offsetWidth : 1,\n        scaleY = offsetHeight ? rect.height / offsetHeight : 1;\n    dom.__position = [rect.left + padding[0], rect.top + padding[1], scaleX, scaleY];\n    return dom.__position;\n}\n\n/**\n * Get event's position from the top-left corner of the dom container\n * @param {Event} ev    event\n * @return {Point}\n * @memberOf DomUtil\n */\nexport function getEventContainerPoint(ev, dom) {\n    if (!ev) {\n        ev = window.event;\n    }\n    let domPos = dom.__position;\n    if (!domPos) {\n        domPos = computeDomPosition(dom);\n    }\n    // div by scaleX, scaleY to fix #450\n    return new Point(\n        (ev.clientX - domPos[0] - dom.clientLeft) / domPos[2],\n        (ev.clientY - domPos[1] - dom.clientTop) / domPos[3]\n    );\n}\n\nfunction endsWith(str, suffix) {\n    const l = str.length - suffix.length;\n    return l >= 0 && str.indexOf(suffix, l) === l;\n}\n\n/**\n * set css style to the dom element\n * @param {HTMLElement} dom dom element\n * @param {String} strCss css text\n * @memberOf DomUtil\n */\nexport function setStyle(dom, strCss) {\n    let cssText = dom.style.cssText;\n    if (!endsWith(cssText, ';')) {\n        cssText += ';';\n    }\n    dom.style.cssText = cssText + strCss;\n    return this;\n}\n\n/**\n * Whether the dom has the given css class.\n * @param {HTMLElement} el HTML Element\n * @param {String} name css class\n * @memberOf DomUtil\n */\nexport function hasClass(el, name) {\n    if (el.classList !== undefined) {\n        return el.classList.contains(name);\n    }\n    const className = getClass(el);\n    return className.length > 0 && new RegExp('(^|\\\\s)' + name + '(\\\\s|$)').test(className);\n}\n\n/**\n * add css class to dom element\n * @param {HTMLElement} el HTML Element\n * @param {String} name css class\n * @memberOf DomUtil\n */\nexport function addClass(el, name) {\n    if (el.classList !== undefined && !hasClass(el, name)) {\n        const classes = splitWords(name);\n        for (let i = 0, len = classes.length; i < len; i++) {\n            el.classList.add(classes[i]);\n        }\n    } else {\n        const className = getClass(el);\n        setClass(el, (className ? className + ' ' : '') + name);\n    }\n    return this;\n}\n\n/**\n * Set dom's css class\n * @param {HTMLElement} el HTML Element\n * @param {String} name css class\n * @memberOf DomUtil\n */\nexport function setClass(el, name) {\n    if (isNil(el.className.baseVal)) {\n        el.className = name;\n    } else {\n        el.className.baseVal = name;\n    }\n    return this;\n}\n\n/**\n * Get dom's css class\n * @param {String} name css class\n * @retrun {String} class字符串\n * @memberOf DomUtil\n */\nexport function getClass(el) {\n    return isNil(el.className.baseVal) ? el.className : el.className.baseVal;\n}\n\n\nexport function setOpacity(el, value) {\n    el.style.opacity = value;\n    return this;\n}\n\n// export function copyCanvas(src) {\n//     if (IS_NODE) {\n//         return null;\n//     }\n//     const target = createEl('canvas');\n//     target.width = src.width;\n//     target.height = src.height;\n//     target.getContext('2d').drawImage(src, 0, 0);\n//     return target;\n// }\n\n/**\n * Resets the 3D CSS transform of `el` so it is translated by `offset` pixels\n * @param {HTMLElement} el\n * @param {Point} offset\n * @memberOf DomUtil\n */\nexport function setTransform(el, offset) {\n    const pos = offset || new Point(0, 0);\n    el.style[TRANSFORM] =\n        Browser.any3d ?\n            'translate3d(' + pos.x + 'px,' + pos.y + 'px,0px)' :\n            'translate(' + pos.x + 'px,' + pos.y + 'px)';\n\n    return this;\n}\n\nexport function setTransformMatrix(el, m) {\n    const text = 'matrix(' + (isString(m) ? m : m.join()) + ')';\n    if (el.style[TRANSFORM] !== text) {\n        el.style[TRANSFORM] = text;\n    }\n    return this;\n}\n\nexport function removeTransform(el) {\n    if (el.style[TRANSFORM]) {\n        el.style[TRANSFORM] = '';\n    }\n    return this;\n}\n\nexport function isHTML(str) {\n    return /<[a-z\\][\\s\\S]*>/i.test(str);\n}\n\nexport function measureDom(parentTag, dom) {\n    const ruler = getDomRuler(parentTag);\n    if (isString(dom)) {\n        ruler.innerHTML = dom;\n    } else {\n        ruler.appendChild(dom);\n    }\n    const result = new Size(ruler.clientWidth, ruler.clientHeight);\n    removeDomNode(ruler);\n    return result;\n}\n\nexport function getDomRuler(tag) {\n    const span = document.createElement(tag);\n    span.style.cssText = 'position:absolute;left:-10000px;top:-10000px;';\n    document.body.appendChild(span);\n    return span;\n}\n\n/**\n * Alias for [addDomEvent]{@link DomUtil.addDomEvent}\n * @param {HTMLElement} obj     - dom element to listen on\n * @param {String} typeArr      - event types, seperated by space\n * @param {Function} handler    - listener function\n * @param {Object} context      - function context\n * @static\n * @function\n * @return {DomUtil}\n * @memberOf DomUtil\n */\nexport const on = addDomEvent;\n\n/**\n * Alias for [removeDomEvent]{@link DomUtil.removeDomEvent}\n * @param {HTMLElement} obj         - dom element\n * @param {String} typeArr          - event types, separated by space\n * @param {Function} handler        - listening function\n * @static\n * @function\n * @return {DomUtil}\n * @memberOf DomUtil\n */\nexport const off = removeDomEvent;\n","/**\n * from mapbox-gl-js\n * A [least-recently-used cache](http://en.wikipedia.org/wiki/Cache_algorithms)\n * with hash lookup made possible by keeping a list of keys in parallel to\n * an array of dictionary of values\n *\n * @public\n */\nclass LRUCache {\n    /**\n     * @param {number} max number of permitted values\n     * @param {Function} onRemove callback called with items when they expire\n     */\n    constructor(max, onRemove) {\n        this.max = max;\n        this.onRemove = onRemove;\n        this.reset();\n    }\n\n    /**\n     * Clear the cache\n     *\n     * @returns {LRUCache} this cache\n     */\n    reset() {\n        for (const key in this.data) {\n            this.onRemove(this.data[key]);\n        }\n\n        this.data = {};\n        this.order = [];\n\n        return this;\n    }\n\n    clear() {\n        this.reset();\n        delete this.onRemove;\n    }\n\n    /**\n     * Add a key, value combination to the cache, trimming its size if this pushes\n     * it over max length.\n     *\n     * @param {string} key lookup key for the item\n     * @param {*} data any value\n     *\n     * @returns {LRUCache} this cache\n     */\n    add(key, data) {\n\n        if (this.has(key)) {\n            this.order.splice(this.order.indexOf(key), 1);\n            this.data[key] = data;\n            this.order.push(key);\n\n        } else {\n            this.data[key] = data;\n            this.order.push(key);\n\n            if (this.order.length > this.max) {\n                const removedData = this.getAndRemove(this.order[0]);\n                if (removedData) this.onRemove(removedData);\n            }\n        }\n\n        return this;\n    }\n\n    /**\n     * Determine whether the value attached to `key` is present\n     *\n     * @param {String} key the key to be looked-up\n     * @returns {Boolean} whether the cache has this value\n     */\n    has(key) {\n        return key in this.data;\n    }\n\n    /**\n     * List all keys in the cache\n     *\n     * @returns {Array<string>} an array of keys in this cache.\n     */\n    keys() {\n        return this.order;\n    }\n\n    /**\n     * Get the value attached to a specific key and remove data from cache.\n     * If the key is not found, returns `null`\n     *\n     * @param {string} key the key to look up\n     * @returns {*} the data, or null if it isn't found\n     */\n    getAndRemove(key) {\n        if (!this.has(key)) { return null; }\n\n        const data = this.data[key];\n\n        delete this.data[key];\n        this.order.splice(this.order.indexOf(key), 1);\n\n        return data;\n    }\n\n    /**\n     * Get the value attached to a specific key without removing data\n     * from the cache. If the key is not found, returns `null`\n     *\n     * @param {string} key the key to look up\n     * @returns {*} the data, or null if it isn't found\n     */\n    get(key) {\n        if (!this.has(key)) { return null; }\n\n        const data = this.data[key];\n        return data;\n    }\n\n    /**\n     * Remove a key/value combination from the cache.\n     *\n     * @param {string} key the key for the pair to delete\n     * @returns {LRUCache} this cache\n     */\n    remove(key) {\n        if (!this.has(key)) { return this; }\n\n        const data = this.data[key];\n        delete this.data[key];\n        this.onRemove(data);\n        this.order.splice(this.order.indexOf(key), 1);\n\n        return this;\n    }\n\n    /**\n     * Change the max size of the cache.\n     *\n     * @param {number} max the max size of the cache\n     * @returns {LRUCache} this cache\n     */\n    setMaxSize(max) {\n        this.max = max;\n\n        while (this.order.length > this.max) {\n            const removedData = this.getAndRemove(this.order[0]);\n            if (removedData) this.onRemove(removedData);\n        }\n\n        return this;\n    }\n}\n\nexport default LRUCache;\n","import { IS_NODE, isString, isFunction, parseJSON, emptyImageUrl, UID } from './util';\n\n/**\n * @classdesc\n * Ajax Utilities. It is static and should not be initiated.\n * @class\n * @static\n * @category core\n */\nconst Ajax = {\n\n    /**\n     * Get JSON data by jsonp\n     * from https://gist.github.com/gf3/132080/110d1b68d7328d7bfe7e36617f7df85679a08968\n     * @param  {String}   url - resource url\n     * @param  {Function} cb  - callback function when completed\n     */\n    jsonp: function (url, callback) {\n        // INIT\n        const name = '_maptalks_jsonp_' + UID();\n        if (url.match(/\\?/)) url += '&callback=' + name;\n        else url += '?callback=' + name;\n\n        // Create script\n        let script = document.createElement('script');\n        script.type = 'text/javascript';\n        script.src = url;\n\n        // Setup handler\n        window[name] = function (data) {\n            callback(null, data);\n            document.getElementsByTagName('head')[0].removeChild(script);\n            script = null;\n            delete window[name];\n        };\n\n        // Load JSON\n        document.getElementsByTagName('head')[0].appendChild(script);\n        return this;\n    },\n\n    /**\n     * Fetch remote resource by HTTP \"GET\" method\n     * @param  {String}   url - resource url\n     * @param  {Object}   [options=null] - request options\n     * @param  {Object}   [options.headers=null] - HTTP headers\n     * @param  {String}   [options.responseType=null] - responseType\n     * @param  {String}   [options.credentials=null]  - if with credentials, set it to \"include\"\n     * @param  {Function} cb  - callback function when completed\n     * @return {Ajax}  Ajax\n     * @example\n     * maptalks.Ajax.get(\n     *     'url/to/resource',\n     *     (err, data) => {\n     *         if (err) {\n     *             throw new Error(err);\n     *         }\n     *         // do things with data\n     *     }\n     * );\n     */\n    get: function (url, options, cb) {\n        if (isFunction(options)) {\n            const t = cb;\n            cb = options;\n            options = t;\n        }\n        if (IS_NODE && Ajax.get.node) {\n            return Ajax.get.node(url, cb, options);\n        }\n        const client = Ajax._getClient(cb);\n        client.open('GET', url, true);\n        if (options) {\n            for (const k in options.headers) {\n                client.setRequestHeader(k, options.headers[k]);\n            }\n            client.withCredentials = options.credentials === 'include';\n            if (options['responseType']) {\n                client.responseType = options['responseType'];\n            }\n        }\n        client.send(null);\n        return client;\n    },\n\n    /**\n     * Fetch remote resource by HTTP \"POST\" method\n     * @param  {String}   url - resource url\n     * @param  {Object}   options - request options\n     * @param  {String|Object}  options.postData - post data\n     * @param  {Object}   [options.headers=null]  - HTTP headers\n     * @param  {Function} cb  - callback function when completed\n     * @return {Ajax}  Ajax\n     * @example\n     * maptalks.Ajax.post(\n     *   'url/to/post',\n     *   {\n     *     postData : {\n     *       'param0' : 'val0',\n     *       'param1' : 1\n     *     }\n     *   },\n     *   (err, data) => {\n     *     if (err) {\n     *       throw new Error(err);\n     *     }\n     *     // do things with data\n     *   }\n     * );\n     */\n    post: function (url, options, cb) {\n        let postData;\n        if (!isString(url)) {\n            //for compatible\n            //options, postData, cb\n            const t = cb;\n            postData = options;\n            options = url;\n            url = options.url;\n            cb = t;\n        } else {\n            if (isFunction(options)) {\n                const t = cb;\n                cb = options;\n                options = t;\n            }\n            options = options || {};\n            postData = options.postData;\n        }\n        if (IS_NODE && Ajax.post.node) {\n            options.url = url;\n            return Ajax.post.node(options, postData, cb);\n        }\n        const client = Ajax._getClient(cb);\n        client.open('POST', options.url, true);\n        if (!options.headers) {\n            options.headers = {};\n        }\n        if (!options.headers['Content-Type']) {\n            options.headers['Content-Type'] = 'application/x-www-form-urlencoded';\n        }\n        if ('setRequestHeader' in client) {\n            for (const p in options.headers) {\n                if (options.headers.hasOwnProperty(p)) {\n                    client.setRequestHeader(p, options.headers[p]);\n                }\n            }\n        }\n        if (!isString(postData)) {\n            postData = JSON.stringify(postData);\n        }\n        client.send(postData);\n        return client;\n    },\n\n    _wrapCallback: function (client, cb) {\n        return function () {\n            if (client.readyState === 4) {\n                if (client.status === 200) {\n                    if (client.responseType === 'arraybuffer') {\n                        const response = client.response;\n                        if (response.byteLength === 0) {\n                            cb(new Error('http status 200 returned without content.'));\n                        } else {\n                            cb(null, {\n                                data: client.response,\n                                cacheControl: client.getResponseHeader('Cache-Control'),\n                                expires: client.getResponseHeader('Expires'),\n                                contentType : client.getResponseHeader('Content-Type')\n                            });\n                        }\n                    } else {\n                        cb(null, client.responseText);\n                    }\n                } else {\n                    cb(new Error(client.statusText + ',' + client.status));\n                }\n            }\n        };\n    },\n\n    _getClient: function (cb) {\n        /*eslint-disable no-empty, no-undef*/\n        let client;\n        try {\n            client = new XMLHttpRequest();\n        } catch (e) {\n            try { client = new ActiveXObject('Msxml2.XMLHTTP'); } catch (e) {\n                try { client = new ActiveXObject('Microsoft.XMLHTTP'); } catch (e) {}\n            }\n        }\n        client.onreadystatechange = Ajax._wrapCallback(client, cb);\n        return client;\n        /*eslint-enable no-empty, no-undef*/\n    },\n    /**\n     * Fetch resource as arraybuffer.\n     * @param {String} url    - url\n     * @param {Object} [options=null] - options, same as Ajax.get\n     * @param {Function} cb   - callback function when completed.\n     * @example\n     * maptalks.Ajax.getArrayBuffer(\n     *     'url/to/resource.bin',\n     *     (err, data) => {\n     *         if (err) {\n     *             throw new Error(err);\n     *         }\n     *         // data is a binary array\n     *     }\n     * );\n     */\n    getArrayBuffer(url, options, cb) {\n        if (isFunction(options)) {\n            const t = cb;\n            cb = options;\n            options = t;\n        }\n        if (!options) {\n            options = {};\n        }\n        options['responseType'] = 'arraybuffer';\n        return Ajax.get(url, options, cb);\n    },\n\n    // from mapbox-gl-js\n    getImage(img, url, options) {\n        return Ajax.getArrayBuffer(url, options, (err, imgData) => {\n            if (err) {\n                if (img.onerror) {\n                    img.onerror(err);\n                }\n            } else if (imgData) {\n                const URL = window.URL || window.webkitURL;\n                const onload = img.onload;\n                img.onload = () => {\n                    if (onload) {\n                        onload();\n                    }\n                    URL.revokeObjectURL(img.src);\n                };\n                const blob = new Blob([new Uint8Array(imgData.data)], { type: imgData.contentType });\n                img.cacheControl = imgData.cacheControl;\n                img.expires = imgData.expires;\n                img.src = imgData.data.byteLength ? URL.createObjectURL(blob) : emptyImageUrl;\n            }\n        });\n    }\n};\n\n/**\n * Fetch resource as a JSON Object.\n * @param {String} url          - json's url\n * @param {Object} [options=null]        - optional options\n * @param {String} [options.jsonp=false] - fetch by jsonp, false by default\n * @param {Function} cb   - callback function when completed.\n * @example\n * maptalks.Ajax.getJSON(\n *     'url/to/resource.json',\n *     { jsonp : true },\n *     (err, json) => {\n *         if (err) {\n *             throw new Error(err);\n *         }\n *         // json is a JSON Object\n *         console.log(json.foo);\n *     }\n * );\n * @static\n */\nAjax.getJSON = function (url, options, cb) {\n    if (isFunction(options)) {\n        const t = cb;\n        cb = options;\n        options = t;\n    }\n    const callback = function (err, resp) {\n        const data = resp ? parseJSON(resp) : null;\n        cb(err, data);\n    };\n    if (options && options['jsonp']) {\n        return Ajax.jsonp(url, callback);\n    }\n    return Ajax.get(url, options, callback);\n};\n\nexport default Ajax;\n","import {\n    IS_NODE,\n    isNil,\n    isNumber,\n    isString,\n    isArrayHasData,\n    isSVG,\n    isCssUrl,\n    extractCssUrl,\n    computeDegree\n} from './util';\nimport { isGradient } from './util/style';\nimport { createEl } from './util/dom';\nimport Browser from './Browser';\nimport Point from '../geo/Point';\nimport { getFont, getAlignPoint } from './util/strings';\n\nconst DEFAULT_STROKE_COLOR = '#000';\nconst DEFAULT_FILL_COLOR = 'rgba(255,255,255,0)';\nconst DEFAULT_TEXT_COLOR = '#000';\n\nlet hitTesting = false;\n\nlet TEMP_CANVAS = null;\n\nconst Canvas = {\n    setHitTesting(testing) {\n        hitTesting = testing;\n    },\n\n    createCanvas(width, height, canvasClass) {\n        let canvas;\n        if (!IS_NODE) {\n            canvas = createEl('canvas');\n            canvas.width = width;\n            canvas.height = height;\n        } else {\n            //can be node-canvas or any other canvas mock\n            canvas = new canvasClass(width, height);\n        }\n        return canvas;\n    },\n\n    prepareCanvasFont(ctx, style) {\n        ctx.textBaseline = 'top';\n        ctx.font = getFont(style);\n        let fill = style['textFill'];\n        if (!fill) {\n            fill = DEFAULT_TEXT_COLOR;\n        }\n        ctx.fillStyle = Canvas.getRgba(fill, style['textOpacity']);\n    },\n\n    /**\n     * Set canvas's fill and stroke style\n     * @param {CanvasRenderingContext2D} ctx\n     * @param {Object} style\n     * @param {Object} resources\n     * @param {Boolean} testing  - paint for testing, ignore stroke and fill patterns\n     */\n    prepareCanvas(ctx, style, resources, testing) {\n        if (!style) {\n            return;\n        }\n        const strokeWidth = style['lineWidth'];\n        if (!isNil(strokeWidth) && ctx.lineWidth !== strokeWidth) {\n            ctx.lineWidth = strokeWidth;\n        }\n        const strokeColor = style['linePatternFile'] || style['lineColor'] || DEFAULT_STROKE_COLOR;\n        if (testing) {\n            ctx.strokeStyle = '#000';\n        } else if (isImageUrl(strokeColor) && resources) {\n            let patternOffset;\n            if (style['linePatternDx'] || style['linePatternDy']) {\n                patternOffset = [style['linePatternDx'], style['linePatternDy']];\n            }\n            Canvas._setStrokePattern(ctx, strokeColor, strokeWidth, patternOffset, resources);\n            //line pattern will override stroke-dasharray\n            style['lineDasharray'] = [];\n        } else if (isGradient(strokeColor)) {\n            if (style['lineGradientExtent']) {\n                ctx.strokeStyle = Canvas._createGradient(ctx, strokeColor, style['lineGradientExtent']);\n            } else {\n                ctx.strokeStyle = DEFAULT_STROKE_COLOR;\n            }\n        } else /*if (ctx.strokeStyle !== strokeColor)*/ {\n            ctx.strokeStyle = strokeColor;\n        }\n        if (style['lineJoin']) {\n            ctx.lineJoin = style['lineJoin'];\n        }\n        if (style['lineCap']) {\n            ctx.lineCap = style['lineCap'];\n        }\n        if (ctx.setLineDash && isArrayHasData(style['lineDasharray'])) {\n            ctx.setLineDash(style['lineDasharray']);\n        }\n        const fill = style['polygonPatternFile'] || style['polygonFill'] || DEFAULT_FILL_COLOR;\n        if (testing) {\n            ctx.fillStyle = '#000';\n        } else if (isImageUrl(fill) && resources) {\n            const fillImgUrl = extractImageUrl(fill);\n            let fillTexture = resources.getImage([fillImgUrl, null, null]);\n            if (!fillTexture) {\n                //if the linestring has a arrow and a linePatternFile, polygonPatternFile will be set with the linePatternFile.\n                fillTexture = resources.getImage([fillImgUrl + '-texture', null, strokeWidth]);\n            }\n            if (isSVG(fillImgUrl) && (fillTexture instanceof Image) && (Browser.edge || Browser.ie)) {\n                //opacity of svg img painted on canvas is always 1, so we paint svg on a canvas at first.\n                const w = fillTexture.width || 20,\n                    h = fillTexture.height || 20;\n                const canvas = Canvas.createCanvas(w, h);\n                Canvas.image(canvas.getContext('2d'), fillTexture, 0, 0, w, h);\n                fillTexture = canvas;\n            }\n            if (!fillTexture) {\n                if (typeof console !== 'undefined') {\n                    console.warn('img not found for', fillImgUrl);\n                }\n            } else {\n                ctx.fillStyle = ctx.createPattern(fillTexture, 'repeat');\n                if (style['polygonPatternDx'] || style['polygonPatternDy']) {\n                    ctx.fillStyle['polygonPatternOffset'] = [style['polygonPatternDx'], style['polygonPatternDy']];\n                }\n            }\n\n        } else if (isGradient(fill)) {\n            if (style['polygonGradientExtent']) {\n                ctx.fillStyle = Canvas._createGradient(ctx, fill, style['polygonGradientExtent']);\n            } else {\n                ctx.fillStyle = 'rgba(255,255,255,0)';\n            }\n        } else /*if (ctx.fillStyle !== fill)*/ {\n            ctx.fillStyle = fill;\n        }\n    },\n\n    _createGradient(ctx, g, extent) {\n        let gradient = null,\n            places = g['places'];\n        const min = extent.getMin(),\n            max = extent.getMax(),\n            width = extent.getWidth(),\n            height = extent.getHeight();\n        if (!g['type'] || g['type'] === 'linear') {\n            if (!places) {\n                places = [min.x, min.y, max.x, min.y];\n            } else {\n                if (places.length !== 4) {\n                    throw new Error('A linear gradient\\'s places should have 4 numbers.');\n                }\n                places = [\n                    min.x + places[0] * width, min.y + places[1] * height,\n                    min.x + places[2] * width, min.y + places[3] * height\n                ];\n            }\n            gradient = ctx.createLinearGradient.apply(ctx, places);\n        } else if (g['type'] === 'radial') {\n            if (!places) {\n                const c = extent.getCenter()._round();\n                places = [c.x, c.y, Math.abs(c.x - min.x), c.x, c.y, 0];\n            } else {\n                if (places.length !== 6) {\n                    throw new Error('A radial gradient\\'s places should have 6 numbers.');\n                }\n                places = [\n                    min.x + places[0] * width, min.y + places[1] * height, width * places[2],\n                    min.x + places[3] * width, min.y + places[4] * height, width * places[5]\n                ];\n            }\n            gradient = ctx.createRadialGradient.apply(ctx, places);\n        }\n        g['colorStops'].forEach(stop => {\n            gradient.addColorStop.apply(gradient, stop);\n        });\n        return gradient;\n    },\n\n    _setStrokePattern(ctx, strokePattern, strokeWidth, linePatternOffset, resources) {\n        const imgUrl = extractImageUrl(strokePattern);\n        let imageTexture;\n        if (IS_NODE) {\n            imageTexture = resources.getImage([imgUrl, null, strokeWidth]);\n        } else {\n            const key = imgUrl + '-texture-' + strokeWidth;\n            imageTexture = resources.getImage(key);\n            if (!imageTexture) {\n                const imageRes = resources.getImage([imgUrl, null, null]);\n                if (imageRes) {\n                    let w;\n                    if (!imageRes.width || !imageRes.height) {\n                        w = strokeWidth;\n                    } else {\n                        w = Math.round(imageRes.width * strokeWidth / imageRes.height);\n                    }\n                    const patternCanvas = Canvas.createCanvas(w, strokeWidth, ctx.canvas.constructor);\n                    Canvas.image(patternCanvas.getContext('2d'), imageRes, 0, 0, w, strokeWidth);\n                    resources.addResource([key, null, strokeWidth], patternCanvas);\n                    imageTexture = patternCanvas;\n                }\n            }\n        }\n        if (imageTexture) {\n            ctx.strokeStyle = ctx.createPattern(imageTexture, 'repeat');\n            ctx.strokeStyle['linePatternOffset'] = linePatternOffset;\n        } else if (typeof console !== 'undefined') {\n            console.warn('img not found for', imgUrl);\n        }\n    },\n\n    clearRect(ctx, x1, y1, x2, y2) {\n        ctx.canvas._drawn = false;\n        ctx.clearRect(x1, y1, x2, y2);\n    },\n\n    fillCanvas(ctx, fillOpacity, x, y) {\n        if (hitTesting) {\n            fillOpacity = 1;\n        }\n        ctx.canvas._drawn = true;\n        if (fillOpacity === 0) {\n            return;\n        }\n        const isPattern = Canvas._isPattern(ctx.fillStyle);\n\n        const offset = ctx.fillStyle && ctx.fillStyle['polygonPatternOffset'];\n        const dx = offset ? offset[0] : 0,\n            dy = offset ? offset[1] : 0;\n\n        if (isNil(fillOpacity)) {\n            fillOpacity = 1;\n        }\n        let alpha;\n        if (fillOpacity < 1) {\n            alpha = ctx.globalAlpha;\n            ctx.globalAlpha *= fillOpacity;\n        }\n        if (isPattern) {\n            x = x || 0;\n            y = y || 0;\n            // x = round(x);\n            // y = round(y);\n            ctx.translate(x + dx, y + dy);\n        }\n        ctx.fill();\n        if (isPattern) {\n            ctx.translate(-x - dx, -y - dy);\n        }\n        if (fillOpacity < 1) {\n            ctx.globalAlpha = alpha;\n        }\n    },\n\n    // hexColorRe: /^#([0-9a-f]{6}|[0-9a-f]{3})$/i,\n\n    // support #RRGGBB/#RGB now.\n    // if color was like [red, orange...]/rgb(a)/hsl(a), op will not combined to result\n    getRgba(color, op) {\n        if (isNil(op)) {\n            op = 1;\n        }\n        if (color[0] !== '#') {\n            return color;\n        }\n        let r, g, b;\n        if (color.length === 7) {\n            r = parseInt(color.substring(1, 3), 16);\n            g = parseInt(color.substring(3, 5), 16);\n            b = parseInt(color.substring(5, 7), 16);\n        } else {\n            r = parseInt(color.substring(1, 2), 16) * 17;\n            g = parseInt(color.substring(2, 3), 16) * 17;\n            b = parseInt(color.substring(3, 4), 16) * 17;\n        }\n        return 'rgba(' + r + ',' + g + ',' + b + ',' + op + ')';\n    },\n\n    image(ctx, img, x, y, width, height) {\n        ctx.canvas._drawn = true;\n        try {\n            if (isNumber(width) && isNumber(height)) {\n                ctx.drawImage(img, x, y, width, height);\n            } else {\n                ctx.drawImage(img, x, y);\n            }\n        } catch (error) {\n            if (console) {\n                console.warn('error when drawing image on canvas:', error);\n                console.warn(img);\n            }\n        }\n    },\n\n    text(ctx, text, pt, style, textDesc) {\n        Canvas._textOnMultiRow(ctx, textDesc['rows'], style, pt, textDesc['size'], textDesc['rawSize']);\n    },\n\n    _textOnMultiRow(ctx, texts, style, point, splitTextSize, textSize) {\n        const ptAlign = getAlignPoint(splitTextSize, style['textHorizontalAlignment'], style['textVerticalAlignment']),\n            lineHeight = textSize['height'] + style['textLineSpacing'],\n            basePoint = point.add(0, ptAlign.y),\n            maxHeight = style['textMaxHeight'];\n        let text, rowAlign, height = 0;\n        for (let i = 0, len = texts.length; i < len; i++) {\n            text = texts[i]['text'];\n            rowAlign = getAlignPoint(texts[i]['size'], style['textHorizontalAlignment'], style['textVerticalAlignment']);\n            Canvas._textOnLine(ctx, text, basePoint.add(rowAlign.x, i * lineHeight), style['textHaloRadius'], style['textHaloFill'], style['textHaloOpacity']);\n            if (maxHeight > 0) {\n                height += lineHeight;\n                if (height + textSize['height'] >= maxHeight) {\n                    break;\n                }\n            }\n        }\n    },\n\n    _textOnLine(ctx, text, pt, textHaloRadius, textHaloFill, textHaloAlpha) {\n        if (hitTesting) {\n            textHaloAlpha = 1;\n        }\n        const drawHalo = textHaloAlpha !== 0 && textHaloRadius !== 0;\n        // pt = pt._round();\n        ctx.textBaseline = 'top';\n        let gco, fill;\n        const shadowBlur = ctx.shadowBlur,\n            shadowOffsetX = ctx.shadowOffsetX,\n            shadowOffsetY = ctx.shadowOffsetY;\n        if (drawHalo) {\n            const alpha = ctx.globalAlpha;\n            //http://stackoverflow.com/questions/14126298/create-text-outline-on-canvas-in-javascript\n            //根据text-horizontal-alignment和text-vertical-alignment计算绘制起始点偏移量\n            ctx.globalAlpha *= textHaloAlpha;\n\n            ctx.miterLimit = 2;\n            ctx.lineJoin = 'round';\n            ctx.lineCap = 'round';\n            ctx.lineWidth = textHaloRadius * 2;\n            ctx.strokeStyle = textHaloFill;\n            ctx.strokeText(text, Math.round(pt.x), Math.round(pt.y));\n            ctx.miterLimit = 10; //default\n\n            ctx.globalAlpha = alpha;\n\n            gco = ctx.globalCompositeOperation;\n            ctx.globalCompositeOperation = 'destination-out';\n            fill = ctx.fillStyle;\n            ctx.fillStyle = '#000';\n        }\n\n        if (shadowBlur && drawHalo) {\n            ctx.shadowBlur = ctx.shadowOffsetX = ctx.shadowOffsetY = 0;\n        }\n        Canvas.fillText(ctx, text, pt.x, pt.y);\n        if (gco) {\n            ctx.globalCompositeOperation = gco;\n            Canvas.fillText(ctx, text, pt.x, pt.y, fill);\n            if (shadowBlur) {\n                ctx.shadowBlur = shadowBlur;\n                ctx.shadowOffsetX = shadowOffsetX;\n                ctx.shadowOffsetY = shadowOffsetY;\n            }\n        }\n    },\n\n    fillText(ctx, text, x, y, rgba) {\n        ctx.canvas._drawn = true;\n        if (rgba) {\n            ctx.fillStyle = rgba;\n        }\n        ctx.fillText(text, Math.round(x), Math.round(y));\n    },\n\n    _stroke(ctx, strokeOpacity, x, y) {\n        if (hitTesting) {\n            strokeOpacity = 1;\n        }\n        ctx.canvas._drawn = true;\n        if (strokeOpacity === 0) {\n            return;\n        }\n        const offset = ctx.strokeStyle && ctx.strokeStyle['linePatternOffset'];\n        const dx = offset ? offset[0] : 0,\n            dy = offset ? offset[1] : 0;\n\n        const isPattern = Canvas._isPattern(ctx.strokeStyle) && (!isNil(x) && !isNil(y) || !isNil(dx) && !isNil(dy));\n\n        if (isNil(strokeOpacity)) {\n            strokeOpacity = 1;\n        }\n        let alpha;\n        if (strokeOpacity < 1) {\n            alpha = ctx.globalAlpha;\n            ctx.globalAlpha *= strokeOpacity;\n        }\n        if (isPattern) {\n            x = x || 0;\n            y = y || 0;\n            // x = round(x);\n            // y = round(y);\n            ctx.translate(x + dx, y + dy);\n        }\n        ctx.stroke();\n        if (isPattern) {\n            ctx.translate(-x - dx, -y - dy);\n        }\n        if (strokeOpacity < 1) {\n            ctx.globalAlpha = alpha;\n        }\n    },\n\n    _path(ctx, points, lineDashArray, lineOpacity, ignoreStrokePattern) {\n        if (!isArrayHasData(points)) {\n            return;\n        }\n\n        function fillWithPattern(p1, p2) {\n            const degree = computeDegree(p1.x, p1.y, p2.x, p2.y);\n            ctx.save();\n            ctx.translate(p1.x, p1.y - ctx.lineWidth / 2 / Math.cos(degree));\n            ctx.rotate(degree);\n            Canvas._stroke(ctx, lineOpacity);\n            ctx.restore();\n        }\n\n        const isDashed = isArrayHasData(lineDashArray);\n        const isPatternLine = (ignoreStrokePattern === true ? false : Canvas._isPattern(ctx.strokeStyle));\n        let point, prePoint, nextPoint;\n        for (let i = 0, len = points.length; i < len; i++) {\n            point = points[i];\n            if (!isDashed || ctx.setLineDash) { //IE9+\n                ctx.lineTo(point.x, point.y);\n                if (isPatternLine && i > 0) {\n                    prePoint = points[i - 1];\n                    fillWithPattern(prePoint, point);\n                    ctx.beginPath();\n                    ctx.moveTo(point.x, point.y);\n                }\n            } else if (isDashed) {\n                if (i === len - 1) {\n                    break;\n                }\n                nextPoint = points[i + 1];\n                drawDashLine(ctx, point, nextPoint, lineDashArray, isPatternLine);\n            }\n        }\n    },\n\n    path(ctx, points, lineOpacity, fillOpacity, lineDashArray) {\n        if (!isArrayHasData(points)) {\n            return;\n        }\n        ctx.beginPath();\n        ctx.moveTo(points[0].x, points[0].y);\n        Canvas._path(ctx, points, lineDashArray, lineOpacity);\n        Canvas._stroke(ctx, lineOpacity);\n    },\n\n    _multiClip(ctx, points) {\n        if (!points || points.length === 0) return;\n        //not Handle holes\n        points = points[0];\n        for (let i = 0, len = points.length; i < len; i++) {\n            const point = points[i];\n            let x = point.x, y = point.y;\n            if (i === 0) {\n                ctx.moveTo(x, y);\n            } else {\n                ctx.lineTo(x, y);\n            }\n            if (i === len - 1) {\n                x = points[0].x;\n                y = points[0].y;\n                ctx.lineTo(x, y);\n            }\n        }\n    },\n\n    polygon(ctx, points, lineOpacity, fillOpacity, lineDashArray, smoothness) {\n        // if MultiClip\n        if (ctx.isMultiClip) {\n            Canvas._multiClip(ctx, points);\n            return;\n        }\n        if (!isArrayHasData(points)) {\n            return;\n        }\n\n        const isPatternLine = Canvas._isPattern(ctx.strokeStyle),\n            fillFirst = (isArrayHasData(lineDashArray) && !ctx.setLineDash) || isPatternLine && !smoothness;\n        if (!isArrayHasData(points[0])) {\n            points = [points];\n        }\n        const savedCtx = ctx;\n        if (points.length > 1 && !IS_NODE) {\n            if (!TEMP_CANVAS) {\n                TEMP_CANVAS = Canvas.createCanvas(1, 1);\n            }\n            ctx.canvas._drawn = false;\n            TEMP_CANVAS.width = ctx.canvas.width;\n            TEMP_CANVAS.height = ctx.canvas.height;\n            ctx = TEMP_CANVAS.getContext('2d');\n            copyProperties(ctx, savedCtx);\n        }\n        // function fillPolygon(points, i, op) {\n        //     Canvas.fillCanvas(ctx, op, points[i][0].x, points[i][0].y);\n        // }\n        let op, i, len;\n        if (fillFirst) {\n            //因为canvas只填充moveto,lineto,lineto的空间, 而dashline的moveto不再构成封闭空间, 所以重新绘制图形轮廓用于填充\n            ctx.save();\n            for (i = 0, len = points.length; i < len; i++) {\n                if (!isArrayHasData(points[i])) {\n                    continue;\n                }\n                Canvas._ring(ctx, points[i], null, 0, true);\n                op = fillOpacity;\n                if (i > 0) {\n                    ctx.globalCompositeOperation = 'destination-out';\n                    op = 1;\n                }\n                Canvas.fillCanvas(ctx, op, points[i][0].x, points[i][0].y);\n                if (i > 0) {\n                    ctx.globalCompositeOperation = 'source-over';\n                } else if (len > 1) {\n                    // make sure 'destination-out'\n                    ctx.fillStyle = '#fff';\n                }\n                Canvas._stroke(ctx, 0);\n            }\n            ctx.restore();\n        }\n        for (i = 0, len = points.length; i < len; i++) {\n            if (!isArrayHasData(points[i])) {\n                continue;\n            }\n\n            if (smoothness) {\n                Canvas.paintSmoothLine(ctx, points[i], lineOpacity, smoothness, true);\n                ctx.closePath();\n            } else {\n                Canvas._ring(ctx, points[i], lineDashArray, lineOpacity);\n            }\n\n            if (!fillFirst) {\n                op = fillOpacity;\n                if (i > 0) {\n                    ctx.globalCompositeOperation = 'destination-out';\n                    op = 1;\n                }\n                Canvas.fillCanvas(ctx, op, points[i][0].x, points[i][0].y);\n                if (i > 0) {\n                    //return to default compositeOperation to display strokes.\n                    ctx.globalCompositeOperation = 'source-over';\n                } else if (len > 1) {\n                    // make sure 'destination-out'\n                    ctx.fillStyle = '#fff';\n                }\n            }\n            Canvas._stroke(ctx, lineOpacity);\n        }\n        if (points.length > 1 && !IS_NODE) {\n            savedCtx.drawImage(TEMP_CANVAS, 0, 0);\n            savedCtx.canvas._drawn = ctx.canvas._drawn;\n            copyProperties(savedCtx, ctx);\n        }\n    },\n\n    _ring(ctx, ring, lineDashArray, lineOpacity, ignorePattern) {\n        const isPattern = Canvas._isPattern(ctx.strokeStyle);\n        if (!ignorePattern && isPattern && !ring[0].equals(ring[ring.length - 1])) {\n            ring = ring.concat([ring[0]]);\n        }\n        ctx.beginPath();\n        ctx.moveTo(ring[0].x, ring[0].y);\n        Canvas._path(ctx, ring, lineDashArray, lineOpacity, ignorePattern);\n        if (!isPattern) {\n            ctx.closePath();\n        }\n    },\n\n    paintSmoothLine(ctx, points, lineOpacity, smoothValue, close, tailIdx, tailRatio) {\n        if (!points) {\n            return;\n        }\n        if (points.length <= 2 || !smoothValue) {\n            Canvas.path(ctx, points, lineOpacity);\n            return;\n        }\n\n        //推算 cubic 贝塞尔曲线片段的起终点和控制点坐标\n        //t0: 片段起始比例 0-1\n        //t1: 片段结束比例 0-1\n        //x1, y1, 曲线起点\n        //bx1, by1, bx2, by2，曲线控制点\n        //x2, y2  曲线终点\n        //结果是曲线片段的起点，2个控制点坐标和终点坐标\n        //https://stackoverflow.com/questions/878862/drawing-part-of-a-b%C3%A9zier-curve-by-reusing-a-basic-b%C3%A9zier-curve-function/879213#879213\n        function interpolate(t0, t1, x1, y1, bx1, by1, bx2, by2, x2, y2) {\n            const u0 = 1.0 - t0;\n            const u1 = 1.0 - t1;\n\n            const qxa =  x1 * u0 * u0 + bx1 * 2 * t0 * u0 + bx2 * t0 * t0;\n            const qxb =  x1 * u1 * u1 + bx1 * 2 * t1 * u1 + bx2 * t1 * t1;\n            const qxc = bx1 * u0 * u0 + bx2 * 2 * t0 * u0 +  x2 * t0 * t0;\n            const qxd = bx1 * u1 * u1 + bx2 * 2 * t1 * u1 +  x2 * t1 * t1;\n\n            const qya =  y1 * u0 * u0 + by1 * 2 * t0 * u0 + by2 * t0 * t0;\n            const qyb =  y1 * u1 * u1 + by1 * 2 * t1 * u1 + by2 * t1 * t1;\n            const qyc = by1 * u0 * u0 + by2 * 2 * t0 * u0 +  y2 * t0 * t0;\n            const qyd = by1 * u1 * u1 + by2 * 2 * t1 * u1 +  y2 * t1 * t1;\n\n            // const xa = qxa * u0 + qxc * t0;\n            const xb = qxa * u1 + qxc * t1;\n            const xc = qxb * u0 + qxd * t0;\n            const xd = qxb * u1 + qxd * t1;\n\n            // const ya = qya * u0 + qyc * t0;\n            const yb = qya * u1 + qyc * t1;\n            const yc = qyb * u0 + qyd * t0;\n            const yd = qyb * u1 + qyd * t1;\n\n            return [xb, yb, xc, yc, xd, yd];\n        }\n\n        //from http://www.antigrain.com/research/bezier_interpolation/\n        function getCubicControlPoints(x0, y0, x1, y1, x2, y2, x3, y3, smoothValue, t) {\n            // Assume we need to calculate the control\n            // points between (x1,y1) and (x2,y2).\n            // Then x0,y0 - the previous vertex,\n            //      x3,y3 - the next one.\n            const xc1 = (x0 + x1) / 2.0, yc1 = (y0 + y1) / 2.0;\n            const xc2 = (x1 + x2) / 2.0, yc2 = (y1 + y2) / 2.0;\n            const xc3 = (x2 + x3) / 2.0, yc3 = (y2 + y3) / 2.0;\n\n            const len1 = Math.sqrt((x1 - x0) * (x1 - x0) + (y1 - y0) * (y1 - y0));\n            const len2 = Math.sqrt((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1));\n            const len3 = Math.sqrt((x3 - x2) * (x3 - x2) + (y3 - y2) * (y3 - y2));\n\n            const k1 = len1 / (len1 + len2);\n            const k2 = len2 / (len2 + len3);\n\n            const xm1 = xc1 + (xc2 - xc1) * k1, ym1 = yc1 + (yc2 - yc1) * k1;\n\n            const xm2 = xc2 + (xc3 - xc2) * k2, ym2 = yc2 + (yc3 - yc2) * k2;\n\n            // Resulting control points. Here smoothValue is mentioned\n            // above coefficient K whose value should be in range [0...1].\n            const ctrl1X = xm1 + (xc2 - xm1) * smoothValue + x1 - xm1,\n                ctrl1Y = ym1 + (yc2 - ym1) * smoothValue + y1 - ym1,\n\n                ctrl2X = xm2 + (xc2 - xm2) * smoothValue + x2 - xm2,\n                ctrl2Y = ym2 + (yc2 - ym2) * smoothValue + y2 - ym2;\n\n            const ctrlPoints = [ctrl1X, ctrl1Y, ctrl2X, ctrl2Y];\n            if (t < 1) {\n                return interpolate(0, t, x1, y1, ctrl1X, ctrl1Y, ctrl2X, ctrl2Y, x2, y2);\n            } else {\n                return ctrlPoints;\n            }\n        }\n        let count = points.length;\n        let l = close ? count : count - 1;\n\n        ctx.beginPath();\n        ctx.moveTo(points[0].x, points[0].y);\n        if (tailRatio !== undefined) l -= Math.max(l - tailIdx - 1, 0);\n        let preCtrlPoints;\n        for (let i = 0; i < l; i++) {\n            const x1 = points[i].x, y1 = points[i].y;\n\n            let x0, y0, x2, y2, x3, y3;\n            if (i - 1 < 0) {\n                if (!close) {\n                    x0 = points[i + 1].x;\n                    y0 = points[i + 1].y;\n                } else {\n                    x0 = points[l - 1].x;\n                    y0 = points[l - 1].y;\n                }\n            } else {\n                x0 = points[i - 1].x;\n                y0 = points[i - 1].y;\n            }\n            if (i + 1 < count) {\n                x2 = points[i + 1].x;\n                y2 = points[i + 1].y;\n            } else {\n                x2 = points[i + 1 - count].x;\n                y2 = points[i + 1 - count].y;\n            }\n            if (i + 2 < count) {\n                x3 = points[i + 2].x;\n                y3 = points[i + 2].y;\n            } else if (!close) {\n                x3 = points[i].x;\n                y3 = points[i].y;\n            } else {\n                x3 = points[i + 2 - count].x;\n                y3 = points[i + 2 - count].y;\n            }\n\n            const ctrlPoints = getCubicControlPoints(x0, y0, x1, y1, x2, y2, x3, y3, smoothValue, i === l - 1 ? tailRatio : 1);\n            if (i === l - 1 && tailRatio >= 0 && tailRatio < 1) {\n                ctx.bezierCurveTo(ctrlPoints[0], ctrlPoints[1], ctrlPoints[2], ctrlPoints[3], ctrlPoints[4], ctrlPoints[5]);\n                points.splice(l - 1, count - (l - 1) - 1);\n                const lastPoint = new Point(ctrlPoints[4], ctrlPoints[5]);\n                lastPoint.prevCtrlPoint = new Point(ctrlPoints[2], ctrlPoints[3]);\n                points.push(lastPoint);\n                count = points.length;\n            } else {\n                ctx.bezierCurveTo(ctrlPoints[0], ctrlPoints[1], ctrlPoints[2], ctrlPoints[3], x2, y2);\n            }\n            points[i].nextCtrlPoint = ctrlPoints.slice(0, 2);\n            points[i].prevCtrlPoint = preCtrlPoints ? preCtrlPoints.slice(2) : null;\n            preCtrlPoints = ctrlPoints;\n        }\n        if (!close && points[1].prevCtrlPoint) {\n            points[0].nextCtrlPoint = points[1].prevCtrlPoint;\n            delete points[0].prevCtrlPoint;\n        }\n        if (!points[count - 1].prevCtrlPoint) {\n            points[count - 1].prevCtrlPoint = points[count - 2].nextCtrlPoint;\n        }\n        Canvas._stroke(ctx, lineOpacity);\n    },\n\n    /**\n     * draw an arc from p1 to p2 with degree of (p1, center) and (p2, center)\n     * @param  {Context} ctx    canvas context\n     * @param  {Point} p1      point 1\n     * @param  {Point} p2      point 2\n     * @param  {Number} degree arc degree between p1 and p2\n     */\n    _arcBetween(ctx, p1, p2, degree) {\n        const a = degree,\n            dist = p1.distanceTo(p2),\n            //radius of circle\n            r = dist / 2 / Math.sin(a / 2);\n        //angle between p1 and p2\n        let p1p2 = Math.asin((p2.y - p1.y) / dist);\n        if (p1.x > p2.x) {\n            p1p2 = Math.PI - p1p2;\n        }\n        //angle between circle center and p2\n        const cp2 = 90 * Math.PI / 180 - a / 2,\n            da = p1p2 - cp2;\n\n        const dx = Math.cos(da) * r,\n            dy = Math.sin(da) * r,\n            cx = p1.x + dx,\n            cy = p1.y + dy;\n\n        let startAngle = Math.asin((p2.y - cy) / r);\n        if (cx > p2.x) {\n            startAngle = Math.PI - startAngle;\n        }\n        const endAngle = startAngle + a;\n\n        ctx.beginPath();\n        ctx.arc(cx, cy, r, startAngle, endAngle);\n        return [cx, cy];\n    },\n\n    _lineTo(ctx, p) {\n        ctx.lineTo(p.x, p.y);\n    },\n\n    bezierCurveAndFill(ctx, points, lineOpacity, fillOpacity) {\n        ctx.beginPath();\n        const start = points[0];\n        ctx.moveTo(start.x, start.y);\n        const args = [ctx];\n        args.push.apply(args, points.splice(1));\n        Canvas._bezierCurveTo.apply(Canvas, args);\n        Canvas.fillCanvas(ctx, fillOpacity);\n        Canvas._stroke(ctx, lineOpacity);\n    },\n\n    _bezierCurveTo(ctx, p1, p2, p3) {\n        ctx.bezierCurveTo(p1.x, p1.y, p2.x, p2.y, p3.x, p3.y);\n    },\n\n\n    //各种图形的绘制方法\n    ellipse(ctx, pt, width, height, lineOpacity, fillOpacity) {\n        function bezierEllipse(x, y, a, b) {\n            const k = 0.5522848,\n                ox = a * k,\n                oy = b * k;\n            ctx.moveTo(x - a, y);\n            ctx.bezierCurveTo(x - a, y - oy, x - ox, y - b, x, y - b);\n            ctx.bezierCurveTo(x + ox, y - b, x + a, y - oy, x + a, y);\n            ctx.bezierCurveTo(x + a, y + oy, x + ox, y + b, x, y + b);\n            ctx.bezierCurveTo(x - ox, y + b, x - a, y + oy, x - a, y);\n            ctx.closePath();\n        }\n        ctx.beginPath();\n        if (width === height) {\n            ctx.arc(pt.x, pt.y, width, 0, 2 * Math.PI);\n        } else if (ctx.ellipse) {\n            ctx.ellipse(pt.x, pt.y, width, height, 0, 0, Math.PI / 180 * 360);\n        } else {\n            // IE\n            bezierEllipse(pt.x, pt.y, width, height);\n        }\n        Canvas.fillCanvas(ctx, fillOpacity, pt.x - width, pt.y - height);\n        Canvas._stroke(ctx, lineOpacity, pt.x - width, pt.y - height);\n    },\n\n    rectangle(ctx, x, y, size, lineOpacity, fillOpacity) {\n        // pt = pt._round();\n        ctx.beginPath();\n        ctx.rect(x, y, size['width'], size['height']);\n        Canvas.fillCanvas(ctx, fillOpacity, x, y);\n        Canvas._stroke(ctx, lineOpacity, x, y);\n    },\n\n    sector(ctx, pt, size, angles, lineOpacity, fillOpacity) {\n        const rad = Math.PI / 180;\n        const startAngle = angles[0],\n            endAngle = angles[1];\n\n        function sector(ctx, x, y, radius, startAngle, endAngle) {\n            const sDeg = rad * -endAngle;\n            const eDeg = rad * -startAngle;\n            ctx.beginPath();\n            ctx.moveTo(x, y);\n            ctx.arc(x, y, radius, sDeg, eDeg);\n            ctx.lineTo(x, y);\n            Canvas.fillCanvas(ctx, fillOpacity, x - radius, y - radius);\n            Canvas._stroke(ctx, lineOpacity, x - radius, y - radius);\n        }\n        sector(ctx, pt.x, pt.y, size, startAngle, endAngle);\n    },\n\n    _isPattern(style) {\n        return !isString(style) && !('addColorStop' in style);\n    },\n\n    drawCross(ctx, x, y, lineWidth, color) {\n        ctx.canvas._drawn = true;\n        ctx.strokeStyle = color;\n        ctx.lineWidth = lineWidth;\n        ctx.beginPath();\n        ctx.moveTo(x - 5, y);\n        ctx.lineTo(x + 5, y);\n        ctx.moveTo(x, y - 5);\n        ctx.lineTo(x, y + 5);\n        ctx.stroke();\n    },\n\n    copy(canvas, c) {\n        const target = c || createEl('canvas');\n        target.width = canvas.width;\n        target.height = canvas.height;\n        target.getContext('2d').drawImage(canvas, 0, 0);\n        return target;\n    }\n};\n\nexport default Canvas;\n\n\n/* istanbul ignore next */\nfunction drawDashLine(ctx, startPoint, endPoint, dashArray) {\n    //https://davidowens.wordpress.com/2010/09/07/html-5-canvas-and-dashed-lines/\n    //\n    // Our growth rate for our line can be one of the following:\n    //   (+,+), (+,-), (-,+), (-,-)\n    // Because of this, our algorithm needs to understand if the x-coord and\n    // y-coord should be getting smaller or larger and properly cap the values\n    // based on (x,y).\n    const fromX = startPoint.x,\n        fromY = startPoint.y,\n        toX = endPoint.x,\n        toY = endPoint.y;\n    const pattern = dashArray;\n    const lt = function (a, b) {\n        return a <= b;\n    };\n    const gt = function (a, b) {\n        return a >= b;\n    };\n    const capmin = function (a, b) {\n        return Math.min(a, b);\n    };\n    const capmax = function (a, b) {\n        return Math.max(a, b);\n    };\n\n    const checkX = {\n        thereYet: gt,\n        cap: capmin\n    };\n    const checkY = {\n        thereYet: gt,\n        cap: capmin\n    };\n\n    if (fromY - toY > 0) {\n        checkY.thereYet = lt;\n        checkY.cap = capmax;\n    }\n    if (fromX - toX > 0) {\n        checkX.thereYet = lt;\n        checkX.cap = capmax;\n    }\n\n    ctx.moveTo(fromX, fromY);\n    let offsetX = fromX;\n    let offsetY = fromY;\n    let idx = 0,\n        dash = true;\n    let ang, len;\n    while (!(checkX.thereYet(offsetX, toX) && checkY.thereYet(offsetY, toY))) {\n        ang = Math.atan2(toY - fromY, toX - fromX);\n        len = pattern[idx];\n\n        offsetX = checkX.cap(toX, offsetX + (Math.cos(ang) * len));\n        offsetY = checkY.cap(toY, offsetY + (Math.sin(ang) * len));\n\n        if (dash) {\n            ctx.lineTo(offsetX, offsetY);\n        } else {\n            ctx.moveTo(offsetX, offsetY);\n        }\n\n        idx = (idx + 1) % pattern.length;\n        dash = !dash;\n    }\n}\n\nconst prefix = 'data:image/';\nfunction isImageUrl(url) {\n    return url.length > prefix.length && url.substring(0, prefix.length) === prefix || isCssUrl(url);\n}\n\nfunction extractImageUrl(url) {\n    if (url.substring(0, prefix.length) === prefix) {\n        return url;\n    }\n    return extractCssUrl(url);\n}\n\nfunction copyProperties(ctx, savedCtx) {\n    ctx.filter = savedCtx.filter;\n    ctx.fillStyle = savedCtx.fillStyle;\n    ctx.globalAlpha = savedCtx.globalAlpha;\n    ctx.lineCap = savedCtx.lineCap;\n    ctx.lineDashOffset = savedCtx.lineDashOffset;\n    ctx.lineJoin = savedCtx.lineJoin;\n    ctx.lineWidth = savedCtx.lineWidth;\n    ctx.shadowBlur = savedCtx.shadowBlur;\n    ctx.shadowColor = savedCtx.shadowColor;\n    ctx.shadowOffsetX = savedCtx.shadowOffsetX;\n    ctx.shadowOffsetY = savedCtx.shadowOffsetY;\n    ctx.strokeStyle = savedCtx.strokeStyle;\n}\n","!function(i){\"use strict\";var c,s,u=\"fulfilled\",f=\"undefined\",a=function(){var e=[],n=0;function o(){for(;e.length-n;){try{e[n]()}catch(t){i.console&&i.console.error(t)}e[n++]=s,1024==n&&(e.splice(0,1024),n=0)}}var r=function(){if(typeof MutationObserver===f)return typeof process!==f&&\"function\"==typeof process.nextTick?function(){process.nextTick(o)}:typeof setImmediate!==f?function(){setImmediate(o)}:function(){setTimeout(o,0)};var t=document.createElement(\"div\");return new MutationObserver(o).observe(t,{attributes:!0}),function(){t.setAttribute(\"a\",0)}}();return function(t){e.push(t),e.length-n==1&&r()}}();function l(t){if(!(this instanceof l))throw new TypeError(\"Zousan must be created with the new keyword\");if(\"function\"==typeof t){var e=this;try{t(function(t){e.resolve(t)},function(t){e.reject(t)})}catch(t){e.reject(t)}}else if(0<arguments.length)throw new TypeError(\"Zousan resolver \"+t+\" is not a function\")}function h(e,t){if(\"function\"==typeof e.y)try{var n=e.y.call(s,t);e.p.resolve(n)}catch(t){e.p.reject(t)}else e.p.resolve(t)}function v(e,t){if(\"function\"==typeof e.n)try{var n=e.n.call(s,t);e.p.resolve(n)}catch(t){e.p.reject(t)}else e.p.reject(t)}l.prototype={resolve:function(n){if(this.state===c){if(n===this)return this.reject(new TypeError(\"Attempt to resolve promise with self\"));var o=this;if(n&&(\"function\"==typeof n||\"object\"==typeof n))try{var e=!0,t=n.then;if(\"function\"==typeof t)return void t.call(n,function(t){e&&(e=!1,o.resolve(t))},function(t){e&&(e=!1,o.reject(t))})}catch(t){return void(e&&this.reject(t))}this.state=u,this.v=n,o.c&&a(function(){for(var t=0,e=o.c.length;t<e;t++)h(o.c[t],n)})}},reject:function(n){if(this.state===c){var t=this;this.state=\"rejected\",this.v=n;var o=this.c;a(o?function(){for(var t=0,e=o.length;t<e;t++)v(o[t],n)}:function(){t.handled||!l.suppressUncaughtRejectionError&&i.console&&l.warn(\"You upset Zousan. Please catch rejections: \",n,n?n.stack:null)})}},then:function(t,e){var n=new l,o={y:t,n:e,p:n};if(this.state===c)this.c?this.c.push(o):this.c=[o];else{var r=this.state,i=this.v;this.handled=!0,a(function(){r===u?h(o,i):v(o,i)})}return n},catch:function(t){return this.then(null,t)},finally:function(t){return this.then(t,t)},timeout:function(t,o){o=o||\"Timeout\";var r=this;return new l(function(e,n){setTimeout(function(){n(Error(o))},t),r.then(function(t){e(t)},function(t){n(t)})})}},l.resolve=function(t){var e=new l;return e.resolve(t),e},l.reject=function(t){var e=new l;return e.c=[],e.reject(t),e},l.all=function(n){var o=[],r=0,i=new l;function t(t,e){t&&\"function\"==typeof t.then||(t=l.resolve(t)),t.then(function(t){o[e]=t,++r==n.length&&i.resolve(o)},function(t){i.reject(t)})}for(var e=0;e<n.length;e++)t(n[e],e);return n.length||i.resolve(o),i},l.warn=console.warn,typeof module!=f&&module.exports&&(module.exports=l),i.define&&i.define.amd&&i.define([],function(){return l}),(i.Zousan=l).soon=a}(\"undefined\"!=typeof global?global:this);","import Zousan from 'zousan';\n\nlet promise;\n\nif (typeof Promise !== 'undefined') {\n    // built-in Promise\n    promise = Promise;\n} else {\n    promise = Zousan;\n}\n\nexport default promise;\n","import { extend, isString, isNil } from './util';\nimport { stopPropagation } from './util/dom';\n/**\n * This provides methods used for event handling. It's a mixin and not meant to be used directly.\n * @mixin Eventable\n */\n\nconst Eventable = Base =>\n\n    class extends Base {\n        /**\n         * Register a handler function to be called whenever this event is fired.\n         *\n         * @param {String} eventsOn                  - event types to register, seperated by space if more than one.\n         * @param {Function} handler                 - handler function to be called\n         * @param {Object} [context=null]            - the context of the handler\n         * @return {Any} this\n         * @function Eventable.on\n         * @example\n         * foo.on('mousedown mousemove mouseup', onMouseEvent, foo);\n         */\n        on(eventsOn, handler, context) {\n            if (!eventsOn) {\n                return this;\n            }\n            if (!isString(eventsOn)) {\n                return this._switch('on', eventsOn, handler);\n            }\n            if (!handler) {\n                return this;\n            }\n            if (!this._eventMap) {\n                this._eventMap = {};\n            }\n            const eventTypes = eventsOn.toLowerCase().split(' ');\n            let evtType;\n            if (!context) {\n                context = this;\n            }\n            let handlerChain;\n            for (let ii = 0, ll = eventTypes.length; ii < ll; ii++) {\n                evtType = eventTypes[ii];\n                handlerChain = this._eventMap[evtType];\n                if (!handlerChain) {\n                    handlerChain = [];\n                    this._eventMap[evtType] = handlerChain;\n                }\n                const l = handlerChain.length;\n                if (l > 0) {\n                    for (let i = 0; i < l; i++) {\n                        if (handler === handlerChain[i].handler && handlerChain[i].context === context) {\n                            return this;\n                        }\n                    }\n                }\n                handlerChain.push({\n                    handler: handler,\n                    context: context\n                });\n            }\n            return this;\n        }\n\n        /**\n         * Alias for [on]{@link Eventable.on}\n         *\n         * @param {String} eventTypes     - event types to register, seperated by space if more than one.\n         * @param {Function} handler                 - handler function to be called\n         * @param {Object} [context=null]            - the context of the handler\n         * @return {} this\n         * @function Eventable.addEventListener\n         */\n        addEventListener() {\n            return this.on.apply(this, arguments);\n        }\n\n        /**\n         * Same as on, except the listener will only get fired once and then removed.\n         *\n         * @param {String} eventTypes                - event types to register, seperated by space if more than one.\n         * @param {Function} handler                 - listener handler\n         * @param {Object} [context=null]            - the context of the handler\n         * @return {} this\n         * @example\n         * foo.once('mousedown mousemove mouseup', onMouseEvent, foo);\n         * @function Eventable.once\n         */\n        once(eventTypes, handler, context) {\n            if (!isString(eventTypes)) {\n                const once = {};\n                for (const p in eventTypes) {\n                    if (eventTypes.hasOwnProperty(p)) {\n                        once[p] = this._wrapOnceHandler(p, eventTypes[p], context);\n                    }\n                }\n                return this._switch('on', once);\n            }\n            const evetTypes = eventTypes.split(' ');\n            for (let i = 0, l = evetTypes.length; i < l; i++) {\n                this.on(evetTypes[i], this._wrapOnceHandler(evetTypes[i], handler, context));\n            }\n            return this;\n        }\n\n        /**\n         * Unregister the event handler for the specified event types.\n         *\n         * @param {String} eventsOff                - event types to unregister, seperated by space if more than one.\n         * @param {Function} handler                - listener handler\n         * @param {Object} [context=null]           - the context of the handler\n         * @return {} this\n         * @example\n         * foo.off('mousedown mousemove mouseup', onMouseEvent, foo);\n         * @function Eventable.off\n         */\n        off(eventsOff, handler, context) {\n            if (!this._eventMap || !eventsOff) {\n                return this;\n            }\n            if (!isString(eventsOff)) {\n                return this._switch('off', eventsOff, handler);\n            }\n            if (!handler) {\n                return this;\n            }\n            const eventTypes = eventsOff.split(' ');\n            let eventType, listeners, wrapKey;\n            if (!context) {\n                context = this;\n            }\n            for (let j = 0, jl = eventTypes.length; j < jl; j++) {\n                eventType = eventTypes[j].toLowerCase();\n                wrapKey = 'Z__' + eventType;\n                listeners = this._eventMap[eventType];\n                if (!listeners) {\n                    return this;\n                }\n                for (let i = listeners.length - 1; i >= 0; i--) {\n                    const listener = listeners[i];\n                    if ((handler === listener.handler || handler === listener.handler[wrapKey]) && listener.context === context) {\n                        delete listener.handler[wrapKey];\n                        listeners.splice(i, 1);\n                    }\n                }\n                if (!listeners.length) {\n                    delete this._eventMap[eventType];\n                }\n            }\n            return this;\n        }\n\n        /**\n         * Alias for [off]{@link Eventable.off}\n         *\n         * @param {String} eventTypes    - event types to unregister, seperated by space if more than one.\n         * @param {Function} handler                - listener handler\n         * @param {Object} [context=null]           - the context of the handler\n         * @return {} this\n         * @function Eventable.removeEventListener\n         */\n        removeEventListener() {\n            return this.off.apply(this, arguments);\n        }\n\n        /**\n         * Returns listener's count registered for the event type.\n         *\n         * @param {String} eventType        - an event type\n         * @param {Function} [hanlder=null] - listener function\n         * @param {Object} [context=null]   - the context of the handler\n         * @return {Number}\n         * @function Eventable.listens\n         */\n        listens(eventType, handler, context) {\n            if (!this._eventMap || !isString(eventType)) {\n                return 0;\n            }\n            const handlerChain = this._eventMap[eventType.toLowerCase()];\n            if (!handlerChain || !handlerChain.length) {\n                return 0;\n            }\n            if (!handler) {\n                return handlerChain.length;\n            }\n            for (let i = 0, len = handlerChain.length; i < len; i++) {\n                if (handler === handlerChain[i].handler &&\n                    (isNil(context) || handlerChain[i].context === context)) {\n                    return 1;\n                }\n            }\n            return 0;\n        }\n\n        /**\n         * Get all the listening event types\n         *\n         * @returns {String[]} events\n         */\n        getListeningEvents() {\n            if (!this._eventMap) {\n                return [];\n            }\n            return Object.keys(this._eventMap);\n        }\n\n        /**\n         * Copy all the event listener to the target object\n         * @param {Object} target - target object to copy to.\n         * @return {} this\n         * @function Eventable.copyEventListeners\n         */\n        copyEventListeners(target) {\n            const eventMap = target._eventMap;\n            if (!eventMap) {\n                return this;\n            }\n            let handlerChain;\n            for (const eventType in eventMap) {\n                handlerChain = eventMap[eventType];\n                for (let i = 0, len = handlerChain.length; i < len; i++) {\n                    this.on(eventType, handlerChain[i].handler, handlerChain[i].context);\n                }\n            }\n            return this;\n        }\n\n        /**\n         * Fire an event, causing all handlers for that event name to run.\n         *\n         * @param  {String} eventType - an event type to fire\n         * @param  {Object} param     - parameters for the listener function.\n         * @return {} this\n         * @function Eventable.fire\n         */\n        fire() {\n            if (this._eventParent) {\n                return this._eventParent.fire.apply(this._eventParent, arguments);\n            }\n            return this._fire.apply(this, arguments);\n        }\n\n        _wrapOnceHandler(evtType, handler, context) {\n            const me = this;\n            const key = 'Z__' + evtType;\n            let called = false;\n            const fn = function onceHandler() {\n                if (called) {\n                    return;\n                }\n                delete fn[key];\n                called = true;\n                if (context) {\n                    handler.apply(context, arguments);\n                } else {\n                    handler.apply(this, arguments);\n                }\n                me.off(evtType, onceHandler, this);\n            };\n            fn[key] = handler;\n            return fn;\n        }\n\n        _switch(to, eventKeys, context) {\n            for (const p in eventKeys) {\n                if (eventKeys.hasOwnProperty(p)) {\n                    this[to](p, eventKeys[p], context);\n                }\n            }\n            return this;\n        }\n\n        _clearListeners(eventType) {\n            if (!this._eventMap || !isString(eventType)) {\n                return;\n            }\n            const handlerChain = this._eventMap[eventType.toLowerCase()];\n            if (!handlerChain) {\n                return;\n            }\n            this._eventMap[eventType] = null;\n        }\n\n        _clearAllListeners() {\n            this._eventMap = null;\n        }\n\n        /**\n         * Set a event parent to handle all the events\n         * @param {Any} parent - event parent\n         * @return {Any} this\n         * @private\n         * @function Eventable._setEventParent\n         */\n        _setEventParent(parent) {\n            this._eventParent = parent;\n            return this;\n        }\n\n        _fire(eventType, param) {\n            if (!this._eventMap) {\n                return this;\n            }\n            const handlerChain = this._eventMap[eventType.toLowerCase()];\n            if (!handlerChain) {\n                return this;\n            }\n            if (!param) {\n                param = {};\n            }\n            param['type'] = eventType;\n            param['target'] = this;\n            //in case of deleting a listener in a execution, copy the handlerChain to execute.\n            const queue = handlerChain.slice(0);\n            let context, bubble, passed;\n            for (let i = 0, len = queue.length; i < len; i++) {\n                if (!queue[i]) {\n                    continue;\n                }\n                context = queue[i].context;\n                bubble = true;\n                passed = extend({}, param);\n                if (context) {\n                    bubble = queue[i].handler.call(context, passed);\n                } else {\n                    bubble = queue[i].handler(passed);\n                }\n                //stops the event propagation if the handler returns false.\n                if (bubble === false) {\n                    if (param['domEvent']) {\n                        stopPropagation(param['domEvent']);\n                    }\n                }\n            }\n            return this;\n        }\n    };\n\nexport default Eventable;\n","import Eventable from '../core/Eventable';\n\n/**\n * Base class for all the interaction handlers\n * @category handler\n * @abstract\n * @protected\n */\nclass Handler {\n    constructor(target) {\n        this.target = target;\n    }\n\n    /**\n     * Enables the handler\n     * @return {Handler} this\n     */\n    enable() {\n        if (this._enabled) {\n            return this;\n        }\n        this._enabled = true;\n        this.addHooks();\n        return this;\n    }\n\n    /**\n     * Disablesthe handler\n     * @return {Handler} this\n     */\n    disable() {\n        if (!this._enabled) {\n            return this;\n        }\n        this._enabled = false;\n        this.removeHooks();\n        return this;\n    }\n\n    /**\n     * Returns true if the handler is enabled.\n     * @return {Boolean}\n     */\n    enabled() {\n        return !!this._enabled;\n    }\n\n    remove() {\n        this.disable();\n        delete this.target;\n        delete this.dom;\n    }\n}\n\n\nexport default Eventable(Handler);\n","import { extend } from './util/common';\nimport Handler from '../handler/Handler';\n\n/**\n * This library uses ES2015 class system. <br />\n * Class is the root class of class hierachy. <br />\n * It provides utility methods to make it easier to manage configration options, merge mixins and add init hooks.\n * @example\n * var defaultOptions = {\n *     'foo' : 'bar'\n * };\n * class Foo extends maptalks.Class {\n *     constructor(id, options) {\n *         super(options);\n *         this.setId(id);\n *     }\n *\n *     setId(id) {\n *         this.id = id;\n *     }\n *\n *     whenCreated() {\n *         // .....\n *     }\n * }\n *\n * Foo.mergeOptions(defaultOptions);\n *\n * Foo.addInitHook('whenCreated');\n * @category core\n * @abstract\n */\nclass Class {\n\n    /**\n     * Create an object, set options if given and call all the init hooks.<br />\n     * Options is where the object manages its configuration. Options passed to the object will be merged with parent's instead of overriding it.\n     *\n     * @param  {Object} options - options to set\n     */\n    constructor(options) {\n        if (!this || !this.setOptions) {\n            throw new Error('Class instance is being created without \"new\" operator.');\n        }\n        this.setOptions(options);\n        this.callInitHooks();\n    }\n\n    /**\n     * Visit and call all the init hooks defined on Class and its parents.\n     * @return {Class} this\n     */\n    callInitHooks() {\n        const proto = Object.getPrototypeOf(this);\n        this._visitInitHooks(proto);\n        return this;\n    }\n\n    /**\n     * Merges options with the default options of the object.\n     * @param {Object} options - options to set\n     * @return {Class} this\n     */\n    setOptions(options) {\n        if (!this.hasOwnProperty('options')) {\n            this.options = this.options ? Object.create(this.options) : {};\n        }\n        if (!options) {\n            return this;\n        }\n        for (const i in options) {\n            this.options[i] = options[i];\n        }\n        return this;\n    }\n\n    /**\n     * 1. Return object's options if no parameter is provided. <br/>\n     *\n     * 2. update an option and enable/disable the handler if a handler with the same name existed.\n     * @example\n     * // Get marker's options;\n     * var options = marker.config();\n     * // Set map's option \"draggable\" to false and disable map's draggable handler.\n     * map.config('draggable', false);\n     * // You can update more than one options like this:\n     * map.config({\n     *     'scrollWheelZoom' : false,\n     *     'doubleClickZoom' : false\n     * });\n     * @param  {Object} conf - config to update\n     * @return {Class} this\n     */\n    config(conf) {\n        if (!conf) {\n            const config = {};\n            for (const p in this.options) {\n                if (this.options.hasOwnProperty(p)) {\n                    config[p] = this.options[p];\n                }\n            }\n            return config;\n        } else {\n            if (arguments.length === 2) {\n                const t = {};\n                t[conf] = arguments[1];\n                conf = t;\n            }\n            for (const i in conf) {\n                this.options[i] = conf[i];\n                // enable/disable handler\n                if (this[i] && (this[i] instanceof Handler)) {\n                    if (conf[i]) {\n                        this[i].enable();\n                    } else {\n                        this[i].disable();\n                    }\n                }\n            }\n            // callback when set config\n            this.onConfig(conf);\n        }\n        return this;\n    }\n\n    /**\n     * Default callback when config is called\n     */\n    onConfig(/*conf*/) {\n\n    }\n\n    _visitInitHooks(proto) {\n        if (this._initHooksCalled) {\n            return;\n        }\n        const parentProto = Object.getPrototypeOf(proto);\n        if (parentProto._visitInitHooks) {\n            parentProto._visitInitHooks.call(this, parentProto);\n        }\n        this._initHooksCalled = true;\n        const hooks = proto._initHooks;\n        if (hooks && hooks !== parentProto._initHooks) {\n            for (let i = 0; i < hooks.length; i++) {\n                hooks[i].call(this);\n            }\n        }\n    }\n\n    /**\n     * Add an init hook, which will be called when the object is initiated. <br>\n     * It is useful in plugin developing to do things when creating objects without changing class's constructor.\n     * @param {String|Function} fn - a hook function or name of the hook function\n     * @param {Any[]} args         - arguments for the init hook function\n     */\n    static addInitHook(fn, ...args) {\n        const init = typeof fn === 'function' ? fn : function () {\n            this[fn].apply(this, args);\n        };\n        const proto = this.prototype;\n        const parentProto = Object.getPrototypeOf(proto);\n        if (!proto._initHooks || proto._initHooks === parentProto._initHooks) {\n            proto._initHooks = [];\n        }\n        proto._initHooks.push(init);\n        return this;\n    }\n\n    /**\n     * Mixin the specified objects into the class as prototype properties or methods.\n     * @param  {...Object} sources - objects to mixin\n     */\n    static include(...sources) {\n        for (let i = 0; i < sources.length; i++) {\n            extend(this.prototype, sources[i]);\n        }\n        return this;\n    }\n\n    /**\n     * Mixin options with the class's default options. <br />\n     * @param  {Object} options - options to merge.\n     */\n    static mergeOptions(options) {\n        const proto = this.prototype;\n        const parentProto = Object.getPrototypeOf(proto);\n        if (!proto.options || proto.options === parentProto.options) {\n            proto.options = proto.options ? Object.create(proto.options) : {};\n        }\n        extend(proto.options, options);\n        return this;\n    }\n}\n\nexport default Class;\n","\nconst registeredTypes = {};\n\n/**\n * A helper mixin for JSON serialization.\n * @mixin JSONAble\n */\nexport default Base =>\n    class extends Base {\n        /**\n         * It is a static method. <br>\n         * Register layer for JSON serialization and assign a JSON type.\n         * @param  {String} type - JSON type\n         * @function JSONAble.registerJSONType\n         */\n        static registerJSONType(type) {\n            if (!type) {\n                return this;\n            }\n            registeredTypes[type] = this;\n            return this;\n        }\n\n        /**\n         * It is a static method. <br>\n         * Get class of input JSON type\n         * @param  {String} type - JSON type\n         * @return {Class}      Class\n         * @function JSONAble.getJSONClass\n         */\n        static getJSONClass(type) {\n            if (!type) {\n                return null;\n            }\n            return registeredTypes[type];\n        }\n\n        /**\n         * Get object's JSON Type\n         * @return {String}\n         * @function JSONAble.getJSONType\n         */\n        getJSONType() {\n            if (this._jsonType === undefined) {\n                const clazz = Object.getPrototypeOf(this).constructor;\n                for (const p in registeredTypes) {\n                    if (registeredTypes[p] === clazz) {\n                        this._jsonType = p;\n                        break;\n                    }\n                }\n            }\n            if (!this._jsonType) {\n                throw new Error('Found an unregistered geometry class!');\n            }\n            return this._jsonType;\n        }\n    };\n","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.quickselect = factory());\n}(this, (function () { 'use strict';\n\nfunction quickselect(arr, k, left, right, compare) {\n    quickselectStep(arr, k, left || 0, right || (arr.length - 1), compare || defaultCompare);\n}\n\nfunction quickselectStep(arr, k, left, right, compare) {\n\n    while (right > left) {\n        if (right - left > 600) {\n            var n = right - left + 1;\n            var m = k - left + 1;\n            var z = Math.log(n);\n            var s = 0.5 * Math.exp(2 * z / 3);\n            var sd = 0.5 * Math.sqrt(z * s * (n - s) / n) * (m - n / 2 < 0 ? -1 : 1);\n            var newLeft = Math.max(left, Math.floor(k - m * s / n + sd));\n            var newRight = Math.min(right, Math.floor(k + (n - m) * s / n + sd));\n            quickselectStep(arr, k, newLeft, newRight, compare);\n        }\n\n        var t = arr[k];\n        var i = left;\n        var j = right;\n\n        swap(arr, left, k);\n        if (compare(arr[right], t) > 0) swap(arr, left, right);\n\n        while (i < j) {\n            swap(arr, i, j);\n            i++;\n            j--;\n            while (compare(arr[i], t) < 0) i++;\n            while (compare(arr[j], t) > 0) j--;\n        }\n\n        if (compare(arr[left], t) === 0) swap(arr, left, j);\n        else {\n            j++;\n            swap(arr, j, right);\n        }\n\n        if (j <= k) left = j + 1;\n        if (k <= j) right = j - 1;\n    }\n}\n\nfunction swap(arr, i, j) {\n    var tmp = arr[i];\n    arr[i] = arr[j];\n    arr[j] = tmp;\n}\n\nfunction defaultCompare(a, b) {\n    return a < b ? -1 : a > b ? 1 : 0;\n}\n\nreturn quickselect;\n\n})));\n","'use strict';\n\nmodule.exports = rbush;\nmodule.exports.default = rbush;\n\nvar quickselect = require('quickselect');\n\nfunction rbush(maxEntries, format) {\n    if (!(this instanceof rbush)) return new rbush(maxEntries, format);\n\n    // max entries in a node is 9 by default; min node fill is 40% for best performance\n    this._maxEntries = Math.max(4, maxEntries || 9);\n    this._minEntries = Math.max(2, Math.ceil(this._maxEntries * 0.4));\n\n    if (format) {\n        this._initFormat(format);\n    }\n\n    this.clear();\n}\n\nrbush.prototype = {\n\n    all: function () {\n        return this._all(this.data, []);\n    },\n\n    search: function (bbox) {\n\n        var node = this.data,\n            result = [],\n            toBBox = this.toBBox;\n\n        if (!intersects(bbox, node)) return result;\n\n        var nodesToSearch = [],\n            i, len, child, childBBox;\n\n        while (node) {\n            for (i = 0, len = node.children.length; i < len; i++) {\n\n                child = node.children[i];\n                childBBox = node.leaf ? toBBox(child) : child;\n\n                if (intersects(bbox, childBBox)) {\n                    if (node.leaf) result.push(child);\n                    else if (contains(bbox, childBBox)) this._all(child, result);\n                    else nodesToSearch.push(child);\n                }\n            }\n            node = nodesToSearch.pop();\n        }\n\n        return result;\n    },\n\n    collides: function (bbox) {\n\n        var node = this.data,\n            toBBox = this.toBBox;\n\n        if (!intersects(bbox, node)) return false;\n\n        var nodesToSearch = [],\n            i, len, child, childBBox;\n\n        while (node) {\n            for (i = 0, len = node.children.length; i < len; i++) {\n\n                child = node.children[i];\n                childBBox = node.leaf ? toBBox(child) : child;\n\n                if (intersects(bbox, childBBox)) {\n                    if (node.leaf || contains(bbox, childBBox)) return true;\n                    nodesToSearch.push(child);\n                }\n            }\n            node = nodesToSearch.pop();\n        }\n\n        return false;\n    },\n\n    load: function (data) {\n        if (!(data && data.length)) return this;\n\n        if (data.length < this._minEntries) {\n            for (var i = 0, len = data.length; i < len; i++) {\n                this.insert(data[i]);\n            }\n            return this;\n        }\n\n        // recursively build the tree with the given data from scratch using OMT algorithm\n        var node = this._build(data.slice(), 0, data.length - 1, 0);\n\n        if (!this.data.children.length) {\n            // save as is if tree is empty\n            this.data = node;\n\n        } else if (this.data.height === node.height) {\n            // split root if trees have the same height\n            this._splitRoot(this.data, node);\n\n        } else {\n            if (this.data.height < node.height) {\n                // swap trees if inserted one is bigger\n                var tmpNode = this.data;\n                this.data = node;\n                node = tmpNode;\n            }\n\n            // insert the small tree into the large tree at appropriate level\n            this._insert(node, this.data.height - node.height - 1, true);\n        }\n\n        return this;\n    },\n\n    insert: function (item) {\n        if (item) this._insert(item, this.data.height - 1);\n        return this;\n    },\n\n    clear: function () {\n        this.data = createNode([]);\n        return this;\n    },\n\n    remove: function (item, equalsFn) {\n        if (!item) return this;\n\n        var node = this.data,\n            bbox = this.toBBox(item),\n            path = [],\n            indexes = [],\n            i, parent, index, goingUp;\n\n        // depth-first iterative tree traversal\n        while (node || path.length) {\n\n            if (!node) { // go up\n                node = path.pop();\n                parent = path[path.length - 1];\n                i = indexes.pop();\n                goingUp = true;\n            }\n\n            if (node.leaf) { // check current node\n                index = findItem(item, node.children, equalsFn);\n\n                if (index !== -1) {\n                    // item found, remove the item and condense tree upwards\n                    node.children.splice(index, 1);\n                    path.push(node);\n                    this._condense(path);\n                    return this;\n                }\n            }\n\n            if (!goingUp && !node.leaf && contains(node, bbox)) { // go down\n                path.push(node);\n                indexes.push(i);\n                i = 0;\n                parent = node;\n                node = node.children[0];\n\n            } else if (parent) { // go right\n                i++;\n                node = parent.children[i];\n                goingUp = false;\n\n            } else node = null; // nothing found\n        }\n\n        return this;\n    },\n\n    toBBox: function (item) { return item; },\n\n    compareMinX: compareNodeMinX,\n    compareMinY: compareNodeMinY,\n\n    toJSON: function () { return this.data; },\n\n    fromJSON: function (data) {\n        this.data = data;\n        return this;\n    },\n\n    _all: function (node, result) {\n        var nodesToSearch = [];\n        while (node) {\n            if (node.leaf) result.push.apply(result, node.children);\n            else nodesToSearch.push.apply(nodesToSearch, node.children);\n\n            node = nodesToSearch.pop();\n        }\n        return result;\n    },\n\n    _build: function (items, left, right, height) {\n\n        var N = right - left + 1,\n            M = this._maxEntries,\n            node;\n\n        if (N <= M) {\n            // reached leaf level; return leaf\n            node = createNode(items.slice(left, right + 1));\n            calcBBox(node, this.toBBox);\n            return node;\n        }\n\n        if (!height) {\n            // target height of the bulk-loaded tree\n            height = Math.ceil(Math.log(N) / Math.log(M));\n\n            // target number of root entries to maximize storage utilization\n            M = Math.ceil(N / Math.pow(M, height - 1));\n        }\n\n        node = createNode([]);\n        node.leaf = false;\n        node.height = height;\n\n        // split the items into M mostly square tiles\n\n        var N2 = Math.ceil(N / M),\n            N1 = N2 * Math.ceil(Math.sqrt(M)),\n            i, j, right2, right3;\n\n        multiSelect(items, left, right, N1, this.compareMinX);\n\n        for (i = left; i <= right; i += N1) {\n\n            right2 = Math.min(i + N1 - 1, right);\n\n            multiSelect(items, i, right2, N2, this.compareMinY);\n\n            for (j = i; j <= right2; j += N2) {\n\n                right3 = Math.min(j + N2 - 1, right2);\n\n                // pack each entry recursively\n                node.children.push(this._build(items, j, right3, height - 1));\n            }\n        }\n\n        calcBBox(node, this.toBBox);\n\n        return node;\n    },\n\n    _chooseSubtree: function (bbox, node, level, path) {\n\n        var i, len, child, targetNode, area, enlargement, minArea, minEnlargement;\n\n        while (true) {\n            path.push(node);\n\n            if (node.leaf || path.length - 1 === level) break;\n\n            minArea = minEnlargement = Infinity;\n\n            for (i = 0, len = node.children.length; i < len; i++) {\n                child = node.children[i];\n                area = bboxArea(child);\n                enlargement = enlargedArea(bbox, child) - area;\n\n                // choose entry with the least area enlargement\n                if (enlargement < minEnlargement) {\n                    minEnlargement = enlargement;\n                    minArea = area < minArea ? area : minArea;\n                    targetNode = child;\n\n                } else if (enlargement === minEnlargement) {\n                    // otherwise choose one with the smallest area\n                    if (area < minArea) {\n                        minArea = area;\n                        targetNode = child;\n                    }\n                }\n            }\n\n            node = targetNode || node.children[0];\n        }\n\n        return node;\n    },\n\n    _insert: function (item, level, isNode) {\n\n        var toBBox = this.toBBox,\n            bbox = isNode ? item : toBBox(item),\n            insertPath = [];\n\n        // find the best node for accommodating the item, saving all nodes along the path too\n        var node = this._chooseSubtree(bbox, this.data, level, insertPath);\n\n        // put the item into the node\n        node.children.push(item);\n        extend(node, bbox);\n\n        // split on node overflow; propagate upwards if necessary\n        while (level >= 0) {\n            if (insertPath[level].children.length > this._maxEntries) {\n                this._split(insertPath, level);\n                level--;\n            } else break;\n        }\n\n        // adjust bboxes along the insertion path\n        this._adjustParentBBoxes(bbox, insertPath, level);\n    },\n\n    // split overflowed node into two\n    _split: function (insertPath, level) {\n\n        var node = insertPath[level],\n            M = node.children.length,\n            m = this._minEntries;\n\n        this._chooseSplitAxis(node, m, M);\n\n        var splitIndex = this._chooseSplitIndex(node, m, M);\n\n        var newNode = createNode(node.children.splice(splitIndex, node.children.length - splitIndex));\n        newNode.height = node.height;\n        newNode.leaf = node.leaf;\n\n        calcBBox(node, this.toBBox);\n        calcBBox(newNode, this.toBBox);\n\n        if (level) insertPath[level - 1].children.push(newNode);\n        else this._splitRoot(node, newNode);\n    },\n\n    _splitRoot: function (node, newNode) {\n        // split root node\n        this.data = createNode([node, newNode]);\n        this.data.height = node.height + 1;\n        this.data.leaf = false;\n        calcBBox(this.data, this.toBBox);\n    },\n\n    _chooseSplitIndex: function (node, m, M) {\n\n        var i, bbox1, bbox2, overlap, area, minOverlap, minArea, index;\n\n        minOverlap = minArea = Infinity;\n\n        for (i = m; i <= M - m; i++) {\n            bbox1 = distBBox(node, 0, i, this.toBBox);\n            bbox2 = distBBox(node, i, M, this.toBBox);\n\n            overlap = intersectionArea(bbox1, bbox2);\n            area = bboxArea(bbox1) + bboxArea(bbox2);\n\n            // choose distribution with minimum overlap\n            if (overlap < minOverlap) {\n                minOverlap = overlap;\n                index = i;\n\n                minArea = area < minArea ? area : minArea;\n\n            } else if (overlap === minOverlap) {\n                // otherwise choose distribution with minimum area\n                if (area < minArea) {\n                    minArea = area;\n                    index = i;\n                }\n            }\n        }\n\n        return index;\n    },\n\n    // sorts node children by the best axis for split\n    _chooseSplitAxis: function (node, m, M) {\n\n        var compareMinX = node.leaf ? this.compareMinX : compareNodeMinX,\n            compareMinY = node.leaf ? this.compareMinY : compareNodeMinY,\n            xMargin = this._allDistMargin(node, m, M, compareMinX),\n            yMargin = this._allDistMargin(node, m, M, compareMinY);\n\n        // if total distributions margin value is minimal for x, sort by minX,\n        // otherwise it's already sorted by minY\n        if (xMargin < yMargin) node.children.sort(compareMinX);\n    },\n\n    // total margin of all possible split distributions where each node is at least m full\n    _allDistMargin: function (node, m, M, compare) {\n\n        node.children.sort(compare);\n\n        var toBBox = this.toBBox,\n            leftBBox = distBBox(node, 0, m, toBBox),\n            rightBBox = distBBox(node, M - m, M, toBBox),\n            margin = bboxMargin(leftBBox) + bboxMargin(rightBBox),\n            i, child;\n\n        for (i = m; i < M - m; i++) {\n            child = node.children[i];\n            extend(leftBBox, node.leaf ? toBBox(child) : child);\n            margin += bboxMargin(leftBBox);\n        }\n\n        for (i = M - m - 1; i >= m; i--) {\n            child = node.children[i];\n            extend(rightBBox, node.leaf ? toBBox(child) : child);\n            margin += bboxMargin(rightBBox);\n        }\n\n        return margin;\n    },\n\n    _adjustParentBBoxes: function (bbox, path, level) {\n        // adjust bboxes along the given tree path\n        for (var i = level; i >= 0; i--) {\n            extend(path[i], bbox);\n        }\n    },\n\n    _condense: function (path) {\n        // go through the path, removing empty nodes and updating bboxes\n        for (var i = path.length - 1, siblings; i >= 0; i--) {\n            if (path[i].children.length === 0) {\n                if (i > 0) {\n                    siblings = path[i - 1].children;\n                    siblings.splice(siblings.indexOf(path[i]), 1);\n\n                } else this.clear();\n\n            } else calcBBox(path[i], this.toBBox);\n        }\n    },\n\n    _initFormat: function (format) {\n        // data format (minX, minY, maxX, maxY accessors)\n\n        // uses eval-type function compilation instead of just accepting a toBBox function\n        // because the algorithms are very sensitive to sorting functions performance,\n        // so they should be dead simple and without inner calls\n\n        var compareArr = ['return a', ' - b', ';'];\n\n        this.compareMinX = new Function('a', 'b', compareArr.join(format[0]));\n        this.compareMinY = new Function('a', 'b', compareArr.join(format[1]));\n\n        this.toBBox = new Function('a',\n            'return {minX: a' + format[0] +\n            ', minY: a' + format[1] +\n            ', maxX: a' + format[2] +\n            ', maxY: a' + format[3] + '};');\n    }\n};\n\nfunction findItem(item, items, equalsFn) {\n    if (!equalsFn) return items.indexOf(item);\n\n    for (var i = 0; i < items.length; i++) {\n        if (equalsFn(item, items[i])) return i;\n    }\n    return -1;\n}\n\n// calculate node's bbox from bboxes of its children\nfunction calcBBox(node, toBBox) {\n    distBBox(node, 0, node.children.length, toBBox, node);\n}\n\n// min bounding rectangle of node children from k to p-1\nfunction distBBox(node, k, p, toBBox, destNode) {\n    if (!destNode) destNode = createNode(null);\n    destNode.minX = Infinity;\n    destNode.minY = Infinity;\n    destNode.maxX = -Infinity;\n    destNode.maxY = -Infinity;\n\n    for (var i = k, child; i < p; i++) {\n        child = node.children[i];\n        extend(destNode, node.leaf ? toBBox(child) : child);\n    }\n\n    return destNode;\n}\n\nfunction extend(a, b) {\n    a.minX = Math.min(a.minX, b.minX);\n    a.minY = Math.min(a.minY, b.minY);\n    a.maxX = Math.max(a.maxX, b.maxX);\n    a.maxY = Math.max(a.maxY, b.maxY);\n    return a;\n}\n\nfunction compareNodeMinX(a, b) { return a.minX - b.minX; }\nfunction compareNodeMinY(a, b) { return a.minY - b.minY; }\n\nfunction bboxArea(a)   { return (a.maxX - a.minX) * (a.maxY - a.minY); }\nfunction bboxMargin(a) { return (a.maxX - a.minX) + (a.maxY - a.minY); }\n\nfunction enlargedArea(a, b) {\n    return (Math.max(b.maxX, a.maxX) - Math.min(b.minX, a.minX)) *\n           (Math.max(b.maxY, a.maxY) - Math.min(b.minY, a.minY));\n}\n\nfunction intersectionArea(a, b) {\n    var minX = Math.max(a.minX, b.minX),\n        minY = Math.max(a.minY, b.minY),\n        maxX = Math.min(a.maxX, b.maxX),\n        maxY = Math.min(a.maxY, b.maxY);\n\n    return Math.max(0, maxX - minX) *\n           Math.max(0, maxY - minY);\n}\n\nfunction contains(a, b) {\n    return a.minX <= b.minX &&\n           a.minY <= b.minY &&\n           b.maxX <= a.maxX &&\n           b.maxY <= a.maxY;\n}\n\nfunction intersects(a, b) {\n    return b.minX <= a.maxX &&\n           b.minY <= a.maxY &&\n           b.maxX >= a.minX &&\n           b.maxY >= a.minY;\n}\n\nfunction createNode(children) {\n    return {\n        children: children,\n        height: 1,\n        leaf: true,\n        minX: Infinity,\n        minY: Infinity,\n        maxX: -Infinity,\n        maxY: -Infinity\n    };\n}\n\n// sort an array so that items come in groups of n unsorted items, with groups sorted between each other;\n// combines selection algorithm with binary divide & conquer approach\n\nfunction multiSelect(arr, left, right, n, compare) {\n    var stack = [left, right],\n        mid;\n\n    while (stack.length) {\n        right = stack.pop();\n        left = stack.pop();\n\n        if (right - left <= n) continue;\n\n        mid = left + Math.ceil((right - left) / n / 2) * n;\n        quickselect(arr, mid, left, right, compare);\n\n        stack.push(left, mid, mid, right);\n    }\n}\n","import rbush from 'rbush';\n\n//global temparary variables\nconst search = {\n};\n/**\n * 碰撞检测的实现思路：\n * 1. 选择 collsionIndex\n *    1.1 如果 collision scope 是 layer，则在layer上创建\n *    1.2 如果 collision scope 是 map, 则直接使用map的collisionIndex\n * 2. painter中查询collisionIndex中是否有命中\n *   2.1 如果有，则从 elements 中删除当前item\n *   2.2 如果没有，如果需要的，insert到collisionIndex中\n */\nclass CollisionIndex {\n    constructor() {\n        this._tree = rbush(9, ['[0]', '[1]', '[2]', '[3]']);\n    }\n\n    /**\n     * Test if given box is collided with any other\n     * @param {Number[]} box - [minx, miny, maxx, maxy]\n     * @returns {Boolean}\n     */\n    collides(box) {\n        [search.minX, search.minY, search.maxX, search.maxY] = box;\n        return this._tree.collides(search);\n    }\n\n    /**\n     * Insert box in collision index\n     * @param {Number[]} box - [minx, miny, maxx, maxy]\n     * @returns {CollisionIndex} this\n     */\n    insertBox(box) {\n        const tree = this._tree;\n        tree.insert(box);\n        return this;\n    }\n\n    /**\n     * Bulk insert boxes in collision index\n     * Powered by rbush, it will perform better in subsquent query\n     * @param {Number[][]} boxes - [[minx, miny, maxx, maxy], ...]\n     * @returns {CollisionIndex} this\n     */\n    bulkInsertBox(boxes) {\n        this._tree.load(boxes);\n        return this;\n    }\n\n    /**\n     * Clear the collision index\n     * @returns {CollisionIndex} this\n     */\n    clear() {\n        this._tree.clear();\n        return this;\n    }\n}\n\nexport default CollisionIndex;\n","/**\n * A mixin, to enable a class with [interaction handlers]{@link Handler}\n * @protected\n * @category handler\n * @mixin Handlerable\n */\nexport default function (Base) {\n    return class extends Base {\n        /**\n         * Register a handler\n         * @param {String} name       - name of the handler\n         * @param {Handler}           - handler class\n         * @return {*} this\n         * @protected\n         * @function Handerable.addHandler\n         */\n        addHandler(name, handlerClass) {\n            if (!handlerClass) {\n                return this;\n            }\n            if (!this._handlers) {\n                this._handlers = [];\n            }\n            //handler已经存在\n            if (this[name]) {\n                this[name].enable();\n                return this;\n            }\n\n            const handler = this[name] = new handlerClass(this);\n\n            this._handlers.push(handler);\n\n            if (this.options[name]) {\n                handler.enable();\n            }\n            return this;\n        }\n\n        /**\n         * Removes a handler\n         * @param {String} name       - name of the handler\n         * @return {*} this\n         * @protected\n         * @function Handerable.removeHandler\n         */\n        removeHandler(name) {\n            if (!name) {\n                return this;\n            }\n            const handler = this[name];\n            if (handler) {\n                //handler registered\n                const hit = this._handlers.indexOf(handler);\n                if (hit >= 0) {\n                    this._handlers.splice(hit, 1);\n                }\n                this[name].remove();\n                delete this[name];\n            }\n            return this;\n        }\n\n        _clearHandlers() {\n            for (let i = 0, len = this._handlers.length; i < len; i++) {\n                this._handlers[i].remove();\n            }\n            this._handlers = [];\n        }\n    };\n}\n","import { isNumber } from '../core/util';\nimport Handler from './Handler';\nimport { on, off } from '../core/util/dom';\nimport Point from '../geo/Point';\n\nconst START_EVENTS = 'touchstart mousedown';\nconst MOVE_EVENTS = {\n    mousedown: 'mousemove',\n    touchstart: 'touchmove',\n    pointerdown: 'touchmove',\n    MSPointerDown: 'touchmove'\n};\nconst END_EVENTS = {\n    mousedown: 'mouseup',\n    touchstart: 'touchend',\n    pointerdown: 'touchend',\n    MSPointerDown: 'touchend'\n};\n\n/**\n * Drag handler\n * @category handler\n * @protected\n * @extends Handler\n */\nclass DragHandler extends Handler {\n\n    constructor(dom, options = {}) {\n        super(null);\n        this.dom = dom;\n        this.options = options;\n    }\n\n    enable() {\n        if (!this.dom) {\n            return this;\n        }\n        //create a dynamic method to resolve conflicts with other drag handler\n        this._onMouseDown = function (e) {\n            return this.onMouseDown(e);\n        };\n        on(this.dom, START_EVENTS, this._onMouseDown, this);\n        return this;\n    }\n\n\n    disable() {\n        if (!this.dom) {\n            return this;\n        }\n        this._offEvents();\n        off(this.dom, START_EVENTS, this._onMouseDown);\n        delete this._onMouseDown;\n        return this;\n    }\n\n    onMouseDown(event) {\n        if (!this.options['rightclick'] && event.button === 2) {\n            //ignore right mouse down\n            return;\n        }\n        if (event.touches && event.touches.length > 1) {\n            return;\n        }\n        if (this.options['cancelOn'] && this.options['cancelOn'](event) === true) {\n            return;\n        }\n        const dom = this.dom;\n        if (dom.setCapture) {\n            dom.setCapture();\n        } else if (window.captureEvents) {\n            window.captureEvents(window['Event'].MOUSEMOVE | window['Event'].MOUSEUP);\n        }\n        dom['ondragstart'] = function () {\n            return false;\n        };\n        delete this.moved;\n        const actual = event.touches ? event.touches[0] : event;\n        this.startPos = new Point(actual.clientX, actual.clientY);\n        on(document, MOVE_EVENTS[event.type], this.onMouseMove, this);\n        on(document, END_EVENTS[event.type], this.onMouseUp, this);\n        if (!this.options['ignoreMouseleave']) {\n            on(this.dom, 'mouseleave', this.onMouseUp, this);\n        }\n        this.fire('mousedown', {\n            'domEvent': event,\n            'mousePos': new Point(actual.clientX, actual.clientY)\n        });\n    }\n\n    onMouseMove(event) {\n        if (event.touches && event.touches.length > 1) {\n            if (this.moved) {\n                this.interupted = true;\n                this.onMouseUp(event);\n            }\n            return;\n        }\n        const actual = event.touches ? event.touches[0] : event;\n\n        const newPos = new Point(actual.clientX, actual.clientY),\n            offset = newPos.sub(this.startPos);\n        if (!offset.x && !offset.y) {\n            return;\n        }\n        if (!this.moved) {\n            this.fire('dragstart', {\n                'domEvent': event,\n                'mousePos': this.startPos.copy()\n            });\n            this.moved = true;\n        } else {\n            this.fire('dragging', {\n                'domEvent': event,\n                'mousePos': new Point(actual.clientX, actual.clientY)\n            });\n        }\n    }\n\n    onMouseUp(event) {\n        const actual = event.changedTouches ? event.changedTouches[0] : event;\n        this._offEvents();\n        const param = {\n            'domEvent': event\n        };\n        if (isNumber(actual.clientX)) {\n            param['mousePos'] = new Point(parseInt(actual.clientX, 0), parseInt(actual.clientY, 0));\n        }\n        if (this.moved/* && this.moving*/) {\n            param.interupted = this.interupted;\n            this.fire('dragend', param);\n            delete this.interupted;\n            delete this.moved;\n        }\n\n        this.fire('mouseup', param);\n    }\n\n    _offEvents() {\n        const dom = this.dom;\n        off(dom, 'mouseleave', this.onMouseUp, this);\n        if ((typeof document === 'undefined') || (typeof window === 'undefined')) {\n            return;\n        }\n        for (const i in MOVE_EVENTS) {\n            off(document, MOVE_EVENTS[i], this.onMouseMove, this);\n            off(document, END_EVENTS[i], this.onMouseUp, this);\n        }\n\n        if (dom['releaseCapture']) {\n            dom['releaseCapture']();\n        } else if (window.captureEvents) {\n            window.captureEvents(window['Event'].MOUSEMOVE | window['Event'].MOUSEUP);\n        }\n    }\n}\n\nexport default DragHandler;\n","import { isNumber, forEachCoord } from '../core/util';\nimport Position from './Position';\n/**\n * Represents a coordinate point <br>\n * e.g. <br>\n * A geographical point (longitude, latitude)\n * @example\n * var coord = new Coordinate(0, 0);\n * @example\n * var coord = new Coordinate([ 0, 0 ]);\n * @example\n * var coord = new Coordinate({ x : 0, y : 0 });\n * @category basic types\n */\nclass Coordinate extends Position {\n\n    /**\n     * Convert one or more Coordinate objects to GeoJSON style coordinates\n     * @param  {Coordinate|Coordinate[]} coordinates - coordinates to convert\n     * @return {Number[]|Number[][]}\n     * @example\n     * // result is [[100,0], [101,1]]\n     * var numCoords = Coordinate.toNumberArrays([new Coordinate(100,0), new Coordinate(101,1)]);\n     */\n    static toNumberArrays(coordinates) {\n        if (!Array.isArray(coordinates)) {\n            return [coordinates.x, coordinates.y];\n        }\n        return forEachCoord(coordinates, function (coord) {\n            return [coord.x, coord.y];\n        });\n    }\n\n    /**\n     * Convert one or more GeoJSON style coordiantes to Coordinate objects\n     * @param  {Number[]|Number[][]} coordinates - coordinates to convert\n     * @return {Coordinate|Coordinate[]}\n     * @example\n     * var coordinates = Coordinate.toCoordinates([[100,0], [101,1]]);\n     */\n    static toCoordinates(coordinates) {\n        if (isNumber(coordinates[0]) && isNumber(coordinates[1])) {\n            return new Coordinate(coordinates);\n        }\n        const result = [];\n        for (let i = 0, len = coordinates.length; i < len; i++) {\n            const child = coordinates[i];\n            if (Array.isArray(child)) {\n                if (isNumber(child[0])) {\n                    result.push(new Coordinate(child));\n                } else {\n                    result.push(Coordinate.toCoordinates(child));\n                }\n            } else {\n                result.push(new Coordinate(child));\n            }\n        }\n        return result;\n    }\n\n\n}\n\nexport default Coordinate;\n","/**\n * Represent CRS defined by [GeoJSON]{@link http://geojson.org/geojson-spec.html#coordinate-reference-system-objects}\n *\n * @category geo\n */\nclass CRS {\n\n    /**\n     * @param {String} type          - type of the CRS\n     * @param {Object} properties    - CRS's properties\n     */\n    constructor(type, properties) {\n        this.type = type;\n        this.properties = properties;\n    }\n\n    /**\n     * Create a [proj4]{@link https://github.com/OSGeo/proj.4} style CRS used by maptalks <br>\n     * @example\n     * {\n     *     \"type\"       : \"proj4\",\n     *     \"properties\" : {\n     *         \"proj\"   : \"+proj=longlat +datum=WGS84 +no_defs\"\n     *     }\n     * }\n     * var crs_wgs84 = CRS.createProj4(\"+proj=longlat +datum=WGS84 +no_defs\");\n     * @param  {String} proj - a proj4 projection string.\n     * @return {CRS}\n     */\n    static createProj4(proj) {\n        return new CRS('proj4', {\n            'proj': proj\n        });\n    }\n\n    static fromProjectionCode(code) {\n        if (!code) {\n            return null;\n        }\n        code = code.toUpperCase().replace(':', '');\n        return CRS[code] || null;\n    }\n}\n\n// some common CRS definitions\n\n/**\n * Predefined CRS of well-known WGS84 (aka EPSG:4326)\n * @type {CRS}\n * @constant\n */\nCRS.WGS84 = CRS.createProj4('+proj=longlat +datum=WGS84 +no_defs');\n\n/**\n * Alias for CRS.WGS84\n * @type {CRS}\n * @constant\n */\nCRS.EPSG4326 = CRS.WGS84;\n\n/**\n * Projected Coordinate System used by google maps that has the following alias: 'EPSG:3785', 'GOOGLE', 'EPSG:900913'\n * @type {CRS}\n * @constant\n */\nCRS.EPSG3857 = CRS.createProj4('+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs');\n\n/**\n * A CRS represents a simple Cartesian coordinate system. <br>\n * Maps x, y directly, is useful for maps of flat surfaces (e.g. indoor maps, game maps).\n * @type {CRS}\n * @constant\n */\nCRS.IDENTITY = CRS.createProj4('+proj=identity +no_defs');\n\n/**\n * Official coordinate system in China (aka EPSG:4490), in most cases, it can be considered the same with WGS84.\n * @type {CRS}\n * @see  {@link http://spatialreference.org/ref/sr-org/7408/}\n * @constant\n */\nCRS.CGCS2000 = CRS.createProj4('+proj=longlat +datum=CGCS2000');\n\n/**\n * Alias for CRS.CGCS2000\n * @type {CRS}\n * @constant\n */\nCRS.EPSG4490 = CRS.CGCS2000;\n\n/**\n * Projection used by [Baidu Map]{@link http://map.baidu.com}, a popular web map service in China.\n * @type {CRS}\n * @constant\n */\nCRS.BD09LL = CRS.createProj4('+proj=longlat +datum=BD09');\n\n/**\n * A encrypted CRS usded in the most online map services in China..\n * @type {CRS}\n * @see {@link https://en.wikipedia.org/wiki/Restrictions_on_geographic_data_in_China}\n * @constant\n */\nCRS.GCJ02 = CRS.createProj4('+proj=longlat +datum=GCJ02');\n\nexport default CRS;\n","import { isNil, isNumber } from '../core/util';\nimport Coordinate from './Coordinate';\nimport Point from './Point';\nimport Size from './Size';\n\n//temparary variables\nconst TEMP_POINT0 = new Point(0, 0);\nconst TEMP_COORD0 = new Coordinate(0, 0);\nconst TEMP_COORD1 = new Coordinate(0, 0);\nconst TEMP_COORD2 = new Coordinate(0, 0);\nconst TEMP_COORD3 = new Coordinate(0, 0);\nconst TEMP_COORD4 = new Coordinate(0, 0);\nconst TEMP_COORD5 = new Coordinate(0, 0);\nconst TEMP_COORD6 = new Coordinate(0, 0);\nconst TEMP_COORD7 = new Coordinate(0, 0);\nconst MINMAX = [];\n/* eslint-disable prefer-const */\nlet TEMP_EXTENT;\n/* eslint-enable prefer-const */\nconst TEMP_COMBINE = [];\n\n/**\n * Represent a bounding box on the map, a rectangular geographical area with minimum and maximum coordinates. <br>\n * There are serveral ways to create a extent:\n * @category basic types\n * @example\n * //with 4 numbers: xmin, ymin, xmax and ymax\n * var extent = new Extent(100, 10, 120, 20);\n * @example\n * //with 2 coordinates\n * var extent = new Extent(new Coordinate(100, 10), new Coordinate(120, 20));\n * @example\n * //with a json object containing xmin, ymin, xmax and ymax\n * var extent = new Extent({xmin : 100, ymin: 10, xmax: 120, ymax:20});\n * @example\n * var extent1 = new Extent(100, 10, 120, 20);\n * //with another extent\n * var extent2 = new Extent(extent1);\n */\nclass Extent {\n\n    /**\n     * @param {Number} x1   - x of coordinate 1\n     * @param {Number} y1   - y of coordinate 1\n     * @param {Number} x2   - x of coordinate 2\n     * @param {Number} y2   - y of coordinate 2\n     */\n    constructor(p1, p2, p3, p4) {\n        this._clazz = Coordinate;\n        const l = arguments.length;\n        const proj = l > 0 ? arguments[l - 1] : null;\n        if (proj && proj.unproject) {\n            this.projection = arguments[l - 1];\n        }\n        this._dirty = true;\n        this._initialize(p1, p2, p3, p4);\n    }\n\n    _initialize(p1, p2, p3, p4) {\n        /**\n         * @property {Number} xmin - minimum x\n         */\n        this.xmin = null;\n        /**\n         * @property {Number} xmax - maximum x\n         */\n        this.xmax = null;\n        /**\n         * @property {Number} ymin - minimum y\n         */\n        this.ymin = null;\n        /**\n         * @property {Number} ymax - maximum y\n         */\n        this.ymax = null;\n        if (isNil(p1)) {\n            return;\n        }\n        const projection = this.projection;\n        //Constructor 1: all numbers\n        if (isNumber(p1) &&\n            isNumber(p2) &&\n            isNumber(p3) &&\n            isNumber(p4)) {\n            if (projection) {\n                this.set(p1, p2, p3, p4);\n            } else {\n                this.set(\n                    Math.min(p1, p3),\n                    Math.min(p2, p4),\n                    Math.max(p1, p3),\n                    Math.max(p2, p4)\n                );\n            }\n            return;\n        } else if (Array.isArray(p1)) {\n            if (projection) {\n                this.set(p1[0], p1[1], p1[2], p1[3]);\n            } else {\n                this.set(\n                    Math.min(p1[0], p1[2]),\n                    Math.min(p1[1], p1[3]),\n                    Math.max(p1[0], p1[2]),\n                    Math.max(p1[1], p1[3])\n                );\n            }\n        } else if (isNumber(p1.x) &&\n            isNumber(p2.x) &&\n            isNumber(p1.y) &&\n            isNumber(p2.y)) {\n            //Constructor 2: two coordinates\n            if (projection) {\n                this.set(p1.x, p1.y, p2.x, p2.y);\n            } else {\n                if (p1.x > p2.x) {\n                    this['xmin'] = p2.x;\n                    this['xmax'] = p1.x;\n                } else {\n                    this['xmin'] = p1.x;\n                    this['xmax'] = p2.x;\n                }\n                if (p1.y > p2.y) {\n                    this['ymin'] = p2.y;\n                    this['ymax'] = p1.y;\n                } else {\n                    this['ymin'] = p1.y;\n                    this['ymax'] = p2.y;\n                }\n            }\n            //constructor 3: another extent or a object containing xmin, ymin, xmax and ymax\n        } else if (isNumber(p1['xmin']) &&\n            isNumber(p1['xmax']) &&\n            isNumber(p1['ymin']) &&\n            isNumber(p1['ymax'])) {\n            this.set(p1['xmin'], p1['ymin'], p1['xmax'], p1['ymax']);\n        }\n    }\n\n    _add(p) {\n        this._dirty = true;\n        if (!isNil(p.x)) {\n            this['xmin'] += p.x;\n            this['ymin'] += p.y;\n            this['xmax'] += p.x;\n            this['ymax'] += p.y;\n        } else if (!isNil(p.xmin)) {\n            this['xmin'] += p.xmin;\n            this['ymin'] += p.ymin;\n            this['xmax'] += p.xmax;\n            this['ymax'] += p.ymax;\n        } else if (!isNil(p[0])) {\n            this['xmin'] += p[0];\n            this['ymin'] += p[1];\n            this['xmax'] += p[0];\n            this['ymax'] += p[1];\n        }\n        return this;\n    }\n\n    /**\n     * Add the extent with a coordinate or a point.\n     * @param {Coordinate|Point} p - point or coordinate to add\n     * @returns {Extent} a new extent\n     */\n    add() {\n        const e = new this.constructor(this['xmin'], this['ymin'], this['xmax'], this['ymax'], this.projection);\n        return e._add.apply(e, arguments);\n    }\n\n    _scale(s) {\n        this._dirty = true;\n        this['xmin'] *= s;\n        this['ymin'] *= s;\n        this['xmax'] *= s;\n        this['ymax'] *= s;\n        return this;\n    }\n\n    _sub(p) {\n        this._dirty = true;\n        if (!isNil(p.x)) {\n            this['xmin'] -= p.x;\n            this['ymin'] -= p.y;\n            this['xmax'] -= p.x;\n            this['ymax'] -= p.y;\n        } else if (!isNil(p.xmin)) {\n            this['xmin'] -= p.xmin;\n            this['ymin'] -= p.ymin;\n            this['xmax'] -= p.xmax;\n            this['ymax'] -= p.ymax;\n        } else if (!isNil(p[0])) {\n            this['xmin'] -= p[0];\n            this['ymin'] -= p[1];\n            this['xmax'] -= p[0];\n            this['ymax'] -= p[1];\n        }\n        return this;\n    }\n\n    _substract() {\n        return this._sub.apply(this, arguments);\n    }\n\n    /**\n     * Substract the extent with a coordinate or a point.\n     * @param {Coordinate|Point} p - point or coordinate to substract\n     * @returns {Extent} a new extent\n     */\n    sub() {\n        const e = new this.constructor(this['xmin'], this['ymin'], this['xmax'], this['ymax'], this.projection);\n        return e._sub.apply(e, arguments);\n    }\n\n    /**\n     * Alias for sub\n     * @param {Coordinate|Point} p - point or coordinate to substract\n     * @returns {Extent} a new extent\n     */\n    substract() {\n        return this.sub.apply(this, arguments);\n    }\n\n\n    /**\n     * Round the extent\n     * @return {Extent} rounded extent\n     */\n    round() {\n        return new this.constructor(Math.round(this['xmin']), Math.round(this['ymin']),\n            Math.round(this['xmax']), Math.round(this['ymax']), this.projection);\n    }\n\n    _round() {\n        this._dirty = true;\n        this['xmin'] = Math.round(this['xmin']);\n        this['ymin'] = Math.round(this['ymin']);\n        this['xmax'] = Math.round(this['xmax']);\n        this['ymax'] = Math.round(this['ymax']);\n        return this;\n    }\n\n    /**\n     * Get the minimum point\n     * @params {Coorindate} [out=undefined] - optional point to receive result\n     * @return {Coordinate}\n     */\n    getMin(out) {\n        if (out) {\n            out.set(this['xmin'], this['ymin']);\n            return out;\n        }\n        return new this._clazz(this['xmin'], this['ymin']);\n    }\n\n    /**\n     * Get the maximum point\n     * @params {Coorindate} [out=undefined] - optional point to receive result\n     * @return {Coordinate}\n     */\n    getMax(out) {\n        if (out) {\n            out.set(this['xmax'], this['ymax']);\n            return out;\n        }\n        return new this._clazz(this['xmax'], this['ymax']);\n    }\n\n    /**\n     * Get center of the extent.\n     * @params {Coorindate} [out=undefined] - optional point to receive result\n     * @return {Coordinate}\n     */\n    getCenter(out) {\n        const x = (this['xmin'] + this['xmax']) / 2;\n        const y = (this['ymin'] + this['ymax']) / 2;\n        if (out) {\n            out.set(x, y);\n            return out;\n        }\n        return new this._clazz(x, y);\n    }\n\n    /**\n     * Whether the extent is valid\n     * @protected\n     * @return {Boolean}\n     */\n    isValid() {\n        return !isNil(this['xmin']) &&\n            !isNil(this['ymin']) &&\n            !isNil(this['xmax']) &&\n            !isNil(this['ymax']);\n    }\n\n    /**\n     * Compare with another extent to see whether they are equal.\n     * @param  {Extent}  ext2 - extent to compare\n     * @return {Boolean}\n     */\n    equals(ext2) {\n        return (this['xmin'] === ext2['xmin'] &&\n            this['xmax'] === ext2['xmax'] &&\n            this['ymin'] === ext2['ymin'] &&\n            this['ymax'] === ext2['ymax']);\n    }\n\n    /**\n     * Whether it intersects with another extent\n     * @param  {Extent}  ext2 - another extent\n     * @return {Boolean}\n     */\n    intersects(ext2) {\n        this._project(this);\n        this._project(ext2);\n        const rxmin = Math.max(this['pxmin'], ext2['pxmin']);\n        const rymin = Math.max(this['pymin'], ext2['pymin']);\n        const rxmax = Math.min(this['pxmax'], ext2['pxmax']);\n        const rymax = Math.min(this['pymax'], ext2['pymax']);\n        const intersects = !((rxmin > rxmax) || (rymin > rymax));\n        return intersects;\n    }\n\n    /**\n     * Whether the extent is within another extent\n     * @param  {Extent}  ext2 - another extent\n     * @returns {Boolean}\n     */\n    within(extent) {\n        this._project(this);\n        this._project(extent);\n        return this.pxmin >= extent.pxmin && this.pxmax <= extent.pxmax && this.pymin >= extent.pymin && this.pymax <= extent.pymax;\n    }\n\n    /**\n     * Whether the extent contains the input point.\n     * @param  {Coordinate|Number[]} coordinate - input point\n     * @returns {Boolean}\n     */\n    contains(c) {\n        if (!c) {\n            return false;\n        }\n        this._project(this);\n        const proj = this.projection;\n        if (proj) {\n            if (c.x !== undefined) {\n                const coord = TEMP_COORD0;\n                if (Array.isArray(c)) {\n                    coord.x = c[0];\n                    coord.y = c[1];\n                } else {\n                    coord.x = c.x;\n                    coord.y = c.y;\n                }\n                c = proj.project(coord, coord);\n            } else if (c.xmin !== undefined) {\n                this._project(c);\n            }\n        }\n        return ((c.x || c.pxmin || 0) >= this.pxmin) &&\n            ((c.x || c.pxmax || 0) <= this.pxmax) &&\n            ((c.y || c.pymin || 0) >= this.pymin) &&\n            ((c.y || c.pymax || 0) <= this.pymax);\n    }\n\n    /**\n     * Get the width of the Extent\n     * @return {Number}\n     */\n    getWidth() {\n        return Math.abs(this['xmax'] - this['xmin']);\n    }\n\n    /**\n     * Get the height of the Extent\n     * @return {Number}\n     */\n    getHeight() {\n        return Math.abs(this['ymax'] - this['ymin']);\n    }\n\n    /**\n     * Get size of the Extent\n     * @return {Size}\n     */\n    getSize() {\n        return new Size(this.getWidth(), this.getHeight());\n    }\n\n    set(xmin, ymin, xmax, ymax) {\n        this.xmin = xmin;\n        this.ymin = ymin;\n        this.xmax = xmax;\n        this.ymax = ymax;\n        return this;\n    }\n\n    __combine(extent) {\n        if (extent.x !== undefined) {\n            TEMP_EXTENT.xmin = TEMP_EXTENT.xmax = extent.x;\n            TEMP_EXTENT.ymin = TEMP_EXTENT.ymax = extent.y;\n            extent = TEMP_EXTENT;\n        }\n        this._project(extent);\n        this._project(this);\n        const inited = isNumber(this.pxmin);\n        let xmin, ymin, xmax, ymax;\n        if (!inited) {\n            xmin = extent['pxmin'];\n            ymin = extent['pymin'];\n            xmax = extent['pxmax'];\n            ymax = extent['pymax'];\n        } else {\n            xmin = Math.min(this['pxmin'], extent['pxmin']);\n            ymin = Math.min(this['pymin'], extent['pymin']);\n            xmax = Math.max(this['pxmax'], extent['pxmax']);\n            ymax = Math.max(this['pymax'], extent['pymax']);\n        }\n        const proj = this.projection;\n        if (proj) {\n            TEMP_COORD1.set(xmin, ymin);\n            TEMP_COORD2.set(xmax, ymax);\n            const min = proj.unproject(TEMP_COORD1, TEMP_COORD1),\n                max = proj.unproject(TEMP_COORD2, TEMP_COORD2);\n            xmin = min.x;\n            ymin = min.y;\n            xmax = max.x;\n            ymax = max.y;\n        }\n        TEMP_COMBINE[0] = xmin;\n        TEMP_COMBINE[1] = ymin;\n        TEMP_COMBINE[2] = xmax;\n        TEMP_COMBINE[3] = ymax;\n        return TEMP_COMBINE;\n    }\n\n    _combine(extent) {\n        if (!extent || extent.isValid && !extent.isValid()) {\n            return this;\n        }\n        const ext = this.__combine(extent);\n        this.set(ext[0], ext[1], ext[2], ext[3]);\n        this._dirty = true;\n        return this;\n    }\n\n    /**\n     * Combine it with another extent to a larger extent.\n     * @param  {Extent|Coordinate|Point} extent - extent/coordinate/point to combine into\n     * @returns {Extent} extent combined\n     */\n    combine(extent) {\n        if (!extent || extent.isValid && !extent.isValid()) {\n            return this;\n        }\n        const ext = this.__combine(extent);\n        return new this.constructor(ext[0], ext[1], ext[2], ext[3], this.projection);\n    }\n\n    /**\n     * Gets the intersection extent of this and another extent.\n     * @param  {Extent} extent - another extent\n     * @return {Extent} intersection extent\n     */\n    intersection(extent) {\n        if (!this.intersects(extent)) {\n            return null;\n        }\n        TEMP_COORD3.x = Math.max(this['pxmin'], extent['pxmin']);\n        TEMP_COORD3.y = Math.max(this['pymin'], extent['pymin']);\n        TEMP_COORD4.x = Math.min(this['pxmax'], extent['pxmax']);\n        TEMP_COORD4.y = Math.min(this['pymax'], extent['pymax']);\n        let min = TEMP_COORD3,\n            max = TEMP_COORD4;\n        const proj = this.projection;\n        if (proj) {\n            min = proj.unproject(min, min);\n            max = proj.unproject(max, max);\n        }\n        return new this.constructor(min, max, proj);\n    }\n\n    /**\n     * Expand the extent by distance\n     * @param  {Size|Number} distance  - distance to expand\n     * @returns {Extent} a new extent expanded from\n     */\n    expand(distance) {\n        let w, h;\n        if (!isNumber(distance)) {\n            w = distance['width'] || distance['x'] || distance[0] || 0;\n            h = distance['height'] || distance['y'] || distance[1] || 0;\n        } else {\n            w = h = distance;\n        }\n        return new this.constructor(this['xmin'] - w, this['ymin'] - h, this['xmax'] + w, this['ymax'] + h, this.projection);\n    }\n\n    _expand(distance) {\n        let w, h;\n        if (!isNumber(distance)) {\n            w = distance['width'] || distance['x'] || distance[0] || 0;\n            h = distance['height'] || distance['y'] || distance[1] || 0;\n        } else {\n            w = h = distance;\n        }\n        this['xmin'] -= w;\n        this['ymin'] -= h;\n        this['xmax'] += w;\n        this['ymax'] += h;\n        this._dirty = true;\n        return this;\n    }\n\n    /**\n     * Get extent's JSON object.\n     * @return {Object} jsonObject\n     * @example\n     * // {xmin : 100, ymin: 10, xmax: 120, ymax:20}\n     * var json = extent.toJSON();\n     */\n    toJSON() {\n        return {\n            'xmin': this['xmin'],\n            'ymin': this['ymin'],\n            'xmax': this['xmax'],\n            'ymax': this['ymax']\n        };\n    }\n\n    /**\n     * Get a coordinate array of extent's rectangle area, containing 5 coordinates in which the first equals with the last.\n     * @return {Coordinate[]} coordinates array\n     */\n    toArray() {\n        const xmin = this['xmin'],\n            ymin = this['ymin'],\n            xmax = this['xmax'],\n            ymax = this['ymax'];\n        return [\n            new this._clazz([xmin, ymax]), new this._clazz([xmax, ymax]),\n            new this._clazz([xmax, ymin]), new this._clazz([xmin, ymin]),\n            new this._clazz([xmin, ymax])\n        ];\n    }\n\n    toString() {\n        return `${this.xmin},${this.ymin},${this.xmax},${this.ymax}`;\n    }\n\n    /**\n     * Get a copy of the extent.\n     * @return {Extent} copy\n     */\n    copy() {\n        return new this.constructor(this['xmin'], this['ymin'], this['xmax'], this['ymax'], this.projection);\n    }\n\n    /**\n     * Convert to a new extent\n     * @param  {Function} fn convert function on each point\n     * @return {Extent}\n     */\n    convertTo(fn, out) {\n        if (!this.isValid()) {\n            return null;\n        }\n        const e = out || new this.constructor();\n        if (out) {\n            e.xmin = e.ymin = e.xmax = e.ymax = 0;\n        }\n        let coord;\n        if (this._clazz === Coordinate) {\n            coord = TEMP_COORD5;\n        } else if (this._clazz === Point) {\n            coord = TEMP_POINT0;\n        }\n        coord.x = this.xmin;\n        coord.y = this.ymax;\n        e._combine(fn(coord));\n        coord.x = this.xmax;\n        e._combine(fn(coord));\n        coord.y = this.ymin;\n        e._combine(fn(coord));\n        coord.x = this.xmin;\n        e._combine(fn(coord));\n        return e;\n    }\n\n    _project(ext) {\n        if (!ext || !ext.isValid()) {\n            return;\n        }\n        const proj = this.projection;\n        if (proj) {\n            //FIXME a rare but potential bug:\n            //An extent may be projected by multiple projection\n            if (ext._dirty) {\n                TEMP_COORD6.set(ext.xmax, ext.ymin);\n                TEMP_COORD7.set(ext.xmin, ext.ymax);\n                MINMAX[0] = TEMP_COORD6;\n                MINMAX[1] = TEMP_COORD7;\n                const minmax = proj.projectCoords(MINMAX);\n                const min = minmax[0],\n                    max = minmax[1];\n                ext.pxmin = Math.min(min.x, max.x);\n                ext.pymin = Math.min(min.y, max.y);\n                ext.pxmax = Math.max(min.x, max.x);\n                ext.pymax = Math.max(min.y, max.y);\n            }\n            delete ext._dirty;\n        } else {\n            ext.pxmin = ext.xmin;\n            ext.pxmax = ext.xmax;\n            ext.pymin = ext.ymin;\n            ext.pymax = ext.ymax;\n        }\n    }\n}\n\nTEMP_EXTENT = new Extent(0, 0, 0, 0);\n\nexport default Extent;\n","import Extent from './Extent';\nimport Point from './Point';\n\n/**\n * Represent a bounding box on 2d surface , a rectangular area with minimum and maximum points. <br>\n * There are serveral ways to create a PointExtent:\n * @category basic types\n * @extends Extent\n * @example\n * //with 4 numbers\n * var extent = new PointExtent(100, 10, 120, 20);\n * @example\n * //with 2 points\n * var extent = new PointExtent(new Point(100, 10), new Point(120, 20));\n * @example\n * //with a json object containing xmin, ymin, xmax and ymax\n * var extent = new PointExtent({xmin : 100, ymin: 10, xmax: 120, ymax:20});\n * @example\n * var extent1 = new PointExtent(100, 10, 120, 20);\n * //with another extent\n * var extent2 = new PointExtent(extent1);\n */\nclass PointExtent extends Extent {\n\n    /**\n     * @param {Number} x1   - x of point 1\n     * @param {Number} y1   - y of point 1\n     * @param {Number} x2   - x of point 2\n     * @param {Number} y2   - y of point 2\n     */\n    constructor(p1, p2, p3, p4) {\n        super(p1, p2, p3, p4);\n        this._clazz = Point;\n    }\n}\n\nexport default PointExtent;\n","import Coordinate from '../Coordinate';\nimport Point from '../Point';\n\n/**\n * Transformation between projected coordinates and base 2d point system.\n * A core class used internally for mapping map's (usually geographical) coordinates to 2d points.<br>\n *\n * @category geo\n * @protected\n */\nclass Transformation {\n    /**\n     * The base 2d point system is a fixed system that is consistent with HTML coordinate system: on X-Axis, left is smaller and right is larger; on Y-Axis, top is smaller and bottom is larger. <br>\n     * As map's coordinates may not be in the same order(e.g. on a mercator projected earth, top is larger and bottom is smaller), <br>\n     * transformation provides mapping functions to map arbitrary coordinates system to the fixed 2d point system. <br>\n     * How to transform is decided by the constructor parameters which is a 4 number array [a, b, c, d]:<br>\n     * a : the order scale of X-axis values 1 means right is larger and -1 means the reverse, left is larger;<br>\n     * b : the order scale of Y-axis values 1 means bottom is larger and -1 means the reverse, top is larger;<br>\n     * c : x of the origin point of the projected coordinate system <br>\n     * d : y of the origin point of the projected coordinate system <br>\n     * e.g.: Transformation parameters for Google map: [1, -1, -20037508.34, 20037508.34] <br>\n     * @param  {Number[]} matrix transformation array\n     */\n    constructor(matrix) {\n        this.matrix = matrix;\n    }\n\n    /**\n     * Transform a projected coordinate to a 2d point. <br>\n     * Parameter scale in transform/untransform method is used to scale the result 2d points on map's different zoom levels.\n     * @param  {Number[]|Coordinate} coordinates - projected coordinate to transform\n     * @param  {Number} scale                              - transform scale\n     * @return {Point} 2d point.\n     */\n    transform(coordinates, scale, out) {\n        const x = this.matrix[0] * (coordinates.x - this.matrix[2]) / scale;\n        const y = this.matrix[1] * (coordinates.y - this.matrix[3]) / scale;\n        if (out) {\n            out.x = x;\n            out.y = y;\n            return out;\n        }\n        return new Point(x, y);\n    }\n\n    /**\n     * Transform a 2d point to a projected coordinate.\n     * @param  {Point} point   - 2d point\n     * @param  {Number} scale           - transform scale\n     * @return {Coordinate}  projected coordinate.\n     */\n    untransform(point, scale, out) {\n        const x = point.x * scale / this.matrix[0] + this.matrix[2];\n        const y = point.y * scale / this.matrix[1] + this.matrix[3];\n        if (out) {\n            out.x = x;\n            out.y = y;\n            return out;\n        }\n        return new Coordinate(x, y);\n    }\n}\n\nexport default Transformation;\n","import { forEachCoord, sign, wrap } from '../../core/util';\nimport Coordinate from '../Coordinate';\nimport Extent from '../Extent';\n\n/**\n * Common Methods of Projections.\n * @mixin\n * @protected\n * @memberOf projection\n * @name Common\n */\nexport default /** @lends projection.Common */ {\n    /**\n     * Project a geographical coordinate to a projected coordinate (2d coordinate)\n     * @param  {Coordinate} p - coordinate to project\n     * @return {Coordinate}\n     * @function projection.Common.project\n     */\n    project() {},\n    /**\n     * Unproject a projected coordinate to a geographical coordinate (2d coordinate)\n     * @param  {Coordinate} p - coordinate to project\n     * @return {Coordinate}\n     * @function projection.Common.unproject\n     */\n    unproject() {},\n    /**\n     * Project a group of geographical coordinates to projected coordinates.\n     * @param  {Coordinate[]|Coordinate[][]|Coordinate[][][]} coordinates - coordinates to project\n     * @return {Coordinate[]|Coordinate[][]|Coordinate[][][]}\n     * @function projection.Common.projectCoords\n     */\n    projectCoords(coordinates) {\n        if (!coordinates) {\n            return [];\n        }\n        if (!Array.isArray(coordinates)) {\n            return this.project(coordinates);\n        }\n        if (coordinates.length === 0) {\n            return [];\n        }\n        if (!this.isSphere()) {\n            return forEachCoord(coordinates, this.project, this);\n        }\n        if (Array.isArray(coordinates[0])) {\n            return coordinates.map(coords => this.projectCoords(coords));\n        } else {\n            const circum = this.getCircum();\n            const extent = this.getSphereExtent(),\n                sx = extent.sx,\n                sy = extent.sy;\n            let wrapX, wrapY;\n            let pre = coordinates[0], current, dx, dy, p;\n            const prj = [this.project(pre)];\n            for (let i = 1, l = coordinates.length; i < l; i++) {\n                current = coordinates[i];\n                dx = current.x - pre.x;\n                dy = current.y - pre.y;\n                p = this.project(current);\n                if (Math.abs(dx) > 180) {\n                    if (wrapX === undefined) {\n                        wrapX = current.x > pre.x;\n                    }\n                    if (wrapX) {\n                        p._add(-circum.x * sign(dx) * sx, 0);\n                        current._add(-360 * sign(dx), 0);\n                    }\n                }\n                if (Math.abs(dy) > 90) {\n                    if (wrapY === undefined) {\n                        wrapY = current.y < pre.y;\n                    }\n                    if (wrapY) {\n                        p._add(0, -circum.y * sign(dy) * sy);\n                        current._add(0, -180 * sign(dy));\n                    }\n                }\n                pre = current;\n                prj.push(p);\n            }\n            return prj;\n        }\n    },\n\n    /**\n     * Unproject a group of projected coordinates to geographical coordinates.\n     * @param  {Coordinate[]|Coordinate[][]|Coordinate[][][]} projCoords - projected coordinates to unproject\n     * @return {Coordinate[]|Coordinate[][]|Coordinate[][][]}\n     * @function projection.Common.unprojectCoords\n     */\n    unprojectCoords(projCoords) {\n        if (!projCoords) {\n            return [];\n        }\n        if (!Array.isArray(projCoords)) {\n            return this.unproject(projCoords);\n        }\n        return forEachCoord(projCoords, this.unproject, this);\n    },\n\n    /**\n     * Whether the projection is spherical\n     * @return {Boolean}\n     */\n    isSphere() {\n        return !!this.sphere;\n    },\n\n    /**\n     * If the projected coord out of the sphere\n     * @param  {Coordinate}  pcoord projected coord\n     * @return {Boolean}\n     */\n    isOutSphere(pcoord) {\n        if (!this.isSphere()) {\n            return false;\n        }\n        const extent = this.getSphereExtent();\n        return !extent.contains(pcoord);\n    },\n\n    /**\n     * Wrap the projected coord in the sphere\n     * @param  {Coordinate} pcoord projected coord\n     * @return {Coordinate} wrapped projected coord\n     */\n    wrapCoord(pcoord) {\n        if (!this.isSphere()) {\n            return pcoord;\n        }\n        const extent = this.getSphereExtent();\n        const wrapped = new Coordinate(pcoord);\n        if (!extent.contains(wrapped)) {\n            // wrapped.x = wrap(pcoord.x, extent.xmin, extent.xmax);\n            // wrapped.y = wrap(pcoord.y, extent.ymin, extent.ymax);\n            // FIXME: sakitam-fdd - config wrap coordinates\n            wrapped.x = pcoord.x;\n            wrapped.y = pcoord.y;\n        }\n        return wrapped;\n    },\n\n    getCircum() {\n        if (!this.circum && this.isSphere()) {\n            const extent = this.getSphereExtent();\n            this.circum = {\n                x : extent.getWidth(),\n                y : extent.getHeight()\n            };\n        }\n        return this.circum;\n    },\n\n    getSphereExtent() {\n        if (!this.extent && this.isSphere()) {\n            const max = this.project(new Coordinate(180, 90)),\n                min = this.project(new Coordinate(-180, -90));\n            this.extent = new Extent(min, max, this);\n            this.extent.sx = max.x > min.x ? 1 : -1;\n            this.extent.sy = max.y > min.y ? 1 : -1;\n        }\n        return this.extent;\n    }\n};\n","/**\n * This provides methods used for event handling. It's a mixin and not meant to be used directly.\n * @mixin Common\n * @memberOf measurer\n * @protected\n */\nexport default {\n    /**\n     * Measure length between coordinate c1 and coordinate c2\n     * @param  {coordinate} c1 coordinate\n     * @param  {coordinate} c2 coordinate\n     * @return {Number}    length\n     * @function measurer.Common.measureLength\n     */\n    measureLength: function (c1, c2) {\n        if (!Array.isArray(c1)) {\n            return this.measureLenBetween(c1, c2);\n        }\n        let len = 0;\n        for (let i = 0, l = c1.length; i < l - 1; i++) {\n            len += this.measureLenBetween(c1[i], c1[i + 1]);\n        }\n        return len;\n    }\n};\n","import { extend } from '../../core/util';\nimport Coordinate from '../Coordinate';\nimport Point from '../Point';\nimport Common from './Common';\n/**\n * Identity measurer, a measurer for Cartesian coordinate system.\n *\n * @class\n * @category geo\n * @protected\n * @memberOf measurer\n * @name Identity\n * @mixes measurer.Common\n */\nexport default extend(/** @lends measurer.Identity */{\n    /**\n     * the code of the measurer\n     * @static\n     * @type {String}\n     */\n    'measure': 'IDENTITY',\n    /**\n     * Measure the length between 2 coordinates.\n     * @param  {Coordinate} c1\n     * @param  {Coordinate} c2\n     * @return {Number}\n     */\n    measureLenBetween: function (c1, c2) {\n        if (!c1 || !c2) {\n            return 0;\n        }\n        try {\n            return Math.sqrt(Math.pow(c1.x - c2.x, 2) + Math.pow(c1.y - c2.y, 2));\n        } catch (err) {\n            return 0;\n        }\n    },\n    /**\n     * Measure the area closed by the given coordinates.\n     * @param  {Coordinate[]} coordinates\n     * @return {number}\n     */\n    measureArea: function (coordinates) {\n        if (!Array.isArray(coordinates)) {\n            return 0;\n        }\n        let area = 0;\n        for (let i = 0, len = coordinates.length; i < len; i++) {\n            const c1 = coordinates[i];\n            let c2 = null;\n            if (i === len - 1) {\n                c2 = coordinates[0];\n            } else {\n                c2 = coordinates[i + 1];\n            }\n            area += c1.x * c2.y - c1.y * c2.x;\n        }\n        return Math.abs(area / 2);\n    },\n\n    locate : function (c, xDist, yDist) {\n        c = new Coordinate(c.x, c.y);\n        return this._locate(c, xDist, yDist);\n    },\n\n    /**\n     * Locate a coordinate from the given source coordinate with a x-axis distance and a y-axis distance.\n     * @param  {Coordinate} c     - source coordinate\n     * @param  {Number} xDist     - x-axis distance\n     * @param  {Number} yDist     - y-axis distance\n     * @return {Coordinate}\n     */\n    _locate: function (c, xDist, yDist) {\n        if (!c) {\n            return null;\n        }\n        if (!xDist) {\n            xDist = 0;\n        }\n        if (!yDist) {\n            yDist = 0;\n        }\n        if (!xDist && !yDist) {\n            return c;\n        }\n        c.x = c.x + xDist;\n        c.y = c.y + yDist;\n        return c;\n    },\n\n    rotate : function (c, pivot, angle) {\n        c = new Coordinate(c.x, c.y);\n        return this._rotate(c, pivot, angle);\n    },\n\n    /**\n     * Rotate a coordinate of given angle around pivot\n     * @param {Coordinate} c  - source coordinate\n     * @param {Coordinate} pivot - pivot\n     * @param {Number} angle - angle in degree\n     * @return {Coordinate}\n     */\n    _rotate : function () {\n        const tmp = new Point(0, 0);\n        return function (c, pivot, angle) {\n            tmp.x = c.x - pivot.x;\n            tmp.y = c.y - pivot.y;\n            tmp._rotate(angle * Math.PI / 180);\n            c.x = pivot.x + tmp.x;\n            c.y = pivot.y + tmp.y;\n            return c;\n        };\n    }()\n}, Common);\n","import { toRadian, toDegree, extend, wrap } from '../../core/util';\nimport Coordinate from '../Coordinate';\nimport Common from './Common';\n\n/**\n * A helper class with common measure methods for Sphere.\n * @memberOf measurer\n * @private\n */\nclass Sphere {\n    /**\n     * @param  {Number} radius Sphere's radius\n     */\n    constructor(radius) {\n        this.radius = radius;\n    }\n\n    measureLenBetween(c1, c2) {\n        if (!c1 || !c2) {\n            return 0;\n        }\n        let b = toRadian(c1.y);\n        const d = toRadian(c2.y),\n            e = b - d,\n            f = toRadian(c1.x) - toRadian(c2.x);\n        b = 2 * Math.asin(Math.sqrt(Math.pow(Math.sin(e / 2), 2) + Math.cos(b) * Math.cos(d) * Math.pow(Math.sin(f / 2), 2)));\n        b *= this.radius;\n        return Math.round(b * 1E5) / 1E5;\n    }\n\n    measureArea(coordinates) {\n        const a = toRadian(this.radius);\n        let b = 0,\n            c = coordinates,\n            d = c.length;\n        if (d < 3) {\n            return 0;\n        }\n        let i;\n        for (i = 0; i < d - 1; i++) {\n            const e = c[i],\n                f = c[i + 1];\n            b += e.x * a * Math.cos(toRadian(e.y)) * f.y * a - f.x * a * Math.cos(toRadian(f.y)) * e.y * a;\n        }\n        d = c[i];\n        c = c[0];\n        b += d.x * a * Math.cos(toRadian(d.y)) * c.y * a - c.x * a * Math.cos(toRadian(c.y)) * d.y * a;\n        return 0.5 * Math.abs(b);\n    }\n\n    locate(c, xDist, yDist) {\n        c = new Coordinate(c.x, c.y);\n        return this._locate(c, xDist, yDist);\n    }\n\n    _locate(c, xDist, yDist) {\n        if (!c) {\n            return null;\n        }\n        if (!xDist) {\n            xDist = 0;\n        }\n        if (!yDist) {\n            yDist = 0;\n        }\n        if (!xDist && !yDist) {\n            return c;\n        }\n        let x, y;\n        let ry = toRadian(c.y);\n        if (yDist !== 0) {\n            const dy = Math.abs(yDist);\n            const sy = Math.sin(dy / (2 * this.radius)) * 2;\n            ry = ry + sy * (yDist > 0 ? 1 : -1);\n            y = wrap(ry * 180 / Math.PI, -90, 90);\n        } else {\n            y = c.y;\n        }\n        if (xDist !== 0) {\n            // distance per degree\n            const dx = Math.abs(xDist);\n            let rx = toRadian(c.x);\n            const sx = 2 * Math.sqrt(Math.pow(Math.sin(dx / (2 * this.radius)), 2) / Math.pow(Math.cos(ry), 2));\n            rx = rx + sx * (xDist > 0 ? 1 : -1);\n            x = wrap(rx * 180 / Math.PI, -180, 180);\n        } else {\n            x = c.x;\n        }\n        c.x = x;\n        c.y = y;\n        return c;\n    }\n\n    rotate(c, pivot, angle) {\n        c = new Coordinate(c);\n        return this._rotate(c, pivot, angle);\n    }\n\n    /**\n     * Rotate a coordinate of given angle around pivot\n     * @param {Coordinate} c  - source coordinate\n     * @param {Coordinate} pivot - pivot\n     * @param {Number} angle - angle in degree\n     * @return {Coordinate}\n     */\n    _rotate(c, pivot, angle) {\n        const initialAngle = rhumbBearing(pivot, c);\n        const finalAngle = initialAngle - angle;\n        const distance = this.measureLenBetween(pivot, c);\n        c.x = pivot.x;\n        c.y = pivot.y;\n        return calculateRhumbDestination(c, distance, finalAngle, this.radius);\n    }\n}\n\n// from turf.js\nfunction rhumbBearing(start, end, options = {}) {\n    let bear360;\n    if (options.final) bear360 = calculateRhumbBearing(end, start);\n    else bear360 = calculateRhumbBearing(start, end);\n\n    const bear180 = (bear360 > 180) ? -(360 - bear360) : bear360;\n\n    return bear180;\n}\n\nfunction calculateRhumbBearing(from, to) {\n    // φ => phi\n    // Δλ => deltaLambda\n    // Δψ => deltaPsi\n    // θ => theta\n    const phi1 = toRadian(from.y);\n    const phi2 = toRadian(to.y);\n    let deltaLambda = toRadian((to.x - from.x));\n    // if deltaLambdaon over 180° take shorter rhumb line across the anti-meridian:\n    if (deltaLambda > Math.PI) deltaLambda -= 2 * Math.PI;\n    if (deltaLambda < -Math.PI) deltaLambda += 2 * Math.PI;\n\n    const deltaPsi = Math.log(Math.tan(phi2 / 2 + Math.PI / 4) / Math.tan(phi1 / 2 + Math.PI / 4));\n\n    const theta = Math.atan2(deltaLambda, deltaPsi);\n\n    return (toDegree(theta) + 360) % 360;\n}\n\nfunction calculateRhumbDestination(origin, distance, bearing, radius) {\n    // φ => phi\n    // λ => lambda\n    // ψ => psi\n    // Δ => Delta\n    // δ => delta\n    // θ => theta\n\n    const delta = distance / radius; // angular distance in radians\n    const lambda1 = origin.x * Math.PI / 180; // to radians, but without normalize to 𝜋\n    const phi1 = toRadian(origin.y);\n    const theta = toRadian(bearing);\n\n    const DeltaPhi = delta * Math.cos(theta);\n    let phi2 = phi1 + DeltaPhi;\n\n    // check for some daft bugger going past the pole, normalise latitude if so\n    if (Math.abs(phi2) > Math.PI / 2) phi2 = phi2 > 0 ? Math.PI - phi2 : -Math.PI - phi2;\n\n    const DeltaPsi = Math.log(Math.tan(phi2 / 2 + Math.PI / 4) / Math.tan(phi1 / 2 + Math.PI / 4));\n    const q = Math.abs(DeltaPsi) > 10e-12 ? DeltaPhi / DeltaPsi : Math.cos(phi1); // E-W course becomes ill-conditioned with 0/0\n    const DeltaLambda = delta * Math.sin(theta) / q;\n    const lambda2 = lambda1 + DeltaLambda;\n\n    origin.x = ((lambda2 * 180 / Math.PI) + 540) % 360 - 180;\n    origin.y = phi2 * 180 / Math.PI;\n    return origin; // normalise to −180..+180°\n}\n\n/**\n * WGS84 Sphere measurer.\n * @class\n * @category geo\n * @protected\n * @memberOf measurer\n * @name WGS84Sphere\n * @mixes measurer.Common\n */\nexport const WGS84Sphere = extend(/** @lends measurer.WGS84Sphere */{\n    'measure': 'EPSG:4326',\n    sphere: new Sphere(6378137),\n    /**\n     * Measure the length between 2 coordinates.\n     * @param  {Coordinate} c1\n     * @param  {Coordinate} c2\n     * @return {Number}\n     */\n    measureLenBetween() {\n        return this.sphere.measureLenBetween.apply(this.sphere, arguments);\n    },\n    /**\n     * Measure the area closed by the given coordinates.\n     * @param  {Coordinate[]} coordinates\n     * @return {number}\n     */\n    measureArea() {\n        return this.sphere.measureArea.apply(this.sphere, arguments);\n    },\n\n    _locate() {\n        return this.sphere._locate.apply(this.sphere, arguments);\n    },\n\n    /**\n     * Locate a coordinate from the given source coordinate with a x-axis distance and a y-axis distance.\n     * @param  {Coordinate} c     - source coordinate\n     * @param  {Number} xDist              - x-axis distance\n     * @param  {Number} yDist              - y-axis distance\n     * @return {Coordinate}\n     */\n    locate() {\n        return this.sphere.locate.apply(this.sphere, arguments);\n    },\n\n    _rotate() {\n        return this.sphere._rotate.apply(this.sphere, arguments);\n    },\n\n    /**\n     * Rotate a coordinate of given angle around pivot\n     * @param {Coordinate} c  - source coordinate\n     * @param {Coordinate} pivot - pivot\n     * @param {Number} angle - angle in degree\n     * @return {Coordinate}\n     */\n    rotate() {\n        return this.sphere.rotate.apply(this.sphere, arguments);\n    }\n}, Common);\n\n/**\n * Baidu sphere measurer\n * @class\n * @category geo\n * @protected\n * @memberOf measurer\n * @name BaiduSphere\n * @mixes measurer.Common\n */\nexport const BaiduSphere = extend(/** @lends measurer.BaiduSphere */{\n    'measure': 'BAIDU',\n    sphere: new Sphere(6370996.81),\n    /**\n     * Measure the length between 2 coordinates.\n     * @param  {Coordinate} c1\n     * @param  {Coordinate} c2\n     * @return {Number}\n     */\n    measureLenBetween() {\n        return this.sphere.measureLenBetween.apply(this.sphere, arguments);\n    },\n    /**\n     * Measure the area closed by the given coordinates.\n     * @param  {Coordinate[]} coordinates\n     * @return {number}\n     */\n    measureArea() {\n        return this.sphere.measureArea.apply(this.sphere, arguments);\n    },\n\n    _locate() {\n        return this.sphere._locate.apply(this.sphere, arguments);\n    },\n\n    /**\n     * Locate a coordinate from the given source coordinate with a x-axis distance and a y-axis distance.\n     * @param  {Coordinate} c     - source coordinate\n     * @param  {Number} xDist              - x-axis distance\n     * @param  {Number} yDist              - y-axis distance\n     * @return {Coordinate}\n     */\n    locate() {\n        return this.sphere.locate.apply(this.sphere, arguments);\n    },\n\n    _rotate() {\n        return this.sphere._rotate.apply(this.sphere, arguments);\n    },\n\n    /**\n     * Rotate a coordinate of given angle around pivot\n     * @param {Coordinate} c  - source coordinate\n     * @param {Coordinate} pivot - pivot\n     * @param {Number} angle - angle in degree\n     * @return {Coordinate}\n     */\n    rotate() {\n        return this.sphere.rotate.apply(this.sphere, arguments);\n    }\n}, Common);\n","/** @namespace measurer */\n\nimport { hasOwn } from '../../core/util';\nimport Identity from './Identity';\nimport { WGS84Sphere, BaiduSphere } from './Sphere';\n\nexport { Identity };\nexport * from './Sphere';\n\n/**\n * Default measurer, [WGS84Sphere]{@link measurer.WGS84Sphere}\n *\n * @class\n * @category geo\n * @protected\n * @memberOf measurer\n * @name DEFAULT\n * @extends measurer.WGS84Sphere\n */\nexport const DEFAULT = WGS84Sphere;\n\n\nconst measurers = {};\n\nfunction registerMeasurer(m) {\n    measurers[m.measure] = m;\n}\n\nregisterMeasurer(Identity);\nregisterMeasurer(WGS84Sphere);\nregisterMeasurer(BaiduSphere);\n\n/**\n * @classdesc\n * Utilities with measurers. It is static and should not be initiated.<br>\n * Measurer provides methods for geographical computations such as length and area measuring, etc.\n * @class\n * @name Measurer\n * @memberOf measurer\n * @category geo\n */\nexport const Measurer = {\n    /**\n     * Get a measurer instance.\n     * @param  {String} name - code of the measurer: 'EPSG:4326', 'Identity', 'BAIDU'\n     * @return {Object} a measurer object\n     * @function measurer.Measurer.getInstance\n     */\n    getInstance(name) {\n        if (!name) {\n            return DEFAULT;\n        }\n        for (const p in measurers) {\n            if (hasOwn(measurers, p)) {\n                const mName = measurers[p]['measure'];\n                if (!mName) {\n                    continue;\n                }\n                if (name.toLowerCase() === mName.toLowerCase()) {\n                    return measurers[p];\n                }\n            }\n        }\n        return null;\n    }\n};\n\n","import { extend, wrap, sign } from '../../core/util';\nimport Common from './Projection';\nimport Coordinate from '../Coordinate';\nimport { WGS84Sphere } from '../measurer';\n\nconst delta = 1E-7;\n\n/**\n * Well-known projection used by Google maps or Open Street Maps, aka Mercator Projection.<br>\n * It is map's default projection.\n * @class\n * @category geo\n * @protected\n * @memberOf projection\n * @name EPSG3857\n * @mixes projection.Common\n * @mixes measurer.WGS84Sphere\n */\nexport default extend({}, Common, /** @lends projection.EPSG3857 */ {\n    /**\n     * \"EPSG:3857\", Code of the projection\n     * @type {String}\n     * @constant\n     */\n    code: 'EPSG:3857',\n    rad: Math.PI / 180,\n    metersPerDegree: 6378137 * Math.PI / 180,\n    maxLatitude: 85.0511287798,\n\n    project: function (lnglat, out) {\n        const rad = this.rad,\n            metersPerDegree = this.metersPerDegree,\n            max = this.maxLatitude;\n        const lng = lnglat.x,\n            lat = Math.max(Math.min(max, lnglat.y), -max);\n        let c;\n        if (lat === 0) {\n            c = 0;\n        } else {\n            c = Math.log(Math.tan((90 + lat) * rad / 2)) / rad;\n        }\n        const x = lng * metersPerDegree;\n        const y = c * metersPerDegree;\n        if (out) {\n            out.x = x;\n            out.y = y;\n            return out;\n        }\n        return new Coordinate(x, y);\n    },\n\n    unproject: function (pLnglat, out) {\n        const rad = this.rad;\n        const metersPerDegree = this.metersPerDegree;\n        let x = pLnglat.x / metersPerDegree;\n        const y = pLnglat.y;\n        let c;\n        if (y === 0) {\n            c = 0;\n        } else {\n            c = y / metersPerDegree;\n            c = (2 * Math.atan(Math.exp(c * rad)) - Math.PI / 2) / rad;\n        }\n        if (Math.abs(Math.abs(x) - 180) < delta) {\n            x = sign(x) * 180;\n        }\n        if (Math.abs(Math.abs(c) - this.maxLatitude) < delta) {\n            c = sign(c) * this.maxLatitude;\n        }\n        // const rx = wrap(x, -180, 180);\n        // const ry = wrap(c, -this.maxLatitude, this.maxLatitude);\n        // FIXME: sakitam-fdd - config wrap coordinates\n        // return new Coordinate(x / metersPerDegree, c);\n\n        // const rx = wrap(x / metersPerDegree, -180, 180);\n        const rx = x;\n        const ry = c;\n        if (out) {\n            out.x = rx;\n            out.y = ry;\n            return out;\n        }\n        return new Coordinate(rx, ry);\n    }\n}, WGS84Sphere);\n","import { extend } from '../../core/util';\nimport Common from './Projection';\nimport Coordinate from '../Coordinate';\nimport { WGS84Sphere } from '../measurer';\n\n/**\n * A common CRS among GIS enthusiasts. Uses simple Equirectangular projection.\n *\n * @class\n * @category geo\n * @protected\n * @memberOf projection\n * @name EPSG4326\n * @mixes projection.Common\n * @mixes measurer.WGS84Sphere\n */\nexport default extend({}, Common, /** @lends projection.EPSG4326 */ {\n    /**\n     * \"EPSG:4326\", Code of the projection\n     * @type {String}\n     * @constant\n     */\n    code: 'EPSG:4326',\n    project: function (p, out) {\n        if (out) {\n            out.x = p.x;\n            out.y = p.y;\n            return out;\n        }\n        return new Coordinate(p);\n    },\n    unproject: function (p, out) {\n        if (out) {\n            out.x = p.x;\n            out.y = p.y;\n            return out;\n        }\n        return new Coordinate(p);\n    }\n}, WGS84Sphere);\n","import { extend } from '../../core/util';\nimport PROJ4326 from './Projection.EPSG4326';\n\n/**\n * For CGCS2000\n *\n * @class\n * @category geo\n * @protected\n * @memberOf projection\n * @name EPSG4490\n * @mixes projection.EPSG4326\n * @mixes measurer.WGS84Sphere\n */\nexport default extend({}, PROJ4326, /** @lends projection.EPSG4490 */ {\n    /**\n     * \"EPSG:4490\", Code of the projection\n     * @type {String}\n     * @constant\n     */\n    code: 'EPSG:4490'\n});\n","import { extend } from '../../core/util';\nimport Common from './Projection';\nimport Coordinate from '../Coordinate';\nimport { BaiduSphere } from '../measurer';\n\n/**\n * Projection used by [Baidu Map]{@link http://map.baidu.com}\n * @class\n * @category geo\n * @protected\n * @memberOf projection\n * @name BAIDU\n * @mixes projection.Common\n * @mixes measurer.BaiduSphere\n */\nexport default extend({}, Common, /** @lends projection.BAIDU */ {\n    /**\n     * \"BAIDU\", Code of the projection\n     * @type {String}\n     * @constant\n     */\n    code: 'BAIDU',\n\n    project: function (p, out) {\n        return this.convertLL2MC(p, out);\n    },\n\n    unproject: function (p, out) {\n        return this.convertMC2LL(p, out);\n    }\n}, BaiduSphere, {\n    EARTHRADIUS: 6370996.81,\n    MCBAND: [12890594.86, 8362377.87, 5591021, 3481989.83, 1678043.12, 0],\n    LLBAND: [75, 60, 45, 30, 15, 0],\n    MC2LL: [\n        [1.410526172116255e-8, 0.00000898305509648872, -1.9939833816331, 200.9824383106796, -187.2403703815547, 91.6087516669843, -23.38765649603339, 2.57121317296198, -0.03801003308653, 17337981.2],\n        [-7.435856389565537e-9, 0.000008983055097726239, -0.78625201886289, 96.32687599759846, -1.85204757529826, -59.36935905485877, 47.40033549296737, -16.50741931063887, 2.28786674699375, 10260144.86],\n        [-3.030883460898826e-8, 0.00000898305509983578, 0.30071316287616, 59.74293618442277, 7.357984074871, -25.38371002664745, 13.45380521110908, -3.29883767235584, 0.32710905363475, 6856817.37],\n        [-1.981981304930552e-8, 0.000008983055099779535, 0.03278182852591, 40.31678527705744, 0.65659298677277, -4.44255534477492, 0.85341911805263, 0.12923347998204, -0.04625736007561, 4482777.06],\n        [3.09191371068437e-9, 0.000008983055096812155, 0.00006995724062, 23.10934304144901, -0.00023663490511, -0.6321817810242, -0.00663494467273, 0.03430082397953, -0.00466043876332, 2555164.4],\n        [2.890871144776878e-9, 0.000008983055095805407, -3.068298e-8, 7.47137025468032, -0.00000353937994, -0.02145144861037, -0.00001234426596, 0.00010322952773, -0.00000323890364, 826088.5]\n    ],\n    LL2MC: [\n        [-0.0015702102444, 111320.7020616939, 1704480524535203, -10338987376042340, 26112667856603880, -35149669176653700, 26595700718403920, -10725012454188240, 1800819912950474, 82.5],\n        [0.0008277824516172526, 111320.7020463578, 647795574.6671607, -4082003173.641316, 10774905663.51142, -15171875531.51559, 12053065338.62167, -5124939663.577472, 913311935.9512032, 67.5],\n        [0.00337398766765, 111320.7020202162, 4481351.045890365, -23393751.19931662, 79682215.47186455, -115964993.2797253, 97236711.15602145, -43661946.33752821, 8477230.501135234, 52.5],\n        [0.00220636496208, 111320.7020209128, 51751.86112841131, 3796837.749470245, 992013.7397791013, -1221952.21711287, 1340652.697009075, -620943.6990984312, 144416.9293806241, 37.5],\n        [-0.0003441963504368392, 111320.7020576856, 278.2353980772752, 2485758.690035394, 6070.750963243378, 54821.18345352118, 9540.606633304236, -2710.55326746645, 1405.483844121726, 22.5],\n        [-0.0003218135878613132, 111320.7020701615, 0.00369383431289, 823725.6402795718, 0.46104986909093, 2351.343141331292, 1.58060784298199, 8.77738589078284, 0.37238884252424, 7.45]\n    ],\n\n    convertMC2LL: function (cB, out) {\n        let cE;\n        for (let cD = 0, len = this.MCBAND.length; cD < len; cD++) {\n            if (Math.abs(cB.y) >= this.MCBAND[cD]) {\n                cE = this.MC2LL[cD];\n                break;\n            }\n        }\n        const T = this.convertor(cB, cE, out);\n        return T;\n    },\n    convertLL2MC: function (T, out) {\n        let cD, cC, len;\n        T.x = this.getLoop(T.x, -180, 180);\n        T.y = this.getRange(T.y, -74, 74);\n        const cB = new Coordinate(T.x, T.y);\n        for (cC = 0, len = this.LLBAND.length; cC < len; cC++) {\n            if (cB.y >= this.LLBAND[cC]) {\n                cD = this.LL2MC[cC];\n                break;\n            }\n        }\n        if (!cD) {\n            for (cC = this.LLBAND.length - 1; cC >= 0; cC--) {\n                if (cB.y <= -this.LLBAND[cC]) {\n                    cD = this.LL2MC[cC];\n                    break;\n                }\n            }\n        }\n        const cE = this.convertor(T, cD, out);\n        return cE;\n    },\n    convertor: function (cC, cD, out) {\n        if (!cC || !cD) {\n            return null;\n        }\n        let T = cD[0] + cD[1] * Math.abs(cC.x);\n        const cB = Math.abs(cC.y) / cD[9];\n        let cE = cD[2] + cD[3] * cB + cD[4] * cB * cB +\n            cD[5] * cB * cB * cB + cD[6] * cB * cB * cB * cB +\n            cD[7] * cB * cB * cB * cB * cB +\n            cD[8] * cB * cB * cB * cB * cB * cB;\n        T *= (cC.x < 0 ? -1 : 1);\n        cE *= (cC.y < 0 ? -1 : 1);\n        if (out) {\n            out.x = T;\n            out.y = cE;\n            return out;\n        }\n        return new Coordinate(T, cE);\n    },\n    toRadians: function (T) {\n        return Math.PI * T / 180;\n    },\n    toDegrees: function (T) {\n        return (180 * T) / Math.PI;\n    },\n    getRange: function (cC, cB, T) {\n        if (cB != null) {\n            cC = Math.max(cC, cB);\n        }\n        if (T != null) {\n            cC = Math.min(cC, T);\n        }\n        return cC;\n    },\n    getLoop: function (cC, cB, T) {\n        if (cC === Infinity) {\n            return T;\n        } else if (cC === -Infinity) {\n            return cB;\n        }\n        while (cC > T) {\n            cC -= T - cB;\n        }\n        while (cC < cB) {\n            cC += T - cB;\n        }\n        return cC;\n    }\n});\n","import { extend } from '../../core/util';\nimport Common from './Projection';\nimport { Identity } from '../measurer';\n\n/**\n * A projection based on Cartesian coordinate system.<br>\n * This projection maps x, y directly, it is useful for maps of flat surfaces (e.g. indoor maps, game maps).\n * @class\n * @category geo\n * @protected\n * @memberOf projection\n * @name IDENTITY\n * @mixes projection.Common\n * @mixes measurer.Identity\n */\nexport default extend({}, Common, /** @lends projection.IDENTITY */ {\n    /**\n     * \"IDENTITY\", Code of the projection\n     * @type {String}\n     * @constant\n     */\n    code: 'IDENTITY',\n    project: function (p, out) {\n        if (out) {\n            out.x = p.x;\n            out.y = p.y;\n            return out;\n        }\n        return p.copy();\n    },\n    unproject: function (p, out) {\n        if (out) {\n            out.x = p.x;\n            out.y = p.y;\n            return out;\n        }\n        return p.copy();\n    }\n}, Identity);\n","/** @namespace projection */\n\nimport EPSG3857 from './Projection.EPSG3857';\n\nexport { default as EPSG4326 } from './Projection.EPSG4326';\nexport { default as EPSG4490 } from './Projection.EPSG4490';\nexport { default as BAIDU } from './Projection.Baidu';\nexport { default as IDENTITY } from './Projection.IDENTITY';\nexport { EPSG3857 };\nexport { default as Common } from './Projection';\n/**\n * Default projection, [EPSG3857]{@link projection.EPSG3857}\n *\n * @class\n * @category geo\n * @protected\n * @memberOf projection\n * @name DEFAULT\n * @extends projection.EPSG3857\n */\nexport const DEFAULT = EPSG3857;\n","/**\n * Common methods for classes can be rendered, e.g. Map, Layers\n * @mixin Renderable\n * @protected\n */\nexport default Base =>\n    class extends Base {\n        /**\n         * Register a renderer class with the given name.\n         * @param  {String} name  - renderer's register key\n         * @param  {Function} clazz - renderer's class, a function (not necessarily a [Class]{@link Class}).\n         * @return {*} this\n         * @function Renderable.registerRenderer\n         */\n        static registerRenderer(name, clazz) {\n            const proto = this.prototype;\n            const parentProto = Object.getPrototypeOf(proto);\n            if (!proto._rendererClasses || proto._rendererClasses === parentProto._rendererClasses) {\n                proto._rendererClasses = proto._rendererClasses ? Object.create(proto._rendererClasses) : {};\n            }\n            proto._rendererClasses[name.toLowerCase()] = clazz;\n            return this;\n        }\n\n        /**\n         * Get the registered renderer class by the given name\n         * @param  {String} name  - renderer's register key\n         * @return {Function} renderer's class\n         * @function Renderable.getRendererClass\n         */\n        static getRendererClass(name) {\n            const proto = this.prototype;\n            if (!proto._rendererClasses) {\n                return null;\n            }\n            return proto._rendererClasses[name.toLowerCase()];\n        }\n    };\n","import { now, isNil, isArrayHasData, isSVG, IS_NODE, loadImage, hasOwn } from '../../core/util';\nimport Class from '../../core/Class';\nimport Browser from '../../core/Browser';\nimport Promise from '../../core/Promise';\nimport Canvas2D from '../../core/Canvas';\nimport Point from '../../geo/Point';\n\n/**\n * @classdesc\n * Base Class to render layer on HTMLCanvasElement\n * @abstract\n * @protected\n * @memberOf renderer\n * @extends Class\n */\nclass CanvasRenderer extends Class {\n\n    /**\n     * @param  {Layer} layer the layer to render\n     */\n    constructor(layer) {\n        super();\n        this.layer = layer;\n        this._painted = false;\n        this._drawTime = 0;\n        this.setToRedraw();\n    }\n\n\n    /**\n     * Render the layer.\n     * Call checkResources\n     */\n    render(framestamp) {\n        this.prepareRender();\n        if (!this.getMap() || !this.layer.isVisible()) {\n            return;\n        }\n        if (!this.resources) {\n            /* eslint-disable no-use-before-define */\n            this.resources = new ResourceCache();\n            /* eslint-enable no-use-before-define */\n        }\n        if (this.checkResources) {\n            const resources = this.checkResources();\n            if (resources.length > 0) {\n                this._loadingResource = true;\n                this.loadResources(resources).then(() => {\n                    this._loadingResource = false;\n                    if (this.layer) {\n                        /**\n                         * resourceload event, fired when external resources of the layer complete loading.\n                         *\n                         * @event Layer#resourceload\n                         * @type {Object}\n                         * @property {String} type     - resourceload\n                         * @property {Layer} target    - layer\n                         */\n                        this.layer.fire('resourceload');\n                        this.setToRedraw();\n                    }\n                });\n            } else {\n                this._tryToDraw(framestamp);\n            }\n        } else {\n            this._tryToDraw(framestamp);\n        }\n    }\n\n    /**\n     * Check if has any external resources to load\n     * If yes, load the resources before calling draw method\n     * @abstract\n     * @method checkResources\n     * @instance\n     * @returns {Array[]} an array of resource arrays [ [url1, width, height], [url2, width, height], [url3, width, height] .. ]\n     * @memberOf renderer.CanvasRenderer\n     */\n\n    /**\n     * a required abstract method to implement\n     * draw the layer when map is not interacting\n     * @abstract\n     * @instance\n     * @method draw\n     * @memberOf renderer.CanvasRenderer\n     */\n\n    /**\n     * an optional abstract method to implement\n     * draw the layer when map is interacting (moving/zooming/dragrotating)\n     * @abstract\n     * @instance\n     * @method drawOnInteracting\n     * @param {Object} eventParam event parameters\n     * @memberOf renderer.CanvasRenderer\n     */\n\n    /**\n     * @private\n     */\n    testIfNeedRedraw() {\n        const map = this.getMap();\n        if (this._loadingResource) {\n            return false;\n        }\n        if (this._toRedraw) {\n            return true;\n        }\n        if (map.isInteracting() && !this.drawOnInteracting) {\n            return false;\n        }\n        if (this.needToRedraw()) {\n            return true;\n        }\n        return false;\n    }\n\n    /**\n     * Ask whether the layer renderer needs to redraw\n     * @return {Boolean}\n     */\n    needToRedraw() {\n        const map = this.getMap();\n        if (map.isInteracting()) {\n            // don't redraw when map is moving without any pitch\n            return !(!map.getPitch() && map.isMoving() && !map.isZooming() && !map.isRotating() && !this.layer.options['forceRenderOnMoving']);\n        }\n        return false;\n    }\n\n    /**\n     * A callback for overriding when drawOnInteracting is skipped due to low fps\n     */\n    onSkipDrawOnInteracting() {\n\n    }\n\n    isLoadingResource() {\n        return this._loadingResource;\n    }\n\n    isRenderComplete() {\n        return !!this._renderComplete;\n    }\n\n    /**\n     * Whether must call render instead of drawOnInteracting when map is interacting\n     */\n    mustRenderOnInteracting() {\n        return !this._painted || (this.checkResources && this.checkResources().length > 0);\n    }\n\n    /**\n     * Set to redraw, ask map to call draw/drawOnInteracting to redraw the layer\n     */\n    setToRedraw() {\n        this._toRedraw = true;\n        return this;\n    }\n\n    /**\n     *  Mark layer's canvas updated\n     */\n    setCanvasUpdated() {\n        this._canvasUpdated = true;\n        return this;\n    }\n\n    /**\n     * Only called by map's renderer to check whether the layer's canvas is updated\n     * @protected\n     * @return {Boolean}\n     */\n    isCanvasUpdated() {\n        return !!this._canvasUpdated;\n    }\n\n    /**\n     * Remove the renderer, will be called when layer is removed\n     */\n    remove() {\n        this.onRemove();\n        delete this._loadingResource;\n        delete this.southWest;\n        delete this.canvas;\n        delete this.context;\n        delete this.canvasExtent2D;\n        delete this._extent2D;\n        delete this.resources;\n        delete this.layer;\n    }\n\n    onRemove() {}\n\n    onAdd() {}\n\n    /**\n     * Get map\n     * @return {Map}\n     */\n    getMap() {\n        if (!this.layer) {\n            return null;\n        }\n        return this.layer.getMap();\n    }\n\n    /**\n     * Get renderer's Canvas image object\n     * @return {HTMLCanvasElement}\n     */\n    getCanvasImage() {\n        const map = this.getMap();\n        this._canvasUpdated = false;\n        if (this._renderZoom !== map.getZoom() || !this.canvas || !this._extent2D) {\n            return null;\n        }\n        if (this.isBlank()) {\n            return null;\n        }\n        if (this.layer.isEmpty && this.layer.isEmpty()) {\n            return null;\n        }\n        // size = this._extent2D.getSize(),\n        const containerPoint = map._pointToContainerPoint(this.southWest)._add(0, -map.height);\n        return {\n            'image': this.canvas,\n            'layer': this.layer,\n            'point': containerPoint/* ,\n            'size': size */\n        };\n    }\n\n    /**\n     * Clear canvas\n     */\n    clear() {\n        this.clearCanvas();\n    }\n\n    /**\n     * A method to help improve performance.\n     * If you are sure that layer's canvas is blank, returns true to save unnecessary layer works of maps.\n     * @return {Boolean}\n     */\n    isBlank() {\n        if (!this._painted) {\n            return true;\n        }\n        return false;\n    }\n\n    /**\n     * Show the layer\n     */\n    show() {\n        this.setToRedraw();\n    }\n\n    /**\n     * Hide the layer\n     */\n    hide() {\n        this.clear();\n        this.setToRedraw();\n    }\n\n    /**\n     * Set z-index of layer\n     */\n    setZIndex(/*z*/) {\n        this.setToRedraw();\n    }\n\n    /**\n     * Detect if there is anything painted on the given point\n     * @param  {Point} point containerPoint\n     * @return {Boolean}\n     */\n    hitDetect(point) {\n        if (!this.context || (this.layer.isEmpty && this.layer.isEmpty()) || this.isBlank() || this._errorThrown) {\n            return false;\n        }\n        const map = this.getMap();\n        const r = map.getDevicePixelRatio();\n        const size = map.getSize();\n        if (point.x < 0 || point.x > size['width'] * r || point.y < 0 || point.y > size['height'] * r) {\n            return false;\n        }\n        try {\n            const imgData = this.context.getImageData(r * point.x, r * point.y, 1, 1).data;\n            if (imgData[3] > 0) {\n                return true;\n            }\n        } catch (error) {\n            if (!this._errorThrown) {\n                if (console) {\n                    console.warn('hit detect failed with tainted canvas, some geometries have external resources in another domain:\\n', error);\n                }\n                this._errorThrown = true;\n            }\n            //usually a CORS error will be thrown if the canvas uses resources from other domain.\n            //this may happen when a geometry is filled with pattern file.\n            return false;\n        }\n        return false;\n\n    }\n\n    /**\n     * loadResource from resourceUrls\n     * @param  {String[]} resourceUrls    - Array of urls to load\n     * @param  {Function} onComplete          - callback after loading complete\n     * @param  {Object} context         - callback's context\n     * @returns {Promise[]}\n     */\n    loadResources(resourceUrls) {\n        if (!this.resources) {\n            /* eslint-disable no-use-before-define */\n            this.resources = new ResourceCache();\n            /* eslint-enable no-use-before-define */\n        }\n        const resources = this.resources,\n            promises = [];\n        if (isArrayHasData(resourceUrls)) {\n            const cache = {};\n            for (let i = resourceUrls.length - 1; i >= 0; i--) {\n                const url = resourceUrls[i];\n                if (!url || !url.length || cache[url.join('-')]) {\n                    continue;\n                }\n                cache[url.join('-')] = 1;\n                if (!resources.isResourceLoaded(url, true)) {\n                    //closure it to preserve url's value\n                    promises.push(new Promise(this._promiseResource(url)));\n                }\n            }\n        }\n        return Promise.all(promises);\n    }\n\n    /**\n     * Prepare rendering\n     * Set necessary properties, like this._renderZoom/ this.canvasExtent2D, this.southWest\n     * @private\n     */\n    prepareRender() {\n        delete this._renderComplete;\n        const map = this.getMap();\n        this._renderZoom = map.getZoom();\n        this.canvasExtent2D = this._extent2D = map._get2DExtent();\n        //change from northWest to southWest, because northwest's point <=> containerPoint changes when pitch >= 72\n        this.southWest = map._containerPointToPoint(new Point(0, map.height));\n    }\n\n    /**\n     * Create renderer's Canvas\n     */\n    createCanvas() {\n        if (this.canvas) {\n            return;\n        }\n        const map = this.getMap();\n        const size = map.getSize();\n        const r = map.getDevicePixelRatio(),\n            w = r * size.width,\n            h = r * size.height;\n        if (this.layer._canvas) {\n            const canvas = this.layer._canvas;\n            canvas.width = w;\n            canvas.height = h;\n            if (canvas.style) {\n                canvas.style.width = size.width + 'px';\n                canvas.style.height = size.height + 'px';\n            }\n            this.canvas = this.layer._canvas;\n        } else {\n            this.canvas = Canvas2D.createCanvas(w, h, map.CanvasClass);\n        }\n\n        this.onCanvasCreate();\n\n    }\n\n    onCanvasCreate() {\n\n    }\n\n    createContext() {\n        //Be compatible with layer renderers that overrides create canvas and create gl/context\n        if (this.gl && this.gl.canvas === this.canvas || this.context) {\n            return;\n        }\n        this.context = this.canvas.getContext('2d');\n        if (!this.context) {\n            return;\n        }\n        if (this.layer.options['globalCompositeOperation']) {\n            this.context.globalCompositeOperation = this.layer.options['globalCompositeOperation'];\n        }\n        const dpr = this.getMap().getDevicePixelRatio();\n        if (dpr !== 1) {\n            this.context.scale(dpr, dpr);\n        }\n    }\n\n    resetCanvasTransform() {\n        if (!this.context) {\n            return;\n        }\n        const dpr = this.getMap().getDevicePixelRatio();\n        this.context.setTransform(dpr, 0, 0, dpr, 0, 0);\n    }\n\n    /**\n     * Resize the canvas\n     * @param  {Size} canvasSize the size resizing to\n     */\n    resizeCanvas(canvasSize) {\n        const canvas = this.canvas;\n        if (!canvas) {\n            return;\n        }\n        const size = canvasSize || this.getMap().getSize();\n        const r = this.getMap().getDevicePixelRatio();\n        if (canvas.width === r * size.width && canvas.height === r * size.height) {\n            return;\n        }\n        //retina support\n        canvas.height = r * size.height;\n        canvas.width = r * size.width;\n        if (r !== 1 && this.context) {\n            this.context.scale(r, r);\n        }\n        if (this.layer._canvas && canvas.style) {\n            canvas.style.width = size.width + 'px';\n            canvas.style.height = size.height + 'px';\n        }\n    }\n\n    /**\n     * Clear the canvas to blank\n     */\n    clearCanvas() {\n        if (!this.context) {\n            return;\n        }\n        Canvas2D.clearRect(this.context, 0, 0, this.canvas.width, this.canvas.height);\n    }\n\n    /**\n     * Prepare the canvas for rendering. <br>\n     * 1. Clear the canvas to blank. <br>\n     * 2. Clip the canvas by mask if there is any and return the mask's extent\n     * @return {PointExtent} mask's extent of current zoom's 2d point.\n     */\n    prepareCanvas() {\n        if (!this.canvas) {\n            this.createCanvas();\n            this.createContext();\n            /**\n             * canvascreate event, fired when canvas created.\n             *\n             * @event Layer#canvascreate\n             * @type {Object}\n             * @property {String} type     - canvascreate\n             * @property {Layer} target    - layer\n             * @property {CanvasRenderingContext2D} context - canvas's context\n             * @property {WebGLRenderingContext2D} gl  - canvas's webgl context\n             */\n            this.layer.fire('canvascreate', {\n                'context' : this.context,\n                'gl' : this.gl\n            });\n        } else {\n            this.clearCanvas();\n            this.resizeCanvas();\n            this.resetCanvasTransform();\n        }\n        delete this._maskExtent;\n        const mask = this.layer.getMask();\n        // this.context may be not available\n        if (!mask) {\n            this.layer.fire('renderstart', {\n                'context': this.context,\n                'gl' : this.gl\n            });\n            return null;\n        }\n        const maskExtent2D = this._maskExtent = mask._getPainter().get2DExtent();\n        if (!maskExtent2D.intersects(this._extent2D)) {\n            this.layer.fire('renderstart', {\n                'context': this.context,\n                'gl' : this.gl\n            });\n            return maskExtent2D;\n        }\n        /**\n         * renderstart event, fired when layer starts to render.\n         *\n         * @event Layer#renderstart\n         * @type {Object}\n         * @property {String} type              - renderstart\n         * @property {Layer} target    - layer\n         * @property {CanvasRenderingContext2D} context - canvas's context\n         */\n        this.layer.fire('renderstart', {\n            'context': this.context,\n            'gl' : this.gl\n        });\n        return maskExtent2D;\n    }\n\n    clipCanvas(context) {\n        const mask = this.layer.getMask();\n        if (!mask) {\n            return false;\n        }\n        const old = this.southWest;\n        const map = this.getMap();\n        //when clipping, layer's southwest needs to be reset for mask's containerPoint conversion\n        this.southWest = map._containerPointToPoint(new Point(0, map.height));\n        context.save();\n        const dpr = map.getDevicePixelRatio();\n        if (dpr !== 1) {\n            context.save();\n            context.scale(dpr, dpr);\n        }\n        // Handle MultiPolygon\n        if (mask.getGeometries) {\n            context.isMultiClip = true;\n            const masks = mask.getGeometries() || [];\n            context.beginPath();\n            masks.forEach(_mask => {\n                const painter =  _mask._getPainter();\n                painter.paint(null, context);\n            });\n            context.stroke();\n            delete context.isMultiClip;\n        } else {\n            const painter = mask._getPainter();\n            painter.paint(null, context);\n        }\n        if (dpr !== 1) {\n            context.restore();\n        }\n        context.clip();\n        this.southWest = old;\n        return true;\n    }\n\n    /**\n     * Get renderer's current view extent in 2d point\n     * @return {Object} view.extent, view.maskExtent, view.zoom, view.southWest\n     */\n    getViewExtent() {\n        return {\n            'extent' : this._extent2D,\n            'maskExtent' : this._maskExtent,\n            'zoom' : this._renderZoom,\n            'southWest' : this.southWest\n        };\n    }\n\n    /**\n     * call when rendering completes, this will fire necessary events and call setCanvasUpdated\n     */\n    completeRender() {\n        if (this.getMap()) {\n            this._renderComplete = true;\n            /**\n             * renderend event, fired when layer ends rendering.\n             *\n             * @event Layer#renderend\n             * @type {Object}\n             * @property {String} type              - renderend\n             * @property {Layer} target    - layer\n             * @property {CanvasRenderingContext2D} context - canvas's context\n             */\n            this.layer.fire('renderend', {\n                'context': this.context,\n                'gl' : this.gl\n            });\n            this.setCanvasUpdated();\n        }\n    }\n\n    /**\n     * Get renderer's event map registered on the map\n     * @return {Object} events\n     */\n    getEvents() {\n        return {\n            '_zoomstart' : this.onZoomStart,\n            '_zooming' : this.onZooming,\n            '_zoomend' : this.onZoomEnd,\n            '_resize'  : this.onResize,\n            '_movestart' : this.onMoveStart,\n            '_moving' : this.onMoving,\n            '_moveend' : this.onMoveEnd,\n            '_dragrotatestart' : this.onDragRotateStart,\n            '_dragrotating' : this.onDragRotating,\n            '_dragrotateend' : this.onDragRotateEnd,\n            '_spatialreferencechange' : this.onSpatialReferenceChange\n        };\n    }\n\n    /**\n    /**\n     * onZoomStart\n     * @param  {Object} param event parameters\n     */\n    onZoomStart() {\n    }\n\n    /**\n    * onZoomEnd\n    * @param  {Object} param event parameters\n    */\n    onZoomEnd() {\n        this.setToRedraw();\n    }\n\n    /**\n    * onZooming\n    * @param  {Object} param event parameters\n    */\n    onZooming() {}\n\n    /**\n    * onMoveStart\n    * @param  {Object} param event parameters\n    */\n    onMoveStart() {}\n\n    /**\n    * onMoving\n    * @param  {Object} param event parameters\n    */\n    onMoving() {}\n\n    /**\n    * onMoveEnd\n    * @param  {Object} param event parameters\n    */\n    onMoveEnd() {\n        this.setToRedraw();\n    }\n\n    /**\n    * onResize\n    * @param  {Object} param event parameters\n    */\n    onResize() {\n        delete this._extent2D;\n        this.resizeCanvas();\n        this.setToRedraw();\n    }\n\n    /**\n    * onDragRotateStart\n    * @param  {Object} param event parameters\n    */\n    onDragRotateStart() {}\n\n    /**\n    * onDragRotating\n    * @param  {Object} param event parameters\n    */\n    onDragRotating() {}\n\n    /**\n    * onDragRotateEnd\n    * @param  {Object} param event parameters\n    */\n    onDragRotateEnd() {\n        this.setToRedraw();\n    }\n\n    /**\n    * onSpatialReferenceChange\n    * @param  {Object} param event parameters\n    */\n    onSpatialReferenceChange() {\n    }\n\n    /**\n     * Get ellapsed time of previous drawing\n     * @return {Number}\n     */\n    getDrawTime() {\n        return this._drawTime;\n    }\n\n    _tryToDraw(framestamp) {\n        this._toRedraw = false;\n        if (!this.canvas && this.layer.isEmpty && this.layer.isEmpty()) {\n            this._renderComplete = true;\n            // not to create canvas when layer is empty\n            return;\n        }\n        this._drawAndRecord(framestamp);\n    }\n\n    _drawAndRecord(framestamp) {\n        if (!this.getMap()) {\n            return;\n        }\n        const painted = this._painted;\n        this._painted = true;\n        let t = now();\n        this.draw(framestamp);\n        t = now() - t;\n        //reduce some time in the first draw\n        this._drawTime = painted ? t  : t / 2;\n        if (painted && this.layer && this.layer.options['logDrawTime']) {\n            console.log(this.layer.getId(), 'frameTimeStamp:', framestamp, 'drawTime:', this._drawTime);\n        }\n    }\n\n    _promiseResource(url) {\n        const me = this, resources = this.resources,\n            crossOrigin = this.layer.options['crossOrigin'];\n        return function (resolve) {\n            if (resources.isResourceLoaded(url, true)) {\n                resolve(url);\n                return;\n            }\n            const img = new Image();\n            if (!isNil(crossOrigin)) {\n                img['crossOrigin'] = crossOrigin;\n            }\n            if (isSVG(url[0]) && !IS_NODE) {\n                //amplify the svg image to reduce loading.\n                if (url[1]) { url[1] *= 2; }\n                if (url[2]) { url[2] *= 2; }\n            }\n            img.onload = function () {\n                me._cacheResource(url, img);\n                resolve(url);\n            };\n            img.onabort = function (err) {\n                if (console) { console.warn('image loading aborted: ' + url[0]); }\n                if (err) {\n                    if (console) { console.warn(err); }\n                }\n                resolve(url);\n            };\n            img.onerror = function (err) {\n                // if (console) { console.warn('image loading failed: ' + url[0]); }\n                if (err && typeof console !== 'undefined') {\n                    console.warn(err);\n                }\n                resources.markErrorResource(url);\n                resolve(url);\n            };\n            loadImage(img,  url);\n        };\n\n    }\n\n    _cacheResource(url, img) {\n        if (!this.layer || !this.resources) {\n            return;\n        }\n        let w = url[1], h = url[2];\n        if (this.layer.options['cacheSvgOnCanvas'] && isSVG(url[0]) === 1 && (Browser.edge || Browser.ie)) {\n            //opacity of svg img painted on canvas is always 1, so we paint svg on a canvas at first.\n            if (isNil(w)) {\n                w = img.width || this.layer.options['defaultIconSize'][0];\n            }\n            if (isNil(h)) {\n                h = img.height || this.layer.options['defaultIconSize'][1];\n            }\n            const canvas = Canvas2D.createCanvas(w, h);\n            Canvas2D.image(canvas.getContext('2d'), img, 0, 0, w, h);\n            img = canvas;\n        }\n        this.resources.addResource(url, img);\n    }\n}\n\nexport default CanvasRenderer;\n\nexport class ResourceCache {\n    constructor() {\n        this.resources = {};\n        this._errors = {};\n    }\n\n    addResource(url, img) {\n        this.resources[url[0]] = {\n            image: img,\n            width: +url[1],\n            height: +url[2]\n        };\n    }\n\n    isResourceLoaded(url, checkSVG) {\n        if (!url) {\n            return false;\n        }\n        const imgUrl = this._getImgUrl(url);\n        if (this._errors[imgUrl]) {\n            return true;\n        }\n        const img = this.resources[imgUrl];\n        if (!img) {\n            return false;\n        }\n        if (checkSVG && isSVG(url[0]) && (+url[1] > img.width || +url[2] > img.height)) {\n            return false;\n        }\n        return true;\n    }\n\n    getImage(url) {\n        const imgUrl = this._getImgUrl(url);\n        if (!this.isResourceLoaded(url) || this._errors[imgUrl]) {\n            return null;\n        }\n        return this.resources[imgUrl].image;\n    }\n\n    markErrorResource(url) {\n        this._errors[this._getImgUrl(url)] = 1;\n    }\n\n    merge(res) {\n        if (!res) {\n            return this;\n        }\n        for (const p in res.resources) {\n            const img = res.resources[p];\n            this.addResource([p, img.width, img.height], img.image);\n        }\n        return this;\n    }\n\n    forEach(fn) {\n        if (!this.resources) {\n            return this;\n        }\n        for (const p in this.resources) {\n            if (hasOwn(this.resources, p)) {\n                fn(p, this.resources[p]);\n            }\n        }\n        return this;\n    }\n\n    _getImgUrl(url) {\n        if (!Array.isArray(url)) {\n            return url;\n        }\n        return url[0];\n    }\n}\n","import Class from '../core/Class';\nimport { isNil, isNumber } from '../core/util';\nimport Eventable from '../core/Eventable';\nimport JSONAble from '../core/JSONAble';\nimport Renderable from '../renderer/Renderable';\nimport CanvasRenderer from '../renderer/layer/CanvasRenderer';\nimport CollisionIndex from '../core/CollisionIndex';\n\n/**\n * @property {Object}  [options=null] - base options of layer.\n * @property {String}  [options.attribution= null] - the attribution of this layer, you can specify company or other information of this layer.\n * @property {Number}  [options.minZoom=-1] - the minimum zoom to display the layer, set to -1 to unlimit it.\n * @property {Number}  [options.maxZoom=-1] - the maximum zoom to display the layer, set to -1 to unlimit it.\n * @property {Boolean} [options.visible=true] - whether to display the layer.\n * @property {Number}  [options.opacity=1] - opacity of the layer, from 0 to 1.\n * @property {Number}  [options.zIndex=undefined] - z index of the layer\n * @property {String}  [options.renderer=canvas]  - renderer type, \"canvas\" in default.\n * @property {String}   [options.globalCompositeOperation=null] - (Only for layer rendered with [CanvasRenderer]{@link renderer.CanvasRenderer}) globalCompositeOperation of layer's canvas 2d context.\n * @property {String}   [options.debugOutline='#0f0']  - debug outline's color.\n * @property {String}   [options.cssFilter=null]       - css filter apply to canvas context's filter\n * @property {Boolean}  [options.forceRenderOnMoving=false]    - force to render layer when map is moving\n * @property {Boolean}  [options.forceRenderOnZooming=false]   - force to render layer when map is zooming\n * @property {Boolean}  [options.forceRenderOnRotating=false]  - force to render layer when map is Rotating\n *\n * @property {String}   [options.collisionScope=layer]         - layer's collision scope: layer or map\n * @memberOf Layer\n * @instance\n */\nconst options = {\n    'attribution': null,\n    'minZoom': null,\n    'maxZoom': null,\n    'visible': true,\n    'opacity': 1,\n    // context.globalCompositeOperation, 'source-over' in default\n    'globalCompositeOperation': null,\n    'renderer': 'canvas',\n    'debugOutline' : '#0f0',\n    'cssFilter': null,\n    'forceRenderOnMoving' : false,\n    'forceRenderOnZooming' : false,\n    'forceRenderOnRotating' : false,\n    'collision' : false,\n    'collisionScope' : 'layer'\n};\n\n/**\n * @classdesc\n * Base class for all the layers, defines common methods that all the layer classes share. <br>\n * It is abstract and not intended to be instantiated.\n *\n * @category layer\n * @abstract\n * @extends Class\n * @mixes Eventable\n * @mixes JSONAble\n * @mixes Renderable\n */\nclass Layer extends JSONAble(Eventable(Renderable(Class))) {\n\n    constructor(id, options) {\n        let canvas;\n        if (options) {\n            canvas = options.canvas;\n            delete options.canvas;\n        }\n        super(options);\n        this._canvas = canvas;\n        this.setId(id);\n        if (options) {\n            this.setZIndex(options.zIndex);\n        }\n    }\n\n    /**\n     * load the tile layer, can't be overrided by sub-classes\n     */\n    load() {\n        if (!this.getMap()) {\n            return this;\n        }\n        if (this.onLoad()) {\n            this._initRenderer();\n            const zIndex = this.getZIndex();\n            if (!isNil(zIndex)) {\n                this._renderer.setZIndex(zIndex);\n                if (!this.isCanvasRender()) {\n                    this._renderer.render();\n                }\n            }\n            this.onLoadEnd();\n        }\n        return this;\n    }\n\n    /**\n     * Get the layer id\n     * @returns {String} id\n     */\n    getId() {\n        return this._id;\n    }\n\n    /**\n     * Set a new id to the layer\n     * @param {String} id - new layer id\n     * @return {Layer} this\n     * @fires Layer#idchange\n     */\n    setId(id) {\n        const old = this._id;\n        if (!isNil(id)) {\n            id = id + '';\n        }\n        this._id = id;\n        /**\n         * idchange event.\n         *\n         * @event Layer#idchange\n         * @type {Object}\n         * @property {String} type - idchange\n         * @property {Layer} target    - the layer fires the event\n         * @property {String} old        - value of the old id\n         * @property {String} new        - value of the new id\n         */\n        this.fire('idchange', {\n            'old': old,\n            'new': id\n        });\n        return this;\n    }\n\n    /**\n     * Adds itself to a map.\n     * @param {Map} map - map added to\n     * @return {Layer} this\n     */\n    addTo(map) {\n        map.addLayer(this);\n        return this;\n    }\n\n    /**\n     * Set a z-index to the layer\n     * @param {Number} zIndex - layer's z-index\n     * @return {Layer} this\n     */\n    setZIndex(zIndex) {\n        this._zIndex = zIndex;\n        if (isNil(zIndex)) {\n            delete this.options['zIndex'];\n        } else {\n            this.options.zIndex = zIndex;\n        }\n        if (this.map) {\n            this.map._sortLayersByZIndex();\n        }\n        if (this._renderer) {\n            this._renderer.setZIndex(zIndex);\n        }\n        return this;\n    }\n\n    /**\n     * Get the layer's z-index\n     * @return {Number}\n     */\n    getZIndex() {\n        return this._zIndex || 0;\n    }\n\n    /**\n     * Get Layer's minZoom to display\n     * @return {Number}\n     */\n    getMinZoom() {\n        const map = this.getMap();\n        const minZoom = this.options['minZoom'];\n        return map ? Math.max(map.getMinZoom(), minZoom || 0) : minZoom;\n    }\n\n    /**\n     * Get Layer's maxZoom to display\n     * @return {Number}\n     */\n    getMaxZoom() {\n        const map = this.getMap();\n        const maxZoom = this.options['maxZoom'];\n        return map ? Math.min(map.getMaxZoom(), isNil(maxZoom) ? Infinity : maxZoom) : maxZoom;\n    }\n\n    /**\n     * Get layer's opacity\n     * @returns {Number}\n     */\n    getOpacity() {\n        return this.options['opacity'];\n    }\n\n    /**\n     * Set opacity to the layer\n     * @param {Number} opacity - layer's opacity\n     * @return {Layer} this\n     */\n    setOpacity(op) {\n        this.config('opacity', op);\n        return this;\n    }\n\n    /**\n     * If the layer is rendered by HTML5 Canvas.\n     * @return {Boolean}\n     * @protected\n     */\n    isCanvasRender() {\n        const renderer = this._getRenderer();\n        return (renderer && (renderer instanceof CanvasRenderer));\n    }\n\n    /**\n     * Get the map that the layer added to\n     * @returns {Map}\n     */\n    getMap() {\n        if (this.map) {\n            return this.map;\n        }\n        return null;\n    }\n\n    /**\n     * Get projection of layer's map\n     * @returns {Object}\n     */\n    getProjection() {\n        const map = this.getMap();\n        return map ? map.getProjection() : null;\n    }\n\n    /**\n     * Brings the layer to the top of all the layers\n     * @returns {Layer} this\n     */\n    bringToFront() {\n        const layers = this._getLayerList();\n        if (!layers.length) {\n            return this;\n        }\n        const topLayer = layers[layers.length - 1];\n        if (layers.length === 1 || topLayer === this) {\n            return this;\n        }\n        const max = topLayer.getZIndex();\n        this.setZIndex(max + 1);\n        return this;\n    }\n\n    /**\n     * Brings the layer under the bottom of all the layers\n     * @returns {Layer} this\n     */\n    bringToBack() {\n        const layers = this._getLayerList();\n        if (!layers.length) {\n            return this;\n        }\n        const bottomLayer = layers[0];\n        if (layers.length === 1 || bottomLayer === this) {\n            return this;\n        }\n        const min = bottomLayer.getZIndex();\n        this.setZIndex(min - 1);\n        return this;\n    }\n\n    /**\n     * Show the layer\n     * @returns {Layer} this\n     */\n    show() {\n        if (!this.options['visible']) {\n            this.options['visible'] = true;\n            const renderer = this.getRenderer();\n            if (renderer) {\n                renderer.show();\n            }\n\n            const map = this.getMap();\n            if (renderer && map) {\n                //fire show at renderend to make sure layer is shown\n                map.once('renderend', () => {\n                    this.fire('show');\n                });\n            } else {\n                this.fire('show');\n            }\n        }\n        return this;\n    }\n\n    /**\n     * Hide the layer\n     * @returns {Layer} this\n     */\n    hide() {\n        if (this.options['visible']) {\n            this.options['visible'] = false;\n            const renderer = this.getRenderer();\n            if (renderer) {\n                renderer.hide();\n            }\n\n            const map = this.getMap();\n            if (renderer && map) {\n                //fire hide at renderend to make sure layer is hidden\n                map.once('renderend', () => {\n                    this.fire('hide');\n                });\n            } else {\n                this.fire('hide');\n            }\n        }\n        // this.fire('hide');\n        return this;\n    }\n\n    /**\n     * Whether the layer is visible now.\n     * @return {Boolean}\n     */\n    isVisible() {\n        if (isNumber(this.options['opacity']) && this.options['opacity'] <= 0) {\n            return false;\n        }\n        const map = this.getMap();\n        if (map) {\n            const zoom = map.getZoom();\n            if ((!isNil(this.options['maxZoom']) && this.options['maxZoom'] < zoom) ||\n                (!isNil(this.options['minZoom']) && this.options['minZoom'] > zoom)) {\n                return false;\n            }\n        }\n\n        if (isNil(this.options['visible'])) {\n            this.options['visible'] = true;\n        }\n        return this.options['visible'];\n    }\n\n    /**\n     * Remove itself from the map added to.\n     * @returns {Layer} this\n     */\n    remove() {\n        if (this.map) {\n            this.map.removeLayer(this);\n        }\n        return this;\n    }\n\n    /**\n     * Get the mask geometry of the layer\n     * @return {Geometry}\n     */\n    getMask() {\n        return this._mask;\n    }\n\n    /**\n     * Set a mask geometry on the layer, only the area in the mask will be displayed.\n     * @param {Geometry} mask - mask geometry, can only be a Marker with vector symbol, a Polygon or a MultiPolygon\n     * @returns {Layer} this\n     */\n    setMask(mask) {\n        if (!((mask.type === 'Point' && mask._isVectorMarker()) || mask.type === 'Polygon' || mask.type === 'MultiPolygon')) {\n            throw new Error('Mask for a layer must be a marker with vector marker symbol or a Polygon(MultiPolygon).');\n        }\n\n        if (mask.type === 'Point') {\n            mask.updateSymbol({\n                'markerLineColor': 'rgba(0, 0, 0, 0)',\n                'markerFillOpacity': 0\n            });\n        } else {\n            mask.setSymbol({\n                'lineColor': 'rgba(0, 0, 0, 0)',\n                'polygonOpacity': 0\n            });\n        }\n        mask._bindLayer(this);\n        this._mask = mask;\n        if (!this.getMap() || this.getMap().isZooming()) {\n            return this;\n        }\n        const renderer = this._getRenderer();\n        if (renderer && renderer.setToRedraw) {\n            this._getRenderer().setToRedraw();\n        }\n        return this;\n    }\n\n    /**\n     * Remove the mask\n     * @returns {Layer} this\n     */\n    removeMask() {\n        delete this._mask;\n        if (!this.getMap() || this.getMap().isZooming()) {\n            return this;\n        }\n        const renderer = this._getRenderer();\n        if (renderer && renderer.setToRedraw) {\n            this._getRenderer().setToRedraw();\n        }\n        return this;\n    }\n\n    /**\n     * Prepare Layer's loading, this is a method intended to be overrided by subclasses.\n     * @return {Boolean} true to continue loading, false to cease.\n     * @protected\n     */\n    onLoad() {\n        return true;\n    }\n\n    onLoadEnd() {\n    }\n\n    /**\n     * Whether the layer is loaded\n     * @return {Boolean}\n     */\n    isLoaded() {\n        return !!this._loaded;\n    }\n\n    /**\n     * Get layer's collision index\n     * @returns {CollisionIndex}\n     */\n    getCollisionIndex() {\n        if (this.options['collisionScope'] === 'layer') {\n            if (!this._collisionIndex) {\n                this._collisionIndex = new CollisionIndex();\n            }\n            return this._collisionIndex;\n        }\n        const map = this.getMap();\n        if (!map) {\n            return null;\n        }\n        return map.getCollisionIndex();\n    }\n\n    /**\n     * Clear layer's collision index.\n     * Will ignore if collisionScope is not layer\n     */\n    clearCollisionIndex() {\n        if (this.options['collisionScope'] === 'layer' &&\n            this._collisionIndex) {\n            this._collisionIndex.clear();\n        }\n        return this;\n    }\n\n    getRenderer() {\n        return this._getRenderer();\n    }\n\n    onConfig(conf) {\n        if (isNumber(conf['opacity']) || conf['cssFilter']) {\n            const renderer = this.getRenderer();\n            if (renderer) {\n                renderer.setToRedraw();\n            }\n        }\n    }\n\n    onAdd() {}\n\n    onRemove() {}\n\n    _bindMap(map, zIndex) {\n        if (!map) {\n            return;\n        }\n        this.map = map;\n        if (!isNil(zIndex)) {\n            this.setZIndex(zIndex);\n        }\n        this._switchEvents('on', this);\n\n        this.onAdd();\n\n        this.fire('add');\n    }\n\n    _initRenderer() {\n        const renderer = this.options['renderer'];\n        if (!this.constructor.getRendererClass) {\n            return;\n        }\n        const clazz = this.constructor.getRendererClass(renderer);\n        if (!clazz) {\n            throw new Error('Invalid renderer for Layer(' + this.getId() + '):' + renderer);\n        }\n        this._renderer = new clazz(this);\n        this._renderer.layer = this;\n        this._renderer.setZIndex(this.getZIndex());\n        this._switchEvents('on', this._renderer);\n        // some plugin of dom renderer doesn't implement onAdd\n        if (this._renderer.onAdd) {\n            this._renderer.onAdd();\n        }\n\n        /**\n         * renderercreate event, fired when renderer is created.\n         *\n         * @event Layer#renderercreate\n         * @type {Object}\n         * @property {String} type - renderercreate\n         * @property {Layer} target    - the layer fires the event\n         * @property {Any} renderer    - renderer of the layer\n         */\n        this.fire('renderercreate', {\n            'renderer': this._renderer\n        });\n    }\n\n    _doRemove() {\n        this._loaded = false;\n        this.onRemove();\n\n        this._switchEvents('off', this);\n        if (this._renderer) {\n            this._switchEvents('off', this._renderer);\n            this._renderer.remove();\n            delete this._renderer;\n        }\n        delete this.map;\n        delete this._collisionIndex;\n    }\n\n    _switchEvents(to, emitter) {\n        if (emitter && emitter.getEvents) {\n            this.getMap()[to](emitter.getEvents(), emitter);\n        }\n    }\n\n    _getRenderer() {\n        return this._renderer;\n    }\n\n    _getLayerList() {\n        if (!this.map) {\n            return [];\n        }\n        return this.map._layers;\n    }\n\n    _getMask2DExtent() {\n        if (!this._mask || !this.getMap()) {\n            return null;\n        }\n        const painter = this._mask._getPainter();\n        if (!painter) {\n            return null;\n        }\n        return painter.get2DExtent();\n    }\n}\n\nLayer.mergeOptions(options);\n\nconst fire = Layer.prototype.fire;\n\nLayer.prototype.fire = function (eventType, param) {\n    if (eventType === 'layerload') {\n        this._loaded = true;\n    }\n    if (this.map) {\n        if (!param) {\n            param = {};\n        }\n        param['type'] = eventType;\n        param['target'] = this;\n        this.map._onLayerEvent(param);\n    }\n    return fire.apply(this, arguments);\n};\n\nexport default Layer;\n","import { extend, isNil, isObject, hasOwn, sign } from '../../core/util';\nimport Coordinate from '../../geo/Coordinate';\nimport Extent from '../../geo/Extent';\nimport * as projections from '../../geo/projection';\nimport Transformation from '../../geo/transformation/Transformation';\nimport { Measurer } from '../../geo/measurer';\n\nconst DefaultSpatialReference = {\n    'EPSG:3857': {\n        'resolutions': (function () {\n            const resolutions = [];\n            const d = 2 * 6378137 * Math.PI;\n            for (let i = 0; i < 21; i++) {\n                resolutions[i] = d / (256 * Math.pow(2, i));\n            }\n            return resolutions;\n        })(),\n        'fullExtent': {\n            'top': 6378137 * Math.PI,\n            'left': -6378137 * Math.PI,\n            'bottom': -6378137 * Math.PI,\n            'right': 6378137 * Math.PI\n        }\n    },\n    'EPSG:4326': {\n        'fullExtent': {\n            'top': 90,\n            'left': -180,\n            'bottom': -90,\n            'right': 180\n        },\n        'resolutions': (function () {\n            const resolutions = [];\n            for (let i = 0; i < 20; i++) {\n                resolutions[i] = 180 / (Math.pow(2, i) * 128);\n            }\n            return resolutions;\n        })()\n    },\n    'BAIDU': {\n        'resolutions': (function () {\n            let res = Math.pow(2, 18);\n            const resolutions = [];\n            for (let i = 0; i < 20; i++) {\n                resolutions[i] = res;\n                res *= 0.5;\n            }\n            resolutions[0] = null;\n            resolutions[1] = null;\n            resolutions[2] = null;\n            return resolutions;\n        })(),\n        'fullExtent': {\n            'top': 33554432,\n            'left': -33554432,\n            'bottom': -33554432,\n            'right': 33554432\n        }\n    },\n    'IDENTITY' : {\n        'resolutions': (function () {\n            let res = Math.pow(2, 8);\n            const resolutions = [];\n            for (let i = 0; i < 18; i++) {\n                resolutions[i] = res;\n                res *= 0.5;\n            }\n            return resolutions;\n        })(),\n        'fullExtent': {\n            'top': 200000,\n            'left': -200000,\n            'bottom': -200000,\n            'right': 200000\n        }\n    }\n};\n\nDefaultSpatialReference['EPSG:4490'] = DefaultSpatialReference['EPSG:4326'];\n\nexport default class SpatialReference {\n    constructor(options = {}) {\n        this.options = options;\n        this._initSpatialRef();\n    }\n\n    static getProjectionInstance(prjName) {\n        if (!prjName) {\n            return null;\n        }\n        if (isObject(prjName)) {\n            return prjName;\n        }\n        prjName = (prjName + '').toLowerCase();\n        for (const p in projections) {\n            if (hasOwn(projections, p)) {\n                const code = projections[p]['code'];\n                if (code && code.toLowerCase() === prjName) {\n                    return projections[p];\n                }\n            }\n        }\n        return null;\n    }\n\n    static equals(sp1, sp2) {\n        if (!sp1 && !sp2) {\n            return true;\n        } else if (!sp1 || !sp2) {\n            return false;\n        }\n        if (sp1.projection !== sp2.projection) {\n            return false;\n        }\n        const f1 = sp1.fullExtent, f2 = sp2.fullExtent;\n        if (f1 && !f2 || !f1 && f2) {\n            return false;\n        }\n        if (f1 && f2) {\n            if (f1.top !== f2.top || f1.bottom !== f2.bottom || f1.left !== f2.left || f1.right !== f2.right) {\n                return false;\n            }\n        }\n        const r1 = sp1.resolutions, r2 = sp2.resolutions;\n        if (r1 && r2) {\n            if (r1.length !== r2.length) {\n                return false;\n            }\n            for (let i = 0; i < r1.length; i++) {\n                if (r1[i] !== r2[i]) {\n                    return false;\n                }\n            }\n        }\n        return true;\n    }\n\n    _initSpatialRef() {\n        let projection = this.options['projection'];\n        if (projection) {\n            projection = SpatialReference.getProjectionInstance(projection);\n        } else {\n            projection = projections.DEFAULT;\n        }\n        if (!projection) {\n            throw new Error('must provide a valid projection in map\\'s spatial reference.');\n        }\n        projection = extend({}, projections.Common, projection);\n        if (!projection.measureLength) {\n            extend(projection, Measurer.DEFAULT);\n        }\n        this._projection = projection;\n        let defaultSpatialRef,\n            resolutions = this.options['resolutions'];\n        if (!resolutions) {\n            if (projection['code']) {\n                defaultSpatialRef = DefaultSpatialReference[projection['code']];\n                if (defaultSpatialRef) {\n                    resolutions = defaultSpatialRef['resolutions'];\n                    this.isEPSG = projection['code'] !== 'IDENTITY';\n                }\n            }\n            if (!resolutions) {\n                throw new Error('must provide valid resolutions in map\\'s spatial reference.');\n            }\n        }\n        this._resolutions = resolutions;\n        let fullExtent = this.options['fullExtent'];\n        if (!fullExtent) {\n            if (projection['code']) {\n                defaultSpatialRef = DefaultSpatialReference[projection['code']];\n                if (defaultSpatialRef) {\n                    fullExtent = defaultSpatialRef['fullExtent'];\n                }\n            }\n            if (!fullExtent) {\n                throw new Error('must provide a valid fullExtent in map\\'s spatial reference.');\n            }\n        }\n        if (!isNil(fullExtent['left'])) {\n            this._fullExtent = new Extent(new Coordinate(fullExtent['left'], fullExtent['top']),\n                new Coordinate(fullExtent['right'], fullExtent['bottom']));\n        } else {\n            //xmin, ymin, xmax, ymax\n            this._fullExtent = new Extent(fullExtent);\n            fullExtent['left'] = fullExtent['xmin'];\n            fullExtent['right'] = fullExtent['xmax'];\n            fullExtent['top'] = fullExtent['ymax'];\n            fullExtent['bottom'] = fullExtent['ymin'];\n        }\n\n        if (isNil(fullExtent['top']) || isNil(fullExtent['bottom']) || isNil(fullExtent['left']) || isNil(fullExtent['right'])) {\n            throw new Error('must provide valid top/bottom/left/right in fullExtent.');\n        }\n\n        //set left, right, top, bottom value\n        extend(this._fullExtent, fullExtent);\n\n        this._projection.fullExtent = fullExtent;\n\n        const a = fullExtent['right'] >= fullExtent['left'] ? 1 : -1,\n            b = fullExtent['top'] >= fullExtent['bottom'] ? -1 : 1;\n        this._transformation = new Transformation([a, b, 0, 0]);\n    }\n\n    getResolutions() {\n        return this._resolutions || [];\n    }\n\n    getResolution(zoom) {\n        let z = (zoom | 0);\n        if (z < 0) {\n            z = 0;\n        } else if (z > this._resolutions.length - 1) {\n            z = this._resolutions.length - 1;\n        }\n        const res = this._resolutions[z];\n        if (z !== zoom && zoom > 0 && z < this._resolutions.length - 1) {\n            const next = this._resolutions[z + 1];\n            return res + (next - res) * (zoom - z);\n        }\n        return res;\n    }\n\n    getProjection() {\n        return this._projection;\n    }\n\n    getFullExtent() {\n        return this._fullExtent;\n    }\n\n    getTransformation() {\n        return this._transformation;\n    }\n\n    getMinZoom() {\n        for (let i = 0; i < this._resolutions.length; i++) {\n            if (!isNil(this._resolutions[i])) {\n                return i;\n            }\n        }\n        return 0;\n    }\n\n    getMaxZoom() {\n        for (let i = this._resolutions.length - 1; i >= 0; i--) {\n            if (!isNil(this._resolutions[i])) {\n                return i;\n            }\n        }\n        return this._resolutions.length - 1;\n    }\n\n    getZoomDirection() {\n        return sign(this._resolutions[this.getMinZoom()] - this._resolutions[this.getMaxZoom()]);\n    }\n\n    toJSON() {\n        if (!this.json) {\n            this.json = {\n                'resolutions' : this._resolutions,\n                'fullExtent' : {\n                    'top': this._fullExtent.top,\n                    'left': this._fullExtent.left,\n                    'bottom': this._fullExtent.bottom,\n                    'right': this._fullExtent.right\n                },\n                'projection' : this._projection.code\n            };\n        }\n        return this.json;\n    }\n}\n","import { INTERNAL_LAYER_PREFIX } from '../core/Constants';\nimport {\n    now,\n    extend,\n    IS_NODE,\n    isNil,\n    isString,\n    isFunction,\n    sign,\n    UID,\n    b64toBlob\n} from '../core/util';\nimport Class from '../core/Class';\nimport Browser from '../core/Browser';\nimport Eventable from '../core/Eventable';\nimport Handlerable from '../handler/Handlerable';\nimport Point from '../geo/Point';\nimport Size from '../geo/Size';\nimport PointExtent from '../geo/PointExtent';\nimport Extent from '../geo/Extent';\nimport Coordinate from '../geo/Coordinate';\nimport Layer from '../layer/Layer';\nimport Renderable from '../renderer/Renderable';\nimport SpatialReference from './spatial-reference/SpatialReference';\n\n/**\n * @property {Object} options                                   - map's options, options must be updated by config method:<br> map.config('zoomAnimation', false);\n * @property {Boolean} [options.centerCross=false]              - Display a red cross in the center of map\n * @property {Boolean} [options.seamlessZoom=false]             - whether to use seamless zooming mode\n * @property {Boolean} [options.zoomInCenter=false]             - whether to fix in the center when zooming\n * @property {Boolean} [options.zoomAnimation=true]             - enable zooming animation\n * @property {Number}  [options.zoomAnimationDuration=330]      - zoom animation duration.\n * @property {Boolean} [options.panAnimation=true]              - continue to animate panning when draging or touching ended.\n * @property {Boolean} [options.panAnimationDuration=600]       - duration of pan animation.\n * @property {Boolean} [options.zoomable=true]                  - whether to enable map zooming.\n * @property {Boolean} [options.enableInfoWindow=true]          - whether to enable infowindow on this map.\n * @property {Boolean} [options.hitDetect=true]                 - whether to enable hit detecting of layers for cursor style on this map, disable it to improve performance.\n * @property {Boolean} [options.hitDetectLimit=5]               - the maximum number of layers to perform hit detect.\n * @property {Boolean} [options.fpsOnInteracting=25]            - fps when map is interacting, some slow layers will not be drawn on interacting when fps is low. Set to 0 to disable it.\n * @property {Boolean} [options.layerCanvasLimitOnInteracting=-1]    - limit of layer canvas to draw on map when interacting, set it to improve perf.\n * @property {Number}  [options.maxZoom=null]                   - the maximum zoom the map can be zooming to.\n * @property {Number}  [options.minZoom=null]                   - the minimum zoom the map can be zooming to.\n * @property {Extent}  [options.maxExtent=null]         - when maxExtent is set, map will be restricted to the give max extent and bouncing back when user trying to pan ouside the extent.\n * @property {Boolean} [options.fixCenterOnResize=false]        - whether to fix map center when map is resized\n *\n * @property {Number}  [options.maxPitch=80]                    - max pitch\n * @property {Number}  [options.maxVisualPitch=60]              - the max pitch to be visual\n *\n * @property {Extent}  [options.viewHistory=true]               -  whether to record view history\n * @property {Extent}  [options.viewHistoryCount=10]            -  the count of view history record.\n *\n * @property {Boolean} [options.draggable=true]                         - disable the map dragging if set to false.\n * @property {Boolean} [options.dragPan=true]                           - if true, map can be dragged to pan.\n * @property {Boolean} [options.dragRotate=true]                        - default true. If true, map can be dragged to rotate by right click or ctrl + left click.\n * @property {Boolean} [options.dragPitch=true]                         - default true. If true, map can be dragged to pitch by right click or ctrl + left click.\n * @property {Boolean} [options.dragRotatePitch=true]                  - if true, map is dragged to pitch and rotate at the same time.\n * @property {Boolean} [options.touchGesture=true]                      - whether to allow map to zoom/rotate/tilt by two finger touch gestures.\n * @property {Boolean} [options.touchZoom=true]                         - whether to allow map to zoom by touch pinch.\n * @property {Boolean} [options.touchRotate=true]                       - whether to allow map to rotate by touch pinch.\n * @property {Boolean} [options.touchPitch=true]                        - whether to allow map to pitch by touch pinch.\n * @property {Boolean} [options.touchZoomRotate=false]                  - if true, map is to zoom and rotate at the same time by touch pinch.\n * @property {Boolean} [options.doubleClickZoom=true]                    - whether to allow map to zoom by double click events.\n * @property {Boolean} [options.scrollWheelZoom=true]                   - whether to allow map to zoom by scroll wheel events.\n * @property {Boolean} [options.geometryEvents=true]                    - enable/disable firing geometry events\n *\n * @property {Boolean}        [options.control=true]                    - whether allow map to add controls.\n * @property {Boolean|Object} [options.attribution=true]                - whether to display the attribution control on the map. if true, attribution display maptalks info; if object, you can specify positon or your base content, and both;\n * @property {Boolean|Object} [options.zoomControl=false]               - display the zoom control on the map if set to true or a object as the control construct option.\n * @property {Boolean|Object} [options.scaleControl=false]              - display the scale control on the map if set to true or a object as the control construct option.\n * @property {Boolean|Object} [options.overviewControl=false]           - display the overview control on the map if set to true or a object as the control construct option.\n *\n * @property {Boolean}        [options.fog=true]                        - whether to draw fog in far distance.\n * @property {Number[]}       [options.fogColor=[233, 233, 233]]        - color of fog: [r, g, b]\n *\n * @property {String} [options.renderer=canvas]                 - renderer type. Don't change it if you are not sure about it. About renderer, see [TODO]{@link tutorial.renderer}.\n * @property {Number} [options.devicePixelRatio=null]           - device pixel ratio to override device's default one\n * @memberOf Map\n * @instance\n */\nconst options = {\n    'maxVisualPitch' : 60,\n    'maxPitch' : 80,\n    'centerCross': false,\n\n    'zoomInCenter' : false,\n    'zoomAnimation': (function () {\n        return !IS_NODE;\n    })(),\n    'zoomAnimationDuration': 330,\n\n    'panAnimation': (function () {\n        return !IS_NODE;\n    })(),\n    //default pan animation duration\n    'panAnimationDuration': 600,\n\n    'zoomable': true,\n    'enableInfoWindow': true,\n\n    'hitDetect': (function () {\n        return !Browser.mobile;\n    })(),\n\n    'hitDetectLimit' : 5,\n\n    'fpsOnInteracting' : 25,\n\n    'layerCanvasLimitOnInteracting' : -1,\n\n    'maxZoom': null,\n    'minZoom': null,\n    'maxExtent': null,\n    'fixCenterOnResize' : false,\n\n    'checkSize': true,\n    'checkSizeInterval' : 1000,\n\n    'renderer': 'canvas'\n};\n\n/**\n * The central class of the library, to create a map on a container.\n * @category map\n * @extends Class\n *\n * @mixes Eventable\n * @mixes Handlerable\n * @mixes ui.Menuable\n * @mixes Renderable\n *\n * @example\n * var map = new maptalks.Map(\"map\",{\n *      center:     [180,0],\n *      zoom:  4,\n *      baseLayer : new maptalks.TileLayer(\"base\",{\n *          urlTemplate:'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n *          subdomains:['a','b','c']\n *      }),\n *      layers : [\n *          new maptalks.VectorLayer('v', [new maptalks.Marker([180, 0])])\n *      ]\n * });\n */\nclass Map extends Handlerable(Eventable(Renderable(Class))) {\n\n    /**\n     * @param {(string|HTMLElement|object)} container - The container to create the map on, can be:<br>\n     *                                          1. A HTMLElement container.<br/>\n     *                                          2. ID of a HTMLElement container.<br/>\n     *                                          3. Any canvas compatible container\n     * @param {Object} options - construct options\n     * @param {(Number[]|Coordinate)} options.center - initial center of the map.\n     * @param {Number} options.zoom - initial zoom of the map.\n     * @param {Object} [options.spatialReference=null] - map's spatial reference, default is using projection EPSG:3857 with resolutions used by google map/osm.\n     * @param {Layer} [options.baseLayer=null] - base layer that will be set to map initially.\n     * @param {Layer[]} [options.layers=null] - layers that will be added to map initially.\n     * @param {*} options.* - any other option defined in [Map.options]{@link Map#options}      [description]\n     */\n    constructor(container, options) {\n        if (!options) {\n            throw new Error('Invalid options when creating map.');\n        }\n        if (!options['center']) {\n            throw new Error('Invalid center when creating map.');\n        }\n        // prepare options\n        const opts = extend({}, options);\n        const zoom = opts['zoom'];\n        delete opts['zoom'];\n        const center = new Coordinate(opts['center']);\n        delete opts['center'];\n\n        const baseLayer = opts['baseLayer'];\n        delete opts['baseLayer'];\n        const layers = opts['layers'];\n        delete opts['layers'];\n        super(opts);\n\n        /**\n         * @property {String}  - Version of library\n         * @constant\n         * @static\n         */\n        this.VERSION = Map.VERSION;\n\n        Object.defineProperty(this, 'id', {\n            value: UID(),\n            writable: false\n        });\n\n        this._loaded = false;\n        this._initContainer(container);\n\n        this._panels = {};\n\n        //Layers\n        this._baseLayer = null;\n        this._layers = [];\n\n        this._zoomLevel = zoom;\n        this._center = center;\n\n        this.setSpatialReference(opts['spatialReference'] || opts['view']);\n\n\n        this._mapViewPoint = new Point(0, 0);\n\n        this._initRenderer();\n        this._updateMapSize(this._getContainerDomSize());\n\n        if (baseLayer) {\n            this.setBaseLayer(baseLayer);\n        }\n        if (layers) {\n            this.addLayer(layers);\n        }\n\n        this._Load();\n    }\n\n    /**\n     * Add hooks for additional codes when map's loading complete, useful for plugin developping.\n     * Note that it can only be called before the map is created.\n     * @param {Function} fn\n     * @returns {Map}\n     * @protected\n     */\n    static addOnLoadHook(fn) { // (Function) || (String, args...)\n        const args = Array.prototype.slice.call(arguments, 1);\n        const onload = typeof fn === 'function' ? fn : function () {\n            this[fn].apply(this, args);\n        };\n        this.prototype._onLoadHooks = this.prototype._onLoadHooks || [];\n        this.prototype._onLoadHooks.push(onload);\n        return this;\n    }\n\n\n    /**\n     * Whether the map is loaded or not.\n     * @return {Boolean}\n     */\n    isLoaded() {\n        return !!this._loaded;\n    }\n\n    /**\n     * Get map's container\n     * @returns {HTMLElement}\n     */\n    getContainer() {\n        return this._containerDOM;\n    }\n\n    /**\n     * Get the spatial reference of the Map.\n     * @return {SpatialReference} map's spatial reference\n     */\n    getSpatialReference() {\n        return this._spatialReference;\n    }\n\n    /**\n     * Change the spatial reference of the map. <br>\n     * A SpatialReference is a series of settings to decide the map presentation:<br>\n     * 1. the projection.<br>\n     * 2. zoom levels and resolutions. <br>\n     * 3. full extent.<br>\n     * There are some [predefined spatial references]{@link http://www.foo.com}, and surely you can [define a custom one.]{@link http://www.foo.com}.<br>\n     * SpatialReference can also be updated by map.config('spatialReference', spatialReference);\n     * @param {SpatialReference} spatialReference - spatial reference\n     * @returns {Map} this\n     * @fires Map#spatialreferencechange\n     * @example\n     *  map.setSpatialReference({\n            projection:'EPSG:4326',\n            resolutions: (function() {\n                const resolutions = [];\n                for (let i=0; i < 19; i++) {\n                    resolutions[i] = 180/(Math.pow(2, i)*128);\n                }\n                return resolutions;\n            })()\n     *  });\n       @example\n     *  map.config('spatialReference', {\n            projection:'EPSG:4326',\n            resolutions: (function() {\n                const resolutions = [];\n                for (let i=0; i < 19; i++) {\n                    resolutions[i] = 180/(Math.pow(2, i)*128);\n                }\n                return resolutions;\n            })()\n        });\n     */\n    setSpatialReference(ref) {\n        const oldRef = this.options['spatialReference'];\n        if (this._loaded && SpatialReference.equals(oldRef, ref)) {\n            return this;\n        }\n        this._updateSpatialReference(ref, oldRef);\n        return this;\n    }\n\n    _updateSpatialReference(ref, oldRef) {\n        ref = extend({}, ref);\n        this._center = this.getCenter();\n        this.options['spatialReference'] = ref;\n        this._spatialReference = new SpatialReference(ref);\n        if (this.options['spatialReference'] && isFunction(this.options['spatialReference']['projection'])) {\n            const projection = this._spatialReference.getProjection();\n            //save projection code for map profiling (toJSON/fromJSON)\n            this.options['spatialReference']['projection'] = projection['code'];\n        }\n        this._resetMapStatus();\n        /**\n         * spatialreferencechange event, fired when map's spatial reference is updated.\n         *\n         * @event Map#spatialreferencechange\n         * @type {Object}\n         * @property {String} type - spatialreferencechange\n         * @property {Map} target - map\n         * @property {Map} old - the old spatial reference\n         * @property {Map} new - the new spatial reference changed to\n         */\n        this._fireEvent('spatialreferencechange', {\n            'old': oldRef,\n            'new': extend({}, this.options['spatialReference'])\n        });\n        return this;\n    }\n\n    // _syncWorld() {\n    //     const projection = this.getProjection();\n    //     if (!projection) {\n    //         return false;\n    //     }\n    //     const pcenter = this._getPrjCenter();\n    //     if (projection.isOutSphere(pcenter)) {\n    //         const wrapped = projection.wrapCoord(pcenter);\n    //         this._setPrjCenter(wrapped);\n    //         this._fireEvent('syncworld', { 'old' : pcenter.toArray(), 'new' : wrapped.toArray() });\n    //         return true;\n    //     }\n    //     return false;\n    // }\n\n    /**\n     * Callback when any option is updated\n     * @private\n     * @param  {Object} conf - options to update\n     * @return {Map}   this\n     */\n    onConfig(conf) {\n        const ref = conf['spatialReference'] || conf['view'];\n        if (!isNil(ref)) {\n            this._updateSpatialReference(ref, null);\n        }\n        return this;\n    }\n\n    /**\n     * Get the projection of the map. <br>\n     * Projection is an algorithm for map projection, e.g. well-known [Mercator Projection]{@link https://en.wikipedia.org/wiki/Mercator_projection} <br>\n     * A projection must have 2 methods: <br>\n     * 1. project(coordinate) - project the input coordinate <br>\n     * 2. unproject(coordinate) - unproject the input coordinate <br>\n     * Projection also contains measuring method usually extended from a measurer: <br>\n     * 1. measureLength(coord1, coord2) - compute length between 2 coordinates.  <br>\n     * 2. measureArea(coords[]) - compute area of the input coordinates. <br>\n     * 3. locate(coord, distx, disty) - compute the coordinate from the coord with xdist on axis x and ydist on axis y.\n     * @return {Object}\n     */\n    getProjection() {\n        if (!this._spatialReference) {\n            return null;\n        }\n        return this._spatialReference.getProjection();\n    }\n\n    /**\n     * Get map's full extent, which is defined in map's spatial reference. <br>\n     * eg: {'left': -180, 'right' : 180, 'top' : 90, 'bottom' : -90}\n     * @return {Extent}\n     */\n    getFullExtent() {\n        if (!this._spatialReference) {\n            return null;\n        }\n        return this._spatialReference.getFullExtent();\n    }\n\n    /**\n     * Set map's cursor style, cursor style is same with CSS.\n     * @param {String} cursor - cursor style\n     * @returns {Map} this\n     * @example\n     * map.setCursor('url(cursor.png) 4 12, auto');\n     */\n    setCursor(cursor) {\n        delete this._cursor;\n        this._trySetCursor(cursor);\n        this._cursor = cursor;\n        return this;\n    }\n\n    /**\n     * Reset map's cursor style.\n     * @return {Map} this\n     * @example\n     * map.resetCursor();\n     */\n    resetCursor() {\n        return this.setCursor(null);\n    }\n\n    /**\n     * Get center of the map.\n     * @return {Coordinate}\n     */\n    getCenter() {\n        if (!this._loaded || !this._prjCenter) {\n            return this._center;\n        }\n        const projection = this.getProjection();\n        return projection.unproject(this._prjCenter);\n    }\n\n    /**\n     * Set a new center to the map.\n     * @param {Coordinate} center\n     * @return {Map} this\n     */\n    setCenter(center) {\n        if (!center) {\n            return this;\n        }\n        center = new Coordinate(center);\n        if (!this._verifyExtent(center)) {\n            return this;\n        }\n        if (!this._loaded) {\n            this._center = center;\n            return this;\n        }\n        this.onMoveStart();\n        const projection = this.getProjection();\n        const _pcenter = projection.project(center);\n        this._setPrjCenter(_pcenter);\n        this.onMoveEnd(this._parseEventFromCoord(this.getCenter()));\n        return this;\n    }\n\n    /**\n     * Get map's size (width and height) in pixel.\n     * @return {Size}\n     */\n    getSize() {\n        if (isNil(this.width) || isNil(this.height)) {\n            return this._getContainerDomSize();\n        }\n        return new Size(this.width, this.height);\n    }\n\n    /**\n     * Get container extent of the map\n     * @return {PointExtent}\n     */\n    getContainerExtent() {\n        let visualHeight = this.height;\n        const pitch = this.getPitch(),\n            maxVisualPitch = this.options['maxVisualPitch'];\n        if (maxVisualPitch && pitch > maxVisualPitch) {\n            visualHeight = this._getVisualHeight(maxVisualPitch);\n        }\n        return new PointExtent(0, this.height - visualHeight, this.width, this.height);\n    }\n\n    _getVisualHeight(maxVisualPitch) {\n        const pitch = this.getPitch();\n        const visualDistance = this.height / 2 * Math.tan(maxVisualPitch * Math.PI / 180);\n        return this.height / 2 + visualDistance *  Math.tan((90 - pitch) * Math.PI / 180);\n    }\n\n    /**\n     * Get the geographical extent of map's current view extent.\n     *\n     * @return {Extent}\n     */\n    getExtent() {\n        return this._pointToExtent(this._get2DExtent());\n    }\n\n    /**\n     * Get the projected geographical extent of map's current view extent.\n     *\n     * @return {Extent}\n     */\n    getProjExtent() {\n        const extent2D = this._get2DExtent();\n        return new Extent(\n            this._pointToPrj(extent2D.getMin()),\n            this._pointToPrj(extent2D.getMax())\n        );\n    }\n\n    /**\n     * Alias for getProjExtent\n     *\n     * @return {Extent}\n     */\n    getPrjExtent() {\n        return this.getProjExtent();\n    }\n\n    /**\n     * Get the max extent that the map is restricted to.\n     * @return {Extent}\n     */\n    getMaxExtent() {\n        if (!this.options['maxExtent']) {\n            return null;\n        }\n        return new Extent(this.options['maxExtent'], this.getProjection());\n    }\n\n    /**\n     * Sets the max extent that the map is restricted to.\n     * @param {Extent}\n     * @return {Map} this\n     * @example\n     * map.setMaxExtent(map.getExtent());\n     */\n    setMaxExtent(extent) {\n        if (extent) {\n            const maxExt = new Extent(extent, this.getProjection());\n            this.options['maxExtent'] = maxExt;\n            const center = this.getCenter();\n            if (!this._verifyExtent(center)) {\n                this.panTo(maxExt.getCenter());\n            }\n        } else {\n            delete this.options['maxExtent'];\n        }\n        return this;\n    }\n\n    /**\n     * Get map's current zoom.\n     * @return {Number}\n     */\n    getZoom() {\n        return this._zoomLevel;\n    }\n\n    /**\n     * Caculate the target zoom if scaling from \"fromZoom\" by \"scale\"\n     * @param  {Number} scale\n     * @param  {Number} fromZoom\n     * @param  {Boolean} isFraction - can return fractional zoom\n     * @return {Number} zoom fit for scale starting from fromZoom\n     */\n    getZoomForScale(scale, fromZoom, isFraction) {\n        const zoom = this.getZoom();\n        if (isNil(fromZoom)) {\n            fromZoom = zoom;\n        }\n        if (scale === 1 && fromZoom === zoom) {\n            return zoom;\n        }\n        const res = this._getResolution(fromZoom),\n            targetRes = res / scale;\n        const scaleZoom = this.getZoomFromRes(targetRes);\n        if (isFraction) {\n            return scaleZoom;\n        } else {\n            const delta = 1E-6; //avoid precision\n            return this.getSpatialReference().getZoomDirection() < 0 ?\n                Math.ceil(scaleZoom - delta) : Math.floor(scaleZoom + delta);\n        }\n    }\n\n    getZoomFromRes(res) {\n        const resolutions = this._getResolutions(),\n            minRes = this._getResolution(this.getMinZoom()),\n            maxRes = this._getResolution(this.getMaxZoom());\n        if (minRes <= maxRes) {\n            if (res <= minRes) {\n                return this.getMinZoom();\n            } else if (res >= maxRes) {\n                return this.getMaxZoom();\n            }\n        } else if (res >= minRes) {\n            return this.getMinZoom();\n        } else if (res <= maxRes) {\n            return this.getMaxZoom();\n        }\n\n        const l = resolutions.length;\n        for (let i = 0; i < l - 1; i++) {\n            if (!resolutions[i]) {\n                continue;\n            }\n            const gap = resolutions[i + 1] - resolutions[i];\n            const test = res - resolutions[i];\n            if (sign(gap) === sign(test) && Math.abs(gap) >= Math.abs(test)) {\n                return i + test / gap;\n            }\n        }\n        return l - 1;\n    }\n\n    /**\n     * Sets zoom of the map\n     * @param {Number} zoom\n     * @param {Object} [options=null] options\n     * @param {Boolean} [options.animation=true] whether zoom is animation, true by default\n     * @returns {Map} this\n     */\n    setZoom(zoom, options = { 'animation' : true }) {\n        if (isNaN(zoom) || isNil(zoom)) {\n            return this;\n        }\n        zoom = +zoom;\n        if (this._loaded && this.options['zoomAnimation'] && options['animation']) {\n            this._zoomAnimation(zoom);\n        } else {\n            this._zoom(zoom);\n        }\n        return this;\n    }\n\n    /**\n     * Get the max zoom that the map can be zoom to.\n     * @return {Number}\n     */\n    getMaxZoom() {\n        if (!isNil(this.options['maxZoom'])) {\n            return this.options['maxZoom'];\n        }\n        return this.getMaxNativeZoom();\n    }\n\n    /**\n     * Sets the max zoom that the map can be zoom to.\n     * @param {Number} maxZoom\n     * @returns {Map} this\n     */\n    setMaxZoom(maxZoom) {\n        const viewMaxZoom = this.getMaxNativeZoom();\n        if (maxZoom > viewMaxZoom) {\n            maxZoom = viewMaxZoom;\n        }\n        if (maxZoom !== null && maxZoom < this._zoomLevel) {\n            this.setZoom(maxZoom);\n            maxZoom = +maxZoom;\n        }\n        this.options['maxZoom'] = maxZoom;\n        return this;\n    }\n\n    /**\n     * Get the min zoom that the map can be zoom to.\n     * @return {Number}\n     */\n    getMinZoom() {\n        if (!isNil(this.options['minZoom'])) {\n            return this.options['minZoom'];\n        }\n        return this._spatialReference.getMinZoom();\n    }\n\n    /**\n     * Sets the min zoom that the map can be zoom to.\n     * @param {Number} minZoom\n     * @return {Map} this\n     */\n    setMinZoom(minZoom) {\n        if (minZoom !== null) {\n            minZoom = +minZoom;\n            const viewMinZoom = this._spatialReference.getMinZoom();\n            if (minZoom < viewMinZoom) {\n                minZoom = viewMinZoom;\n            }\n            if (minZoom > this._zoomLevel) {\n                this.setZoom(minZoom);\n            }\n        }\n        this.options['minZoom'] = minZoom;\n        return this;\n    }\n\n    /**\n     * Maximum zoom the map has\n     * @return {Number}\n     */\n    getMaxNativeZoom() {\n        const ref = this.getSpatialReference();\n        if (!ref) {\n            return null;\n        }\n        return ref.getMaxZoom();\n    }\n\n    /**\n     * Zoom for world point in WebGL context\n     * @returns {Number}\n     */\n    getGLZoom() {\n        return this.getMaxNativeZoom() / 2;\n    }\n\n    /**\n     * Caculate scale from gl zoom to given zoom (default by current zoom)\n     * @param {Number} [zoom=undefined] target zoom, current zoom by default\n     * @returns {Number}\n     * @examples\n     * const point = map.coordToPoint(map.getCenter());\n     * // convert to point in gl zoom\n     * const glPoint = point.multi(this.getGLScale());\n     */\n    getGLScale(zoom) {\n        if (isNil(zoom)) {\n            zoom = this.getZoom();\n        }\n        return this._getResolution(zoom) / this._getResolution(this.getGLZoom());\n    }\n\n    /**\n     * zoom in\n     * @return {Map} this\n     */\n    zoomIn() {\n        return this.setZoom(this.getZoom() + 1);\n    }\n\n    /**\n     * zoom out\n     * @return {Map} this\n     */\n    zoomOut() {\n        return this.setZoom(this.getZoom() - 1);\n    }\n\n    /**\n     * Whether the map is zooming\n     * @return {Boolean}\n     */\n    isZooming() {\n        return !!this._zooming;\n    }\n\n    /**\n     * Whether the map is being interacted\n     * @return {Boolean}\n     */\n    isInteracting() {\n        return this.isZooming() || this.isMoving() || this.isRotating();\n    }\n\n    /**\n     * Sets the center and zoom at the same time.\n     * @param {Coordinate} center\n     * @param {Number} zoom\n     * @return {Map} this\n     */\n    setCenterAndZoom(center, zoom) {\n        if (!isNil(zoom) && this._zoomLevel !== zoom) {\n            this.setCenter(center);\n            this.setZoom(zoom, { animation : false });\n        } else {\n            this.setCenter(center);\n        }\n        return this;\n    }\n\n\n    /**\n     * Caculate the zoom level that contains the given extent with the maximum zoom level possible.\n     * @param {Extent} extent\n     * @return {Number} zoom fit for the extent\n     */\n    getFitZoom(extent) {\n        if (!extent || !(extent instanceof Extent)) {\n            return this._zoomLevel;\n        }\n        //It's a point\n        if (extent['xmin'] === extent['xmax'] && extent['ymin'] === extent['ymax']) {\n            return this.getMaxZoom();\n        }\n        const size = this.getSize();\n        const containerExtent = extent.convertTo(p => this.coordToContainerPoint(p));\n        const w = containerExtent.getWidth(),\n            h = containerExtent.getHeight();\n        const scaleX = size['width'] / w,\n            scaleY = size['height'] / h;\n        const scale = this.getSpatialReference().getZoomDirection() < 0 ?\n            Math.max(scaleX, scaleY) : Math.min(scaleX, scaleY);\n        const zoom = this.getZoomForScale(scale);\n        return zoom;\n    }\n\n    /**\n     * Get map's current view (center/zoom/pitch/bearing)\n     * @return {Object} { center : *, zoom : *, pitch : *, bearing : * }\n     */\n    getView() {\n        return {\n            'center' : this.getCenter().toArray(),\n            'zoom'  : this.getZoom(),\n            'pitch' : this.getPitch(),\n            'bearing' : this.getBearing()\n        };\n    }\n\n    /**\n     * Set map's center/zoom/pitch/bearing at one time\n     * @param {Object} view - a object containing center/zoom/pitch/bearing\n     * return {Map} this\n     */\n    setView(view) {\n        if (!view) {\n            return this;\n        }\n        if (view['center']) {\n            this.setCenter(view['center']);\n        }\n        if (view['zoom'] !== null && !isNaN(+view['zoom'])) {\n            this.setZoom(+view['zoom'], { 'animation' : false });\n        }\n        if (view['pitch'] !== null && !isNaN(+view['pitch'])) {\n            this.setPitch(+view['pitch']);\n        }\n        if (view['pitch'] !== null && !isNaN(+view['bearing'])) {\n            this.setBearing(+view['bearing']);\n        }\n        return this;\n    }\n\n    /**\n     * Get map's resolution\n     * @param {Number} zoom - zoom or current zoom if not given\n     * @return {Number} resolution\n     */\n    getResolution(zoom) {\n        return this._getResolution(zoom);\n    }\n\n    /**\n     * Get scale of resolutions from zoom to max zoom\n     * @param {Number} zoom - zoom or current zoom if not given\n     * @return {Number} scale\n     */\n    getScale(zoom) {\n        const z = (isNil(zoom) ? this.getZoom() : zoom);\n        const max = this._getResolution(this.getMaxNativeZoom()),\n            res = this._getResolution(z);\n        return res / max;\n    }\n\n    /**\n     * Set the map to be fit for the given extent with the max zoom level possible.\n     * @param  {Extent} extent - extent\n     * @param  {Number} zoomOffset - zoom offset\n     * @return {Map} - this\n     */\n    fitExtent(extent, zoomOffset, options = {}, step) {\n        if (!extent) {\n            return this;\n        }\n        extent = new Extent(extent, this.getProjection());\n        const zoom = this.getFitZoom(extent) + (zoomOffset || 0);\n        const center = extent.getCenter();\n        if (typeof (options['animation']) === 'undefined' || options['animation'])\n            return this.animateTo({\n                center,\n                zoom\n            }, {\n                'duration' : options['duration'] || this.options['zoomAnimationDuration'],\n                'easing' : options['easing'] || 'out',\n            }, step);\n        else\n            return this.setCenterAndZoom(center, zoom);\n    }\n\n    /**\n     * Get the base layer of the map.\n     * @return {Layer}\n     */\n    getBaseLayer() {\n        return this._baseLayer;\n    }\n\n    /**\n     * Sets a new base layer to the map.<br>\n     * Some events will be thrown such as baselayerchangestart, baselayerload, baselayerchangeend.\n     * @param  {Layer} baseLayer - new base layer\n     * @return {Map} this\n     * @fires Map#setbaselayer\n     * @fires Map#baselayerchangestart\n     * @fires Map#baselayerchangeend\n     */\n    setBaseLayer(baseLayer) {\n        let isChange = false;\n        if (this._baseLayer) {\n            isChange = true;\n            /**\n             * baselayerchangestart event, fired when base layer is changed.\n             *\n             * @event Map#baselayerchangestart\n             * @type {Object}\n             * @property {String} type - baselayerchangestart\n             * @property {Map} target - map\n             */\n            this._fireEvent('baselayerchangestart');\n            this._baseLayer.remove();\n        }\n        if (!baseLayer) {\n            delete this._baseLayer;\n            /**\n             * baselayerchangeend event, fired when base layer is changed.\n             *\n             * @event Map#baselayerchangeend\n             * @type {Object}\n             * @property {String} type - baselayerchangeend\n             * @property {Map} target - map\n             */\n            this._fireEvent('baselayerchangeend');\n            /**\n             * setbaselayer event, fired when base layer is set.\n             *\n             * @event Map#setbaselayer\n             * @type {Object}\n             * @property {String} type - setbaselayer\n             * @property {Map} target - map\n             */\n            this._fireEvent('setbaselayer');\n            return this;\n        }\n\n        this._baseLayer = baseLayer;\n        baseLayer._bindMap(this, -1);\n\n        function onbaseLayerload() {\n            /**\n             * baselayerload event, fired when base layer is loaded.\n             *\n             * @event Map#baselayerload\n             * @type {Object}\n             * @property {String} type - baselayerload\n             * @property {Map} target - map\n             */\n            this._fireEvent('baselayerload');\n            if (isChange) {\n                isChange = false;\n                this._fireEvent('baselayerchangeend');\n            }\n        }\n        this._baseLayer.on('layerload', onbaseLayerload, this);\n        if (this._loaded) {\n            this._baseLayer.load();\n        }\n        this._fireEvent('setbaselayer');\n        return this;\n    }\n\n    /**\n     * Remove the base layer from the map\n     * @return {Map} this\n     * @fires Map#baselayerremove\n     */\n    removeBaseLayer() {\n        if (this._baseLayer) {\n            this._baseLayer.remove();\n            delete this._baseLayer;\n            /**\n             * baselayerremove event, fired when base layer is removed.\n             *\n             * @event Map#baselayerremove\n             * @type {Object}\n             * @property {String} type - baselayerremove\n             * @property {Map} target - map\n             */\n            this._fireEvent('baselayerremove');\n        }\n        return this;\n    }\n\n    /**\n     * Get the layers of the map, except base layer (which should be by getBaseLayer). <br>\n     * A filter function can be given to filter layers, e.g. exclude all the VectorLayers.\n     * @param {Function} [filter=undefined] - a filter function of layers, return false to exclude the given layer.\n     * @return {Layer[]}\n     * @example\n     * var vectorLayers = map.getLayers(function (layer) {\n     *     return (layer instanceof VectorLayer);\n     * });\n     */\n    getLayers(filter) {\n        return this._getLayers(function (layer) {\n            if (layer === this._baseLayer || layer.getId().indexOf(INTERNAL_LAYER_PREFIX) >= 0) {\n                return false;\n            }\n            if (filter) {\n                return filter(layer);\n            }\n            return true;\n        });\n    }\n\n    /**\n     * Get the layer with the given id.\n     * @param  {String} id - layer id\n     * @return {Layer}\n     */\n    getLayer(id) {\n        if (!id) {\n            return null;\n        }\n        const layer =  this._layerCache ? this._layerCache[id] : null;\n        if (layer) {\n            return layer;\n        }\n        const baseLayer = this.getBaseLayer();\n        if (baseLayer && baseLayer.getId() === id) {\n            return baseLayer;\n        }\n        return null;\n    }\n\n    /**\n     * Add a new layer on the top of the map.\n     * @param  {Layer|Layer[]} layer - one or more layers to add\n     * @return {Map} this\n     * @fires Map#addlayer\n     */\n    addLayer(layers) {\n        if (!layers) {\n            return this;\n        }\n        if (!Array.isArray(layers)) {\n            layers = Array.prototype.slice.call(arguments, 0);\n            return this.addLayer(layers);\n        }\n        if (!this._layerCache) {\n            this._layerCache = {};\n        }\n        const mapLayers = this._layers;\n        for (let i = 0, len = layers.length; i < len; i++) {\n            const layer = layers[i];\n            const id = layer.getId();\n            if (isNil(id)) {\n                throw new Error('Invalid id for the layer: ' + id);\n            }\n            if (layer.getMap() === this) {\n                continue;\n            }\n            if (this._layerCache[id]) {\n                throw new Error('Duplicate layer id in the map: ' + id);\n            }\n            this._layerCache[id] = layer;\n            layer._bindMap(this);\n            mapLayers.push(layer);\n            if (this._loaded) {\n                layer.load();\n            }\n        }\n\n        this._sortLayersByZIndex();\n\n        /**\n         * addlayer event, fired when adding layers.\n         *\n         * @event Map#addlayer\n         * @type {Object}\n         * @property {String} type - addlayer\n         * @property {Map} target - map\n         * @property {Layer[]} layers - layers to add\n         */\n        this._fireEvent('addlayer', {\n            'layers': layers\n        });\n        return this;\n    }\n\n    /**\n     * Remove a layer from the map\n     * @param  {String|String[]|Layer|Layer[]} layer - one or more layers or layer ids\n     * @return {Map} this\n     * @fires Map#removelayer\n     */\n    removeLayer(layers) {\n        if (!layers) {\n            return this;\n        }\n        if (!Array.isArray(layers)) {\n            return this.removeLayer([layers]);\n        }\n        const removed = [];\n        for (let i = 0, len = layers.length; i < len; i++) {\n            let layer = layers[i];\n            if (!(layer instanceof Layer)) {\n                layer = this.getLayer(layer);\n            }\n            if (!layer) {\n                continue;\n            }\n            const map = layer.getMap();\n            if (!map || map !== this) {\n                continue;\n            }\n            removed.push(layer);\n            this._removeLayer(layer, this._layers);\n            if (this._loaded) {\n                layer._doRemove();\n            }\n            const id = layer.getId();\n            if (this._layerCache) {\n                delete this._layerCache[id];\n            }\n        }\n        if (removed.length > 0) {\n            this.once('frameend', () => {\n                removed.forEach(layer => {\n                    layer.fire('remove');\n                });\n            });\n        }\n        /**\n         * removelayer event, fired when removing layers.\n         *\n         * @event Map#removelayer\n         * @type {Object}\n         * @property {String} type - removelayer\n         * @property {Map} target - map\n         * @property {Layer[]} layers - layers to remove\n         */\n        this._fireEvent('removelayer', {\n            'layers': layers\n        });\n        return this;\n    }\n\n    /**\n     * Sort layers according to the order provided, the last will be on the top.\n     * @param  {string[]|Layer[]} layers - layers or layer ids to sort\n     * @return {Map} this\n     * @example\n     * map.addLayer([layer1, layer2, layer3]);\n     * map.sortLayers([layer2, layer3, layer1]);\n     * map.sortLayers(['3', '2', '1']); // sort by layer ids.\n     */\n    sortLayers(layers) {\n        if (!layers || !Array.isArray(layers)) {\n            return this;\n        }\n        const layersToOrder = [];\n        let minZ = Number.MAX_VALUE;\n        for (let i = 0, l = layers.length; i < l; i++) {\n            let layer = layers[i];\n            if (isString(layers[i])) {\n                layer = this.getLayer(layer);\n            }\n            if (!(layer instanceof Layer) || !layer.getMap() || layer.getMap() !== this) {\n                throw new Error('It must be a layer added to this map to order.');\n            }\n            if (layer.getZIndex() < minZ) {\n                minZ = layer.getZIndex();\n            }\n            layersToOrder.push(layer);\n        }\n        for (let i = 0, l = layersToOrder.length; i < l; i++) {\n            layersToOrder[i].setZIndex(minZ + i);\n        }\n\n        return this;\n    }\n\n    /**\n     * Exports image from the map's canvas.\n     * @param {Object} [options=undefined] - options\n     * @param {String} [options.mimeType=image/png] - mime type of the image\n     * @param {Boolean} [options.save=false] - whether pop a file save dialog to save the export image.\n     * @param {String} [options.fileName=export] - specify the file name, if options.save is true.\n     * @return {String} image of base64 format.\n     */\n    toDataURL(options) {\n        if (!options) {\n            options = {};\n        }\n        let mimeType = options['mimeType'];\n        if (!mimeType) {\n            mimeType = 'image/png';\n        }\n        const save = options['save'];\n        const renderer = this._getRenderer();\n        if (renderer && renderer.toDataURL) {\n            let file = options['fileName'];\n            if (!file) {\n                file = 'export';\n            }\n            const dataURL = renderer.toDataURL(mimeType);\n            if (save && dataURL) {\n                let imgURL;\n                if (typeof Blob !== 'undefined' && typeof atob !== 'undefined') {\n                    const blob = b64toBlob(dataURL.replace(/^data:image\\/(png|jpeg|jpg);base64,/, ''), mimeType);\n                    imgURL = URL.createObjectURL(blob);\n                } else {\n                    imgURL = dataURL;\n                }\n                const dlLink = document.createElement('a');\n                dlLink.download = file;\n                dlLink.href = imgURL;\n\n                document.body.appendChild(dlLink);\n                dlLink.click();\n                document.body.removeChild(dlLink);\n            }\n            return dataURL;\n        }\n        return null;\n    }\n\n    /**\n     * shorter alias for coordinateToPoint\n     */\n    coordToPoint(coordinate, zoom, out) {\n        return this.coordinateToPoint(coordinate, zoom, out);\n    }\n\n    /**\n     * shorter alias for pointToCoordinate\n     */\n    pointToCoord(point, zoom, out) {\n        return this.pointToCoordinate(point, zoom, out);\n    }\n\n    /**\n     * shorter alias for coordinateToViewPoint\n     */\n    coordToViewPoint(coordinate, out) {\n        return this.coordinateToViewPoint(coordinate, out);\n    }\n\n    /**\n     * shorter alias for viewPointToCoordinate\n     */\n    viewPointToCoord(viewPoint, out) {\n        return this.viewPointToCoordinate(viewPoint, out);\n    }\n\n    /**\n     * shorter alias for coordinateToContainerPoint\n     */\n    coordToContainerPoint(coordinate, zoom, out) {\n        return this.coordinateToContainerPoint(coordinate, zoom, out);\n    }\n\n\n    /**\n     * shorter alias for containerPointToCoordinate\n     */\n    containerPointToCoord(containerPoint, out) {\n        return this.containerPointToCoordinate(containerPoint, out);\n    }\n\n    /**\n     * Converts a container point to the view point.\n     * Usually used in plugin development.\n     * @param {Point}\n     * @param  {Point} [out=undefined]    - optional point to receive result\n     * @returns {Point}\n     */\n    containerPointToViewPoint(containerPoint, out) {\n        if (out) {\n            out.set(containerPoint.x, containerPoint.y);\n        } else {\n            out = containerPoint.copy();\n        }\n        return out._sub(this.getViewPoint());\n    }\n\n    /**\n     * Converts a view point to the container point.\n     * Usually used in plugin development.\n     * @param {Point}\n     * @param  {Point} [out=undefined]    - optional point to receive result\n     * @returns {Point}\n     */\n    viewPointToContainerPoint(viewPoint, out) {\n        if (out) {\n            out.set(viewPoint.x, viewPoint.y);\n        } else {\n            out = viewPoint.copy();\n        }\n        return out._add(this.getViewPoint());\n    }\n\n    /**\n     * Checks if the map container size changed and updates the map if so.\n     * @return {Map} this\n     * @fires Map#resize\n     */\n    checkSize() {\n        const justStart = ((now() - this._initTime) < 1500) && this.width === 0 || this.height === 0;\n\n        const watched = this._getContainerDomSize(),\n            oldHeight = this.height,\n            oldWidth = this.width;\n        if (watched['width'] === oldWidth && watched['height'] === oldHeight) {\n            return this;\n        }\n        const center = this.getCenter();\n        this._updateMapSize(watched);\n\n        if (!this.options['fixCenterOnResize']) {\n            const resizeOffset = new Point((oldWidth - watched.width) / 2, (oldHeight - watched.height) / 2);\n            this._offsetCenterByPixel(resizeOffset);\n            // when size changed, center is updated but panel's offset remains.\n            this._mapViewCoord = this._getPrjCenter();\n        }\n\n        const hided = (watched['width'] === 0 ||  watched['height'] === 0 || oldWidth === 0 || oldHeight === 0);\n\n        if (justStart || hided) {\n            this._noEvent = true;\n            this.setCenter(center);\n            delete this._noEvent;\n        }\n        /**\n         * resize event when map container's size changes\n         * @event Map#resize\n         * @type {Object}\n         * @property {String} type - resize\n         * @property {Map} target - map fires the event\n         */\n        this._fireEvent('resize');\n\n        return this;\n    }\n\n\n\n    /**\n     * Computes the coordinate from the given meter distance.\n     * @param  {Coordinate} coordinate - source coordinate\n     * @param  {Number} dx           - meter distance on X axis\n     * @param  {Number} dy           - meter distance on Y axis\n     * @return {Coordinate} Result coordinate\n     */\n    locate(coordinate, dx, dy) {\n        return this.getProjection()._locate(new Coordinate(coordinate), dx, dy);\n    }\n\n\n    /**\n     * Return map's main panel\n     * @returns {HTMLElement}\n     */\n    getMainPanel() {\n        return this._getRenderer().getMainPanel();\n    }\n\n    /**\n     * Returns map panels.\n     * @return {Object}\n     */\n    getPanels() {\n        return this._panels;\n    }\n\n    /**\n     * Remove the map\n     * @return {Map} this\n     */\n    remove() {\n        if (this.isRemoved()) {\n            return this;\n        }\n        this._fireEvent('removestart');\n        this._removeDomEvents();\n        this._clearHandlers();\n        this.removeBaseLayer();\n        const layers = this.getLayers();\n        for (let i = 0; i < layers.length; i++) {\n            layers[i].remove();\n        }\n        if (this._getRenderer()) {\n            this._getRenderer().remove();\n        }\n        if (this._containerDOM.innerHTML) {\n            this._containerDOM.innerHTML = '';\n        }\n        delete this._panels;\n        delete this._containerDOM;\n        delete this.renderer;\n        this._fireEvent('removeend');\n        this._clearAllListeners();\n        return this;\n    }\n\n    /**\n     * whether the map is removed\n     * @return {Boolean}\n     */\n    isRemoved() {\n        return !this._containerDOM;\n    }\n\n    /**\n     * Whether the map is moving\n     * @return {Boolean}\n     */\n    isMoving() {\n        return !!this._moving;\n    }\n\n    /**\n     * The callback function when move started\n     * @private\n     * @fires Map#movestart\n     */\n    onMoveStart(param) {\n        this._originCenter = this.getCenter();\n        this._moving = true;\n        this._trySetCursor('move');\n        /**\n         * movestart event\n         * @event Map#movestart\n         * @type {Object}\n         * @property {String} type - movestart\n         * @property {Map} target - map fires the event\n         * @property {Coordinate} coordinate - coordinate of the event\n         * @property {Point} containerPoint  - container point of the event\n         * @property {Point} viewPoint       - view point of the event\n         * @property {Event} domEvent                 - dom event\n         */\n        this._fireEvent('movestart', this._parseEvent(param ? param['domEvent'] : null, 'movestart'));\n    }\n\n    onMoving(param) {\n        /**\n         * moving event\n         * @event Map#moving\n         * @type {Object}\n         * @property {String} type - moving\n         * @property {Map} target - map fires the event\n         * @property {Coordinate} coordinate - coordinate of the event\n         * @property {Point} containerPoint  - container point of the event\n         * @property {Point} viewPoint       - view point of the event\n         * @property {Event} domEvent                 - dom event\n         */\n        this._fireEvent('moving', this._parseEvent(param ? param['domEvent'] : null, 'moving'));\n    }\n\n    onMoveEnd(param) {\n        this._moving = false;\n        this._trySetCursor('default');\n        /**\n         * moveend event\n         * @event Map#moveend\n         * @type {Object}\n         * @property {String} type - moveend\n         * @property {Map} target - map fires the event\n         * @property {Coordinate} coordinate - coordinate of the event\n         * @property {Point} containerPoint  - container point of the event\n         * @property {Point} viewPoint       - view point of the event\n         * @property {Event} domEvent                 - dom event\n         */\n        this._fireEvent('moveend',  (param && param['domEvent']) ? this._parseEvent(param['domEvent'], 'moveend') : param);\n        if (!this._verifyExtent(this.getCenter())) {\n            let moveTo = this._originCenter;\n            if (!this._verifyExtent(moveTo)) {\n                moveTo = this.getMaxExtent().getCenter();\n            }\n            this.panTo(moveTo);\n        }\n    }\n\n    onDragRotateStart(param) {\n        this._dragRotating = true;\n        /**\n         * dragrotatestart event\n         * @event Map#dragrotatestart\n         * @type {Object}\n         * @property {String} type - dragrotatestart\n         * @property {Map} target - map fires the event\n         * @property {Coordinate} coordinate - coordinate of the event\n         * @property {Point} containerPoint  - container point of the event\n         * @property {Point} viewPoint       - view point of the event\n         * @property {Event} domEvent                 - dom event\n         */\n        this._fireEvent('dragrotatestart', this._parseEvent(param ? param['domEvent'] : null, 'dragrotatestart'));\n    }\n\n    onDragRotating(param) {\n        /**\n         * dragrotating event\n         * @event Map#dragrotating\n         * @type {Object}\n         * @property {String} type - dragrotating\n         * @property {Map} target - map fires the event\n         * @property {Coordinate} coordinate - coordinate of the event\n         * @property {Point} containerPoint  - container point of the event\n         * @property {Point} viewPoint       - view point of the event\n         * @property {Event} domEvent                 - dom event\n         */\n        this._fireEvent('dragrotating', this._parseEvent(param ? param['domEvent'] : null, 'dragrotating'));\n    }\n\n    onDragRotateEnd(param) {\n        this._dragRotating = false;\n        /**\n         * dragrotateend event\n         * @event Map#dragrotateend\n         * @type {Object}\n         * @property {String} type - dragrotateend\n         * @property {Map} target - map fires the event\n         * @property {Coordinate} coordinate - coordinate of the event\n         * @property {Point} containerPoint  - container point of the event\n         * @property {Point} viewPoint       - view point of the event\n         * @property {Event} domEvent                 - dom event\n         */\n        this._fireEvent('dragrotateend', this._parseEvent(param ? param['domEvent'] : null, 'dragrotateend'));\n    }\n\n    isDragRotating() {\n        return !!this._dragRotating;\n    }\n\n    /**\n     * Test if given box is out of current screen\n     * @param {Number[] | PointExtent} box - [minx, miny, maxx, maxy]\n     * @param {Number} padding - test padding\n     * @returns {Boolean}\n     */\n    isOffscreen(box, viewportPadding = 0) {\n        const { width, height } = this;\n        const screenRightBoundary = width + viewportPadding;\n        const screenBottomBoundary = height + viewportPadding;\n        let { xmin, ymin, xmax, ymax } = box;\n        if (Array.isArray(box)) {\n            [xmin, ymin, xmax, ymax] = box;\n        }\n        return xmax < viewportPadding || xmin >= screenRightBoundary || ymax < viewportPadding || ymin > screenBottomBoundary;\n    }\n\n    getRenderer() {\n        return this._getRenderer();\n    }\n\n    /**\n     * Get device's devicePixelRatio, you can override it by setting devicePixelRatio in options.\n     * @returns {Number}\n     */\n    getDevicePixelRatio() {\n        return this.options['devicePixelRatio'] || Math.ceil(Browser.devicePixelRatio) || 1;\n    }\n\n    //-----------------------------------------------------------\n\n    _initContainer(container) {\n        if (isString(container)) {\n            this._containerDOM = document.getElementById(container);\n            if (!this._containerDOM) {\n                throw new Error('Invalid container when creating map: \\'' + container + '\\'');\n            }\n        } else {\n            this._containerDOM = container;\n            if (IS_NODE) {\n                //Reserve container's constructor in node for canvas creating.\n                this.CanvasClass = this._containerDOM.constructor;\n            }\n        }\n\n        if (this._containerDOM.childNodes && this._containerDOM.childNodes.length > 0) {\n            if (this._containerDOM.childNodes[0].className === 'maptalks-wrapper') {\n                throw new Error('Container is already loaded with another map instance, use map.remove() to clear it.');\n            }\n        }\n    }\n\n    /**\n     * try to change cursor when map is not setCursored\n     * @private\n     * @param  {String} cursor css cursor\n     */\n    _trySetCursor(cursor) {\n        if (!this._cursor && !this._priorityCursor) {\n            if (!cursor) {\n                cursor = 'default';\n            }\n            this._setCursorToPanel(cursor);\n        }\n        return this;\n    }\n\n    _setPriorityCursor(cursor) {\n        if (!cursor) {\n            let hasCursor = false;\n            if (this._priorityCursor) {\n                hasCursor = true;\n            }\n            delete this._priorityCursor;\n            if (hasCursor) {\n                this.setCursor(this._cursor);\n            }\n        } else {\n            this._priorityCursor = cursor;\n            this._setCursorToPanel(cursor);\n        }\n        return this;\n    }\n\n    _setCursorToPanel(cursor) {\n        const panel = this.getMainPanel();\n        if (panel && panel.style && panel.style.cursor !== cursor) {\n            panel.style.cursor = cursor;\n        }\n    }\n\n\n    //remove a layer from the layerList\n    _removeLayer(layer, layerList) {\n        if (!layer || !layerList) {\n            return;\n        }\n        const index = layerList.indexOf(layer);\n        if (index > -1) {\n            layerList.splice(index, 1);\n        }\n    }\n\n    _sortLayersByZIndex() {\n        if (!this._layers) {\n            return;\n        }\n        for (let i = 0, l = this._layers.length; i < l; i++) {\n            this._layers[i]._order = i;\n        }\n        this._layers.sort(function (a, b) {\n            const c = a.getZIndex() - b.getZIndex();\n            if (c === 0) {\n                return a._order - b._order;\n            }\n            return c;\n        });\n    }\n\n\n    _fireEvent(eventName, param) {\n        if (this._noEvent) {\n            return;\n        }\n        //fire internal events at first\n        this.fire('_' + eventName, param);\n        this.fire(eventName, param);\n    }\n\n    _Load() {\n        this._resetMapStatus();\n        if (this.options['pitch']) {\n            this.setPitch(this.options['pitch']);\n            delete this.options['pitch'];\n        }\n        if (this.options['bearing']) {\n            this.setBearing(this.options['bearing']);\n            delete this.options['bearing'];\n        }\n        this._loadAllLayers();\n        this._getRenderer().onLoad();\n        this._loaded = true;\n        this._callOnLoadHooks();\n        this._initTime = now();\n    }\n\n    _initRenderer() {\n        const renderer = this.options['renderer'];\n        const clazz = Map.getRendererClass(renderer);\n        this._renderer = new clazz(this);\n        this._renderer.load();\n    }\n\n    _getRenderer() {\n        return this._renderer;\n    }\n\n    _loadAllLayers() {\n        function loadLayer(layer) {\n            if (layer) {\n                layer.load();\n            }\n        }\n        if (this._baseLayer) {\n            this._baseLayer.load();\n        }\n        this._eachLayer(loadLayer, this.getLayers());\n    }\n\n    /**\n     * Gets layers that fits for the filter\n     * @param  {fn} filter - filter function\n     * @return {Layer[]}\n     * @private\n     */\n    _getLayers(filter) {\n        const layers = this._baseLayer ? [this._baseLayer].concat(this._layers) : this._layers;\n        const result = [];\n        for (let i = 0; i < layers.length; i++) {\n            if (!filter || filter.call(this, layers[i])) {\n                result.push(layers[i]);\n            }\n        }\n        return result;\n    }\n\n    _eachLayer(fn) {\n        if (arguments.length < 2) {\n            return;\n        }\n        let layerLists = Array.prototype.slice.call(arguments, 1);\n        if (layerLists && !Array.isArray(layerLists)) {\n            layerLists = [layerLists];\n        }\n        let layers = [];\n        for (let i = 0, len = layerLists.length; i < len; i++) {\n            layers = layers.concat(layerLists[i]);\n        }\n        for (let j = 0, jlen = layers.length; j < jlen; j++) {\n            fn.call(fn, layers[j]);\n        }\n    }\n\n    _onLayerEvent(param) {\n        if (!param) {\n            return;\n        }\n        if (param['type'] === 'idchange') {\n            delete this._layerCache[param['old']];\n            this._layerCache[param['new']] = param['target'];\n        }\n    }\n\n    //Check and reset map's status when map's spatial reference is changed.\n    _resetMapStatus() {\n        let maxZoom = this.getMaxZoom(),\n            minZoom = this.getMinZoom();\n        const viewMaxZoom = this._spatialReference.getMaxZoom(),\n            viewMinZoom = this._spatialReference.getMinZoom();\n        if (isNil(maxZoom) || maxZoom === -1 || maxZoom > viewMaxZoom) {\n            this.setMaxZoom(viewMaxZoom);\n        }\n        if (isNil(minZoom) || minZoom === -1 || minZoom < viewMinZoom) {\n            this.setMinZoom(viewMinZoom);\n        }\n        maxZoom = this.getMaxZoom();\n        minZoom = this.getMinZoom();\n        if (maxZoom < minZoom) {\n            this.setMaxZoom(minZoom);\n        }\n        if (isNil(this._zoomLevel) || this._zoomLevel > maxZoom) {\n            this._zoomLevel = maxZoom;\n        }\n        if (this._zoomLevel < minZoom) {\n            this._zoomLevel = minZoom;\n        }\n        delete this._prjCenter;\n        const projection = this.getProjection();\n        this._prjCenter = projection.project(this._center);\n        this._calcMatrices();\n        const renderer = this._getRenderer();\n        if (renderer) {\n            renderer.resetContainer();\n        }\n    }\n\n    _getContainerDomSize() {\n        if (!this._containerDOM) {\n            return null;\n        }\n        const containerDOM = this._containerDOM;\n        let width, height;\n        if (!isNil(containerDOM.width) && !isNil(containerDOM.height)) {\n            width = containerDOM.width;\n            height = containerDOM.height;\n            const dpr = this.getDevicePixelRatio();\n            if (dpr !== 1 && containerDOM['layer']) {\n                //is a canvas tile of CanvasTileLayer\n                width /= dpr;\n                height /= dpr;\n            }\n        } else if (!isNil(containerDOM.clientWidth) && !isNil(containerDOM.clientHeight)) {\n            width = parseInt(containerDOM.clientWidth, 0);\n            height = parseInt(containerDOM.clientHeight, 0);\n        } else {\n            throw new Error('can not get size of container');\n        }\n        return new Size(width, height);\n    }\n\n    _updateMapSize(mSize) {\n        this.width = mSize['width'];\n        this.height = mSize['height'];\n        this._getRenderer().updateMapSize(mSize);\n        this._calcMatrices();\n        return this;\n    }\n\n    /**\n     * Gets projected center of the map\n     * @return {Coordinate}\n     * @private\n     */\n    _getPrjCenter() {\n        return this._prjCenter;\n    }\n\n    _setPrjCenter(pcenter) {\n        this._prjCenter = pcenter;\n        if (this.isInteracting() && !this.isMoving()) {\n            // when map is not moving, map's center is updated but map platform won't\n            // mapViewCoord needs to be synced\n            this._mapViewCoord = pcenter;\n        }\n        this._calcMatrices();\n    }\n\n    _setPrjCoordAtContainerPoint(coordinate, point) {\n        if (point.x === this.width / 2 && point.y === this.height / 2) {\n            return this;\n        }\n        const t = this._containerPointToPoint(point)._sub(this._prjToPoint(this._getPrjCenter()));\n        const pcenter = this._pointToPrj(this._prjToPoint(coordinate).sub(t));\n        this._setPrjCenter(pcenter);\n        return this;\n    }\n\n    _verifyExtent(center) {\n        if (!center) {\n            return false;\n        }\n        const maxExt = this.getMaxExtent();\n        if (!maxExt) {\n            return true;\n        }\n        return maxExt.contains(center);\n    }\n\n    /**\n     * Move map's center by pixels.\n     * @param  {Point} pixel - pixels to move, the relation between value and direction is as:\n     * -1,1 | 1,1\n     * ------------\n     *-1,-1 | 1,-1\n     * @private\n     * @returns {Coordinate} the new projected center.\n     */\n    _offsetCenterByPixel(pixel) {\n        const pos = new Point(this.width / 2 - pixel.x, this.height / 2 - pixel.y);\n        const pCenter = this._containerPointToPrj(pos);\n        this._setPrjCenter(pCenter);\n        return pCenter;\n    }\n\n    /**\n     * offset map panels.\n     *\n     * @param  {Point} offset - offset in pixel to move\n     * @return {Map} this\n     */\n    /**\n     * Gets map panel's current view point.\n     * @return {Point}\n     */\n    offsetPlatform(offset) {\n        if (!offset) {\n            return this._mapViewPoint;\n        } else {\n            this._getRenderer().offsetPlatform(offset);\n            this._mapViewCoord = this._getPrjCenter();\n            this._mapViewPoint = this._mapViewPoint.add(offset);\n            return this;\n        }\n    }\n\n    /**\n     * Get map's view point, adding in frame offset\n     * @return {Point} map view point\n     */\n    getViewPoint() {\n        const offset = this._getViewPointFrameOffset();\n        let panelOffset = this.offsetPlatform();\n        if (offset) {\n            panelOffset = panelOffset.add(offset);\n        }\n        return panelOffset;\n    }\n\n\n    _resetMapViewPoint() {\n        this._mapViewPoint = new Point(0, 0);\n        // mapViewCoord is the proj coordinate of current view point\n        this._mapViewCoord = this._getPrjCenter();\n    }\n\n    /**\n     * Get map's current resolution\n     * @return {Number} resolution\n     * @private\n     */\n    _getResolution(zoom) {\n        if ((zoom === undefined || zoom === this._zoomLevel) && this._mapRes !== undefined) {\n            return this._mapRes;\n        } else if (zoom === this.getGLZoom() && this._mapGlRes !== undefined) {\n            return this._mapGlRes;\n        }\n        if (isNil(zoom)) {\n            zoom = this._zoomLevel;\n        }\n        return this._spatialReference.getResolution(zoom);\n    }\n\n    _getResolutions() {\n        return this._spatialReference.getResolutions();\n    }\n\n    /**\n     * Converts the projected coordinate to a 2D point in the specific zoom\n     * @param  {Coordinate} pCoord - projected Coordinate\n     * @param  {Number} zoom   - point's zoom level\n     * @return {Point} 2D point\n     * @private\n     */\n    _prjToPoint(pCoord, zoom, out) {\n        zoom = (isNil(zoom) ? this.getZoom() : zoom);\n        return this._spatialReference.getTransformation().transform(pCoord, this._getResolution(zoom), out);\n    }\n\n    /**\n     * Converts the 2D point to projected coordinate\n     * @param  {Point} point - 2D point\n     * @param  {Number} zoom   - point's zoom level\n     * @return {Coordinate} projected coordinate\n     * @private\n     */\n    _pointToPrj(point, zoom, out) {\n        zoom = (isNil(zoom) ? this.getZoom() : zoom);\n        return this._spatialReference.getTransformation().untransform(point, this._getResolution(zoom), out);\n    }\n\n    /**\n     * Convert point at zoom to point at current zoom\n     * @param  {Point} point point\n     * @param  {Number} zoom point's zoom\n     * @return {Point} point at current zoom\n     * @private\n     */\n    _pointToPoint(point, zoom, out) {\n        if (out) {\n            out.x = point.x;\n            out.y = point.y;\n        } else {\n            out = point.copy();\n        }\n        if (!isNil(zoom)) {\n            return out._multi(this._getResolution(zoom) / this._getResolution());\n        }\n        return out;\n    }\n\n    /**\n     * Convert point at current zoom to point at target zoom\n     * @param  {Point} point point\n     * @param  {Number} zoom target zoom\n     * @return {Point} point at current zoom\n     * @private\n     */\n    _pointToPointAtZoom(point, zoom, out) {\n        if (out) {\n            out.x = point.x;\n            out.y = point.y;\n        } else {\n            out = point.copy();\n        }\n        if (!isNil(zoom)) {\n            return out._multi(this._getResolution() / this._getResolution(zoom));\n        }\n        return out;\n    }\n\n    /**\n     * transform container point to geographical projected coordinate\n     *\n     * @param  {Point} containerPoint\n     * @return {Coordinate}\n     * @private\n     */\n    _containerPointToPrj(containerPoint, out) {\n        return this._pointToPrj(this._containerPointToPoint(containerPoint, undefined, out), undefined, out);\n    }\n\n\n    /* eslint no-extend-native: 0 */\n    _callOnLoadHooks() {\n        const proto = Map.prototype;\n        if (!proto._onLoadHooks) {\n            return;\n        }\n        for (let i = 0, l = proto._onLoadHooks.length; i < l; i++) {\n            proto._onLoadHooks[i].call(this);\n        }\n    }\n}\n\nMap.include(/** @lends Map.prototype */{\n\n    /**\n     * Converts a coordinate to the 2D point in current zoom or in the specific zoom. <br>\n     * The 2D point's coordinate system's origin is the same with map's origin.\n     * Usually used in plugin development.\n     * @param  {Coordinate} coordinate - coordinate\n     * @param  {Number} [zoom=undefined]  - zoom level\n     * @param  {Point} [out=undefined]    - optional point to receive result\n     * @return {Point}  2D point\n     * @function\n     * @example\n     * var point = map.coordinateToPoint(new Coordinate(121.3, 29.1));\n     */\n    coordinateToPoint: function () {\n        const COORD = new Coordinate(0, 0);\n        return function (coordinate, zoom, out) {\n            const prjCoord = this.getProjection().project(coordinate, COORD);\n            return this._prjToPoint(prjCoord, zoom, out);\n        };\n    }(),\n\n    /**\n     * Converts a 2D point in current zoom or a specific zoom to a coordinate.\n     * Usually used in plugin development.\n     * @param  {Point} point - 2D point\n     * @param  {Number} zoom  - point's zoom level\n     * @param  {Coordinate} [out=undefined]    - optional coordinate to receive result\n     * @return {Coordinate} coordinate\n     * @function\n     * @example\n     * var coord = map.pointToCoordinate(new Point(4E6, 3E4));\n     */\n    pointToCoordinate: function () {\n        const COORD = new Coordinate(0, 0);\n        return function (point, zoom, out) {\n            const prjCoord = this._pointToPrj(point, zoom, COORD);\n            return this.getProjection().unproject(prjCoord, out);\n        };\n    }(),\n\n\n    /**\n     * Converts a geographical coordinate to view point.<br>\n     * A view point is a point relative to map's mapPlatform panel's position. <br>\n     * Usually used in plugin development.\n     * @param {Coordinate} coordinate\n     * @param  {Point} [out=undefined]    - optional point to receive result\n     * @return {Point}\n     * @function\n     */\n    coordinateToViewPoint: function () {\n        const COORD = new Coordinate(0, 0);\n        return function (coordinate, out) {\n            return this._prjToViewPoint(this.getProjection().project(coordinate, COORD), out);\n        };\n    }(),\n\n    /**\n     * Converts a view point to the geographical coordinate.\n     * Usually used in plugin development.\n     * @param {Point} viewPoint\n     * @param  {Coordinate} [out=undefined]    - optional coordinate to receive result\n     * @return {Coordinate}\n     * @function\n     */\n    viewPointToCoordinate: function () {\n        const COORD = new Coordinate(0, 0);\n        return function (viewPoint, out) {\n            return this.getProjection().unproject(this._viewPointToPrj(viewPoint, COORD), out);\n        };\n    }(),\n\n    /**\n     * Convert a geographical coordinate to the container point. <br>\n     *  A container point is a point relative to map container's top-left corner. <br>\n     * @param {Coordinate}                - coordinate\n     * @param  {Number} [zoom=undefined]  - zoom level\n     * @param  {Point} [out=undefined]    - optional point to receive result\n     * @return {Point}\n     * @function\n     */\n    coordinateToContainerPoint: function () {\n        const COORD = new Coordinate(0, 0);\n        return function (coordinate, zoom, out) {\n            const pCoordinate = this.getProjection().project(coordinate, COORD);\n            return this._prjToContainerPoint(pCoordinate, zoom, out);\n        };\n    }(),\n\n    /**\n     * Converts a container point to geographical coordinate.\n     * @param {Point}\n     * @param  {Coordinate} [out=undefined]    - optional coordinate to receive result\n     * @return {Coordinate}\n     * @function\n     */\n    containerPointToCoordinate: function () {\n        const COORD = new Coordinate(0, 0);\n        return function (containerPoint, out) {\n            const pCoordinate = this._containerPointToPrj(containerPoint, COORD);\n            return this.getProjection().unproject(pCoordinate, out);\n        };\n    }(),\n\n    /**\n     * Converts a container point extent to the geographic extent.\n     * @param  {PointExtent} containerExtent - containeproints extent\n     * @return {Extent}  geographic extent\n     * @function\n     */\n    containerToExtent: function () {\n        const POINT0 = new Point(0, 0);\n        const POINT1 = new Point(0, 0);\n        return function (containerExtent) {\n            const extent2D = new PointExtent(\n                this._containerPointToPoint(containerExtent.getMin(POINT0), undefined, POINT0),\n                this._containerPointToPoint(containerExtent.getMax(POINT1), undefined, POINT1)\n            );\n            return this._pointToExtent(extent2D);\n        };\n    }(),\n\n    /**\n     * Converts geographical distances to the pixel length.<br>\n     * The value varis with difference zoom level.\n     *\n     * @param  {Number} xDist - distance on X axis.\n     * @param  {Number} yDist - distance on Y axis.\n     * @return {Size} result.width: pixel length on X axis; result.height: pixel length on Y axis\n     * @function\n     */\n    distanceToPixel: function () {\n        const POINT0 = new Point(0, 0);\n        const POINT1 = new Point(0, 0);\n        return function (xDist, yDist, zoom) {\n            const projection = this.getProjection();\n            if (!projection) {\n                return null;\n            }\n            const scale = this.getScale() / this.getScale(zoom);\n            const center = this.getCenter(),\n                target = projection.locate(center, xDist, yDist);\n            const p0 = this.coordToContainerPoint(center, undefined, POINT0),\n                p1 = this.coordToContainerPoint(target, undefined, POINT1);\n            p1._sub(p0)._multi(scale)._abs();\n            return new Size(p1.x, p1.y);\n        };\n    }(),\n\n    /**\n     * Converts geographical distances to the 2d point length.<br>\n     * The value varis with difference zoom level.\n     *\n     * @param  {Number} xDist - distance on X axis.\n     * @param  {Number} yDist - distance on Y axis.\n     * @param  {Number} zoom - point's zoom\n     * @return {Point}\n     * @function\n     */\n    distanceToPoint: function () {\n        const POINT = new Point(0, 0);\n        return function (xDist, yDist, zoom) {\n            const projection = this.getProjection();\n            if (!projection) {\n                return null;\n            }\n            const center = this.getCenter(),\n                target = projection.locate(center, xDist, yDist);\n            const p0 = this.coordToPoint(center, zoom, POINT),\n                p1 = this.coordToPoint(target, zoom);\n            p1._sub(p0)._abs();\n            return p1;\n        };\n    }(),\n\n\n    /**\n     * Converts pixel size to geographical distance.\n     *\n     * @param  {Number} width - pixel width\n     * @param  {Number} height - pixel height\n     * @return {Number}  distance - Geographical distance\n     * @function\n     */\n    pixelToDistance: function () {\n        const COORD0 = new Coordinate(0, 0);\n        const COORD1 = new Coordinate(0, 0);\n        return function (width, height) {\n            const projection = this.getProjection();\n            if (!projection) {\n                return null;\n            }\n            const fullExt = this.getFullExtent();\n            const d = fullExt['top'] > fullExt['bottom'] ? -1 : 1;\n            const target = COORD0.set(this.width / 2 + width, this.height / 2 + d * height);\n            const coord = this.containerPointToCoord(target, COORD1);\n            return projection.measureLength(this.getCenter(), coord);\n        };\n    }(),\n\n    /**\n     * Converts 2d point distances to geographic length.<br>\n     *\n     * @param  {Number} dx - distance on X axis.\n     * @param  {Number} dy - distance on Y axis.\n     * @param  {Number} zoom - point's zoom\n     * @return {Number} distance\n     * @function\n     */\n    pointToDistance: function () {\n        const POINT = new Point(0, 0);\n        const COORD = new Coordinate(0, 0);\n        return function (dx, dy, zoom) {\n            const projection = this.getProjection();\n            if (!projection) {\n                return null;\n            }\n            const c = this._prjToPoint(this._getPrjCenter(), zoom, POINT);\n            c._add(dx, dy);\n            const target = this.pointToCoord(c, zoom, COORD);\n            return projection.measureLength(this.getCenter(), target);\n        };\n    }(),\n\n\n    /**\n     * Computes the coordinate from the given pixel distance.\n     * @param  {Coordinate} coordinate - source coordinate\n     * @param  {Number} px           - pixel distance on X axis\n     * @param  {Number} py           - pixel distance on Y axis\n     * @return {Coordinate} Result coordinate\n     * @function\n     */\n    locateByPoint: function () {\n        const POINT = new Point(0, 0);\n        return function (coordinate, px, py) {\n            const point = this.coordToContainerPoint(coordinate, undefined, POINT);\n            return this.containerPointToCoord(point._add(px, py));\n        };\n    }(),\n\n    /**\n     * Get map's extent in view points.\n     * @param {Number} zoom - zoom\n     * @return {PointExtent}\n     * @private\n     * @function\n     */\n    _get2DExtent: function () {\n        const POINT = new Point(0, 0);\n        return function (zoom, out) {\n            let cached;\n            if ((zoom === undefined || zoom === this._zoomLevel) && this._mapExtent2D) {\n                cached = this._mapExtent2D;\n            } else if (zoom === this.getGLZoom() && this._mapGlExtent2D) {\n                cached = this._mapGlExtent2D;\n            }\n            if (cached) {\n                if (out) {\n                    out.set(cached['xmin'], cached['ymin'], cached['xmax'], cached['ymax']);\n                    return out;\n                }\n                return cached.copy();\n            }\n            const cExtent = this.getContainerExtent();\n            return cExtent.convertTo(c => this._containerPointToPoint(c, zoom, POINT), out);\n        };\n    }(),\n\n    /**\n     * Converts a view point extent to the geographic extent.\n     * @param  {PointExtent} extent2D - view points extent\n     * @return {Extent}  geographic extent\n     * @protected\n     * @function\n     */\n    _pointToExtent: function () {\n        const COORD0 = new Coordinate(0, 0);\n        const COORD1 = new Coordinate(0, 0);\n        return function (extent2D) {\n            const min2d = extent2D.getMin(),\n                max2d = extent2D.getMax();\n            const fullExtent = this.getFullExtent();\n            const [minx, maxx] = (!fullExtent || fullExtent.left <= fullExtent.right) ? [min2d.x, max2d.x] : [max2d.x, min2d.x];\n            const [miny, maxy] = (!fullExtent || fullExtent.top > fullExtent.bottom) ? [max2d.y, min2d.y] : [min2d.y, max2d.y];\n            const min = min2d.set(minx, miny);\n            const max = max2d.set(maxx, maxy);\n            return new Extent(\n                this.pointToCoord(min, undefined, COORD0),\n                this.pointToCoord(max, undefined, COORD1),\n                this.getProjection()\n            );\n        };\n    }(),\n\n\n    /**\n     * When moving map, map's center is updated in real time, but platform will be moved in the next frame to keep syncing with other layers\n     * Get the offset in current frame and the next frame\n     * @return {Point} view point offset\n     * @private\n     * @function\n     */\n    _getViewPointFrameOffset: function () {\n        const POINT = new Point(0, 0);\n        return function () {\n            // when zooming, view point is not updated, and container is being transformed with matrix.\n            // so ignore the frame offset\n            if (this.isZooming()) {\n                return null;\n            }\n            const pcenter = this._getPrjCenter();\n            if (this._mapViewCoord && !this._mapViewCoord.equals(pcenter)) {\n                return this._prjToContainerPoint(this._mapViewCoord)._sub(this._prjToContainerPoint(pcenter, undefined, POINT));\n            }\n            return null;\n        };\n    }(),\n\n    /**\n     * transform view point to geographical projected coordinate\n     * @param  {Point} viewPoint\n     * @param  {Coordinate} [out=undefined]  - optional coordinate to receive result\n     * @return {Coordinate}\n     * @private\n     * @function\n     */\n    _viewPointToPrj: function () {\n        const POINT = new Point(0, 0);\n        return function (viewPoint, out) {\n            return this._containerPointToPrj(this.viewPointToContainerPoint(viewPoint, POINT), out);\n        };\n    }(),\n\n    /**\n     * transform geographical projected coordinate to container point\n     * @param  {Coordinate} pCoordinate\n     * @param  {Number} zoom target zoom\n     * @param  {Point} [out=undefined]    - optional point to receive result\n     * @return {Point}\n     * @private\n     * @function\n     */\n    _prjToContainerPoint: function () {\n        const POINT = new Point(0, 0);\n        return function (pCoordinate, zoom, out) {\n            return this._pointToContainerPoint(this._prjToPoint(pCoordinate, zoom, POINT), zoom, 0, out);\n        };\n    }(),\n\n    /**\n     * transform geographical projected coordinate to view point\n     * @param  {Coordinate} pCoordinate\n     * @return {Point}\n     * @private\n     * @function\n     */\n    _prjToViewPoint: function () {\n        const POINT = new Point(0, 0);\n        return function (pCoordinate, out) {\n            const containerPoint = this._prjToContainerPoint(pCoordinate, undefined, POINT);\n            return this.containerPointToViewPoint(containerPoint, out);\n        };\n    }(),\n\n    _viewPointToPoint: function () {\n        const POINT = new Point(0, 0);\n        return function (viewPoint, zoom, out) {\n            return this._containerPointToPoint(this.viewPointToContainerPoint(viewPoint, POINT), zoom, out);\n        };\n    }(),\n\n    _pointToViewPoint: function () {\n        const COORD = new Coordinate(0, 0);\n        return function (point, zoom, out) {\n            return this._prjToViewPoint(this._pointToPrj(point, zoom, COORD), out);\n        };\n    }(),\n\n});\n\nMap.mergeOptions(options);\n\nexport default Map;\n","import Handler from '../../handler/Handler';\nimport Map from '../Map';\n\nclass MapDoubleClickZoomHandler extends Handler {\n    addHooks() {\n        if (!this.target) {\n            return;\n        }\n        this.target.on('_dblclick', this._onDoubleClick, this);\n    }\n\n    removeHooks() {\n        if (!this.target) {\n            return;\n        }\n        this.target.off('_dblclick', this._onDoubleClick, this);\n    }\n\n    _onDoubleClick(param) {\n        const map = this.target;\n        if (map.options['doubleClickZoom']) {\n            const oldZoom = map.getZoom(),\n                zoom = param['domEvent']['shiftKey'] ? Math.ceil(oldZoom) - 1 : Math.floor(oldZoom) + 1;\n            map._zoomAnimation(zoom, param['containerPoint']);\n        }\n\n    }\n}\n\nMap.mergeOptions({\n    'doubleClickZoom': true\n});\n\nMap.addOnLoadHook('addHandler', 'doubleClickZoom', MapDoubleClickZoomHandler);\n\nexport default MapDoubleClickZoomHandler;\n","import { now } from '../../core/util';\nimport { preventDefault, getEventContainerPoint } from '../../core/util/dom';\nimport Handler from '../../handler/Handler';\nimport DragHandler from '../../handler/Drag';\nimport Point from '../../geo/Point';\nimport Map from '../Map';\n\nclass MapDragHandler extends Handler {\n    addHooks() {\n        const map = this.target;\n        if (!map) {\n            return;\n        }\n        const dom = map._panels.mapWrapper || map._containerDOM;\n        this._dragHandler = new DragHandler(dom, {\n            'cancelOn': this._cancelOn.bind(this),\n            'rightclick' : true\n        });\n        this._dragHandler.on('mousedown', this._onMouseDown, this)\n            .on('dragstart', this._onDragStart, this)\n            .on('dragging', this._onDragging, this)\n            .on('dragend', this._onDragEnd, this)\n            .enable();\n    }\n\n    removeHooks() {\n        this._dragHandler.off('mousedown', this._onMouseDown, this)\n            .off('dragstart', this._onDragStart, this)\n            .off('dragging', this._onDragging, this)\n            .off('dragend', this._onDragEnd, this);\n        this._dragHandler.remove();\n        delete this._dragHandler;\n    }\n\n    _cancelOn(domEvent) {\n        if (this.target.isZooming() || this._ignore(domEvent)) {\n            return true;\n        }\n        return false;\n    }\n\n    _ignore(param) {\n        if (!param) {\n            return false;\n        }\n        if (param.domEvent) {\n            param = param.domEvent;\n        }\n        return this.target._ignoreEvent(param);\n    }\n\n    _onMouseDown(param) {\n        delete this.startDragTime;\n        delete this._mode;\n        if (param.domEvent.button === 2 || param.domEvent.ctrlKey) {\n            if (this.target.options['dragRotate'] || this.target.options['dragPitch']) {\n                this._mode = 'rotatePitch';\n            }\n        } else if (this.target.options['dragPan']) {\n            this._mode = 'move';\n        }\n        this.target._stopAnim(this.target._animPlayer);\n        preventDefault(param['domEvent']);\n    }\n\n    _onDragStart(param) {\n        this.startDragTime = now();\n        if (this._mode === 'move') {\n            this._moveStart(param);\n        } else if (this._mode === 'rotatePitch') {\n            this._rotateStart(param);\n        }\n    }\n\n    _onDragging(param) {\n        const map = this.target;\n        if (map._isEventOutMap(param['domEvent'])) {\n            return;\n        }\n        if (this._mode === 'move') {\n            this._moving(param);\n        } else if (this._mode === 'rotatePitch') {\n            this._rotating(param);\n        }\n    }\n\n    _onDragEnd(param) {\n        if (this._mode === 'move') {\n            this._moveEnd(param);\n        } else if (this._mode === 'rotatePitch') {\n            this._rotateEnd(param);\n        }\n        delete this.startDragTime;\n        delete this.startBearing;\n    }\n\n    _start(param) {\n        this.preX = param['mousePos'].x;\n        this.preY = param['mousePos'].y;\n        this.startX = this.preX;\n        this.startY = this.preY;\n    }\n\n    _moveStart(param) {\n        this._start(param);\n        const map = this.target;\n        map.onMoveStart(param);\n        const p = getEventContainerPoint(map._getActualEvent(param.domEvent), map.getContainer());\n        this.startPrjCoord = map._containerPointToPrj(p);\n    }\n\n    _moving(param) {\n        if (!this.startDragTime) {\n            return;\n        }\n        const map = this.target;\n        const p = getEventContainerPoint(map._getActualEvent(param.domEvent), map.getContainer());\n        map._setPrjCoordAtContainerPoint(this.startPrjCoord, p);\n        map.onMoving(param);\n    }\n\n    _moveEnd(param) {\n        if (!this.startDragTime) {\n            return;\n        }\n        const map = this.target;\n        let t = now() - this.startDragTime;\n        const mx = param['mousePos'].x,\n            my = param['mousePos'].y;\n        const dx = mx - this.startX;\n        const dy = my - this.startY;\n\n        this._clear();\n\n        if (map.options['panAnimation'] && !param.interupted && map._verifyExtent(map.getCenter()) && t < 280 && Math.abs(dy) + Math.abs(dx) > 5) {\n            t = 5 * t * (Math.abs(dx) + Math.abs(dy)) / 500;\n            map.panBy(new Point(dx, dy), { 'duration' : t });\n        } else {\n            map.onMoveEnd(param);\n        }\n    }\n\n    _rotateStart(param) {\n        this._start(param);\n        delete this._rotateMode;\n        this.startBearing = this.target.getBearing();\n        this.target.onDragRotateStart(param);\n        this._db = 0;\n    }\n\n    _rotating(param) {\n        const map = this.target;\n        const mx = param['mousePos'].x,\n            my = param['mousePos'].y;\n        const prePitch = map.getPitch(),\n            preBearing = map.getBearing();\n        const dx = Math.abs(mx - this.preX),\n            dy = Math.abs(my - this.preY);\n\n        if (!this._rotateMode) {\n            if (map.options['dragRotatePitch']) {\n                this._rotateMode = 'rotate_pitch';\n            } else if (dx > dy) {\n                this._rotateMode = 'rotate';\n            } else if (dx < dy) {\n                this._rotateMode = 'pitch';\n            } else {\n                this._rotateMode = 'rotate';\n            }\n        }\n\n        if (this._rotateMode === 'pitch' && prePitch === 0 && dy < 10) {\n            return;\n        }\n\n        if (this._rotateMode.indexOf('rotate') >= 0 && map.options['dragRotate']) {\n\n            let db = 0;\n            if (map.options['dragPitch'] || dx > dy) {\n                db = -0.6 * (this.preX - mx);\n            } else if (mx > map.width / 2) {\n                db = 0.6 * (this.preY - my);\n            } else {\n                db = -0.6 * (this.preY - my);\n            }\n            const bearing = map.getBearing() + db;\n            this._db = this._db || 0;\n            this._db += db;\n\n            map.setBearing(bearing);\n        }\n        if (this._rotateMode.indexOf('pitch') >= 0 && map.options['dragPitch']) {\n            map.setPitch(map.getPitch() + (this.preY - my) * 0.4);\n        }\n        this.preX = mx;\n        this.preY = my;\n        if (map.getBearing() !== preBearing || map.getPitch() !== prePitch) {\n            map.onDragRotating(param);\n        }\n    }\n\n    _rotateEnd(param) {\n        const map = this.target;\n        const bearing = map.getBearing();\n        this._clear();\n        const t = now() - this.startDragTime;\n        map.onDragRotateEnd(param);\n        if (Math.abs(bearing - this.startBearing) > 20 && (this._rotateMode === 'rotate' || this._rotateMode === 'rotate_pitch') && !param.interupted && t < 400) {\n            const bearing = map.getBearing();\n            map.animateTo({\n                'bearing' : bearing + this._db / 2\n            }, {\n                'easing'  : 'out',\n                'duration' : 800\n            });\n        }\n    }\n\n    _clear() {\n        delete this.startPrjCoord;\n        delete this.preX;\n        delete this.preY;\n        delete this.startX;\n        delete this.startY;\n    }\n}\n\nMap.mergeOptions({\n    'draggable': true,\n    'dragPan' : true,\n    'dragRotatePitch' : true,\n    'dragRotate' : true,\n    'dragPitch' : true\n});\n\nMap.addOnLoadHook('addHandler', 'draggable', MapDragHandler);\n\nexport default MapDragHandler;\n","import Point from '../../geo/Point';\n\n\nexport function clipLine(points, bounds, round, noCut) {\n    const parts = [];\n    let k = 0, segment;\n    for (let j = 0, l = points.length; j < l - 1; j++) {\n        segment = clipSegment(points[j], points[j + 1], bounds, j, round, noCut);\n\n        if (!segment) { continue; }\n\n        parts[k] = parts[k] || [];\n        parts[k].push({\n            'point' : segment[0],\n            'index' : j\n        });\n\n        // if segment goes out of screen, or it's the last one, it's the end of the line part\n        if ((segment[1] !== points[j + 1]) || (j === l - 2)) {\n            // parts[k].push(segment[1]);\n            parts[k].push({\n                'point' : segment[1],\n                'index' : j + 1\n            });\n            k++;\n        }\n    }\n    return parts;\n}\n\nlet _lastCode;\n\n// @function clipSegment(a: Point, b: Point, bounds: Bounds, useLastCode?: Boolean, round?: Boolean): Point[]|Boolean\n// Clips the segment a to b by rectangular bounds with the\n// [Cohen-Sutherland algorithm](https://en.wikipedia.org/wiki/Cohen%E2%80%93Sutherland_algorithm)\n// (modifying the segment points directly!). Used by Leaflet to only show polyline\n// points that are on the screen or near, increasing performance.\n// @copyright Leaflet\nexport function clipSegment(a, b, bounds, useLastCode, round, noCut) {\n    let codeA = useLastCode ? _lastCode : _getBitCode(a, bounds),\n        codeB = _getBitCode(b, bounds),\n\n        codeOut, p, newCode;\n\n    // save 2nd code to avoid calculating it on the next segment\n    _lastCode = codeB;\n\n    while (true) {\n        // if a,b is inside the clip window (trivial accept)\n        if (!(codeA | codeB)) {\n            return [a, b];\n        }\n\n        // if a,b is outside the clip window (trivial reject)\n        if (codeA & codeB) {\n            return false;\n        }\n\n        if (noCut) {\n            return [a, b];\n        }\n        // other cases\n        codeOut = codeA || codeB;\n        p = _getEdgeIntersection(a, b, codeOut, bounds, round);\n        newCode = _getBitCode(p, bounds);\n\n        if (codeOut === codeA) {\n            a = p;\n            codeA = newCode;\n        } else {\n            b = p;\n            codeB = newCode;\n        }\n    }\n}\n\n/* @function clipPolygon(points: Point[], bounds: Bounds, round?: Boolean): Point[]\n * Clips the polygon geometry defined by the given `points` by the given bounds (using the [Sutherland-Hodgeman algorithm](https://en.wikipedia.org/wiki/Sutherland%E2%80%93Hodgman_algorithm)).\n * Used by Leaflet to only show polygon points that are on the screen or near, increasing\n * performance. Note that polygon points needs different algorithm for clipping\n * than polyline, so there's a seperate method for it.\n * @copyright Leaflet\n */\nexport function clipPolygon(points, bounds, round) {\n    const edges = [1, 4, 2, 8];\n    let clippedPoints,\n        i, j, k,\n        a, b,\n        len, edge, p;\n\n    for (i = 0, len = points.length; i < len; i++) {\n        points[i]._code = _getBitCode(points[i], bounds);\n    }\n\n    // for each edge (left, bottom, right, top)\n    for (k = 0; k < 4; k++) {\n        edge = edges[k];\n        clippedPoints = [];\n\n        for (i = 0, len = points.length, j = len - 1; i < len; j = i++) {\n            a = points[i];\n            b = points[j];\n\n            // if a is inside the clip window\n            if (!(a._code & edge)) {\n                // if b is outside the clip window (a->b goes out of screen)\n                if (b._code & edge) {\n                    p = _getEdgeIntersection(b, a, edge, bounds, round);\n                    p._code = _getBitCode(p, bounds);\n                    clippedPoints.push(p);\n                }\n                clippedPoints.push(a);\n\n            // else if b is inside the clip window (a->b enters the screen)\n            } else if (!(b._code & edge)) {\n                p = _getEdgeIntersection(b, a, edge, bounds, round);\n                p._code = _getBitCode(p, bounds);\n                clippedPoints.push(p);\n            }\n        }\n        points = clippedPoints;\n    }\n\n    return points;\n}\n\n/**\n * caculate the distance from a point to a segment.\n * @param {Point} p\n * @param {Point} p1\n * @param {Point} p2\n * @return {Number} distance from p to (p1, p2)\n * @memberOf Util\n */\nexport function distanceToSegment(p, p1, p2) {\n    const x = p.x,\n        y = p.y,\n        x1 = p1.x,\n        y1 = p1.y,\n        x2 = p2.x,\n        y2 = p2.y;\n\n    const cross = (x2 - x1) * (x - x1) + (y2 - y1) * (y - y1);\n    if (cross <= 0) {\n        // P->P1\n        return Math.sqrt((x - x1) * (x - x1) + (y - y1) * (y - y1));\n    }\n    const d2 = (x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1);\n    if (cross >= d2) {\n        // P->P2\n        return Math.sqrt((x - x2) * (x - x2) + (y - y2) * (y - y2));\n    }\n    const r = cross / d2;\n    const px = x1 + (x2 - x1) * r;\n    const py = y1 + (y2 - y1) * r;\n    // P->P(px,py)\n    return Math.sqrt((x - px) * (x - px) + (y - py) * (y - py));\n}\n\n/**\n * Whether the coordinate is inside the polygon\n * @param {Polygon}         - polygon\n * @param {Coordinate}      - coordinate\n * @return {Boolean}\n * @memberOf Util\n */\nexport function pointInsidePolygon(p, points) {\n    let p1, p2;\n    const len = points.length;\n    let c = false;\n\n    for (let i = 0, j = len - 1; i < len; j = i++) {\n        p1 = points[i];\n        p2 = points[j];\n        if (((p1.y > p.y) !== (p2.y > p.y)) &&\n            (p.x < (p2.x - p1.x) * (p.y - p1.y) / (p2.y - p1.y) + p1.x)) {\n            c = !c;\n        }\n    }\n\n    return c;\n}\n\nfunction _getEdgeIntersection(a, b, code, bounds, round) {\n    const dx = b.x - a.x,\n        dy = b.y - a.y,\n        min = bounds.getMin(),\n        max = bounds.getMax();\n    let x, y;\n\n    if (code & 8) { // top\n        x = a.x + dx * (max.y - a.y) / dy;\n        y = max.y;\n\n    } else if (code & 4) { // bottom\n        x = a.x + dx * (min.y - a.y) / dy;\n        y = min.y;\n\n    } else if (code & 2) { // right\n        x = max.x;\n        y = a.y + dy * (max.x - a.x) / dx;\n\n    } else if (code & 1) { // left\n        x = min.x;\n        y = a.y + dy * (min.x - a.x) / dx;\n    }\n\n    const p = new Point(x, y);\n    if (round) {\n        p._round();\n    }\n    return p;\n}\n\nfunction _getBitCode(p, bounds) {\n    let code = 0;\n\n    if (p.x < bounds.getMin().x) { // left\n        code |= 1;\n    } else if (p.x > bounds.getMax().x) { // right\n        code |= 2;\n    }\n\n    if (p.y < bounds.getMin().y) { // bottom\n        code |= 4;\n    } else if (p.y > bounds.getMax().y) { // top\n        code |= 8;\n    }\n\n    return code;\n}\n\n/**\n * Is the point within an ellipse\n * @param {Point} point\n * @param {Point} center ellipse's center\n * @param {Point} southeast ellipse's southeast point\n * @param {Number} tolerance\n * @returns {Boolean}\n * @private\n * @memberOf Util\n */\nexport function withInEllipse(point, center, southeast, tolerance) {\n    point = new Point(point);\n    const a = Math.abs(southeast.x - center.x),\n        b = Math.abs(southeast.y - center.y),\n        c = Math.sqrt(Math.abs(a * a - b * b)),\n        xfocus = a >= b;\n    let f1, f2, d;\n    if (xfocus) {\n        f1 = new Point(center.x - c, center.y);\n        f2 = new Point(center.x + c, center.y);\n        d = a * 2;\n    } else {\n        f1 = new Point(center.x, center.y - c);\n        f2 = new Point(center.x, center.y + c);\n        d = b * 2;\n    }\n    /*\n    L1 + L2 = D\n    L1 + t >= L1'\n    L2 + t >= L2'\n    D + 2t >= L1' + L2'\n    */\n    return (point.distanceTo(f1) + point.distanceTo(f2)) <= (d + 2 * tolerance);\n}\n","import { COLOR_PROPERTIES } from '../../../core/Constants';\nimport { isString } from '../../../core/util';\n\n/**\n * @classdesc\n * Base class for all the symbolilzers\n * @class\n * @extends Class\n * @abstract\n * @private\n */\nclass Symbolizer {\n    getMap() {\n        return this.geometry.getMap();\n    }\n\n    getPainter() {\n        return this.painter;\n    }\n\n    /**\n     * Test if the property is a property related with coloring\n     * @param {String} prop - property name to test\n     * @static\n     * @function\n     * @return {Boolean}\n     * @memberof symbolizer.Symbolizer\n     */\n    static testColor(prop) {\n        if (!prop || !isString(prop)) {\n            return false;\n        }\n        if (COLOR_PROPERTIES.indexOf(prop) >= 0) {\n            return true;\n        }\n        return false;\n    }\n}\n\nexport default Symbolizer;\n","import { isNumber, extend } from '../../../core/util';\nimport { loadFunctionTypes } from '../../../core/mapbox';\nimport Symbolizer from './Symbolizer';\nimport Canvas from '../../../core/Canvas';\n\n/**\n * @classdesc\n * Base symbolizer class for all the symbolizers base on HTML5 Canvas2D\n * @abstract\n * @class\n * @private\n * @memberOf symbolizer\n * @name CanvasSymbolizer\n * @extends {Symbolizer}\n */\nclass CanvasSymbolizer extends Symbolizer {\n    _prepareContext(ctx) {\n        if (isNumber(this.symbol['opacity'])) {\n            if (ctx.globalAlpha !== this.symbol['opacity']) {\n                ctx.globalAlpha = this.symbol['opacity'];\n            }\n        } else if (ctx.globalAlpha !== 1) {\n            ctx.globalAlpha = 1;\n        }\n    }\n\n    prepareCanvas(ctx, style, resources) {\n        Canvas.prepareCanvas(ctx, style, resources, this.getPainter().isHitTesting());\n    }\n\n    remove() {}\n\n    setZIndex() {}\n\n    show() {}\n\n    hide() {}\n\n    _defineStyle(style) {\n        return function () {\n            const arr = [],\n                prop = {};\n            return loadFunctionTypes(style, () => {\n                const map = this.getMap();\n                return set(arr, map.getZoom(),\n                    extend({},\n                        this.geometry.getProperties(),\n                        setProp(prop, map.getBearing(), map.getPitch(), map.getZoom())\n                    )\n                );\n            });\n        }.bind(this)();\n    }\n}\n\nfunction set(arr, a0, a1) {\n    arr[0] = a0;\n    arr[1] = a1;\n    return arr;\n}\n\nfunction setProp(prop, b, p, z) {\n    prop['{bearing}'] = b;\n    prop['{pitch}'] = p;\n    prop['{zoom}'] = z;\n    return prop;\n}\n\nexport default CanvasSymbolizer;\n","import { computeDegree } from '../../../core/util';\nimport PointExtent from '../../../geo/PointExtent';\nimport Point from '../../../geo/Point';\nimport CanvasSymbolizer from './CanvasSymbolizer';\n\nconst TEMP_POINT0 = new Point(0, 0);\nconst TEMP_POINT1 = new Point(0, 0);\n\n/**\n * @classdesc\n * Base symbolizer class for all the point type symbol styles.\n * @abstract\n * @class\n * @private\n * @memberOf symbolizer\n * @name PointSymbolizer\n * @extends {symbolizer.CanvasSymbolizer}\n */\nclass PointSymbolizer extends CanvasSymbolizer {\n\n    constructor(symbol, geometry, painter) {\n        super();\n        this.symbol = symbol;\n        this.geometry = geometry;\n        this.painter = painter;\n    }\n\n    get2DExtent() {\n        const map = this.getMap();\n        const glZoom = map.getGLZoom();\n        const extent = new PointExtent();\n        const renderPoints = this._getRenderPoints()[0];\n        for (let i = renderPoints.length - 1; i >= 0; i--) {\n            if (renderPoints[i]) {\n                extent._combine(map._pointToPoint(renderPoints[i], glZoom));\n            }\n        }\n        return extent;\n    }\n\n    _rotateExtent(fixedExtent, angle) {\n        return fixedExtent.convertTo(p => p._rotate(angle));\n    }\n\n    _getRenderPoints() {\n        const painter = this.getPainter();\n        const placement = painter.isSpriting() ? 'center' : this.getPlacement();\n        return this.getPainter().getRenderPoints(placement);\n    }\n\n    /**\n     * Get container points to draw on Canvas\n     * @return {Point[]}\n     */\n    _getRenderContainerPoints(ignoreAltitude) {\n        const painter = this.getPainter(),\n            points = this._getRenderPoints()[0];\n        if (painter.isSpriting()) {\n            return points;\n        }\n        const dxdy = this.getDxDy();\n        const cpoints = this.painter._pointContainerPoints(points, dxdy.x, dxdy.y, ignoreAltitude, true, this.getPlacement());\n        if (!cpoints || !Array.isArray(cpoints[0])) {\n            return cpoints;\n        }\n        const flat = [];\n        for (let i = 0, l = cpoints.length; i < l; i++) {\n            for (let ii = 0, ll = cpoints[i].length; ii < ll; ii++) {\n                flat.push(cpoints[i][ii]);\n            }\n        }\n        return flat;\n    }\n\n    _getRotationAt(i) {\n        let r = this.getRotation();\n        if (!r) {\n            r = 0;\n        }\n        const rotations = this._getRenderPoints()[1];\n        if (!rotations || !rotations[i]) {\n            return r;\n        }\n\n        const map = this.getMap();\n        let p0 = rotations[i][0], p1 = rotations[i][1];\n        if (map.isTransforming()) {\n            const maxZoom = map.getGLZoom();\n            p0 = map._pointToContainerPoint(rotations[i][0], maxZoom, 0, TEMP_POINT0);\n            p1 = map._pointToContainerPoint(rotations[i][1], maxZoom, 0, TEMP_POINT1);\n        }\n        return r + computeDegree(p0.x, p0.y, p1.x, p1.y);\n    }\n\n    _rotate(ctx, origin, rotation) {\n        if (rotation) {\n            const dxdy = this.getDxDy();\n            const p = origin.sub(dxdy);\n            ctx.save();\n            ctx.translate(p.x, p.y);\n            ctx.rotate(rotation);\n            return this.getDxDy();\n        }\n        return null;\n    }\n}\n\nexport default PointSymbolizer;\n","import { isNil, isNumber, isArrayHasData, getValueOrDefault, sign } from '../../../core/util';\nimport { isGradient, getGradientStamp } from '../../../core/util/style';\nimport { getAlignPoint } from '../../../core/util/strings';\nimport { hasFunctionDefinition } from '../../../core/mapbox';\nimport Size from '../../../geo/Size';\nimport Point from '../../../geo/Point';\nimport PointExtent from '../../../geo/PointExtent';\nimport Canvas from '../../../core/Canvas';\nimport PointSymbolizer from './PointSymbolizer';\n\nexport default class VectorMarkerSymbolizer extends PointSymbolizer {\n\n    static test(symbol) {\n        if (!symbol) {\n            return false;\n        }\n        if (isNil(symbol['markerFile']) && !isNil(symbol['markerType']) && (symbol['markerType'] !== 'path')) {\n            return true;\n        }\n        return false;\n    }\n\n    constructor(symbol, geometry, painter) {\n        super(symbol, geometry, painter);\n        this._dynamic = hasFunctionDefinition(symbol);\n        this.style = this._defineStyle(this.translate());\n        this.strokeAndFill = this._defineStyle(VectorMarkerSymbolizer.translateLineAndFill(this.style));\n        const lineWidth = this.strokeAndFill['lineWidth'];\n        if (lineWidth % 2 === 0) {\n            this.padding = 2;\n        } else {\n            this.padding = 1.5;\n        }\n    }\n\n    symbolize(ctx, resources) {\n        const style = this.style;\n        if (!this.painter.isHitTesting() && (style['markerWidth'] === 0 || style['markerHeight'] === 0 ||\n            (style['polygonOpacity'] === 0 && style['lineOpacity'] === 0))) {\n            return;\n        }\n        const cookedPoints = this._getRenderContainerPoints();\n        if (!isArrayHasData(cookedPoints)) {\n            return;\n        }\n        this._prepareContext(ctx);\n        if (this.getPainter().isSpriting() ||\n            this.geometry.getLayer().getMask() === this.geometry ||\n            this._dynamic ||\n            this.geometry.getLayer().options['cacheVectorOnCanvas'] === false) {\n            this._drawMarkers(ctx, cookedPoints, resources);\n        } else {\n            this._drawMarkersWithCache(ctx, cookedPoints, resources);\n        }\n\n    }\n\n    getDxDy() {\n        const s = this.style;\n        const dx = s['markerDx'],\n            dy = s['markerDy'];\n        return new Point(dx, dy);\n    }\n\n    _drawMarkers(ctx, cookedPoints, resources) {\n        const strokeAndFill = this.strokeAndFill;\n        const gradient = isGradient(strokeAndFill['lineColor']) || isGradient(strokeAndFill['polygonFill']);\n        if (!gradient) {\n            this.prepareCanvas(ctx, strokeAndFill, resources);\n        }\n        for (let i = cookedPoints.length - 1; i >= 0; i--) {\n            let point = cookedPoints[i];\n            const origin = this._rotate(ctx, point, this._getRotationAt(i));\n            if (origin) {\n                point = origin;\n            }\n\n            this._drawVectorMarker(ctx, point, resources);\n            if (origin) {\n                ctx.restore();\n            }\n        }\n    }\n\n    _drawMarkersWithCache(ctx, cookedPoints, resources) {\n        const stamp = this._stampSymbol();\n        let image = resources.getImage(stamp);\n        if (!image) {\n            image = this._createMarkerImage(ctx, resources);\n            resources.addResource([stamp, image.width, image.height], image);\n        }\n        const anchor = this._getAnchor(image.width, image.height);\n        for (let i = cookedPoints.length - 1; i >= 0; i--) {\n            let point = cookedPoints[i];\n            const origin = this._rotate(ctx, point, this._getRotationAt(i));\n            if (origin) {\n                point = origin;\n            }\n            Canvas.image(ctx, image, point.x + anchor.x, point.y + anchor.y);\n            if (origin) {\n                ctx.restore();\n            }\n        }\n    }\n\n    _calMarkerSize() {\n        if (!this._size) {\n            const lineWidth = this.strokeAndFill['lineWidth'],\n                shadow = 2 * (this.symbol['shadowBlur'] || 0), // add some tolerance for shadowOffsetX/Y\n                w = Math.round(this.style['markerWidth'] + lineWidth + 2 * shadow + this.padding * 2),\n                h = Math.round(this.style['markerHeight'] + lineWidth + 2 * shadow + this.padding * 2);\n            this._size = [w, h];\n        }\n        return this._size;\n    }\n\n    _createMarkerImage(ctx, resources) {\n        const canvasClass = ctx.canvas.constructor,\n            size = this._calMarkerSize(),\n            canvas = Canvas.createCanvas(size[0], size[1], canvasClass),\n            point = this._getCacheImageAnchor(size[0], size[1]);\n        const context = canvas.getContext('2d');\n        const gradient = isGradient(this.strokeAndFill['lineColor']) || isGradient(this.strokeAndFill['polygonFill']);\n        if (!gradient) {\n            this.prepareCanvas(context, this.strokeAndFill, resources);\n        }\n        this._drawVectorMarker(context, point, resources);\n        return canvas;\n    }\n\n    _stampSymbol() {\n        if (!this._stamp) {\n            this._stamp = [\n                this.style['markerType'],\n                isGradient(this.style['markerFill']) ? getGradientStamp(this.style['markerFill']) : this.style['markerFill'],\n                this.style['markerFillOpacity'],\n                this.style['markerFillPatternFile'],\n                isGradient(this.style['markerLineColor']) ? getGradientStamp(this.style['markerLineColor']) : this.style['markerLineColor'],\n                this.style['markerLineWidth'],\n                this.style['markerLineOpacity'],\n                this.style['markerLineDasharray'] ? this.style['markerLineDasharray'].join(',') : '',\n                this.style['markerLinePatternFile'],\n                this.style['markerWidth'],\n                this.style['markerHeight'],\n                this.style['markerHorizontalAlignment'],\n                this.style['markerVerticalAlignment']\n            ].join('_');\n        }\n        return this._stamp;\n    }\n\n    _getAnchor(w, h) {\n        const shadow = 2 * (this.symbol['shadowBlur'] || 0),\n            margin = shadow + this.padding;\n        const p = getAlignPoint(new Size(w, h), this.style['markerHorizontalAlignment'], this.style['markerVerticalAlignment']);\n        if (p.x !== -w  / 2) {\n            p.x -= sign(p.x + w / 2) * margin;\n        }\n        if (p.y !== -h / 2) {\n            p.y -= sign(p.y + h / 2) * margin;\n        }\n        return p;\n    }\n\n    _getCacheImageAnchor(w, h) {\n        const shadow = 2 * (this.symbol['shadowBlur'] || 0),\n            margin = shadow + this.padding;\n        const markerType = this.style['markerType'];\n        if (markerType === 'bar' || markerType === 'pie' || markerType === 'pin') {\n            return new Point(w / 2, h - margin);\n        } else if (markerType === 'rectangle') {\n            return new Point(margin, margin);\n        } else {\n            return new Point(w / 2, h / 2);\n        }\n    }\n\n    _getGraidentExtent(points) {\n        const e = new PointExtent(),\n            dxdy = this.getDxDy(),\n            m = this.getFixedExtent();\n        if (Array.isArray(points)) {\n            for (let i = points.length - 1; i >= 0; i--) {\n                e._combine(points[i]);\n            }\n        } else {\n            e._combine(points);\n        }\n        e['xmin'] += m['xmin'] - dxdy.x;\n        e['ymin'] += m['ymin'] - dxdy.y;\n        e['xmax'] += m['xmax'] - dxdy.x;\n        e['ymax'] += m['ymax'] - dxdy.y;\n        return e;\n    }\n\n    _drawVectorMarker(ctx, point, resources) {\n        const style = this.style,\n            strokeAndFill = this.strokeAndFill,\n            markerType = style['markerType'].toLowerCase(),\n            vectorArray = VectorMarkerSymbolizer._getVectorPoints(markerType, style['markerWidth'], style['markerHeight']),\n            lineOpacity = strokeAndFill['lineOpacity'],\n            fillOpacity = strokeAndFill['polygonOpacity'];\n        const gradient = isGradient(strokeAndFill['lineColor']) || isGradient(strokeAndFill['polygonFill']);\n        if (gradient) {\n            let gradientExtent;\n            if (isGradient(strokeAndFill['lineColor'])) {\n                gradientExtent = this._getGraidentExtent(point);\n                strokeAndFill['lineGradientExtent'] = gradientExtent.expand(strokeAndFill['lineWidth']);\n            }\n            if (isGradient(strokeAndFill['polygonFill'])) {\n                if (!gradientExtent) {\n                    gradientExtent = this._getGraidentExtent(point);\n                }\n                strokeAndFill['polygonGradientExtent'] = gradientExtent;\n            }\n            this.prepareCanvas(ctx, strokeAndFill, resources);\n        }\n\n\n        const width = style['markerWidth'],\n            height = style['markerHeight'],\n            hLineWidth = style['markerLineWidth'] / 2;\n        if (markerType === 'ellipse') {\n            //ellipse default\n            Canvas.ellipse(ctx, point, width / 2, height / 2, lineOpacity, fillOpacity);\n        } else if (markerType === 'cross' || markerType === 'x') {\n            for (let j = vectorArray.length - 1; j >= 0; j--) {\n                vectorArray[j]._add(point);\n            }\n            //线类型\n            Canvas.path(ctx, vectorArray.slice(0, 2), lineOpacity);\n            Canvas.path(ctx, vectorArray.slice(2, 4), lineOpacity);\n        } else if (markerType === 'diamond' || markerType === 'bar' || markerType === 'square' || markerType === 'rectangle' || markerType === 'triangle') {\n            if (markerType === 'bar') {\n                point = point.add(0, -hLineWidth);\n            } else if (markerType === 'rectangle') {\n                point = point.add(hLineWidth, hLineWidth);\n            }\n            for (let j = vectorArray.length - 1; j >= 0; j--) {\n                vectorArray[j]._add(point);\n            }\n            //面类型\n            Canvas.polygon(ctx, vectorArray, lineOpacity, fillOpacity);\n        } else if (markerType === 'pin') {\n            point = point.add(0, -hLineWidth);\n            for (let j = vectorArray.length - 1; j >= 0; j--) {\n                vectorArray[j]._add(point);\n            }\n            const lineCap = ctx.lineCap;\n            ctx.lineCap = 'round'; //set line cap to round to close the pin bottom\n            Canvas.bezierCurveAndFill(ctx, vectorArray, lineOpacity, fillOpacity);\n            ctx.lineCap = lineCap;\n        } else if (markerType === 'pie') {\n            point = point.add(0, hLineWidth);\n            const angle = Math.atan(width / 2 / height) * 180 / Math.PI;\n            const lineCap = ctx.lineCap;\n            ctx.lineCap = 'round';\n            Canvas.sector(ctx, point, height, [90 - angle, 90 + angle], lineOpacity, fillOpacity);\n            ctx.lineCap = lineCap;\n        } else {\n            throw new Error('unsupported markerType: ' + markerType);\n        }\n    }\n\n    getPlacement() {\n        return this.symbol['markerPlacement'];\n    }\n\n    getRotation() {\n        const r = this.style['markerRotation'];\n        if (!isNumber(r)) {\n            return null;\n        }\n        //to radian\n        return -r * Math.PI / 180;\n    }\n\n    getFixedExtent() {\n        const dxdy = this.getDxDy(),\n            padding = this.padding * 2;\n        const size = this._calMarkerSize().map(d => d - padding);\n        const alignPoint = this._getAnchor(size[0], size[1]);\n        let result = new PointExtent(dxdy.add(0, 0), dxdy.add(size[0], size[1]));\n        result._add(alignPoint);\n        const rotation = this.getRotation();\n        if (rotation) {\n            result = this._rotateExtent(result, rotation);\n        }\n\n        return result;\n    }\n\n    translate() {\n        const s = this.symbol;\n        const result = {\n            'markerType': getValueOrDefault(s['markerType'], 'ellipse'), //<----- ellipse | cross | x | triangle | diamond | square | bar | pin等,默认ellipse\n            'markerFill': getValueOrDefault(s['markerFill'], '#00f'), //blue as cartoCSS\n            'markerFillOpacity': getValueOrDefault(s['markerFillOpacity'], 1),\n            'markerFillPatternFile': getValueOrDefault(s['markerFillPatternFile'], null),\n            'markerLineColor': getValueOrDefault(s['markerLineColor'], '#000'), //black\n            'markerLineWidth': getValueOrDefault(s['markerLineWidth'], 1),\n            'markerLineOpacity': getValueOrDefault(s['markerLineOpacity'], 1),\n            'markerLineDasharray': getValueOrDefault(s['markerLineDasharray'], []),\n            'markerLinePatternFile': getValueOrDefault(s['markerLinePatternFile'], null),\n\n            'markerDx': getValueOrDefault(s['markerDx'], 0),\n            'markerDy': getValueOrDefault(s['markerDy'], 0),\n\n            'markerWidth': getValueOrDefault(s['markerWidth'], 10),\n            'markerHeight': getValueOrDefault(s['markerHeight'], 10),\n\n            'markerRotation' : getValueOrDefault(s['markerRotation'], 0)\n        };\n        const markerType = result['markerType'];\n        let ha, va;\n        if (markerType === 'bar' || markerType === 'pie' || markerType === 'pin') {\n            ha = 'middle';\n            va = 'top';\n        } else if (markerType === 'rectangle') {\n            ha = 'right';\n            va = 'bottom';\n        } else {\n            ha = 'middle';\n            va = 'middle';\n        }\n\n        result['markerHorizontalAlignment'] = getValueOrDefault(s['markerHorizontalAlignment'], ha); //left | middle | right\n        result['markerVerticalAlignment'] = getValueOrDefault(s['markerVerticalAlignment'], va); // top | middle | bottom\n\n        //markerOpacity覆盖fillOpacity和lineOpacity\n        if (isNumber(s['markerOpacity'])) {\n            if (isNumber(s['markerFillOpacity'])) {\n                result['markerFillOpacity'] *= s['markerOpacity'];\n            }\n            if (isNumber(s['markerLineOpacity'])) {\n                result['markerLineOpacity'] *= s['markerOpacity'];\n            }\n        }\n        return result;\n    }\n\n    static translateLineAndFill(s) {\n        const result = {\n            'lineColor': s['markerLineColor'],\n            'linePatternFile': s['markerLinePatternFile'],\n            'lineWidth': s['markerLineWidth'],\n            'lineOpacity': s['markerLineOpacity'],\n            'lineDasharray': s['markerLineDasharray'],\n            'lineCap': 'butt',\n            'lineJoin': 'round',\n            'polygonFill': s['markerFill'],\n            'polygonPatternFile': s['markerFillPatternFile'],\n            'polygonOpacity': s['markerFillOpacity']\n        };\n        if (result['lineWidth'] === 0) {\n            result['lineOpacity'] = 0;\n        }\n        return result;\n    }\n\n    static _getVectorPoints(markerType, width, height) {\n        //half height and half width\n        const hh = height / 2,\n            hw = width / 2;\n        const left = 0,\n            top = 0;\n        let v0, v1, v2, v3;\n        if (markerType === 'triangle') {\n            v0 = new Point(left, top - hh);\n            v1 = new Point(left - hw, top + hh);\n            v2 = new Point(left + hw, top + hh);\n            return [v0, v1, v2];\n        } else if (markerType === 'cross') {\n            v0 = new Point((left - hw), top);\n            v1 = new Point((left + hw), top);\n            v2 = new Point((left), (top - hh));\n            v3 = new Point((left), (top + hh));\n            return [v0, v1, v2, v3];\n        } else if (markerType === 'diamond') {\n            v0 = new Point((left - hw), top);\n            v1 = new Point(left, (top - hh));\n            v2 = new Point((left + hw), top);\n            v3 = new Point((left), (top + hh));\n            return [v0, v1, v2, v3];\n        } else if (markerType === 'square') {\n            v0 = new Point((left - hw), (top + hh));\n            v1 = new Point((left + hw), (top + hh));\n            v2 = new Point((left + hw), (top - hh));\n            v3 = new Point((left - hw), (top - hh));\n            return [v0, v1, v2, v3];\n        } else if (markerType === 'rectangle') {\n            v0 = new Point(left, top);\n            v1 = v0.add(width, 0);\n            v2 = v0.add(width, height);\n            v3 = v0.add(0, height);\n            return [v0, v1, v2, v3];\n        } else if (markerType === 'x') {\n            v0 = new Point(left - hw, top + hh);\n            v1 = new Point(left + hw, top - hh);\n            v2 = new Point(left + hw, top + hh);\n            v3 = new Point(left - hw, top - hh);\n            return [v0, v1, v2, v3];\n        } else if (markerType === 'bar') {\n            v0 = new Point((left - hw), (top - height));\n            v1 = new Point((left + hw), (top - height));\n            v2 = new Point((left + hw), top);\n            v3 = new Point((left - hw), top);\n            return [v0, v1, v2, v3];\n        } else if (markerType === 'pin') {\n            const extWidth = height * Math.atan(hw / hh);\n            v0 = new Point(left, top);\n            v1 = new Point(left - extWidth, top - height);\n            v2 = new Point(left + extWidth, top - height);\n            v3 = new Point(left, top);\n            return [v0, v1, v2, v3];\n        }\n        return [];\n    }\n}\n\n\n","import {\n    isNil\n} from '../../../core/util';\nimport Point from '../../../geo/Point';\nimport Canvas from '../../../core/Canvas';\nimport PointSymbolizer from './PointSymbolizer';\nimport VectorMarkerSymbolizer from './VectorMarkerSymbolizer';\n\nexport default class DebugSymbolizer extends PointSymbolizer {\n\n    getPlacement() {\n        return 'point';\n    }\n\n    getDxDy() {\n        return new Point(0, 0);\n    }\n\n    symbolize(ctx) {\n        const geometry = this.geometry,\n            layer = geometry.getLayer();\n        if (!geometry.options['debug'] && (layer && !layer.options['debug'])) {\n            return;\n        }\n        const map = this.getMap();\n        if (!map || map.isZooming()) {\n            return;\n        }\n        const color = layer.options['debugOutline'],\n            op = 1;\n        ctx.strokeStyle = color;\n        ctx.fillStyle = color;\n\n        //outline\n        const outline = this.getPainter().getContainerExtent().toArray();\n        Canvas.polygon(ctx, [outline], op, 0);\n\n        //center cross and id if have any.\n        const points = this._getRenderContainerPoints(),\n            id = this.geometry.getId(),\n            cross = VectorMarkerSymbolizer._getVectorPoints('cross', 10, 10);\n        for (let i = 0; i < points.length; i++) {\n            const p = points[i];\n            if (!isNil(id)) {\n                Canvas.fillText(ctx, id, p.x + 8, p.y - 4, color);\n            }\n            const c = [];\n            for (let ii = 0; ii < cross.length; ii++) {\n                c.push(cross[ii].add(p));\n            }\n            Canvas.path(ctx, c.slice(0, 2), op);\n            Canvas.path(ctx, c.slice(2, 4), op);\n        }\n    }\n\n}\n","import { isNil, isNumber, isArrayHasData, getValueOrDefault, isString } from '../../../core/util';\nimport { getAlignPoint } from '../../../core/util/strings';\nimport { colorNames } from '../../../core/Constants';\nimport Size from '../../../geo/Size';\nimport Point from '../../../geo/Point';\nimport PointExtent from '../../../geo/PointExtent';\nimport Canvas from '../../../core/Canvas';\nimport PointSymbolizer from './PointSymbolizer';\n\nconst keyword = /(\\D+)/;\nconst hex = /^#([a-f0-9]{6})([a-f0-9]{2})?$/i;\n// eslint-disable-next-line no-useless-escape\nconst rgba = /^rgba?\\(\\s*([+-]?\\d+)\\s*,\\s*([+-]?\\d+)\\s*,\\s*([+-]?\\d+)\\s*(?:,\\s*([+-]?[\\d\\.]+)\\s*)?\\)$/;\n\nfunction getColor(string) {\n    let rgb = [];\n\n    if (string.match(hex)) {\n        let match = string.match(hex);\n        const hexAlpha = match[2];\n        match = match[1];\n\n        for (let i = 0; i < 3; i++) {\n            // https://jsperf.com/slice-vs-substr-vs-substring-methods-long-string/19\n            const i2 = i * 2;\n            rgb[i] = parseInt(match.slice(i2, i2 + 2), 16);\n        }\n\n        if (hexAlpha) {\n            rgb[3] = Math.round((parseInt(hexAlpha, 16) / 255) * 100) / 100;\n        }\n    } else if (string.match(rgba)) {\n        const match = string.match(rgba);\n        for (let i = 0; i < 3; i++) {\n            rgb[i] = parseInt(match[i + 1], 0);\n        }\n\n        if (match[4]) {\n            rgb[3] = parseFloat(match[4]);\n        }\n    } else if (string.match(keyword)) {\n        const match = string.match(keyword);\n        if (match[1] === 'transparent') {\n            return [0, 0, 0, 0];\n        }\n        rgb = colorNames[match[1]];\n        if (!rgb) {\n            return null;\n        }\n        rgb[3] = 1;\n        return rgb;\n    } else {\n        return null;\n    }\n\n    return rgb;\n}\n\nexport default class ImageMarkerSymbolizer extends PointSymbolizer {\n\n    static test(symbol) {\n        if (!symbol) {\n            return false;\n        }\n        if (!isNil(symbol['markerFile'])) {\n            return true;\n        }\n        return false;\n    }\n\n    constructor(symbol, geometry, painter) {\n        super(symbol, geometry, painter);\n        this.style = this._defineStyle(this.translate());\n\n        /**\n         * temp canvas\n         * @type {null}\n         * @private\n         */\n        this._tempCanvas = null;\n\n        /**\n         * 创建临时绘制对象，避免重复调用\n         * @type {null}\n         * @private\n         */\n        this._tempCtx = null;\n    }\n\n    symbolize(ctx, resources) {\n        const style = this.style;\n        if (!this.painter.isHitTesting() && (style['markerWidth'] === 0 || style['markerHeight'] === 0 || style['markerOpacity'] === 0)) {\n            return;\n        }\n        const cookedPoints = this._getRenderContainerPoints();\n        if (!isArrayHasData(cookedPoints)) {\n            return;\n        }\n\n        let img = this._getImage(resources);\n        if (!img) {\n            if (typeof console !== 'undefined') {\n                console.warn('no img found for ' + (this.style['markerFile'] || this._url[0]));\n            }\n            return;\n        }\n\n        if ('markerReplaceColor' in this.style) {\n            const w = img.width;\n            const h = img.height;\n            if (!this._tempCtx) {\n                this._tempCanvas = Canvas.createCanvas(w, h);\n                this._tempCtx = this._tempCanvas.getContext('2d');\n            } else {\n                Canvas.clearRect(this._tempCtx, this._tempCtx.canvas.width, this._tempCtx.canvas.height);\n                this._tempCanvas.width = w;\n                this._tempCanvas.height = h;\n            }\n\n            Canvas.image(this._tempCtx, img,\n                0,\n                0,\n                w, h);\n            this.replaceColor_(this._tempCtx, 0, 0, w, h);\n            this._tempCtx.restore();\n            img = this._tempCanvas;\n        }\n\n        this._prepareContext(ctx);\n        let width = style['markerWidth'];\n        let height = style['markerHeight'];\n        if (!isNumber(width) || !isNumber(height)) {\n            width = img.width;\n            height = img.height;\n            style['markerWidth'] = width;\n            style['markerHeight'] = height;\n            const imgURL = [style['markerFile'], style['markerWidth'], style['markerHeight']];\n            if (!resources.isResourceLoaded(imgURL)) {\n                resources.addResource(imgURL, img);\n            }\n            const painter = this.getPainter();\n            if (!painter.isSpriting()) {\n                painter.removeCache();\n            }\n        }\n        let alpha;\n        // for VectorPathMarkerSymbolizer, opacity is already set into SVG element.\n        if (this.symbol['markerType'] !== 'path' &&\n            isNumber(style['markerOpacity']) && style['markerOpacity'] < 1) {\n            alpha = ctx.globalAlpha;\n            ctx.globalAlpha *= style['markerOpacity'];\n        }\n        const alignPoint = getAlignPoint(new Size(width, height), style['markerHorizontalAlignment'], style['markerVerticalAlignment']);\n        for (let i = 0, len = cookedPoints.length; i < len; i++) {\n            let p = cookedPoints[i];\n            const origin = this._rotate(ctx, p, this._getRotationAt(i));\n            if (origin) {\n                p = origin;\n            }\n            Canvas.image(ctx, img,\n                p.x + alignPoint.x,\n                p.y + alignPoint.y,\n                width, height);\n\n            if (origin) {\n                ctx.restore();\n            }\n        }\n        if (alpha !== undefined) {\n            ctx.globalAlpha = alpha;\n        }\n    }\n\n    _getImage(resources) {\n        const img = !resources ? null : resources.getImage([this.style['markerFile'], this.style['markerWidth'], this.style['markerHeight']]);\n        return img;\n    }\n\n    getPlacement() {\n        return this.symbol['markerPlacement'];\n    }\n\n    getRotation() {\n        const r = this.style['markerRotation'];\n        if (!isNumber(r)) {\n            return null;\n        }\n        //to radian\n        return -r * Math.PI / 180;\n    }\n\n    getDxDy() {\n        const s = this.style;\n        const dx = s['markerDx'],\n            dy = s['markerDy'];\n        return new Point(dx, dy);\n    }\n\n    getFixedExtent(resources) {\n        const style = this.style;\n        const url = style['markerFile'],\n            img = resources ? resources.getImage(url) : null;\n        const width = style['markerWidth'] || (img ? img.width : 0),\n            height = style['markerHeight'] || (img ? img.height : 0);\n        const dxdy = this.getDxDy();\n        const alignPoint = getAlignPoint(new Size(width, height), style['markerHorizontalAlignment'], style['markerVerticalAlignment']);\n        let result = new PointExtent(dxdy.add(0, 0), dxdy.add(width, height));\n        result._add(alignPoint);\n        const rotation = this.getRotation();\n        if (rotation) {\n            result = this._rotateExtent(result, rotation);\n        }\n        return result;\n    }\n\n    translate() {\n        const s = this.symbol;\n        return {\n            'markerReplaceColor': s['markerReplaceColor'],\n            'markerFile': s['markerFile'],\n            'markerOpacity': getValueOrDefault(s['markerOpacity'], 1),\n            'markerWidth': getValueOrDefault(s['markerWidth'], null),\n            'markerHeight': getValueOrDefault(s['markerHeight'], null),\n            'markerRotation' : getValueOrDefault(s['markerRotation'], 0),\n\n            'markerDx': getValueOrDefault(s['markerDx'], 0),\n            'markerDy': getValueOrDefault(s['markerDy'], 0),\n\n            'markerHorizontalAlignment': getValueOrDefault(s['markerHorizontalAlignment'], 'middle'), //left | middle | right\n            'markerVerticalAlignment': getValueOrDefault(s['markerVerticalAlignment'], 'top'), // top | middle | bottom\n        };\n    }\n\n    replaceColor_(ctx) {\n        if (!this.style.markerReplaceColor) {\n            return;\n        }\n        let color = null;\n        if (Array.isArray(color) && color.length > 2) {\n            color = this.style.markerReplaceColor;\n        } else if (isString(this.style.markerReplaceColor)) {\n            color = getColor(this.style.markerReplaceColor);\n        }\n\n        if (!color) {\n            return;\n        }\n\n        const imgData = ctx.getImageData(0, 0, ctx.canvas.width, ctx.canvas.height);\n        const data = imgData.data;\n        const r = color[0] / 255.0;\n        const g = color[1] / 255.0;\n        const b = color[2] / 255.0;\n\n        for (let i = 0, ii = data.length; i < ii; i += 4) {\n            data[i] *= r;\n            data[i + 1] *= g;\n            data[i + 2] *= b;\n        }\n        ctx.putImageData(imgData, 0, 0);\n\n        if (color[3] !== undefined) {\n            ctx.globalAlpha = color[3];\n        }\n    }\n}\n","import { getValueOrDefault } from '../../../core/util';\nimport { isGradient as checkGradient } from '../../../core/util/style';\nimport Coordinate from '../../../geo/Coordinate';\nimport PointExtent from '../../../geo/PointExtent';\nimport CanvasSymbolizer from './CanvasSymbolizer';\n\nconst TEMP_COORD0 = new Coordinate(0, 0);\nconst TEMP_COORD1 = new Coordinate(0, 0);\n\nexport default class StrokeAndFillSymbolizer extends CanvasSymbolizer {\n\n    static test(symbol, geometry) {\n        if (!symbol) {\n            return false;\n        }\n        if (geometry && (geometry.type === 'Point')) {\n            return false;\n        }\n        for (const p in symbol) {\n            const f = p.slice(0, 4);\n            if (f === 'line' || f === 'poly') {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    constructor(symbol, geometry, painter) {\n        super();\n        this.symbol = symbol;\n        this.geometry = geometry;\n        this.painter = painter;\n        if (geometry.type === 'Point') {\n            return;\n        }\n        this.style = this._defineStyle(this.translate());\n    }\n\n    symbolize(ctx, resources) {\n        const style = this.style;\n        if (style['polygonOpacity'] === 0 && style['lineOpacity'] === 0 && !this.painter.isHitTesting()) {\n            return;\n        }\n        const paintParams = this._getPaintParams();\n        if (!paintParams) {\n            return;\n        }\n        this._prepareContext(ctx);\n        const isGradient = checkGradient(style['lineColor']),\n            isPath = (this.geometry.getJSONType() === 'Polygon') || (this.geometry.type === 'LineString');\n        if (isGradient && (style['lineColor']['places'] || !isPath)) {\n            style['lineGradientExtent'] = this.getPainter().getContainerExtent()._expand(style['lineWidth']);\n        }\n        if (checkGradient(style['polygonFill'])) {\n            style['polygonGradientExtent'] = this.getPainter().getContainerExtent();\n        }\n\n        const points = paintParams[0],\n            isSplitted = (this.geometry.getJSONType() === 'Polygon' && points.length > 0 && Array.isArray(points[0][0])) ||\n            (this.geometry.type === 'LineString' && points.length > 0 && Array.isArray(points[0]));\n\n        if (isSplitted) {\n            for (let i = 0; i < points.length; i++) {\n                this.prepareCanvas(ctx, style, resources);\n                if (isGradient && isPath && !style['lineColor']['places']) {\n                    this._createGradient(ctx, points[i], style['lineColor']);\n                }\n                const params = [ctx, points[i]];\n                if (paintParams.length > 1) {\n                    params.push.apply(params, paintParams.slice(1));\n                }\n                params.push(style['lineOpacity'], style['polygonOpacity'], style['lineDasharray']);\n                this.geometry._paintOn.apply(this.geometry, params);\n            }\n        } else {\n            this.prepareCanvas(ctx, style, resources);\n            if (isGradient && isPath && !style['lineColor']['places']) {\n                this._createGradient(ctx, points, style['lineColor']);\n            }\n            const params = [ctx];\n            params.push.apply(params, paintParams);\n            params.push(style['lineOpacity'], style['polygonOpacity'], style['lineDasharray']);\n            this.geometry._paintOn.apply(this.geometry, params);\n        }\n\n        if (ctx.setLineDash && Array.isArray(style['lineDasharray'])) {\n            ctx.setLineDash([]);\n        }\n    }\n\n    get2DExtent() {\n        const map = this.getMap();\n        const extent = this.geometry._getPrjExtent();\n        if (!extent) {\n            return null;\n        }\n        // this ugly implementation is to improve perf as we can\n        // it tries to avoid creating instances to save cpu consumption.\n        if (!this._extMin || !this._extMax) {\n            this._extMin = new Coordinate(0, 0);\n            this._extMax = new Coordinate(0, 0);\n        }\n        this._extMin.x = extent['xmin'];\n        this._extMin.y = extent['ymin'];\n        this._extMax.x = extent['xmax'];\n        this._extMax.y = extent['ymax'];\n        const min = map._prjToPoint(this._extMin, undefined, TEMP_COORD0),\n            max = map._prjToPoint(this._extMax, undefined, TEMP_COORD1);\n        if (!this._pxExtent) {\n            this._pxExtent = new PointExtent(min, max);\n        } else {\n            this._pxExtent.set(\n                Math.min(min.x, max.x),\n                Math.min(min.y, max.y),\n                Math.max(min.x, max.x),\n                Math.max(min.y, max.y)\n            );\n        }\n        return this._pxExtent;\n    }\n\n    getFixedExtent() {\n        const t = this.style['lineWidth'] / 2;\n        return new PointExtent(-t, -t, t, t);\n    }\n\n    _getPaintParams() {\n        return this.getPainter().getPaintParams(this.style['lineDx'], this.style['lineDy']);\n    }\n\n    translate() {\n        const s = this.symbol;\n        const result = {\n            'lineColor': getValueOrDefault(s['lineColor'], '#000'),\n            'lineWidth': getValueOrDefault(s['lineWidth'], 2),\n            'lineOpacity': getValueOrDefault(s['lineOpacity'], 1),\n            'lineDasharray': getValueOrDefault(s['lineDasharray'], []),\n            'lineCap': getValueOrDefault(s['lineCap'], 'butt'), //“butt”, “square”, “round”\n            'lineJoin': getValueOrDefault(s['lineJoin'], 'miter'), //“bevel”, “round”, “miter”\n            'linePatternFile': getValueOrDefault(s['linePatternFile'], null),\n            'lineDx' : getValueOrDefault(s['lineDx'], 0),\n            'lineDy' : getValueOrDefault(s['lineDy'], 0),\n            'polygonFill': getValueOrDefault(s['polygonFill'], null),\n            'polygonOpacity': getValueOrDefault(s['polygonOpacity'], 1),\n            'polygonPatternFile': getValueOrDefault(s['polygonPatternFile'], null),\n            'polygonPatternDx' : getValueOrDefault(s['polygonPatternDx'], 0),\n            'polygonPatternDy' : getValueOrDefault(s['polygonPatternDy'], 0),\n            'linePatternDx' : getValueOrDefault(s['linePatternDx'], 0),\n            'linePatternDy' : getValueOrDefault(s['linePatternDy'], 0)\n        };\n        if (result['lineWidth'] === 0) {\n            result['lineOpacity'] = 0;\n        }\n        // fill of arrow\n        if ((this.geometry.type === 'LineString') && !result['polygonFill']) {\n            result['polygonFill'] = result['lineColor'];\n        }\n        return result;\n    }\n\n    _createGradient(ctx, points, lineColor) {\n        if (!Array.isArray(points) || !points.length) {\n            return;\n        }\n        const len = points.length;\n        const grad = ctx.createLinearGradient(points[0].x, points[0].y, points[len - 1].x, points[len - 1].y);\n        lineColor['colorStops'].forEach(function (stop) {\n            grad.addColorStop.apply(grad, stop);\n        });\n        ctx.strokeStyle = grad;\n    }\n\n}\n","import {\n    IS_NODE,\n    isNil,\n    isNumber,\n    isArrayHasData,\n    getValueOrDefault\n} from '../../../core/util';\nimport Point from '../../../geo/Point';\nimport { hasFunctionDefinition } from '../../../core/mapbox';\nimport { splitTextToRow, getAlignPoint, replaceVariable } from '../../../core/util/strings';\nimport PointExtent from '../../../geo/PointExtent';\nimport Canvas from '../../../core/Canvas';\nimport PointSymbolizer from './PointSymbolizer';\n\nexport const CACHE_KEY = '___text_symbol_cache';\n\nexport default class TextMarkerSymbolizer extends PointSymbolizer {\n\n    static test(symbol) {\n        if (!symbol) {\n            return false;\n        }\n        if (!isNil(symbol['textName'])) {\n            return true;\n        }\n        return false;\n    }\n\n    constructor(symbol, geometry, painter) {\n        super(symbol, geometry, painter);\n        this._dynamic = hasFunctionDefinition(symbol);\n        this.style = this._defineStyle(this.translate());\n        if (this.style['textWrapWidth'] === 0) {\n            return;\n        }\n        this.strokeAndFill = this._defineStyle(this.translateLineAndFill(this.style));\n        const textContent = replaceVariable(this.style['textName'], this.geometry.getProperties());\n        if (!this._dynamic) {\n            // the key to cache text descriptor\n            this._cacheKey = genCacheKey(textContent, this.style);\n        }\n        this._descText(textContent);\n    }\n\n    symbolize(ctx, resources) {\n        if (!this.painter.isHitTesting() && (this.style['textSize'] === 0 ||\n            !this.style['textOpacity'] && (!this.style['textHaloRadius'] || !this.style['textHaloOpacity']) ||\n            this.style['textWrapWidth'] === 0)) {\n            return;\n        }\n        const cookedPoints = this._getRenderContainerPoints();\n        if (!isArrayHasData(cookedPoints)) {\n            return;\n        }\n        const style = this.style,\n            strokeAndFill = this.strokeAndFill;\n        const textContent = replaceVariable(this.style['textName'], this.geometry.getProperties());\n        this._descText(textContent);\n        this._prepareContext(ctx);\n        this.prepareCanvas(ctx, strokeAndFill, resources);\n        Canvas.prepareCanvasFont(ctx, style);\n        for (let i = 0, len = cookedPoints.length; i < len; i++) {\n            let p = cookedPoints[i];\n            const origin = this._rotate(ctx, p, this._getRotationAt(i));\n            if (origin) {\n                p = origin;\n            }\n            Canvas.text(ctx, textContent, p, style, this.textDesc);\n            if (origin) {\n                ctx.restore();\n            }\n        }\n    }\n\n    getPlacement() {\n        return this.symbol['textPlacement'];\n    }\n\n    getRotation() {\n        const r = this.style['textRotation'];\n        if (!isNumber(r)) {\n            return null;\n        }\n        //to radian\n        return -r * Math.PI / 180;\n    }\n\n    getDxDy() {\n        const s = this.style;\n        return new Point(s['textDx'], s['textDy']);\n    }\n\n    getFixedExtent() {\n        const dxdy = this.getDxDy(),\n            style = this.style;\n        let size = this.textDesc['size'];\n        const alignPoint = getAlignPoint(size, style['textHorizontalAlignment'], style['textVerticalAlignment']);\n        const alignW = alignPoint.x,\n            alignH = alignPoint.y;\n        if (style['textHaloRadius']) {\n            const r = style['textHaloRadius'];\n            size = size.add(r * 2, r * 2);\n        }\n        let result = new PointExtent(\n            dxdy.add(alignW, alignH),\n            dxdy.add(alignW + size['width'], alignH + size['height'])\n        );\n        const rotation = this.getRotation();\n        if (rotation) {\n            result = this._rotateExtent(result, rotation);\n        }\n        return result;\n    }\n\n    translate() {\n        const s = this.symbol;\n        const result = {\n            'textName': s['textName'],\n            'textFaceName': getValueOrDefault(s['textFaceName'], 'monospace'),\n            'textWeight': getValueOrDefault(s['textWeight'], 'normal'), //'bold', 'bolder'\n            'textStyle': getValueOrDefault(s['textStyle'], 'normal'), //'italic', 'oblique'\n            'textSize': getValueOrDefault(s['textSize'], 10),\n            'textFont': getValueOrDefault(s['textFont'], null),\n            'textFill': getValueOrDefault(s['textFill'], '#000'),\n            'textOpacity': getValueOrDefault(s['textOpacity'], 1),\n\n            'textHaloFill': getValueOrDefault(s['textHaloFill'], '#ffffff'),\n            'textHaloRadius': getValueOrDefault(s['textHaloRadius'], 0),\n            'textHaloOpacity': getValueOrDefault(s['textHaloOpacity'], 1),\n\n            'textWrapWidth': getValueOrDefault(s['textWrapWidth'], null),\n            'textWrapCharacter': getValueOrDefault(s['textWrapCharacter'], '\\n'),\n            'textLineSpacing': getValueOrDefault(s['textLineSpacing'], 0),\n\n            'textDx': getValueOrDefault(s['textDx'], 0),\n            'textDy': getValueOrDefault(s['textDy'], 0),\n\n            'textHorizontalAlignment': getValueOrDefault(s['textHorizontalAlignment'], 'middle'), //left | middle | right | auto\n            'textVerticalAlignment': getValueOrDefault(s['textVerticalAlignment'], 'middle'), // top | middle | bottom | auto\n            'textAlign': getValueOrDefault(s['textAlign'], 'center'), //left | right | center | auto\n\n            'textRotation' : getValueOrDefault(s['textRotation'], 0),\n\n            'textMaxWidth' : getValueOrDefault(s['textMaxWidth'], 0),\n            'textMaxHeight' : getValueOrDefault(s['textMaxHeight'], 0)\n        };\n\n        if (result['textMaxWidth'] > 0 && (!result['textWrapWidth'] || result['textWrapWidth'] > result['textMaxWidth'])) {\n            if (!result['textWrapWidth']) {\n                result['textMaxHeight'] = 1;\n            }\n            result['textWrapWidth'] = result['textMaxWidth'];\n        }\n        return result;\n    }\n\n    translateLineAndFill(s) {\n        return {\n            'lineColor': s['textHaloRadius'] ? s['textHaloFill'] : s['textFill'],\n            'lineWidth': s['textHaloRadius'],\n            'lineOpacity': s['textOpacity'],\n            'lineDasharray': null,\n            'lineCap': 'butt',\n            'lineJoin': 'round',\n            'polygonFill': s['textFill'],\n            'polygonOpacity': s['textOpacity']\n        };\n    }\n\n    _descText(textContent) {\n        if (this._dynamic) {\n            this.textDesc = this._measureText(textContent);\n            return;\n        }\n        this.textDesc = this._loadFromCache();\n        if (!this.textDesc) {\n            this.textDesc = this._measureText(textContent);\n            this._storeToCache(this.textDesc);\n        }\n    }\n\n    _measureText(textContent) {\n        const maxHeight = this.style['textMaxHeight'];\n        const textDesc = splitTextToRow(textContent, this.style);\n        if (maxHeight && maxHeight < textDesc.size.height) {\n            textDesc.size.height = maxHeight;\n        }\n        return textDesc;\n    }\n\n    _storeToCache(textDesc) {\n        if (IS_NODE) {\n            return;\n        }\n        if (!this.geometry[CACHE_KEY]) {\n            this.geometry[CACHE_KEY] = {};\n        }\n        this.geometry[CACHE_KEY][this._cacheKey] = { 'desc' : textDesc, 'active' : true };\n    }\n\n    _loadFromCache() {\n        if (!this.geometry[CACHE_KEY]) {\n            return null;\n        }\n        const cache = this.geometry[CACHE_KEY][this._cacheKey];\n        if (!cache) {\n            return null;\n        }\n        cache.active = true;\n        return cache.desc;\n    }\n}\n\nTextMarkerSymbolizer.CACHE_KEY = CACHE_KEY;\n\nfunction genCacheKey(textContent, style) {\n    const key = [textContent];\n    for (const p in style) {\n        if (style.hasOwnProperty(p) && p.length > 4 && p.substring(0, 4) === 'text') {\n            key.push(p + '=' + style[p]);\n        }\n    }\n    return key.join('-');\n}\n","import { isNil, extend } from '../../../core/util';\nimport Browser from '../../../core/Browser';\nimport { getMarkerPathBase64 } from '../../../core/util/resource';\nimport ImageMarkerSymbolizer from './ImageMarkerSymbolizer';\n\nexport default class VectorPathMarkerSymbolizer extends ImageMarkerSymbolizer {\n\n    static test(symbol) {\n        if (!symbol) {\n            return false;\n        }\n        if (isNil(symbol['markerFile']) && symbol['markerType'] === 'path') {\n            return true;\n        }\n        return false;\n    }\n\n    constructor(symbol, geometry, painter) {\n        //IE must have a valid width and height to draw a svg image\n        //otherwise, error will be thrown\n        if (isNil(symbol['markerWidth'])) {\n            symbol['markerWidth'] = 80;\n        }\n        if (isNil(symbol['markerHeight'])) {\n            symbol['markerHeight'] = 80;\n        }\n        super(symbol, geometry, painter);\n        symbol = extend(symbol, this.translate());\n        const style = this.style = this._defineStyle(symbol);\n        if (Browser.gecko) {\n            // Firefox requires valid width and height attributes in SVG's root element.\n            this._url = [getMarkerPathBase64(style, style['markerWidth'], style['markerHeight']), style['markerWidth'], style['markerHeight']];\n        } else {\n            this._url = [getMarkerPathBase64(style), style['markerWidth'], style['markerHeight']];\n        }\n    }\n\n    _prepareContext() {\n        //for VectorPathMarkerSymbolizer, opacity is already added into SVG element.\n    }\n\n    _getImage(resources) {\n        if (resources && resources.isResourceLoaded(this._url)) {\n            return resources.getImage(this._url);\n        }\n        const painter = this.painter;\n        const image = new Image();\n        image.onload = () => {\n            const renderer = painter.getLayer() && painter.getLayer().getRenderer();\n            if (renderer) {\n                renderer.setToRedraw();\n            }\n        };\n        image.onerror = err => {\n            if (err && typeof console !== 'undefined') {\n                console.warn(err);\n            }\n            resources.markErrorResource(this._url);\n        };\n        image.src = this._url[0];\n        if (resources) {\n            resources.addResource(this._url, image);\n        }\n        return image;\n        // return resources ? resources.getImage(this._url) : null;\n    }\n}\n","import { isObject } from '../../../core/util';\nimport Point from '../../../geo/Point';\nimport PointSymbolizer from './PointSymbolizer';\nimport StrokeAndFillSymbolizer from './StrokeAndFillSymbolizer';\nimport Canvas from '../../../core/Canvas';\n\nconst defaultSymbol = {\n    lineWidth : 1,\n    polygonFill : '#fff',\n    polygonOpacity : 0.5\n};\n\nexport default class DrawAltitudeSymbolizer extends PointSymbolizer {\n    static test(symbol, geometry) {\n        const layer = geometry.getLayer();\n        if (!layer) {\n            return false;\n        }\n        const type = geometry.getJSONType();\n        // shoule be a point or linestring\n        return (type === 'Marker' || type === 'LineString');\n    }\n\n    constructor(symbol, geometry, painter) {\n        super(symbol, geometry, painter);\n        this.style = geometry.getLayer().options['drawAltitude'];\n        if (!this.style || !isObject(this.style)) {\n            this.style = {\n                'lineWidth' : 2\n            };\n        }\n        if (!this.style['lineWidth']) {\n            // for get2DExtent\n            this.style['lineWidth'] = 0;\n        }\n        this.dxdy = this._defineStyle({\n            'dx' : symbol['textDx'] || symbol['markerDx'],\n            'dy' : symbol['textDy'] || symbol['markerDy']\n        });\n    }\n\n    symbolize(ctx) {\n        const layer = this.geometry.getLayer();\n        if (!layer.options['drawAltitude']) {\n            return;\n        }\n        const properties = this.geometry.getProperties();\n        if (!properties || !properties[layer.options['altitudeProperty']]) {\n            return;\n        }\n        const style = this._getStyle();\n        this._prepareContext(ctx);\n        if (this.geometry.type === 'LineString') {\n            const paintParams = this._getPaintParams(style['lineDx'], style['lineDy']);\n            if (!paintParams) {\n                return;\n            }\n            //container points that ignore altitude\n            const groundPoints = this.getPainter().getPaintParams(style['lineDx'], style['lineDy'], true)[0];\n            this._drawLineAltitude(ctx, paintParams[0], groundPoints);\n        } else {\n            const point = this._getRenderContainerPoints(),\n                groundPoint = this._getRenderContainerPoints(true);\n            if (!point || point.length === 0) {\n                return;\n            }\n            this._drawMarkerAltitude(ctx, point[0], groundPoint[0]);\n        }\n    }\n\n    getDxDy() {\n        const s = this.dxdy;\n        return new Point(s['dx'] || 0, s['dy'] || 0);\n    }\n\n    get2DExtent() {\n        if (this.geometry.type === 'LineString') {\n            return StrokeAndFillSymbolizer.prototype.get2DExtent.apply(this);\n        } else {\n            return super.get2DExtent();\n        }\n    }\n\n    getPlacement() {\n        return 'point';\n    }\n\n    _getPaintParams(dx, dy) {\n        return this.getPainter().getPaintParams(dx || 0, dy || 0);\n    }\n\n    _drawMarkerAltitude(ctx, point, groundPoint) {\n        const style = this._getStyle();\n        this.prepareCanvas(ctx, style);\n        Canvas.path(ctx, [point, groundPoint], style['lineOpacity'], null, style['lineDasharray']);\n    }\n\n    _drawLineAltitude(ctx, points, groundPoints) {\n        const style = this._getStyle();\n        const isSplitted = points.length > 0 && Array.isArray(points[0]);\n\n        if (isSplitted) {\n            for (let i = 0; i < points.length; i++) {\n                this._drawLine(ctx, points[i], groundPoints[i]);\n            }\n        } else {\n            this._drawLine(ctx, points, groundPoints);\n        }\n\n        if (ctx.setLineDash && Array.isArray(style['lineDasharray'])) {\n            ctx.setLineDash([]);\n        }\n    }\n\n    _drawLine(ctx, points, groundPoints) {\n        const style = this._getStyle();\n        this.prepareCanvas(ctx, style);\n        for (let i = 0, l = points.length - 1; i < l; i++) {\n            Canvas.polygon(ctx, [points[i], points[i + 1], groundPoints[i + 1], groundPoints[i]], style['lineOpacity'], style['polygonOpacity'], style['lineDasharray']);\n        }\n    }\n\n    _getStyle() {\n        // read drawAltitude from layer every time\n        let style = this.geometry.getLayer().options['drawAltitude'];\n        if (!isObject(style)) {\n            style = defaultSymbol;\n        }\n        if (!style['lineWidth']) {\n            // for get2DExtent\n            style['lineWidth'] = 0;\n            style['lineOpacity'] = 0;\n        }\n        return style;\n    }\n}\n","import { isNumber, sign, pushIn, hasOwn } from '../../core/util';\nimport { clipPolygon, clipLine } from '../../core/util/path';\nimport Class from '../../core/Class';\nimport Size from '../../geo/Size';\nimport Point from '../../geo/Point';\nimport PointExtent from '../../geo/PointExtent';\nimport Canvas from '../../core/Canvas';\nimport * as Symbolizers from './symbolizers';\nimport { interpolate } from '../../core/util/util';\n\n//registered symbolizers\n//the latter will paint at the last\nconst registerSymbolizers = [\n    Symbolizers.DrawAltitudeSymbolizer,\n    Symbolizers.StrokeAndFillSymbolizer,\n    Symbolizers.ImageMarkerSymbolizer,\n    Symbolizers.VectorPathMarkerSymbolizer,\n    Symbolizers.VectorMarkerSymbolizer,\n    Symbolizers.TextMarkerSymbolizer\n];\n\n\nlet testCanvas;\n\nconst TEMP_POINT0 = new Point(0, 0);\nconst TEMP_POINT1 = new Point(0, 0);\nconst TEMP_POINT2 = new Point(0, 0);\nconst TEMP_PAINT_EXTENT = new PointExtent();\nconst TEMP_EXTENT = new PointExtent();\nconst TEMP_FIXED_EXTENT = new PointExtent();\nconst TEMP_CLIP_EXTENT0 = new PointExtent();\nconst TEMP_CLIP_EXTENT1 = new PointExtent();\n// const TEMP_CONTAINER_EXTENT = new PointExtent();\n\n/**\n * @classdesc\n * Painter class for all geometry types except the collection types.\n * @class\n * @private\n */\nclass Painter extends Class {\n\n    /**\n     *  @param {Geometry} geometry - geometry to paint\n     */\n    constructor(geometry) {\n        super();\n        this.geometry = geometry;\n        this.symbolizers = this._createSymbolizers();\n        this._altAtGLZoom = this._getGeometryAltitude();\n    }\n\n    getMap() {\n        return this.geometry.getMap();\n    }\n\n    getLayer() {\n        return this.geometry.getLayer();\n    }\n\n    /**\n     * create symbolizers\n     */\n    _createSymbolizers() {\n        const geoSymbol = this.getSymbol(),\n            symbolizers = [],\n            regSymbolizers = registerSymbolizers;\n        let symbols = geoSymbol;\n        if (!Array.isArray(geoSymbol)) {\n            symbols = [geoSymbol];\n        }\n        for (let ii = symbols.length - 1; ii >= 0; ii--) {\n            const symbol = symbols[ii];\n            for (let i = regSymbolizers.length - 1; i >= 0; i--) {\n                if (regSymbolizers[i].test(symbol, this.geometry)) {\n                    const symbolizer = new regSymbolizers[i](symbol, this.geometry, this);\n                    symbolizers.push(symbolizer);\n                    if (symbolizer instanceof Symbolizers.PointSymbolizer) {\n                        this._hasPoint = true;\n                    }\n                }\n            }\n        }\n        if (!symbolizers.length) {\n            if (console) {\n                const id = this.geometry.getId();\n                console.warn('invalid symbol for geometry(' + (this.geometry ? this.geometry.getType() + (id ? ':' + id : '') : '') + ') to draw : ' + JSON.stringify(geoSymbol));\n            }\n            // throw new Error('no symbolizers can be created to draw, check the validity of the symbol.');\n        }\n        this._debugSymbolizer = new Symbolizers.DebugSymbolizer(geoSymbol, this.geometry, this);\n        return symbolizers;\n    }\n\n    hasPoint() {\n        return !!this._hasPoint;\n    }\n\n    /**\n     * for point symbolizers\n     * @return {Point[]} points to render\n     */\n    getRenderPoints(placement) {\n        if (!this._renderPoints) {\n            this._renderPoints = {};\n        }\n        if (!placement) {\n            placement = 'center';\n        }\n        if (!this._renderPoints[placement]) {\n            this._renderPoints[placement] = this.geometry._getRenderPoints(placement);\n        }\n        return this._renderPoints[placement];\n    }\n\n    /**\n     * for strokeAndFillSymbolizer\n     * @return {Object[]} resources to render vector\n     */\n    getPaintParams(dx, dy, ignoreAltitude) {\n        const map = this.getMap(),\n            geometry = this.geometry,\n            res = map.getResolution(),\n            pitched = (map.getPitch() !== 0),\n            rotated = (map.getBearing() !== 0);\n        let params = this._cachedParams;\n\n        const paintAsPath = geometry._paintAsPath && geometry._paintAsPath();\n        if (paintAsPath && this._unsimpledParams && res <= this._unsimpledParams._res) {\n            //if res is smaller, return unsimplified params directly\n            params = this._unsimpledParams;\n        } else if (!params ||\n            // refresh paint params\n            // simplified, but not same zoom\n            params._res !== map.getResolution() ||\n            // refresh if requested by geometry\n            this._pitched !== pitched && geometry._redrawWhenPitch() ||\n            this._rotated !== rotated && geometry._redrawWhenRotate()\n        ) {\n            //render resources geometry returned are based on 2d points.\n            params = geometry._getPaintParams();\n            if (!params) {\n                return null;\n            }\n            params._res = res;\n\n            if (!geometry._simplified && paintAsPath) {\n                if (!this._unsimpledParams) {\n                    this._unsimpledParams = params;\n                }\n                if (res > this._unsimpledParams._res) {\n                    this._unsimpledParams._res = res;\n                }\n            }\n            this._cachedParams = params;\n        }\n        if (!params) {\n            return null;\n        }\n        this._pitched = pitched;\n        this._rotated = rotated;\n        const zoomScale = map.getGLScale(),\n            // paintParams = this._paintParams,\n            tr = [], // transformed params\n            points = params[0];\n\n        const mapExtent = map.getContainerExtent();\n        const cPoints = this._pointContainerPoints(points, dx, dy, ignoreAltitude, this._hitPoint && !mapExtent.contains(this._hitPoint));\n        if (!cPoints) {\n            return null;\n        }\n        tr.push(cPoints);\n        for (let i = 1, l = params.length; i < l; i++) {\n            if (isNumber(params[i]) || (params[i] instanceof Size)) {\n                if (isNumber(params[i])) {\n                    tr.push(params[i] / zoomScale);\n                } else {\n                    tr.push(params[i].multi(1 / zoomScale));\n                }\n            } else {\n                tr.push(params[i]);\n            }\n        }\n        return tr;\n    }\n\n    _pointContainerPoints(points, dx, dy, ignoreAltitude, disableClip, pointPlacement) {\n        if (this._aboveCamera()) {\n            return null;\n        }\n        const map = this.getMap(),\n            glZoom = map.getGLZoom(),\n            containerOffset = this.containerOffset;\n        let cPoints;\n        function pointContainerPoint(point, alt) {\n            const p = map._pointToContainerPoint(point, glZoom, alt)._sub(containerOffset);\n            if (dx || dy) {\n                p._add(dx || 0, dy || 0);\n            }\n            return p;\n        }\n\n        let altitude = this.getAltitude();\n\n        //convert 2d points to container points needed by canvas\n        if (Array.isArray(points)) {\n            const geometry = this.geometry;\n            let clipped;\n            if (!disableClip && geometry.options['enableClip']) {\n                clipped = this._clip(points, altitude);\n            } else {\n                clipped = {\n                    points : points,\n                    altitude : altitude\n                };\n            }\n            const clipPoints = clipped.points;\n            altitude = clipped.altitude;\n            if (ignoreAltitude) {\n                altitude = 0;\n            }\n            let alt = altitude;\n            cPoints = [];\n            for (let i = 0, l = clipPoints.length; i < l; i++) {\n                const c = clipPoints[i];\n                if (Array.isArray(c)) {\n                    const cring = [];\n                    //polygon rings or clipped line string\n                    for (let ii = 0, ll = c.length; ii < ll; ii++) {\n                        const cc = c[ii];\n                        if (Array.isArray(altitude)) {\n                            if (altitude[i]) {\n                                alt = altitude[i][ii];\n                            } else {\n                                alt = 0;\n                            }\n                        }\n                        cring.push(pointContainerPoint(cc, alt));\n                    }\n                    cPoints.push(cring);\n                } else {\n                    //line string\n                    if (Array.isArray(altitude)) {\n                        // altitude of different placement for point symbolizers\n                        if (pointPlacement === 'vertex-last') {\n                            alt = altitude[altitude.length - 1 - i];\n                        } else if (pointPlacement === 'line') {\n                            alt = (altitude[i] + altitude[i + 1]) / 2;\n                        } else {\n                            //vertex, vertex-first\n                            alt = altitude[i];\n                        }\n                    }\n                    cPoints.push(pointContainerPoint(c, alt));\n                }\n            }\n        } else if (points instanceof Point) {\n            if (ignoreAltitude) {\n                altitude = 0;\n            }\n            cPoints = map._pointToContainerPoint(points, glZoom, altitude)._sub(containerOffset);\n            if (dx || dy) {\n                cPoints._add(dx, dy);\n            }\n        }\n        return cPoints;\n    }\n\n    _clip(points, altitude) {\n        const map = this.getMap(),\n            geometry = this.geometry;\n        let lineWidth = this.getSymbol()['lineWidth'];\n        if (!isNumber(lineWidth)) {\n            lineWidth = 4;\n        }\n        let extent2D = map._get2DExtent(undefined, TEMP_CLIP_EXTENT0)._expand(lineWidth);\n        if (map.getPitch() > 0 && altitude) {\n            const c = map.cameraLookAt;\n            const pos = map.cameraPosition;\n            //add [1px, 1px] towards camera's lookAt\n            TEMP_POINT0.set(pos.x, pos.y);\n            extent2D = extent2D._combine(TEMP_POINT0._add(sign(c[0] - pos[0]), sign(c[1] - pos[1])));\n        }\n        const e = this.get2DExtent(null, TEMP_CLIP_EXTENT1);\n        let clipPoints = points;\n        if (e.within(extent2D)) {\n            // if (this.geometry.getJSONType() === 'LineString') {\n            //     // clip line with altitude\n            //     return this._clipLineByAlt(clipPoints, altitude);\n            // }\n            return {\n                points : clipPoints,\n                altitude : altitude\n            };\n        }\n        const glExtent2D = map._get2DExtent(map.getGLZoom(), TEMP_CLIP_EXTENT0)._expand(lineWidth / map._glScale);\n        const smoothness = geometry.options['smoothness'];\n        // if (this.geometry instanceof Polygon) {\n        if (geometry.getShell && this.geometry.getHoles && !smoothness) {\n            // clip the polygon to draw less and improve performance\n            if (!Array.isArray(points[0])) {\n                clipPoints = clipPolygon(points, glExtent2D);\n            } else {\n                clipPoints = [];\n                for (let i = 0; i < points.length; i++) {\n                    const part = clipPolygon(points[i], glExtent2D);\n                    if (part.length) {\n                        clipPoints.push(part);\n                    }\n                }\n            }\n        } else if (geometry.getJSONType() === 'LineString') {\n            // clip the line string to draw less and improve performance\n            if (!Array.isArray(points[0])) {\n                clipPoints = clipLine(points, glExtent2D, false, !!smoothness);\n            } else {\n                clipPoints = [];\n                for (let i = 0; i < points.length; i++) {\n                    pushIn(clipPoints, clipLine(points[i], glExtent2D, false, !!smoothness));\n                }\n            }\n            //interpolate line's segment's altitude if altitude is an array\n            return this._interpolateSegAlt(clipPoints, points, altitude);\n            // const segs = this._interpolateSegAlt(clipPoints, points, altitude);\n            // return this._clipLineByAlt(segs.points, segs.altitude);\n        }\n\n        return {\n            points : clipPoints,\n            altitude : altitude\n        };\n    }\n\n    // _clipLineByAlt(clipSegs, altitude) {\n    //     const frustumAlt = this.getMap().getFrustumAltitude();\n    //     if (!Array.isArray(altitude) || this.maxAltitude <= frustumAlt) {\n    //         return {\n    //             points : clipSegs,\n    //             altitude : altitude\n    //         };\n    //     }\n    //     return clipByALt(clipSegs, altitude, frustumAlt);\n    // }\n\n    /**\n     * interpolate clipped line segs's altitude\n     * @param {Point[]|Point[][]} clipSegs\n     * @param {Point[]|Point[][]} orig\n     * @param {Number|Number[]} altitude\n     * @private\n     */\n    _interpolateSegAlt(clipSegs, orig, altitude) {\n        if (!Array.isArray(altitude)) {\n            const fn = cc => cc.point;\n            return {\n                points : clipSegs.map(c => {\n                    if (Array.isArray(c)) {\n                        return c.map(fn);\n                    }\n                    return c.point;\n                }),\n                altitude : altitude\n            };\n        }\n        const segsWithAlt = interpolateAlt(clipSegs, orig, altitude);\n        altitude = [];\n        const points = segsWithAlt.map(p => {\n            if (Array.isArray(p)) {\n                const alt = [];\n                const cp = p.map(pp => {\n                    alt.push(pp.altitude);\n                    return pp.point;\n                });\n                altitude.push(alt);\n                return cp;\n            }\n            altitude.push(p.altitude);\n            return p.point;\n        });\n        return {\n            points : points,\n            altitude : altitude\n        };\n    }\n\n    getSymbol() {\n        return this.geometry._getInternalSymbol();\n    }\n\n    paint(extent, context, offset) {\n        if (!this.symbolizers) {\n            return;\n        }\n        const renderer = this.getLayer()._getRenderer();\n        if (!renderer || !renderer.context && !context) {\n            return;\n        }\n        //reduce geos to paint when drawOnInteracting\n        if (extent && !extent.intersects(this.get2DExtent(renderer.resources, TEMP_PAINT_EXTENT))) {\n            return;\n        }\n        const map = this.getMap();\n        const minAltitude = this.getMinAltitude();\n        const frustumAlt = map.getFrustumAltitude();\n        if (minAltitude && frustumAlt && frustumAlt < minAltitude) {\n            return;\n        }\n        this.containerOffset = offset || map._pointToContainerPoint(renderer.southWest)._add(0, -map.height);\n        this._beforePaint();\n        const ctx = context || renderer.context;\n        const contexts = [ctx, renderer.resources];\n        for (let i = this.symbolizers.length - 1; i >= 0; i--) {\n            this._prepareShadow(ctx, this.symbolizers[i].symbol);\n            this.symbolizers[i].symbolize.apply(this.symbolizers[i], contexts);\n        }\n        this._afterPaint();\n        this._painted = true;\n        this._debugSymbolizer.symbolize.apply(this._debugSymbolizer, contexts);\n    }\n\n    getSprite(resources, canvasClass) {\n        if (this.geometry.type !== 'Point') {\n            return null;\n        }\n        this._spriting = true;\n        if (!this._sprite && this.symbolizers.length > 0) {\n            const extent = new PointExtent();\n            this.symbolizers.forEach(s => {\n                const markerExtent = s.getFixedExtent(resources);\n                extent._combine(markerExtent);\n            });\n            const origin = extent.getMin().multi(-1);\n            const clazz = canvasClass || (this.getMap() ? this.getMap().CanvasClass : null);\n            const canvas = Canvas.createCanvas(extent.getWidth(), extent.getHeight(), clazz);\n            let bak;\n            if (this._renderPoints) {\n                bak = this._renderPoints;\n            }\n            const ctx = canvas.getContext('2d');\n            const contexts = [ctx, resources];\n            for (let i = this.symbolizers.length - 1; i >= 0; i--) {\n                const dxdy = this.symbolizers[i].getDxDy();\n                this._renderPoints = {\n                    'center': [\n                        [origin.add(dxdy)]\n                    ]\n                };\n                this._prepareShadow(ctx, this.symbolizers[i].symbol);\n                this.symbolizers[i].symbolize.apply(this.symbolizers[i], contexts);\n            }\n            if (bak) {\n                this._renderPoints = bak;\n            }\n            this._sprite = {\n                'canvas': canvas,\n                'offset': extent.getCenter()\n            };\n        }\n        this._spriting = false;\n        return this._sprite;\n    }\n\n    isSpriting() {\n        return !!this._spriting;\n    }\n\n    hitTest(cp, tolerance) {\n        if (!tolerance || tolerance < 0.5) {\n            tolerance = 0.5;\n        }\n        if (!testCanvas) {\n            testCanvas = Canvas.createCanvas(1, 1);\n        }\n        Canvas.setHitTesting(true);\n        testCanvas.width = testCanvas.height = 2 * tolerance;\n        const ctx = testCanvas.getContext('2d');\n        this._hitPoint = cp.sub(tolerance, tolerance);\n        try {\n            this.paint(null, ctx, this._hitPoint);\n        } catch (e) {\n            throw e;\n        } finally {\n            Canvas.setHitTesting(false);\n        }\n        delete this._hitPoint;\n        const imgData = ctx.getImageData(0, 0, testCanvas.width, testCanvas.height).data;\n        for (let i = 3, l = imgData.length; i < l; i += 4) {\n            if (imgData[i] > 0) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    isHitTesting() {\n        return !!this._hitPoint;\n    }\n\n    _prepareShadow(ctx, symbol) {\n        if (symbol['shadowBlur']) {\n            ctx.shadowBlur = symbol['shadowBlur'];\n            ctx.shadowColor = symbol['shadowColor'] || '#000';\n            ctx.shadowOffsetX = symbol['shadowOffsetX'] || 0;\n            ctx.shadowOffsetY = symbol['shadowOffsetY'] || 0;\n        } else if (ctx.shadowBlur) {\n            ctx.shadowBlur = null;\n            ctx.shadowColor = null;\n            ctx.shadowOffsetX = null;\n            ctx.shadowOffsetY = null;\n        }\n    }\n\n    _eachSymbolizer(fn, context) {\n        if (!this.symbolizers) {\n            return;\n        }\n        if (!context) {\n            context = this;\n        }\n        for (let i = this.symbolizers.length - 1; i >= 0; i--) {\n            fn.apply(context, [this.symbolizers[i]]);\n        }\n    }\n\n    get2DExtent(resources, out) {\n        this._verifyProjection();\n        const map = this.getMap();\n        resources = resources || this.getLayer()._getRenderer().resources;\n        const zoom = map.getZoom();\n        if (!this._extent2D || this._extent2D._zoom !== zoom) {\n            delete this._extent2D;\n            delete this._fixedExtent;\n            if (this.symbolizers) {\n                const extent = this._extent2D = new PointExtent();\n                const fixedExt = this._fixedExtent = new PointExtent();\n                for (let i = this.symbolizers.length - 1; i >= 0; i--) {\n                    const symbolizer = this.symbolizers[i];\n                    extent._combine(symbolizer.get2DExtent());\n                    if (symbolizer.getFixedExtent) {\n                        fixedExt._combine(symbolizer.getFixedExtent(resources));\n                    }\n                }\n                extent._zoom = zoom;\n            }\n        }\n        if (!this._extent2D) {\n            return null;\n        }\n        if (out) {\n            out.set(this._extent2D['xmin'], this._extent2D['ymin'], this._extent2D['xmax'], this._extent2D['ymax']);\n            out._add(this._fixedExtent);\n            return out;\n        }\n        return this._extent2D.add(this._fixedExtent);\n    }\n\n    getContainerExtent(out) {\n        if (this._aboveCamera()) {\n            return null;\n        }\n        this._verifyProjection();\n        const map = this.getMap();\n        const zoom = map.getZoom();\n        const glScale = map._glScale;\n        if (!this._extent2D || this._extent2D._zoom !== zoom) {\n            this.get2DExtent(null, TEMP_EXTENT);\n        }\n        const altitude = this.getMinAltitude();\n        const extent = this._extent2D.convertTo(c => map._pointToContainerPoint(c, zoom, altitude / glScale, TEMP_POINT0), out);\n        const maxAltitude = this.getMaxAltitude();\n        if (maxAltitude !== altitude) {\n            const extent2 = this._extent2D.convertTo(c => map._pointToContainerPoint(c, zoom, maxAltitude / glScale, TEMP_POINT0), TEMP_EXTENT);\n            extent._combine(extent2);\n        }\n        const layer = this.geometry.getLayer();\n        if (this.geometry.type === 'LineString' && maxAltitude && layer.options['drawAltitude']) {\n            const groundExtent = this._extent2D.convertTo(c => map._pointToContainerPoint(c, zoom, 0, TEMP_POINT0), TEMP_EXTENT);\n            extent._combine(groundExtent);\n        }\n        if (extent) {\n            extent._add(this._fixedExtent);\n        }\n        const smoothness = this.geometry.options['smoothness'];\n        if (smoothness) {\n            extent._expand(extent.getWidth() * 0.15);\n        }\n        return extent;\n    }\n\n    _aboveCamera() {\n        const altitude = this.getMinAltitude();\n        const map = this.getMap();\n        const frustumAlt = map.getFrustumAltitude();\n        return altitude && frustumAlt && frustumAlt < altitude;\n    }\n\n    getFixedExtent() {\n        const map = this.getMap();\n        const zoom = map.getZoom();\n        if (!this._extent2D || this._extent2D._zoom !== zoom) {\n            this.get2DExtent(null, TEMP_FIXED_EXTENT);\n        }\n        return this._fixedExtent;\n    }\n\n    setZIndex(change) {\n        this._eachSymbolizer(function (symbolizer) {\n            symbolizer.setZIndex(change);\n        });\n    }\n\n    show() {\n        if (!this._painted) {\n            const layer = this.getLayer();\n            if (!layer.isCanvasRender()) {\n                this.paint();\n            }\n        } else {\n            this.removeCache();\n            this._eachSymbolizer(function (symbolizer) {\n                symbolizer.show();\n            });\n        }\n    }\n\n    hide() {\n        this._eachSymbolizer(function (symbolizer) {\n            symbolizer.hide();\n        });\n    }\n\n    repaint() {\n        this._altAtGLZoom = this._getGeometryAltitude();\n        this.removeCache();\n        const layer = this.getLayer();\n        if (!layer) {\n            return;\n        }\n        const renderer = layer.getRenderer();\n        if (!renderer || !renderer.setToRedraw()) {\n            return;\n        }\n        renderer.setToRedraw();\n    }\n\n    /**\n     * refresh symbolizers when symbol changed\n     */\n    refreshSymbol() {\n        this.removeCache();\n        this._removeSymbolizers();\n        this.symbolizers = this._createSymbolizers();\n    }\n\n    remove() {\n        this.removeCache();\n        this._removeSymbolizers();\n    }\n\n    _removeSymbolizers() {\n        this._eachSymbolizer(function (symbolizer) {\n            delete symbolizer.painter;\n            symbolizer.remove();\n        });\n        delete this.symbolizers;\n    }\n\n    /**\n     * delete painter's caches\n     */\n    removeCache() {\n        delete this._renderPoints;\n        delete this._paintParams;\n        delete this._sprite;\n        delete this._extent2D;\n        delete this._fixedExtent;\n        delete this._cachedParams;\n        delete this._unsimpledParams;\n        if (this.geometry) {\n            delete this.geometry[Symbolizers.TextMarkerSymbolizer.CACHE_KEY];\n        }\n    }\n\n    getAltitude() {\n        const propAlt = this._getAltitudeProperty();\n        if (propAlt !== this._propAlt) {\n            this._altAtGLZoom = this._getGeometryAltitude();\n        }\n        if (!this._altAtGLZoom) {\n            return 0;\n        }\n        return this._altAtGLZoom;\n    }\n\n    getMinAltitude() {\n        if (!this.minAltitude) {\n            return 0;\n        }\n        return this.minAltitude;\n    }\n\n    getMaxAltitude() {\n        if (!this.maxAltitude) {\n            return 0;\n        }\n        return this.maxAltitude;\n    }\n\n    _getGeometryAltitude() {\n        const map = this.getMap();\n        if (!map) {\n            return 0;\n        }\n        const altitude = this._getAltitudeProperty();\n        this._propAlt = altitude;\n        if (!altitude) {\n            this.minAltitude = this.maxAltitude = 0;\n            return 0;\n        }\n        const center = this.geometry.getCenter();\n        if (!center) {\n            return 0;\n        }\n        if (Array.isArray(altitude)) {\n            this.minAltitude = Number.MAX_VALUE;\n            this.maxAltitude = Number.MIN_VALUE;\n            return altitude.map(alt => {\n                const a = this._meterToPoint(center, alt);\n                if (a < this.minAltitude) {\n                    this.minAltitude = a;\n                }\n                if (a > this.maxAltitude) {\n                    this.maxAltitude = a;\n                }\n                return a;\n            });\n        } else {\n            this.minAltitude = this.maxAltitude = this._meterToPoint(center, altitude);\n            return this.minAltitude;\n        }\n    }\n\n    _meterToPoint(center, altitude) {\n        const map = this.getMap();\n        const z = map.getGLZoom();\n        const target = map.locate(center, altitude, 0);\n        const p0 = map.coordToPoint(center, z, TEMP_POINT1),\n            p1 = map.coordToPoint(target, z, TEMP_POINT2);\n        return Math.abs(p1.x - p0.x) * sign(altitude);\n    }\n\n    _getAltitudeProperty() {\n        const geometry = this.geometry,\n            layerOpts = geometry.getLayer().options,\n            properties = geometry.getProperties();\n        const altitude = layerOpts['enableAltitude'] ? properties ? properties[layerOpts['altitudeProperty']] : 0 : 0;\n        return altitude;\n    }\n\n    _verifyProjection() {\n        const projection = this.geometry._getProjection();\n        if (this._projCode && this._projCode !== projection.code) {\n            this.removeCache();\n        }\n        this._projCode = projection.code;\n    }\n\n    _beforePaint() {\n        const textcache = this.geometry[Symbolizers.TextMarkerSymbolizer.CACHE_KEY];\n        if (!textcache) {\n            return;\n        }\n        for (const p in textcache) {\n            if (hasOwn(textcache, p)) {\n                textcache[p].active = false;\n            }\n        }\n    }\n\n    _afterPaint() {\n        const textcache = this.geometry[Symbolizers.TextMarkerSymbolizer.CACHE_KEY];\n        if (!textcache) {\n            return;\n        }\n        for (const p in textcache) {\n            if (hasOwn(textcache, p)) {\n                if (!textcache[p].active) {\n                    delete textcache[p];\n                }\n            }\n        }\n    }\n}\n\nfunction interpolateAlt(points, orig, altitude) {\n    if (!Array.isArray(altitude)) {\n        return points;\n    }\n    const parts = [];\n    for (let i = 0, l = points.length; i < l; i++) {\n        if (Array.isArray(points[i])) {\n            parts.push(interpolateAlt(points[i], orig, altitude));\n        } else {\n            const p = points[i];\n            if (!p.point.equals(orig[p.index])) {\n                let w0, w1;\n                if (p.index === 0) {\n                    w0 = p.index;\n                    w1 = p.index + 1;\n                } else {\n                    w0 = p.index - 1;\n                    w1 = p.index;\n                }\n\n                const t0 = p.point.distanceTo(orig[w1]);\n                const t = t0 / (t0 + orig[w0].distanceTo(p.point));\n                const alt = interpolate(altitude[w0], altitude[w1], 1 - t);\n                p.altitude = alt;\n                parts.push(p);\n            } else {\n                p.altitude = altitude[p.index];\n                parts.push(p);\n            }\n        }\n    }\n    return parts;\n}\n\nexport default Painter;\n","import Class from '../../core/Class';\nimport PointExtent from '../../geo/PointExtent';\n\nconst TEMP_EXTENT = new PointExtent();\n\n/**\n * @classdesc\n * Painter for collection type geometries\n * @class\n * @private\n */\nexport default class CollectionPainter extends Class {\n    /**\n     * @param {GeometryCollection} geometry - geometry to paint\n     */\n    constructor(geometry) {\n        super();\n        this.geometry = geometry;\n    }\n\n    _eachPainter(fn) {\n        const geometries = this.geometry.getGeometries();\n        let painter;\n        for (let i = 0, len = geometries.length; i < len; i++) {\n            painter = geometries[i]._getPainter();\n            if (!painter) {\n                continue;\n            }\n            if (painter) {\n                if (fn.call(this, painter) === false) {\n                    break;\n                }\n            }\n        }\n    }\n\n    paint(extent) {\n        if (!this.geometry) {\n            return;\n        }\n        this._eachPainter(painter => {\n            painter.paint(extent);\n        });\n    }\n\n    get2DExtent(resources, out) {\n        if (out) {\n            out.set(null, null, null, null);\n        }\n        let extent = out || new PointExtent();\n        this._eachPainter(painter => {\n            extent = extent._combine(painter.get2DExtent(resources, TEMP_EXTENT));\n        });\n        return extent;\n    }\n\n    getContainerExtent() {\n        let extent = new PointExtent();\n        this._eachPainter(painter => {\n            extent = extent.combine(painter.getContainerExtent());\n        });\n        return extent;\n    }\n\n    remove() {\n        const args = arguments;\n        this._eachPainter(painter => {\n            painter.remove.apply(painter, args);\n        });\n    }\n\n    setZIndex() {\n        const args = arguments;\n        this._eachPainter(painter => {\n            painter.setZIndex.apply(painter, args);\n        });\n    }\n\n    show() {\n        const args = arguments;\n        this._eachPainter(painter => {\n            painter.show.apply(painter, args);\n        });\n    }\n\n    hide() {\n        const args = arguments;\n        this._eachPainter(painter => {\n            painter.hide.apply(painter, args);\n        });\n    }\n\n    repaint() {\n        const args = arguments;\n        this._eachPainter(painter => {\n            painter.repaint.apply(painter, args);\n        });\n    }\n\n    refreshSymbol() {\n        const args = arguments;\n        this._eachPainter(painter => {\n            painter.refreshSymbol.apply(painter, args);\n        });\n    }\n\n    hasPoint() {\n        let result = false;\n        this._eachPainter(painter => {\n            if (painter.hasPoint()) {\n                result = true;\n                return false;\n            }\n            return true;\n        });\n        return result;\n    }\n\n    getMinAltitude() {\n        let first = true;\n        let result = 0;\n        this._eachPainter(painter => {\n            const alt = painter.getMinAltitude();\n            if (first || alt < result) {\n                first = false;\n                result = alt;\n            }\n        });\n        return result;\n    }\n\n    getMaxAltitude() {\n        let result = 0;\n        this._eachPainter(painter => {\n            const alt = painter.getMaxAltitude();\n            if (alt > result) {\n                result = alt;\n            }\n        });\n        return result;\n    }\n\n}\n","import { GEOMETRY_COLLECTION_TYPES, NUMERICAL_PROPERTIES } from '../core/Constants';\nimport Class from '../core/Class';\nimport Eventable from '../core/Eventable';\nimport JSONAble from '../core/JSONAble';\nimport Handlerable from '../handler/Handlerable';\nimport {\n    extend,\n    isNil,\n    isString,\n    isNumber,\n    isObject,\n    forEachCoord,\n    flash\n} from '../core/util';\nimport { extendSymbol } from '../core/util/style';\nimport { convertResourceUrl, getExternalResources } from '../core/util/resource';\nimport Coordinate from '../geo/Coordinate';\nimport Extent from '../geo/Extent';\nimport Painter from '../renderer/geometry/Painter';\nimport CollectionPainter from '../renderer/geometry/CollectionPainter';\nimport SpatialReference from '../map/spatial-reference/SpatialReference';\n\n/**\n * @property {Object} options                       - geometry options\n * @property {Boolean} [options.id=null]            - id of the geometry\n * @property {Boolean} [options.visible=true]       - whether the geometry is visible.\n * @property {Boolean} [options.editable=true]      - whether the geometry can be edited.\n * @property {Boolean} [options.interactive=true]   - whether the geometry can be interactived.\n * @property {String} [options.cursor=null]         - cursor style when mouseover the geometry, same as the definition in CSS.\n * @property {String} [options.measure=EPSG:4326]   - the measure code for the geometry, defines {@tutorial measureGeometry how it can be measured}.\n * @property {Boolean} [options.draggable=false]    - whether the geometry can be dragged.\n * @property {Boolean} [options.dragShadow=true]    - if true, during geometry dragging, a shadow will be dragged before geometry was moved.\n * @property {Boolean} [options.dragOnAxis=null]    - if set, geometry can only be dragged along the specified axis, possible values: x, y\n * @property {Number}  [options.zIndex=undefined]   - geometry's initial zIndex\n * @memberOf Geometry\n * @instance\n */\nconst options = {\n    'id': null,\n    'visible': true,\n    'interactive':true,\n    'editable': true,\n    'cursor': null,\n    'defaultProjection': 'EPSG:4326' // BAIDU, IDENTITY\n};\n\n/**\n * Base class for all the geometries. <br/>\n * It defines common methods that all the geometry classes share. <br>\n * It is abstract and not intended to be instantiated but extended.\n *\n * @category geometry\n * @abstract\n * @extends Class\n * @mixes Eventable\n * @mixes Handlerable\n * @mixes JSONAble\n * @mixes ui.Menuable\n */\nclass Geometry extends JSONAble(Eventable(Handlerable(Class))) {\n\n    constructor(options) {\n        const opts = extend({}, options);\n        const symbol = opts['symbol'];\n        const properties = opts['properties'];\n        const id = opts['id'];\n        delete opts['symbol'];\n        delete opts['id'];\n        delete opts['properties'];\n        super(opts);\n        if (symbol) {\n            this.setSymbol(symbol);\n        }\n        if (properties) {\n            this.setProperties(properties);\n        }\n        if (!isNil(id)) {\n            this.setId(id);\n        }\n    }\n\n    /**\n     * Returns the first coordinate of the geometry.\n     *\n     * @return {Coordinate} First Coordinate\n     */\n    getFirstCoordinate() {\n        if (this.type === 'GeometryCollection') {\n            const geometries = this.getGeometries();\n            if (!geometries.length) {\n                return null;\n            }\n            return geometries[0].getFirstCoordinate();\n        }\n        let coordinates = this.getCoordinates();\n        if (!Array.isArray(coordinates)) {\n            return coordinates;\n        }\n        do {\n            coordinates = coordinates[0];\n        } while (Array.isArray(coordinates) && coordinates.length > 0);\n        return coordinates;\n    }\n\n    /**\n     * Returns the last coordinate of the geometry.\n     *\n     * @return {Coordinate} Last Coordinate\n     */\n    getLastCoordinate() {\n        if (this.type === 'GeometryCollection') {\n            const geometries = this.getGeometries();\n            if (!geometries.length) {\n                return null;\n            }\n            return geometries[geometries.length - 1].getLastCoordinate();\n        }\n        let coordinates = this.getCoordinates();\n        if (!Array.isArray(coordinates)) {\n            return coordinates;\n        }\n        do {\n            coordinates = coordinates[coordinates.length - 1];\n        } while (Array.isArray(coordinates) && coordinates.length > 0);\n        return coordinates;\n    }\n\n    /**\n     * Adds the geometry to a layer\n     * @param {Layer} layer    - layer add to\n     * @param {Boolean} [fitview=false] - automatically set the map to a fit center and zoom for the geometry\n     * @return {Geometry} this\n     * @fires Geometry#add\n     */\n    addTo(layer, fitview) {\n        layer.addGeometry(this, fitview);\n        return this;\n    }\n\n    /**\n     * Get the layer which this geometry added to.\n     * @returns {Layer} - layer added to\n     */\n    getLayer() {\n        if (!this._layer) {\n            return null;\n        }\n        return this._layer;\n    }\n\n    /**\n     * Get the map which this geometry added to\n     * @returns {Map} - map added to\n     */\n    getMap() {\n        if (!this._layer) {\n            return null;\n        }\n        return this._layer.getMap();\n    }\n\n    /**\n     * Gets geometry's id. Id is set by setId or constructor options.\n     * @returns {String|Number} geometry的id\n     */\n    getId() {\n        return this._id;\n    }\n\n    /**\n     * Set geometry's id.\n     * @param {String} id - new id\n     * @returns {Geometry} this\n     * @fires Geometry#idchange\n     */\n    setId(id) {\n        const oldId = this.getId();\n        this._id = id;\n        /**\n         * idchange event.\n         *\n         * @event Geometry#idchange\n         * @type {Object}\n         * @property {String} type - idchange\n         * @property {Geometry} target - the geometry fires the event\n         * @property {String|Number} old        - value of the old id\n         * @property {String|Number} new        - value of the new id\n         */\n        this._fireEvent('idchange', {\n            'old': oldId,\n            'new': id\n        });\n\n        return this;\n    }\n\n    /**\n     * Get geometry's properties. Defined by GeoJSON as [feature's properties]{@link http://geojson.org/geojson-spec.html#feature-objects}.\n     *\n     * @returns {Object} properties\n     */\n    getProperties() {\n        if (!this.properties) {\n            if (this._getParent()) {\n                return this._getParent().getProperties();\n            }\n            return null;\n        }\n        return this.properties;\n    }\n\n    /**\n     * Set a new properties to geometry.\n     * @param {Object} properties - new properties\n     * @returns {Geometry} this\n     * @fires Geometry#propertieschange\n     */\n    setProperties(properties) {\n        const old = this.properties;\n        this.properties = isObject(properties) ? extend({}, properties) : properties;\n        this._repaint();\n        /**\n         * propertieschange event, thrown when geometry's properties is changed.\n         *\n         * @event Geometry#propertieschange\n         * @type {Object}\n         * @property {String} type - propertieschange\n         * @property {Geometry} target - the geometry fires the event\n         * @property {String|Number} old        - value of the old properties\n         * @property {String|Number} new        - value of the new properties\n         */\n        this._fireEvent('propertieschange', {\n            'old': old,\n            'new': properties\n        });\n\n        return this;\n    }\n\n    /**\n     * Get type of the geometry, e.g. \"Point\", \"LineString\"\n     * @returns {String} type of the geometry\n     */\n    getType() {\n        return this.type;\n    }\n\n    /**\n     * Get symbol of the geometry\n     * @returns {Object} geometry's symbol\n     */\n    getSymbol() {\n        const s = this._symbol;\n        if (s) {\n            if (!Array.isArray(s)) {\n                return extend({}, s);\n            } else {\n                return extendSymbol(s);\n            }\n        }\n        return null;\n    }\n\n    /**\n     * Set a new symbol to style the geometry.\n     * @param {Object} symbol - new symbol\n     * @see {@tutorial symbol Style a geometry with symbols}\n     * @return {Geometry} this\n     * @fires Geometry#symbolchange\n     */\n    setSymbol(symbol) {\n        this._symbol = this._prepareSymbol(symbol);\n        this.onSymbolChanged();\n        return this;\n    }\n\n    /**\n     * Update geometry's current symbol.\n     *\n     * @param  {Object} props - symbol properties to update\n     * @return {Geometry} this\n     * @fires Geometry#symbolchange\n     * @example\n     * var marker = new Marker([0, 0], {\n     *    symbol : {\n     *       markerType : 'ellipse',\n     *       markerWidth : 20,\n     *       markerHeight : 30\n     *    }\n     * });\n     * // update symbol's markerWidth to 40\n     * marker.updateSymbol({\n     *     markerWidth : 40\n     * });\n     */\n    updateSymbol(props) {\n        if (!props) {\n            return this;\n        }\n        let s = this._getSymbol();\n        if (s) {\n            s = extendSymbol(s, props);\n        } else {\n            s = extendSymbol(this._getInternalSymbol(), props);\n        }\n        return this.setSymbol(s);\n    }\n\n    /**\n     * Get the geographical center of the geometry.\n     *\n     * @returns {Coordinate}\n     */\n    getCenter() {\n        return this._computeCenter(this._getMeasurer());\n    }\n\n    /**\n     * Get the geometry's geographical extent\n     *\n     * @returns {Extent} geometry's extent\n     */\n    getExtent() {\n        const prjExt = this._getPrjExtent();\n        if (prjExt) {\n            const p = this._getProjection();\n            const min = p.unproject(new Coordinate(prjExt['xmin'], prjExt['ymin'])),\n                max = p.unproject(new Coordinate(prjExt['xmax'], prjExt['ymax']));\n            return new Extent(min, max, this._getProjection());\n        } else {\n            return this._computeExtent(this._getMeasurer());\n        }\n    }\n\n    /**\n     * Get geometry's screen extent in pixel\n     *\n     * @returns {PointExtent}\n     */\n    getContainerExtent(out) {\n        const painter = this._getPainter();\n        return painter ? painter.getContainerExtent(out) : null;\n    }\n\n    /**\n     * Get pixel size of the geometry, which may vary in different zoom levels.\n     *\n     * @returns {Size}\n     */\n    getSize() {\n        const extent = this.getContainerExtent();\n        return extent ? extent.getSize() : null;\n    }\n\n    /**\n     * Whehter the geometry contains the input container point.\n     *\n     * @param  {Point|Coordinate} point - input container point or coordinate\n     * @param  {Number} [t=undefined] - tolerance in pixel\n     * @return {Boolean}\n     * @example\n     * var circle = new Circle([0, 0], 1000)\n     *     .addTo(layer);\n     * var contains = circle.containsPoint(new maptalks.Point(400, 300));\n     */\n    containsPoint(containerPoint, t) {\n        if (!this.getMap()) {\n            throw new Error('The geometry is required to be added on a map to perform \"containsPoint\".');\n        }\n        if (containerPoint instanceof Coordinate) {\n            containerPoint = this.getMap().coordToContainerPoint(containerPoint);\n        }\n        return this._containsPoint(containerPoint, t);\n        // return this._containsPoint(this.getMap()._containerPointToPoint(new Point(containerPoint)), t);\n    }\n\n    _containsPoint(containerPoint, t) {\n        const painter = this._getPainter();\n        if (!painter) {\n            return false;\n        }\n        if (isNil(t) && this._hitTestTolerance) {\n            t = this._hitTestTolerance();\n        }\n        return painter.hitTest(containerPoint, t);\n    }\n\n    /**\n     * Show the geometry.\n     *\n     * @return {Geometry} this\n     * @fires Geometry#show\n     */\n    show() {\n        this.options['visible'] = true;\n        if (this.getMap()) {\n            const painter = this._getPainter();\n            if (painter) {\n                painter.show();\n            }\n            /**\n             * show event\n             *\n             * @event Geometry#show\n             * @type {Object}\n             * @property {String} type - show\n             * @property {Geometry} target - the geometry fires the event\n             */\n            this._fireEvent('show');\n        }\n        return this;\n    }\n\n    /**\n     * Hide the geometry\n     *\n     * @return {Geometry} this\n     * @fires Geometry#hide\n     */\n    hide() {\n        this.options['visible'] = false;\n        if (this.getMap()) {\n            this.onHide();\n            const painter = this._getPainter();\n            if (painter) {\n                painter.hide();\n            }\n            /**\n             * hide event\n             *\n             * @event Geometry#hide\n             * @type {Object}\n             * @property {String} type - hide\n             * @property {Geometry} target - the geometry fires the event\n             */\n            this._fireEvent('hide');\n        }\n        return this;\n    }\n\n    /**\n     * Whether the geometry is visible\n     *\n     * @returns {Boolean}\n     */\n    isVisible() {\n        if (!this.options['visible']) {\n            return false;\n        }\n        const symbol = this._getInternalSymbol();\n        if (!symbol) {\n            return true;\n        }\n        if (Array.isArray(symbol)) {\n            if (!symbol.length) {\n                return true;\n            }\n            for (let i = 0, l = symbol.length; i < l; i++) {\n                if (isNil(symbol[i]['opacity']) || symbol[i]['opacity'] > 0) {\n                    return true;\n                }\n            }\n            return false;\n        } else {\n            return (isNil(symbol['opacity']) || (isNumber(symbol['opacity']) && symbol['opacity'] > 0));\n        }\n    }\n\n    /**\n     * Get zIndex of the geometry, default is 0\n     * @return {Number} zIndex\n     */\n    getZIndex() {\n        return this.options['zIndex'] || 0;\n    }\n\n    /**\n     * Set a new zIndex to Geometry and fire zindexchange event (will cause layer to sort geometries and render)\n     * @param {Number} zIndex - new zIndex\n     * @return {Geometry} this\n     * @fires Geometry#zindexchange\n     */\n    setZIndex(zIndex) {\n        const old = this.options['zIndex'];\n        this.options['zIndex'] = zIndex;\n        /**\n         * zindexchange event, fired when geometry's zIndex is changed.\n         *\n         * @event Geometry#zindexchange\n         * @type {Object}\n         * @property {String} type - zindexchange\n         * @property {Geometry} target - the geometry fires the event\n         * @property {Number} old        - old zIndex\n         * @property {Number} new        - new zIndex\n         */\n        this._fireEvent('zindexchange', {\n            'old': old,\n            'new': zIndex\n        });\n\n        return this;\n    }\n\n    /**\n     * Only set a new zIndex to Geometry without firing zindexchange event. <br>\n     * Can be useful to improve perf when a lot of geometries' zIndex need to be updated. <br>\n     * When updated N geometries, You can use setZIndexSilently with (N-1) geometries and use setZIndex with the last geometry for layer to sort and render.\n     * @param {Number} zIndex - new zIndex\n     * @return {Geometry} this\n     */\n    setZIndexSilently(zIndex) {\n        this.options['zIndex'] = zIndex;\n        return this;\n    }\n\n    /**\n     * Bring the geometry on the top\n     * @return {Geometry} this\n     * @fires Geometry#zindexchange\n     */\n    bringToFront() {\n        const layer = this.getLayer();\n        if (!layer || !layer.getGeoMaxZIndex) {\n            return this;\n        }\n        const topZ = layer.getGeoMaxZIndex();\n        this.setZIndex(topZ + 1);\n        return this;\n    }\n\n    /**\n     * Bring the geometry to the back\n     * @return {Geometry} this\n     * @fires Geometry#zindexchange\n     */\n    bringToBack() {\n        const layer = this.getLayer();\n        if (!layer || !layer.getGeoMinZIndex) {\n            return this;\n        }\n        const bottomZ = layer.getGeoMinZIndex();\n        this.setZIndex(bottomZ - 1);\n        return this;\n    }\n\n    /**\n     * Translate or move the geometry by the given offset.\n     *\n     * @param  {Coordinate} offset - translate offset\n     * @return {Geometry} this\n     * @fires Geometry#positionchange\n     * @fires Geometry#shapechange\n     */\n    /**\n     * Translate or move the geometry by the given offset.\n     *\n     * @param  {Number} x - x offset\n     * @param  {Number} y - y offset\n     * @return {Geometry} this\n     * @fires Geometry#positionchange\n     * @fires Geometry#shapechange\n     */\n    translate(x, y) {\n        if (isNil(x)) {\n            return this;\n        }\n        const offset = new Coordinate(x, y);\n        if (offset.x === 0 && offset.y === 0) {\n            return this;\n        }\n        const coordinates = this.getCoordinates();\n        if (coordinates) {\n            if (Array.isArray(coordinates)) {\n                const translated = forEachCoord(coordinates, function (coord) {\n                    return coord.add(offset);\n                });\n                this.setCoordinates(translated);\n            } else {\n                this.setCoordinates(coordinates.add(offset));\n            }\n        }\n        return this;\n    }\n\n    /**\n     * Flash the geometry, show and hide by certain internal for times of count.\n     *\n     * @param {Number} [interval=100]     - interval of flash, in millisecond (ms)\n     * @param {Number} [count=4]          - flash times\n     * @param {Function} [cb=null]        - callback function when flash ended\n     * @param {*} [context=null]          - callback context\n     * @return {Geometry} this\n     */\n    flash(interval, count, cb, context) {\n        return flash.call(this, interval, count, cb, context);\n    }\n\n    /**\n     * Returns a copy of the geometry without the event listeners.\n     * @returns {Geometry} copy\n     */\n    copy() {\n        const json = this.toJSON();\n        const ret = Geometry.fromJSON(json);\n        //restore visibility\n        ret.options['visible'] = true;\n        return ret;\n    }\n\n\n    /**\n     * remove itself from the layer if any.\n     * @returns {Geometry} this\n     * @fires Geometry#removestart\n     * @fires Geometry#remove\n     */\n    remove() {\n        const layer = this.getLayer();\n        if (!layer) {\n            return this;\n        }\n        /**\n         * removestart event.\n         *\n         * @event Geometry#removestart\n         * @type {Object}\n         * @property {String} type - removestart\n         * @property {Geometry} target - the geometry fires the event\n         */\n        this._fireEvent('removestart');\n\n        this._unbind();\n        /**\n         * removeend event.\n         *\n         * @event Geometry#removeend\n         * @type {Object}\n         * @property {String} type - removeend\n         * @property {Geometry} target - the geometry fires the event\n         */\n        this._fireEvent('removeend');\n        /**\n         * remove event.\n         *\n         * @event Geometry#remove\n         * @type {Object}\n         * @property {String} type - remove\n         * @property {Geometry} target - the geometry fires the event\n         */\n        this._fireEvent('remove');\n        return this;\n    }\n\n    /**\n     * Exports [geometry]{@link http://geojson.org/geojson-spec.html#feature-objects} out of a GeoJSON feature.\n     * @return {Object} GeoJSON Geometry\n     */\n    toGeoJSONGeometry() {\n        const gJson = this._exportGeoJSONGeometry();\n        return gJson;\n    }\n\n    /**\n     * Exports a GeoJSON feature.\n     * @param {Object} [opts=null]              - export options\n     * @param {Boolean} [opts.geometry=true]    - whether export geometry\n     * @param {Boolean} [opts.properties=true]  - whether export properties\n     * @returns {Object} GeoJSON Feature\n     */\n    toGeoJSON(opts) {\n        if (!opts) {\n            opts = {};\n        }\n        const feature = {\n            'type': 'Feature',\n            'geometry': null\n        };\n        if (isNil(opts['geometry']) || opts['geometry']) {\n            const geoJSON = this._exportGeoJSONGeometry();\n            feature['geometry'] = geoJSON;\n        }\n        const id = this.getId();\n        if (!isNil(id)) {\n            feature['id'] = id;\n        }\n        let properties;\n        if (isNil(opts['properties']) || opts['properties']) {\n            properties = this._exportProperties();\n        }\n        feature['properties'] = properties;\n        return feature;\n    }\n\n    /**\n     * Export a profile json out of the geometry. <br>\n     * Besides exporting the feature object, a profile json also contains symbol, construct options and infowindow info.<br>\n     * The profile json can be stored somewhere else and be used to reproduce the geometry later.<br>\n     * Due to the problem of serialization for functions, event listeners and contextmenu are not included in profile json.\n     * @example\n     *     // an example of a profile json.\n     * var profile = {\n            \"feature\": {\n                  \"type\": \"Feature\",\n                  \"id\" : \"point1\",\n                  \"geometry\": {\"type\": \"Point\", \"coordinates\": [102.0, 0.5]},\n                  \"properties\": {\"prop0\": \"value0\"}\n            },\n            //construct options.\n            \"options\":{\n                \"draggable\" : true\n            },\n            //symbol\n            \"symbol\":{\n                \"markerFile\"  : \"http://foo.com/icon.png\",\n                \"markerWidth\" : 20,\n                \"markerHeight\": 20\n            },\n            //infowindow info\n            \"infowindow\" : {\n                \"options\" : {\n                    \"style\" : \"black\"\n                },\n                \"title\" : \"this is a infowindow title\",\n                \"content\" : \"this is a infowindow content\"\n            }\n        };\n     * @param {Object}  [options=null]          - export options\n     * @param {Boolean} [opts.geometry=true]    - whether export feature's geometry\n     * @param {Boolean} [opts.properties=true]  - whether export feature's properties\n     * @param {Boolean} [opts.options=true]     - whether export construct options\n     * @param {Boolean} [opts.symbol=true]      - whether export symbol\n     * @param {Boolean} [opts.infoWindow=true]  - whether export infowindow\n     * @return {Object} profile json object\n     */\n    toJSON(options) {\n        //一个Graphic的profile\n        /*\n            //因为响应函数无法被序列化, 所以menu, 事件listener等无法被包含在graphic中\n        }*/\n        if (!options) {\n            options = {};\n        }\n        const json = this._toJSON(options);\n        const other = this._exportGraphicOptions(options);\n        extend(json, other);\n        return json;\n    }\n\n    /**\n     * Get the geographic length of the geometry.\n     * @returns {Number} geographic length, unit is meter\n     */\n    getLength() {\n        return this._computeGeodesicLength(this._getMeasurer());\n    }\n\n    /**\n     * Get the geographic area of the geometry.\n     * @returns {Number} geographic area, unit is sq.meter\n     */\n    getArea() {\n        return this._computeGeodesicArea(this._getMeasurer());\n    }\n\n    /**\n     * Rotate the geometry of given angle around a pivot point\n     * @param {Number} angle - angle to rotate in degree\n     * @param {Coordinate} [pivot=null]  - optional, will be the geometry's center by default\n     * @returns {Geometry} this\n     */\n    rotate(angle, pivot) {\n        if (this.type === 'GeometryCollection') {\n            const geometries = this.getGeometries();\n            geometries.forEach(g => g.rotate(angle, pivot));\n            return this;\n        }\n        if (!pivot) {\n            pivot = this.getCenter();\n        } else {\n            pivot = new Coordinate(pivot);\n        }\n        const measurer = this._getMeasurer();\n        const coordinates = this.getCoordinates();\n        if (!Array.isArray(coordinates)) {\n            if (pivot.x !== coordinates.x || pivot.y !== coordinates.y) {\n                const c = measurer._rotate(coordinates, pivot, angle);\n                this.setCoordinates(c);\n            }\n            return this;\n        }\n        forEachCoord(coordinates, c => {\n            return measurer._rotate(c, pivot, angle);\n        });\n        this.setCoordinates(coordinates);\n        return this;\n    }\n\n    /**\n     * Get the connect points for [ConnectorLine]{@link ConnectorLine}\n     * @return {Coordinate[]} connect points\n     * @private\n     */\n    _getConnectPoints() {\n        return [this.getCenter()];\n    }\n\n    //options initializing\n    _initOptions(options) {\n        const opts = extend({}, options);\n        const symbol = opts['symbol'];\n        const properties = opts['properties'];\n        const id = opts['id'];\n        delete opts['symbol'];\n        delete opts['id'];\n        delete opts['properties'];\n        this.setOptions(opts);\n        if (symbol) {\n            this.setSymbol(symbol);\n        }\n        if (properties) {\n            this.setProperties(properties);\n        }\n        if (!isNil(id)) {\n            this.setId(id);\n        }\n    }\n\n    //bind the geometry to a layer\n    _bindLayer(layer) {\n        //check dupliaction\n        if (this.getLayer()) {\n            throw new Error('Geometry cannot be added to two or more layers at the same time.');\n        }\n        this._layer = layer;\n        this._clearCache();\n        this._clearProjection();\n        // this.callInitHooks();\n    }\n\n    _prepareSymbol(symbol) {\n        if (Array.isArray(symbol)) {\n            const cookedSymbols = [];\n            for (let i = 0; i < symbol.length; i++) {\n                cookedSymbols.push(convertResourceUrl(this._checkAndCopySymbol(symbol[i])));\n            }\n            return cookedSymbols;\n        } else if (symbol) {\n            symbol = this._checkAndCopySymbol(symbol);\n            return convertResourceUrl(symbol);\n        }\n        return null;\n    }\n\n    _checkAndCopySymbol(symbol) {\n        const s = {};\n        for (const i in symbol) {\n            if (NUMERICAL_PROPERTIES[i] && isString(symbol[i])) {\n                s[i] = +symbol[i];\n            } else {\n                s[i] = symbol[i];\n            }\n        }\n        return s;\n    }\n\n    _getSymbol() {\n        return this._symbol;\n    }\n\n    /**\n     * Sets a external symbol to the geometry, e.g. style from VectorLayer's setStyle\n     * @private\n     * @param {Object} symbol - external symbol\n     */\n    _setExternSymbol(symbol) {\n        this._externSymbol = this._prepareSymbol(symbol);\n        this.onSymbolChanged();\n        return this;\n    }\n\n    _getInternalSymbol() {\n        if (this._symbol) {\n            return this._symbol;\n        } else if (this._externSymbol) {\n            return this._externSymbol;\n        } else if (this.options['symbol']) {\n            return this.options['symbol'];\n        }\n        return null;\n    }\n\n    _getPrjExtent() {\n        const p = this._getProjection();\n        this._verifyProjection();\n        if (!this._extent && p) {\n            this._extent = this._computePrjExtent(p);\n        }\n        return this._extent;\n    }\n\n    _unbind() {\n        const layer = this.getLayer();\n        if (!layer) {\n            return;\n        }\n\n        if (this._animPlayer) {\n            this._animPlayer.finish();\n        }\n        this._clearHandlers();\n        //contextmenu\n        this._unbindMenu();\n        //infowindow\n        this._unbindInfoWindow();\n\n        if (this.isEditing()) {\n            this.endEdit();\n        }\n        this._removePainter();\n        if (this.onRemove) {\n            this.onRemove();\n        }\n        if (layer.onRemoveGeometry) {\n            layer.onRemoveGeometry(this);\n        }\n        delete this._layer;\n        delete this._internalId;\n        delete this._extent;\n    }\n\n    _getInternalId() {\n        return this._internalId;\n    }\n\n    //只能被图层调用\n    _setInternalId(id) {\n        this._internalId = id;\n    }\n\n    _getMeasurer() {\n        if (this._getProjection()) {\n            return this._getProjection();\n        }\n        return SpatialReference.getProjectionInstance(this.options['defaultProjection']);\n    }\n\n    _getProjection() {\n        const map = this.getMap();\n        if (map) {\n            return map.getProjection();\n        }\n        return null;\n    }\n\n    _verifyProjection() {\n        const projection = this._getProjection();\n        if (this._projCode && (!projection || this._projCode !== projection.code)) {\n            this._clearProjection();\n        }\n        this._projCode = projection ? projection.code : null;\n    }\n\n    //获取geometry样式中依赖的外部图片资源\n    _getExternalResources() {\n        const symbol = this._getInternalSymbol();\n        return getExternalResources(symbol);\n    }\n\n    _getPainter() {\n        if (!this._painter && this.getMap()) {\n            if (GEOMETRY_COLLECTION_TYPES.indexOf(this.type) !== -1) {\n                this._painter = new CollectionPainter(this);\n            } else {\n                this._painter = new Painter(this);\n            }\n        }\n        return this._painter;\n    }\n\n    _removePainter() {\n        if (this._painter) {\n            this._painter.remove();\n        }\n        delete this._painter;\n    }\n\n    _paint(extent) {\n        if (this._painter) {\n            this._painter.paint(extent);\n        }\n    }\n\n    _clearCache() {\n        delete this._extent;\n    }\n\n    _clearProjection() {\n        delete this._extent;\n    }\n\n    _repaint() {\n        if (this._painter) {\n            this._painter.repaint();\n        }\n    }\n\n    onHide() {\n        this.closeMenu();\n        this.closeInfoWindow();\n    }\n\n    onShapeChanged() {\n        this._clearCache();\n        this._repaint();\n        /**\n         * shapechange event.\n         *\n         * @event Geometry#shapechange\n         * @type {Object}\n         * @property {String} type - shapechange\n         * @property {Geometry} target - the geometry fires the event\n         */\n        this._fireEvent('shapechange');\n    }\n\n    onPositionChanged() {\n        this._clearCache();\n        this._repaint();\n        /**\n         * positionchange event.\n         *\n         * @event Geometry#positionchange\n         * @type {Object}\n         * @property {String} type - positionchange\n         * @property {Geometry} target - the geometry fires the event\n         */\n        this._fireEvent('positionchange');\n    }\n\n    onSymbolChanged() {\n        if (this._painter) {\n            this._painter.refreshSymbol();\n        }\n        /**\n         * symbolchange event.\n         *\n         * @event Geometry#symbolchange\n         * @type {Object}\n         * @property {String} type - symbolchange\n         * @property {Geometry} target - the geometry fires the event\n         */\n        this._fireEvent('symbolchange');\n    }\n\n    onConfig(conf) {\n        let properties;\n        if (conf['properties']) {\n            properties = conf['properties'];\n            delete conf['properties'];\n        }\n        let needRepaint = false;\n        for (const p in conf) {\n            if (conf.hasOwnProperty(p)) {\n                const prefix = p.slice(0, 5);\n                if (prefix === 'arrow' || prefix === 'smoot') {\n                    needRepaint = true;\n                    break;\n                }\n            }\n        }\n        if (properties) {\n            this.setProperties(properties);\n            this._repaint();\n        } else if (needRepaint) {\n            this._repaint();\n        }\n    }\n\n    /**\n     * Set a parent to the geometry, which is usually a MultiPolygon, GeometryCollection, etc\n     * @param {GeometryCollection} geometry - parent geometry\n     * @private\n     */\n    _setParent(geometry) {\n        if (geometry) {\n            this._parent = geometry;\n        }\n    }\n\n    _getParent() {\n        return this._parent;\n    }\n\n    _fireEvent(eventName, param) {\n        if (this.getLayer() && this.getLayer()._onGeometryEvent) {\n            if (!param) {\n                param = {};\n            }\n            param['type'] = eventName;\n            param['target'] = this;\n            this.getLayer()._onGeometryEvent(param);\n        }\n        this.fire(eventName, param);\n    }\n\n    _toJSON(options) {\n        return {\n            'feature': this.toGeoJSON(options)\n        };\n    }\n\n    _exportGraphicOptions(options) {\n        const json = {};\n        if (isNil(options['options']) || options['options']) {\n            json['options'] = this.config();\n        }\n        if (isNil(options['symbol']) || options['symbol']) {\n            json['symbol'] = this.getSymbol();\n        }\n        if (isNil(options['infoWindow']) || options['infoWindow']) {\n            if (this._infoWinOptions) {\n                json['infoWindow'] = this._infoWinOptions;\n            }\n        }\n        return json;\n    }\n\n    _exportGeoJSONGeometry() {\n        const points = this.getCoordinates();\n        const coordinates = Coordinate.toNumberArrays(points);\n        return {\n            'type': this.getType(),\n            'coordinates': coordinates\n        };\n    }\n\n    _exportProperties() {\n        let properties = null;\n        const geoProperties = this.getProperties();\n        if (!isNil(geoProperties)) {\n            if (isObject(geoProperties)) {\n                properties = extend({}, geoProperties);\n            } else {\n                properties = geoProperties;\n            }\n        }\n        return properties;\n    }\n\n}\n\nGeometry.mergeOptions(options);\n\nexport default Geometry;\n","import { now, requestAnimFrame, cancelAnimFrame } from '../../core/util';\nimport { on, off, getEventContainerPoint, preventDefault, stopPropagation } from '../../core/util/dom';\nimport Handler from '../../handler/Handler';\nimport Geometry from '../../geometry/Geometry';\nimport Map from '../Map';\n\nconst EVENTS =\n    /**\n     * mousedown event\n     * @event Geometry#mousedown\n     * @type {Object}\n     * @property {String} type                    - mousedown\n     * @property {Geometry} target            - the Geometry fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'mousedown ' +\n    /**\n     * mouseup event\n     * @event Geometry#mouseup\n     * @type {Object}\n     * @property {String} type                    - mouseup\n     * @property {Geometry} target            - the Geometry fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'mouseup ' +\n    /**\n     * mousemove event\n     * @event Geometry#mousemove\n     * @type {Object}\n     * @property {String} type                    - mousemove\n     * @property {Geometry} target            - the Geometry fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'mousemove ' +\n    /**\n     * click event\n     * @event Geometry#click\n     * @type {Object}\n     * @property {String} type                    - click\n     * @property {Geometry} target            - the Geometry fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'click ' +\n    /**\n     * dblclick event\n     * @event Geometry#dblclick\n     * @type {Object}\n     * @property {String} type                    - dblclick\n     * @property {Geometry} target            - the Geometry fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'dblclick ' +\n    /**\n     * contextmenu event\n     * @event Geometry#contextmenu\n     * @type {Object}\n     * @property {String} type                    - contextmenu\n     * @property {Geometry} target            - the Geometry fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'contextmenu ' +\n    /**\n     * touchstart event\n     * @event Geometry#touchstart\n     * @type {Object}\n     * @property {String} type                    - touchstart\n     * @property {Geometry} target            - the Geometry fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'touchstart ' +\n    /**\n     * touchmove event\n     * @event Geometry#touchmove\n     * @type {Object}\n     * @property {String} type                    - touchmove\n     * @property {Geometry} target            - the Geometry fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'touchmove ' +\n    /**\n     * touchend event\n     * @event Geometry#touchend\n     * @type {Object}\n     * @property {String} type                    - touchend\n     * @property {Geometry} target            - the Geometry fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'touchend';\n    /**\n     * mouseenter event for geometry\n     * @event Geometry#mouseenter\n     * @type {Object}\n     * @property {String} type                    - mouseenter\n     * @property {Geometry} target       - the geometry fires mouseenter\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    /**\n     * mouseover event for geometry\n     * @event Geometry#mouseover\n     * @type {Object}\n     * @property {String} type                    - mouseover\n     * @property {Geometry} target       - the geometry fires mouseover\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    /**\n     * mouseout event for geometry\n     * @event Geometry#mouseout\n     * @type {Object}\n     * @property {String} type                    - mouseout\n     * @property {Geometry} target       - the geometry fires mouseout\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n\nclass MapGeometryEventsHandler extends Handler {\n\n    addHooks() {\n        const map = this.target;\n        const dom = map._panels.allLayers || map._containerDOM;\n        on(dom, EVENTS, this._identifyGeometryEvents, this);\n    }\n\n    removeHooks() {\n        const map = this.target;\n        const dom = map._panels.allLayers || map._containerDOM;\n        off(dom, EVENTS, this._identifyGeometryEvents, this);\n    }\n\n    _identifyGeometryEvents(domEvent, type) {\n        const map = this.target;\n        if (map.isInteracting() || map._ignoreEvent(domEvent)) {\n            return;\n        }\n        const layers = map._getLayers(layer => {\n            if (layer.identify && layer.options['geometryEvents']) {\n                return true;\n            }\n            return false;\n        });\n        if (!layers.length) {\n            return;\n        }\n        let oneMoreEvent = null;\n        const eventType = type || domEvent.type;\n        // ignore click lasted for more than 300ms.\n        if (eventType === 'mousedown' || (eventType === 'touchstart' && domEvent.touches.length === 1)) {\n            this._mouseDownTime = now();\n        } else if ((eventType === 'click' || eventType === 'touchend') && this._mouseDownTime) {\n            const downTime = this._mouseDownTime;\n            delete this._mouseDownTime;\n            const time = now();\n            if (time - downTime > 300) {\n                if (eventType === 'click') {\n                    return;\n                }\n            } else if (eventType === 'touchend') {\n                oneMoreEvent = 'click';\n            }\n        }\n\n\n        const actual = domEvent.touches && domEvent.touches.length > 0 ?\n            domEvent.touches[0] : domEvent.changedTouches && domEvent.changedTouches.length > 0 ?\n                domEvent.changedTouches[0] : domEvent;\n        if (!actual) {\n            return;\n        }\n        const containerPoint = getEventContainerPoint(actual, map._containerDOM),\n            coordinate = map.containerPointToCoordinate(containerPoint);\n        if (eventType === 'touchstart') {\n            preventDefault(domEvent);\n        }\n        let geometryCursorStyle = null;\n        const identifyOptions = {\n            'includeInternals': true,\n            //return only one geometry on top,\n            'filter': geometry => {\n                if (!(geometry instanceof Geometry)) {\n                    return false;\n                }\n                const eventToFire = geometry._getEventTypeToFire(domEvent);\n                if (eventType === 'mousemove') {\n                    if (!geometryCursorStyle && geometry.options['cursor']) {\n                        geometryCursorStyle = geometry.options['cursor'];\n                    }\n                    if (!geometry.listens('mousemove') && !geometry.listens('mouseover') && !geometry.listens('mouseenter')) {\n                        return false;\n                    }\n                } else if (!geometry.listens(eventToFire) && !geometry.listens(oneMoreEvent)) {\n                    return false;\n                }\n\n                return true;\n            },\n            'count': 1,\n            'coordinate': coordinate,\n            'onlyVisible' : map.options['onlyVisibleGeometryEvents'],\n            'layers': layers\n        };\n        const callback = fireGeometryEvent.bind(this);\n\n        if (this._queryIdentifyTimeout) {\n            cancelAnimFrame(this._queryIdentifyTimeout);\n        }\n        if (eventType === 'mousemove' || eventType === 'touchmove') {\n            this._queryIdentifyTimeout = requestAnimFrame(() => {\n                if (map.isInteracting()) {\n                    return;\n                }\n                map.identify(identifyOptions, callback);\n            });\n        } else {\n            map.identify(identifyOptions, callback);\n        }\n\n        function fireGeometryEvent(geometries) {\n            let propagation = true;\n            if (eventType === 'mousemove') {\n                const geoMap = {};\n                if (geometries.length > 0) {\n                    for (let i = geometries.length - 1; i >= 0; i--) {\n                        const geo = geometries[i];\n                        if (!(geo instanceof Geometry)) {\n                            continue;\n                        }\n                        const iid = geo._getInternalId();\n                        geoMap[iid] = geo;\n                        geo._onEvent(domEvent);\n                        if (!this._prevOverGeos || !this._prevOverGeos.geomap[iid]) {\n                            geo._onEvent(domEvent, 'mouseenter');\n                        }\n                        propagation = geo._onEvent(domEvent, 'mouseover');\n                    }\n                }\n\n                map._setPriorityCursor(geometryCursorStyle);\n\n                const oldTargets = this._prevOverGeos && this._prevOverGeos.geos;\n                this._prevOverGeos = {\n                    'geos' : geometries,\n                    'geomap' : geoMap\n                };\n                if (oldTargets && oldTargets.length > 0) {\n                    for (let i = oldTargets.length - 1; i >= 0; i--) {\n                        const oldTarget = oldTargets[i];\n                        if (!(oldTarget instanceof Geometry)) {\n                            continue;\n                        }\n                        const oldTargetId = oldTargets[i]._getInternalId();\n                        /**\n                         * 鼠标经过的新位置中不包含老的目标geometry\n                         */\n                        if (!geoMap[oldTargetId]) {\n                            propagation = oldTarget._onEvent(domEvent, 'mouseout');\n                        }\n                    }\n                }\n\n            } else {\n                if (!geometries || !geometries.length) { return; }\n                for (let i = geometries.length - 1; i >= 0; i--) {\n                    if (!(geometries[i] instanceof Geometry)) {\n                        continue;\n                    }\n                    propagation = geometries[i]._onEvent(domEvent);\n                    if (oneMoreEvent) {\n                        geometries[i]._onEvent(domEvent, oneMoreEvent);\n                    }\n                    break;\n                }\n            }\n            if (propagation === false) {\n                stopPropagation(domEvent);\n            }\n        }\n\n    }\n}\n\nMap.mergeOptions({\n    'geometryEvents': true,\n    'onlyVisibleGeometryEvents' : true\n});\n\nMap.addOnLoadHook('addHandler', 'geometryEvents', MapGeometryEventsHandler);\n\nexport default MapGeometryEventsHandler;\n","import { isNil } from '../../core/util';\nimport { addDomEvent, removeDomEvent, getEventContainerPoint, preventDefault, stopPropagation } from '../../core/util/dom';\nimport Handler from '../../handler/Handler';\nimport Map from '../Map';\n\n/*!\n * Contains code from mapbox-gl-js\n * http://github.com/mapbox/mapbox-gl-js\n * License BSD-3-Clause\n */\n\nconst wheelZoomDelta = 4.000244140625;\n\nconst defaultZoomRate = 1 / 100;\nconst wheelZoomRate = 1 / 450;\n\nconst maxScalePerFrame = 2;\n\nclass MapScrollWheelZoomHandler extends Handler {\n    constructor(target) {\n        super(target);\n        this._thisScrollZoom = this._scrollZoom.bind(this);\n        this._wheelZoomRate = wheelZoomRate;\n        this._defaultZoomRate = defaultZoomRate;\n        this._delta = 0;\n    }\n\n    addHooks() {\n        addDomEvent(this.target._containerDOM, 'mousewheel', this._onWheelScroll, this);\n    }\n\n    removeHooks() {\n        removeDomEvent(this.target._containerDOM, 'mousewheel', this._onWheelScroll);\n    }\n\n    _onWheelScroll(evt) {\n        const map = this.target;\n        if (map._ignoreEvent(evt) || !map.options['zoomable']) {\n            return false;\n        }\n        preventDefault(evt);\n        stopPropagation(evt);\n        const container = map._containerDOM;\n        const origin = map._checkZoomOrigin(getEventContainerPoint(evt, container));\n        if (map.options['seamlessZoom']) {\n            if (!this._zooming) {\n                this._trackPadSuspect = 0;\n                this._ensureTrackpad = false;\n            }\n            return this._seamless(evt, origin);\n        } else {\n            return this._interval(evt, origin);\n        }\n    }\n\n    _seamless(evt, origin) {\n        let value = evt.deltaMode === window.WheelEvent.DOM_DELTA_LINE ? evt.deltaY * 60 : evt.deltaY;\n        if (value % wheelZoomDelta !== 0) {\n            //according to https://archive.fo/ZV8gz\n            //value % wheelDelta === 0 means it must be  mouse on Mac OS X\n            if (!this._ensureTrackpad) {\n                if (Math.abs(value) < 60) {\n                    this._trackPadSuspect++;\n                } else {\n                    this._trackPadSuspect = 0;\n                }\n                //repeated very small delta value ensure it's a trackpad\n                if (this._trackPadSuspect >= 2) {\n                    this._ensureTrackpad = true;\n                }\n            }\n            if (this._ensureTrackpad) {\n                value *= 14;\n            }\n        }\n\n        if (evt.shiftKey && value) value = value / 4;\n\n        this._lastWheelEvent = evt;\n        this._delta -= value;\n        if (!this._zooming && this._delta) {\n            const map = this.target;\n            this._zoomOrigin = origin;\n            map.onZoomStart(null, origin);\n        }\n        this._start();\n    }\n\n    _start() {\n        if (!this._delta) return;\n        this._zooming = true;\n        const map = this.target;\n        if (!this._active) {\n            map.getRenderer().callInNextFrame(this._thisScrollZoom);\n            this._active = true;\n        }\n    }\n\n    _scrollZoom() {\n        this._active = false;\n        if (!this._delta) {\n            return;\n        }\n        const zoomRate = (Math.abs(this._delta) > wheelZoomDelta) ? this._wheelZoomRate : this._defaultZoomRate;\n        let scale = maxScalePerFrame / (1 + Math.exp(-Math.abs(this._delta * zoomRate)));\n        if (this._delta < 0 && scale !== 0) {\n            scale = 1 / scale;\n        }\n        const map = this.target;\n        const zoom = map.getZoom();\n        const targetZoom = map.getZoomForScale(scale, zoom, true);\n        this._delta = 0;\n        map.onZooming(targetZoom, this._zoomOrigin);\n        if (this._timeout) {\n            clearTimeout(this._timeout);\n        }\n        this._timeout = setTimeout(() => {\n            this._zooming = false;\n            delete this._timeout;\n            map.onZoomEnd(map.getZoom(), this._zoomOrigin);\n        }, 320);\n    }\n\n    _interval(evt, origin) {\n        const map = this.target;\n        if (this._zooming) {\n            this._requesting++;\n            return false;\n        }\n        this._requesting = 0;\n        let levelValue = (evt.wheelDelta ? evt.wheelDelta : evt.detail) > 0 ? 1 : -1;\n        if (evt.detail) {\n            levelValue *= -1;\n        }\n        const zoom = map.getZoom();\n        let nextZoom = zoom + levelValue;\n        nextZoom = map._checkZoom(levelValue > 0 ? Math.ceil(nextZoom) : Math.floor(nextZoom));\n        if (nextZoom === zoom) {\n            return false;\n        }\n        this._zooming = true;\n        if (!this._delta) {\n            map.onZoomStart(null, origin);\n            this._origin = origin;\n            this._delta = levelValue;\n            this._startZoom = map.getZoom();\n        }\n        const duration = 90;\n        map.animateTo({\n            'zoom' : nextZoom - this._delta * 1 / 2,\n            'around' : this._origin\n        }, {\n            'continueOnViewChanged' : true,\n            'easing' : 'linear',\n            'duration' : duration,\n            'wheelZoom' : true\n        }, frame => {\n            if (frame.state.playState !== 'finished') {\n                return;\n            }\n            if (this._requesting < 1 || Math.abs(nextZoom - this._startZoom) > 2 ||\n                //finish zooming if target zoom hits min/max\n                nextZoom === map.getMaxZoom() || nextZoom === map.getMinZoom()) {\n\n                map.animateTo({\n                    'zoom' : nextZoom,\n                    'around' : this._origin\n                }, {\n                    'continueOnViewChanged' : true,\n                    'duration' : 100\n                }, frame => {\n                    if (frame.state.playState === 'finished') {\n                        setTimeout(() => {\n                            delete this._zooming;\n                            delete this._requesting;\n                        }, 200);\n                    }\n                });\n                delete this._startZoom;\n                delete this._origin;\n                delete this._delta;\n                this._requesting = 0;\n            } else if (!isNil(this._requesting)) {\n                delete this._zooming;\n                this._onWheelScroll(evt);\n            }\n        });\n        return false;\n    }\n}\n\nMap.mergeOptions({\n    'scrollWheelZoom': true,\n    'seamlessZoom': false\n});\n\nMap.addOnLoadHook('addHandler', 'scrollWheelZoom', MapScrollWheelZoomHandler);\n\nexport default MapScrollWheelZoomHandler;\n","import { off, addDomEvent, removeDomEvent, getEventContainerPoint, preventDefault } from '../../core/util/dom';\nimport Handler from '../../handler/Handler';\nimport Point from '../../geo/Point';\nimport Map from '../Map';\n\n//handler to zoom map by pinching\nclass MapTouchZoomHandler extends Handler {\n    addHooks() {\n        addDomEvent(this.target.getContainer(), 'touchstart', this._onTouchStart, this);\n    }\n\n    removeHooks() {\n        removeDomEvent(this.target.getContainer(), 'touchstart', this._onTouchStart);\n    }\n\n    _onTouchStart(event) {\n        const map = this.target;\n        if (!event.touches || event.touches.length !== 2 || map.isInteracting()) {\n            return;\n        }\n        const container = map.getContainer();\n        const p1 = getEventContainerPoint(event.touches[0], container),\n            p2 = getEventContainerPoint(event.touches[1], container);\n\n        this.preY = p1.y;\n        this._startP1 = p1;\n        this._startP2 = p2;\n        this._startDist = p1.distanceTo(p2);\n        this._startVector = p1.sub(p2);\n        this._startZoom = map.getZoom();\n        this._startBearing = map.getBearing();\n\n        addDomEvent(document, 'touchmove', this._onTouchMove, this);\n        addDomEvent(document, 'touchend', this._onTouchEnd, this);\n        preventDefault(event);\n\n        /**\n          * touchactstart event\n          * @event Map#touchactstart\n          * @type {Object}\n          * @property {String} type                    - touchactstart\n          * @property {Map} target                     - the map fires event\n          */\n        map._fireEvent('touchactstart');\n    }\n\n    _onTouchMove(event) {\n        const map = this.target;\n        if (!event.touches || event.touches.length !== 2) {\n            return;\n        }\n        const container = map.getContainer(),\n            p1 = getEventContainerPoint(event.touches[0], container),\n            p2 = getEventContainerPoint(event.touches[1], container),\n            d1 = p1.sub(this._startP1),\n            d2 = p2.sub(this._startP2),\n            vector = p1.sub(p2),\n            scale = p1.distanceTo(p2) / this._startDist,\n            bearing = vector.angleWith(this._startVector) * 180 / Math.PI,\n            preY = this.preY || p1.y,\n            pitch = (preY - p1.y) * 0.4;\n        // console.log(preY, p1.y);\n        this.preY = p1.y;\n        const param = {\n            'domEvent': event,\n            'mousePos': [p1, p2]\n        };\n        if (!this.mode) {\n            if (map.options['touchRotate'] && Math.abs(bearing) > 8) {\n                this.mode = map.options['touchZoomRotate'] ? 'rotate_zoom' : 'rotate';\n            } else if (map.options['touchPitch'] && d1.y * d2.y > 0 && Math.abs(d1.y) > 10 && Math.abs(d2.y) > 10) {\n                this.mode = 'pitch';\n            } else if (map.options['zoomable'] && map.options['touchZoom'] && Math.abs(1 - scale) > 0.15) {\n                this.mode = map.options['touchZoomRotate'] && map.options['touchRotate'] ? 'rotate_zoom' : 'zoom';\n            }\n            this._startTouching(param);\n        }\n        if (this.mode === 'zoom' || this.mode === 'rotate_zoom') {\n            this._scale = scale;\n            const res = map._getResolution(this._startZoom) / scale;\n            const zoom = map.getZoomFromRes(res);\n            map.onZooming(zoom, this._Origin);\n        }\n        if (this.mode === 'rotate' || this.mode === 'rotate_zoom') {\n            map.setBearing(this._startBearing + bearing);\n            map.onDragRotating(param);\n        } else if (this.mode === 'pitch') {\n            map.setPitch(map.getPitch() + pitch);\n            map.onDragRotating(param);\n        }\n        /**\n          * touchacting event\n          * @event Map#touchacting\n          * @type {Object}\n          * @property {String} type                    - touchacting\n          * @property {Map} target                     - the map fires event\n          */\n        map._fireEvent('touchactinging');\n    }\n\n    _startTouching(param) {\n        const map = this.target;\n        if (this.mode === 'zoom' || this.mode === 'rotate_zoom') {\n            const size = map.getSize();\n            this._Origin = new Point(size['width'] / 2, size['height'] / 2);\n            map.onZoomStart(null, this._Origin);\n        }\n        if (this.mode === 'rotate' || this.mode === 'pitch' || this.mode === 'rotate_zoom') {\n            map.onDragRotateStart(param);\n        }\n    }\n\n    _onTouchEnd(event) {\n        delete this.preY;\n        const map = this.target;\n\n        off(document, 'touchmove', this._onTouchMove, this);\n        off(document, 'touchend', this._onTouchEnd, this);\n\n        if (this.mode === 'zoom' || this.mode === 'rotate_zoom') {\n            const scale = this._scale;\n            const res = map._getResolution(this._startZoom) / scale;\n            const zoom = map.getZoomFromRes(res);\n            map.onZoomEnd(zoom, this._Origin);\n        }\n        if (this.mode === 'pitch' || this.mode === 'rotate' || this.mode === 'rotate_zoom') {\n            map.onDragRotateEnd({\n                'domEvent': event\n            });\n        }\n        delete this.mode;\n        /**\n          * touchactend event\n          * @event Map#touchactend\n          * @type {Object}\n          * @property {String} type                    - touchactend\n          * @property {Map} target                     - the map fires event\n          */\n        map._fireEvent('touchactend');\n    }\n}\n\nMap.mergeOptions({\n    'touchGesture' : true,\n    'touchZoom': true,\n    'touchPitch' : true,\n    'touchRotate' : true,\n    'touchZoomRotate' : false\n});\n\nMap.addOnLoadHook('addHandler', 'touchGesture', MapTouchZoomHandler);\n\nexport default MapTouchZoomHandler;\n","import {\n    isNil,\n    extend,\n    isNumber,\n    isString,\n    requestAnimFrame,\n    now\n} from './util';\nimport Point from '../geo/Point';\nimport Coordinate from '../geo/Coordinate';\n\n/**\n * @classdesc\n * Easing functions for anmation, from openlayers 3\n * @class\n * @category animation\n * @memberof animation\n * @protected\n */\nconst Easing = {\n    /**\n     * Start slow and speed up.\n     * @param {number} t Input between 0 and 1.\n     * @return {number} Output between 0 and 1.\n     */\n    in(t) {\n        return Math.pow(t, 2);\n    },\n\n    /**\n     * Start fast and slow down.\n     * @param {number} t Input between 0 and 1.\n     * @return {number} Output between 0 and 1.\n     */\n    out(t) {\n        return 1 - Easing.in(1 - t);\n    },\n\n    /**\n     * Start slow, speed up, and then slow down again.\n     * @param {number} t Input between 0 and 1.\n     * @return {number} Output between 0 and 1.\n     */\n    inAndOut(t) {\n        return 3 * t * t - 2 * t * t * t;\n    },\n\n    /**\n     * Maintain a constant speed over time.\n     * @param {number} t Input between 0 and 1.\n     * @return {number} Output between 0 and 1.\n     */\n    linear(t) {\n        return t;\n    },\n\n    /**\n     * Start slow, speed up, and at the very end slow down again.  This has the\n     * same general behavior as {@link inAndOut}, but the final slowdown\n     * is delayed.\n     * @param {number} t Input between 0 and 1.\n     * @return {number} Output between 0 and 1.\n     */\n    upAndDown(t) {\n        if (t < 0.5) {\n            return Easing.inAndOut(2 * t);\n        } else {\n            return 1 - Easing.inAndOut(2 * (t - 0.5));\n        }\n    }\n};\n\n/**\n * Animation Frame used internally in animation player.\n * @category animation\n * @memberof animation\n * @protected\n */\nclass Frame {\n    /**\n     * Create an animation frame.\n     * @param {Object} state  - animation state\n     * @param {Object} styles - styles to animate\n     */\n    constructor(state, styles) {\n        this.state = state;\n        this.styles = styles;\n    }\n}\n\n/**\n * An [Web Animation API]{@link https://developer.mozilla.org/zh-CN/docs/Web/API/Animation} style animation player\n * @category animation\n * @memberof animation\n */\nclass Player {\n\n    /**\n     * Create an animation player\n     * @param {Function} animation - animation [framing]{@link framing} function\n     * @param {Object} options     - animation options\n     * @param {Function} onFrame  - callback function for animation steps\n     */\n    constructor(animation, options, onFrame) {\n        this._animation = animation;\n        this.options = options;\n        this._onFrame = onFrame;\n        this.playState = 'idle';\n        this.ready = true;\n        this.finished = false;\n    }\n}\n\n/**\n * @classdesc\n * Utilities for animation\n * @class\n * @category animation\n * @memberof animation\n */\nconst Animation = {\n    /**\n     * @property {Object} speed         - predefined animation speed\n     * @property {Number} speed.slow    - 2000ms\n     * @property {Number} speed.normal  - 1000ms\n     * @property {Number} speed.fast    - 500ms\n     */\n    speed: {\n        'slow': 2000,\n        'normal': 1000,\n        'fast': 500\n    },\n\n    /**\n     * resolve styles for animation, get a style group of start style, styles to animate and end styles.\n     * @param  {Object} styles - styles to resolve\n     * @return {Object[]}  styles resolved\n     * @private\n     */\n    _resolveStyles(styles) {\n        if (!styles) {\n            return null;\n        }\n        //resolve a child styles.\n        function resolveChild(child) {\n            if (!Array.isArray(child)) {\n                return Animation._resolveStyles(child);\n            }\n            const start = [],\n                d = [],\n                dest = [];\n            for (let i = 0; i < child.length; i++) {\n                const styles = Animation._resolveStyles(child[i]);\n                if (styles) {\n                    start.push(styles[0]);\n                    d.push(styles[1]);\n                    dest.push(styles[2]);\n                }\n            }\n            if (!start.length) {\n                return null;\n            } else {\n                return [start, d, dest];\n            }\n        }\n        // resolve a style value.\n        function resolveVal(val) {\n            let values = val;\n            let clazz;\n            //val is just a destination value, so we set start value to 0 or a 0-point or a 0-coordinate.\n            if (!Array.isArray(val)) {\n                if (isNumber(val)) {\n                    values = [0, val];\n                } else if (val instanceof Point || val instanceof Coordinate) {\n                    clazz = val.constructor;\n                    values = [new clazz(0, 0), val];\n                } else {\n                    values = [val, val];\n                }\n            }\n            //val is an array and val[0] is the start value and val[1] is the destination value.\n            let v1 = values[0],\n                v2 = values[1];\n            if (isNumber(v1) && isNumber(v2)) {\n                if (v1 === v2) {\n                    return null;\n                }\n                return [v1, v2 - v1, v2];\n            } else if (Array.isArray(v1) || v1 instanceof Coordinate || v1 instanceof Point) {\n                // is a coordinate (array or a coordinate) or a point\n                if (Array.isArray(v1)) {\n                    v1 = new Coordinate(v1);\n                    v2 = new Coordinate(v2);\n                } else {\n                    clazz = v1.constructor;\n                    v1 = new clazz(v1);\n                    v2 = new clazz(v2);\n                }\n                if (v1.equals(v2)) {\n                    //a Coordinate or a Point to be eql with each other\n                    return null;\n                }\n                return [v1, v2.sub(v1), v2];\n            } else {\n                return [v1, 0, v2];\n            }\n        }\n\n        function isChild(val) {\n            if (!Array.isArray(val) && val.constructor === Object) {\n                return true;\n            } else if (Array.isArray(val) && val[0].constructor === Object) {\n                return true;\n            }\n            return false;\n        }\n\n        const d = {},\n            start = {},\n            dest = {};\n        for (const p in styles) {\n            if (styles.hasOwnProperty(p)) {\n                const values = styles[p];\n                // ignore null values\n                if (!values) {\n                    continue;\n                } else if (Array.isArray(values)) {\n                    if (isNil(values[0]) || isNil(values[1])) {\n                        continue;\n                    }\n                }\n                let childStyles;\n                if (isChild(values)) {\n                    childStyles = resolveChild(values);\n                } else {\n                    childStyles = resolveVal(values);\n                }\n                if (childStyles) {\n                    start[p] = childStyles[0];\n                    d[p] = childStyles[1];\n                    dest[p] = childStyles[2];\n                }\n            }\n        }\n        return [start, d, dest];\n    },\n\n    /**\n     * Generate a framing function\n     * @param  {Object[]} styles        - animation style group\n     * @param  {Object} [options=null]  - options\n     * @param  {Object} [options.easing=null]  - animation easing\n     * @return {Function} framing function helps to generate animation frames.\n     */\n    framing(styles, options) {\n        if (!options) {\n            options = {};\n        }\n        let easing = options['easing'] ? Easing[options['easing']] : Easing.linear;\n        if (!easing) {\n            easing = Easing.linear;\n        }\n        let dStyles, startStyles, destStyles;\n        styles = Animation._resolveStyles(styles);\n        if (styles) {\n            startStyles = styles[0];\n            dStyles = styles[1];\n            destStyles = styles[2];\n        }\n        const deltaStyles = function (delta, _startStyles, _dStyles) {\n            if (!_startStyles || !_dStyles) {\n                return null;\n            }\n            const result = {};\n            for (const p in _dStyles) {\n                if (_dStyles.hasOwnProperty(p)) {\n                    if (_startStyles[p] === destStyles[p]) {\n                        result[p] = _startStyles[p];\n                        continue;\n                    }\n                    const s = _startStyles[p],\n                        d = _dStyles[p];\n                    if (isNumber(d)) {\n                        //e.g. radius, width, height\n                        result[p] = s + delta * d;\n                    } else if (Array.isArray(d)) {\n                        //e.g. a composite symbol, element in array can only be a object.\n                        const children = [];\n                        for (let i = 0; i < d.length; i++) {\n                            children.push(deltaStyles(delta, s[i], d[i]));\n                        }\n                        result[p] = children;\n                    } else {\n                        //e.g. translate or a child\n                        const clazz = d.constructor;\n                        if (clazz === Object) {\n                            result[p] = deltaStyles(delta, s, d);\n                        } else if (s instanceof Point || s instanceof Coordinate) {\n                            result[p] = s.add(d.multi(delta));\n                        }\n                    }\n                }\n            }\n            return result;\n        };\n        return function (elapsed, duration) {\n            let state, d;\n            if (elapsed < 0) {\n                state = {\n                    'playState': 'idle',\n                    'delta': 0\n                };\n                d = startStyles;\n            } else if (elapsed < duration) {\n                const delta = easing(elapsed / duration);\n                state = {\n                    'playState': 'running',\n                    'delta': delta\n                };\n                d = deltaStyles(delta, startStyles, dStyles);\n            } else {\n                state = {\n                    'playState': 'finished',\n                    'delta': 1\n                };\n                d = destStyles;\n            }\n            state['startStyles'] = startStyles;\n            state['destStyles'] = destStyles;\n            state['progress'] = elapsed;\n            state['remainingMs'] = duration - elapsed;\n            return new Frame(state, d);\n        };\n\n    },\n\n    _requestAnimFrame(fn) {\n        if (!this._frameQueue) {\n            this._frameQueue = [];\n        }\n        this._frameQueue.push(fn);\n        this._a();\n    },\n\n    _a() {\n        if (!this._animationFrameId) {\n            this._animationFrameId = requestAnimFrame(Animation._frameFn);\n        }\n    },\n\n    _run() {\n        if (this._frameQueue.length) {\n            const running = this._frameQueue;\n            this._frameQueue = [];\n            for (let i = 0, len = running.length; i < len; i++) {\n                running[i]();\n            }\n            if (this._frameQueue.length) {\n                this._animationFrameId = requestAnimFrame(Animation._frameFn);\n            } else {\n                delete this._animationFrameId;\n            }\n        }\n    },\n\n    /**\n     * Create an animation player\n     * @param  {Object} styles  - styles to animate\n     * @param  {Object} options - animation options\n     * @param  {Function} step  - callback function for animation steps\n     * @return {Player} player\n     */\n    animate(styles, options, step) {\n        if (!options) {\n            options = {};\n        }\n        const animation = Animation.framing(styles, options);\n        return new Player(animation, options, step);\n    }\n};\n\nAnimation._frameFn = Animation._run.bind(Animation);\n\nextend(Player.prototype, /** @lends animation.Player.prototype */{\n    _prepare() {\n        const options = this.options;\n        let duration = options['speed'] || options['duration'];\n        if (isString(duration)) {\n            duration = Animation.speed[duration];\n            if (!duration) {\n                duration = +duration;\n            }\n        }\n        if (!duration) {\n            duration = Animation.speed['normal'];\n        }\n        this.duration = duration;\n        this._framer = options['framer'] || Animation._requestAnimFrame.bind(Animation);\n    },\n\n    /**\n     * Start or resume the animation\n     * @return {Player} this\n     */\n    play() {\n        if (this.playState !== 'idle' && this.playState !== 'paused') {\n            return this;\n        }\n        if (this.playState === 'idle') {\n            this.currentTime = 0;\n            this._prepare();\n        }\n        const t = now();\n        if (!this.startTime) {\n            const options = this.options;\n            this.startTime = options['startTime'] ? options['startTime'] : t;\n        }\n        this._playStartTime = Math.max(t, this.startTime);\n        if (this.playState === 'paused') {\n            this._playStartTime -= this.currentTime;\n        }\n        this.playState = 'running';\n        this._run();\n        return this;\n    },\n\n    /**\n     * Pause the animation\n     * @return {Player} this\n     */\n    pause() {\n        if (this.playState === 'paused') {\n            return this;\n        }\n        this.playState = 'paused';\n        this._run();\n        //this.duration = this.duration - this.currentTime;\n        return this;\n    },\n\n    /**\n     * Cancel the animation play and ready to play again\n     * @return {Player} this\n     */\n    cancel() {\n        if (this.playState === 'idle') {\n            return this;\n        }\n        this.playState = 'idle';\n        this.finished = false;\n        this._run();\n        return this;\n    },\n\n    /**\n     * Finish the animation play, and can't be played any more.\n     * @return {Player} this\n     */\n    finish() {\n        if (this.playState === 'finished') {\n            return this;\n        }\n        this.playState = 'finished';\n        this.finished = true;\n        this._run();\n        return this;\n    },\n\n    reverse() {\n    },\n\n    _run() {\n        const onFrame = this._onFrame;\n        const t = now();\n        let elapsed = t - this._playStartTime;\n        if (this.options['repeat'] && elapsed >= this.duration) {\n            this._playStartTime = t;\n            elapsed = 0;\n        }\n        if (this.playState !== 'running') {\n            if (onFrame) {\n                if (this.playState === 'finished') {\n                    elapsed = this.duration;\n                } else if (this.playState === 'idle') {\n                    elapsed = 0;\n                }\n                const frame = this._animation(elapsed, this.duration);\n                frame.state.playState = this.playState;\n                onFrame(frame);\n            }\n            return;\n        }\n        //elapsed, duration\n        const frame = this._animation(elapsed, this.duration);\n        this.playState = frame.state['playState'];\n\n        if (this.playState === 'idle') {\n            if (this.startTime > t) {\n                setTimeout(this._run.bind(this), this.startTime - t);\n            }\n        } else if (this.playState === 'running') {\n            this._framer(() => {\n                if (this.playState !== 'running') {\n                    // this._run();\n                    return;\n                }\n                this.currentTime = elapsed;\n                if (onFrame) {\n                    onFrame(frame);\n                }\n                this._run();\n            });\n        } else if (this.playState === 'finished') {\n            this.finished = true;\n            //finished\n            if (onFrame) {\n                onFrame(frame);\n            }\n        }\n\n    }\n});\n\nexport { Animation, Easing, Player, Frame };\n","/*\n (c) 2017, Vladimir Agafonkin\n Simplify.js, a high-performance JS polyline simplification library\n mourner.github.io/simplify-js\n*/\n\n(function () { 'use strict';\n\n// to suit your point format, run search/replace for '.x' and '.y';\n// for 3D version, see 3d branch (configurability would draw significant performance overhead)\n\n// square distance between 2 points\nfunction getSqDist(p1, p2) {\n\n    var dx = p1.x - p2.x,\n        dy = p1.y - p2.y;\n\n    return dx * dx + dy * dy;\n}\n\n// square distance from a point to a segment\nfunction getSqSegDist(p, p1, p2) {\n\n    var x = p1.x,\n        y = p1.y,\n        dx = p2.x - x,\n        dy = p2.y - y;\n\n    if (dx !== 0 || dy !== 0) {\n\n        var t = ((p.x - x) * dx + (p.y - y) * dy) / (dx * dx + dy * dy);\n\n        if (t > 1) {\n            x = p2.x;\n            y = p2.y;\n\n        } else if (t > 0) {\n            x += dx * t;\n            y += dy * t;\n        }\n    }\n\n    dx = p.x - x;\n    dy = p.y - y;\n\n    return dx * dx + dy * dy;\n}\n// rest of the code doesn't care about point format\n\n// basic distance-based simplification\nfunction simplifyRadialDist(points, sqTolerance) {\n\n    var prevPoint = points[0],\n        newPoints = [prevPoint],\n        point;\n\n    for (var i = 1, len = points.length; i < len; i++) {\n        point = points[i];\n\n        if (getSqDist(point, prevPoint) > sqTolerance) {\n            newPoints.push(point);\n            prevPoint = point;\n        }\n    }\n\n    if (prevPoint !== point) newPoints.push(point);\n\n    return newPoints;\n}\n\nfunction simplifyDPStep(points, first, last, sqTolerance, simplified) {\n    var maxSqDist = sqTolerance,\n        index;\n\n    for (var i = first + 1; i < last; i++) {\n        var sqDist = getSqSegDist(points[i], points[first], points[last]);\n\n        if (sqDist > maxSqDist) {\n            index = i;\n            maxSqDist = sqDist;\n        }\n    }\n\n    if (maxSqDist > sqTolerance) {\n        if (index - first > 1) simplifyDPStep(points, first, index, sqTolerance, simplified);\n        simplified.push(points[index]);\n        if (last - index > 1) simplifyDPStep(points, index, last, sqTolerance, simplified);\n    }\n}\n\n// simplification using Ramer-Douglas-Peucker algorithm\nfunction simplifyDouglasPeucker(points, sqTolerance) {\n    var last = points.length - 1;\n\n    var simplified = [points[0]];\n    simplifyDPStep(points, 0, last, sqTolerance, simplified);\n    simplified.push(points[last]);\n\n    return simplified;\n}\n\n// both algorithms combined for awesome performance\nfunction simplify(points, tolerance, highestQuality) {\n\n    if (points.length <= 2) return points;\n\n    var sqTolerance = tolerance !== undefined ? tolerance * tolerance : 1;\n\n    points = highestQuality ? points : simplifyRadialDist(points, sqTolerance);\n    points = simplifyDouglasPeucker(points, sqTolerance);\n\n    return points;\n}\n\n// export as AMD module / Node module / browser or worker variable\nif (typeof define === 'function' && define.amd) define(function() { return simplify; });\nelse if (typeof module !== 'undefined') {\n    module.exports = simplify;\n    module.exports.default = simplify;\n} else if (typeof self !== 'undefined') self.simplify = simplify;\nelse window.simplify = simplify;\n\n})();\n","import { isNil, isNumber, isArrayHasData, isFunction, forEachCoord } from '../core/util';\nimport { Animation } from '../core/Animation';\nimport Coordinate from '../geo/Coordinate';\nimport Extent from '../geo/Extent';\nimport Geometry from './Geometry';\nimport Polygon from './Polygon';\nimport simplify from 'simplify-js';\n\n/**\n * @property {Object} options - configuration options\n * @property {Number} [options.smoothness=0]      - line smoothing by quad bezier interporating, 0 by default\n * @property {Boolean} [options.enableSimplify=true] - whether to simplify path before rendering\n * @property {Number}  [options.simplifyTolerance=2] - tolerance to simplify path, the higher the simplify is more intense\n * @property {Boolean} [options.enableClip=true] - whether to clip path with map's current extent\n * @property {Object} options.symbol - Path's default symbol\n * @memberOf Path\n * @instance\n */\nconst options = {\n    'smoothness' : 0,\n    'enableClip' : true,\n    'enableSimplify' : true,\n    'simplifyTolerance' : 2,\n    'symbol': {\n        'lineColor': '#000',\n        'lineWidth': 2,\n        'lineOpacity': 1,\n\n        'polygonFill': '#fff', //default color in cartoCSS\n        'polygonOpacity': 1,\n        'opacity': 1\n    }\n};\n\n/**\n * An abstract class Path containing common methods for Path geometry classes, e.g. LineString, Polygon\n * @abstract\n * @category geometry\n * @extends Geometry\n */\nclass Path extends Geometry {\n\n    getOutline() {\n        const painter = this._getPainter();\n        if (!painter) {\n            return null;\n        }\n        const map = this.getMap();\n        const extent = painter.getContainerExtent().convertTo(c => map.containerPointToCoord(c));\n        return new Polygon(extent.toArray(), {\n            symbol : {\n                'lineWidth': 1,\n                'lineColor': '6b707b'\n            }\n        });\n    }\n\n    /**\n     * Show the linestring with animation\n     * @param  {Object} [options=null] animation options\n     * @param  {Number} [options.duration=1000] duration\n     * @param  {String} [options.easing=out] animation easing\n     * @param  {Function} [cb=null] callback function in animation, function parameters: frame, currentCoord\n     * @example\n     *  line.animateShow({\n     *    duration : 2000,\n     *    easing : 'linear'\n     *  }, function (frame, currentCoord) {\n     *    //frame is the animation frame\n     *    //currentCoord is current coordinate of animation\n     *  });\n     * @return {LineString}         this\n     */\n    animateShow(options = {}, cb) {\n        if (this._showPlayer) {\n            this._showPlayer.finish();\n        }\n        if (isFunction(options)) {\n            options = {};\n            cb = options;\n        }\n        const coordinates = this.getCoordinates();\n        if (coordinates.length === 0) {\n            return this;\n        }\n        this._animIdx = 0;\n        this._animLenSoFar = 0;\n        this.show();\n        const isPolygon = !!this.getShell;\n        const animCoords = isPolygon ? this.getShell().concat(this.getShell()[0]) : this.getCoordinates();\n        const projection = this._getProjection();\n        this._aniShowCenter = projection.unproject(this._getPrjExtent().getCenter());\n        const duration = options['duration'] || 1000,\n            length = this.getLength(),\n            easing = options['easing'] || 'out';\n        this.setCoordinates([]);\n        const player = this._showPlayer = Animation.animate({\n            't': duration\n        }, {\n            'duration': duration,\n            'easing': easing\n        }, frame => {\n            if (!this.getMap()) {\n                if (player.playState !== 'finished') {\n                    player.finish();\n                    if (cb) {\n                        const coordinates = this.getCoordinates();\n                        cb(frame, coordinates[coordinates.length - 1]);\n                    }\n                }\n                return;\n            }\n            const currentCoord = this._drawAnimShowFrame(frame.styles.t, duration, length, animCoords);\n            if (frame.state.playState === 'finished') {\n                delete this._showPlayer;\n                delete this._aniShowCenter;\n                delete this._animIdx;\n                delete this._animLenSoFar;\n                delete this._animTailRatio;\n                this.setCoordinates(coordinates);\n            }\n            if (cb) {\n                cb(frame, currentCoord);\n            }\n        });\n        player.play();\n        return player;\n    }\n\n    _drawAnimShowFrame(t, duration, length, coordinates) {\n        if (t === 0) {\n            return coordinates[0];\n        }\n        const map = this.getMap();\n        const targetLength = t / duration * length;\n        let segLen = 0;\n        let i, l;\n        for (i = this._animIdx, l = coordinates.length; i < l - 1; i++) {\n            segLen = map.computeLength(coordinates[i], coordinates[i + 1]);\n            if (this._animLenSoFar + segLen > targetLength) {\n                break;\n            }\n            this._animLenSoFar += segLen;\n        }\n        this._animIdx = i;\n        if (this._animIdx >= l - 1) {\n            this.setCoordinates(coordinates);\n            return coordinates[coordinates.length - 1];\n        }\n        const idx = this._animIdx;\n        const p1 = coordinates[idx],\n            p2 = coordinates[idx + 1],\n            span = targetLength - this._animLenSoFar,\n            r = span / segLen;\n        this._animTailRatio = r;\n        const x = p1.x + (p2.x - p1.x) * r,\n            y = p1.y + (p2.y - p1.y) * r,\n            targetCoord = new Coordinate(x, y);\n        const isPolygon = !!this.getShell;\n        if (!isPolygon && this.options['smoothness'] > 0) {\n            //smooth line needs to set current coordinates plus 2 more to caculate correct control points\n            const animCoords = coordinates.slice(0, this._animIdx + 3);\n            this.setCoordinates(animCoords);\n        } else {\n            const animCoords = coordinates.slice(0, this._animIdx + 1);\n            animCoords.push(targetCoord);\n            if (isPolygon) {\n                this.setCoordinates([this._aniShowCenter].concat(animCoords));\n            } else {\n                this.setCoordinates(animCoords);\n            }\n        }\n        return targetCoord;\n    }\n\n    _getCenterInExtent(extent, coordinates, clipFn) {\n        const meExtent = this.getExtent();\n        if (!extent.intersects(meExtent)) {\n            return null;\n        }\n        const clipped = clipFn(coordinates, extent);\n        if (clipped.length === 0) {\n            return null;\n        }\n        let [sumx, sumy, counter] = [0, 0, 0];\n        clipped.forEach(part => {\n            if (Array.isArray(part)) {\n                part.forEach(c => {\n                    if (c.point) {\n                        c = c.point;\n                    }\n                    sumx += c.x;\n                    sumy += c.y;\n                    counter++;\n                });\n            } else {\n                if (part.point) {\n                    part = part.point;\n                }\n                sumx += part.x;\n                sumy += part.y;\n                counter++;\n            }\n        });\n        const c = new Coordinate(sumx, sumy)._multi(1 / counter);\n        c.count = counter;\n        return c;\n    }\n\n    /**\n     * Transform projected coordinates to view points\n     * @param  {Coordinate[]} prjCoords           - projected coordinates\n     * @param  {Boolean} disableSimplify          - whether to disable simplify\\\n     * @param  {Number} zoom                      - 2d points' zoom level\n     * @returns {Point[]}\n     * @private\n     */\n    _getPath2DPoints(prjCoords, disableSimplify, zoom) {\n        if (!isArrayHasData(prjCoords)) {\n            return [];\n        }\n        const map = this.getMap(),\n            isSimplify = !disableSimplify && this._shouldSimplify(),\n            tolerance = this.options['simplifyTolerance'] * map._getResolution(),\n            isMulti = Array.isArray(prjCoords[0]);\n        delete this._simplified;\n        if (isSimplify && !isMulti) {\n            const count = prjCoords.length;\n            prjCoords = simplify(prjCoords, tolerance, false);\n            this._simplified = prjCoords.length < count;\n        }\n        if (isNil(zoom)) {\n            zoom = map.getZoom();\n        }\n        return forEachCoord(prjCoords, c => map._prjToPoint(c, zoom));\n    }\n\n    _shouldSimplify() {\n        const layer = this.getLayer(),\n            properties = this.getProperties();\n        const hasAltitude = properties && layer.options['enableAltitude'] && !isNil(properties[layer.options['altitudeProperty']]);\n        return layer && layer.options['enableSimplify'] && !hasAltitude && this.options['enableSimplify'] && !this._showPlayer/* && !this.options['smoothness'] */;\n    }\n\n    _setPrjCoordinates(prjPoints) {\n        this._prjCoords = prjPoints;\n        this.onShapeChanged();\n    }\n\n    _getPrjCoordinates() {\n        const projection = this._getProjection();\n        if (!projection) {\n            return null;\n        }\n        this._verifyProjection();\n        if (!this._prjCoords) {\n            this._prjCoords = this._projectCoords(this._coordinates);\n        }\n        return this._prjCoords;\n    }\n\n    //update cached variables if geometry is updated.\n    _updateCache() {\n        this._clearCache();\n        const projection = this._getProjection();\n        if (!projection) {\n            return;\n        }\n        if (this._prjCoords) {\n            this._coordinates = this._unprojectCoords(this._getPrjCoordinates());\n        }\n    }\n\n    _clearProjection() {\n        this._prjCoords = null;\n        super._clearProjection();\n    }\n\n    _projectCoords(points) {\n        const projection = this._getProjection();\n        if (projection) {\n            return projection.projectCoords(points);\n        }\n        return [];\n    }\n\n    _unprojectCoords(prjPoints) {\n        const projection = this._getProjection();\n        if (projection) {\n            return projection.unprojectCoords(prjPoints);\n        }\n        return [];\n    }\n\n    _computeCenter() {\n        const ring = this._coordinates;\n        if (!isArrayHasData(ring)) {\n            return null;\n        }\n        let sumx = 0,\n            sumy = 0,\n            counter = 0;\n        const size = ring.length;\n        for (let i = 0; i < size; i++) {\n            if (ring[i]) {\n                if (isNumber(ring[i].x) && isNumber(ring[i].y)) {\n                    sumx += ring[i].x;\n                    sumy += ring[i].y;\n                    counter++;\n                }\n            }\n        }\n        return new Coordinate(sumx / counter, sumy / counter);\n    }\n\n    _computeExtent() {\n        const shell = this._coordinates;\n        if (!isArrayHasData(shell)) {\n            return null;\n        }\n        const rings = [shell];\n        if (this.hasHoles && this.hasHoles()) {\n            rings.push.apply(rings, this.getHoles());\n        }\n        return this._coords2Extent(rings, this._getProjection());\n    }\n\n    _computePrjExtent() {\n        const coords = [this._getPrjCoordinates()];\n        if (this.hasHoles && this.hasHoles()) {\n            coords.push.apply(coords, this._getPrjHoles());\n        }\n        return this._coords2Extent(coords);\n    }\n\n    _get2DLength() {\n        const vertexes = this._getPath2DPoints(this._getPrjCoordinates(), true);\n        let len = 0;\n        for (let i = 1, l = vertexes.length; i < l; i++) {\n            len += vertexes[i].distanceTo(vertexes[i - 1]);\n        }\n        return len;\n    }\n\n    _hitTestTolerance() {\n        const symbol = this._getInternalSymbol();\n        let w;\n        if (Array.isArray(symbol)) {\n            w = 0;\n            for (let i = 0; i < symbol.length; i++) {\n                if (isNumber(symbol[i]['lineWidth'])) {\n                    if (symbol[i]['lineWidth'] > w) {\n                        w = symbol[i]['lineWidth'];\n                    }\n                }\n            }\n        } else {\n            w = symbol['lineWidth'];\n        }\n        return isNumber(w) ? w / 2 : 1.5;\n    }\n\n    _coords2Extent(coords, proj) {\n        const result = new Extent(proj);\n        for (let i = 0, l = coords.length; i < l; i++) {\n            for (let j = 0, ll = coords[i].length; j < ll; j++) {\n                result._combine(coords[i][j]);\n            }\n        }\n        return result;\n    }\n}\n\nPath.mergeOptions(options);\n\nexport default Path;\n","import { isArrayHasData } from '../core/util';\nimport Coordinate from '../geo/Coordinate';\nimport { clipPolygon } from '../core/util/path';\nimport Path from './Path';\n\nconst JSON_TYPE = 'Polygon';\n\n/**\n * @classdesc\n * Geometry class for polygon type\n * @category geometry\n * @extends Path\n * @example\n * var polygon = new Polygon(\n *      [\n *          [\n *              [121.48053653961283, 31.24244899384889],\n *              [121.48049362426856, 31.238559229494186],\n *              [121.49032123809872, 31.236210614999653],\n *              [121.49366863494917, 31.242926029397037],\n *              [121.48577221160967, 31.243880093267567],\n *              [121.48053653961283, 31.24244899384889]\n *          ]\n *      ]\n *  ).addTo(layer);\n */\nclass Polygon extends Path {\n\n    /**\n     * @param {Number[][]|Number[][][]|Coordinate[]|Coordinate[][]} coordinates - coordinates, shell coordinates or all the rings.\n     * @param {Object} [options=null] - construct options defined in [Polygon]{@link Polygon#options}\n     */\n    constructor(coordinates, opts) {\n        super(opts);\n        this.type = 'Polygon';\n        if (coordinates) {\n            this.setCoordinates(coordinates);\n        }\n    }\n\n    /**\n     * Set coordinates to the polygon\n     *\n     * @param {Number[][]|Number[][][]|Coordinate[]|Coordinate[][]} coordinates - new coordinates\n     * @return {Polygon} this\n     * @fires Polygon#shapechange\n     */\n    setCoordinates(coordinates) {\n        if (!coordinates) {\n            this._coordinates = null;\n            this._holes = null;\n            this._projectRings();\n            return this;\n        }\n        const rings = Coordinate.toCoordinates(coordinates);\n        const len = rings.length;\n        if (!Array.isArray(rings[0])) {\n            this._coordinates = this._trimRing(rings);\n        } else {\n            this._coordinates = this._trimRing(rings[0]);\n            if (len > 1) {\n                const holes = [];\n                for (let i = 1; i < len; i++) {\n                    if (!rings[i]) {\n                        continue;\n                    }\n                    holes.push(this._trimRing(rings[i]));\n                }\n                this._holes = holes;\n            }\n        }\n\n        this._projectRings();\n        return this;\n    }\n\n    /**\n     * Gets polygons's coordinates\n     *\n     * @returns {Coordinate[][]}\n     */\n    getCoordinates() {\n        if (!this._coordinates) {\n            return [];\n        }\n        const holes = this.getHoles();\n        const rings = [this._copyAndCloseRing(this._coordinates)];\n        for (let i = 0, l = holes.length; i < l; i++) {\n            rings.push(this._copyAndCloseRing(holes[i]));\n        }\n        return rings;\n    }\n\n    /**\n     * Get center of linestring's intersection with give extent\n     * @example\n     *  const extent = map.getExtent();\n     *  const center = line.getCenterInExtent(extent);\n     * @param {Extent} extent\n     * @return {Coordinate} center, null if line doesn't intersect with extent\n     */\n    getCenterInExtent(extent) {\n        return this._getCenterInExtent(extent, this.getShell(), clipPolygon);\n    }\n\n    /**\n     * Gets shell's coordinates of the polygon\n     *\n     * @returns {Coordinate[]}\n     */\n    getShell() {\n        return this._coordinates || [];\n    }\n\n\n    /**\n     * Gets holes' coordinates of the polygon if it has.\n     * @returns {Coordinate[][]}\n     */\n    getHoles() {\n        return this._holes || [];\n    }\n\n    /**\n     * Whether the polygon has any holes inside.\n     *\n     * @returns {Boolean}\n     */\n    hasHoles() {\n        return this.getHoles().length > 0;\n    }\n\n    _projectRings() {\n        if (!this.getMap()) {\n            this.onShapeChanged();\n            return;\n        }\n        this._prjCoords = this._projectCoords(this._coordinates);\n        this._prjHoles = this._projectCoords(this._holes);\n        this.onShapeChanged();\n    }\n\n    _cleanRing(ring) {\n        for (let i = ring.length - 1; i >= 0; i--) {\n            if (!ring[i]) {\n                ring.splice(i, 1);\n            }\n        }\n    }\n\n    /**\n     * Check if ring is valid\n     * @param  {*} ring ring to check\n     * @return {Boolean} is ring a closed one\n     * @private\n     */\n    _checkRing(ring) {\n        this._cleanRing(ring);\n        if (!ring || !isArrayHasData(ring)) {\n            return false;\n        }\n        const lastPoint = ring[ring.length - 1];\n        let isClose = true;\n        if (ring[0].x !== lastPoint.x || ring[0].y !== lastPoint.y) {\n            isClose = false;\n        }\n        return isClose;\n    }\n\n    /**\n     * If the first coordinate is equal with the last one, then remove the last coordinates.\n     * @private\n     */\n    _trimRing(ring) {\n        const isClose = this._checkRing(ring);\n        if (isArrayHasData(ring) && isClose) {\n            ring.splice(ring.length - 1, 1);\n        }\n        return ring;\n    }\n\n    /**\n     * If the first coordinate is different with the last one, then copy the first coordinates and add to the ring.\n     * @private\n     */\n    _copyAndCloseRing(ring) {\n        ring = ring.slice(0);\n        const isClose = this._checkRing(ring);\n        if (isArrayHasData(ring) && !isClose) {\n            ring.push(ring[0].copy());\n            return ring;\n        } else {\n            return ring;\n        }\n    }\n\n    _getPrjShell() {\n        if (this.getJSONType() === JSON_TYPE) {\n            return this._getPrjCoordinates();\n        }\n        const projection = this._getProjection();\n        if (!projection) {\n            return null;\n        }\n        this._verifyProjection();\n        if (!this._prjShell) {\n            this._prjShell = this._projectCoords(this.getShell());\n        }\n        return this._prjShell;\n    }\n\n    _getPrjHoles() {\n        const projection = this._getProjection();\n        if (!projection) {\n            return null;\n        }\n        this._verifyProjection();\n        if (!this._prjHoles) {\n            this._prjHoles = this._projectCoords(this.getHoles());\n        }\n        return this._prjHoles;\n    }\n\n    _computeGeodesicLength(measurer) {\n        const rings = this.getCoordinates();\n        if (!isArrayHasData(rings)) {\n            return 0;\n        }\n        let result = 0;\n        for (let i = 0, len = rings.length; i < len; i++) {\n            result += measurer.measureLength(rings[i]);\n        }\n        return result;\n    }\n\n    _computeGeodesicArea(measurer) {\n        const rings = this.getCoordinates();\n        if (!isArrayHasData(rings)) {\n            return 0;\n        }\n        let result = measurer.measureArea(rings[0]);\n        //holes\n        for (let i = 1, len = rings.length; i < len; i++) {\n            result -= measurer.measureArea(rings[i]);\n\n        }\n        return result;\n    }\n\n    _updateCache() {\n        super._updateCache();\n        if (this._prjHoles) {\n            this._holes = this._unprojectCoords(this._getPrjHoles());\n        }\n    }\n\n    _clearCache() {\n        delete this._prjShell;\n        return super._clearCache();\n    }\n\n    _clearProjection() {\n        if (this._prjHoles) {\n            this._prjHoles = null;\n        }\n        if (this._prjShell) {\n            this._prjShell = null;\n        }\n        super._clearProjection();\n    }\n}\n\nPolygon.registerJSONType(JSON_TYPE);\n\nexport default Polygon;\n","import { isNil } from '../core/util';\nimport Coordinate from '../geo/Coordinate';\n\n/**\n * Common methods for geometry classes that base on a center, e.g. Marker, Circle, Ellipse , etc\n * @mixin CenterMixin\n */\nexport default function (Base) {\n    return class extends Base {\n\n        /**\n         * Get geometry's center\n         * @return {Coordinate} - center of the geometry\n         * @function CenterMixin.getCoordinates\n         */\n        getCoordinates() {\n            return this._coordinates;\n        }\n\n        /**\n         * Set a new center to the geometry\n         * @param {Coordinate|Number[]} coordinates - new center\n         * @return {Geometry} this\n         * @fires Geometry#positionchange\n         * @function CenterMixin.setCoordinates\n         */\n        setCoordinates(coordinates) {\n            const center = (coordinates instanceof Coordinate) ? coordinates : new Coordinate(coordinates);\n            if (center.equals(this._coordinates)) {\n                return this;\n            }\n            this._coordinates = center;\n            if (!this.getMap()) {\n                this.onPositionChanged();\n                return this;\n            }\n            const projection = this._getProjection();\n            this._setPrjCoordinates(projection.project(this._coordinates));\n            return this;\n        }\n\n        //Gets view point of the geometry's center\n        _getCenter2DPoint(zoom) {\n            const map = this.getMap();\n            if (!map) {\n                return null;\n            }\n            const z = isNil(zoom) ? map.getZoom() : map.getGLZoom();\n            const pcenter = this._getPrjCoordinates();\n            if (!pcenter) { return null; }\n\n            return map._prjToPoint(pcenter, z);\n        }\n\n        _getPrjCoordinates() {\n            const projection = this._getProjection();\n            if (!projection) {\n                return null;\n            }\n            this._verifyProjection();\n            if (!this._pcenter) {\n                if (this._coordinates) {\n                    this._pcenter = projection.project(this._coordinates);\n                }\n            }\n            return this._pcenter;\n        }\n\n        //Set center by projected coordinates\n        _setPrjCoordinates(pcenter) {\n            this._pcenter = pcenter;\n            this.onPositionChanged();\n        }\n\n        //update cached const iables if geometry is updated.\n        _updateCache() {\n            this._clearCache();\n            const projection = this._getProjection();\n            if (this._pcenter && projection) {\n                this._coordinates = projection.unproject(this._pcenter);\n            }\n        }\n\n        _clearProjection() {\n            this._pcenter = null;\n            super._clearProjection();\n        }\n\n        _computeCenter() {\n            return this._coordinates ? this._coordinates.copy() : null;\n        }\n    };\n}\n","import Extent from '../geo/Extent';\nimport CenterMixin from './CenterMixin';\nimport Geometry from './Geometry';\nimport Painter from '../renderer/geometry/Painter';\nimport * as Symbolizers from '../renderer/geometry/symbolizers';\n\n/**\n * @property {String} [options.hitTestForEvent=false] - use hit testing for events, be careful, it may fail due to tainted canvas.\n * @memberOf Marker\n * @instance\n */\nconst options = {\n    'symbol': {\n        'markerType': 'path',\n        'markerPath': [{\n            'path': 'M8 23l0 0 0 0 0 0 0 0 0 0c-4,-5 -8,-10 -8,-14 0,-5 4,-9 8,-9l0 0 0 0c4,0 8,4 8,9 0,4 -4,9 -8,14z M3,9 a5,5 0,1,0,0,-0.9Z',\n            'fill': '#DE3333'\n        }],\n        'markerPathWidth': 16,\n        'markerPathHeight': 23,\n        'markerWidth': 24,\n        'markerHeight': 34\n    },\n    'hitTestForEvent' : false\n};\n\n/**\n * @classdesc\n * Represents a Point type Geometry.\n * @category geometry\n * @extends Geometry\n * @mixes CenterMixin\n * @example\n * var marker = new Marker([100, 0], {\n *     'id' : 'marker0',\n *     'symbol' : {\n *         'markerFile'  : 'foo.png',\n *         'markerWidth' : 20,\n *         'markerHeight': 20,\n *     },\n *     'properties' : {\n *         'foo' : 'value'\n *     }\n * });\n */\nclass Marker extends CenterMixin(Geometry) {\n\n    /**\n     * @param {Coordinate} coordinates      - coordinates of the marker\n     * @param {Object} [options=null]       - construct options defined in [Marker]{@link Marker#options}\n     */\n    constructor(coordinates, opts) {\n        super(opts);\n        this.type = 'Point';\n        if (coordinates) {\n            this.setCoordinates(coordinates);\n        }\n    }\n\n    getOutline() {\n        const painter = this._getPainter();\n        if (!painter) {\n            return null;\n        }\n        const coord = this.getCoordinates();\n        const extent = painter.getContainerExtent();\n        const anchor = this.getMap().coordToContainerPoint(coord);\n        return new Marker(coord, {\n            'symbol': {\n                'markerType' : 'square',\n                'markerWidth' : extent.getWidth(),\n                'markerHeight' : extent.getHeight(),\n                'markerLineWidth': 1,\n                'markerLineColor': '6b707b',\n                'markerFill' : 'rgba(0, 0, 0, 0)',\n                'markerDx' : extent.xmin - (anchor.x - extent.getWidth() / 2),\n                'markerDy' : extent.ymin - (anchor.y - extent.getHeight() / 2)\n            }\n        });\n    }\n\n    _isVectorMarker() {\n        const symbol = this._getInternalSymbol();\n        if (Array.isArray(symbol)) {\n            return false;\n        }\n        return Symbolizers.VectorMarkerSymbolizer.test(symbol);\n    }\n\n    /**\n     * Can be edited, only marker with a vector symbol, vector path symbol or a image symbol can be edited.\n     * @return {Boolean}\n     * @private\n     */\n    _canEdit() {\n        const symbol = this._getInternalSymbol();\n        if (Array.isArray(symbol)) {\n            return false;\n        }\n        return Symbolizers.VectorMarkerSymbolizer.test(symbol) || Symbolizers.VectorPathMarkerSymbolizer.test(symbol) ||\n            Symbolizers.ImageMarkerSymbolizer.test(symbol);\n    }\n\n    _containsPoint(point, t) {\n        let extent = this.getContainerExtent();\n        if (t) {\n            extent = extent.expand(t);\n        }\n        if (extent.contains(point)) {\n            if (this.options['hitTestForEvent']) {\n                return super._containsPoint(point, t);\n            } else {\n                return true;\n            }\n        } else {\n            return false;\n        }\n    }\n\n    _computeExtent() {\n        return computeExtent.call(this, 'getCenter');\n    }\n\n    _computePrjExtent() {\n        return computeExtent.call(this, '_getPrjCoordinates');\n    }\n\n    _computeGeodesicLength() {\n        return 0;\n    }\n\n    _computeGeodesicArea() {\n        return 0;\n    }\n\n    _getSprite(resources, canvasClass) {\n        if (this._getPainter()) {\n            return this._getPainter().getSprite(resources, canvasClass);\n        }\n        return new Painter(this).getSprite(resources, canvasClass);\n    }\n}\n\nMarker.mergeOptions(options);\n\nMarker.registerJSONType('Marker');\n\nexport default Marker;\n\nfunction computeExtent(fn) {\n    const coordinates = this[fn]();\n    if (!coordinates) {\n        return null;\n    }\n    return new Extent(coordinates, coordinates, this._getProjection());\n}\n","import Coordinate from '../geo/Coordinate';\nimport { clipLine } from '../core/util/path';\nimport Path from './Path';\n\n/**\n * @property {Object} [options=null]\n * @property {String|Number[]} [options.arrowStyle=null]        - style of arrow, can be a pre-defined value or an array [arrow-width, arrow-height] (value in the array is times of linewidth), possible predefined values: classic ([3, 4])\n * @property {String} [options.arrowPlacement=vertex-last]      - arrow's placement: vertex-first, vertex-last, vertex-firstlast, point\n * @memberOf LineString\n * @instance\n */\nconst options = {\n    'arrowStyle': null,\n    'arrowPlacement': 'vertex-last' //vertex-first, vertex-last, vertex-firstlast, point\n};\n\n/**\n * Represents a LineString type Geometry.\n * @category geometry\n * @extends Path\n * @example\n * var line = new LineString(\n *     [\n *         [121.45942, 31.24123],\n *         [121.46371, 31.24226],\n *         [121.46727, 31.23870],\n *         [121.47019, 31.24145]\n *     ]\n * ).addTo(layer);\n */\nclass LineString extends Path {\n\n    /**\n     * @param {Coordinate[]|Number[][]} coordinates - coordinates of the line string\n     * @param {Object} [options=null] - construct options defined in [LineString]{@link LineString#options}\n     */\n    constructor(coordinates, options) {\n        super(options);\n        this.type = 'LineString';\n        if (coordinates) {\n            this.setCoordinates(coordinates);\n        }\n    }\n\n    /**\n     * Set new coordinates to the line string\n     * @param {Coordinate[]|Number[][]} coordinates - new coordinates\n     * @fires LineString#shapechange\n     * @return {LineString} this\n     */\n    setCoordinates(coordinates) {\n        if (!coordinates) {\n            this._coordinates = null;\n            this._setPrjCoordinates(null);\n            return this;\n        }\n        this._coordinates = Coordinate.toCoordinates(coordinates);\n        if (this.getMap()) {\n            this._setPrjCoordinates(this._projectCoords(this._coordinates));\n        } else {\n            this.onShapeChanged();\n        }\n        return this;\n    }\n\n    /**\n     * Get coordinates of the line string\n     * @return {Coordinate[]|Number[][]} coordinates\n     */\n    getCoordinates() {\n        return this._coordinates || [];\n    }\n\n    /**\n     * Get center of linestring's intersection with give extent\n     * @example\n     *  const extent = map.getExtent();\n     *  const center = line.getCenterInExtent(extent);\n     * @param {Extent} extent\n     * @return {Coordinate} center, null if line doesn't intersect with extent\n     */\n    getCenterInExtent(extent) {\n        return this._getCenterInExtent(extent, this.getCoordinates(), clipLine);\n    }\n\n    _computeGeodesicLength(measurer) {\n        return measurer.measureLength(this.getCoordinates());\n    }\n\n    _computeGeodesicArea() {\n        return 0;\n    }\n}\n\nLineString.mergeOptions(options);\n\nLineString.registerJSONType('LineString');\n\nexport default LineString;\n","import { isFunction, isArrayHasData } from '../core/util';\nimport { createFilter, getFilterFeature } from '@maptalks/feature-filter';\nimport { getExternalResources } from '../core/util/resource';\nimport Coordinate from '../geo/Coordinate';\nimport Geometry from './Geometry';\n\n/**\n * @classdesc\n * Represents a GeometryCollection.\n * @category geometry\n * @extends Geometry\n * @example\n * var marker = new Marker([0, 0]),\n *     line = new LineString([[0, 0], [0, 1]]),\n *     polygon = new Polygon([[0, 0], [0, 1], [1, 3]]);\n * var collection = new GeometryCollection([marker, line, polygon])\n *     .addTo(layer);\n */\nclass GeometryCollection extends Geometry {\n\n    /**\n     * @param {Geometry[]} geometries - GeometryCollection's geometries\n     * @param {Object} [options=null] - options defined in [nGeometryCollection]{@link GeometryCollection#options}\n     */\n    constructor(geometries, opts) {\n        super(opts);\n        this.type = 'GeometryCollection';\n        this.setGeometries(geometries);\n    }\n\n    /**\n     * Set new geometries to the geometry collection\n     * @param {Geometry[]} geometries\n     * @return {GeometryCollection} this\n     * @fires GeometryCollection#shapechange\n     */\n    setGeometries(_geometries) {\n        const geometries = this._checkGeometries(_geometries || []);\n        const symbol = this._getSymbol();\n        const options = this.config();\n        //Set the collection as child geometries' parent.\n        for (let i = geometries.length - 1; i >= 0; i--) {\n            geometries[i]._initOptions(options);\n            geometries[i]._setParent(this);\n            geometries[i]._setEventParent(this);\n            if (symbol) {\n                geometries[i].setSymbol(symbol);\n            }\n        }\n        this._geometries = geometries;\n        if (this.getLayer()) {\n            this._bindGeometriesToLayer();\n            this.onShapeChanged();\n        }\n        return this;\n    }\n\n    /**\n     * Get geometries of the geometry collection\n     * @return {Geometry[]} geometries\n     */\n    getGeometries() {\n        return this._geometries || [];\n    }\n\n    /**\n     * Executes the provided callback once for each geometry present in the collection in order.\n     * @param  {Function} fn             - a callback function\n     * @param  {*} [context=undefined]   - callback's context\n     * @return {GeometryCollection} this\n     */\n    forEach(fn, context) {\n        const geometries = this.getGeometries();\n        for (let i = 0, l = geometries.length; i < l; i++) {\n            if (!geometries[i]) {\n                continue;\n            }\n            if (!context) {\n                fn(geometries[i], i);\n            } else {\n                fn.call(context, geometries[i], i);\n            }\n        }\n        return this;\n    }\n\n    /**\n     * Creates a GeometryCollection with all elements that pass the test implemented by the provided function.\n     * @param  {Function} fn      - Function to test each geometry\n     * @param  {*} [context=undefined]    - Function's context\n     * @return {GeometryCollection} A GeometryCollection with all elements that pass the test\n     * @example\n     * var filtered = collection.filter(['==', 'foo', 'bar]);\n     * @example\n     * var filtered = collection.filter(geometry => geometry.getProperties().foo === 'bar');\n     */\n    filter(fn, context) {\n        if (!fn) {\n            return new GeometryCollection();\n        }\n        const selected = [];\n        const isFn = isFunction(fn);\n        const filter = isFn ? fn : createFilter(fn);\n\n        this.forEach(geometry => {\n            const g = isFn ? geometry : getFilterFeature(geometry);\n            if (context ? filter.call(context, g) : filter(g)) {\n                selected.push(geometry);\n            }\n        }, this);\n\n        return new GeometryCollection(selected);\n    }\n\n    /**\n     * Translate or move the geometry collection by the given offset.\n     * @param  {Coordinate} offset - translate offset\n     * @return {GeometryCollection} this\n     */\n    translate(offset) {\n        if (!offset) {\n            return this;\n        }\n        if (this.isEmpty()) {\n            return this;\n        }\n        const args = arguments;\n        this.forEach(function (geometry) {\n            if (geometry && geometry.translate) {\n                geometry.translate.apply(geometry, args);\n            }\n        });\n        return this;\n    }\n\n    /**\n     * Whether the geometry collection is empty\n     * @return {Boolean}\n     */\n    isEmpty() {\n        return !isArrayHasData(this.getGeometries());\n    }\n\n    /**\n     * remove itself from the layer if any.\n     * @returns {Geometry} this\n     * @fires GeometryCollection#removestart\n     * @fires GeometryCollection#remove\n     * @fires GeometryCollection#removeend\n     */\n    remove() {\n        this.forEach(function (geometry) {\n            geometry._unbind();\n        });\n        return Geometry.prototype.remove.apply(this, arguments);\n    }\n\n    /**\n     * Show the geometry collection.\n     * @return {GeometryCollection} this\n     * @fires GeometryCollection#show\n     */\n    show() {\n        this.options['visible'] = true;\n        this.forEach(function (geometry) {\n            geometry.show();\n        });\n        return this;\n    }\n\n    /**\n     * Hide the geometry collection.\n     * @return {GeometryCollection} this\n     * @fires GeometryCollection#hide\n     */\n    hide() {\n        this.options['visible'] = false;\n        this.forEach(function (geometry) {\n            geometry.hide();\n        });\n        return this;\n    }\n\n    onConfig(config) {\n        this.forEach(function (geometry) {\n            geometry.config(config);\n        });\n    }\n\n    getSymbol() {\n        let s = super.getSymbol();\n        if (!s) {\n            const symbols = [];\n            let is = false;\n            this.forEach(g => {\n                const symbol = g.getSymbol();\n                if (symbol && !is) {\n                    is = true;\n                }\n                symbols.push(g.getSymbol());\n            });\n            if (is) {\n                s =  {\n                    'children' : symbols\n                };\n            }\n        }\n        return s;\n    }\n\n    setSymbol(s) {\n        if (s && s['children']) {\n            this._symbol = null;\n            this.forEach((g, i) => {\n                g.setSymbol(s['children'][i]);\n            });\n        } else {\n            const symbol = this._prepareSymbol(s);\n            this._symbol = symbol;\n            this.forEach(g => {\n                g.setSymbol(symbol);\n            });\n        }\n        this.onSymbolChanged();\n        return this;\n    }\n\n    _setExternSymbol(symbol) {\n        symbol = this._prepareSymbol(symbol);\n        this._externSymbol = symbol;\n        this.forEach(function (geometry) {\n            geometry._setExternSymbol(symbol);\n        });\n        this.onSymbolChanged();\n        return this;\n    }\n\n    /**\n     * bind this geometry collection to a layer\n     * @param  {Layer} layer\n     * @private\n     */\n    _bindLayer() {\n        super._bindLayer.apply(this, arguments);\n        this._bindGeometriesToLayer();\n    }\n\n    _bindGeometriesToLayer() {\n        const layer = this.getLayer();\n        this.forEach(function (geometry) {\n            geometry._bindLayer(layer);\n        });\n    }\n\n    /**\n     * Check whether the type of geometries is valid\n     * @param  {Geometry[]} geometries - geometries to check\n     * @private\n     */\n    _checkGeometries(geometries) {\n        const invalidGeoError = 'The geometry added to collection is invalid.';\n        if (geometries && !Array.isArray(geometries)) {\n            if (geometries instanceof Geometry) {\n                return [geometries];\n            } else {\n                throw new Error(invalidGeoError);\n            }\n        } else {\n            for (let i = 0, l = geometries.length; i < l; i++) {\n                if (!this._checkGeo(geometries[i])) {\n                    throw new Error(invalidGeoError + ' Index: ' + i);\n                }\n            }\n            return geometries;\n        }\n    }\n\n    _checkGeo(geo) {\n        return (geo instanceof Geometry);\n    }\n\n    _updateCache() {\n        this._clearCache();\n        if (this.isEmpty()) {\n            return;\n        }\n        this.forEach(function (geometry) {\n            if (geometry && geometry._updateCache) {\n                geometry._updateCache();\n            }\n        });\n    }\n\n    _removePainter() {\n        if (this._painter) {\n            this._painter.remove();\n        }\n        delete this._painter;\n        this.forEach(function (geometry) {\n            geometry._removePainter();\n        });\n    }\n\n    _computeCenter(projection) {\n        if (!projection || this.isEmpty()) {\n            return null;\n        }\n        let sumX = 0,\n            sumY = 0,\n            counter = 0;\n        const geometries = this.getGeometries();\n        for (let i = 0, l = geometries.length; i < l; i++) {\n            if (!geometries[i]) {\n                continue;\n            }\n            const center = geometries[i]._computeCenter(projection);\n            if (center) {\n                sumX += center.x;\n                sumY += center.y;\n                counter++;\n            }\n        }\n        if (counter === 0) {\n            return null;\n        }\n        return new Coordinate(sumX / counter, sumY / counter);\n    }\n\n    _containsPoint(point, t) {\n        if (this.isEmpty()) {\n            return false;\n        }\n        const geometries = this.getGeometries();\n        for (let i = 0, l = geometries.length; i < l; i++) {\n            if (geometries[i]._containsPoint(point, t)) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    _computeExtent(projection) {\n        return computeExtent.call(this, projection, '_computeExtent');\n    }\n\n    _computePrjExtent(projection) {\n        return computeExtent.call(this, projection, '_computePrjExtent');\n    }\n\n    _computeGeodesicLength(projection) {\n        if (!projection || this.isEmpty()) {\n            return 0;\n        }\n        const geometries = this.getGeometries();\n        let result = 0;\n        for (let i = 0, l = geometries.length; i < l; i++) {\n            if (!geometries[i]) {\n                continue;\n            }\n            result += geometries[i]._computeGeodesicLength(projection);\n        }\n        return result;\n    }\n\n    _computeGeodesicArea(projection) {\n        if (!projection || this.isEmpty()) {\n            return 0;\n        }\n        const geometries = this.getGeometries();\n        let result = 0;\n        for (let i = 0, l = geometries.length; i < l; i++) {\n            if (!geometries[i]) {\n                continue;\n            }\n            result += geometries[i]._computeGeodesicArea(projection);\n        }\n        return result;\n    }\n\n    _exportGeoJSONGeometry() {\n        const children = [];\n        if (!this.isEmpty()) {\n            const geometries = this.getGeometries();\n            for (let i = 0, l = geometries.length; i < l; i++) {\n                if (!geometries[i]) {\n                    continue;\n                }\n                children.push(geometries[i]._exportGeoJSONGeometry());\n            }\n        }\n        return {\n            'type': 'GeometryCollection',\n            'geometries': children\n        };\n    }\n\n    _clearProjection() {\n        if (this.isEmpty()) {\n            return;\n        }\n        const geometries = this.getGeometries();\n        for (let i = 0, l = geometries.length; i < l; i++) {\n            if (!geometries[i]) {\n                continue;\n            }\n            geometries[i]._clearProjection();\n        }\n\n    }\n\n    /**\n     * Get connect points if being connected by [ConnectorLine]{@link ConnectorLine}\n     * @private\n     * @return {Coordinate[]}\n     */\n    _getConnectPoints() {\n        const extent = this.getExtent();\n        const anchors = [\n            new Coordinate(extent.xmin, extent.ymax),\n            new Coordinate(extent.xmax, extent.ymin),\n            new Coordinate(extent.xmin, extent.ymin),\n            new Coordinate(extent.xmax, extent.ymax)\n        ];\n        return anchors;\n    }\n\n    _getExternalResources() {\n        if (this.isEmpty()) {\n            return [];\n        }\n        const geometries = this.getGeometries(),\n            resources = [];\n        const cache = {};\n        let symbol, res, key;\n        for (let i = 0, l = geometries.length; i < l; i++) {\n            if (!geometries[i]) {\n                continue;\n            }\n            symbol = geometries[i]._getInternalSymbol();\n            res = getExternalResources(symbol);\n            for (let ii = 0, ll = res.length; ii < ll; ii++) {\n                key = res[ii].join();\n                if (!cache[key]) {\n                    resources.push(res[ii]);\n                    cache[key] = 1;\n                }\n            }\n        }\n        return resources;\n    }\n\n    //----------Overrides editor methods in Geometry-----------------\n\n    startEdit(opts) {\n        if (this.isEmpty()) {\n            return this;\n        }\n        if (!opts) {\n            opts = {};\n        }\n        if (opts['symbol']) {\n            this._originalSymbol = this.getSymbol();\n            this.setSymbol(opts['symbol']);\n        }\n        this._draggbleBeforeEdit = this.options['draggable'];\n        this.config('draggable', false);\n        const geometries = this.getGeometries();\n        for (let i = 0, l = geometries.length; i < l; i++) {\n            geometries[i].startEdit(opts);\n        }\n        this._editing = true;\n        this.hide();\n        setTimeout(() => {\n            this.fire('editstart');\n        }, 1);\n        return this;\n    }\n\n    endEdit() {\n        if (this.isEmpty()) {\n            return this;\n        }\n        const geometries = this.getGeometries();\n        for (let i = 0, l = geometries.length; i < l; i++) {\n            geometries[i].endEdit();\n        }\n        if (this._originalSymbol) {\n            this.setSymbol(this._originalSymbol);\n            delete this._originalSymbol;\n        }\n        this._editing = false;\n        this.show();\n        this.config('draggable', this._draggbleBeforeEdit);\n        this.fire('editend');\n        return this;\n    }\n\n    isEditing() {\n        if (!this._editing) {\n            return false;\n        }\n        return true;\n    }\n}\n\nGeometryCollection.registerJSONType('GeometryCollection');\n\nexport default GeometryCollection;\n\nfunction computeExtent(projection, fn) {\n    if (this.isEmpty()) {\n        return null;\n    }\n    const geometries = this.getGeometries();\n    let result = null;\n    for (let i = 0, l = geometries.length; i < l; i++) {\n        const geo = geometries[i];\n        if (!geo) {\n            continue;\n        }\n        const geoExtent = geo[fn](projection);\n        if (geoExtent) {\n            result = geoExtent.combine(result);\n        }\n    }\n    return result;\n}\n","import GeometryCollection from './GeometryCollection';\nimport Coordinate from '../geo/Coordinate';\n\n/**\n * The parent class for MultiPoint, MultiLineString and MultiPolygon\n * @category geometry\n * @abstract\n * @extends {GeometryCollection}\n */\nclass MultiGeometry extends GeometryCollection {\n\n    /**\n     * @param  {Class} geoType      Type of the geometry\n     * @param  {String} type        type in String, e.g. \"MultiPoint\", \"MultiLineString\"\n     * @param  {Geometry[]} data    data\n     * @param  {Object} [options=null] configuration options\n     */\n    constructor(geoType, type, data, options) {\n        super(null, options);\n        this.GeometryType = geoType;\n        this.type = type;\n        this._initData(data);\n    }\n\n    /**\n     * Get coordinates of the collection\n     * @return {Coordinate[]|Coordinate[][]|Coordinate[][][]} coordinates\n     */\n    getCoordinates() {\n        const coordinates = [];\n        const geometries = this.getGeometries();\n        for (let i = 0, l = geometries.length; i < l; i++) {\n            const child = geometries[i];\n            coordinates.push(child.getShell && child.getJSONType() !== 'Polygon' ? [child.getShell()] : child.getCoordinates());\n        }\n        return coordinates;\n    }\n\n    /**\n     * Set new coordinates to the collection\n     * @param {Coordinate[]|Coordinate[][]|Coordinate[][][]} coordinates\n     * @returns {Geometry} this\n     * @fires maptalk.Geometry#shapechange\n     */\n    setCoordinates(coordinates) {\n        coordinates = coordinates || [];\n        const geometries = [];\n        for (let i = 0, l = coordinates.length; i < l; i++) {\n            const g = new this.GeometryType(coordinates[i], this.config());\n            geometries.push(g);\n        }\n        this.setGeometries(geometries);\n        return this;\n    }\n\n    _initData(data) {\n        data = data || [];\n        if (data.length) {\n            if (data[0] instanceof this.GeometryType) {\n                this.setGeometries(data);\n            } else {\n                this.setCoordinates(data);\n            }\n        }\n    }\n\n    _checkGeo(geo) {\n        return (geo instanceof this.GeometryType);\n    }\n\n    //override _exportGeoJSONGeometry in GeometryCollection\n    _exportGeoJSONGeometry() {\n        const points = this.getCoordinates();\n        const coordinates = Coordinate.toNumberArrays(points);\n        return {\n            'type': this.getType(),\n            'coordinates': coordinates\n        };\n    }\n}\n\nexport default MultiGeometry;\n","import MultiGeometry from './MultiGeometry';\nimport Marker from './Marker';\n\n/**\n * @classdesc\n * Represents a Geometry type of MultiPoint.\n * @category geometry\n * @extends MultiGeometry\n * @example\n * var multiPoint = new MultiPoint(\n *     [\n *         [121.5080881906138, 31.241128104458117],\n *         [121.50804527526954, 31.237238340103413],\n *         [121.5103728890997, 31.23888972560888]\n *     ]\n * ).addTo(layer);\n */\nclass MultiPoint extends MultiGeometry {\n\n    /**\n     * @param {Number[][]|Coordinate[]|Marker[]} data - construct data, coordinates or an array of markers\n     * @param {Object} [options=null] - options defined in [nMultiPoint]{@link MultiPoint#options}\n     */\n    constructor(data, opts) {\n        super(Marker, 'MultiPoint', data, opts);\n    }\n\n    /**\n     * Find the closet point to the give coordinate\n     * @param {Coordinate} coordinate coordinate\n     * @returns {Coordinate} coordinate\n     */\n    findClosest(coordinate) {\n        if (!coordinate) {\n            return null;\n        }\n        const coords = this.getCoordinates();\n        let hit = null;\n        let max = Infinity;\n        coords.forEach(c => {\n            const dist = distanceTo(c, coordinate);\n            if (dist < max) {\n                hit = c;\n                max = dist;\n            }\n        });\n        return hit;\n    }\n}\n\nMultiPoint.registerJSONType('MultiPoint');\n\nexport default MultiPoint;\n\nfunction distanceTo(p0, p1) {\n    const x = p1.x - p0.x,\n        y = p1.y - p0.y;\n    return Math.sqrt(x * x + y * y);\n}\n","import MultiGeometry from './MultiGeometry';\nimport Coordinate from '../geo/Coordinate';\n\n/**\n * @classdesc\n * An abstract class for MultiPolygon and MultiLineString\n * @category geometry\n * @extends MultiGeometry\n */\nclass MultiPath extends MultiGeometry {\n\n    /**\n     * Get center of (MultiLineString or MultiPolygon)'s intersection with give extent\n     * @example\n     *  const extent = map.getExtent();\n     *  const center = geometry.getCenterInExtent(extent);\n     * @param {Extent} extent\n     * @return {Coordinate} center, null if line doesn't intersect with extent\n     */\n    getCenterInExtent(extent) {\n        const children = this.getGeometries();\n        let [sumx, sumy, counter] = [0, 0, 0];\n        children.forEach(l => {\n            const c = l.getCenterInExtent(extent);\n            if (c) {\n                sumx += c.x * c.count;\n                sumy += c.y * c.count;\n                counter += c.count;\n            }\n        });\n        if (counter === 0) {\n            return null;\n        }\n        return new Coordinate(sumx, sumy)._multi(1 / counter);\n    }\n}\n\n\nexport default MultiPath;\n","import MultiPath from './MultiPath';\nimport LineString from './LineString';\n\n/**\n * @classdesc\n * Represents a Geometry type of MultiLineString\n * @category geometry\n * @extends MultiGeometry\n * @example\n * var multiLineString = new MultiLineString(\n *      [\n *          [\n *              [121.5289450479131, 31.2420083925986],\n *              [121.52860172515919, 31.238926401171824]\n *          ],\n *          [\n *              [121.53091915374796, 31.241898323208233],\n *              [121.53104789978069, 31.23859618183896]\n *          ],\n *          [\n *               [121.5324641061405, 31.241898323208233],\n *               [121.53242119079626, 31.239146546752256]\n *           ]\n *       ],\n *       {\n *           symbol:{\n *               'lineColor' : '#000000',\n *               'lineWidth' : 5,\n *               'lineOpacity' : 1\n *           },\n *          draggable:true\n *      }\n * ).addTo(layer);\n */\nclass MultiLineString extends MultiPath {\n\n    /**\n     * @param {Number[][][]|Coordinate[][]|LineString[]} data - construct data, coordinates or an array of linestrings\n     * @param {Object} [options=null]           - options defined in [MultiLineString]{@link MultiLineString#options}\n     */\n    constructor(data, options) {\n        super(LineString, 'MultiLineString', data, options);\n    }\n}\n\nMultiLineString.registerJSONType('MultiLineString');\n\nexport default MultiLineString;\n","import MultiPath from './MultiPath';\nimport Polygon from './Polygon';\n\n/**\n * @classdesc\n * Represents a Geometry type of MultiPolygon\n * @category geometry\n * @extends MultiGeometry\n * @example\n * var multiPolygon = new MultiPolygon(\n *       [\n *           [\n *               [\n *                   [121.55074604278596, 31.242008515751614],\n *                   [121.55074604278596, 31.23914637638951],\n *                   [121.55349262481711, 31.23914637638951],\n *                   [121.55349262481711, 31.24134802974913],\n *                   [121.5518618417361, 31.241384723537074],\n *                   [121.55074604278596, 31.242008515751614]\n *               ]\n *           ],\n *           [\n *               [\n *                   [121.5543080163576, 31.241054478932387],\n *                   [121.5543938470461, 31.240100432478293],\n *                   [121.55555256134048, 31.240173821009137],\n *                   [121.55542381530773, 31.240981091085693],\n *                   [121.5543080163576, 31.241054478932387]\n *               ]\n *           ]\n *\n *       ],\n *       {\n *           symbol:{\n *               'lineColor' : '#000000',\n *               'lineWidth' : 2,\n *               'lineDasharray' : null,//线形\n *               'lineOpacity' : 1,\n *               'polygonFill' : 'rgb(255, 0, 0)',\n *               'polygonOpacity' : 0.8\n *           },\n *           draggable:true\n * }).addTo(layer);\n */\nclass MultiPolygon extends MultiPath {\n\n    /**\n     * @param {Number[][][][]|Coordinate[][][]|Polygon[]} data - construct data, coordinates or an array of polygons\n     * @param {Object} [options=null]           - options defined in [MultiPolygon]{@link MultiPolygon#options}\n     */\n    constructor(data, opts) {\n        super(Polygon, 'MultiPolygon', data, opts);\n    }\n}\n\nMultiPolygon.registerJSONType('MultiPolygon');\n\nexport default MultiPolygon;\n","import {\n    isNil,\n    isString,\n    parseJSON,\n    isArrayHasData,\n    pushIn\n} from '../core/util';\nimport Marker from './Marker';\nimport LineString from './LineString';\nimport Polygon from './Polygon';\nimport MultiPoint from './MultiPoint';\nimport MultiLineString from './MultiLineString';\nimport MultiPolygon from './MultiPolygon';\nimport GeometryCollection from './GeometryCollection';\n\nconst types = {\n    'Marker': Marker,\n    'LineString': LineString,\n    'Polygon': Polygon,\n    'MultiPoint': MultiPoint,\n    'MultiLineString': MultiLineString,\n    'MultiPolygon': MultiPolygon\n};\n\n/**\n * GeoJSON utilities\n * @class\n * @category geometry\n * @name GeoJSON\n */\nconst GeoJSON = {\n\n    /**\n     * Convert one or more GeoJSON objects to geometry\n     * @param  {String|Object|Object[]} geoJSON - GeoJSON objects or GeoJSON string\n     * @param  {Function} [foreachFn=undefined] - callback function for each geometry\n     * @return {Geometry|Geometry[]} a geometry array when input is a FeatureCollection\n     * @example\n     * var collection = {\n     *      \"type\": \"FeatureCollection\",\n     *      \"features\": [\n     *          { \"type\": \"Feature\",\n     *            \"geometry\": {\"type\": \"Point\", \"coordinates\": [102.0, 0.5]},\n     *            \"properties\": {\"prop0\": \"value0\"}\n     *           },\n     *           { \"type\": \"Feature\",\n     *             \"geometry\": {\n     *                 \"type\": \"LineString\",\n     *                 \"coordinates\": [\n     *                     [102.0, 0.0], [103.0, 1.0], [104.0, 0.0], [105.0, 1.0]\n     *                 ]\n     *             },\n     *             \"properties\": {\n     *                 \"prop0\": \"value0\",\n     *                 \"prop1\": 0.0\n     *             }\n     *           },\n     *           { \"type\": \"Feature\",\n     *             \"geometry\": {\n     *                 \"type\": \"Polygon\",\n     *                 \"coordinates\": [\n     *                     [ [100.0, 0.0], [101.0, 0.0], [101.0, 1.0],\n     *                       [100.0, 1.0], [100.0, 0.0] ]\n     *                 ]\n     *             },\n     *             \"properties\": {\n     *                 \"prop0\": \"value0\",\n     *                 \"prop1\": {\"this\": \"that\"}\n     *             }\n     *          }\n     *      ]\n     *  }\n     *  // A geometry array.\n     *  const geometries = GeoJSON.toGeometry(collection, geometry => { geometry.config('draggable', true); });\n     */\n    toGeometry: function (geoJSON, foreachFn) {\n        if (isString(geoJSON)) {\n            geoJSON = parseJSON(geoJSON);\n        }\n        if (Array.isArray(geoJSON)) {\n            const resultGeos = [];\n            for (let i = 0, len = geoJSON.length; i < len; i++) {\n                const geo = GeoJSON._convert(geoJSON[i], foreachFn);\n                if (Array.isArray(geo)) {\n                    pushIn(resultGeos, geo);\n                } else {\n                    resultGeos.push(geo);\n                }\n            }\n            return resultGeos;\n        } else {\n            const resultGeo = GeoJSON._convert(geoJSON, foreachFn);\n            return resultGeo;\n        }\n\n    },\n\n    /**\n     * Convert single GeoJSON object\n     * @param  {Object} geoJSONObj - a GeoJSON object\n     * @return {Geometry}\n     * @private\n     */\n    _convert: function (json, foreachFn) {\n        if (!json || isNil(json['type'])) {\n            return null;\n        }\n\n        const type = json['type'];\n        if (type === 'Feature') {\n            const g = json['geometry'];\n            const geometry = GeoJSON._convert(g, foreachFn);\n            if (!geometry) {\n                return null;\n            }\n            geometry.setId(json['id']);\n            geometry.setProperties(json['properties']);\n            return geometry;\n        } else if (type === 'FeatureCollection') {\n            const features = json['features'];\n            if (!features) {\n                return null;\n            }\n            return GeoJSON.toGeometry(features, foreachFn);\n        } else if (['Point', 'LineString', 'Polygon', 'MultiPoint', 'MultiLineString', 'MultiPolygon'].indexOf(type) >= 0) {\n            const clazz = (type === 'Point' ? 'Marker' : type);\n            const result = new types[clazz](json['coordinates']);\n            if (foreachFn) {\n                foreachFn(result);\n            }\n            return result;\n        } else if (type === 'GeometryCollection') {\n            const geometries = json['geometries'];\n            if (!isArrayHasData(geometries)) {\n                const result = new GeometryCollection();\n                if (foreachFn) {\n                    foreachFn(result);\n                }\n                return result;\n            }\n            const mGeos = [];\n            const size = geometries.length;\n            for (let i = 0; i < size; i++) {\n                mGeos.push(GeoJSON._convert(geometries[i]));\n            }\n            const result = new GeometryCollection(mGeos);\n            if (foreachFn) {\n                foreachFn(result);\n            }\n            return result;\n        }\n        return null;\n    }\n};\n\nexport default GeoJSON;\n","import { extend, isNil } from '../core/util';\nimport { withInEllipse } from '../core/util/path';\nimport Coordinate from '../geo/Coordinate';\nimport Extent from '../geo/Extent';\nimport CenterMixin from './CenterMixin';\nimport Polygon from './Polygon';\n\n/**\n * @property {Object} options\n * @property {Number} [options.numberOfShellPoints=60]   - number of shell points when converting the circle to a polygon.\n * @memberOf Circle\n * @instance\n */\nconst options = {\n    'numberOfShellPoints': 60\n};\n\n/**\n * @classdesc\n * Represents a Circle Geometry. <br>\n * @category geometry\n * @extends Polygon\n * @mixes Geometry.Center\n * @example\n * var circle = new Circle([100, 0], 1000, {\n *     id : 'circle0',\n *     properties : {\n *         foo : 'bar'\n *     }\n * });\n * @mixes CenterMixin\n */\nclass Circle extends CenterMixin(Polygon) {\n\n    static fromJSON(json) {\n        const feature = json['feature'];\n        const circle = new Circle(json['coordinates'], json['radius'], json['options']);\n        circle.setProperties(feature['properties']);\n        return circle;\n    }\n\n    /**\n     * @param {Coordinate} center - center of the circle\n     * @param {Number} radius           - radius of the circle, in meter\n     * @param {Object} [options=null]   - construct options defined in [Circle]{@link Circle#options}\n     */\n    constructor(coordinates, radius, opts) {\n        super(null, opts);\n        if (coordinates) {\n            this.setCoordinates(coordinates);\n        }\n        this._radius = radius;\n    }\n\n    /**\n     * Get radius of the circle\n     * @return {Number}\n     */\n    getRadius() {\n        return this._radius;\n    }\n\n    /**\n     * Set a new radius to the circle\n     * @param {Number} radius - new radius\n     * @return {Circle} this\n     * @fires Circle#shapechange\n     */\n    setRadius(radius) {\n        this._radius = radius;\n        this.onShapeChanged();\n        return this;\n    }\n\n    /**\n     * Gets the shell of the circle as a polygon, number of the shell points is decided by [options.numberOfShellPoints]{@link Circle#options}\n     * @return {Coordinate[]} - shell coordinates\n     */\n    getShell() {\n        const measurer = this._getMeasurer(),\n            center = this.getCoordinates(),\n            numberOfPoints = this.options['numberOfShellPoints'],\n            radius = this.getRadius();\n        const shell = [];\n        let rad, dx, dy;\n        for (let i = 0, len = numberOfPoints - 1; i < len; i++) {\n            rad = (360 * i / len) * Math.PI / 180;\n            dx = radius * Math.cos(rad);\n            dy = radius * Math.sin(rad);\n            const vertex = measurer.locate(center, dx, dy);\n            shell.push(vertex);\n        }\n        shell.push(shell[0]);\n        return shell;\n    }\n\n    /**\n     * Circle won't have any holes, always returns null\n     * @return {Object[]} an empty array\n     */\n    getHoles() {\n        return [];\n    }\n\n    animateShow() {\n        return this.show();\n    }\n\n    _containsPoint(point, tolerance) {\n        const map = this.getMap();\n        if (map.getPitch()) {\n            return super._containsPoint(point, tolerance);\n        }\n        const center = map._pointToContainerPoint(this._getCenter2DPoint()),\n            size = this.getSize(),\n            t = isNil(tolerance) ? this._hitTestTolerance() : tolerance,\n            se = center.add(size.width / 2, size.height / 2);\n        return withInEllipse(point, center, se, t);\n    }\n\n    _computePrjExtent(projection) {\n        const minmax = this._getMinMax(projection);\n        if (!minmax) {\n            return null;\n        }\n        const pcenter = this._getPrjCoordinates();\n        const pminmax = minmax.map(c => projection.project(c));\n        const dx = Math.min(Math.abs(pminmax[0].x - pcenter.x), Math.abs(pminmax[1].x - pcenter.x)),\n            dy = Math.min(Math.abs(pminmax[2].y - pcenter.y), Math.abs(pminmax[3].y - pcenter.y));\n        return new Extent(pcenter.sub(dx, dy), pcenter.add(dx, dy));\n    }\n\n    _computeExtent(measurer) {\n        const minmax = this._getMinMax(measurer);\n        if (!minmax) {\n            return null;\n        }\n        return new Extent(minmax[0].x, minmax[2].y, minmax[1].x, minmax[3].y, this._getProjection());\n    }\n\n    _getMinMax(measurer) {\n        if (!measurer || !this._coordinates || isNil(this._radius)) {\n            return null;\n        }\n        const radius = this._radius;\n        const p1 = measurer.locate(this._coordinates, -radius, 0),\n            p2 = measurer.locate(this._coordinates, radius, 0),\n            p3 = measurer.locate(this._coordinates, 0, radius),\n            p4 = measurer.locate(this._coordinates, 0, -radius);\n        return [p1, p2, p3, p4];\n    }\n\n    _computeGeodesicLength() {\n        if (isNil(this._radius)) {\n            return 0;\n        }\n        return Math.PI * 2 * this._radius;\n    }\n\n    _computeGeodesicArea() {\n        if (isNil(this._radius)) {\n            return 0;\n        }\n        return Math.PI * Math.pow(this._radius, 2);\n    }\n\n    _exportGeoJSONGeometry() {\n        const coordinates = Coordinate.toNumberArrays([this.getShell()]);\n        return {\n            'type': 'Polygon',\n            'coordinates': coordinates\n        };\n    }\n\n    _toJSON(options) {\n        const center = this.getCenter();\n        const opts = extend({}, options);\n        opts.geometry = false;\n        const feature = this.toGeoJSON(opts);\n        feature['geometry'] = {\n            'type': 'Polygon'\n        };\n        return {\n            'feature': feature,\n            'subType': 'Circle',\n            'coordinates': [center.x, center.y],\n            'radius': this.getRadius()\n        };\n    }\n\n}\n\nCircle.mergeOptions(options);\n\nCircle.registerJSONType('Circle');\n\nexport default Circle;\n","import { extend, isNil } from '../core/util';\nimport { withInEllipse } from '../core/util/path';\nimport Coordinate from '../geo/Coordinate';\nimport CenterMixin from './CenterMixin';\nimport Polygon from './Polygon';\nimport Circle from './Circle';\n\n/**\n * @property {Object} [options=null]\n * @property {Number} [options.numberOfShellPoints=60]   - number of shell points when exporting the ellipse's shell coordinates as a polygon.\n * @memberOf Ellipse\n * @instance\n */\nconst options = {\n    'numberOfShellPoints': 80\n};\n\n/**\n * Represents a Ellipse Geometry. <br>\n * @category geometry\n * @extends Polygon\n * @mixes CenterMixin\n * @example\n * var ellipse = new Ellipse([100, 0], 1000, 500, {\n *     id : 'ellipse0'\n * });\n */\nclass Ellipse extends CenterMixin(Polygon) {\n\n    static fromJSON(json) {\n        const feature = json['feature'];\n        const ellipse = new Ellipse(json['coordinates'], json['width'], json['height'], json['options']);\n        ellipse.setProperties(feature['properties']);\n        return ellipse;\n    }\n\n    /**\n     * @param {Coordinate} center  - center of the ellipse\n     * @param {Number} width  - width of the ellipse, in meter\n     * @param {Number} height - height of the ellipse, in meter\n     * @param {Object}  [options=null] - construct options defined in [Ellipse]{@link Ellipse#options}\n     */\n    constructor(coordinates, width, height, opts) {\n        super(null, opts);\n        if (coordinates) {\n            this.setCoordinates(coordinates);\n        }\n        this.width = width;\n        this.height = height;\n    }\n\n    /**\n     * Get ellipse's width\n     * @return {Number}\n     */\n    getWidth() {\n        return this.width;\n    }\n\n    /**\n     * Set new width to ellipse\n     * @param {Number} width - new width\n     * @fires Ellipse#shapechange\n     * @return {Ellipse} this\n     */\n    setWidth(width) {\n        this.width = width;\n        this.onShapeChanged();\n        return this;\n    }\n\n    /**\n     * Get ellipse's height\n     * @return {Number}\n     */\n    getHeight() {\n        return this.height;\n    }\n\n    /**\n     * Set new height to ellipse\n     * @param {Number} height - new height\n     * @fires Ellipse#shapechange\n     * @return {Ellipse} this\n     */\n    setHeight(height) {\n        this.height = height;\n        this.onShapeChanged();\n        return this;\n    }\n\n    /**\n     * Gets the shell of the ellipse as a polygon, number of the shell points is decided by [options.numberOfShellPoints]{@link Circle#options}\n     * @return {Coordinate[]} - shell coordinates\n     */\n    getShell() {\n        const measurer = this._getMeasurer(),\n            center = this.getCoordinates(),\n            numberOfPoints = this.options['numberOfShellPoints'],\n            width = this.getWidth(),\n            height = this.getHeight();\n        const shell = [];\n        const s = Math.pow(width / 2, 2) * Math.pow(height / 2, 2),\n            sx = Math.pow(width / 2, 2),\n            sy = Math.pow(height / 2, 2);\n        let deg, rad, dx, dy;\n        for (let i = 0; i < numberOfPoints; i++) {\n            deg = 360 * i / numberOfPoints;\n            rad = deg * Math.PI / 180;\n            dx = Math.sqrt(s / (sx * Math.pow(Math.tan(rad), 2) + sy));\n            dy = Math.sqrt(s / (sy * Math.pow(1 / Math.tan(rad), 2) + sx));\n            if (deg > 90 && deg < 270) {\n                dx *= -1;\n            }\n            if (deg > 180 && deg < 360) {\n                dy *= -1;\n            }\n            const vertex = measurer.locate(center, dx, dy);\n            shell.push(vertex);\n        }\n        return shell;\n    }\n\n    /**\n     * Ellipse won't have any holes, always returns null\n     * @return {Object[]} an empty array\n     */\n    getHoles() {\n        return [];\n    }\n\n    animateShow() {\n        return this.show();\n    }\n\n    _containsPoint(point, tolerance) {\n        const map = this.getMap();\n        if (map.isTransforming()) {\n            return super._containsPoint(point, tolerance);\n        }\n        const projection = map.getProjection();\n        const t = isNil(tolerance) ? this._hitTestTolerance() : tolerance,\n            pps = projection.projectCoords([this._coordinates, map.locate(this._coordinates, this.getWidth() / 2, this.getHeight() / 2)]),\n            p0 = map._prjToContainerPoint(pps[0]),\n            p1 = map._prjToContainerPoint(pps[1]);\n        return withInEllipse(point, p0, p1, t);\n    }\n\n    _computePrjExtent() {\n        return Circle.prototype._computePrjExtent.apply(this, arguments);\n    }\n\n    _computeExtent() {\n        return Circle.prototype._computeExtent.apply(this, arguments);\n    }\n\n    _getMinMax(measurer) {\n        if (!measurer || !this._coordinates || isNil(this.width) || isNil(this.height)) {\n            return null;\n        }\n        const width = this.getWidth(),\n            height = this.getHeight();\n        const p1 = measurer.locate(this._coordinates, -width / 2, 0),\n            p2 = measurer.locate(this._coordinates, width / 2, 0),\n            p3 = measurer.locate(this._coordinates, 0, -height / 2),\n            p4 = measurer.locate(this._coordinates, 0, height / 2);\n        return [p1, p2, p3, p4];\n    }\n\n    _computeGeodesicLength() {\n        if (isNil(this.width) || isNil(this.height)) {\n            return 0;\n        }\n        //L=2πb+4(a-b)\n        //近似值\n        const longer = (this.width > this.height ? this.width : this.height);\n        return 2 * Math.PI * longer / 2 - 4 * Math.abs(this.width - this.height);\n    }\n\n    _computeGeodesicArea() {\n        if (isNil(this.width) || isNil(this.height)) {\n            return 0;\n        }\n        return Math.PI * this.width * this.height / 4;\n    }\n\n    _exportGeoJSONGeometry() {\n        const coordinates = Coordinate.toNumberArrays([this.getShell()]);\n        return {\n            'type': 'Polygon',\n            'coordinates': coordinates\n        };\n    }\n\n    _toJSON(options) {\n        const opts = extend({}, options);\n        const center = this.getCenter();\n        opts.geometry = false;\n        const feature = this.toGeoJSON(opts);\n        feature['geometry'] = {\n            'type': 'Polygon'\n        };\n        return {\n            'feature': feature,\n            'subType': 'Ellipse',\n            'coordinates': [center.x, center.y],\n            'width': this.getWidth(),\n            'height': this.getHeight()\n        };\n    }\n\n}\n\nEllipse.mergeOptions(options);\n\nEllipse.registerJSONType('Ellipse');\n\nexport default Ellipse;\n","import { extend, isNil } from '../core/util';\nimport Coordinate from '../geo/Coordinate';\nimport Extent from '../geo/Extent';\nimport Polygon from './Polygon';\n\n/**\n * @classdesc\n * Represents a Rectangle geometry.\n * @category geometry\n * @extends Polygon\n * @example\n * var rectangle = new Rectangle([100, 0], 1000, 500, {\n *     id : 'rectangle0'\n * });\n */\nclass Rectangle extends Polygon {\n\n    static fromJSON(json) {\n        const feature = json['feature'];\n        const rect = new Rectangle(json['coordinates'], json['width'], json['height'], json['options']);\n        rect.setProperties(feature['properties']);\n        return rect;\n    }\n\n    /**\n     * @param {Coordinate} coordinates  - northwest of the rectangle\n     * @param {Number} width                     - width of the rectangle, in meter\n     * @param {Number} height                    - height of the rectangle, in meter\n     * @param {Object} [options=null]            - options defined in [Rectangle]{@link Rectangle#options}\n     */\n    constructor(coordinates, width, height, opts) {\n        super(null, opts);\n        if (coordinates) {\n            this.setCoordinates(coordinates);\n        }\n        this._width = width;\n        this._height = height;\n    }\n\n    /**\n     * Get coordinates of rectangle's northwest\n     * @return {Coordinate}\n     */\n    getCoordinates() {\n        return this._coordinates;\n    }\n\n    /**\n     * Set a new coordinate for northwest of the rectangle\n     * @param {Coordinate} nw - coordinates of new northwest\n     * @return {Rectangle} this\n     * @fires Rectangle#positionchange\n     */\n    setCoordinates(nw) {\n        this._coordinates = (nw instanceof Coordinate) ? nw : new Coordinate(nw);\n        if (!this._coordinates || !this.getMap()) {\n            this.onPositionChanged();\n            return this;\n        }\n        const projection = this._getProjection();\n        this._setPrjCoordinates(projection.project(this._coordinates));\n        return this;\n    }\n\n    /**\n     * Get rectangle's width\n     * @return {Number}\n     */\n    getWidth() {\n        return this._width;\n    }\n\n    /**\n     * Set new width to the rectangle\n     * @param {Number} width - new width\n     * @fires Rectangle#shapechange\n     * @return {Rectangle} this\n     */\n    setWidth(width) {\n        this._width = width;\n        this.onShapeChanged();\n        return this;\n    }\n\n    /**\n     * Get rectangle's height\n     * @return {Number}\n     */\n    getHeight() {\n        return this._height;\n    }\n\n    /**\n     * Set new height to rectangle\n     * @param {Number} height - new height\n     * @fires Rectangle#shapechange\n     * @return {Rectangle} this\n     */\n    setHeight(height) {\n        this._height = height;\n        this.onShapeChanged();\n        return this;\n    }\n\n    /**\n     * Gets the shell of the rectangle as a polygon\n     * @return {Coordinate[]} - shell coordinates\n     */\n    getShell() {\n        const measurer = this._getMeasurer();\n        const nw = this._coordinates;\n        const map = this.getMap();\n        let sx = 1,\n            sy = -1;\n        if (map) {\n            const fExt = map.getFullExtent();\n            if (fExt['left'] > fExt['right']) {\n                sx = -1;\n            }\n            if (fExt['bottom'] > fExt['top']) {\n                sy = 1;\n            }\n        }\n        const points = [];\n        points.push(nw);\n        points.push(measurer.locate(nw, sx * this._width, 0));\n        points.push(measurer.locate(nw, sx * this._width, sy * this._height));\n        points.push(measurer.locate(nw, 0, sy * this._height));\n        points.push(nw);\n        return points;\n\n    }\n\n    /**\n     * Rectangle won't have any holes, always returns null\n     * @return {Object[]} an empty array\n     */\n    getHoles() {\n        return [];\n    }\n\n    animateShow() {\n        return this.show();\n    }\n\n    _getPrjCoordinates() {\n        const projection = this._getProjection();\n        if (!projection) {\n            return null;\n        }\n        this._verifyProjection();\n        if (!this._pnw) {\n            if (this._coordinates) {\n                this._pnw = projection.project(this._coordinates);\n            }\n        }\n        return this._pnw;\n    }\n\n    _setPrjCoordinates(pnw) {\n        this._pnw = pnw;\n        this.onPositionChanged();\n    }\n\n    _getPrjShell() {\n        const shell = super._getPrjShell();\n        const projection = this._getProjection();\n        if (!projection.isSphere()) {\n            return shell;\n        }\n        const sphereExtent = projection.getSphereExtent(),\n            sx = sphereExtent.sx,\n            sy = sphereExtent.sy;\n        const circum = this._getProjection().getCircum();\n        const nw = shell[0];\n        for (let i = 1, l = shell.length; i < l; i++) {\n            const p = shell[i];\n            let dx = 0, dy = 0;\n            if (sx * (nw.x - p.x) > 0) {\n                dx = circum.x * sx;\n            }\n            if (sy * (nw.y - p.y) < 0) {\n                dy = circum.y * sy;\n            }\n            shell[i]._add(dx, dy);\n        }\n        return shell;\n    }\n\n    //update cached variables if geometry is updated.\n    _updateCache() {\n        this._clearCache();\n        const projection = this._getProjection();\n        if (this._pnw && projection) {\n            this._coordinates = projection.unproject(this._pnw);\n        }\n    }\n\n    _clearProjection() {\n        this._pnw = null;\n        super._clearProjection();\n    }\n\n    _computeCenter(measurer) {\n        return measurer.locate(this._coordinates, this._width / 2, -this._height / 2);\n    }\n\n    _containsPoint(point, tolerance) {\n        const map = this.getMap();\n        if (map.isTransforming()) {\n            return super._containsPoint(point, tolerance);\n        }\n        const t = isNil(tolerance) ? this._hitTestTolerance() : tolerance,\n            r = map._getResolution() * t;\n        const extent = this._getPrjExtent().expand(r);\n        const p = map._containerPointToPrj(point);\n        return extent.contains(p);\n    }\n\n    _computePrjExtent(projection) {\n        const se = this._getSouthEast(projection);\n        if (!se) {\n            return null;\n        }\n        const prjs = projection.projectCoords([\n            new Coordinate(this._coordinates.x, se.y),\n            new Coordinate(se.x, this._coordinates.y)\n        ]);\n        return new Extent(prjs[0], prjs[1]);\n    }\n\n    _computeExtent(measurer) {\n        const se = this._getSouthEast(measurer);\n        if (!se) {\n            return null;\n        }\n        return new Extent(this._coordinates, se, this._getProjection());\n    }\n\n    _getSouthEast(measurer) {\n        if (!measurer || !this._coordinates || isNil(this._width) || isNil(this._height)) {\n            return null;\n        }\n        const width = this.getWidth(),\n            height = this.getHeight();\n        let w = width, h = -height;\n        if (measurer.fullExtent) {\n            const fullExtent = measurer.fullExtent,\n                sx = fullExtent.right > fullExtent.left ? 1 : -1,\n                sy = fullExtent.top > fullExtent.bottom ? 1 : -1;\n            w *= sx;\n            h *= sy;\n        }\n        const se = measurer.locate(this._coordinates, w, h);\n        return se;\n    }\n\n    _computeGeodesicLength() {\n        if (isNil(this._width) || isNil(this._height)) {\n            return 0;\n        }\n        return 2 * (this._width + this._height);\n    }\n\n    _computeGeodesicArea() {\n        if (isNil(this._width) || isNil(this._height)) {\n            return 0;\n        }\n        return this._width * this._height;\n    }\n\n    _exportGeoJSONGeometry() {\n        const coordinates = Coordinate.toNumberArrays([this.getShell()]);\n        return {\n            'type': 'Polygon',\n            'coordinates': coordinates\n        };\n    }\n\n    _toJSON(options) {\n        const opts = extend({}, options);\n        const nw = this.getCoordinates();\n        opts.geometry = false;\n        const feature = this.toGeoJSON(opts);\n        feature['geometry'] = {\n            'type': 'Polygon'\n        };\n        return {\n            'feature': feature,\n            'subType': 'Rectangle',\n            'coordinates': [nw.x, nw.y],\n            'width': this.getWidth(),\n            'height': this.getHeight()\n        };\n    }\n\n}\n\nRectangle.registerJSONType('Rectangle');\n\nexport default Rectangle;\n","import { extend, isNil } from '../core/util';\nimport Circle from './Circle';\n\n/**\n * @property {Object} options -\n * @property {Number} [options.numberOfShellPoints=60]   - number of shell points when converting the sector to a polygon.\n * @memberOf Sector\n * @instance\n */\nconst options = {\n    'numberOfShellPoints': 60\n};\n\n/**\n * @classdesc\n * Represents a sector Geometry.\n * @category geometry\n * @extends Circle\n * @example\n * var sector = new Sector([100, 0], 1000, 30, 120, {\n *     id : 'sector0'\n * });\n */\nclass Sector extends Circle {\n\n    static fromJSON(json) {\n        const feature = json['feature'];\n        const sector = new Sector(json['coordinates'], json['radius'], json['startAngle'], json['endAngle'], json['options']);\n        sector.setProperties(feature['properties']);\n        return sector;\n    }\n\n    /**\n     * @param {Coordinate} center - center of the sector\n     * @param {Number} radius           - radius of the sector, in meter\n     * @param {Number} startAngle       - start angle of the sector, in degree\n     * @param {Number} endAngle         - end angle of the sector, in degree\n     * @param {Object} [options=null]   - construct options defined in [Sector]{@link Sector#options}\n     */\n    constructor(coordinates, radius, startAngle, endAngle, opts) {\n        super(coordinates, radius, opts);\n        this.startAngle = startAngle;\n        this.endAngle = endAngle;\n    }\n\n    /**\n     * Get the sector's start angle\n     * @return {Number}\n     */\n    getStartAngle() {\n        return this.startAngle;\n    }\n\n    /**\n     * Set a new start angle to the sector\n     * @param {Number} startAngle\n     * @return {Sector} this\n     * @fires Sector#shapechange\n     */\n    setStartAngle(startAngle) {\n        this.startAngle = startAngle;\n        this.onShapeChanged();\n        return this;\n    }\n\n    /**\n     * Get the sector's end angle\n     * @return {Number}\n     */\n    getEndAngle() {\n        return this.endAngle;\n    }\n\n    /**\n     * Set a new end angle to the sector\n     * @param {Number} endAngle\n     * @return {Sector} this\n     * @fires Sector#shapechange\n     */\n    setEndAngle(endAngle) {\n        this.endAngle = endAngle;\n        this.onShapeChanged();\n        return this;\n    }\n\n    /**\n     * Gets the shell of the sector as a polygon, number of the shell points is decided by [options.numberOfShellPoints]{@link Sector#options}\n     * @return {Coordinate[]} - shell coordinates\n     */\n    getShell() {\n        const measurer = this._getMeasurer(),\n            center = this.getCoordinates(),\n            numberOfPoints = this.options['numberOfShellPoints'] - 2,\n            radius = this.getRadius(),\n            shell = [center.copy()],\n            startAngle = this.getStartAngle(),\n            angle = this.getEndAngle() - startAngle;\n        let rad, dx, dy;\n        for (let i = 0; i < numberOfPoints; i++) {\n            rad = (angle * i / (numberOfPoints - 1) + startAngle) * Math.PI / 180;\n            dx = radius * Math.cos(rad);\n            dy = radius * Math.sin(rad);\n            const vertex = measurer.locate(center, dx, dy);\n            shell.push(vertex);\n        }\n        shell.push(center.copy());\n        return shell;\n    }\n\n    _containsPoint(point, tolerance) {\n        const map = this.getMap();\n        if (map.isTransforming()) {\n            return super._containsPoint(point, tolerance);\n        }\n        const center = map._pointToContainerPoint(this._getCenter2DPoint()),\n            t = isNil(tolerance) ? this._hitTestTolerance() : tolerance,\n            size = this.getSize(),\n            pc = center,\n            pp = point,\n            x = pp.x - pc.x,\n            y = pc.y - pp.y,\n            atan2 = Math.atan2(y, x),\n            // [0.0, 360.0)\n            angle = atan2 < 0 ? (atan2 + 2 * Math.PI) * 360 / (2 * Math.PI) :\n                atan2 * 360 / (2 * Math.PI);\n        const sAngle = this.startAngle % 360,\n            eAngle = this.endAngle % 360;\n        let between = false;\n        if (sAngle > eAngle) {\n            between = !(angle > eAngle && angle < sAngle);\n        } else {\n            between = (angle >= sAngle && angle <= eAngle);\n        }\n        return pp.distanceTo(pc) <= (size.width / 2 + t) && between;\n    }\n\n    _computeGeodesicLength() {\n        if (isNil(this._radius)) {\n            return 0;\n        }\n        return Math.PI * 2 * this._radius * Math.abs(this.startAngle - this.endAngle) / 360 + 2 * this._radius;\n    }\n\n    _computeGeodesicArea() {\n        if (isNil(this._radius)) {\n            return 0;\n        }\n        return Math.PI * Math.pow(this._radius, 2) * Math.abs(this.startAngle - this.endAngle) / 360;\n    }\n\n    _toJSON(options) {\n        const opts = extend({}, options);\n        const center = this.getCenter();\n        opts.geometry = false;\n        const feature = this.toGeoJSON(opts);\n        feature['geometry'] = {\n            'type': 'Polygon'\n        };\n        return {\n            'feature': feature,\n            'subType': 'Sector',\n            'coordinates': [center.x, center.y],\n            'radius': this.getRadius(),\n            'startAngle': this.getStartAngle(),\n            'endAngle': this.getEndAngle()\n        };\n    }\n\n}\n\nSector.mergeOptions(options);\n\nSector.registerJSONType('Sector');\n\nexport default Sector;\n","import LineString from './LineString';\nimport Canvas2d from '../core/Canvas';\n\nconst options = {\n    'enableSimplify' : false,\n    'enableClip' : false\n};\n\n/**\n * Curve style LineString, an abstract parent class for all the curves.\n * @category geometry\n * @abstract\n * @extends LineString\n * @param {Coordinate[]|Number[][]} coordinates - coordinates of the line string\n * @param {Object} [options=null] - construct options defined in [LineString]{@link LineString#options}\n * @property {Boolean} [options.enableSimplify=false] - whether to simplify path before rendering\n * @property {Boolean} [options.enableClip=false] - whether to clip curve with map's current extent\n */\nclass Curve extends LineString {\n\n    _arc(ctx, points, lineOpacity) {\n        const degree = this.options['arcDegree'] * Math.PI / 180;\n        for (let i = 1, l = points.length; i < l; i++) {\n            const c = Canvas2d._arcBetween(ctx, points[i - 1], points[i], degree);\n            //add control points to caculate normal of arrow\n            const ctrlPoint = [(points[i - 1].x + points[i].x) - c[0], (points[i - 1].y + points[i].y) - c[1]];\n            points[i - 1].nextCtrlPoint = ctrlPoint;\n            points[i].prevCtrlPoint = ctrlPoint;\n            Canvas2d._stroke(ctx, lineOpacity);\n        }\n    }\n\n    _quadraticCurve(ctx, points) {\n        if (points.length <= 2) {\n            Canvas2d._path(ctx, points);\n            return;\n        }\n        let i, l;\n        for (i = 2, l = points.length; i < l; i += 2) {\n            ctx.quadraticCurveTo(points[i - 1].x, points[i - 1].y, points[i].x, points[i].y);\n        }\n        i -= 1;\n        if (i < l) {\n            for (;i < l; i++) {\n                ctx.lineTo(points[i].x, points[i].y);\n            }\n        }\n    }\n\n    _bezierCurve(ctx, points) {\n        if (points.length <= 3) {\n            Canvas2d._path(ctx, points);\n            return;\n        }\n        let i, l;\n        for (i = 1, l = points.length; i + 2 < l; i += 3) {\n            ctx.bezierCurveTo(points[i].x, points[i].y, points[i + 1].x, points[i + 1].y, points[i + 2].x, points[i + 2].y);\n        }\n        if (i < l) {\n            for (; i < l; i++) {\n                ctx.lineTo(points[i].x, points[i].y);\n            }\n        }\n    }\n\n    _getCurveArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance, step) {\n        const l = segments.length;\n        let i;\n        for (i = step; i < l; i += step) {\n            arrows.push(this._getArrowShape(segments[i - 1], segments[i], lineWidth, arrowStyle, tolerance));\n        }\n        i -= step;\n        if (i < l - 1) {\n            for (i += 1; i < l; i++) {\n                arrows.push(this._getArrowShape(segments[i - 1], segments[i], lineWidth, arrowStyle, tolerance));\n            }\n        }\n    }\n}\n\nCurve.mergeOptions(options);\n\nexport default Curve;\n","import Curve from './Curve';\nimport Canvas from '../core/Canvas';\n\n/**\n * @property {Object} options\n * @property {Number} [options.arcDegree=90]           - circle arc's degree.\n * @memberOf ArcCurve\n * @instance\n */\nconst options = {\n    'arcDegree': 90\n};\n\n/**\n * @classdesc\n * Circle Arc Curve\n * @category geometry\n * @extends Curve\n * @param {Coordinate[]|Number[][]} coordinates - coordinates of the curve\n * @param {Object} [options=null]   - construct options defined in [ArcCurve]{@link ArcCurve#options}\n * @example\n * var curve = new ArcCurve(\n *     [\n *         [121.47083767181408,31.214448123476995],\n *         [121.4751292062378,31.215475523000404],\n *         [121.47869117980943,31.211916269810335]\n *     ],\n *     {\n *         arcDegree : 120,\n *         symbol : {\n *             'lineWidth' : 5\n *         }\n *     }\n * ).addTo(layer);\n */\nclass ArcCurve extends Curve {\n\n\n\n    _toJSON(options) {\n        return {\n            'feature': this.toGeoJSON(options),\n            'subType': 'ArcCurve'\n        };\n    }\n\n    // paint method on canvas\n    _paintOn(ctx, points, lineOpacity) {\n        ctx.beginPath();\n        this._arc(ctx, points, lineOpacity);\n        Canvas._stroke(ctx, lineOpacity);\n        this._paintArrow(ctx, points, lineOpacity);\n    }\n\n    static fromJSON(json) {\n        const feature = json['feature'];\n        const arc = new ArcCurve(feature['geometry']['coordinates'], json['options']);\n        arc.setProperties(feature['properties']);\n        return arc;\n    }\n}\n\nArcCurve.registerJSONType('ArcCurve');\n\nArcCurve.mergeOptions(options);\n\nexport default ArcCurve;\n","import Curve from './Curve';\nimport Canvas from '../core/Canvas';\n\n/**\n * Cubic Bezier Curve\n * @category geometry\n * @extends Curve\n * @param {Coordinate[]|Number[][]} coordinates - coordinates of the curve\n * @param {Object} [options=null]   - construct options defined in [CubicBezierCurve]{@link CubicBezierCurve#options}\n * @example\n * var curve = new CubicBezierCurve(\n *     [\n *         [121.47083767181408,31.214448123476995],\n *         [121.4751292062378,31.215475523000404],\n *         [121.47869117980943,31.211916269810335]\n *     ],\n *     {\n *         symbol : {\n *             'lineWidth' : 5\n *         }\n *     }\n * ).addTo(layer);\n */\nclass CubicBezierCurve extends Curve {\n\n    static fromJSON(json) {\n        const feature = json['feature'];\n        const curve = new CubicBezierCurve(feature['geometry']['coordinates'], json['options']);\n        curve.setProperties(feature['properties']);\n        return curve;\n    }\n\n    _toJSON(options) {\n        return {\n            'feature': this.toGeoJSON(options),\n            'subType': 'CubicBezierCurve'\n        };\n    }\n\n    // paint method on canvas\n    _paintOn(ctx, points, lineOpacity) {\n        ctx.beginPath();\n        ctx.moveTo(points[0].x, points[0].y);\n        this._bezierCurve(ctx, points);\n        Canvas._stroke(ctx, lineOpacity);\n        this._paintArrow(ctx, points, lineOpacity);\n    }\n\n    _getArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance) {\n        return this._getCurveArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance, 3);\n    }\n}\n\nCubicBezierCurve.registerJSONType('CubicBezierCurve');\n\nexport default CubicBezierCurve;\n","import Curve from './Curve';\nimport Canvas from '../core/Canvas';\n\n/**\n * @classdesc\n * Quadratic Bezier Curve\n * @category geometry\n * @extends Curve\n * @param {Coordinate[]|Number[][]} coordinates - coordinates of the curve\n * @example\n * var curve = new QuadBezierCurve(\n *     [\n *         [121.47083767181408,31.214448123476995],\n *         [121.4751292062378,31.215475523000404],\n *         [121.47869117980943,31.211916269810335]\n *     ],\n *     {\n *         symbol : {\n *             'lineWidth' : 5\n *         }\n *     }\n * ).addTo(layer);\n */\nclass QuadBezierCurve extends Curve {\n\n    static fromJSON(json) {\n        const feature = json['feature'];\n        const curve = new QuadBezierCurve(feature['geometry']['coordinates'], json['options']);\n        curve.setProperties(feature['properties']);\n        return curve;\n    }\n\n    _toJSON(options) {\n        return {\n            'feature': this.toGeoJSON(options),\n            'subType': 'QuadBezierCurve'\n        };\n    }\n\n    // paint method on canvas\n    _paintOn(ctx, points, lineOpacity) {\n        ctx.beginPath();\n        ctx.moveTo(points[0].x, points[0].y);\n        this._quadraticCurve(ctx, points, lineOpacity);\n        Canvas._stroke(ctx, lineOpacity);\n        this._paintArrow(ctx, points, lineOpacity);\n    }\n\n    _getArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance) {\n        return this._getCurveArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance, 2);\n    }\n}\n\nQuadBezierCurve.registerJSONType('QuadBezierCurve');\n\nexport default QuadBezierCurve;\n","import { extend, hasOwn } from '../core/util';\nimport { splitTextToRow, escapeSpecialChars } from '../core/util/strings';\nimport Marker from './Marker';\n\nconst defaultSymbol = {\n    'textFaceName': 'monospace',\n    'textSize': 12,\n    'textLineSpacing': 8,\n    'textWrapCharacter' : '\\n',\n    'textHorizontalAlignment': 'middle', //left middle right\n    'textVerticalAlignment': 'middle' //top middle bottom\n};\n\nconst defaultBoxSymbol = {\n    'markerType': 'square',\n    'markerLineColor': '#000',\n    'markerLineWidth': 2,\n    'markerLineOpacity': 1,\n    'markerFill': '#fff',\n    'markerOpacity': 1\n};\n\n/**\n * @classdesc\n * Base class for  the Text marker classes, a marker which has text and background box. <br>\n * It is abstract and not intended to be instantiated.\n * @category geometry\n * @abstract\n * @extends Marker\n */\nclass TextMarker extends Marker {\n\n    /**\n     * Get text content of the label\n     * @returns {String}\n     */\n    getContent() {\n        return this._content;\n    }\n\n    /**\n     * Set a new text content to the label\n     * @return {Label} this\n     * @fires Label#contentchange\n     */\n    setContent(content) {\n        const old = this._content;\n        this._content = escapeSpecialChars(content);\n        this._refresh();\n        /**\n         * an event when changing label's text content\n         * @event Label#contentchange\n         * @type {Object}\n         * @property {String} type - contentchange\n         * @property {Label} target - label fires the event\n         * @property {String} old - old content\n         * @property {String} new - new content\n         */\n        this._fireEvent('contentchange', {\n            'old': old,\n            'new': content\n        });\n        return this;\n    }\n\n    onAdd() {\n        this._refresh();\n    }\n\n    toJSON() {\n        const json = super.toJSON();\n        delete json['symbol'];\n        return json;\n    }\n\n    setSymbol(symbol) {\n        if (this._refreshing || !symbol) {\n            return super.setSymbol(symbol);\n        }\n        const s = this._parseSymbol(symbol);\n        if (this.setTextStyle) {\n            const style = this.getTextStyle() || {};\n            style.symbol = s[0];\n            this.setTextStyle(style);\n        } else if (this.setTextSymbol) {\n            this.setTextSymbol(s[0]);\n        }\n        if (this.setBoxStyle) {\n            const style = this.getBoxStyle() || {};\n            style.symbol = s[1];\n            this.setBoxStyle(style);\n        } else if (this.setBoxSymbol) {\n            this.setBoxSymbol(s[1]);\n        }\n        return this;\n    }\n\n    _parseSymbol(symbol) {\n        const t = {};\n        const b = {};\n        for (const p in symbol) {\n            if (hasOwn(symbol, p)) {\n                if (p.indexOf('text') === 0) {\n                    t[p] = symbol[p];\n                } else {\n                    b[p] = symbol[p];\n                }\n            }\n        }\n        return [t, b];\n    }\n\n    _getTextSize(symbol) {\n        return splitTextToRow(this._content, symbol)['size'];\n    }\n\n    _getInternalSymbol() {\n        return this._symbol;\n    }\n\n    _getDefaultTextSymbol() {\n        return extend({}, defaultSymbol);\n    }\n\n    _getDefaultBoxSymbol() {\n        return extend({}, defaultBoxSymbol);\n    }\n\n    _getDefaultPadding() {\n        return [12, 8];\n    }\n}\n\nexport default TextMarker;\n","import { extend, isNil } from '../core/util';\nimport { escapeSpecialChars } from '../core/util/strings';\nimport TextMarker from './TextMarker';\n\n/**\n * @property {Object} [options=null]                   - textbox's options, also including options of [Marker]{@link Marker#options}\n * @property {Boolean} [options.textStyle]             - the default text style of text\n * @property {Boolean} [options.textStyle.wrap=true]             - whether to autowrap text in the textbox\n * @property {Boolean} [options.textStyle.padding=[12, 8]]       - text padding in the box\n * @property {Boolean} [options.textStyle.verticalAlignment=middle]  - text's vertical alignment\n * @property {Boolean} [options.textStyle.horizontalAlignment=true]  - text's horizontal alignment\n * @property {Boolean} [options.boxSymbol=null]        - box symbol of textbox\n * @memberOf TextBox\n * @instance\n */\nconst options = {\n    'textStyle' :  {\n        'wrap' : true,\n        'padding' : [12, 8],\n        'verticalAlignment' : 'middle',\n        'horizontalAlignment' : 'middle'\n    },\n    'boxSymbol' : null\n};\n\n/**\n * @classdesc\n * Represents point type geometry for text boxes.<br>\n * A TextBox is used to draw a box with text inside on a particular coordinate.\n * @category geometry\n * @extends TextMarker\n * @mixes TextEditable\n * @example\n * var textbox = new maptalks.TextBox('This is a textbox',\n    [0, 0], 200, 90,\n    {\n      'draggable' : true,\n      'textStyle' : {\n        'wrap' : true,\n        'padding' : [12, 8],\n        'verticalAlignment' : 'top',\n        'horizontalAlignment' : 'right',\n        'symbol' : {\n          'textFaceName' : 'monospace',\n          'textFill' : '#34495e',\n          'textHaloFill' : '#fff',\n          'textHaloRadius' : 4,\n          'textSize' : 18,\n          'textWeight' : 'bold'\n        }\n      },\n      'boxSymbol': {\n        // box's symbol\n        'markerType' : 'square',\n        'markerFill' : 'rgb(135,196,240)',\n        'markerFillOpacity' : 0.9,\n        'markerLineColor' : '#34495e',\n        'markerLineWidth' : 1\n      }\n    });\n */\nclass TextBox extends TextMarker {\n    /**\n     * @param {String} content                 - TextBox's text content\n     * @param {Coordinate} coordinates         - coordinates\n     * @param {Number} width                   - width in pixel\n     * @param {Number} height                  - height in pixel\n     * @param {Object} [options=null]          - construct options defined in [TextBox]{@link TextBox#options}\n     */\n    constructor(content, coordinates, width, height, options = {}) {\n        super(coordinates, options);\n        this._content = escapeSpecialChars(content);\n        this._width = isNil(width) ? 100 : width;\n        this._height = isNil(height) ? 40 : height;\n        if (options.boxSymbol) {\n            this.setBoxSymbol(options.boxSymbol);\n        }\n        if (options.textStyle) {\n            this.setTextStyle(options.textStyle);\n        }\n        this._refresh();\n    }\n\n    /**\n     * Get textbox's width\n     * @return {Number}\n     */\n    getWidth() {\n        return this._width;\n    }\n\n    /**\n     * Set new width to textbox\n     * @param {Number} width\n     * returns {TextBox} this\n     */\n    setWidth(width) {\n        this._width = width;\n        this._refresh();\n        return this;\n    }\n\n    /**\n     * Get textbox's height\n     * @return {Number}\n     */\n    getHeight() {\n        return this._height;\n    }\n\n    /**\n     * Set new height to textbox\n     * @param {Number} height\n     * returns {TextBox} this\n     */\n    setHeight(height) {\n        this._height = height;\n        this._refresh();\n        return this;\n    }\n\n    /**\n     * Get textbox's boxSymbol\n     * @return {Object} boxsymbol\n     */\n    getBoxSymbol() {\n        return extend({}, this.options.boxSymbol);\n    }\n\n    /**\n     * Set a new box symbol to textbox\n     * @param {Object} symbol\n     * returns {TextBox} this\n     */\n    setBoxSymbol(symbol) {\n        this.options.boxSymbol = symbol ? extend({}, symbol) : symbol;\n        if (this.getSymbol()) {\n            this._refresh();\n        }\n        return this;\n    }\n\n    /**\n     * Get textbox's text style\n     * @return {Object}\n     */\n    getTextStyle() {\n        if (!this.options.textStyle) {\n            return null;\n        }\n        return extend({}, this.options.textStyle);\n    }\n\n    /**\n     * Set a new text style to the textbox\n     * @param {Object} style new text style\n     * returns {TextBox} this\n     */\n    setTextStyle(style) {\n        this.options.textStyle = style ? extend({}, style) : style;\n        if (this.getSymbol()) {\n            this._refresh();\n        }\n        return this;\n    }\n\n    static fromJSON(json) {\n        const feature = json['feature'];\n        const textBox = new TextBox(json['content'], feature['geometry']['coordinates'], json['width'], json['height'], json['options']);\n        textBox.setProperties(feature['properties']);\n        textBox.setId(feature['id']);\n        if (json['symbol']) {\n            textBox.setSymbol(json['symbol']);\n        }\n        return textBox;\n    }\n\n    _toJSON(options) {\n        return {\n            'feature': this.toGeoJSON(options),\n            'width' : this.getWidth(),\n            'height' : this.getHeight(),\n            'subType': 'TextBox',\n            'content': this._content\n        };\n    }\n\n    _refresh() {\n        const textStyle = this.getTextStyle() || {},\n            padding = textStyle['padding'] || [12, 8],\n            maxWidth = this._width - 2 * padding[0],\n            maxHeight = this._height - 2 * padding[1];\n        const symbol = extend({},\n            textStyle.symbol || this._getDefaultTextSymbol(),\n            this.options.boxSymbol || this._getDefaultBoxSymbol(),\n            {\n                'textName' : this._content,\n                'markerWidth' : this._width,\n                'markerHeight' : this._height,\n                'textHorizontalAlignment' : 'middle',\n                'textVerticalAlignment' : 'middle',\n                'textMaxWidth' : maxWidth,\n                'textMaxHeight' : maxHeight\n            });\n\n        if (textStyle['wrap'] && !symbol['textWrapWidth']) {\n            symbol['textWrapWidth'] = maxWidth;\n        }\n\n        const hAlign = textStyle['horizontalAlignment'];\n        symbol['textDx'] = symbol['markerDx'] || 0;\n        const offsetX = symbol['markerWidth'] / 2 - padding[0];\n        if (hAlign === 'left') {\n            symbol['textHorizontalAlignment'] = 'right';\n            symbol['textDx'] = symbol['textDx'] - offsetX;\n        } else if (hAlign === 'right') {\n            symbol['textHorizontalAlignment'] = 'left';\n            symbol['textDx'] = symbol['textDx'] + offsetX;\n        }\n\n        const vAlign = textStyle['verticalAlignment'];\n        symbol['textDy'] = symbol['markerDy'] || 0;\n        const offsetY = symbol['markerHeight'] / 2 - padding[1];\n        if (vAlign === 'top') {\n            symbol['textVerticalAlignment'] = 'bottom';\n            symbol['textDy'] -= offsetY;\n        } else if (vAlign === 'bottom') {\n            symbol['textVerticalAlignment'] = 'top';\n            symbol['textDy'] += offsetY;\n        }\n        this._refreshing = true;\n        this.updateSymbol(symbol);\n        delete this._refreshing;\n    }\n}\n\nTextBox.mergeOptions(options);\n\nTextBox.registerJSONType('TextBox');\n\nexport default TextBox;\n","import { extend } from '../core/util';\nimport { getAlignPoint, escapeSpecialChars } from '../core/util/strings';\nimport Size from '../geo/Size';\nimport TextMarker from './TextMarker';\n\n/**\n * @property {Object} [options=null]                   - textbox's options, also including options of [Marker]{@link Marker#options}\n * @property {Boolean} [options.boxStyle=null]             - the default box style of text\n * @property {Boolean} [options.boxStyle.padding=[12, 8]]           - text padding in the box\n * @property {Boolean} [options.boxStyle.verticalAlignment=middle]  - text's vertical alignment\n * @property {Boolean} [options.boxStyle.horizontalAlignment=true]  - text's horizontal alignment\n * @property {Number} [options.boxStyle.minWidth=0]                 - label box's minWidth\n * @property {Number} [options.boxStyle.minHeight=0]                - label box's minHeight\n * @property {Boolean} [options.textSymbol=null]        - text symbol of label\n * @memberOf Label\n * @instance\n */\nconst options = {\n    'boxStyle' : null, /*{\n        'padding' : [12, 8],\n        'verticalAlignment' : 'middle',\n        'horizontalAlignment' : 'middle',\n        'minWidth' : 0,\n        'minHeight' : 0,\n        'symbol' : null\n    }*/\n    textSymbol : null\n};\n\n/**\n * @classdesc\n * Represents point type geometry for text labels.<br>\n * A label is used to draw text (with a box background if specified) on a particular coordinate.\n * @category geometry\n * @extends TextMarker\n * @mixes TextEditable\n * @example\n * var label = new maptalks.Label('label with a box',\n    [0, 0],\n    {\n      'draggable' : true,\n      'boxStyle' : {\n        'padding' : [12, 8],\n        'verticalAlignment' : 'top',\n        'horizontalAlignment' : 'right',\n        'minWidth' : 300,\n        'minHeight' : 200,\n        'symbol' : {\n          'markerType' : 'square',\n          'markerFill' : 'rgb(135,196,240)',\n          'markerFillOpacity' : 0.9,\n          'markerLineColor' : '#34495e',\n          'markerLineWidth' : 1\n        }\n      },\n      'textSymbol': {\n        'textFaceName' : 'monospace',\n        'textFill' : '#34495e',\n        'textHaloFill' : '#fff',\n        'textHaloRadius' : 4,\n        'textSize' : 18,\n        'textWeight' : 'bold',\n        'textVerticalAlignment' : 'top'\n      }\n    });\n */\nclass Label extends TextMarker {\n\n    /**\n     * @param {String} content                 - Label's text content\n     * @param {Coordinate} coordinates         - coordinates\n     * @param {Object} [options=null]          - construct options defined in [Label]{@link Label#options}\n     */\n    constructor(content, coordinates, options = {}) {\n        super(coordinates, options);\n        if (options.textSymbol) {\n            this.setTextSymbol(options.textSymbol);\n        }\n        if (options.boxStyle) {\n            this.setBoxStyle(options.boxStyle);\n        }\n        this._content = escapeSpecialChars(content);\n        this._refresh();\n    }\n\n    /**\n     * Get label's box style\n     * @return {Object}\n     */\n    getBoxStyle() {\n        if (!this.options.boxStyle) {\n            return null;\n        }\n        return extend({}, this.options.boxStyle);\n    }\n\n    /**\n     * Set a new box style to the label\n     * @param {Object}\n     * @returns {Label} this\n     */\n    setBoxStyle(style) {\n        this.options.boxStyle = style ? extend({}, style) : style;\n        this._refresh();\n        return this;\n    }\n\n    /**\n     * Get label's text symbol\n     * @return {Object}\n     */\n    getTextSymbol() {\n        return extend({}, this._getDefaultTextSymbol(), this.options.textSymbol);\n    }\n\n    /**\n     * Set a new text symbol to the label\n     * @param {Object} symbol\n     * @returns {Label} this\n     */\n    setTextSymbol(symbol) {\n        this.options.textSymbol = symbol ? extend({}, symbol) : symbol;\n        this._refresh();\n        return this;\n    }\n\n    static fromJSON(json) {\n        const feature = json['feature'];\n        const label = new Label(json['content'], feature['geometry']['coordinates'], json['options']);\n        label.setProperties(feature['properties']);\n        label.setId(feature['id']);\n        if (json['symbol']) {\n            label.setSymbol(json['symbol']);\n        }\n        return label;\n    }\n\n    _canEdit() {\n        return false;\n    }\n\n    _toJSON(options) {\n        return {\n            'feature': this.toGeoJSON(options),\n            'subType': 'Label',\n            'content': this._content\n        };\n    }\n\n    _refresh() {\n        const symbol = extend({},\n            this.getTextSymbol(),\n            {\n                'textName' : this._content\n            });\n\n        const boxStyle = this.getBoxStyle();\n        if (boxStyle) {\n            extend(symbol, boxStyle.symbol);\n            const sizes = this._getBoxSize(symbol),\n                textSize = sizes[1],\n                padding = boxStyle['padding'] || this._getDefaultPadding();\n            const boxSize = sizes[0];\n            //if no boxSize then use text's size in default\n            symbol['markerWidth'] = boxSize['width'];\n            symbol['markerHeight'] = boxSize['height'];\n\n            const dx = symbol['textDx'] || 0,\n                dy = symbol['textDy'] || 0,\n                textAlignPoint = getAlignPoint(textSize, symbol['textHorizontalAlignment'], symbol['textVerticalAlignment'])\n                    ._add(dx, dy);\n\n            const hAlign = boxStyle['horizontalAlignment'] || 'middle';\n            symbol['markerDx'] = textAlignPoint.x;\n            if (hAlign === 'left') {\n                symbol['markerDx'] += symbol['markerWidth'] / 2 - padding[0];\n            } else if (hAlign === 'right') {\n                symbol['markerDx'] -= symbol['markerWidth'] / 2 - textSize['width'] - padding[0];\n            } else {\n                symbol['markerDx'] += textSize['width'] / 2;\n            }\n\n            const vAlign = boxStyle['verticalAlignment'] || 'middle';\n            symbol['markerDy'] = textAlignPoint.y;\n            if (vAlign === 'top') {\n                symbol['markerDy'] += symbol['markerHeight'] / 2 - padding[1];\n            } else if (vAlign === 'bottom') {\n                symbol['markerDy'] -= symbol['markerHeight'] / 2 - textSize['height'] - padding[1];\n            } else {\n                symbol['markerDy'] += textSize['height'] / 2;\n            }\n        }\n        this._refreshing = true;\n        this.updateSymbol(symbol);\n        delete this._refreshing;\n    }\n\n    _getBoxSize(symbol) {\n        if (!symbol['markerType']) {\n            symbol['markerType'] = 'square';\n        }\n        const boxStyle = this.getBoxStyle();\n        const size = this._getTextSize(symbol);\n        let width, height;\n        const padding = boxStyle['padding'] || this._getDefaultPadding();\n        width = size['width'] + padding[0] * 2;\n        height = size['height'] + padding[1] * 2;\n        if (boxStyle['minWidth']) {\n            if (!width || width < boxStyle['minWidth']) {\n                width = boxStyle['minWidth'];\n            }\n        }\n        if (boxStyle['minHeight']) {\n            if (!height || height < boxStyle['minHeight']) {\n                height = boxStyle['minHeight'];\n            }\n        }\n        return [new Size(width, height), size];\n    }\n\n}\n\nLabel.mergeOptions(options);\n\nLabel.registerJSONType('Label');\n\nexport default Label;\n","import { isNil, isArrayHasData, removeFromArray } from '../core/util';\nimport LineString from './LineString';\nimport Geometry from './Geometry';\nimport ArcCurve from './ArcCurve';\n\n/**\n * Mixin of connector line methods.\n * @mixin Connectable\n * @private\n */\nconst Connectable = Base =>\n    class extends Base {\n\n        static _hasConnectors(geometry) {\n            return (!isNil(geometry.__connectors) && geometry.__connectors.length > 0);\n        }\n\n        static _getConnectors(geometry) {\n            return geometry.__connectors;\n        }\n\n        /**\n         * Gets the source of the connector line.\n         * @return {Geometry|control.Control|UIComponent}\n         * @function Connectable.getConnectSource\n         */\n        getConnectSource() {\n            return this._connSource;\n        }\n\n        /**\n         * Sets the source to the connector line.\n         * @param {Geometry|control.Control|UIComponent} src\n         * @return {ConnectorLine} this\n         * @function Connectable.setConnectSource\n         */\n        setConnectSource(src) {\n            const target = this._connTarget;\n            this.onRemove();\n            this._connSource = src;\n            this._connTarget = target;\n            this.onAdd();\n            return this;\n        }\n\n        /**\n         * Gets the target of the connector line.\n         * @return {Geometry|control.Control|UIComponent}\n         * @function Connectable.getConnectTarget\n         */\n        getConnectTarget() {\n            return this._connTarget;\n        }\n\n        /**\n         * Sets the target to the connector line.\n         * @param {Geometry|control.Control|UIComponent} target\n         * @return {ConnectorLine} this\n         * @function Connectable.setConnectTarget\n         */\n        setConnectTarget(target) {\n            const src = this._connSource;\n            this.onRemove();\n            this._connSource = src;\n            this._connTarget = target;\n            this._updateCoordinates();\n            this._registerEvents();\n            return this;\n        }\n\n        _updateCoordinates() {\n            let map = this.getMap();\n            if (!map && this._connSource) {\n                map = this._connSource.getMap();\n            }\n            if (!map && this._connTarget) {\n                map = this._connTarget.getMap();\n            }\n            if (!map) {\n                return;\n            }\n            if (!this._connSource || !this._connTarget) {\n                return;\n            }\n            const srcPoints = this._connSource._getConnectPoints();\n            const targetPoints = this._connTarget._getConnectPoints();\n            let minDist = 0;\n            const oldCoordinates = this.getCoordinates();\n            let c1, c2;\n            for (let i = 0, len = srcPoints.length; i < len; i++) {\n                const p1 = srcPoints[i];\n                for (let j = 0, length = targetPoints.length; j < length; j++) {\n                    const p2 = targetPoints[j];\n                    const dist = map.computeLength(p1, p2);\n                    if (i === 0 && j === 0) {\n                        c1 = p1;\n                        c2 = p2;\n                        minDist = dist;\n                    } else if (dist < minDist) {\n                        c1 = p1;\n                        c2 = p2;\n                    }\n                }\n            }\n            if (!isArrayHasData(oldCoordinates) || (!oldCoordinates[0].equals(c1) || !oldCoordinates[1].equals(c2))) {\n                this.setCoordinates([c1, c2]);\n            }\n        }\n\n        onAdd() {\n            this._registerEvents();\n            this._updateCoordinates();\n        }\n\n        onRemove() {\n            if (this._connSource) {\n                if (this._connSource.__connectors) {\n                    removeFromArray(this, this._connSource.__connectors);\n                }\n                this._connSource.off('dragging positionchange', this._updateCoordinates, this)\n                    .off('remove', this.onRemove, this);\n                this._connSource.off('dragstart mousedown mouseover', this._showConnect, this);\n                this._connSource.off('dragend mouseup mouseout', this.hide, this);\n                this._connSource.off('show', this._showConnect, this).off('hide', this.hide, this);\n                delete this._connSource;\n            }\n            if (this._connTarget) {\n                removeFromArray(this, this._connTarget.__connectors);\n                this._connTarget.off('dragging positionchange', this._updateCoordinates, this)\n                    .off('remove', this.onRemove, this);\n                this._connTarget.off('show', this._showConnect, this).off('hide', this.hide, this);\n                delete this._connTarget;\n            }\n\n            //not a geometry\n            if (!(this._connSource instanceof Geometry) || !(this._connTarget instanceof Geometry)) {\n                const map = this.getMap();\n                if (map) {\n                    map.off('movestart moving moveend zoomstart zooming zoomend rotate pitch fovchange spatialreferencechange', this._updateCoordinates, this);\n                }\n            }\n        }\n\n        _showConnect() {\n            if (!this._connSource || !this._connTarget) {\n                return;\n            }\n            if (this._connSource.isVisible() && this._connTarget.isVisible()) {\n                this._updateCoordinates();\n                this.show();\n            }\n        }\n\n        _registerEvents() {\n            if (!this._connSource || !this._connTarget) {\n                return;\n            }\n            if (!this._connSource.__connectors) {\n                this._connSource.__connectors = [];\n            }\n            if (!this._connTarget.__connectors) {\n                this._connTarget.__connectors = [];\n            }\n            this._connSource.__connectors.push(this);\n            this._connTarget.__connectors.push(this);\n            this._connSource.on('dragging positionchange', this._updateCoordinates, this)\n                .on('remove', this.remove, this);\n            this._connTarget.on('dragging positionchange', this._updateCoordinates, this)\n                .on('remove', this.remove, this);\n            this._connSource.on('show', this._showConnect, this).on('hide', this.hide, this);\n            this._connTarget.on('show', this._showConnect, this).on('hide', this.hide, this);\n            const trigger = this.options['showOn'];\n            this.hide();\n            if (trigger === 'moving') {\n                this._connSource.on('dragstart', this._showConnect, this).on('dragend', this.hide, this);\n                this._connTarget.on('dragstart', this._showConnect, this).on('dragend', this.hide, this);\n            } else if (trigger === 'click') {\n                this._connSource.on('mousedown', this._showConnect, this).on('mouseup', this.hide, this);\n                this._connTarget.on('mousedown', this._showConnect, this).on('mouseup', this.hide, this);\n            } else if (trigger === 'mouseover') {\n                this._connSource.on('mouseover', this._showConnect, this).on('mouseout', this.hide, this);\n                this._connTarget.on('mouseover', this._showConnect, this).on('mouseout', this.hide, this);\n            } else {\n                this._showConnect();\n            }\n\n            //not a geometry\n            if (!(this._connSource instanceof Geometry) || !(this._connTarget instanceof Geometry)) {\n                const map = this.getMap();\n                if (map) {\n                    map.on('movestart moving moveend zoomstart zooming zoomend rotate pitch fovchange spatialreferencechange', this._updateCoordinates, this);\n                }\n            }\n        }\n    };\n\n/**\n * @property {Object} options - ConnectorLine's options\n * @property {String} [options.showOn=always]  - when to show the connector line, possible values: 'moving', 'click', 'mouseover', 'always'\n * @memberOf ConnectorLine\n * @instance\n */\n/**\n * @property {Object} options - ConnectorLine's options\n * @property {String} [options.showOn=always]  - when to show the connector line, possible values: 'moving', 'click', 'mouseover', 'always'\n * @memberOf ArcConnectorLine\n * @instance\n */\nconst options = {\n    showOn: 'always'\n};\n\n/**\n * A straight connector line geometry can connect geometries or ui components with each other. <br>\n *\n * @category geometry\n * @extends LineString\n * @example\n * var src = new Marker([0,0]).addTo(layer),\n *     dst = new Marker([1,0]).addTo(layer),\n *     line = new ConnectorLine(src, dst, {\n *         showOn : 'always', //'moving', 'click', 'mouseover', 'always'\n *         arrowStyle : 'classic',\n *         arrowPlacement : 'vertex-last', //vertex-first, vertex-last, vertex-firstlast, point\n *         symbol: {\n *           lineColor: '#34495e',\n *           lineWidth: 2\n *        }\n *     }).addTo(layer);\n * @mixes connectorLineMixin\n */\nclass ConnectorLine extends Connectable(LineString) {\n    /**\n     * @param {Geometry|control.Control|UIComponent} src     - source to connect\n     * @param {Geometry|control.Control|UIComponent} target  - target to connect\n     * @param {Object} [options=null]  - construct options defined in [ConnectorLine]{@link ConnectorLine#options}\n     */\n    constructor(src, target, options) {\n        super(null, options);\n        if (arguments.length === 1) {\n            options = src;\n            src = null;\n            target = null;\n        }\n        this._connSource = src;\n        this._connTarget = target;\n    }\n}\n\nConnectorLine.mergeOptions(options);\n\nConnectorLine.registerJSONType('ConnectorLine');\n\n/**\n * An arc curve connector line geometry can connect geometries or ui components with each other. <br>\n *\n * @category geometry\n * @extends ArcCurve\n * @example\n * var src = new Marker([0,0]).addTo(layer),\n *     dst = new Marker([1,0]).addTo(layer),\n *     line = new ArcConnectorLine(src, dst, {\n *         arcDegree : 120,\n *         showOn : 'always', //'moving', 'click', 'mouseover', 'always'\n *         arrowStyle : 'classic',\n *         arrowPlacement : 'vertex-last', //vertex-first, vertex-last, vertex-firstlast, point\n *         symbol: {\n *           lineColor: '#34495e',\n *           lineWidth: 2\n *        }\n *     }).addTo(layer);\n * @mixes connectorLineMixin\n */\nclass ArcConnectorLine extends Connectable(ArcCurve) {\n    /**\n     * @param {Geometry|control.Control|UIComponent} src     - source to connect\n     * @param {Geometry|control.Control|UIComponent} target  - target to connect\n     * @param {Object} [options=null]  - construct options defined in [ConnectorLine]{@link ConnectorLine#options}\n     */\n    constructor(src, target, options) {\n        super(null, options);\n        if (arguments.length === 1) {\n            options = src;\n            src = null;\n            target = null;\n        }\n        this._connSource = src;\n        this._connTarget = target;\n    }\n}\n\nArcConnectorLine.mergeOptions(options);\n\nArcConnectorLine.registerJSONType('ArcConnectorLine');\n\nexport { ConnectorLine, ArcConnectorLine };\n","import { GEOJSON_TYPES } from '../core/Constants';\nimport { isNil, UID, isObject } from '../core/util';\nimport Extent from '../geo/Extent';\nimport PointExtent from '../geo/PointExtent';\nimport { Geometry, LineString, Curve } from '../geometry';\nimport { isFunction } from '../core/util';\nimport { createFilter, getFilterFeature } from '@maptalks/feature-filter';\nimport Layer from './Layer';\nimport GeoJSON from '../geometry/GeoJSON';\n\n/**\n * @property {Boolean}  [options.drawImmediate=false] - (Only for layer rendered with [CanvasRenderer]{@link renderer.CanvasRenderer}) <br>\n *                                                    In default, for performance reason, layer will be drawn in a frame requested by RAF(RequestAnimationFrame).<br>\n *                                                    Set drawImmediate to true to draw immediately.<br>\n *                                                    This is necessary when layer's drawing is wrapped with another frame requested by RAF.\n * @memberOf OverlayLayer\n * @instance\n */\nconst options = {\n    'drawImmediate' : false\n};\n\nconst TEMP_EXTENT = new PointExtent();\n\n/**\n * @classdesc\n * Base class of all the layers that can add/remove geometries. <br>\n * It is abstract and not intended to be instantiated.\n * @category layer\n * @abstract\n * @extends Layer\n */\nclass OverlayLayer extends Layer {\n\n    constructor(id, geometries, options) {\n        if (geometries && (!(geometries instanceof Geometry) && !Array.isArray(geometries) && GEOJSON_TYPES.indexOf(geometries.type) < 0)) {\n            options = geometries;\n            geometries = null;\n        }\n        super(id, options);\n        this._maxZIndex = 0;\n        this._minZIndex = 0;\n        this._initCache();\n        if (geometries) {\n            this.addGeometry(geometries);\n        }\n    }\n\n    /**\n     * Get a geometry by its id\n     * @param  {String|Number} id   - id of the geometry\n     * @return {Geometry}\n     */\n    getGeometryById(id) {\n        if (isNil(id) || id === '') {\n            return null;\n        }\n        if (!this._geoMap[id]) {\n            return null;\n        }\n        return this._geoMap[id];\n    }\n\n    /**\n     * Get all the geometries or the ones filtered if a filter function is provided.\n     * @param {Function} [filter=undefined]  - a function to filter the geometries\n     * @param {Object} [context=undefined]   - context of the filter function, value to use as this when executing filter.\n     * @return {Geometry[]}\n     */\n    getGeometries(filter, context) {\n        if (!filter) {\n            return this._geoList.slice(0);\n        }\n        const result = [];\n        let geometry, filtered;\n        for (let i = 0, l = this._geoList.length; i < l; i++) {\n            geometry = this._geoList[i];\n            if (context) {\n                filtered = filter.call(context, geometry);\n            } else {\n                filtered = filter(geometry);\n            }\n            if (filtered) {\n                result.push(geometry);\n            }\n        }\n        return result;\n    }\n\n    /**\n     * Get the first geometry, the geometry at the bottom.\n     * @return {Geometry} first geometry\n     */\n    getFirstGeometry() {\n        if (!this._geoList.length) {\n            return null;\n        }\n        return this._geoList[0];\n    }\n\n    /**\n     * Get the last geometry, the geometry on the top\n     * @return {Geometry} last geometry\n     */\n    getLastGeometry() {\n        const len = this._geoList.length;\n        if (len === 0) {\n            return null;\n        }\n        return this._geoList[len - 1];\n    }\n\n    /**\n     * Get count of the geometries\n     * @return {Number} count\n     */\n    getCount() {\n        return this._geoList.length;\n    }\n\n    /**\n     * Get extent of all the geometries in the layer, return null if the layer is empty.\n     * @return {Extent} - extent of the layer\n     */\n    getExtent() {\n        if (this.getCount() === 0) {\n            return null;\n        }\n        const extent = new Extent(this.getProjection());\n        this.forEach(g => {\n            extent._combine(g.getExtent());\n        });\n        return extent;\n    }\n\n    /**\n     * Executes the provided callback once for each geometry present in the layer in order.\n     * @param  {Function} fn - a callback function\n     * @param  {*} [context=undefined]   - callback's context, value to use as this when executing callback.\n     * @return {OverlayLayer} this\n     */\n    forEach(fn, context) {\n        const copyOnWrite = this._geoList.slice(0);\n        for (let i = 0, l = copyOnWrite.length; i < l; i++) {\n            if (!context) {\n                fn(copyOnWrite[i], i);\n            } else {\n                fn.call(context, copyOnWrite[i], i);\n            }\n        }\n        return this;\n    }\n\n    /**\n     * Creates a GeometryCollection with all the geometries that pass the test implemented by the provided function.\n     * @param  {Function} fn      - Function to test each geometry\n     * @param  {*} [context=undefined]  - Function's context, value to use as this when executing function.\n     * @return {GeometryCollection} A GeometryCollection with all the geometries that pass the test\n     */\n    filter(fn, context) {\n        const selected = [];\n        const isFn = isFunction(fn);\n        const filter = isFn ? fn : createFilter(fn);\n\n        this.forEach(geometry => {\n            const g = isFn ? geometry : getFilterFeature(geometry);\n            if (context ? filter.call(context, g) : filter(g)) {\n                selected.push(geometry);\n            }\n        }, this);\n        return selected;\n    }\n\n    /**\n     * Whether the layer is empty.\n     * @return {Boolean}\n     */\n    isEmpty() {\n        return !this._geoList.length;\n    }\n\n    /**\n     * Adds one or more geometries to the layer\n     * @param {Geometry|Geometry[]} geometries - one or more geometries\n     * @param {Boolean} [fitView=false]  - automatically set the map to a fit center and zoom for the geometries\n     * @return {OverlayLayer} this\n     */\n    addGeometry(geometries, fitView) {\n        if (!geometries) {\n            return this;\n        }\n        if (geometries.type === 'FeatureCollection') {\n            return this.addGeometry(GeoJSON.toGeometry(geometries), fitView);\n        } else if (!Array.isArray(geometries)) {\n            const count = arguments.length;\n            const last = arguments[count - 1];\n            geometries = Array.prototype.slice.call(arguments, 0, count - 1);\n            fitView = last;\n            if (isObject(last)) {\n                geometries.push(last);\n                fitView = false;\n            }\n            return this.addGeometry(geometries, fitView);\n        } else if (geometries.length === 0) {\n            return this;\n        }\n        this._initCache();\n        let extent;\n        if (fitView === true) {\n            extent = new Extent();\n        }\n        this._toSort = this._maxZIndex > 0;\n        const geos = [];\n        for (let i = 0, l = geometries.length; i < l; i++) {\n            let geo = geometries[i];\n            if (!geo) {\n                throw new Error('Invalid geometry to add to layer(' + this.getId() + ') at index:' + i);\n            }\n            if (!(geo instanceof Geometry)) {\n                geo = Geometry.fromJSON(geo);\n                if (Array.isArray(geo)) {\n                    for (let ii = 0, ll = geo.length; ii < ll; ii++) {\n                        this._add(geo[ii], extent, i);\n                        geos.push(geo[ii]);\n                    }\n                }\n            }\n            if (!Array.isArray(geo)) {\n                this._add(geo, extent, i);\n                geos.push(geo);\n            }\n        }\n        const map = this.getMap();\n        if (map) {\n            this._getRenderer().onGeometryAdd(geos);\n            if (fitView === true && !isNil(extent.xmin)) {\n                const z = map.getFitZoom(extent);\n                map.setCenterAndZoom(extent.getCenter(), z);\n            }\n        }\n        /**\n         * addgeo event.\n         *\n         * @event OverlayLayer#addgeo\n         * @type {Object}\n         * @property {String} type - addgeo\n         * @property {OverlayLayer} target - layer\n         * @property {Geometry[]} geometries - the geometries to add\n         */\n        this.fire('addgeo', {\n            'geometries': geometries\n        });\n        return this;\n    }\n\n    /**\n     * Get minimum zindex of geometries\n     */\n    getGeoMinZIndex() {\n        return this._minZIndex;\n    }\n\n    /**\n     * Get maximum zindex of geometries\n     */\n    getGeoMaxZIndex() {\n        return this._maxZIndex;\n    }\n\n    _add(geo, extent, i) {\n        if (!this._toSort) {\n            this._toSort = geo.getZIndex() !== 0;\n        }\n        this._updateZIndex(geo.getZIndex());\n        const geoId = geo.getId();\n        if (!isNil(geoId)) {\n            if (!isNil(this._geoMap[geoId])) {\n                throw new Error('Duplicate geometry id in layer(' + this.getId() + '):' + geoId + ', at index:' + i);\n            }\n            this._geoMap[geoId] = geo;\n        }\n        const internalId = UID();\n        geo._setInternalId(internalId);\n        this._geoList.push(geo);\n        if (this.onAddGeometry) {\n            this.onAddGeometry(geo);\n        }\n        geo._bindLayer(this);\n        if (geo.onAdd) {\n            geo.onAdd();\n        }\n        if (extent) {\n            extent._combine(geo.getExtent());\n        }\n        /**\n         * add event.\n         *\n         * @event Geometry#add\n         * @type {Object}\n         * @property {String} type - add\n         * @property {Geometry} target - geometry\n         * @property {Layer} layer - the layer added to.\n         */\n        geo._fireEvent('add', {\n            'layer': this\n        });\n    }\n\n    /**\n     * Removes one or more geometries from the layer\n     * @param  {String|String[]|Geometry|Geometry[]} geometries - geometry ids or geometries to remove\n     * @returns {OverlayLayer} this\n     */\n    removeGeometry(geometries) {\n        if (!Array.isArray(geometries)) {\n            return this.removeGeometry([geometries]);\n        }\n        for (let i = geometries.length - 1; i >= 0; i--) {\n            if (!(geometries[i] instanceof Geometry)) {\n                geometries[i] = this.getGeometryById(geometries[i]);\n            }\n            if (!geometries[i] || this !== geometries[i].getLayer()) continue;\n            geometries[i].remove();\n        }\n        /**\n         * removegeo event.\n         *\n         * @event OverlayLayer#removegeo\n         * @type {Object}\n         * @property {String} type - removegeo\n         * @property {OverlayLayer} target - layer\n         * @property {Geometry[]} geometries - the geometries to remove\n         */\n        this.fire('removegeo', {\n            'geometries': geometries\n        });\n        return this;\n    }\n\n    /**\n     * Clear all geometries in this layer\n     * @returns {OverlayLayer} this\n     */\n    clear() {\n        this._clearing = true;\n        this.forEach(geo => {\n            geo.remove();\n        });\n        this._geoMap = {};\n        const old = this._geoList;\n        this._geoList = [];\n        if (this._getRenderer()) {\n            this._getRenderer().onGeometryRemove(old);\n        }\n        this._clearing = false;\n        /**\n         * clear event.\n         *\n         * @event OverlayLayer#clear\n         * @type {Object}\n         * @property {String} type - clear\n         * @property {OverlayLayer} target - layer\n         */\n        this.fire('clear');\n        return this;\n    }\n\n    /**\n     * Called when geometry is being removed to clear the context concerned.\n     * @param  {Geometry} geometry - the geometry instance to remove\n     * @protected\n     */\n    onRemoveGeometry(geometry) {\n        if (!geometry || this._clearing) { return; }\n        //考察geometry是否属于该图层\n        if (this !== geometry.getLayer()) {\n            return;\n        }\n        const internalId = geometry._getInternalId();\n        if (isNil(internalId)) {\n            return;\n        }\n        const geoId = geometry.getId();\n        if (!isNil(geoId)) {\n            delete this._geoMap[geoId];\n        }\n        const idx = this._findInList(geometry);\n        if (idx >= 0) {\n            this._geoList.splice(idx, 1);\n        }\n        if (this._getRenderer()) {\n            this._getRenderer().onGeometryRemove([geometry]);\n        }\n    }\n\n    hide() {\n        for (let i = 0, l = this._geoList.length; i < l; i++) {\n            this._geoList[i].onHide();\n        }\n        return Layer.prototype.hide.call(this);\n    }\n\n    /**\n     * Identify the geometries on the given coordinate\n     * @param  {maptalks.Coordinate} coordinate   - coordinate to identify\n     * @param  {Object} [options=null]  - options\n     * @param  {Object} [options.tolerance=0] - identify tolerance in pixel\n     * @param  {Object} [options.count=null]  - result count\n     * @return {Geometry[]} geometries identified\n     */\n    identify(coordinate, options = {}) {\n        return this._hitGeos(this._geoList, coordinate, options);\n    }\n\n    _hitGeos(geometries, coordinate, options = {}) {\n        const filter = options['filter'],\n            tolerance = options['tolerance'],\n            hits = [];\n        const map = this.getMap();\n        const point = map.coordToPoint(coordinate);\n        const cp = map._pointToContainerPoint(point, undefined, 0, point);\n        for (let i = geometries.length - 1; i >= 0; i--) {\n            const geo = geometries[i];\n            if (!geo || !geo.isVisible() || !geo._getPainter() || !geo.options['interactive']) {\n                continue;\n            }\n            if (!(geo instanceof LineString) || (!geo._getArrowStyle() && !(geo instanceof Curve))) {\n                // Except for LineString with arrows or curves\n                let extent = geo.getContainerExtent(TEMP_EXTENT);\n                if (tolerance) {\n                    extent = extent._expand(tolerance);\n                }\n                if (!extent || !extent.contains(cp)) {\n                    continue;\n                }\n            }\n            if (geo._containsPoint(cp, tolerance) && (!filter || filter(geo))) {\n                hits.push(geo);\n                if (options['count']) {\n                    if (hits.length >= options['count']) {\n                        break;\n                    }\n                }\n            }\n        }\n        return hits;\n    }\n\n    _initCache() {\n        if (!this._geoList) {\n            this._geoList = [];\n            this._geoMap = {};\n        }\n    }\n\n    _updateZIndex(...zIndex) {\n        this._maxZIndex = Math.max(this._maxZIndex, Math.max.apply(Math, zIndex));\n        this._minZIndex = Math.min(this._minZIndex, Math.min.apply(Math, zIndex));\n    }\n\n    _sortGeometries() {\n        if (!this._toSort) {\n            return;\n        }\n        this._maxZIndex = 0;\n        this._minZIndex = 0;\n        this._geoList.sort((a, b) => {\n            this._updateZIndex(a.getZIndex(), b.getZIndex());\n            return this._compare(a, b);\n        });\n        this._toSort = false;\n    }\n\n    _compare(a, b) {\n        if (a.getZIndex() === b.getZIndex()) {\n            return a._getInternalId() - b._getInternalId();\n        }\n        return a.getZIndex() - b.getZIndex();\n    }\n\n    //binarySearch\n    _findInList(geo) {\n        const len = this._geoList.length;\n        if (len === 0) {\n            return -1;\n        }\n        let low = 0,\n            high = len - 1,\n            middle;\n        while (low <= high) {\n            middle = Math.floor((low + high) / 2);\n            if (this._geoList[middle] === geo) {\n                return middle;\n            } else if (this._compare(this._geoList[middle], geo) > 0) {\n                high = middle - 1;\n            } else {\n                low = middle + 1;\n            }\n        }\n        return -1;\n    }\n\n    _onGeometryEvent(param) {\n        if (!param || !param['target']) {\n            return;\n        }\n        const type = param['type'];\n        if (type === 'idchange') {\n            this._onGeometryIdChange(param);\n        } else if (type === 'zindexchange') {\n            this._onGeometryZIndexChange(param);\n        } else if (type === 'positionchange') {\n            this._onGeometryPositionChange(param);\n        } else if (type === 'shapechange') {\n            this._onGeometryShapeChange(param);\n        } else if (type === 'symbolchange') {\n            this._onGeometrySymbolChange(param);\n        } else if (type === 'show') {\n            this._onGeometryShow(param);\n        } else if (type === 'hide') {\n            this._onGeometryHide(param);\n        } else if (type === 'propertieschange') {\n            this._onGeometryPropertiesChange(param);\n        }\n    }\n\n    _onGeometryIdChange(param) {\n        if (param['new'] === param['old']) {\n            if (this._geoMap[param['old']] && this._geoMap[param['old']] === param['target']) {\n                return;\n            }\n        }\n        if (!isNil(param['new'])) {\n            if (this._geoMap[param['new']]) {\n                throw new Error('Duplicate geometry id in layer(' + this.getId() + '):' + param['new']);\n            }\n            this._geoMap[param['new']] = param['target'];\n        }\n        if (!isNil(param['old']) && param['new'] !== param['old']) {\n            delete this._geoMap[param['old']];\n        }\n\n    }\n\n    _onGeometryZIndexChange(param) {\n        if (param['old'] !== param['new']) {\n            this._updateZIndex(param['new']);\n            this._toSort = true;\n            if (this._getRenderer()) {\n                this._getRenderer().onGeometryZIndexChange(param);\n            }\n        }\n    }\n\n    _onGeometryPositionChange(param) {\n        if (this._getRenderer()) {\n            this._getRenderer().onGeometryPositionChange(param);\n        }\n    }\n\n    _onGeometryShapeChange(param) {\n        if (this._getRenderer()) {\n            this._getRenderer().onGeometryShapeChange(param);\n        }\n    }\n\n    _onGeometrySymbolChange(param) {\n        if (this._getRenderer()) {\n            this._getRenderer().onGeometrySymbolChange(param);\n        }\n    }\n\n    _onGeometryShow(param) {\n        if (this._getRenderer()) {\n            this._getRenderer().onGeometryShow(param);\n        }\n    }\n\n    _onGeometryHide(param) {\n        if (this._getRenderer()) {\n            this._getRenderer().onGeometryHide(param);\n        }\n    }\n\n    _onGeometryPropertiesChange(param) {\n        if (this._getRenderer()) {\n            this._getRenderer().onGeometryPropertiesChange(param);\n        }\n    }\n}\n\nOverlayLayer.mergeOptions(options);\n\nexport default OverlayLayer;\n","import Browser from '../core/Browser';\nimport { isNil } from '../core/util';\nimport { getFilterFeature, compileStyle } from '@maptalks/feature-filter';\nimport Extent from '../geo/Extent';\nimport Geometry from '../geometry/Geometry';\nimport OverlayLayer from './OverlayLayer';\n\n/**\n * @property {Object}  options - VectorLayer's options\n * @property {Boolean} options.debug=false           - whether the geometries on the layer is in debug mode.\n * @property {Boolean} options.enableSimplify=true   - whether to simplify geometries before rendering.\n * @property {String}  options.cursor=default        - the cursor style of the layer\n * @property {Boolean} options.geometryEvents=true   - enable/disable firing geometry events, disable it to improve performance.\n * @property {Boolean} options.defaultIconSize=[20,20] - default size of a marker's icon\n * @property {Boolean} [options.enableAltitude=false]  - whether to enable render geometry with altitude, false by default\n * @property {Boolean} [options.altitudeProperty=altitude] - geometry's altitude property name, if enableAltitude is true, \"altitude\" by default\n * @property {Boolean} [options.drawAltitude=false]  - whether to draw altitude: a vertical line for marker, a vertical polygon for line\n * @property {Boolean} [options.debug=false]         - whether the geometries on the layer is in debug mode.\n * @property {Number} [options.markerLimitOnZooming=30] - limit markers to draw when zooming for better performance, set to 0 to unlimit it.\n * @memberOf VectorLayer\n * @instance\n */\nconst options = {\n    'debug': false,\n    'enableSimplify': true,\n    'geometryEvents': true,\n    'defaultIconSize': [20, 20],\n    'cacheVectorOnCanvas': true,\n    'cacheSvgOnCanvas': Browser.gecko,\n    'enableAltitude' : false,\n    'altitudeProperty' : 'altitude',\n    'drawAltitude' : false,\n    'markerLimitOnZooming': 30\n};\n\n/**\n * @classdesc\n * A layer for managing and rendering geometries.\n * @category layer\n * @extends OverlayLayer\n */\nclass VectorLayer extends OverlayLayer {\n\n    /**\n     * @param {String|Number} id - layer's id\n     * @param {Geometry|Geometry[]} [geometries=null] - geometries to add\n     * @param {Object}  [options=null]          - construct options\n     * @param {Object}  [options.style=null]    - vectorlayer's style\n     * @param {*}  [options.*=null]             - options defined in [VectorLayer]{@link VectorLayer#options}\n     */\n    constructor(id, geometries, options) {\n        super(id, geometries, options);\n        const style = this.options['style'];\n        delete this.options['style'];\n        if (style) {\n            this.setStyle(style);\n        }\n    }\n\n    /**\n     * Gets layer's style.\n     * @return {Object|Object[]} layer's style\n     */\n    getStyle() {\n        if (!this._style) {\n            return null;\n        }\n        return this._style;\n    }\n\n    /**\n     * Sets style to the layer, styling the geometries satisfying the condition with style's symbol. <br>\n     * Based on filter type in [mapbox-gl-js's style specification]{https://www.mapbox.com/mapbox-gl-js/style-spec/#types-filter}.\n     * @param {Object|Object[]} style - layer's style\n     * @returns {VectorLayer} this\n     * @fires VectorLayer#setstyle\n     * @example\n     * layer.setStyle([\n        {\n          'filter': ['==', 'count', 100],\n          'symbol': {'markerFile' : 'foo1.png'}\n        },\n        {\n          'filter': ['==', 'count', 200],\n          'symbol': {'markerFile' : 'foo2.png'}\n        }\n      ]);\n     */\n    setStyle(style) {\n        this._style = style;\n        this._cookedStyles = compileStyle(style);\n        this.forEach(function (geometry) {\n            this._styleGeometry(geometry);\n        }, this);\n        /**\n         * setstyle event.\n         *\n         * @event VectorLayer#setstyle\n         * @type {Object}\n         * @property {String} type - setstyle\n         * @property {VectorLayer} target - layer\n         * @property {Object|Object[]}       style - style to set\n         */\n        this.fire('setstyle', {\n            'style': style\n        });\n        return this;\n    }\n\n    /**\n     * Removes layers' style\n     * @returns {VectorLayer} this\n     * @fires VectorLayer#removestyle\n     */\n    removeStyle() {\n        if (!this._style) {\n            return this;\n        }\n        delete this._style;\n        delete this._cookedStyles;\n        this.forEach(function (geometry) {\n            geometry._setExternSymbol(null);\n        }, this);\n        /**\n         * removestyle event.\n         *\n         * @event VectorLayer#removestyle\n         * @type {Object}\n         * @property {String} type - removestyle\n         * @property {VectorLayer} target - layer\n         */\n        this.fire('removestyle');\n        return this;\n    }\n\n    onAddGeometry(geo) {\n        const style = this.getStyle();\n        if (style) {\n            this._styleGeometry(geo);\n        }\n    }\n\n    onConfig(conf) {\n        super.onConfig(conf);\n        if (conf['enableAltitude'] || conf['drawAltitude'] || conf['altitudeProperty']) {\n            const renderer = this.getRenderer();\n            if (renderer && renderer.setToRedraw) {\n                renderer.setToRedraw();\n            }\n        }\n    }\n\n    _styleGeometry(geometry) {\n        if (!this._cookedStyles) {\n            return false;\n        }\n        const g = getFilterFeature(geometry);\n        for (let i = 0, len = this._cookedStyles.length; i < len; i++) {\n            if (this._cookedStyles[i]['filter'](g) === true) {\n                geometry._setExternSymbol(this._cookedStyles[i]['symbol']);\n                return true;\n            }\n        }\n        return false;\n    }\n\n    identify(coordinate, options = {}) {\n        const renderer = this.getRenderer();\n        // only iterate drawn geometries when onlyVisible is true.\n        if (options['onlyVisible'] && renderer && renderer.identify) {\n            return renderer.identify(coordinate, options);\n        }\n        return super.identify(coordinate, options);\n    }\n\n    /**\n     * Export the VectorLayer's JSON. <br>\n     * @param  {Object} [options=null] - export options\n     * @param  {Object} [options.geometries=null] - If not null and the layer is a [OverlayerLayer]{@link OverlayLayer},\n     *                                            the layer's geometries will be exported with the given \"options.geometries\" as a parameter of geometry's toJSON.\n     * @param  {Extent} [options.clipExtent=null] - if set, only the geometries intersectes with the extent will be exported.\n     * @return {Object} layer's JSON\n     */\n    toJSON(options) {\n        if (!options) {\n            options = {};\n        }\n        const profile = {\n            'type': this.getJSONType(),\n            'id': this.getId(),\n            'options': this.config()\n        };\n        if ((isNil(options['style']) || options['style']) && this.getStyle()) {\n            profile['style'] = this.getStyle();\n        }\n        if (isNil(options['geometries']) || options['geometries']) {\n            let clipExtent;\n            if (options['clipExtent']) {\n                const map = this.getMap();\n                const projection = map ? map.getProjection() : null;\n                clipExtent = new Extent(options['clipExtent'], projection);\n            }\n            const geoJSONs = [];\n            const geometries = this.getGeometries();\n            for (let i = 0, len = geometries.length; i < len; i++) {\n                const geo = geometries[i];\n                const geoExt = geo.getExtent();\n                if (!geoExt || (clipExtent && !clipExtent.intersects(geoExt))) {\n                    continue;\n                }\n                const json = geo.toJSON(options['geometries']);\n                geoJSONs.push(json);\n            }\n            profile['geometries'] = geoJSONs;\n        }\n        return profile;\n    }\n\n    /**\n     * Reproduce a VectorLayer from layer's JSON.\n     * @param  {Object} layerJSON - layer's JSON\n     * @return {VectorLayer}\n     * @static\n     * @private\n     * @function\n     */\n    static fromJSON(json) {\n        if (!json || json['type'] !== 'VectorLayer') {\n            return null;\n        }\n        const layer = new VectorLayer(json['id'], json['options']);\n        const geoJSONs = json['geometries'];\n        const geometries = [];\n        for (let i = 0; i < geoJSONs.length; i++) {\n            const geo = Geometry.fromJSON(geoJSONs[i]);\n            if (geo) {\n                geometries.push(geo);\n            }\n        }\n        layer.addGeometry(geometries);\n        if (json['style']) {\n            layer.setStyle(json['style']);\n        }\n        return layer;\n    }\n}\n\nVectorLayer.mergeOptions(options);\n\nVectorLayer.registerJSONType('VectorLayer');\n\nexport default VectorLayer;\n","import Class from '../../core/Class';\nimport Eventable from '../../core/Eventable';\n\nconst key = '_map_tool';\n\n/**\n * @classdesc\n * <pre>\n * The parent class for all the map tools.\n * It is abstract and not intended to be instantiated.\n * Some interface methods to implement:\n * 1. onAdd: optional, a callback method to do some prepares before enabled when the map tool is added to a map\n * 2. onEnable: optional, called when the map tool is enabled, used to setup the context such as adding more event listeners other than the map, disabling map's default handlers (draggable, scrollWheelZoom, etc) and creating temporary layers.\n * 3. getEvents: required, provide an event map to register event listeners on the map.\n * 4. onDisable: optional, called when the map tool is disabled, used to cleanup such as unregistering event listeners, enable map's original handlers and remove temporary layers.\n * </pre>\n * @abstract\n * @category maptool\n * @extends Class\n * @mixes Eventable\n */\nclass MapTool extends Eventable(Class) {\n\n    /**\n     * Adds the map tool to a map.\n     * @param {Map} map\n     * @return {MapTool} this\n     * @fires MapTool#add\n     */\n    addTo(map) {\n        if (!map) {\n            return this;\n        }\n        this._map = map;\n        // map tool is unique on one map\n        if (map[key]) {\n            map[key].disable();\n        }\n        if (this.onAdd) {\n            this.onAdd();\n        }\n        this.enable();\n        map[key] = this;\n\n        /**\n         * add event.\n         *\n         * @event MapTool#add\n         * @type {Object}\n         * @property {String} type - add\n         * @property {MapTool} target - map tool\n         */\n        this._fireEvent('add');\n        return this;\n    }\n\n    /**\n     * Gets the map it added to.\n     * @return {Map} map\n     */\n    getMap() {\n        return this._map;\n    }\n\n    /**\n     * Enable the map tool.\n     * @return {MapTool} this\n     * @fires MapTool#enable\n     */\n    enable() {\n        const map = this._map;\n        if (!map || this._enabled) {\n            return this;\n        }\n        this._enabled = true;\n        this._switchEvents('off');\n\n        this._registerEvents();\n        if (this.onEnable) {\n            this.onEnable();\n        }\n        /**\n         * enable event.\n         *\n         * @event MapTool#enable\n         * @type {Object}\n         * @property {String} type - enable\n         * @property {MapTool} target - map tool\n         */\n        this._fireEvent('enable');\n        return this;\n    }\n\n    /**\n     * Disable the map tool\n     * @return {MapTool} this\n     * @fires MapTool#disable\n     */\n    disable() {\n        if (!this._enabled || !this._map) {\n            return this;\n        }\n        this._enabled = false;\n        this._switchEvents('off');\n        if (this.onDisable) {\n            this.onDisable();\n        }\n        /**\n         * disable event.\n         *\n         * @event MapTool#disable\n         * @type {Object}\n         * @property {String} type - disable\n         * @property {MapTool} target - map tool\n         */\n        this._fireEvent('disable');\n        return this;\n    }\n\n    /**\n     * Returns whether the tool is enabled\n     * @return {Boolean} true | false\n     */\n    isEnabled() {\n        if (!this._enabled) {\n            return false;\n        }\n        return true;\n    }\n\n    remove() {\n        if (!this._map) {\n            return this;\n        }\n        this.disable();\n        if (this._map) {\n            delete this._map[key];\n            delete this._map;\n        }\n        /**\n         * remove event.\n         *\n         * @event MapTool#remove\n         * @type {Object}\n         * @property {String} type - remove\n         * @property {MapTool} target - map tool\n         */\n        this._fireEvent('remove');\n        return this;\n    }\n\n    _registerEvents() {\n        this._switchEvents('on');\n    }\n\n    _switchEvents(to) {\n        const events = this.getEvents();\n        if (events) {\n            this._map[to](events, this);\n        }\n    }\n\n    _fireEvent(eventName, param) {\n        if (!param) {\n            param = {};\n        }\n        this.fire(eventName, param);\n    }\n}\n\nexport default MapTool;\n","import { INTERNAL_LAYER_PREFIX } from '../../core/Constants';\nimport { isNil } from '../../core/util';\nimport { extendSymbol } from '../../core/util/style';\nimport { getExternalResources } from '../../core/util/resource';\nimport { stopPropagation } from '../../core/util/dom';\nimport Polygon from '../../geometry/Polygon';\nimport VectorLayer from '../../layer/VectorLayer';\nimport MapTool from './MapTool';\n\n/**\n * @property {Object} [options=null] - construct options\n * @property {String} [options.mode=null]   - mode of the draw tool\n * @property {Object} [options.symbol=null] - symbol of the geometries drawn\n * @property {Boolean} [options.once=null]  - whether disable immediately once drawn a geometry.\n * @property {Boolean} [options.autoPanAtEdge=false]  - Whether to make edge judgement or not.\n * @memberOf DrawTool\n * @instance\n */\nconst options = {\n    'symbol': {\n        'lineColor': '#000',\n        'lineWidth': 2,\n        'lineOpacity': 1,\n        'polygonFill': '#fff',\n        'polygonOpacity': 0.3\n    },\n    'doubleClickZoom': false,\n    'mode': null,\n    'once': false,\n    'autoPanAtEdge': false,\n    'ignoreMouseleave': true\n};\n\nconst registeredMode = {};\n\n/**\n * A map tool to help draw geometries.\n * @category maptool\n * @extends MapTool\n * @example\n * var drawTool = new DrawTool({\n *     mode : 'Polygon',\n *     symbol : {\n *         'lineColor' : '#000',\n *         'lineWidth' : 5\n *     },\n *     once : true\n * }).addTo(map);\n */\nclass DrawTool extends MapTool {\n\n    /**\n     * Register a new mode for DrawTool\n     * @param  {String} name       mode name\n     * @param  {Object} modeAction modeActions\n     * @param  {Object} modeAction.action the action of DrawTool: click, mousedown, clickDblclick\n     * @param  {Object} modeAction.create the create method of drawn geometry\n     * @param  {Object} modeAction.update the update method of drawn geometry\n     * @param  {Object} modeAction.generate the method to generate geometry at the end of drawing.\n     * @example\n     * //Register \"CubicBezierCurve\" mode to draw Cubic Bezier Curves.\n     * DrawTool.registerMode('CubicBezierCurve', {\n        'action': 'clickDblclick',\n        'create': path => new CubicBezierCurve(path),\n        'update': (path, geometry) => {\n            geometry.setCoordinates(path);\n        },\n        'generate': geometry => geometry\n       }\n     });\n     */\n    static registerMode(name, modeAction) {\n        registeredMode[name.toLowerCase()] = modeAction;\n    }\n\n    /**\n     * Get mode actions by mode name\n     * @param  {String} name DrawTool mode name\n     * @return {Object}      mode actions\n     */\n    static getRegisterMode(name) {\n        return registeredMode[name.toLowerCase()];\n    }\n\n    /**\n     * In default, DrawTool supports the following modes: <br>\n     * [Point, LineString, Polygon, Circle, Ellipse, Rectangle, ArcCurve, QuadBezierCurve, CubicBezierCurve] <br>\n     * You can easily add new mode to DrawTool by calling [registerMode]{@link DrawTool.registerMode}\n     * @param {Object} [options=null] - construct options\n     * @param {String} [options.mode=null]   - mode of the draw tool\n     * @param {Object} [options.symbol=null] - symbol of the geometries drawn\n     * @param {Boolean} [options.once=null]  - whether disable immediately once drawn a geometry.\n     * @param {Boolean} [options.autoPanAtEdge=false]  - Whether to make edge judgement or not.\n     */\n    constructor(options) {\n        super(options);\n        this._checkMode();\n        /**\n         * events\n         * @type {{click: DrawTool._firstClickHandler, mousemove: DrawTool._mouseMoveHandler, dblclick: DrawTool._doubleClickHandler, mousedown: DrawTool._mouseDownHandler, mouseup: DrawTool._mouseUpHandler}}\n         * @private\n         */\n        this._events = {\n            'click': this._firstClickHandler,\n            'mousemove': this._mouseMoveHandler,\n            'dblclick': this._doubleClickHandler,\n            'mousedown': this._mouseDownHandler,\n            'mouseup': this._mouseUpHandler\n        };\n    }\n\n    /**\n     * Get current mode of draw tool\n     * @return {String} mode\n     */\n    getMode() {\n        if (this.options['mode']) {\n            return this.options['mode'].toLowerCase();\n        }\n        return null;\n    }\n\n    /**\n     * Set mode of the draw tool\n     * @param {String} mode - mode of the draw tool\n     * @expose\n     */\n    setMode(mode) {\n        if (this._geometry) {\n            this._geometry.remove();\n            delete this._geometry;\n        }\n        this._clearStage();\n        this._switchEvents('off');\n        this.options['mode'] = mode;\n        this._checkMode();\n        if (this.isEnabled()) {\n            this._switchEvents('on');\n            this._restoreMapCfg();\n            this._saveMapCfg();\n        }\n        return this;\n    }\n\n    /**\n     * Get symbol of the draw tool\n     * @return {Object} symbol\n     */\n    getSymbol() {\n        const symbol = this.options['symbol'];\n        if (symbol) {\n            return extendSymbol(symbol);\n        } else {\n            return extendSymbol(this.options['symbol']);\n        }\n    }\n\n    /**\n     * Set draw tool's symbol\n     * @param {Object} symbol - symbol set\n     * @returns {DrawTool} this\n     */\n    setSymbol(symbol) {\n        if (!symbol) {\n            return this;\n        }\n        this.options['symbol'] = symbol;\n        if (this._geometry) {\n            this._geometry.setSymbol(symbol);\n        }\n        return this;\n    }\n\n    /**\n     * Get geometry is currently drawing\n     * @return {Geometry} geometry currently drawing\n     */\n    getCurrentGeometry() {\n        return this._geometry;\n    }\n\n    onAdd() {\n        this._checkMode();\n    }\n\n    onEnable() {\n        this._saveMapCfg();\n        this._drawToolLayer = this._getDrawLayer();\n        this._clearStage();\n        this._loadResources();\n        if (this.options['autoPanAtEdge']) {\n            const map = this.getMap();\n            this._mapAutoPanAtEdge = map.options['autoPanAtEdge'];\n            if (!this._mapAutoPanAtEdge) {\n                map.config({ autoPanAtEdge: true });\n            }\n        }\n        return this;\n    }\n\n    onDisable() {\n        const map = this.getMap();\n        this._restoreMapCfg();\n        this.endDraw();\n        if (this._map) {\n            map.removeLayer(this._getDrawLayer());\n            if (this.options['autoPanAtEdge']) {\n                if (!this._mapAutoPanAtEdge) {\n                    map.config({ autoPanAtEdge: false });\n                }\n            }\n        }\n        return this;\n    }\n\n    /**\n     * Undo drawing, only applicable for click/dblclick mode\n     * @return {DrawTool} this\n     */\n    undo() {\n        const registerMode = this._getRegisterMode();\n        const action = registerMode.action;\n        if (!this._shouldRecordHistory(action) || !this._historyPointer) {\n            return this;\n        }\n        const coords = this._clickCoords.slice(0, --this._historyPointer);\n        registerMode.update(coords, this._geometry);\n        return this;\n    }\n\n    /**\n     * Redo drawing, only applicable for click/dblclick mode\n     * @return {DrawTool} this\n     */\n    redo() {\n        const registerMode = this._getRegisterMode();\n        const action = registerMode.action;\n        if (!this._shouldRecordHistory(action) || isNil(this._historyPointer) || this._historyPointer === this._clickCoords.length) {\n            return this;\n        }\n        const coords = this._clickCoords.slice(0, ++this._historyPointer);\n        registerMode.update(coords, this._geometry);\n        return this;\n    }\n\n    /**\n     * check should recor history\n     * @param actions\n     * @returns {boolean}\n     * @private\n     */\n    _shouldRecordHistory(actions) {\n        return Array.isArray(actions) && actions[0] === 'click' && actions[1] === 'mousemove' && actions[2] === 'dblclick';\n    }\n\n    _checkMode() {\n        this._getRegisterMode();\n    }\n\n    _saveMapCfg() {\n        const map = this.getMap();\n        this._mapDoubleClickZoom = map.options['doubleClickZoom'];\n        map.config({\n            'doubleClickZoom': this.options['doubleClickZoom']\n        });\n        const actions = this._getRegisterMode()['action'];\n        if (actions.indexOf('mousedown') > -1) {\n            const map = this.getMap();\n            this._mapDraggable = map.options['draggable'];\n            map.config({\n                'draggable': false\n            });\n        }\n    }\n\n    _restoreMapCfg() {\n        const map = this.getMap();\n        map.config({\n            'doubleClickZoom': this._mapDoubleClickZoom\n        });\n        if (!isNil(this._mapDraggable)) {\n            map.config('draggable', this._mapDraggable);\n        }\n        delete this._mapDraggable;\n        delete this._mapDoubleClickZoom;\n    }\n\n    _loadResources() {\n        const symbol = this.getSymbol();\n        const resources = getExternalResources(symbol);\n        if (resources.length > 0) {\n            //load external resources at first\n            this._drawToolLayer._getRenderer().loadResources(resources);\n        }\n    }\n\n    _getProjection() {\n        return this._map.getProjection();\n    }\n\n    _getRegisterMode() {\n        const mode = this.getMode();\n        const registerMode = DrawTool.getRegisterMode(mode);\n        if (!registerMode) {\n            throw new Error(mode + ' is not a valid mode of DrawTool.');\n        }\n        return registerMode;\n    }\n\n    getEvents() {\n        const action = this._getRegisterMode()['action'];\n        const _events = {};\n        if (Array.isArray(action)) {\n            for (let i = 0; i < action.length; i++) {\n                _events[action[i]] = this._events[action[i]];\n            }\n            return _events;\n        }\n        return null;\n    }\n\n    /**\n     * mouse down start draw\n     * @param event\n     * @private\n     */\n    _mouseDownHandler(event) {\n        this._createGeometry(event);\n    }\n\n    /**\n     * handle mouse up event\n     * @param event\n     * @private\n     */\n    _mouseUpHandler(event) {\n        this.endDraw(event);\n    }\n\n    /**\n     * handle mouse first click handle\n     * @param event\n     * @private\n     */\n    _firstClickHandler(event) {\n        const registerMode = this._getRegisterMode();\n        const coordinate = event['coordinate'];\n        if (!this._geometry) {\n            this._createGeometry(event);\n        } else {\n            if (!isNil(this._historyPointer)) {\n                this._clickCoords = this._clickCoords.slice(0, this._historyPointer);\n            }\n            this._clickCoords.push(coordinate);\n            this._historyPointer = this._clickCoords.length;\n            event.drawTool = this;\n            if (registerMode['clickLimit'] && registerMode['clickLimit'] === this._historyPointer) {\n                registerMode['update']([coordinate], this._geometry, event);\n                this.endDraw(event);\n            } else {\n                registerMode['update'](this._clickCoords, this._geometry, event);\n            }\n            /**\n             * drawvertex event.\n             *\n             * @event DrawTool#drawvertex\n             * @type {Object}\n             * @property {String} type - drawvertex\n             * @property {DrawTool} target - draw tool\n             * @property {Geometry} geometry - geometry drawn\n             * @property {Coordinate} coordinate - coordinate of the event\n             * @property {Point} containerPoint  - container point of the event\n             * @property {Point} viewPoint       - view point of the event\n             * @property {Event} domEvent                 - dom event\n             */\n            this._fireEvent('drawvertex', event);\n        }\n    }\n\n    /**\n     * 第一次事件创建相关geometry\n     * @param event\n     * @private\n     */\n    _createGeometry(event) {\n        const mode = this.getMode();\n        const registerMode = this._getRegisterMode();\n        const coordinate = event['coordinate'];\n        const symbol = this.getSymbol();\n        if (!this._geometry) {\n            this._clickCoords = [coordinate];\n            event.drawTool = this;\n            this._geometry = registerMode['create'](this._clickCoords, event);\n            if (symbol && mode !== 'point') {\n                this._geometry.setSymbol(symbol);\n            } else if (this.options.hasOwnProperty('symbol')) {\n                this._geometry.setSymbol(this.options['symbol']);\n            }\n            this._addGeometryToStage(this._geometry);\n            /**\n             * drawstart event.\n             *\n             * @event DrawTool#drawstart\n             * @type {Object}\n             * @property {String} type - drawstart\n             * @property {DrawTool} target - draw tool\n             * @property {Coordinate} coordinate - coordinate of the event\n             * @property {Point} containerPoint  - container point of the event\n             * @property {Point} viewPoint       - view point of the event\n             * @property {Event} domEvent                 - dom event\n             */\n            this._fireEvent('drawstart', event);\n        }\n        if (mode === 'point') {\n            this.endDraw(event);\n        }\n    }\n\n\n    /**\n     * handle mouse move event\n     * @param event\n     * @private\n     */\n    _mouseMoveHandler(event) {\n        const map = this.getMap();\n        const coordinate = event['coordinate'];\n        if (!this._geometry || !map || map.isInteracting()) {\n            return;\n        }\n        const containerPoint = this._getMouseContainerPoint(event);\n        if (!this._isValidContainerPoint(containerPoint)) {\n            return;\n        }\n        event.drawTool = this;\n        const registerMode = this._getRegisterMode();\n        if (this._shouldRecordHistory(registerMode.action)) {\n            const path = this._clickCoords.slice(0, this._historyPointer);\n            if (path && path.length > 0 && coordinate.equals(path[path.length - 1])) {\n                return;\n            }\n            registerMode['update'](path.concat([coordinate]), this._geometry, event);\n        } else {\n            registerMode['update']([coordinate], this._geometry, event);\n        }\n        /**\n         * mousemove event.\n         *\n         * @event DrawTool#mousemove\n         * @type {Object}\n         * @property {String} type - mousemove\n         * @property {DrawTool} target - draw tool\n         * @property {Geometry} geometry - geometry drawn\n         * @property {Coordinate} coordinate - coordinate of the event\n         * @property {Point} containerPoint  - container point of the event\n         * @property {Point} viewPoint       - view point of the event\n         * @property {Event} domEvent                 - dom event\n         */\n        this._fireEvent('mousemove', event);\n    }\n\n    /**\n     * handle mouse double click event\n     * @param event\n     * @private\n     */\n    _doubleClickHandler(event) {\n        if (!this._geometry) {\n            return;\n        }\n        const containerPoint = this._getMouseContainerPoint(event);\n        if (!this._isValidContainerPoint(containerPoint)) {\n            return;\n        }\n        const registerMode = this._getRegisterMode();\n        const clickCoords = this._clickCoords;\n        if (clickCoords.length < 2) {\n            return;\n        }\n        //remove duplicate vertexes\n        const path = [clickCoords[0]];\n        for (let i = 1, len = clickCoords.length; i < len; i++) {\n            if (clickCoords[i].x !== clickCoords[i - 1].x || clickCoords[i].y !== clickCoords[i - 1].y) {\n                path.push(clickCoords[i]);\n            }\n        }\n        if (path.length < 2 || (this._geometry && (this._geometry instanceof Polygon) && path.length < 3)) {\n            return;\n        }\n        event.drawTool = this;\n        registerMode['update'](path, this._geometry, event);\n        this.endDraw(event);\n    }\n\n    _addGeometryToStage(geometry) {\n        const drawLayer = this._getDrawLayer();\n        drawLayer.addGeometry(geometry);\n    }\n\n    /**\n     * End current draw\n     * @param {Object} [param=null] params of drawend event\n     * @returns {DrawTool} this\n     */\n    endDraw(param) {\n        if (!this._geometry || this._ending) {\n            return this;\n        }\n        this._ending = true;\n        const geometry = this._geometry;\n        this._clearStage();\n        param = param || {};\n        this._geometry = geometry;\n        /**\n         * drawend event.\n         *\n         * @event DrawTool#drawend\n         * @type {Object}\n         * @property {String} type - drawend\n         * @property {DrawTool} target - draw tool\n         * @property {Geometry} geometry - geometry drawn\n         * @property {Coordinate} coordinate - coordinate of the event\n         * @property {Point} containerPoint  - container point of the event\n         * @property {Point} viewPoint       - view point of the event\n         * @property {Event} domEvent                 - dom event\n         */\n        this._fireEvent('drawend', param);\n        delete this._geometry;\n        if (this.options['once']) {\n            this.disable();\n        }\n        delete this._ending;\n        return this;\n    }\n\n    _clearStage() {\n        this._getDrawLayer().clear();\n        delete this._geometry;\n        delete this._clickCoords;\n    }\n\n    /**\n     * Get container point of the mouse event\n     * @param  {Event} event -  mouse event\n     * @return {Point}\n     * @private\n     */\n    _getMouseContainerPoint(event) {\n        const action = this._getRegisterMode()['action'];\n        if (action === 'mousedown') {\n            stopPropagation(event['domEvent']);\n        }\n        return event['containerPoint'];\n    }\n\n    _isValidContainerPoint(containerPoint) {\n        const mapSize = this._map.getSize();\n        const w = mapSize['width'],\n            h = mapSize['height'];\n        if (containerPoint.x < 0 || containerPoint.y < 0) {\n            return false;\n        } else if (containerPoint.x > w || containerPoint.y > h) {\n            return false;\n        }\n        return true;\n    }\n\n    _getDrawLayer() {\n        const drawLayerId = INTERNAL_LAYER_PREFIX + 'drawtool';\n        let drawToolLayer = this._map.getLayer(drawLayerId);\n        if (!drawToolLayer) {\n            drawToolLayer = new VectorLayer(drawLayerId, {\n                'enableSimplify': false\n            });\n            this._map.addLayer(drawToolLayer);\n        }\n        return drawToolLayer;\n    }\n\n    _fireEvent(eventName, param) {\n        if (!param) {\n            param = {};\n        }\n        if (this._geometry) {\n            param['geometry'] = this._getRegisterMode()['generate'](this._geometry, { drawTool: this }).copy();\n        }\n        MapTool.prototype._fireEvent.call(this, eventName, param);\n    }\n\n}\n\nDrawTool.mergeOptions(options);\n\nexport default DrawTool;\n","import Handler from '../../handler/Handler';\nimport Map from '../Map';\nimport DrawTool from '../tool/DrawTool';\nimport Extent from '../../geo/Extent';\n\nclass MapBoxZoomHander extends Handler {\n    constructor(target) {\n        super(target);\n        this.drawTool = new DrawTool({\n            'mode'   : 'boxZoom',\n            'ignoreMouseleave' : false\n        });\n    }\n\n    addHooks() {\n        this.target.on('_mousedown', this._onMouseDown, this);\n    }\n\n    removeHooks() {\n        this.target.off('_mousedown', this._onMouseDown, this);\n        if (this.drawTool.isEnabled()) {\n            this.drawTool.remove();\n        }\n    }\n\n    _onMouseDown(param) {\n        if (!this.target.options['boxZoom']) {\n            return;\n        }\n        if (param.domEvent.shiftKey) {\n            this.drawTool.setSymbol(this.target.options['boxZoomSymbol'])\n                .on('drawend', this._boxZoom, this)\n                .addTo(this.target);\n        }\n    }\n\n    _boxZoom(param) {\n        const map = this.target;\n        this.drawTool.remove();\n        const geometry = param.geometry,\n            center = geometry.getCenter(),\n            symbol = geometry.getSymbol(),\n            w = symbol.markerWidth,\n            h = symbol.markerHeight;\n\n        const extent = new Extent(center, map.locateByPoint(center, w, h), map.getProjection());\n        const zoom = map.getFitZoom(extent);\n        map.animateTo({\n            center : extent.getCenter(),\n            zoom : zoom\n        });\n    }\n}\n\nMap.mergeOptions({\n    'boxZoom' : true,\n    'boxZoomSymbol': {\n        'markerType' : 'rectangle',\n        'markerLineWidth' : 3,\n        'markerLineColor' : '#1bbc9b',\n        'markerLineDasharray' : [10, 5],\n        'markerFillOpacity' : 0.1,\n        'markerFill' : '#1bbc9b',\n        'markerWidth' : 1,\n        'markerHeight' : 1\n    }\n});\n\nMap.addOnLoadHook('addHandler', 'boxZoom', MapBoxZoomHander);\n\nexport default MapBoxZoomHander;\n","import Handler from '../../handler/Handler';\nimport Map from '../Map';\n\n// Edge Detection Distance(Units are pixels).\nconst PANOFFSET = 30;\n\nclass MapAutoPanAtEdgeHandler extends Handler {\n    addHooks() {\n        if (!this.target) {\n            return;\n        }\n        this.target.on('_mousemove', this._onMouseMove, this);\n    }\n\n    removeHooks() {\n        if (!this.target) {\n            return;\n        }\n        this.target.off('_mousemove', this._onMouseMove, this);\n    }\n\n    _onMouseMove(event) {\n        const map = this.target;\n        if (map.options['autoPanAtEdge']) {\n            const { containerPoint } = event;\n            const containerExtent = map.getContainerExtent();\n            if (containerExtent) {\n                const { x, y } = containerPoint;\n                const { xmax, ymax } = containerExtent;\n                let p;\n                if (x < PANOFFSET) {\n                    p = [Math.abs(x - PANOFFSET), 0];\n                }\n                if (y < PANOFFSET) {\n                    p = [0, Math.abs(y - PANOFFSET)];\n                }\n                if ((x + PANOFFSET) > xmax) {\n                    p = [-Math.abs((x + PANOFFSET) - xmax), 0];\n                }\n                if ((y + PANOFFSET) > ymax) {\n                    p = [0, -Math.abs((y + PANOFFSET) - ymax)];\n                }\n                if (p) {\n                    map.panBy(p, { duration: 1 });\n                }\n            }\n        }\n    }\n}\n\nMap.mergeOptions({\n    'autoPanAtEdge': false\n});\n\nMap.addOnLoadHook('addHandler', 'autoPanAtEdge', MapAutoPanAtEdgeHandler);\n\nexport default MapAutoPanAtEdgeHandler;\n","import { Animation } from '../core/Animation';\nimport Coordinate from '../geo/Coordinate';\nimport Point from '../geo/Point';\nimport Map from './Map';\nimport { isNil, isFunction, hasOwn } from '../core/util';\n\nfunction equalView(view1, view2) {\n    for (const p in view1) {\n        if (hasOwn(view1, p)) {\n            if (p === 'center') {\n                if (view1[p][0] !== view2[p][0] || view1[p][1] !== view2[p][1]) {\n                    return false;\n                }\n            } else if (view1[p] !== view2[p]) {\n                return false;\n            }\n        }\n    }\n    return true;\n}\n\nMap.include(/** @lends Map.prototype */{\n\n    /**\n     * Update map's view with animation.\n     * @example\n     * map.animateTo({\n     *     zoom : 13,\n     *     center : [0, 0],\n     *     pitch : 30,\n     *     bearing : 60\n     * }, {\n     *     duration : 6000,\n     *     easing : 'out'\n     * }, function(frame) {\n     *     if (frame.state.playState === 'finished') {\n     *         console.log('animation finished');\n     *     }\n     * });\n     * @param  {Object} view    view object\n     * @param  {Object} [options=null]\n     * @param  {String} [options.easing=out]\n     * @param  {Number} [options.duration=map.options.zoomAnimationDuration]\n     * @param  {Function} [step=null]  - step function during animation, animation frame as the parameter\n     * @return {Map}         this\n     */\n    animateTo(view, options = {}, step) {\n        this._stopAnim(this._animPlayer);\n        if (isFunction(options)) {\n            step = options;\n            options = {};\n        }\n        const projection = this.getProjection(),\n            currView = this.getView(),\n            props = {};\n        let empty = true;\n        for (const p in view) {\n            if (hasOwn(view, p) && !isNil(currView[p])) {\n                empty = false;\n                if (p === 'center') {\n                    const from = new Coordinate(currView[p]).toFixed(7),\n                        to = new Coordinate(view[p]).toFixed(7);\n                    if (!from.equals(to)) {\n                        props['center'] = [from, to];\n                    }\n                } else if (currView[p] !== view[p] && p !== 'around') {\n                    props[p] = [currView[p], view[p]];\n                }\n            }\n        }\n        if (empty) {\n            return null;\n        }\n        const zoomOrigin = view['around'] || new Point(this.width / 2, this.height / 2);\n        let preView = this.getView();\n        const renderer = this._getRenderer(),\n            framer = function (fn) {\n                renderer.callInNextFrame(fn);\n            };\n\n        const player = this._animPlayer = Animation.animate(props, {\n            'easing': options['easing'] || 'out',\n            'duration': options['duration'] || this.options['zoomAnimationDuration'],\n            'framer' : framer\n        }, frame => {\n            if (this.isRemoved()) {\n                player.finish();\n                return;\n            }\n            if (player.playState === 'running') {\n                const view = this.getView();\n                if (!options['continueOnViewChanged'] && !equalView(view, preView)) {\n                    // map's view is updated by another operation, animation should stop\n                    this._stopAnim(player);\n                    return;\n                }\n                if (frame.styles['center']) {\n                    const center = frame.styles['center'];\n                    this._setPrjCenter(projection.project(center));\n                    this.onMoving(this._parseEventFromCoord(this.getCenter()));\n                }\n                if (!isNil(frame.styles['zoom'])) {\n                    this.onZooming(frame.styles['zoom'], zoomOrigin);\n                }\n                if (!isNil(frame.styles['pitch'])) {\n                    this.setPitch(frame.styles['pitch']);\n                }\n                if (!isNil(frame.styles['bearing'])) {\n                    this.setBearing(frame.styles['bearing']);\n                }\n                preView = this.getView();\n                /**\n                 * fired when map is animating.  (panning, zooming, rotating)\n                 *\n                 * @event Map#animating\n                 * @type {Object}\n                 * @property {String} type - animating\n                 * @property {Map} target - the map fires the event\n                 */\n                this._fireEvent('animating');\n            } else if (player.playState === 'finished') {\n                if (!player._interupted) {\n                    if (props['center']) {\n                        this._setPrjCenter(projection.project(props['center'][1]));\n                    }\n                    if (!isNil(props['pitch'])) {\n                        this.setPitch(props['pitch'][1]);\n                    }\n                    if (!isNil(props['bearing'])) {\n                        this.setBearing(props['bearing'][1]);\n                    }\n                }\n                this._endAnim(player, props, zoomOrigin, options);\n                preView = this.getView();\n            }\n            if (step) {\n                step(frame);\n            }\n        });\n\n        this._startAnim(props, zoomOrigin);\n\n        return player;\n    },\n\n    /**\n     * Whether the map is animating with .animateTo\n     * @return {Boolean}\n     */\n    isAnimating() {\n        return !!(this._animPlayer);\n    },\n\n    isRotating() {\n        return this.isDragRotating() || !!this._animRotating;\n    },\n\n    _endAnim(player, props, zoomOrigin, options) {\n        delete this._animRotating;\n        /**\n         * fired when map's animation is interrupted by mouse event or else.\n         *\n         * @event Map#animateinterrupted\n         * @type {Object}\n         * @property {String} type - animateinterrupted\n         * @property {Map} target - the map fires the event\n         */\n        /**\n         * fired when map's animation ended (panning, zooming, rotating).\n         *\n         * @event Map#animateend\n         * @type {Object}\n         * @property {String} type - animateend\n         * @property {Map} target - the map fires the event\n         */\n        const evtType = player._interupted ? 'animateinterrupted' : 'animateend';\n        if (player === this._animPlayer) {\n            delete this._animPlayer;\n        }\n        if (props['center']) {\n            let endCoord;\n            if (player._interupted) {\n                endCoord = this.getCenter();\n            } else {\n                endCoord = props['center'][1];\n            }\n            this.onMoveEnd(this._parseEventFromCoord(endCoord));\n        }\n        if (!isNil(props['zoom'])) {\n            if (player._interupted) {\n                this.onZoomEnd(this.getZoom(), zoomOrigin);\n            } else if (!options['wheelZoom']) {\n                this.onZoomEnd(props['zoom'][1], zoomOrigin);\n            } else {\n                this.onZooming(props['zoom'][1], zoomOrigin);\n            }\n        }\n        if (evtType) {\n            this._fireEvent(evtType);\n        }\n        if (!isNil(props['pitch']) && !this.getPitch()) {\n            //https://github.com/maptalks/maptalks.js/issues/732\n            //fix blank map when pitch changes to 0\n            this.getRenderer().setToRedraw();\n        }\n    },\n\n    _startAnim(props, zoomOrigin) {\n        if (!this._animPlayer) {\n            return;\n        }\n        if (props['center']) {\n            this.onMoveStart();\n        }\n        if (props['zoom'] && !this.isZooming()) {\n            this.onZoomStart(props['zoom'][1], zoomOrigin);\n        }\n        if (props['pitch'] || props['bearing']) {\n            this._animRotating = true;\n        }\n        /**\n         * fired when map starts to animate (panning, zooming, rotating).\n         *\n         * @event Map#animatestart\n         * @type {Object}\n         * @property {String} type - animatestart\n         * @property {Map} target - the map fires the event\n         */\n        this._fireEvent('animatestart');\n        this._animPlayer.play();\n    },\n\n    _stopAnim(player) {\n        if (player && player.playState !== 'finished') {\n            player._interupted = true;\n            player.finish();\n        }\n    }\n});\n","import { now, extend } from '../core/util';\nimport {\n    addDomEvent,\n    removeDomEvent,\n    preventDefault,\n    getEventContainerPoint\n} from '../core/util/dom';\nimport Map from './Map';\n\nconst events =\n    /**\n     * mousedown event\n     * @event Map#mousedown\n     * @type {Object}\n     * @property {String} type                    - mousedown\n     * @property {Map} target            - the map fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'mousedown ' +\n    /**\n     * mouseup event\n     * @event Map#mouseup\n     * @type {Object}\n     * @property {String} type                    - mouseup\n     * @property {Map} target            - the map fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'mouseup ' +\n    /**\n     * mouseover event\n     * @event Map#mouseover\n     * @type {Object}\n     * @property {String} type                    - mouseover\n     * @property {Map} target            - the map fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'mouseover ' +\n    /**\n     * mouseout event\n     * @event Map#mouseout\n     * @type {Object}\n     * @property {String} type                    - mouseout\n     * @property {Map} target            - the map fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'mouseout ' +\n    /**\n     * mouseenter event\n     * @event Map#mouseenter\n     * @type {Object}\n     * @property {String} type                    - mouseenter\n     * @property {Map} target            - the map fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'mouseenter ' +\n    /**\n     * mouseleave event\n     * @event Map#mouseleave\n     * @type {Object}\n     * @property {String} type                    - mouseleave\n     * @property {Map} target            - the map fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'mouseleave ' +\n    /**\n     * mousemove event\n     * @event Map#mousemove\n     * @type {Object}\n     * @property {String} type                    - mousemove\n     * @property {Map} target            - the map fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'mousemove ' +\n    /**\n     * click event\n     * @event Map#click\n     * @type {Object}\n     * @property {String} type                    - click\n     * @property {Map} target            - the map fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'click ' +\n    /**\n     * dblclick event\n     * @event Map#dblclick\n     * @type {Object}\n     * @property {String} type                    - dblclick\n     * @property {Map} target            - the map fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'dblclick ' +\n    /**\n     * contextmenu event\n     * @event Map#contextmenu\n     * @type {Object}\n     * @property {String} type                    - contextmenu\n     * @property {Map} target            - the map fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'contextmenu ' +\n    /**\n     * keypress event\n     * @event Map#keypress\n     * @type {Object}\n     * @property {String} type                    - keypress\n     * @property {Map} target            - the map fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'keypress ' +\n    /**\n     * touchstart event\n     * @event Map#touchstart\n     * @type {Object}\n     * @property {String} type                    - touchstart\n     * @property {Map} target            - the map fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'touchstart ' +\n    /**\n     * touchmove event\n     * @event Map#touchmove\n     * @type {Object}\n     * @property {String} type                    - touchmove\n     * @property {Map} target            - the map fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'touchmove ' +\n    /**\n     * touchend event\n     * @event Map#touchend\n     * @type {Object}\n     * @property {String} type                    - touchend\n     * @property {Map} target            - the map fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'touchend ';\n\nMap.include(/** @lends Map.prototype */ {\n    _registerDomEvents() {\n        const dom = this._panels.mapWrapper || this._containerDOM;\n        addDomEvent(dom, events, this._handleDOMEvent, this);\n    },\n\n    _removeDomEvents() {\n        const dom = this._panels.mapWrapper || this._containerDOM;\n        removeDomEvent(dom, events, this._handleDOMEvent, this);\n    },\n\n    _handleDOMEvent(e) {\n        const type = e.type;\n        // prevent default contextmenu\n        if (type === 'contextmenu') {\n            preventDefault(e);\n        }\n        if (this._ignoreEvent(e)) {\n            return;\n        }\n        let mimicClick = false;\n        // ignore click lasted for more than 300ms.\n        if (type === 'mousedown' || (type === 'touchstart' && e.touches.length === 1)) {\n            this._mouseDownTime = now();\n        } else if ((type === 'click' || type === 'touchend' || type === 'contextmenu')) {\n            if (!this._mouseDownTime) {\n                //mousedown | touchstart propogation is stopped\n                //ignore the click/touchend/contextmenu\n                return;\n            } else {\n                const downTime = this._mouseDownTime;\n                delete this._mouseDownTime;\n                const time = now();\n                if (time - downTime > 300) {\n                    if (type === 'click' || type === 'contextmenu') {\n                        return;\n                    }\n                } else if (type === 'touchend') {\n                    mimicClick = true;\n                }\n            }\n        }\n        this._fireDOMEvent(this, e, type);\n        if (mimicClick) {\n            if (this._clickTime && (now() - this._clickTime <= 300)) {\n                delete this._clickTime;\n                this._fireDOMEvent(this, e, 'dblclick');\n            } else {\n                this._clickTime = now();\n                this._fireDOMEvent(this, e, 'click');\n            }\n        }\n    },\n\n    _ignoreEvent(domEvent) {\n        //ignore events originated from control and ui doms.\n        if (!domEvent || !this._panels.control) {\n            return false;\n        }\n        if (this._isEventOutMap(domEvent)) {\n            return true;\n        }\n        let target = domEvent.srcElement || domEvent.target;\n        let preTarget;\n        if (target) {\n            while (target && target !== this._containerDOM) {\n                if (target.className && target.className.indexOf &&\n                    (target.className.indexOf('maptalks-control') >= 0  || (target.className.indexOf('maptalks-ui') >= 0 && !preTarget['eventsPropagation']))) {\n                    return true;\n                }\n                preTarget = target;\n                target = target.parentNode;\n            }\n\n        }\n        return false;\n    },\n\n    _isEventOutMap(domEvent) {\n        if (this.getPitch() > this.options['maxVisualPitch']) {\n            const actualEvent = this._getActualEvent(domEvent);\n            const eventPos = getEventContainerPoint(actualEvent, this._containerDOM);\n            if (!this.getContainerExtent().contains(eventPos)) {\n                return true;\n            }\n        }\n        return false;\n    },\n\n    _parseEvent(e, type) {\n        if (!e) {\n            return null;\n        }\n        let eventParam = {\n            'domEvent': e\n        };\n        if (type !== 'keypress') {\n            const actual = this._getActualEvent(e);\n            if (actual) {\n                const containerPoint = getEventContainerPoint(actual, this._containerDOM);\n                eventParam = extend(eventParam, {\n                    'coordinate' : this.containerPointToCoord(containerPoint),\n                    'containerPoint' : containerPoint,\n                    'viewPoint' : this.containerPointToViewPoint(containerPoint),\n                    'point2d' : this._containerPointToPoint(containerPoint),\n                });\n            }\n        }\n        return eventParam;\n    },\n\n    _parseEventFromCoord(coord) {\n        const containerPoint = this.coordToContainerPoint(coord),\n            viewPoint = this.containerPointToViewPoint(containerPoint);\n        const e = {\n            'coordinate' : coord,\n            'containerPoint' : containerPoint,\n            'viewPoint' : viewPoint,\n            'point2d' : this.coordToPoint(coord)\n        };\n        return e;\n    },\n\n    _getActualEvent(e) {\n        return e.touches && e.touches.length > 0 ?\n            e.touches[0] : e.changedTouches && e.changedTouches.length > 0 ?\n                e.changedTouches[0] : e;\n    },\n\n    _fireDOMEvent(target, e, type) {\n        if (this.isRemoved()) {\n            return;\n        }\n        const eventParam = this._parseEvent(e, type);\n        this._fireEvent(type, eventParam);\n    }\n\n    // _onKeyPress(e) {\n    //     if (!this.isRemoved() && e.keyCode === 48 && e.ctrlKey) {\n    //         this.setBearing(0);\n    //     }\n    // }\n});\n\nMap.addOnLoadHook('_registerDomEvents');\n","import Map from './Map';\n\nMap.include(/** @lends Map.prototype */ {\n    /**\n     * @return {Boolean} Element is currently in fullscreen.\n     */\n    isFullScreen() {\n        return !!(\n            document.webkitIsFullScreen || document.mozFullScreen ||\n            document.msFullscreenElement || document.fullscreenElement\n        );\n    },\n\n    /**\n     * Request for the full screen\n     * @property {Object} dom -containerDOM to requestFullScreen\n     * @return {Map} this\n     * @fires Map#fullscreenstart\n     * @fires Map#fullscreenend\n     */\n    requestFullScreen(dom) {\n        /**\n         * fullscreenstart event\n         * @event Map#fullscreenstart\n         * @type {Object}\n         * @property {String} type                    - fullscreenstart\n         * @property {Map} target            - the map fires event\n         */\n        this._fireEvent('fullscreenstart');\n        this._requestFullScreen(dom || this._containerDOM);\n        /**\n         * fullscreenend event\n         * @event Map#fullscreenend\n         * @type {Object}\n         * @property {String} type                    - fullscreenend\n         * @property {Map} target            - the map fires event\n         */\n        this._fireEvent('fullscreenend');\n        return this;\n    },\n\n    /**\n     * Cancel full screen\n     * @return {Map} this\n     * @fires Map#cancelfullscreen\n     */\n    cancelFullScreen() {\n        this._cancelFullScreen();\n        /**\n         * cancelfullscreen event\n         * @event Map#cancelfullscreen\n         * @type {Object}\n         * @property {String} type                    - cancelfullscreen\n         * @property {Map} target            - the map fires event\n         */\n        this._fireEvent('cancelfullscreen');\n        return this;\n    },\n\n    _requestFullScreen(dom) {\n        if (dom.requestFullScreen) {\n            dom.requestFullScreen();\n        } else if (dom.mozRequestFullScreen) {\n            dom.mozRequestFullScreen();\n        } else if (dom.webkitRequestFullScreen) {\n            dom.webkitRequestFullScreen();\n        } else if (dom.msRequestFullScreen) {\n            dom.msRequestFullScreen();\n        } else {\n            const features = 'fullscreen=1,status=no,resizable=yes,top=0,left=0,scrollbars=no,' +\n                'titlebar=no,menubar=no,location=no,toolbar=no,z-look=yes,' +\n                'width=' + (screen.availWidth - 8) + ',height=' + (screen.availHeight - 45);\n            const newWin = window.open(location.href, '_blank', features);\n            if (newWin !== null) {\n                window.opener = null;\n                //close parent window\n                window.close();\n            }\n        }\n    },\n\n    _cancelFullScreen() {\n        if (document.cancelFullScreen) {\n            document.cancelFullScreen();\n        } else if (document.mozCancelFullScreen) {\n            document.mozCancelFullScreen();\n        } else if (document.webkitCancelFullScreen) {\n            document.webkitCancelFullScreen();\n        } else {\n            const features = 'fullscreen=no,status=yes,resizable=yes,scrollbars=no,' +\n                'titlebar=no,menubar=yes,location=yes,toolbar=yes,z-look=yes';\n            const newWin = window.open(location.href, '_blank', features);\n            if (newWin !== null) {\n                window.opener = null;\n                //close parent window\n                window.close();\n            }\n        }\n    }\n});\n","import Coordinate from '../geo/Coordinate';\nimport Point from '../geo/Point';\nimport Map from './Map';\nimport { isFunction } from '../core/util';\n\nMap.include(/** @lends Map.prototype */ {\n\n    /**\n     * Pan to the given coordinate\n     * @param {Coordinate} coordinate - coordinate to pan to\n     * @param {Object} [options=null] - pan options\n     * @param {Boolean} [options.animation=null] - whether pan with animation\n     * @param {Boolean} [options.duration=600] - pan animation duration\n     * @return {Map} this\n     */\n    panTo: function (coordinate, options = {}, step) {\n        if (!coordinate) {\n            return this;\n        }\n        if (isFunction(options)) {\n            step = options;\n            options = {};\n        }\n        coordinate = new Coordinate(coordinate);\n        if (typeof (options['animation']) === 'undefined' || options['animation']) {\n            return this._panAnimation(coordinate, options['duration'], step);\n        } else {\n            this.setCenter(coordinate);\n            return this;\n        }\n    },\n\n    /**\n     * Pan the map by the give point\n     * @param  {Point} point - distance to pan, in pixel\n     * @param {Object} [options=null] - pan options\n     * @param {Boolean} [options.animation=null] - whether pan with animation\n     * @param {Boolean} [options.duration=600] - pan animation duration\n     * @return {Map} this\n     */\n    panBy: function (offset, options = {}, step) {\n        if (!offset) {\n            return this;\n        }\n        if (isFunction(options)) {\n            step = options;\n            options = {};\n        }\n        offset = new Point(offset);\n        this.onMoveStart();\n        if (typeof (options['animation']) === 'undefined' || options['animation']) {\n            offset = offset.multi(-1);\n            const target = this.locateByPoint(this.getCenter(), offset.x, offset.y);\n            this._panAnimation(target, options['duration'], step);\n        } else {\n            this._offsetCenterByPixel(offset);\n            this.onMoveEnd(this._parseEventFromCoord(this.getCenter()));\n        }\n        return this;\n    },\n\n    _panAnimation: function (target, t, cb) {\n        return this.animateTo({\n            'center': target\n        }, {\n            'duration': t || this.options['panAnimationDuration'],\n        }, cb);\n    }\n});\n","/** Profile **/\nimport {\n    extend,\n    isNil,\n    isObject,\n    isArrayHasData\n} from '../core/util';\nimport Layer from '../layer/Layer';\nimport Map from './Map';\nimport Geometry from '../geometry/Geometry';\nimport GeoJSON from '../geometry/GeoJSON';\n\n/**\n * Produce a geometry from one or more [JSON]{@link Geometry#toJSON} or GeoJSON.\n * @param  {Object} json - a geometry's JSON or a geojson\n * @return {Geometry} geometry\n * @example\n * var profile = {\n        \"feature\": {\n              \"type\": \"Feature\",\n              \"id\" : \"point1\",\n              \"geometry\": {\"type\": \"Point\", \"coordinates\": [102.0, 0.5]},\n              \"properties\": {\"prop0\": \"value0\"}\n        },\n        //construct options.\n        \"options\":{\n            \"draggable\" : true\n        },\n        //symbol\n        \"symbol\":{\n            \"markerFile\"  : \"http://foo.com/icon.png\",\n            \"markerWidth\" : 20,\n            \"markerHeight\": 20\n        }\n    };\n    const marker = Geometry.fromJSON(profile);\n */\nGeometry.fromJSON = function (json) {\n    if (Array.isArray(json)) {\n        let result = [];\n        for (let i = 0, len = json.length; i < len; i++) {\n            const c = Geometry.fromJSON(json[i]);\n            if (Array.isArray(json)) {\n                result = result.concat(c);\n            } else {\n                result.push(c);\n            }\n        }\n        return result;\n    }\n\n    if (json && !json['feature']) {\n        return GeoJSON.toGeometry(json);\n    }\n    let geometry;\n    if (json['subType']) {\n        geometry = Geometry.getJSONClass(json['subType']).fromJSON(json);\n        if (!isNil(json['feature']['id'])) {\n            geometry.setId(json['feature']['id']);\n        }\n    } else {\n        geometry = GeoJSON.toGeometry(json['feature']);\n        if (json['options']) {\n            geometry.config(json['options']);\n        }\n    }\n    if (json['symbol']) {\n        geometry.setSymbol(json['symbol']);\n    }\n    if (json['infoWindow']) {\n        geometry.setInfoWindow(json['infoWindow']);\n    }\n    return geometry;\n};\n\n/**\n * Reproduce a Layer from layer's JSON.\n * @param  {Object} layerJSON - layer's JSON\n * @return {Layer}\n */\nLayer.fromJSON = function (layerJSON) {\n    if (!layerJSON) {\n        return null;\n    }\n    const layerType = layerJSON['type'];\n    const clazz = Layer.getJSONClass(layerType);\n    if (!clazz || !clazz.fromJSON) {\n        throw new Error('unsupported layer type:' + layerType);\n    }\n    return clazz.fromJSON(layerJSON);\n};\n\nMap.include(/** @lends Map.prototype */ {\n    /**\n     * @property {String}  - Version of the [JSON]{@link Map#toJSON} schema.\n     * @constant\n     * @static\n     */\n    'JSON_VERSION': '1.0',\n    /**\n     * Export the map's json, a snapshot of the map in JSON format.<br>\n     * It can be used to reproduce the instance by [fromJSON]{@link Map#fromJSON} method\n     * @param  {Object} [options=null] - export options\n     * @param  {Boolean|Object} [options.baseLayer=null] - whether to export base layer's JSON, if yes, it will be used as layer's toJSON options.\n     * @param  {Boolean|Extent} [options.clipExtent=null] - if set with an extent instance, only the geometries intersectes with the extent will be exported.\n     *                                                             If set to true, map's current extent will be used.\n     * @param  {Boolean|Object|Object[]} [options.layers=null] - whether to export other layers' JSON, if yes, it will be used as layer's toJSON options.\n     *                                                        It can also be an array of layer export options with a \"id\" attribute to filter the layers to export.\n     * @return {Object} layer's JSON\n     */\n    toJSON: function (options) {\n        if (!options) {\n            options = {};\n        }\n        const json = {\n            'jsonVersion': this['JSON_VERSION'],\n            'version': this.VERSION,\n            'extent': this.getExtent().toJSON()\n        };\n        json['options'] = this.config();\n        json['options']['center'] = this.getCenter();\n        json['options']['zoom'] = this.getZoom();\n\n        const baseLayer = this.getBaseLayer();\n        if ((isNil(options['baseLayer']) || options['baseLayer']) && baseLayer) {\n            json['baseLayer'] = baseLayer.toJSON(options['baseLayer']);\n        }\n        const extraLayerOptions = {};\n        if (options['clipExtent']) {\n            //if clipExtent is set, only geometries intersecting with extent will be exported.\n            //clipExtent's value can be an extent or true (map's current extent)\n            if (options['clipExtent'] === true) {\n                extraLayerOptions['clipExtent'] = this.getExtent();\n            } else {\n                extraLayerOptions['clipExtent'] = options['clipExtent'];\n            }\n        }\n        const layersJSON = [];\n        if (isNil(options['layers']) || (options['layers'] && !Array.isArray(options['layers']))) {\n            const layers = this.getLayers();\n            for (let i = 0, len = layers.length; i < len; i++) {\n                if (!layers[i].toJSON) {\n                    continue;\n                }\n                const opts = extend({}, isObject(options['layers']) ? options['layers'] : {}, extraLayerOptions);\n                layersJSON.push(layers[i].toJSON(opts));\n            }\n            json['layers'] = layersJSON;\n        } else if (isArrayHasData(options['layers'])) {\n            const layers = options['layers'];\n            for (let i = 0; i < layers.length; i++) {\n                const exportOption = layers[i];\n                const layer = this.getLayer(exportOption['id']);\n                if (!layer.toJSON) {\n                    continue;\n                }\n                const opts = extend({}, exportOption['options'], extraLayerOptions);\n                layersJSON.push(layer.toJSON(opts));\n            }\n            json['layers'] = layersJSON;\n        } else {\n            json['layers'] = [];\n        }\n        return json;\n    }\n});\n\n/**\n * Reproduce a map from map's profile JSON.\n * @param {(string|HTMLElement|object)} container - The container to create the map on, can be:<br>\n *                                          1. A HTMLElement container.<br/>\n *                                          2. ID of a HTMLElement container.<br/>\n *                                          3. A canvas compatible container in node,\n *                                          e.g. [node-canvas]{@link https://github.com/Automattic/node-canvas},\n *                                              [canvas2svg]{@link https://github.com/gliffy/canvas2svg}\n * @param  {Object} mapJSON - map's profile JSON\n * @param  {Object} [options=null] - options\n * @param  {Object} [options.baseLayer=null] - whether to import the baseLayer\n * @param  {Object} [options.layers=null]    - whether to import the layers\n * @return {Map}\n * @static\n * @function\n * @example\n * var map = Map.fromJSON('map', mapProfile);\n */\nMap.fromJSON = function (container, profile, options) {\n    if (!container || !profile) {\n        return null;\n    }\n    if (!options) {\n        options = {};\n    }\n    const map = new Map(container, profile['options']);\n    if (isNil(options['baseLayer']) || options['baseLayer']) {\n        const baseLayer = Layer.fromJSON(profile['baseLayer']);\n        if (baseLayer) {\n            map.setBaseLayer(baseLayer);\n        }\n    }\n    if (isNil(options['layers']) || options['layers']) {\n        const layers = [];\n        const layerJSONs = profile['layers'];\n        for (let i = 0; i < layerJSONs.length; i++) {\n            const layer = Layer.fromJSON(layerJSONs[i]);\n            layers.push(layer);\n        }\n        map.addLayer(layers);\n    }\n\n    return map;\n};\n","import { INTERNAL_LAYER_PREFIX } from '../core/Constants';\nimport { extend, isString, isArrayHasData, pushIn } from '../core/util';\nimport Coordinate from '../geo/Coordinate';\nimport Map from './Map';\n\n/**\n * Methods of topo computations\n */\nMap.include(/** @lends Map.prototype */ {\n    /**\n     * Caculate distance of two coordinates.\n     * @param {Number[]|Coordinate} coord1 - coordinate 1\n     * @param {Number[]|Coordinate} coord2 - coordinate 2\n     * @return {Number} distance, unit is meter\n     * @example\n     * var distance = map.computeLength([0, 0], [0, 20]);\n     */\n    computeLength: function (coord1, coord2) {\n        if (!this.getProjection()) {\n            return null;\n        }\n        const p1 = new Coordinate(coord1),\n            p2 = new Coordinate(coord2);\n        if (p1.equals(p2)) {\n            return 0;\n        }\n        return this.getProjection().measureLength(p1, p2);\n    },\n\n    /**\n     * Caculate a geometry's length.\n     * @param {Geometry} geometry - geometry to caculate\n     * @return {Number} length, unit is meter\n     */\n    computeGeometryLength: function (geometry) {\n        return geometry._computeGeodesicLength(this.getProjection());\n    },\n\n    /**\n     * Caculate a geometry's area.\n     * @param  {Geometry} geometry - geometry to caculate\n     * @return {Number} area, unit is sq.meter\n     */\n    computeGeometryArea: function (geometry) {\n        return geometry._computeGeodesicArea(this.getProjection());\n    },\n\n    /**\n     * Identify the geometries on the given coordinate.\n     * @param {Object} opts - the identify options\n     * @param {Coordinate} opts.coordinate - coordinate to identify\n     * @param {Object}   opts.layers        - the layers to perform identify on.\n     * @param {Function} [opts.filter=null] - filter function of the result geometries, return false to exclude.\n     * @param {Number}   [opts.count=null]  - limit of the result count.\n     * @param {Number}   [opts.tolerance=0] - identify tolerance in pixel.\n     * @param {Boolean}  [opts.includeInternals=false] - whether to identify internal layers.\n     * @param {Boolean}  [opts.includeInvisible=false] - whether to identify invisible layers.\n     * @param {Function} callback           - the callback function using the result geometries as the parameter.\n     * @return {Map} this\n     * @example\n     * map.identify({\n     *      coordinate: [0, 0],\n     *      layers: [layer]\n     *  },\n     *  geos => {\n     *      console.log(geos);\n     *  });\n     */\n    identify: function (opts, callback) {\n        if (!opts) {\n            return this;\n        }\n        const reqLayers = opts['layers'];\n        if (!isArrayHasData(reqLayers)) {\n            return this;\n        }\n        const layers = [];\n        for (let i = 0, len = reqLayers.length; i < len; i++) {\n            if (isString(reqLayers[i])) {\n                layers.push(this.getLayer(reqLayers[i]));\n            } else {\n                layers.push(reqLayers[i]);\n            }\n        }\n        const coordinate = new Coordinate(opts['coordinate']);\n        const options = extend({}, opts);\n        const hits = [];\n        for (let i = layers.length - 1; i >= 0; i--) {\n            if (opts['count'] && hits.length >= opts['count']) {\n                break;\n            }\n            const layer = layers[i];\n            if (!layer || !layer.getMap() || (!opts['includeInvisible'] && !layer.isVisible()) || (!opts['includeInternals'] && layer.getId().indexOf(INTERNAL_LAYER_PREFIX) >= 0)) {\n                continue;\n            }\n            const layerHits = layer.identify(coordinate, options);\n            if (layerHits) {\n                if (Array.isArray(layerHits)) {\n                    pushIn(hits, layerHits);\n                } else {\n                    hits.push(layerHits);\n                }\n            }\n        }\n        callback.call(this, hits);\n        return this;\n    }\n\n});\n","import { isNil } from '../core/util';\nimport Point from '../geo/Point';\nimport Map from './Map';\n\nMap.include(/** @lends Map.prototype */{\n\n    _zoom(nextZoom, origin) {\n        if (!this.options['zoomable'] || this.isZooming()) { return; }\n        origin = this._checkZoomOrigin(origin);\n        nextZoom = this._checkZoom(nextZoom);\n        this.onZoomStart(nextZoom, origin);\n        this._frameZoom = this.getZoom();\n        this.onZoomEnd(nextZoom, origin);\n    },\n\n    _zoomAnimation(nextZoom, origin, startScale) {\n        if (!this.options['zoomable'] || this.isZooming()) { return; }\n\n        nextZoom = this._checkZoom(nextZoom);\n        if (this.getZoom() === nextZoom) {\n            return;\n        }\n        origin = this._checkZoomOrigin(origin);\n        this._startZoomAnim(nextZoom, origin, startScale);\n    },\n\n    _checkZoomOrigin(origin) {\n        if (!origin || this.options['zoomInCenter']) {\n            origin = new Point(this.width / 2, this.height / 2);\n        }\n        return origin;\n    },\n\n    _startZoomAnim(nextZoom, origin, startScale) {\n        if (isNil(startScale)) {\n            startScale = 1;\n        }\n        const endScale = this._getResolution(this._startZoomVal) / this._getResolution(nextZoom);\n        const duration = this.options['zoomAnimationDuration'] * Math.abs(endScale - startScale) / Math.abs(endScale - 1);\n        this._frameZoom = this._startZoomVal;\n        this.animateTo({\n            'zoom' : nextZoom,\n            'around' : origin\n        }, {\n            'continueOnViewChanged' : true,\n            'duration' : duration\n        });\n    },\n\n    onZoomStart(nextZoom, origin) {\n        if (!this.options['zoomable'] || this.isZooming()) { return; }\n        this._zooming = true;\n        this._startZoomVal = this.getZoom();\n        this._startZoomCoord = this._containerPointToPrj(origin);\n        /**\n          * zoomstart event\n          * @event Map#zoomstart\n          * @type {Object}\n          * @property {String} type                    - zoomstart\n          * @property {Map} target                     - the map fires event\n          * @property {Number} from                    - zoom level zooming from\n          * @property {Number} to                      - zoom level zooming to\n          */\n        this._fireEvent('zoomstart', { 'from' : this._startZoomVal, 'to': nextZoom });\n    },\n\n    onZooming(nextZoom, origin, startScale) {\n        if (!this.options['zoomable']) { return; }\n        const frameZoom = this._frameZoom;\n        if (frameZoom === nextZoom) {\n            return;\n        }\n        if (isNil(startScale)) {\n            startScale = 1;\n        }\n        this._zoomTo(nextZoom, origin);\n        const res = this.getResolution(nextZoom),\n            fromRes = this.getResolution(this._startZoomVal),\n            scale = fromRes / res / startScale,\n            startPoint = this._prjToContainerPoint(this._startZoomCoord, this._startZoomVal);\n        const offset = this.getViewPoint();\n        if (!this.isRotating() && !startPoint.equals(origin) && scale !== 1) {\n            const pitch = this.getPitch();\n            // coordinate at origin changed, usually by map.setCenter\n            // add origin offset\n            const originOffset = startPoint._sub(origin)._multi(1 / (1 - scale));\n            if (pitch) {\n                //FIXME Math.cos(pitch * Math.PI / 180) is just a magic num, works when tilting but may have problem when rotating\n                originOffset.y /= Math.cos(pitch * Math.PI / 180);\n            }\n            origin = origin.add(originOffset);\n        }\n        const matrix = {\n            'view' : [scale, 0, 0, scale, (origin.x - offset.x) *  (1 - scale), (origin.y - offset.y) *  (1 - scale)]\n        };\n        const dpr = this.getDevicePixelRatio();\n        if (dpr !== 1) {\n            origin = origin.multi(dpr);\n        }\n        matrix['container'] = [scale, 0, 0, scale, origin.x * (1 - scale), origin.y *  (1 - scale)];\n        /**\n          * zooming event\n          * @event Map#zooming\n          * @type {Object}\n          * @property {String} type                    - zooming\n          * @property {Map} target                     - the map fires event\n          * @property {Number} from                    - zoom level zooming from\n          * @property {Number} to                      - zoom level zooming to\n          */\n        this._fireEvent('zooming', { 'from' : this._startZoomVal, 'to': nextZoom, 'origin' : origin, 'matrix' : matrix });\n        this._frameZoom = nextZoom;\n    },\n\n    onZoomEnd(nextZoom, origin) {\n        if (!this.options['zoomable']) { return; }\n        const startZoomVal = this._startZoomVal;\n        this._zoomTo(nextZoom, origin);\n        this._zooming = false;\n        this._getRenderer().onZoomEnd();\n\n        /**\n          * zoomend event\n          * @event Map#zoomend\n          * @type {Object}\n          * @property {String} type                    - zoomend\n          * @property {Map} target                     - the map fires event\n          * @property {Number} from                    - zoom level zooming from\n          * @property {Number} to                      - zoom level zooming to\n          */\n        this._fireEvent('zoomend', { 'from' : startZoomVal, 'to': nextZoom });\n        if (!this._verifyExtent(this.getCenter())) {\n            this.panTo(this.getMaxExtent().getCenter());\n        }\n    },\n\n    _zoomTo(nextZoom, origin) {\n        this._zoomLevel = nextZoom;\n        this._calcMatrices();\n        if (origin) {\n            this._setPrjCoordAtContainerPoint(this._startZoomCoord, origin);\n        }\n    },\n\n    _checkZoom(nextZoom) {\n        const maxZoom = this.getMaxZoom(),\n            minZoom = this.getMinZoom();\n        if (nextZoom < minZoom) {\n            nextZoom = minZoom;\n        }\n        if (nextZoom > maxZoom) {\n            nextZoom = maxZoom;\n        }\n        return nextZoom;\n    }\n});\n","/*eslint-disable no-var*/\n// Contains code from glmatrix.js\n\nexport function perspective(out, fovy, aspect, near, far) {\n    var f = 1.0 / Math.tan(fovy / 2),\n        nf = 1 / (near - far);\n    out[0] = f / aspect;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[5] = f;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[10] = (far + near) * nf;\n    out[11] = -1;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 2 * far * near * nf;\n    out[15] = 0;\n    return out;\n}\n\nexport function translate(out, a, v) {\n    var x = v[0],\n        y = v[1],\n        z = v[2],\n        a00,\n        a01,\n        a02,\n        a03,\n        a10,\n        a11,\n        a12,\n        a13,\n        a20,\n        a21,\n        a22,\n        a23;\n\n    if (a === out) {\n        out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n        out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n        out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n        out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n    } else {\n        a00 = a[0]; a01 = a[1]; a02 = a[2]; a03 = a[3];\n        a10 = a[4]; a11 = a[5]; a12 = a[6]; a13 = a[7];\n        a20 = a[8]; a21 = a[9]; a22 = a[10]; a23 = a[11];\n\n        out[0] = a00; out[1] = a01; out[2] = a02; out[3] = a03;\n        out[4] = a10; out[5] = a11; out[6] = a12; out[7] = a13;\n        out[8] = a20; out[9] = a21; out[10] = a22; out[11] = a23;\n\n        out[12] = a00 * x + a10 * y + a20 * z + a[12];\n        out[13] = a01 * x + a11 * y + a21 * z + a[13];\n        out[14] = a02 * x + a12 * y + a22 * z + a[14];\n        out[15] = a03 * x + a13 * y + a23 * z + a[15];\n    }\n\n    return out;\n}\n\nexport function scale(out, a, v) {\n    var x = v[0],\n        y = v[1],\n        z = v[2];\n\n    out[0] = a[0] * x;\n    out[1] = a[1] * x;\n    out[2] = a[2] * x;\n    out[3] = a[3] * x;\n    out[4] = a[4] * y;\n    out[5] = a[5] * y;\n    out[6] = a[6] * y;\n    out[7] = a[7] * y;\n    out[8] = a[8] * z;\n    out[9] = a[9] * z;\n    out[10] = a[10] * z;\n    out[11] = a[11] * z;\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n    return out;\n}\n\nexport function rotateX(out, a, rad) {\n    var s = Math.sin(rad),\n        c = Math.cos(rad),\n        a10 = a[4],\n        a11 = a[5],\n        a12 = a[6],\n        a13 = a[7],\n        a20 = a[8],\n        a21 = a[9],\n        a22 = a[10],\n        a23 = a[11];\n\n    if (a !== out) {\n        out[0] = a[0];\n        out[1] = a[1];\n        out[2] = a[2];\n        out[3] = a[3];\n        out[12] = a[12];\n        out[13] = a[13];\n        out[14] = a[14];\n        out[15] = a[15];\n    }\n\n    out[4] = a10 * c + a20 * s;\n    out[5] = a11 * c + a21 * s;\n    out[6] = a12 * c + a22 * s;\n    out[7] = a13 * c + a23 * s;\n    out[8] = a20 * c - a10 * s;\n    out[9] = a21 * c - a11 * s;\n    out[10] = a22 * c - a12 * s;\n    out[11] = a23 * c - a13 * s;\n    return out;\n}\n\nexport function rotateZ(out, a, rad) {\n    var s = Math.sin(rad),\n        c = Math.cos(rad),\n        a00 = a[0],\n        a01 = a[1],\n        a02 = a[2],\n        a03 = a[3],\n        a10 = a[4],\n        a11 = a[5],\n        a12 = a[6],\n        a13 = a[7];\n\n    if (a !== out) {\n        out[8] = a[8];\n        out[9] = a[9];\n        out[10] = a[10];\n        out[11] = a[11];\n        out[12] = a[12];\n        out[13] = a[13];\n        out[14] = a[14];\n        out[15] = a[15];\n    }\n\n    out[0] = a00 * c + a10 * s;\n    out[1] = a01 * c + a11 * s;\n    out[2] = a02 * c + a12 * s;\n    out[3] = a03 * c + a13 * s;\n    out[4] = a10 * c - a00 * s;\n    out[5] = a11 * c - a01 * s;\n    out[6] = a12 * c - a02 * s;\n    out[7] = a13 * c - a03 * s;\n    return out;\n}\n\n/* export function copy(out, a) {\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n    return out;\n} */\n\nexport function multiply(out, a, b) {\n    var a00 = a[0],\n        a01 = a[1],\n        a02 = a[2],\n        a03 = a[3],\n        a10 = a[4],\n        a11 = a[5],\n        a12 = a[6],\n        a13 = a[7],\n        a20 = a[8],\n        a21 = a[9],\n        a22 = a[10],\n        a23 = a[11],\n        a30 = a[12],\n        a31 = a[13],\n        a32 = a[14],\n        a33 = a[15];\n\n    // Cache only the current line of the second matrix\n    var b0 = b[0],\n        b1 = b[1],\n        b2 = b[2],\n        b3 = b[3];\n    out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n    out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n    out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n    out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n\n    b0 = b[4]; b1 = b[5]; b2 = b[6]; b3 = b[7];\n    out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n    out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n    out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n    out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n\n    b0 = b[8]; b1 = b[9]; b2 = b[10]; b3 = b[11];\n    out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n    out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n    out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n    out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n\n    b0 = b[12]; b1 = b[13]; b2 = b[14]; b3 = b[15];\n    out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n    out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n    out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n    out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n    return out;\n}\n\nexport function invert(out, a) {\n    var a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3],\n        a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7],\n        a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11],\n        a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15],\n\n        b00 = a00 * a11 - a01 * a10,\n        b01 = a00 * a12 - a02 * a10,\n        b02 = a00 * a13 - a03 * a10,\n        b03 = a01 * a12 - a02 * a11,\n        b04 = a01 * a13 - a03 * a11,\n        b05 = a02 * a13 - a03 * a12,\n        b06 = a20 * a31 - a21 * a30,\n        b07 = a20 * a32 - a22 * a30,\n        b08 = a20 * a33 - a23 * a30,\n        b09 = a21 * a32 - a22 * a31,\n        b10 = a21 * a33 - a23 * a31,\n        b11 = a22 * a33 - a23 * a32,\n\n        // Calculate the determinant\n        det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n    if (!det) {\n        return null;\n    }\n    det = 1.0 / det;\n\n    out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n    out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n    out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n    out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n    out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n    out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n    out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n    out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n    out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n    out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n    out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n    out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n    out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n    out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n    out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n    out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n\n    return out;\n}\n\n/**\n * Set a mat4 to the identity matrix\n *\n * @param {mat4} out the receiving matrix\n * @returns {mat4} out\n */\nexport function identity(out) {\n    out[0] = 1;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[5] = 1;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[10] = 1;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n    out[15] = 1;\n    return out;\n}\n/*eslint-enable no-var*/\n","/**\n * Set the components of a vec3 to the given values\n *\n * @param {vec3} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} out\n */\nexport function set(out, x, y, z) {\n    out[0] = x;\n    out[1] = y;\n    out[2] = z;\n    return out;\n}\n\n/**\n * Adds two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nexport function add(out, a, b) {\n    out[0] = a[0] + b[0];\n    out[1] = a[1] + b[1];\n    out[2] = a[2] + b[2];\n    return out;\n}\n\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nexport function subtract(out, a, b) {\n    out[0] = a[0] - b[0];\n    out[1] = a[1] - b[1];\n    out[2] = a[2] - b[2];\n    return out;\n}\n\n/**\n * Calculates the length of a vec3\n *\n * @param {vec3} a vector to calculate length of\n * @returns {Number} length of a\n */\nexport function length(a) {\n    const x = a[0],\n        y = a[1],\n        z = a[2];\n    return Math.sqrt(x * x + y * y + z * z);\n}\n\n/**\n * Normalize a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to normalize\n * @returns {vec3} out\n */\nexport function normalize(out, a) {\n    const x = a[0],\n        y = a[1],\n        z = a[2];\n    let len = x * x + y * y + z * z;\n    if (len > 0) {\n        //TODO: evaluate use of glm_invsqrt here?\n        len = 1 / Math.sqrt(len);\n        out[0] = a[0] * len;\n        out[1] = a[1] * len;\n        out[2] = a[2] * len;\n    }\n    return out;\n}\n\n/**\n * Calculates the dot product of two vec3's\n *\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {Number} dot product of a and b\n */\nexport function dot(a, b) {\n    return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n\n/**\n * Scales a vec3 by a scalar number\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec3} out\n */\nexport function scale(out, a, b) {\n    out[0] = a[0] * b;\n    out[1] = a[1] * b;\n    out[2] = a[2] * b;\n    return out;\n}\n\n/**\n * Computes the cross product of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nexport function cross(out, a, b) {\n    const ax = a[0], ay = a[1], az = a[2],\n        bx = b[0], by = b[1], bz = b[2];\n\n    out[0] = ay * bz - az * by;\n    out[1] = az * bx - ax * bz;\n    out[2] = ax * by - ay * bx;\n    return out;\n}\n\nexport function dist(a, b) {\n    const x = b[0] - a[0];\n    const y = b[1] - a[1];\n    const z = b[2] - a[2];\n    return Math.sqrt(x * x + y * y + z * z);\n}\n","import { subtract, length, normalize, cross } from './vec3';\n//contains code from THREE.js\n\nexport function applyMatrix(out, v, e) {\n    const x = v[0], y = v[1], z = v[2];\n    // const e = in;\n\n    const w = 1 / (e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ]);\n\n    out[0] = (e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z + e[ 12 ]) * w;\n    out[1] = (e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z + e[ 13 ]) * w;\n    out[2] = (e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ]) * w;\n\n    return out;\n}\n\nexport function applyMatrix4(out, v, e) {\n    const x = v[0], y = v[1], z = v[2], w = v[3];\n\n    out[0] = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z + e[ 12 ] * w;\n    out[1] = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z + e[ 13 ] * w;\n    out[2] = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ] * w;\n    out[3] = e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ] * w;\n\n    return this;\n\n}\n\nexport function matrixToQuaternion(out, te) {\n    // http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToQuaternion/index.htm\n\n    // assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\n    const m11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ],\n        m21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ],\n        m31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ],\n\n        trace = m11 + m22 + m33;\n    let s;\n\n    if (trace > 0) {\n\n        s = 0.5 / Math.sqrt(trace + 1.0);\n\n        out.w = 0.25 / s;\n        out.x = (m32 - m23) * s;\n        out.y = (m13 - m31) * s;\n        out.z = (m21 - m12) * s;\n\n    } else if (m11 > m22 && m11 > m33) {\n\n        s = 2.0 * Math.sqrt(1.0 + m11 - m22 - m33);\n\n        out.w = (m32 - m23) / s;\n        out.x = 0.25 * s;\n        out.y = (m12 + m21) / s;\n        out.z = (m13 + m31) / s;\n\n    } else if (m22 > m33) {\n\n        s = 2.0 * Math.sqrt(1.0 + m22 - m11 - m33);\n\n        out.w = (m13 - m31) / s;\n        out.x = (m12 + m21) / s;\n        out.y = 0.25 * s;\n        out.z = (m23 + m32) / s;\n\n    } else {\n\n        s = 2.0 * Math.sqrt(1.0 + m33 - m11 - m22);\n\n        out.w = (m21 - m12) / s;\n        out.x = (m13 + m31) / s;\n        out.y = (m23 + m32) / s;\n        out.z = 0.25 * s;\n\n    }\n\n    return this;\n}\n\nexport function quaternionToMatrix(out, q) {\n    const te = out;\n\n    const x = q.x, y = q.y, z = q.z, w = q.w;\n    const x2 = x + x, y2 = y + y, z2 = z + z;\n    const xx = x * x2, xy = x * y2, xz = x * z2;\n    const yy = y * y2, yz = y * z2, zz = z * z2;\n    const wx = w * x2, wy = w * y2, wz = w * z2;\n\n    te[ 0 ] = 1 - (yy + zz);\n    te[ 4 ] = xy - wz;\n    te[ 8 ] = xz + wy;\n\n    te[ 1 ] = xy + wz;\n    te[ 5 ] = 1 - (xx + zz);\n    te[ 9 ] = yz - wx;\n\n    te[ 2 ] = xz - wy;\n    te[ 6 ] = yz + wx;\n    te[ 10 ] = 1 - (xx + yy);\n\n    // last column\n    te[ 3 ] = 0;\n    te[ 7 ] = 0;\n    te[ 11 ] = 0;\n\n    // bottom row\n    te[ 12 ] = 0;\n    te[ 13 ] = 0;\n    te[ 14 ] = 0;\n    te[ 15 ] = 1;\n\n    return te;\n}\n\nexport function setPosition(out, v) {\n    const te = out;\n\n    te[ 12 ] = v[0];\n    te[ 13 ] = v[1];\n    te[ 14 ] = v[2];\n\n    return out;\n}\n\nexport function lookAt(te, eye, target, up) {\n    const x = [0, 0, 0];\n    const y = [0, 0, 0];\n    const z = [0, 0, 0];\n    subtract(z, eye, target);\n\n    if (length(z) === 0) {\n\n        // eye and target are in the same position\n\n        z[2] = 1;\n\n    }\n\n    normalize(z, z);\n    cross(x, up, z);\n\n    if (length(z) === 0) {\n\n        // up and z are parallel\n\n        if (Math.abs(up[2]) === 1) {\n\n            z[0] += 0.0001;\n\n        } else {\n\n            z[2] += 0.0001;\n\n        }\n\n        normalize(z, z);\n        cross(x, up, z);\n\n    }\n\n    normalize(x, x);\n    cross(y, z, x);\n\n    te[ 0 ] = x[0]; te[ 4 ] = y[0]; te[ 8 ] = z[0];\n    te[ 1 ] = x[1]; te[ 5 ] = y[1]; te[ 9 ] = z[1];\n    te[ 2 ] = x[2]; te[ 6 ] = y[2]; te[ 10 ] = z[2];\n\n    return te;\n}\n","import Map from './Map';\nimport Point from '../geo/Point';\nimport Coordinate from '../geo/Coordinate';\nimport * as mat4 from '../core/util/mat4';\nimport { subtract, add, scale, normalize, dot, set, dist as distance } from '../core/util/vec3';\nimport { clamp, interpolate, wrap } from '../core/util';\nimport { applyMatrix, matrixToQuaternion, quaternionToMatrix, lookAt, setPosition } from '../core/util/math';\nimport Browser from '../core/Browser';\n\nconst RADIAN = Math.PI / 180;\nconst DEFAULT_FOV = 0.6435011087932844;\nconst TEMP_COORD = new Coordinate(0, 0);\n\n/*!\n * contains code from mapbox-gl-js\n * https://github.com/mapbox/mapbox-gl-js\n * LICENSE : MIT\n * (c) mapbox\n *\n */\n\nMap.include(/** @lends Map.prototype */{\n    /**\n     * Get map's fov (field of view);\n     * @return {Number} fov in degree\n     */\n    getFov() {\n        if (!this._fov) {\n            this._fov = DEFAULT_FOV;\n        }\n        return this._fov / RADIAN;\n    },\n\n    /**\n     * Set a new fov to map\n     * @param {Number} fov new fov in degree\n     * @return {Map} this\n     */\n    setFov(fov) {\n        if (this.isZooming()) {\n            return this;\n        }\n        fov = Math.max(0.01, Math.min(60, fov));\n        if (this._fov === fov) return this;\n        const from = this.getFov();\n        this._fov = fov * RADIAN;\n        this._calcMatrices();\n        this._renderLayers();\n        /*\n          * fovchange event\n          * @event Map#fovchange\n          * @type {Object}\n          * @property {String} type                    - fovchange\n          * @property {Map} target                     - the map fires event\n          * @property {Number} from                    - fovchange from\n          * @property {Number} to                      - fovchange to\n        */\n        this._fireEvent('fovchange', { 'from' : from, 'to': this.getFov() });\n        return this;\n    },\n\n    /**\n     * Get map's bearing\n     * @return {Number} bearing in degree\n     */\n    getBearing() {\n        if (!this._angle) {\n            return 0;\n        }\n        return -this._angle / RADIAN;\n    },\n\n    /**\n     * Set a new bearing to map\n     * @param {Number} bearing new bearing in degree\n     * @return {Map} this\n     */\n    setBearing(bearing) {\n        if (Browser.ie9) {\n            throw new Error('map can\\'t rotate in IE9.');\n        }\n        const b = -wrap(bearing, -180, 180) * RADIAN;\n        if (this._angle === b) return this;\n        const from = this.getBearing();\n        /*\n          * rotate event\n          * @event Map#rotatestart\n          * @type {Object}\n          * @property {String} type                    - rotatestart\n          * @property {Map} target                     - the map fires event\n          * @property {Number} from                    - bearing rotate from\n          * @property {Number} to                      - bearing rotate to\n        */\n        this._fireEvent('rotatestart', { 'from' : from, 'to': b });\n        this._angle = b;\n        this._calcMatrices();\n        this._renderLayers();\n        /*\n          * rotate event, alias of rotateend, deprecated\n          *\n          * @event Map#rotate\n          * @type {Object}\n          * @property {String} type                    - rotate\n          * @property {Map} target                     - the map fires event\n          * @property {Number} from                    - bearing rotate from\n          * @property {Number} to                      - bearing rotate to\n        */\n        this._fireEvent('rotate', { 'from' : from, 'to': b });\n        /*\n          * rotateend event\n          * @event Map#rotateend\n          * @type {Object}\n          * @property {String} type                    - rotateend\n          * @property {Map} target                     - the map fires event\n          * @property {Number} from                    - bearing rotate from\n          * @property {Number} to                      - bearing rotate to\n        */\n        this._fireEvent('rotateend', { 'from' : from, 'to': b });\n        return this;\n    },\n\n    /**\n     * Get map's pitch\n     * @return {Number} pitch in degree\n     */\n    getPitch() {\n        if (!this._pitch) {\n            return 0;\n        }\n        return this._pitch / Math.PI * 180;\n    },\n\n    /**\n     * Set a new pitch to map\n     * @param {Number} pitch new pitch in degree\n     * @return {Map} this\n     */\n    setPitch(pitch) {\n        if (Browser.ie9) {\n            throw new Error('map can\\'t tilt in IE9.');\n        }\n        const p = clamp(pitch, 0, this.options['maxPitch']) * RADIAN;\n        if (this._pitch === p) return this;\n        const from = this.getPitch();\n        /*\n          * rotate event\n          * @event Map#pitchstart\n          * @type {Object}\n          * @property {String} type                    - pitchstart\n          * @property {Map} target                     - the map fires event\n          * @property {Number} from                    - pitch from\n          * @property {Number} to                      - pitch to\n        */\n        this._fireEvent('pitchstart', { 'from' : from, 'to': p });\n        this._pitch = p;\n        this._calcMatrices();\n        this._renderLayers();\n        /**\n          * pitch event, alias of pitchend, deprecated\n          * @event Map#pitch\n          * @type {Object}\n          * @property {String} type                    - pitch\n          * @property {Map} target                     - the map fires event\n          * @property {Number} from                    - pitch from\n          * @property {Number} to                      - pitch to\n          */\n        this._fireEvent('pitch', { 'from' : from, 'to': p });\n        /**\n          * pitchend event\n          * @event Map#pitchend\n          * @type {Object}\n          * @property {String} type                    - pitchend\n          * @property {Map} target                     - the map fires event\n          * @property {Number} from                    - pitchend from\n          * @property {Number} to                      - pitchend to\n          */\n        this._fireEvent('pitchend', { 'from' : from, 'to': p });\n        return this;\n    },\n\n    /**\n     * Whether the map is rotating or tilting.\n     * @return {Boolean}\n     * @private\n     */\n    isTransforming() {\n        return !!(this._pitch || this._angle);\n    },\n\n    getFrustumAltitude() {\n        return this._frustumAltitude;\n    },\n\n    _calcFrustumAltitude() {\n        const pitch = 90 - this.getPitch();\n        let fov = this.getFov() / 2;\n        const cameraAlt = this.cameraPosition ? this.cameraPosition[2] : 0;\n        if (fov <= pitch) {\n            return cameraAlt;\n        }\n        fov = Math.PI * fov / 180;\n        const d1 = new Point(this.cameraPosition).distanceTo(new Point(this.cameraLookAt)),\n            d2 = cameraAlt * Math.tan(fov * 2);\n        const d = Math.tan(fov) * (d1 + d2);\n        return cameraAlt + d;\n    },\n\n    /**\n     * Convert 2d point at target zoom to containerPoint at current zoom\n     * @param  {Point} point 2d point at target zoom\n     * @param  {Number} zoom  point's zoom\n     * @param  {Number} [altitude=0]  target's altitude in 2d point system at target zoom\n     * @return {Point}       containerPoint at current zoom\n     * @private\n     * @function\n     */\n    _pointToContainerPoint: function () {\n        const a = [0, 0, 0];\n        return function (point, zoom, altitude = 0, out) {\n            point = this._pointToPoint(point, zoom, out);\n            if (this.isTransforming() || altitude) {\n                //convert altitude at zoom to current zoom\n                altitude *= this._getResolution(zoom) / this._getResolution();\n                const scale = this._glScale;\n                set(a, point.x * scale, point.y * scale, altitude * scale);\n\n                const t = this._projIfBehindCamera(a, this.cameraPosition, this.cameraForward);\n                applyMatrix(t, t, this.projViewMatrix);\n\n                const w2 = this.width / 2, h2 = this.height / 2;\n                t[0] = (t[0] * w2) + w2;\n                t[1] = -(t[1] * h2) + h2;\n                if (out) {\n                    out.x = t[0];\n                    out.y = t[1];\n                    return out;\n                }\n                return new Point(t[0], t[1]);\n            } else {\n                const centerPoint = this._prjToPoint(this._getPrjCenter(), undefined, TEMP_COORD);\n                if (out) {\n                    out.x = point.x;\n                    out.y = point.y;\n                } else {\n                    out = point;\n                }\n                return out._sub(centerPoint)._add(this.width / 2, this.height / 2);\n            }\n        };\n    }(),\n\n    // https://forum.unity.com/threads/camera-worldtoscreenpoint-bug.85311/#post-2121212\n    _projIfBehindCamera: function () {\n        const vectorFromCam = new Array(3);\n        const proj = new Array(3);\n        const sub = new Array(3);\n        return function (position, cameraPos, camForward) {\n            subtract(vectorFromCam, position, cameraPos);\n            const camNormDot = dot(camForward, vectorFromCam);\n            if (camNormDot <= 0) {\n                scale(proj, camForward, camNormDot * 1.01);\n                add(position, cameraPos, subtract(sub, vectorFromCam, proj));\n            }\n            return position;\n        };\n    }(),\n\n    /**\n     * Convert containerPoint at current zoom to 2d point at target zoom\n     * from mapbox-gl-js\n     * @param  {Point} p    container point at current zoom\n     * @param  {Number} zoom target zoom, current zoom in default\n     * @return {Point}      2d point at target zoom\n     * @private\n     * @function\n     */\n    _containerPointToPoint: function () {\n        const cp = [0, 0, 0],\n            coord0 = [0, 0, 0, 1],\n            coord1 = [0, 0, 0, 1];\n        return function (p, zoom, out) {\n            if (this.isTransforming()) {\n                const w2 = this.width / 2 || 1, h2 = this.height / 2 || 1;\n                set(cp, (p.x - w2) / w2, (h2 - p.y) / h2, 0);\n\n                set(coord0, cp[0], cp[1], 0);\n                set(coord1, cp[0], cp[1], 1);\n                coord0[3] = coord1[3] = 1;\n\n                applyMatrix(coord0, coord0, this.projViewMatrixInverse);\n                applyMatrix(coord1, coord1, this.projViewMatrixInverse);\n                const x0 = coord0[0];\n                const x1 = coord1[0];\n                const y0 = coord0[1];\n                const y1 = coord1[1];\n                const z0 = coord0[2];\n                const z1 = coord1[2];\n\n                const t = z0 === z1 ? 0 : (0 - z0) / (z1 - z0);\n                const x = interpolate(x0, x1, t);\n                const y = interpolate(y0, y1, t);\n                if (out) {\n                    out.x = x;\n                    out.y = y;\n                } else {\n                    out = new Point(x, y);\n                }\n                out._multi(1 / this._glScale);\n                return ((zoom === undefined || this.getZoom() === zoom) ? out : this._pointToPointAtZoom(out, zoom, out));\n            }\n            const centerPoint = this._prjToPoint(this._getPrjCenter(), zoom, out),\n                scale = (zoom !== undefined ? this._getResolution() / this._getResolution(zoom) : 1);\n            const x = scale * (p.x - this.width / 2),\n                y = scale * (p.y - this.height / 2);\n            return centerPoint._add(x, y);\n        };\n    }(),\n\n    /**\n     * GL Matrices in maptalks (based on THREE):\n     * //based on point at map's gl world zoom, by map.coordToPoint(coord, map.getGLZoom())\n     * map.cameraPosition\n     * map.cameraLookAt\n     * map.cameraUp       //camera's up vector\n     * map.cameraForward  //camera's forward vector\n     * map.cameraWorldMatrix\n     * map.projMatrix\n     * map.viewMatrix = cameraWorldMatrix.inverse()\n     * map.projViewMatrix = projMatrix * viewMatrix\n     * map.projViewMatrixInverse = projViewMatrix.inverse()\n     *  @private\n     */\n    _calcMatrices: function () {\n        // closure matrixes to reuse\n        const m0 = Browser.ie9 ? null : createMat4(),\n            m1 = Browser.ie9 ? null : createMat4();\n        return function () {\n            // get pixel size of map\n            if (Browser.ie9) {\n                return;\n            }\n            const sr = this.getSpatialReference();\n            //必须先删除缓存的常用值，否则后面计算常用值时，会循环引用造成错误\n            delete this._mapRes;\n            delete this._mapGlRes;\n            delete this._mapExtent2D;\n            delete this._mapGlExtent2D;\n            const size = this.getSize();\n            const w = size.width || 1,\n                h = size.height || 1;\n\n            this._glScale = this.getGLScale();\n\n            // camera world matrix\n            const worldMatrix = this._getCameraWorldMatrix();\n\n            const fov = this.getFov() * RADIAN,\n                pitch = this.getPitch() * RADIAN;\n\n            const halfFov = fov / 2;\n            const groundAngle = Math.PI / 2 + pitch;\n            const topHalfSurfaceDistance = Math.sin(halfFov) * this.cameraToCenterDistance / Math.sin(Math.PI - groundAngle - halfFov);\n\n            // Calculate z distance of the farthest fragment that should be rendered.\n            const furthestDistance = Math.cos(Math.PI / 2 - pitch) * topHalfSurfaceDistance + this.cameraToCenterDistance;\n\n            // const maxScale = this.getScale(this.getMinZoom()) / this.getScale(this.getMaxNativeZoom());\n            this.cameraFar = furthestDistance * 10.01; //this._glScale * h / 2 / this._getFovRatio() * 2;\n            if (sr.isEPSG) {\n                // dynamic cameraNear for predefined EPSG* projections\n                // this can help to increase depth resolutions\n                //TODO cameraNear会出现过大，而导致图形不显示的问题\n                this.cameraNear = Math.max(this._glScale * this.getResolution(this.getGLZoom()) * Math.cos(this.getPitch() * RADIAN), 0.1);\n            } else {\n                this.cameraNear = 0.1;\n            }\n\n            // camera projection matrix\n            const projMatrix = this.projMatrix || createMat4();\n            mat4.perspective(projMatrix, fov, w / h, this.cameraNear, this.cameraFar);\n            this.projMatrix = projMatrix;\n            // view matrix\n            this.viewMatrix = mat4.invert(m0, worldMatrix);\n            // matrix for world point => screen point\n            this.projViewMatrix = mat4.multiply(this.projViewMatrix || createMat4(), projMatrix, this.viewMatrix);\n            // matrix for screen point => world point\n            this.projViewMatrixInverse = mat4.multiply(this.projViewMatrixInverse || createMat4(), worldMatrix, mat4.invert(m1, projMatrix));\n            this.domCssMatrix = this._calcDomMatrix();\n            this._frustumAltitude = this._calcFrustumAltitude();\n            //缓存常用的值\n            this._mapRes = this._getResolution();\n            this._mapGlRes = this._getResolution(this.getGLZoom());\n            this._mapExtent2D = this._get2DExtent();\n            this._mapGlExtent2D = this._get2DExtent(this.getGLZoom());\n        };\n    }(),\n\n    _calcDomMatrix: function () {\n        const m = Browser.ie9 ? null : createMat4(),\n            minusY = [1, -1, 1],\n            arr = [0, 0, 0];\n        return function () {\n            const cameraToCenterDistance = 0.5 / Math.tan(this._fov / 2) * this.height;\n            mat4.scale(m, this.projMatrix, minusY);\n            mat4.translate(m, m, set(arr, 0, 0, -cameraToCenterDistance));//[0, 0, cameraToCenterDistance]\n            if (this._pitch) {\n                mat4.rotateX(m, m, this._pitch);\n            }\n            if (this._angle) {\n                mat4.rotateZ(m, m, this._angle);\n            }\n            const m1 = createMat4();\n            mat4.scale(m1, m1, set(arr, this.width / 2, -this.height / 2, 1)); //[this.width / 2, -this.height / 2, 1]\n            return mat4.multiply(this.domCssMatrix || createMat4(), m1, m);\n        };\n    }(),\n\n    _getCameraWorldMatrix: function () {\n        const q = {},\n            minusY = [1, -1, 1];\n        return function () {\n            const targetZ = this.getGLZoom();\n\n            const size = this.getSize(),\n                scale = this.getGLScale();\n            const center2D = this._prjToPoint(this._prjCenter, targetZ);\n            this.cameraLookAt = set(this.cameraLookAt || [0, 0, 0], center2D.x, center2D.y, 0);\n\n            const pitch = this.getPitch() * RADIAN;\n            const bearing = -this.getBearing() * RADIAN;\n\n            const ratio = this._getFovRatio();\n            const z = scale * (size.height || 1) / 2 / ratio;\n            const cz = z * Math.cos(pitch);\n            // and [dist] away from map's center on XY plane to tilt the scene.\n            const dist = Math.sin(pitch) * z;\n            // when map rotates, the camera's xy position is rotating with the given bearing and still keeps [dist] away from map's center\n            const cx = center2D.x + dist * Math.sin(bearing);\n            const cy = center2D.y + dist * Math.cos(bearing);\n            this.cameraPosition = set(this.cameraPosition || [0, 0, 0], cx, cy, cz);\n            this.cameraToCenterDistance  = distance(this.cameraPosition, this.cameraLookAt);\n            // when map rotates, camera's up axis is pointing to bearing from south direction of map\n            // default [0,1,0] is the Y axis while the angle of inclination always equal 0\n            // if you want to rotate the map after up an incline,please rotateZ like this:\n            // let up = new vec3(0,1,0);\n            // up.rotateZ(target,radians);\n            const d = dist || 1;\n            const up = this.cameraUp = set(this.cameraUp || [0, 0, 0], Math.sin(bearing) * d, Math.cos(bearing) * d, 0);\n            const m = this.cameraWorldMatrix = this.cameraWorldMatrix || createMat4();\n            lookAt(m, this.cameraPosition, this.cameraLookAt, up);\n\n            const cameraForward = this.cameraForward || [0, 0, 0];\n            subtract(cameraForward, this.cameraLookAt, this.cameraPosition);\n            // similar with unity's camera.transform.forward\n            this.cameraForward = normalize(cameraForward, cameraForward);\n            // math from THREE.js\n            matrixToQuaternion(q, m);\n            quaternionToMatrix(m, q);\n            setPosition(m, this.cameraPosition);\n            mat4.scale(m, m, minusY);\n            return m;\n        };\n    }(),\n\n    _getFovRatio() {\n        const fov = this.getFov();\n        return Math.tan(fov / 2 * RADIAN);\n    },\n\n    _renderLayers() {\n        if (this.isInteracting()) {\n            return;\n        }\n        const layers = this._getLayers();\n        // clear canvas layers to prevent unsync painting with tile layers.\n        layers.forEach(layer => {\n            if (!layer) {\n                return;\n            }\n            const renderer = layer._getRenderer();\n            if (renderer && renderer.setToRedraw) {\n                renderer.setToRedraw();\n            }\n        });\n    }\n});\n\nfunction createMat4() {\n    return mat4.identity(new Array(16));\n}\n","import { equalMapView } from '../core/util';\nimport Map from './Map';\n\nMap.include(/** @lends Map.prototype */ {\n    _onViewChange(view) {\n        if (!this._viewHistory) {\n            this._viewHistory = [];\n            this._viewHistoryPointer = 0;\n        }\n        const old = this._getCurrentView();\n        for (let i = this._viewHistory.length - 1; i >= 0; i--) {\n            if (equalMapView(view, this._viewHistory[i])) {\n                this._viewHistoryPointer = i;\n                this._fireViewChange(old, view);\n                return;\n            }\n        }\n\n        if (this._viewHistoryPointer < this._viewHistory.length - 1) {\n            // remove old 'next views'\n            this._viewHistory.splice(this._viewHistoryPointer + 1);\n        }\n        this._viewHistory.push(view);\n        const count = this.options['viewHistoryCount'];\n        if (count > 0 && this._viewHistory.length > count) {\n            // remove redundant view\n            this._viewHistory.splice(0, this._viewHistory.length - count);\n        }\n        this._viewHistoryPointer = this._viewHistory.length - 1;\n        /**\n         * viewchange event\n         * @event Map#viewchange\n         * @type {Object}\n         * @property {String} type - viewchange\n         * @property {Map} target - map fires the event\n         * @property {Object} old - old view\n         * @property {Point} new  - new view\n         */\n        this._fireViewChange(old, view);\n    },\n\n    /**\n     * Zoom to the previous map view in view history\n     * @return {Object} map view\n     */\n    zoomToPreviousView(options = {}) {\n        if (!this.hasPreviousView()) {\n            return null;\n        }\n        const view = this._viewHistory[--this._viewHistoryPointer];\n        this._zoomToView(view, options);\n        return view;\n    },\n\n    /**\n     * Whether has more previous view\n     * @return {Boolean}\n     */\n    hasPreviousView() {\n        if (!this._viewHistory || this._viewHistoryPointer === 0) {\n            return false;\n        }\n        return true;\n    },\n\n    /**\n     * Zoom to the next view in view history\n     * @return {Object} map view\n     */\n    zoomToNextView(options = {}) {\n        if (!this.hasNextView()) {\n            return null;\n        }\n        const view = this._viewHistory[++this._viewHistoryPointer];\n        this._zoomToView(view, options);\n        return view;\n    },\n\n    /**\n     * Whether has more next view\n     * @return {Boolean}\n     */\n    hasNextView() {\n        if (!this._viewHistory || this._viewHistoryPointer === this._viewHistory.length - 1) {\n            return false;\n        }\n        return true;\n    },\n\n    _zoomToView(view, options) {\n        const old = this.getView();\n        if (options['animation']) {\n            this.animateTo(view, {\n                'duration' : options['duration']\n            }, frame => {\n                if (frame.state.playState === 'finished') {\n                    this._fireViewChange(old, view);\n                }\n            });\n        } else {\n            this.setView(view);\n            this._fireViewChange(old, view);\n        }\n    },\n\n    /**\n     * Get map view history\n     * @return {Object[]}\n     */\n    getViewHistory() {\n        return this._viewHistory;\n    },\n\n    _fireViewChange(old, view) {\n        this._fireEvent('viewchange', {\n            'old' : old,\n            'new' : view\n        });\n    },\n\n    _getCurrentView() {\n        if (!this._viewHistory) {\n            return null;\n        }\n        return this._viewHistory[this._viewHistoryPointer];\n    }\n});\n\nMap.mergeOptions({\n    'viewHistory' : true,\n    'viewHistoryCount' : 10\n});\n","import Map from './Map';\nimport CollisionIndex from '../core/CollisionIndex';\n\nMap.include(/** @lends Map.prototype */ {\n    /**\n     * Get map scope collision index\n     * @returns {CollisionIndex} collision index\n     */\n    getCollisionIndex() {\n        if (!this._collisionIndex) {\n            this.createCollisionIndex();\n        }\n        return this._collisionIndex || this.createCollisionIndex();\n    },\n\n    /**\n     * Create a new collisionIndex\n     * @returns {CollisionIndex} new collision index\n     */\n    createCollisionIndex() {\n        this.clearCollisionIndex();\n        this._collisionIndex = new CollisionIndex();\n        return this._collisionIndex;\n    },\n\n    /**\n     * Clear collision index\n     * @returns {Map} this\n     */\n    clearCollisionIndex() {\n        if (this._collisionIndex) {\n            this._collisionIndex.clear();\n        }\n        return this;\n    }\n});\n","import { isArrayHasData, UID } from '../../core/util';\nimport { extendSymbol } from '../../core/util/style';\nimport Size from '../../geo/Size';\nimport Geometry from '../../geometry/Geometry';\nimport Marker from '../../geometry/Marker';\nimport Label from '../../geometry/Label';\nimport VectorLayer from '../../layer/VectorLayer';\nimport DrawTool from './DrawTool';\n\n/**\n * @property {options} options\n * @property {String}  options.language         - language of the distance tool, zh-CN or en-US\n * @property {Boolean} options.metric           - display result in metric system\n * @property {Boolean} options.imperial         - display result in imperial system.\n * @property {Object}  options.symbol           - symbol of the line\n * @property {Object}  options.vertexSymbol     - symbol of the vertice\n * @property {Object}  options.labelOptions     - construct options of the vertice labels.\n * @memberOf DistanceTool\n * @instance\n */\nconst options = {\n    'mode': 'LineString',\n    'language': 'zh-CN', //'en-US'\n    'metric': true,\n    'imperial': false,\n    'symbol': {\n        'lineColor': '#000',\n        'lineWidth': 3,\n        'lineOpacity': 1\n    },\n    'vertexSymbol': {\n        'markerType': 'ellipse',\n        'markerFill': '#fff',\n        'markerLineColor': '#000',\n        'markerLineWidth': 3,\n        'markerWidth': 11,\n        'markerHeight': 11\n    },\n    'labelOptions': {\n        'textSymbol': {\n            'textFaceName': 'monospace',\n            'textLineSpacing': 1,\n            'textHorizontalAlignment': 'right',\n            'textDx': 15\n        },\n        'boxStyle' : {\n            'padding' : [6, 2],\n            'symbol' : {\n                'markerType' : 'square',\n                'markerFill' : '#fff',\n                'markerFillOpacity' : 0.9,\n                'markerLineColor' : '#b4b3b3',\n            }\n        }\n    },\n    'clearButtonSymbol' :[{\n        'markerType': 'square',\n        'markerFill': '#fff',\n        'markerLineColor': '#b4b3b3',\n        'markerLineWidth': 2,\n        'markerWidth': 15,\n        'markerHeight': 15,\n        'markerDx': 20\n    }, {\n        'markerType': 'x',\n        'markerWidth': 10,\n        'markerHeight': 10,\n        'markerDx': 20\n    }]\n};\n\n\n/**\n * A map tool to help measure distance on the map\n * @category maptool\n * @extends DrawTool\n * @example\n * var distanceTool = new DistanceTool({\n *     'once' : true,\n *     'symbol': {\n *       'lineColor' : '#34495e',\n *       'lineWidth' : 2\n *     },\n *     'vertexSymbol' : {\n *       'markerType'        : 'ellipse',\n *       'markerFill'        : '#1bbc9b',\n *       'markerLineColor'   : '#000',\n *       'markerLineWidth'   : 3,\n *       'markerWidth'       : 10,\n *      'markerHeight'      : 10\n *    },\n *    'language' : 'en-US'\n *  }).addTo(map);\n *\n */\nclass DistanceTool extends DrawTool {\n\n    /**\n     * @param {options} [options=null] - construct options\n     * @param {String} [options.language=zh-CN]         - language of the distance tool, zh-CN or en-US\n     * @param {Boolean} [options.metric=true]           - display result in metric system\n     * @param {Boolean} [options.imperial=false]        - display result in imperial system.\n     * @param {Object}  [options.symbol=null]           - symbol of the line\n     * @param {Object}  [options.vertexSymbol=null]     - symbol of the vertice\n     * @param {Object}  [options.labelOptions=null]     - construct options of the vertice labels.\n     */\n    constructor(options) {\n        super(options);\n        this.on('enable', this._afterEnable, this)\n            .on('disable', this._afterDisable, this);\n        this._measureLayers = [];\n    }\n\n    /**\n     * Clear the measurements\n     * @return {DistanceTool} this\n     */\n    clear() {\n        if (isArrayHasData(this._measureLayers)) {\n            for (let i = 0; i < this._measureLayers.length; i++) {\n                this._measureLayers[i].remove();\n            }\n        }\n        delete this._lastMeasure;\n        delete this._lastVertex;\n        this._measureLayers = [];\n        return this;\n    }\n\n    /**\n     * Get the VectorLayers with the geometries drawn on the map during measuring.\n     * @return {Layer[]}\n     */\n    getMeasureLayers() {\n        return this._measureLayers;\n    }\n\n    /**\n     * Get last measuring result\n     * @return {Number}\n     */\n    getLastMeasure() {\n        if (!this._lastMeasure) {\n            return 0;\n        }\n        return this._lastMeasure;\n    }\n\n    _measure(toMeasure) {\n        const map = this.getMap();\n        let length;\n        if (toMeasure instanceof Geometry) {\n            length = map.computeGeometryLength(toMeasure);\n        } else if (Array.isArray(toMeasure)) {\n            length = map.getProjection().measureLength(toMeasure);\n        }\n        this._lastMeasure = length;\n        let units;\n        if (this.options['language'] === 'zh-CN') {\n            units = [' 米', ' 公里', ' 英尺', ' 英里'];\n        } else {\n            units = [' m', ' km', ' feet', ' mile'];\n        }\n        let content = '';\n        if (this.options['metric']) {\n            content += length < 1000 ? length.toFixed(0) + units[0] : (length / 1000).toFixed(2) + units[1];\n        }\n        if (this.options['imperial']) {\n            length *= 3.2808399;\n            if (content.length > 0) {\n                content += '\\n';\n            }\n            content += length < 5280 ? length.toFixed(0) + units[2] : (length / 5280).toFixed(2) + units[3];\n        }\n        return content;\n    }\n\n    _registerMeasureEvents() {\n        this.on('drawstart', this._msOnDrawStart, this)\n            .on('drawvertex', this._msOnDrawVertex, this)\n            .on('mousemove', this._msOnMouseMove, this)\n            .on('drawend', this._msOnDrawEnd, this);\n    }\n\n    _afterEnable() {\n        this._registerMeasureEvents();\n    }\n\n    _afterDisable() {\n        this.off('drawstart', this._msOnDrawStart, this)\n            .off('drawvertex', this._msOnDrawVertex, this)\n            .off('mousemove', this._msOnMouseMove, this)\n            .off('drawend', this._msOnDrawEnd, this);\n    }\n\n    _msOnDrawStart(param) {\n        const map = this.getMap();\n        const uid = UID();\n        const layerId = 'distancetool_' + uid;\n        const markerLayerId = 'distancetool_markers_' + uid;\n        if (!map.getLayer(layerId)) {\n            this._measureLineLayer = new VectorLayer(layerId).addTo(map);\n            this._measureMarkerLayer = new VectorLayer(markerLayerId).addTo(map);\n        } else {\n            this._measureLineLayer = map.getLayer(layerId);\n            this._measureMarkerLayer = map.getLayer(markerLayerId);\n        }\n        this._measureLayers.push(this._measureLineLayer);\n        this._measureLayers.push(this._measureMarkerLayer);\n        //start marker\n        new Marker(param['coordinate'], {\n            'symbol': this.options['vertexSymbol']\n        }).addTo(this._measureMarkerLayer);\n        const content = (this.options['language'] === 'zh-CN' ? '起点' : 'start');\n        const startLabel = new Label(content, param['coordinate'], this.options['labelOptions']);\n        this._lastVertex = startLabel;\n        this._measureMarkerLayer.addGeometry(startLabel);\n    }\n\n    _msOnMouseMove(param) {\n        const ms = this._measure(this._msGetCoordsToMeasure(param));\n        if (!this._tailMarker) {\n            const symbol = extendSymbol(this.options['vertexSymbol']);\n            symbol['markerWidth'] /= 2;\n            symbol['markerHeight'] /= 2;\n            this._tailMarker = new Marker(param['coordinate'], {\n                'symbol': symbol\n            }).addTo(this._measureMarkerLayer);\n            this._tailLabel = new Label(ms, param['coordinate'], this.options['labelOptions'])\n                .addTo(this._measureMarkerLayer);\n        }\n        this._tailMarker.setCoordinates(param['coordinate']);\n        this._tailLabel.setContent(ms);\n        this._tailLabel.setCoordinates(param['coordinate']);\n    }\n\n    _msGetCoordsToMeasure(param) {\n        return param['geometry'].getCoordinates().concat([param['coordinate']]);\n    }\n\n    _msOnDrawVertex(param) {\n        const geometry = param['geometry'];\n        //vertex marker\n        new Marker(param['coordinate'], {\n            'symbol': this.options['vertexSymbol']\n        }).addTo(this._measureMarkerLayer);\n        const length = this._measure(geometry);\n        const vertexLabel = new Label(length, param['coordinate'], this.options['labelOptions']);\n        this._measureMarkerLayer.addGeometry(vertexLabel);\n        this._lastVertex = vertexLabel;\n    }\n\n    _msOnDrawEnd(param) {\n        this._clearTailMarker();\n        let size = this._lastVertex.getSize();\n        if (!size) {\n            size = new Size(10, 10);\n        }\n        this._addClearMarker(this._lastVertex.getCoordinates(), size['width']);\n        const geo = param['geometry'].copy();\n        geo.addTo(this._measureLineLayer);\n        this._lastMeasure = geo.getLength();\n    }\n\n    _addClearMarker(coordinates, dx) {\n        let symbol = this.options['clearButtonSymbol'];\n        let dxSymbol = {\n            'markerDx' : (symbol['markerDx'] || 0) + dx,\n            'textDx' : (symbol['textDx'] || 0) + dx\n        };\n        if (Array.isArray(symbol)) {\n            dxSymbol = symbol.map(s => {\n                if (s) {\n                    return {\n                        'markerDx' : (s['markerDx'] || 0) + dx,\n                        'textDx' : (s['textDx'] || 0) + dx\n                    };\n                }\n                return null;\n            });\n        }\n        symbol = extendSymbol(symbol, dxSymbol);\n        const endMarker = new Marker(coordinates, {\n            'symbol': symbol\n        });\n        const measureLineLayer = this._measureLineLayer,\n            measureMarkerLayer = this._measureMarkerLayer;\n        endMarker.on('click', function () {\n            measureLineLayer.remove();\n            measureMarkerLayer.remove();\n            //return false to stop propagation of event.\n            return false;\n        }, this);\n        endMarker.addTo(this._measureMarkerLayer);\n    }\n\n    _clearTailMarker() {\n        if (this._tailMarker) {\n            this._tailMarker.remove();\n            delete this._tailMarker;\n        }\n        if (this._tailLabel) {\n            this._tailLabel.remove();\n            delete this._tailLabel;\n        }\n    }\n\n}\n\nDistanceTool.mergeOptions(options);\n\nexport default DistanceTool;\n","import Size from '../../geo/Size';\nimport { Geometry, Marker, Label } from '../../geometry';\nimport DistanceTool from './DistanceTool';\n\n/**\n * @property {options} options\n * @property {String}  options.language         - language of the distance tool, zh-CN or en-US\n * @property {Boolean} options.metric           - display result in metric system\n * @property {Boolean} options.imperial         - display result in imperial system.\n * @property {Object}  options.symbol           - symbol of the line\n * @property {Object}  options.vertexSymbol     - symbol of the vertice\n * @property {Object}  options.labelOptions     - construct options of the vertice labels.\n * @memberOf AreaTool\n * @instance\n */\nconst options = {\n    'mode': 'Polygon',\n    'symbol': {\n        'lineColor': '#000000',\n        'lineWidth': 2,\n        'lineOpacity': 1,\n        'lineDasharray': '',\n        'polygonFill': '#ffffff',\n        'polygonOpacity': 0.5\n    }\n};\n\n/**\n * A map tool to help measure area on the map\n * @category maptool\n * @extends DistanceTool\n * @example\n * var areaTool = new AreaTool({\n *     'once' : true,\n *     'symbol': {\n *       'lineColor' : '#34495e',\n *       'lineWidth' : 2\n *     },\n *     'vertexSymbol' : {\n *       'markerType'        : 'ellipse',\n *       'markerFill'        : '#1bbc9b',\n *       'markerLineColor'   : '#000',\n *       'markerLineWidth'   : 3,\n *       'markerWidth'       : 10,\n *      'markerHeight'      : 10\n *    },\n *    'language' : 'en-US'\n *  }).addTo(map);\n */\nclass AreaTool extends DistanceTool {\n\n    /**\n     * @param {options} [options=null] - construct options\n     * @param {String} [options.language=zh-CN]         - language of the distance tool, zh-CN or en-US\n     * @param {Boolean} [options.metric=true]           - display result in metric system\n     * @param {Boolean} [options.imperial=false]        - display result in imperial system.\n     * @param {Object}  [options.symbol=null]           - symbol of the line\n     * @param {Object}  [options.vertexSymbol=null]     - symbol of the vertice\n     * @param {Object}  [options.labelOptions=null]     - construct options of the vertice labels.\n     */\n    constructor(options) {\n        super(options);\n        this.on('enable', this._afterEnable, this)\n            .on('disable', this._afterDisable, this);\n        this._measureLayers = [];\n    }\n\n    _measure(toMeasure) {\n        const map = this.getMap();\n        let area;\n        if (toMeasure instanceof Geometry) {\n            area = map.computeGeometryArea(toMeasure);\n        } else if (Array.isArray(toMeasure)) {\n            area = map.getProjection().measureArea(toMeasure);\n        }\n        this._lastMeasure = area;\n        let units;\n        if (this.options['language'] === 'zh-CN') {\n            units = [' 平方米', ' 平方公里', ' 平方英尺', ' 平方英里'];\n        } else {\n            units = [' sq.m', ' sq.km', ' sq.ft', ' sq.mi'];\n        }\n        let content = '';\n        if (this.options['metric']) {\n            content += area < 1E6 ? area.toFixed(0) + units[0] : (area / 1E6).toFixed(2) + units[1];\n        }\n        if (this.options['imperial']) {\n            area *= 3.2808399;\n            if (content.length > 0) {\n                content += '\\n';\n            }\n            const sqmi = 5280 * 5280;\n            content += area < sqmi ? area.toFixed(0) + units[2] : (area / sqmi).toFixed(2) + units[3];\n        }\n        return content;\n    }\n\n    _msGetCoordsToMeasure(param) {\n        return param['geometry'].getShell().concat([param['coordinate']]);\n    }\n\n    _msOnDrawVertex(param) {\n        const vertexMarker = new Marker(param['coordinate'], {\n            'symbol': this.options['vertexSymbol']\n        }).addTo(this._measureMarkerLayer);\n        this._measure(param['geometry']);\n        this._lastVertex = vertexMarker;\n    }\n\n    _msOnDrawEnd(param) {\n        this._clearTailMarker();\n\n        const ms = this._measure(param['geometry']);\n        const endLabel = new Label(ms, param['coordinate'], this.options['labelOptions'])\n            .addTo(this._measureMarkerLayer);\n        let size = endLabel.getSize();\n        if (!size) {\n            size = new Size(10, 10);\n        }\n        this._addClearMarker(param['coordinate'], size['width']);\n        const geo = param['geometry'].copy();\n        geo.addTo(this._measureLineLayer);\n        this._lastMeasure = geo.getArea();\n    }\n}\n\nAreaTool.mergeOptions(options);\n\nexport default AreaTool;\n","import Ellipse from '../../geometry/Ellipse';\nimport ArcCurve from '../../geometry/ArcCurve';\nimport LineString from '../../geometry/LineString';\nimport { extendSymbol } from '../../core/util/style';\nimport QuadBezierCurve from '../../geometry/QuadBezierCurve';\nimport Coordinate from '../../geo/Coordinate';\nimport Point from '../../geo/Point';\nimport Marker from '../../geometry/Marker';\nimport CubicBezierCurve from '../../geometry/CubicBezierCurve';\nimport Circle from '../../geometry/Circle';\nimport Polygon from '../../geometry/Polygon';\nimport DrawTool from './DrawTool';\n\nDrawTool.registerMode('circle', {\n    'clickLimit': 2,\n    'action': ['click', 'mousemove', 'click'],\n    'create': function (coordinate) {\n        return new Circle(coordinate[0], 0);\n    },\n    'update': function (path, geometry) {\n        const map = geometry.getMap();\n        const radius = map.computeLength(geometry.getCenter(), path[path.length - 1]);\n        geometry.setRadius(radius);\n    },\n    'generate': function (geometry) {\n        return geometry;\n    }\n});\n\nDrawTool.registerMode('freeHandCircle', {\n    'action': ['mousedown', 'mousemove', 'mouseup'],\n    'create': function (coordinate) {\n        return new Circle(coordinate[0], 0);\n    },\n    'update': function (path, geometry) {\n        const map = geometry.getMap();\n        const radius = map.computeLength(geometry.getCenter(), path[path.length - 1]);\n        geometry.setRadius(radius);\n    },\n    'generate': function (geometry) {\n        return geometry;\n    }\n});\n\nDrawTool.registerMode('ellipse', {\n    'clickLimit': 2,\n    'action': ['click', 'mousemove', 'click'],\n    'create': function (coordinates) {\n        return new Ellipse(coordinates[0], 0, 0);\n    },\n    'update': function (path, geometry) {\n        const map = geometry.getMap();\n        const center = geometry.getCenter();\n        const rx = map.computeLength(center, new Coordinate({\n            x: path[path.length - 1].x,\n            y: center.y\n        }));\n        const ry = map.computeLength(center, new Coordinate({\n            x: center.x,\n            y: path[path.length - 1].y\n        }));\n        geometry.setWidth(rx * 2);\n        geometry.setHeight(ry * 2);\n    },\n    'generate': function (geometry) {\n        return geometry;\n    }\n});\n\nDrawTool.registerMode('freeHandEllipse', {\n    'action': ['mousedown', 'mousemove', 'mouseup'],\n    'create': function (coordinates) {\n        return new Ellipse(coordinates[0], 0, 0);\n    },\n    'update': function (path, geometry) {\n        const map = geometry.getMap();\n        const center = geometry.getCenter();\n        const rx = map.computeLength(center, new Coordinate({\n            x: path[path.length - 1].x,\n            y: center.y\n        }));\n        const ry = map.computeLength(center, new Coordinate({\n            x: center.x,\n            y: path[path.length - 1].y\n        }));\n        geometry.setWidth(rx * 2);\n        geometry.setHeight(ry * 2);\n    },\n    'generate': function (geometry) {\n        return geometry;\n    }\n});\n\nDrawTool.registerMode('rectangle', {\n    'clickLimit': 2,\n    'action': ['click', 'mousemove', 'click'],\n    'create': function (coordinates) {\n        const rect = new Polygon([]);\n        rect._firstClick = coordinates[0];\n        return rect;\n    },\n    'update': function (coordinates, geometry, param) {\n        const map = geometry.getMap();\n        const containerPoint = param['containerPoint'];\n        const firstClick = map.coordToContainerPoint(geometry._firstClick);\n        const ring = [\n            [firstClick.x, firstClick.y],\n            [containerPoint.x, firstClick.y],\n            [containerPoint.x, containerPoint.y],\n            [firstClick.x, containerPoint.y],\n        ];\n        geometry.setCoordinates(ring.map(c => map.containerPointToCoord(new Point(c))));\n    },\n    'generate': function (geometry) {\n        return geometry;\n    }\n});\n\nDrawTool.registerMode('freeHandRectangle', {\n    'action': ['mousedown', 'mousemove', 'mouseup'],\n    'create': function (coordinates) {\n        const rect = new Polygon([]);\n        rect._firstClick = coordinates[0];\n        return rect;\n    },\n    'update': function (coordinates, geometry) {\n        const firstClick = geometry._firstClick;\n        const ring = [\n            [firstClick.x, firstClick.y],\n            [coordinates[0].x, firstClick.y],\n            [coordinates[0].x, coordinates[0].y],\n            [firstClick.x, coordinates[0].y],\n        ];\n        geometry.setCoordinates(ring);\n    },\n    'generate': function (geometry) {\n        return geometry;\n    }\n});\n\nDrawTool.registerMode('point', {\n    'clickLimit': 1,\n    'action': ['click'],\n    'create': function (coordinate) {\n        return new Marker(coordinate[0]);\n    },\n    'generate': function (geometry) {\n        return geometry;\n    }\n});\n\nDrawTool.registerMode('polygon', {\n    'action': ['click', 'mousemove', 'dblclick'],\n    'create': function (path) {\n        return new LineString(path);\n    },\n    'update': function (path, geometry) {\n        const symbol = geometry.getSymbol();\n        geometry.setCoordinates(path);\n\n        const layer = geometry.getLayer();\n        if (layer) {\n            let polygon = layer.getGeometryById('polygon');\n            if (!polygon && path.length >= 3) {\n                polygon = new Polygon([path], {\n                    'id': 'polygon'\n                });\n                if (symbol) {\n                    const pSymbol = extendSymbol(symbol, {\n                        'lineOpacity': 0\n                    });\n                    polygon.setSymbol(pSymbol);\n                }\n                polygon.addTo(layer);\n            }\n            if (polygon) {\n                polygon.setCoordinates(path);\n            }\n        }\n    },\n    'generate': function (geometry) {\n        return new Polygon(geometry.getCoordinates(), {\n            'symbol': geometry.getSymbol()\n        });\n    }\n});\n\nDrawTool.registerMode('freeHandPolygon', {\n    'action': ['mousedown', 'mousemove', 'mouseup'],\n    'create': function (path) {\n        return new LineString(path);\n    },\n    'update': function (path, geometry) {\n        const coordinates = geometry.getCoordinates();\n        const symbol = geometry.getSymbol();\n        geometry.setCoordinates(coordinates.concat(path));\n\n        const layer = geometry.getLayer();\n        if (layer) {\n            let polygon = layer.getGeometryById('polygon');\n            if (!polygon && path.length >= 3) {\n                polygon = new Polygon([path], {\n                    'id': 'polygon'\n                });\n                if (symbol) {\n                    const pSymbol = extendSymbol(symbol, {\n                        'lineOpacity': 0\n                    });\n                    polygon.setSymbol(pSymbol);\n                }\n                polygon.addTo(layer);\n            }\n            if (polygon) {\n                polygon.setCoordinates(path);\n            }\n        }\n    },\n    'generate': function (geometry) {\n        return new Polygon(geometry.getCoordinates(), {\n            'symbol': geometry.getSymbol()\n        });\n    }\n});\n\nDrawTool.registerMode('linestring', {\n    'action': ['click', 'mousemove', 'dblclick'],\n    'create': function (path) {\n        return new LineString(path);\n    },\n    'update': function (path, geometry) {\n        geometry.setCoordinates(path);\n    },\n    'generate': function (geometry) {\n        return geometry;\n    }\n});\n\nDrawTool.registerMode('freeHandLinestring', {\n    'action': ['mousedown', 'mousemove', 'mouseup'],\n    'create': function (path) {\n        return new LineString(path);\n    },\n    'update': function (path, geometry) {\n        const coordinates = geometry.getCoordinates();\n        geometry.setCoordinates(coordinates.concat(path));\n    },\n    'generate': function (geometry) {\n        return geometry;\n    }\n});\n\nDrawTool.registerMode('arccurve', {\n    'action': ['click', 'mousemove', 'dblclick'],\n    'create': function (path) {\n        return new ArcCurve(path);\n    },\n    'update': function (path, geometry) {\n        geometry.setCoordinates(path);\n    },\n    'generate': function (geometry) {\n        return geometry;\n    }\n});\n\nDrawTool.registerMode('quadbeziercurve', {\n    'action': ['click', 'mousemove', 'dblclick'],\n    'create': function (path) {\n        return new QuadBezierCurve(path);\n    },\n    'update': function (path, geometry) {\n        geometry.setCoordinates(path);\n    },\n    'generate': function (geometry) {\n        return geometry;\n    }\n});\n\nDrawTool.registerMode('cubicbeziercurve', {\n    'action': ['click', 'mousemove', 'dblclick'],\n    'create': function (path) {\n        return new CubicBezierCurve(path);\n    },\n    'update': function (path, geometry) {\n        geometry.setCoordinates(path);\n    },\n    'generate': function (geometry) {\n        return geometry;\n    }\n});\n\n// TODO When action contains 'mousedown', It is in drag mode.\nDrawTool.registerMode('boxZoom', {\n    'action': ['mousedown', 'mousemove', 'mouseup'],\n    'create': function (coordinates) {\n        const marker = new Marker(coordinates[0]);\n        marker._firstClick = coordinates[0];\n        return marker;\n    },\n    'update': function (path, geometry, param) {\n        const map = geometry.getMap();\n        const p1 = map.coordToContainerPoint(geometry._firstClick),\n            p2 = param['containerPoint'];\n        const coords = map.containerPointToCoordinate(new Coordinate(Math.min(p1.x, p2.x), Math.min(p1.y, p2.y)));\n        geometry.setCoordinates(coords)\n            .updateSymbol({\n                markerWidth: Math.abs(p1.x - p2.x),\n                markerHeight: Math.abs(p1.y - p2.y)\n            });\n    },\n    'generate': function (geometry) {\n        return geometry;\n    }\n});\n","import { isString, parseJSON } from '../../core/util';\nimport Ajax from '../../core/Ajax';\nimport SpatialReference from './SpatialReference';\n\nfunction parse(arcConf) {\n    const tileInfo = arcConf['tileInfo'],\n        tileSize = [tileInfo['cols'], tileInfo['rows']],\n        resolutions = [],\n        lods = tileInfo['lods'];\n    for (let i = 0, len = lods.length; i < len; i++) {\n        resolutions.push(lods[i]['resolution']);\n    }\n    const fullExtent = arcConf['fullExtent'],\n        origin = tileInfo['origin'],\n        tileSystem = [1, -1, origin['x'], origin['y']];\n    delete fullExtent['spatialReference'];\n    return {\n        'spatialReference': {\n            'resolutions': resolutions,\n            'fullExtent': fullExtent\n        },\n        'tileSystem': tileSystem,\n        'tileSize': tileSize\n    };\n}\n\nSpatialReference.loadArcgis = function (url, cb, options = { 'jsonp' : true }) {\n    if (isString(url) && url.substring(0, 1) !== '{') {\n        Ajax.getJSON(url, function (err, json) {\n            if (err) {\n                cb(err);\n                return;\n            }\n            const spatialRef = parse(json);\n            cb(null, spatialRef);\n        }, options);\n    } else {\n        if (isString(url)) {\n            url = parseJSON(url);\n        }\n        const spatialRef = parse(url);\n        cb(null, spatialRef);\n\n    }\n    return this;\n};\n","import { extend } from '../core/util';\nimport { trim } from '../core/util/strings';\nimport {\n    on,\n    off,\n    removeDomNode,\n    stopPropagation,\n    TRANSFORM,\n    TRANSFORMORIGIN,\n    TRANSITION\n} from '../core/util/dom';\nimport Browser from '../core/Browser';\nimport Class from '../core/Class';\nimport Eventable from '../core/Eventable';\nimport Point from '../geo/Point';\nimport Size from '../geo/Size';\nimport Geometry from '../geometry/Geometry';\n\n/**\n * @property {Object} options\n * @property {Boolean} [options.eventsPropagation=false]  - whether stop ALL events' propagation.\n * @property {Boolean} [options.eventsToStop=null]  - UI's dom events to stop propagation if eventsPropagation is true.\n * @property {Number}  [options.dx=0]     - pixel offset on x axis\n * @property {Number}  [options.dy=0]     - pixel offset on y axis\n * @property {Boolean} [options.autoPan=false]  - set it to false if you don't want the map to do panning animation to fit the opened UI.\n * @property {Boolean} [options.autoPanDuration=600]    - duration for auto panning animation.\n * @property {Boolean} [options.single=true]    - whether the UI is a global single one, only one UI will be shown at the same time if set to true.\n * @property {Boolean} [options.animation=null]         - fade | scale | fade,scale, add animation effect when showing and hiding.\n * @property {Number}  [options.animationDuration=300]  - animation duration, in milliseconds.\n * @property {Boolean}  [options.pitchWithMap=false]    - whether tilt with map\n * @property {Boolean}  [options.rotateWithMap=false]  - whether rotate with map\n * @memberOf ui.UIComponent\n * @instance\n */\nconst options = {\n    'eventsPropagation': false,\n    'eventsToStop': null,\n    'dx': 0,\n    'dy': 0,\n    'autoPan': false,\n    'autoPanDuration': 600,\n    'single': true,\n    'animation': 'scale',\n    'animationOnHide': true,\n    'animationDuration': 500,\n    'pitchWithMap': false,\n    'rotateWithMap': false,\n};\n\n/**\n * @classdesc\n * Base class for all the UI component classes, a UI component is a HTMLElement positioned with geographic coordinate. <br>\n * It is abstract and not intended to be instantiated.\n *\n * @category ui\n * @abstract\n * @mixes Eventable\n * @memberOf ui\n * @extends Class\n */\nclass UIComponent extends Eventable(Class) {\n\n    /**\n     *  Some instance methods subclasses needs to implement:  <br>\n     *  <br>\n     * 1. Optional, returns the Dom element's position offset  <br>\n     * function getOffset : Point  <br>\n     *  <br>\n     * 2. Method to create UI's Dom element  <br>\n     * function buildOn : HTMLElement  <br>\n     *  <br>\n     * 3 Optional, to provide an event map to register event listeners.  <br>\n     * function getEvents : void  <br>\n     * 4 Optional, a callback when dom is removed.  <br>\n     * function onDomRemove : void  <br>\n     * 5 Optional, a callback when UI Component is removed.  <br>\n     * function onRemove : void  <br>\n     * @param  {Object} options configuration options\n     */\n    constructor(options) {\n        super(options);\n    }\n\n    /**\n     * Adds the UI Component to a geometry or a map\n     * @param {Geometry|Map} owner - geometry or map to addto.\n     * @returns {ui.UIComponent} this\n     * @fires ui.UIComponent#add\n     */\n    addTo(owner) {\n        this._owner = owner;\n        // first time\n        this._switchEvents('on');\n        if (this.onAdd) {\n            this.onAdd();\n        }\n        /**\n         * add event.\n         *\n         * @event ui.UIComponent#add\n         * @type {Object}\n         * @property {String} type - add\n         * @property {ui.UIComponent} target - UIComponent\n         */\n        this.fire('add');\n        return this;\n    }\n\n    /**\n     * Get the map it added to\n     * @return {Map} map instance\n     * @override\n     */\n    getMap() {\n        if (!this._owner) {\n            return null;\n        }\n        // is a map\n        if (this._owner.getBaseLayer) {\n            return this._owner;\n        }\n        return this._owner.getMap();\n    }\n\n    /**\n     * Show the UI Component, if it is a global single one, it will close previous one.\n     * @param {Coordinate} [coordinate=null] - coordinate to show, default is owner's center\n     * @return {ui.UIComponent} this\n     * @fires ui.UIComponent#showstart\n     * @fires ui.UIComponent#showend\n     */\n    show(coordinate) {\n        const map = this.getMap();\n        if (!map) {\n            return this;\n        }\n\n        if (!this._mapEventsOn) {\n            this._switchMapEvents('on');\n        }\n\n        coordinate = coordinate || this._coordinate || this._owner.getCenter();\n\n        const visible = this.isVisible();\n\n        /**\n         * showstart event.\n         *\n         * @event ui.UIComponent#showstart\n         * @type {Object}\n         * @property {String} type - showstart\n         * @property {ui.UIComponent} target - UIComponent\n         */\n        this.fire('showstart');\n        const container = this._getUIContainer();\n        this._coordinate = coordinate;\n        this._removePrevDOM();\n        const dom = this.__uiDOM = this.buildOn(map);\n        dom['eventsPropagation'] = this.options['eventsPropagation'];\n\n        if (!dom) {\n            /**\n             * showend event.\n             *\n             * @event ui.UIComponent#showend\n             * @type {Object}\n             * @property {String} type - showend\n             * @property {ui.UIComponent} target - UIComponent\n             */\n            this.fire('showend');\n            return this;\n        }\n\n        this._measureSize(dom);\n\n        if (this._singleton()) {\n            map[this._uiDomKey()] = dom;\n        }\n\n        this._setPosition();\n\n        dom.style[TRANSITION] = null;\n\n        container.appendChild(dom);\n\n\n        const anim = this._getAnimation();\n\n        if (visible) {\n            anim.ok = false;\n        }\n\n        if (anim.ok) {\n            if (anim.fade) {\n                dom.style.opacity = 0;\n            }\n            if (anim.scale) {\n                if (this.getTransformOrigin) {\n                    const origin = this.getTransformOrigin();\n                    dom.style[TRANSFORMORIGIN] = origin;\n                }\n                dom.style[TRANSFORM] = this._toCSSTranslate(this._pos) + ' scale(0)';\n            }\n        }\n\n        dom.style.display = '';\n\n        if (this.options['eventsToStop']) {\n            on(dom, this.options['eventsToStop'], stopPropagation);\n        }\n\n        //autoPan\n        if (this.options['autoPan']) {\n            this._autoPan();\n        }\n\n        const transition = anim.transition;\n        if (anim.ok && transition) {\n            /* eslint-disable no-unused-expressions */\n            // trigger transition\n            dom.offsetHeight;\n            /* eslint-enable no-unused-expressions */\n            if (transition) {\n                dom.style[TRANSITION] = transition;\n            }\n            if (anim.fade) {\n                dom.style.opacity = 1;\n            }\n            if (anim.scale) {\n                dom.style[TRANSFORM] = this._toCSSTranslate(this._pos) + ' scale(1)';\n            }\n        }\n\n        this.fire('showend');\n        return this;\n    }\n\n    /**\n     * Hide the UI Component.\n     * @return {ui.UIComponent} this\n     * @fires ui.UIComponent#hide\n     */\n    hide() {\n        if (!this.getDOM() || !this.getMap()) {\n            return this;\n        }\n\n        const anim = this._getAnimation(),\n            dom = this.getDOM();\n        if (!this.options['animationOnHide']) {\n            anim.ok = false;\n        }\n        if (!anim.ok) {\n            dom.style.display = 'none';\n            /**\n           * hide event.\n           *\n           * @event ui.UIComponent#hide\n           * @type {Object}\n           * @property {String} type - hide\n           * @property {ui.UIComponent} target - UIComponent\n           */\n            this.fire('hide');\n        } else {\n            /* eslint-disable no-unused-expressions */\n            dom.offsetHeight;\n            /* eslint-enable no-unused-expressions */\n            dom.style[TRANSITION] = anim.transition;\n            setTimeout(() => {\n                dom.style.display = 'none';\n                this.fire('hide');\n            }, this.options['animationDuration']);\n        }\n        if (anim.fade) {\n            dom.style.opacity = 0;\n        }\n        if (anim.scale) {\n            dom.style[TRANSFORM] = this._toCSSTranslate(this._pos) + ' scale(0)';\n        }\n        return this;\n    }\n\n    /**\n     * Decide whether the ui component is open\n     * @returns {Boolean} true|false\n     */\n    isVisible() {\n        const dom = this.getDOM();\n        return this.getMap() && dom && dom.parentNode && dom.style.display !== 'none';\n    }\n\n    /**\n     * Remove the UI Component\n     * @return {ui.UIComponent} this\n     * @fires ui.UIComponent#hide\n     * @fires ui.UIComponent#remove\n     */\n    remove() {\n        delete this._mapEventsOn;\n        if (!this._owner) {\n            return this;\n        }\n        this.hide();\n        this._switchEvents('off');\n        if (this.onRemove) {\n            this.onRemove();\n        }\n        if (!this._singleton() && this.__uiDOM) {\n            this._removePrevDOM();\n        }\n        delete this._owner;\n        /**\n         * remove event.\n         *\n         * @event ui.UIComponent#remove\n         * @type {Object}\n         * @property {String} type - remove\n         * @property {ui.UIComponent} target - UIComponent\n         */\n        this.fire('remove');\n        return this;\n    }\n\n    /**\n     * Get pixel size of the UI Component.\n     * @return {Size} size\n     */\n    getSize() {\n        if (this._size) {\n            return this._size.copy();\n        } else {\n            return null;\n        }\n    }\n\n    getOwner() {\n        return this._owner;\n    }\n\n    getDOM() {\n        return this.__uiDOM;\n    }\n\n    getPosition() {\n        if (!this.getMap()) {\n            return null;\n        }\n        const p = this._getViewPoint()._round();\n        if (this.getOffset) {\n            const o = this.getOffset()._round();\n            if (o) {\n                p._add(o);\n            }\n        }\n        return p;\n    }\n\n    _getAnimation() {\n        const anim = {\n            'fade': false,\n            'scale': false\n        };\n        const animations = this.options['animation'] ? this.options['animation'].split(',') : [];\n        for (let i = 0; i < animations.length; i++) {\n            const trimed = trim(animations[i]);\n            if (trimed === 'fade') {\n                anim.fade = true;\n            } else if (trimed === 'scale') {\n                anim.scale = true;\n            }\n        }\n        let transition = null;\n        if (anim.fade) {\n            transition = 'opacity ' + this.options['animationDuration'] + 'ms';\n        }\n        if (anim.scale) {\n            transition = transition ? transition + ',' : '';\n            transition += TRANSFORM + ' ' + this.options['animationDuration'] + 'ms';\n        }\n        anim.transition = transition;\n        anim.ok = (transition !== null);\n        return anim;\n    }\n\n    _getViewPoint() {\n        return this.getMap().coordToViewPoint(this._coordinate)\n            ._add(this.options['dx'], this.options['dy']);\n    }\n\n    _autoPan() {\n        const map = this.getMap(),\n            dom = this.getDOM();\n        if (map.isMoving()) {\n            return;\n        }\n        const point = this._pos;\n        const mapSize = map.getSize(),\n            mapWidth = mapSize['width'],\n            mapHeight = mapSize['height'];\n\n        const containerPoint = map.viewPointToContainerPoint(point);\n        const clientWidth = parseInt(dom.clientWidth),\n            clientHeight = parseInt(dom.clientHeight);\n        let left = 0,\n            top = 0;\n        if ((containerPoint.x) < 0) {\n            left = -(containerPoint.x - clientWidth / 2);\n        } else if ((containerPoint.x + clientWidth - 35) > mapWidth) {\n            left = (mapWidth - (containerPoint.x + clientWidth * 3 / 2));\n        }\n        if (containerPoint.y - clientHeight < 0) {\n            top = -(containerPoint.y - clientHeight) + 50;\n        } else if (containerPoint.y > mapHeight) {\n            top = (mapHeight - containerPoint.y - clientHeight) - 30;\n        }\n        if (top !== 0 || left !== 0) {\n            map.panBy(new Point(left, top), { 'duration': this.options['autoPanDuration'] });\n        }\n    }\n\n    /**\n     * Measure dom's size\n     * @param  {HTMLElement} dom - element to measure\n     * @return {Size} size\n     * @private\n     */\n    _measureSize(dom) {\n        const container = this._getUIContainer();\n        dom.style.position = 'absolute';\n        dom.style.left = -99999 + 'px';\n        const anchor = dom.style.bottom ? 'bottom' : 'top';\n        dom.style[anchor] = -99999 + 'px';\n        dom.style.display = '';\n        container.appendChild(dom);\n        this._size = new Size(dom.clientWidth, dom.clientHeight);\n        dom.style.display = 'none';\n        dom.style.left = '0px';\n        dom.style[anchor] = '0px';\n        return this._size;\n    }\n\n    /**\n     * Remove previous UI DOM if it has.\n     *\n     * @private\n     */\n    _removePrevDOM() {\n        if (this.onDomRemove) {\n            this.onDomRemove();\n        }\n        const eventsToStop = this.options['eventsToStop'];\n        if (this._singleton()) {\n            const map = this.getMap(),\n                key = this._uiDomKey();\n            if (map[key]) {\n                if (eventsToStop) {\n                    off(map[key], eventsToStop, stopPropagation);\n                }\n                removeDomNode(map[key]);\n                delete map[key];\n            }\n            delete this.__uiDOM;\n        } else if (this.__uiDOM) {\n            if (eventsToStop) {\n                off(this.__uiDOM, eventsToStop, stopPropagation);\n            }\n            removeDomNode(this.__uiDOM);\n            delete this.__uiDOM;\n        }\n    }\n\n    /**\n     * generate the cache key to store the singletong UI DOM\n     * @private\n     * @return {String} cache key\n     */\n    _uiDomKey() {\n        return '__ui_' + this._getClassName();\n    }\n\n    _singleton() {\n        return this.options['single'];\n    }\n\n    _getUIContainer() {\n        return this.getMap()._panels['ui'];\n    }\n\n    _getClassName() {\n        return 'UIComponent';\n    }\n\n    _switchMapEvents(to) {\n        const map = this.getMap();\n        if (!map) {\n            return;\n        }\n        this._mapEventsOn = (to === 'on');\n        const events = this._getDefaultEvents();\n        if (this.getEvents) {\n            extend(events, this.getEvents());\n        }\n        if (events) {\n            for (const p in events) {\n                if (events.hasOwnProperty(p)) {\n                    map[to](p, events[p], this);\n                }\n            }\n        }\n    }\n\n    _switchEvents(to) {\n        this._switchMapEvents(to);\n        const ownerEvents = this._getOwnerEvents();\n        if (this._owner) {\n            for (const p in ownerEvents) {\n                if (ownerEvents.hasOwnProperty(p)) {\n                    this._owner[to](p, ownerEvents[p], this);\n                }\n            }\n        }\n    }\n\n    _getDefaultEvents() {\n        return {\n            'zooming rotate pitch': this.onEvent,\n            'zoomend': this.onZoomEnd,\n            'moving': this.onMoving\n        };\n    }\n\n    _getOwnerEvents() {\n        const events = {};\n        if (this._owner && (this._owner instanceof Geometry)) {\n            events.positionchange = this.onGeometryPositionChange;\n        }\n        if (this.getOwnerEvents) {\n            extend(events, this.getOwnerEvents());\n        }\n        return events;\n    }\n\n    onGeometryPositionChange(param) {\n        if (this._owner && this.isVisible()) {\n            this.show(param['target'].getCenter());\n        }\n    }\n\n    onMoving() {\n        if (this.isVisible() && this.getMap().isTransforming()) {\n            this._updatePosition();\n        }\n    }\n\n    onEvent() {\n        if (this.isVisible()) {\n            this._updatePosition();\n        }\n    }\n\n    onZoomEnd() {\n        if (this.isVisible()) {\n            // when zoomend, map container is reset, position should be updated in current frame\n            this._setPosition();\n        }\n    }\n\n    _updatePosition() {\n        // update position in the next frame to sync with layers\n        const renderer = this.getMap()._getRenderer();\n        renderer.callInNextFrame(this._setPosition.bind(this));\n    }\n\n    _setPosition() {\n        const dom = this.getDOM();\n        if (!dom) return;\n        dom.style[TRANSITION] = null;\n        const p = this.getPosition();\n        this._pos = p;\n        dom.style[TRANSFORM] = this._toCSSTranslate(p) + ' scale(1)';\n    }\n\n    _toCSSTranslate(p) {\n        if (!p) {\n            return '';\n        }\n        if (Browser.any3d) {\n            const map = this.getMap(),\n                bearing = map ? map.getBearing() : 0,\n                pitch = map ? map.getPitch() : 0;\n            let r = '';\n            if (this.options['pitchWithMap'] && pitch) {\n                r += ` rotateX(${Math.round(pitch)}deg)`;\n            }\n            if (this.options['rotateWithMap'] && bearing) {\n                r += ` rotateZ(${Math.round(-bearing)}deg)`;\n            }\n            return 'translate3d(' + p.x + 'px,' + p.y + 'px, 0px)' + r;\n        } else {\n            return 'translate(' + p.x + 'px,' + p.y + 'px)';\n        }\n    }\n}\n\nUIComponent.mergeOptions(options);\n\nexport default UIComponent;\n","import { isString, flash } from '../core/util';\nimport { on, off, createEl, stopPropagation } from '../core/util/dom';\nimport Browser from '../core/Browser';\nimport Handler from '../handler/Handler';\nimport Handlerable from '../handler/Handlerable';\nimport DragHandler from '../handler/Drag';\nimport Coordinate from '../geo/Coordinate';\nimport Point from '../geo/Point';\nimport UIComponent from './UIComponent';\n\n/**\n * @property {Object} options - construct options\n * @property {Boolean} [options.draggable=false]  - if the marker can be dragged.\n * @property {Number}  [options.single=false]     - if the marker is a global single one.\n * @property {String|HTMLElement}  options.content - content of the marker, can be a string type HTML code or a HTMLElement.\n * @memberOf ui.UIMarker\n * @instance\n */\nconst options = {\n    'eventsPropagation' : true,\n    'draggable': false,\n    'single': false,\n    'content': null\n};\n\nconst domEvents =\n    /**\n     * mousedown event\n     * @event ui.UIMarker#mousedown\n     * @type {Object}\n     * @property {String} type                    - mousedown\n     * @property {UIMarker} target    - the uimarker fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'mousedown ' +\n    /**\n     * mouseup event\n     * @event ui.UIMarker#mouseup\n     * @type {Object}\n     * @property {String} type                    - mouseup\n     * @property {UIMarker} target    - the uimarker fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'mouseup ' +\n    /**\n     * mouseenter event\n     * @event ui.UIMarker#mouseenter\n     * @type {Object}\n     * @property {String} type                    - mouseenter\n     * @property {UIMarker} target    - the uimarker fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'mouseenter ' +\n    /**\n     * mouseover event\n     * @event ui.UIMarker#mouseover\n     * @type {Object}\n     * @property {String} type                    - mouseover\n     * @property {UIMarker} target    - the uimarker fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'mouseover ' +\n    /**\n     * mouseout event\n     * @event ui.UIMarker#mouseout\n     * @type {Object}\n     * @property {String} type                    - mouseout\n     * @property {UIMarker} target    - the uimarker fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'mouseout ' +\n    /**\n     * mousemove event\n     * @event ui.UIMarker#mousemove\n     * @type {Object}\n     * @property {String} type                    - mousemove\n     * @property {UIMarker} target    - the uimarker fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'mousemove ' +\n    /**\n     * click event\n     * @event ui.UIMarker#click\n     * @type {Object}\n     * @property {String} type                    - click\n     * @property {UIMarker} target    - the uimarker fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'click ' +\n    /**\n     * dblclick event\n     * @event ui.UIMarker#dblclick\n     * @type {Object}\n     * @property {String} type                    - dblclick\n     * @property {UIMarker} target    - the uimarker fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'dblclick ' +\n    /**\n     * contextmenu event\n     * @event ui.UIMarker#contextmenu\n     * @type {Object}\n     * @property {String} type                    - contextmenu\n     * @property {UIMarker} target    - the uimarker fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'contextmenu ' +\n    /**\n     * keypress event\n     * @event ui.UIMarker#keypress\n     * @type {Object}\n     * @property {String} type                    - keypress\n     * @property {UIMarker} target    - the uimarker fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'keypress ' +\n    /**\n     * touchstart event\n     * @event ui.UIMarker#touchstart\n     * @type {Object}\n     * @property {String} type                    - touchstart\n     * @property {UIMarker} target    - the uimarker fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'touchstart ' +\n    /**\n     * touchmove event\n     * @event ui.UIMarker#touchmove\n     * @type {Object}\n     * @property {String} type                    - touchmove\n     * @property {UIMarker} target    - the uimarker fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'touchmove ' +\n    /**\n     * touchend event\n     * @event ui.UIMarker#touchend\n     * @type {Object}\n     * @property {String} type                    - touchend\n     * @property {UIMarker} target    - the uimarker fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'touchend';\n\n/**\n *\n * @classdesc\n * Class for UI Marker, a html based marker positioned by geographic coordinate. <br>\n *\n * @category ui\n * @extends ui.UIComponent\n * @mixes Handlerable\n * @memberOf ui\n * @example\n * var dom = document.createElement('div');\n * dom.innerHTML = 'hello ui marker';\n * var marker = new maptalks.ui.UIMarker([0, 0], {\n *      draggable : true,\n *      content : dom\n *  }).addTo(map);\n */\nclass UIMarker extends Handlerable(UIComponent) {\n\n    /**\n     * As it's renderered by HTMLElement such as a DIV, it: <br>\n     * 1. always on the top of all the map layers <br>\n     * 2. can't be snapped as it's not drawn on the canvas. <br>\n     * @param  {Coordinate} coordinate - UIMarker's coordinates\n     * @param {Object} options - options defined in [UIMarker]{@link UIMarker#options}\n     */\n    constructor(coordinate, options) {\n        super(options);\n        this._markerCoord = new Coordinate(coordinate);\n    }\n\n    // TODO: obtain class in super\n    _getClassName() {\n        return 'UIMarker';\n    }\n\n    /**\n     * Sets the coordinates\n     * @param {Coordinate} coordinates - UIMarker's coordinate\n     * @returns {UIMarker} this\n     * @fires UIMarker#positionchange\n     */\n    setCoordinates(coordinates) {\n        this._markerCoord = coordinates;\n        /**\n         * positionchange event.\n         *\n         * @event ui.UIMarker#positionchange\n         * @type {Object}\n         * @property {String} type - positionchange\n         * @property {UIMarker} target - ui marker\n         */\n        this.fire('positionchange');\n        if (this.isVisible()) {\n            this._coordinate = this._markerCoord;\n            this._setPosition();\n        }\n        return this;\n    }\n\n    /**\n     * Gets the coordinates\n     * @return {Coordinate} coordinates\n     */\n    getCoordinates() {\n        return this._markerCoord;\n    }\n\n    /**\n     * Sets the content of the UIMarker\n     * @param {String|HTMLElement} content - UIMarker's content\n     * @returns {UIMarker} this\n     * @fires UIMarker#contentchange\n     */\n    setContent(content) {\n        const old = this.options['content'];\n        this.options['content'] = content;\n        /**\n         * contentchange event.\n         *\n         * @event ui.UIMarker#contentchange\n         * @type {Object}\n         * @property {String} type - contentchange\n         * @property {UIMarker} target - ui marker\n         * @property {String|HTMLElement} old      - old content\n         * @property {String|HTMLElement} new      - new content\n         */\n        this.fire('contentchange', {\n            'old': old,\n            'new': content\n        });\n        if (this.isVisible()) {\n            this.show();\n        }\n        return this;\n    }\n\n    /**\n     * Gets the content of the UIMarker\n     * @return {String|HTMLElement} content\n     */\n    getContent() {\n        return this.options['content'];\n    }\n\n    onAdd() {\n        this.show();\n    }\n\n    /**\n     * Show the UIMarker\n     * @returns {UIMarker} this\n     * @fires UIMarker#showstart\n     * @fires UIMarker#showend\n     */\n    show() {\n        return super.show(this._markerCoord);\n    }\n\n    /**\n     * Flash the UIMarker, show and hide by certain internal for times of count.\n     *\n     * @param {Number} [interval=100]     - interval of flash, in millisecond (ms)\n     * @param {Number} [count=4]          - flash times\n     * @param {Function} [cb=null]        - callback function when flash ended\n     * @param {*} [context=null]          - callback context\n     * @return {UIMarker} this\n     */\n    flash(interval, count, cb, context) {\n        return flash.call(this, interval, count, cb, context);\n    }\n\n    /**\n     * A callback method to build UIMarker's HTMLElement\n     * @protected\n     * @param {Map} map - map to be built on\n     * @return {HTMLElement} UIMarker's HTMLElement\n     */\n    buildOn() {\n        let dom;\n        if (isString(this.options['content'])) {\n            dom = createEl('div');\n            dom.innerHTML = this.options['content'];\n        } else {\n            dom = this.options['content'];\n        }\n        this._registerDOMEvents(dom);\n        return dom;\n    }\n\n    /**\n     * Gets UIMarker's HTMLElement's position offset, it's caculated dynamically accordiing to its actual size.\n     * @protected\n     * @return {Point} offset\n     */\n    getOffset() {\n        const size = this.getSize();\n        return new Point(-size.width / 2, -size.height / 2);\n    }\n\n    /**\n     * Gets UIMarker's transform origin for animation transform\n     * @protected\n     * @return {Point} transform origin\n     */\n    getTransformOrigin() {\n        return 'center center';\n    }\n\n    onDomRemove() {\n        const dom = this.getDOM();\n        this._removeDOMEvents(dom);\n    }\n\n    /**\n     * Whether the uimarker is being dragged.\n     * @returns {Boolean}\n     */\n    isDragging() {\n        if (this['draggable']) {\n            return this['draggable'].isDragging();\n        }\n        return false;\n    }\n\n    _registerDOMEvents(dom) {\n        on(dom, domEvents, this._onDomEvents, this);\n    }\n\n    _onDomEvents(e) {\n        const event = this.getMap()._parseEvent(e, e.type);\n        this.fire(e.type, event);\n    }\n\n    _removeDOMEvents(dom) {\n        off(dom, domEvents, this._onDomEvents, this);\n    }\n\n    /**\n     * Get the connect points of panel for connector lines.\n     * @private\n     */\n    _getConnectPoints() {\n        const map = this.getMap();\n        const containerPoint = map.coordToContainerPoint(this.getCoordinates());\n        const size = this.getSize(),\n            width = size.width,\n            height = size.height;\n        const anchors = [\n            //top center\n            map.containerPointToCoordinate(\n                containerPoint.add(-width / 2, 0)\n            ),\n            //middle right\n            map.containerPointToCoordinate(\n                containerPoint.add(width / 2, 0)\n            ),\n            //bottom center\n            map.containerPointToCoordinate(\n                containerPoint.add(0, height / 2)\n            ),\n            //middle left\n            map.containerPointToCoordinate(\n                containerPoint.add(0, -height / 2)\n            )\n\n        ];\n        return anchors;\n    }\n}\n\nUIMarker.mergeOptions(options);\n\nconst EVENTS = Browser.touch ? 'touchstart mousedown' : 'mousedown';\n\nclass UIMarkerDragHandler extends Handler {\n\n    constructor(target) {\n        super(target);\n    }\n\n    addHooks() {\n        this.target.on(EVENTS, this._startDrag, this);\n    }\n\n    removeHooks() {\n        this.target.off(EVENTS, this._startDrag, this);\n    }\n\n    _startDrag(param) {\n        const domEvent = param['domEvent'];\n        if (domEvent.touches && domEvent.touches.length > 1 || domEvent.button === 2) {\n            return;\n        }\n        if (this.isDragging()) {\n            return;\n        }\n        this.target.on('click', this._endDrag, this);\n        this._lastCoord = param['coordinate'];\n        this._lastPoint = param['containerPoint'];\n\n        this._prepareDragHandler();\n        this._dragHandler.onMouseDown(param['domEvent']);\n        /**\n         * drag start event\n         * @event ui.UIMarker#dragstart\n         * @type {Object}\n         * @property {String} type                    - dragstart\n         * @property {UIMarker} target    - the uimarker fires event\n         * @property {Coordinate} coordinate - coordinate of the event\n         * @property {Point} containerPoint  - container point of the event\n         * @property {Point} viewPoint       - view point of the event\n         * @property {Event} domEvent                 - dom event\n         */\n        this.target.fire('dragstart', param);\n    }\n\n    _prepareDragHandler() {\n        this._dragHandler = new DragHandler(this.target.getDOM(), {\n            'cancelOn': this._cancelOn.bind(this),\n            'ignoreMouseleave' : true\n        });\n        this._dragHandler.on('mousedown', this._onMouseDown, this);\n        this._dragHandler.on('dragging', this._dragging, this);\n        this._dragHandler.on('mouseup', this._endDrag, this);\n        this._dragHandler.enable();\n    }\n\n    _cancelOn(domEvent) {\n        const target = domEvent.srcElement || domEvent.target,\n            tagName = target.tagName.toLowerCase();\n        if (tagName === 'button' ||\n            tagName === 'input' ||\n            tagName === 'select' ||\n            tagName === 'option' ||\n            tagName === 'textarea') {\n            return true;\n        }\n        return false;\n    }\n\n    _onMouseDown(param) {\n        stopPropagation(param['domEvent']);\n    }\n\n    _dragging(param) {\n        const target = this.target,\n            map = target.getMap(),\n            eventParam = map._parseEvent(param['domEvent']),\n            domEvent = eventParam['domEvent'];\n        if (domEvent.touches && domEvent.touches.length > 1) {\n            return;\n        }\n        if (!this._isDragging) {\n            this._isDragging = true;\n            return;\n        }\n\n        const coord = eventParam['coordinate'],\n            point = eventParam['containerPoint'];\n        if (!this._lastCoord) {\n            this._lastCoord = coord;\n        }\n        if (!this._lastPoint) {\n            this._lastPoint = point;\n        }\n        const coordOffset = coord.sub(this._lastCoord),\n            pointOffset = point.sub(this._lastPoint);\n        this._lastCoord = coord;\n        this._lastPoint = point;\n        this.target.setCoordinates(this.target.getCoordinates().add(coordOffset));\n        eventParam['coordOffset'] = coordOffset;\n        eventParam['pointOffset'] = pointOffset;\n\n        /**\n         * dragging event\n         * @event ui.UIMarker#dragging\n         * @type {Object}\n         * @property {String} type                    - dragging\n         * @property {UIMarker} target    - the uimarker fires event\n         * @property {Coordinate} coordinate - coordinate of the event\n         * @property {Point} containerPoint  - container point of the event\n         * @property {Point} viewPoint       - view point of the event\n         * @property {Event} domEvent                 - dom event\n         */\n        target.fire('dragging', eventParam);\n\n    }\n\n    _endDrag(param) {\n        const target = this.target,\n            map = target.getMap();\n        if (this._dragHandler) {\n            target.off('click', this._endDrag, this);\n            this._dragHandler.disable();\n            delete this._dragHandler;\n        }\n        delete this._lastCoord;\n        delete this._lastPoint;\n        this._isDragging = false;\n        if (!map) {\n            return;\n        }\n        const eventParam = map._parseEvent(param['domEvent']);\n        /**\n         * dragend event\n         * @event ui.UIMarker#dragend\n         * @type {Object}\n         * @property {String} type                    - dragend\n         * @property {UIMarker} target    - the uimarker fires event\n         * @property {Coordinate} coordinate - coordinate of the event\n         * @property {Point} containerPoint  - container point of the event\n         * @property {Point} viewPoint       - view point of the event\n         * @property {Event} domEvent                 - dom event\n         */\n        target.fire('dragend', eventParam);\n\n    }\n\n    isDragging() {\n        if (!this._isDragging) {\n            return false;\n        }\n        return true;\n    }\n}\n\nUIMarker.addInitHook('addHandler', 'draggable', UIMarkerDragHandler);\n\nexport default UIMarker;\n","import { isString } from '../core/util';\nimport { createEl, addDomEvent, removeDomEvent } from '../core/util/dom';\nimport Point from '../geo/Point';\nimport { Geometry, Marker, MultiPoint } from '../geometry';\nimport UIComponent from './UIComponent';\n\n\n/**\n * @property {Object} options\n * @property {Boolean} [options.autoPan=true]  - set it to false if you don't want the map to do panning animation to fit the opened window.\n * @property {Boolean} [options.autoCloseOn=null] - Auto close infowindow on map's events, e.g. \"click contextmenu\" will close infowindow with click or right click on map.\n * @property {Boolean} [options.autoOpenOn=null]  - Auto open infowindow on owner's events, e.g. \"click\" will open infowindow with click or right click on window's owner.\n * @property {Number}  [options.width=300]     - default width\n * @property {Number}  [options.minHeight=120] - minimun height\n * @property {Boolean} [options.custom=false]  - set it to true if you want a customized infowindow, customized html codes or a HTMLElement is set to content.\n * @property {String}  [options.title=null]    - title of the infowindow.\n * @property {String|HTMLElement}  options.content - content of the infowindow.\n * @memberOf ui.InfoWindow\n * @instance\n */\nconst options = {\n    'autoPan': true,\n    'autoCloseOn' : null,\n    'autoOpenOn' : 'click',\n    'width': 300,\n    'minHeight': 120,\n    'custom': false,\n    'title': null,\n    'content': null\n};\n\n/**\n * @classdesc\n * Class for info window, a popup on the map to display any useful infomation you wanted.\n * @category ui\n * @extends ui.UIComponent\n * @param {Object} options - options defined in [InfoWindow]{@link InfoWindow#options}\n * @memberOf ui\n */\nclass InfoWindow extends UIComponent {\n\n    // TODO: obtain class in super\n    _getClassName() {\n        return 'InfoWindow';\n    }\n\n    /**\n     * Adds the UI Component to a geometry or a map\n     * @param {Geometry|Map} owner - geometry or map to addto.\n     * @returns {UIComponent} this\n     * @fires UIComponent#add\n     */\n    addTo(owner) {\n        if (owner instanceof Geometry) {\n            if (owner.getInfoWindow() && owner.getInfoWindow() !== this) {\n                owner.removeInfoWindow();\n            }\n            owner._infoWindow = this;\n        }\n        return super.addTo(owner);\n    }\n\n    /**\n     * Set the content of the infowindow.\n     * @param {String|HTMLElement} content - content of the infowindow.\n     * return {InfoWindow} this\n     * @fires InfoWindow#contentchange\n     */\n    setContent(content) {\n        const old = this.options['content'];\n        this.options['content'] = content;\n        /**\n         * contentchange event.\n         *\n         * @event InfoWindow#contentchange\n         * @type {Object}\n         * @property {String} type - contentchange\n         * @property {InfoWindow} target - InfoWindow\n         * @property {String|HTMLElement} old      - old content\n         * @property {String|HTMLElement} new      - new content\n         */\n        this.fire('contentchange', {\n            'old': old,\n            'new': content\n        });\n        if (this.isVisible()) {\n            this.show(this._coordinate);\n        }\n        return this;\n    }\n\n    /**\n     * Get content of  the infowindow.\n     * @return {String|HTMLElement} - content of the infowindow\n     */\n    getContent() {\n        return this.options['content'];\n    }\n\n    /**\n     * Set the title of the infowindow.\n     * @param {String|HTMLElement} title - title of the infowindow.\n     * return {InfoWindow} this\n     * @fires InfoWindow#titlechange\n     */\n    setTitle(title) {\n        const old = title;\n        this.options['title'] = title;\n        /**\n         * titlechange event.\n         *\n         * @event InfoWindow#titlechange\n         * @type {Object}\n         * @property {String} type - titlechange\n         * @property {InfoWindow} target - InfoWindow\n         * @property {String} old      - old content\n         * @property {String} new      - new content\n         */\n        this.fire('contentchange', {\n            'old': old,\n            'new': title\n        });\n        if (this.isVisible()) {\n            this.show(this._coordinate);\n        }\n        return this;\n    }\n\n    /**\n     * Get title of  the infowindow.\n     * @return {String|HTMLElement} - content of the infowindow\n     */\n    getTitle() {\n        return this.options['title'];\n    }\n\n    buildOn() {\n        if (this.options['custom']) {\n            if (isString(this.options['content'])) {\n                const dom = createEl('div');\n                dom.innerHTML = this.options['content'];\n                return dom;\n            } else {\n                return this.options['content'];\n            }\n        }\n        const dom = createEl('div');\n        dom.className = 'maptalks-msgBox';\n        dom.style.width = this._getWindowWidth() + 'px';\n        dom.style.bottom = '0px'; // fix #657\n        let content = '<em class=\"maptalks-ico\"></em>';\n        if (this.options['title']) {\n            content += '<h2>' + this.options['title'] + '</h2>';\n        }\n        content += '<a href=\"javascript:void(0);\" class=\"maptalks-close\"></a><div class=\"maptalks-msgContent\"></div>';\n        dom.innerHTML = content;\n        const msgContent = dom.querySelector('.maptalks-msgContent');\n        if (isString(this.options['content'])) {\n            msgContent.innerHTML = this.options['content'];\n        } else {\n            msgContent.appendChild(this.options['content']);\n        }\n        this._onCloseBtnClick = this.hide.bind(this);\n        const closeBtn = dom.querySelector('.maptalks-close');\n        addDomEvent(closeBtn, 'click touchend', this._onCloseBtnClick);\n\n        return dom;\n    }\n\n    /**\n     * Gets InfoWindow's transform origin for animation transform\n     * @protected\n     * @return {Point} transform origin\n     */\n    getTransformOrigin() {\n        const size = this.getSize();\n        return size.width / 2 + 'px bottom';\n    }\n\n    getOffset() {\n        const size = this.getSize();\n        const o = new Point(-size['width'] / 2, 0);\n        if (!this.options['custom']) {\n            o._sub(4, 12);\n        } else {\n            o._sub(0, size['height']);\n        }\n        const owner = this.getOwner();\n        if (owner instanceof Marker || owner instanceof MultiPoint) {\n            let painter, markerSize;\n            if (owner instanceof Marker) {\n                painter = owner._getPainter();\n                markerSize = owner.getSize();\n            } else {\n                const children = owner.getGeometries();\n                if (!children || !children.length) {\n                    return o;\n                }\n                painter = children[0]._getPainter();\n                markerSize = children[0].getSize();\n            }\n            if (painter) {\n                const fixExtent = painter.getFixedExtent();\n                o._add(fixExtent.xmax - markerSize.width / 2, fixExtent.ymin);\n            }\n        }\n        return o;\n    }\n\n    show(coordinate) {\n        if (!this.getMap()) {\n            return this;\n        }\n        if (!this.getMap().options['enableInfoWindow']) {\n            return this;\n        }\n        return super.show(coordinate);\n    }\n\n    getEvents() {\n        if (!this.options['autoCloseOn']) {\n            return null;\n        }\n        const events = {};\n        events[this.options['autoCloseOn']] = this.hide;\n        return events;\n    }\n\n    getOwnerEvents() {\n        const owner = this.getOwner();\n        if (!this.options['autoOpenOn'] || !owner) {\n            return null;\n        }\n        const events = {};\n        events[this.options['autoOpenOn']] = this._onAutoOpen;\n        return events;\n    }\n\n    onRemove() {\n        this.onDomRemove();\n    }\n\n    onDomRemove() {\n        if (this._onCloseBtnClick) {\n            const dom = this.getDOM();\n            const closeBtn = dom.childNodes[2];\n            removeDomEvent(closeBtn, 'click touchend', this._onCloseBtnClick);\n            delete this._onCloseBtnClick;\n        }\n    }\n\n    _onAutoOpen(e) {\n        const owner = this.getOwner();\n        setTimeout(() => {\n            if (owner instanceof Marker) {\n                this.show(owner.getCoordinates());\n            } else if (owner instanceof MultiPoint) {\n                this.show(owner.findClosest(e.coordinate));\n            } else {\n                this.show(e.coordinate);\n            }\n        }, 1);\n    }\n\n    _getWindowWidth() {\n        const defaultWidth = 300;\n        let width = this.options['width'];\n        if (!width) {\n            width = defaultWidth;\n        }\n        return width;\n    }\n}\n\nInfoWindow.mergeOptions(options);\n\nexport default InfoWindow;\n","import { createEl } from '../core/util/dom';\nimport { Geometry } from '../geometry';\nimport UIComponent from './UIComponent';\nimport UIMarker from './UIMarker';\n\n\n/**\n * @property {Object} options\n * @property {Number}  [options.width=0]     - default width\n * @property {Number}  [options.height=0]     - default height\n * @property {String}  [options.animation='fade']     - default fade, scale | fade,scale are an alternative to set\n * @property {String}  [options.cssName=maptalks-tooltip]    - tooltip's css class name\n * @property {Number}  [options.showTimeout=400]      - timeout to show tooltip\n * @memberOf ui.ToolTip\n * @instance\n */\nconst options = {\n    'width': 0,\n    'height': 0,\n    'animation': 'fade',\n    'cssName': 'maptalks-tooltip',\n    'showTimeout' : 400\n};\n/**\n * @classdesc\n * Class for tooltip, a tooltip used for showing some useful infomation attached to geometries on the map.\n * @category ui\n * @extends ui.UIComponent\n * @memberOf ui\n */\nclass ToolTip extends UIComponent {\n    // TODO:obtain class in super\n    _getClassName() {\n        return 'ToolTip';\n    }\n\n    /**\n     * @param {String} content         - content of tooltip\n     * @param {Object} [options=null]  - options defined in [ToolTip]{@link ToolTip#options}\n     */\n    constructor(content, options = {}) {\n        super(options);\n        this._content = content;\n    }\n\n    /**\n     * Adds the UI Component to a geometry\n     * @param {Geometry} owner - geometry to add.\n     * @returns {UIComponent} this\n     * @fires UIComponent#add\n     */\n    addTo(owner) {\n        if (owner instanceof Geometry || owner instanceof UIMarker) {\n            owner.on('mousemove', this.onMouseMove, this);\n            owner.on('mouseout', this.onMouseOut, this);\n            return super.addTo(owner);\n        } else {\n            throw new Error('Invalid geometry or UIMarker the tooltip is added to.');\n        }\n    }\n\n    /**\n     * set ToolTip's content's css class name.\n     * @param {String} css class name - set for ToolTip's content.\n     */\n    setStyle(cssName) {\n        this.options.cssName = cssName;\n        return this;\n    }\n\n    /**\n     * get ToolTip's  content's css class name\n     * @returns {String} css class name - set for ToolTip's content.\n     */\n    getStyle() {\n        return this.options.cssName;\n    }\n\n    /**\n     * get the UI Component's content\n     * @returns {String} tooltip's content\n     */\n    getContent() {\n        return this._content;\n    }\n\n    buildOn() {\n        const dom = createEl('div');\n        const options = this.options || {};\n        if (options.height) {\n            dom.style.height = options.height + 'px';\n        }\n        if (options.width) {\n            dom.style.width = options.width + 'px';\n        }\n        const cssName = options.cssName;\n        if (!cssName && options.height) {\n            dom.style.lineHeight = options.height + 'px';\n        }\n        dom.innerHTML = `<div class=\"${cssName}\">${this._content}</div>`;\n        return dom;\n    }\n\n    onMouseOut() {\n        clearTimeout(this._timeout);\n        if (this.isVisible()) {\n            this._removePrevDOM();\n        }\n    }\n\n    onMouseMove(e) {\n        clearTimeout(this._timeout);\n        const map = this.getMap();\n        if (!map) {\n            return;\n        }\n        const coord = map.locateByPoint(e.coordinate, -5, 25);\n        if (this.options['showTimeout'] === 0) {\n            this.show(coord);\n        } else {\n            this._timeout = setTimeout(() => {\n                if (map) {\n                    this.show(coord);\n                }\n            }, this.options['showTimeout']);\n        }\n    }\n\n    /**\n     * remove the tooltip, this method will be called by 'this.remove()'\n     */\n    onRemove() {\n        clearTimeout(this._timeout);\n        if (this._owner) {\n            this._owner.off('mouseover', this.onMouseOver, this);\n            this._owner.off('mouseout', this.onMouseOut, this);\n        }\n    }\n}\n\nToolTip.mergeOptions(options);\n\nexport default ToolTip;\n","import { isString, isFunction } from '../core/util';\nimport { on, createEl, addClass, setStyle, preventDefault } from '../core/util/dom';\nimport Point from '../geo/Point';\nimport UIComponent from './UIComponent';\n\n/**\n * @property {Object} options\n * @property {Boolean} [options.autoPan=false]  - set it to false if you don't want the map to do panning animation to fit the opened menu.\n * @property {Number}  [options.width=160]      - default width\n * @property {Number}  [options.maxHeight=0]    - default max-height\n * @property {String|HTMLElement} [options.custom=false]  - set it to true if you want a customized menu, customized html codes or a HTMLElement is set to items.\n * @property {Object[]|String|HTMLElement}  options.items   - html code or a html element is options.custom is true. Or a menu items array, containing: item objects, \"-\" as a splitor line\n * @memberOf ui.Menu\n * @instance\n */\nconst defaultOptions = {\n    'animation': null,\n    'animationDelay': 10,\n    'animationOnHide': false,\n    'autoPan': false,\n    'width': 160,\n    'maxHeight' : 0,\n    'custom': false,\n    'items': []\n};\n\n/**\n * @classdesc\n * Class for context menu, useful for interactions with right clicks on the map.\n * @category ui\n * @extends ui.UIComponent\n * @memberOf ui\n */\nclass Menu extends UIComponent {\n\n    /**\n     * Menu items is set to options.items or by setItems method. <br>\n     * <br>\n     * Normally items is a object array, containing: <br>\n     * 1. item object: {'item': 'This is a menu text', 'click': function() {alert('oops! You clicked!');)}} <br>\n     * 2. minus string \"-\", which will draw a splitor line on the menu. <br>\n     * <br>\n     * If options.custom is set to true, the menu is considered as a customized one. Then items is the customized html codes or HTMLElement. <br>\n     * @param {Object} options - options defined in [ui.Menu]{@link ui.Menu#options}\n     */\n    constructor(options) {\n        super(options);\n    }\n\n    // TODO: obtain class in super\n    _getClassName() {\n        return 'Menu';\n    }\n\n    addTo(owner) {\n        if (owner._menu && owner._menu !== this) {\n            owner.removeMenu();\n        }\n        owner._menu = this;\n        return UIComponent.prototype.addTo.apply(this, arguments);\n    }\n\n    /**\n     * Set the items of the menu.\n     * @param {Object[]|String|HTMLElement} items - items of the menu\n     * return {ui.Menu} this\n     * @example\n     * menu.setItems([\n     *      //return false to prevent event propagation\n     *     {'item': 'Query', 'click': function() {alert('Query Clicked!'); return false;}},\n     *     '-',\n     *     {'item': 'Edit', 'click': function() {alert('Edit Clicked!')}},\n     *     {'item': 'About', 'click': function() {alert('About Clicked!')}}\n     * ]);\n     */\n    setItems(items) {\n        this.options['items'] = items;\n        return this;\n    }\n\n    /**\n     * Get items of  the menu.\n     * @return {Object[]|String|HTMLElement} - items of the menu\n     */\n    getItems() {\n        return this.options['items'] || [];\n    }\n\n    /**\n     * Create the menu DOM.\n     * @protected\n     * @return {HTMLElement} menu's DOM\n     */\n    buildOn() {\n        if (this.options['custom']) {\n            if (isString(this.options['items'])) {\n                const container = createEl('div');\n                container.innerHTML = this.options['items'];\n                return container;\n            } else {\n                return this.options['items'];\n            }\n        } else {\n            const dom = createEl('div');\n            addClass(dom, 'maptalks-menu');\n            dom.style.width = this._getMenuWidth() + 'px';\n            /*const arrow = createEl('em');\n            addClass(arrow, 'maptalks-ico');*/\n            const menuItems = this._createMenuItemDom();\n            // dom.appendChild(arrow);\n            dom.appendChild(menuItems);\n            on(dom, 'contextmenu', preventDefault);\n            return dom;\n        }\n    }\n\n    /**\n     * Offset of the menu DOM to fit the click position.\n     * @return {Point} offset\n     * @private\n     */\n    getOffset() {\n        if (!this.getMap()) {\n            return null;\n        }\n        const mapSize = this.getMap().getSize(),\n            p = this.getMap().viewPointToContainerPoint(this._getViewPoint()),\n            size = this.getSize();\n        let dx = 0,\n            dy = 0;\n        if (p.x + size['width'] > mapSize['width']) {\n            dx = -size['width'];\n        }\n        if (p.y + size['height'] > mapSize['height']) {\n            dy = -size['height'];\n        }\n        return new Point(dx, dy);\n    }\n\n    getTransformOrigin() {\n        const p = this.getOffset()._multi(-1);\n        return p.x + 'px ' + p.y + 'px';\n    }\n\n    getEvents() {\n        return {\n            '_zoomstart _zoomend _movestart _dblclick _click': this. _removePrevDOM\n        };\n    }\n\n    _createMenuItemDom() {\n        const me = this;\n        const map = this.getMap();\n        const ul = createEl('ul');\n        addClass(ul, 'maptalks-menu-items');\n        const items = this.getItems();\n\n        function onMenuClick(index) {\n            return function (e) {\n                const param = map._parseEvent(e, 'click');\n                param['target'] = me;\n                param['owner'] = me._owner;\n                param['index'] = index;\n                const result = this._callback(param);\n                if (result === false) {\n                    return;\n                }\n                me.hide();\n            };\n        }\n        let item, itemDOM;\n        for (let i = 0, len = items.length; i < len; i++) {\n            item = items[i];\n            if (item === '-' || item === '_') {\n                itemDOM = createEl('li');\n                addClass(itemDOM, 'maptalks-menu-splitter');\n            } else {\n                itemDOM = createEl('li');\n                let itemTitle = item['item'];\n                if (isFunction(itemTitle)) {\n                    itemTitle = itemTitle({\n                        'owner': this._owner,\n                        'index': i\n                    });\n                }\n                itemDOM.innerHTML = itemTitle;\n                itemDOM._callback = item['click'];\n                on(itemDOM, 'click', (onMenuClick)(i));\n            }\n            ul.appendChild(itemDOM);\n        }\n        const maxHeight = this.options['maxHeight'] || 0;\n        if (maxHeight > 0) {\n            setStyle(ul, 'max-height: ' + maxHeight + 'px; overflow-y: auto;');\n        }\n        return ul;\n    }\n\n    _getMenuWidth() {\n        const defaultWidth = 160;\n        const width = this.options['width'] || defaultWidth;\n        return width;\n    }\n}\n\nMenu.mergeOptions(defaultOptions);\n\nexport default Menu;\n","import Map from '../map/Map';\nimport Geometry from '../geometry/Geometry';\nimport Menu from './Menu';\n\n/**\n * Mixin of the context menu methods.\n * @mixin ui.Menuable\n */\nconst Menuable = {\n    /**\n     * Set a context menu\n     * @param {Object} options - menu options\n     * @return {*} this\n     * @example\n     * foo.setMenu({\n     *  'width'  : 160,\n     *  'custom' : false,\n     *  'items' : [\n     *      //return false to prevent event propagation\n     *     {'item': 'Query', 'click': function() {alert('Query Clicked!'); return false;}},\n     *     '-',\n     *     {'item': 'Edit', 'click': function() {alert('Edit Clicked!')}},\n     *     {'item': 'About', 'click': function() {alert('About Clicked!')}}\n     *    ]\n     * });\n     * @function ui.Menuable.setMenu\n     */\n    setMenu(options) {\n        this._menuOptions = options;\n\n        if (this._menu) {\n            this._menu.setOptions(options);\n        } else {\n            this.on('contextmenu', this._defaultOpenMenu, this);\n        }\n        return this;\n    },\n\n    /**\n     * Open the context menu, default on the center of the geometry or map.\n     * @param {Coordinate} [coordinate=null] - coordinate to open the context menu\n     * @return {*} this\n     * @function ui.Menuable.openMenu\n     */\n    openMenu(coordinate) {\n        const map = (this instanceof Map) ? this : this.getMap();\n        if (!coordinate) {\n            coordinate = this.getCenter();\n        }\n        if (!this._menu) {\n            if (this._menuOptions && map) {\n                this._bindMenu(this._menuOptions);\n                this._menu.show(coordinate);\n            }\n        } else {\n            this._menu.show(coordinate);\n        }\n        return this;\n    },\n\n    /**\n     * Set menu items to the context menu\n     * @param {Object[]} items - menu items\n     * @return {*} this\n     * @function ui.Menuable.setMenuItems\n     */\n    setMenuItems(items) {\n        if (!this._menuOptions) {\n            this._menuOptions = {};\n        }\n        if (Array.isArray(items)) {\n            this._menuOptions['custom'] = false;\n        }\n        this._menuOptions['items'] = items;\n        this.setMenu(this._menuOptions);\n        return this;\n    },\n\n    /**\n     * Get the context menu items\n     * @return {Object[]}\n     * @function ui.Menuable.getMenuItems\n     */\n    getMenuItems() {\n        if (this._menu) {\n            return this._menu.getItems();\n        } else if (this._menuOptions) {\n            return this._menuOptions['items'] || [];\n        }\n        return [];\n    },\n\n    /**\n     * Close the contexnt menu\n     * @return {*} this\n     * @function ui.Menuable.closeMenu\n     */\n    closeMenu() {\n        if (this._menu) {\n            this._menu.hide();\n        }\n        return this;\n    },\n\n    /**\n     * Remove the context menu\n     * @return {*} this\n     * @function ui.Menuable.removeMenu\n     */\n    removeMenu() {\n        this.off('contextmenu', this._defaultOpenMenu, this);\n        this._unbindMenu();\n        delete this._menuOptions;\n        return this;\n    },\n\n    _bindMenu(options) {\n        this._menu = new Menu(options);\n        this._menu.addTo(this);\n\n        return this;\n    },\n\n    _unbindMenu() {\n        if (this._menu) {\n            this.closeMenu();\n            this._menu.remove();\n            delete this._menu;\n        }\n        return this;\n    },\n\n    /**\n     * If contextmenu is not listened, open the menu in default.<br>\n     * Otherwise, do nothing here.\n     * @param  {Object} param - event parameter\n     * @return {Boolean} true | false to stop event propagation\n     * @private\n     */\n    _defaultOpenMenu(param) {\n        if (this.listens('contextmenu') > 1) {\n            return true;\n        } else {\n            this.openMenu(param['coordinate']);\n            return false;\n        }\n    }\n};\n\nMap.include(Menuable);\nGeometry.include(Menuable);\n\nexport default Menuable;\n","import { extend, isNil, isString } from '../core/util';\nimport { createEl, setStyle, removeDomNode } from '../core/util/dom';\nimport Eventable from '../core/Eventable';\nimport Class from '../core/Class';\nimport Point from '../geo/Point';\nimport Map from '../map/Map';\n\n/**\n * Base class for all the map controls, you can extend it to build your own customized Control.\n * It is abstract and not intended to be instantiated.\n * @category control\n * @memberOf control\n * @abstract\n * @extends Class\n * @mixes Eventable\n */\nclass Control extends Eventable(Class) {\n\n    /**\n     * Methods needs to implement:  <br>\n     *  <br>\n     * 1. Method to create UI's Dom element  <br>\n     * function buildOn : HTMLElement  <br>\n     *  <br>\n     * 2. Optional, a callback when the control is added.  <br>\n     * function onAdd : void  <br>\n     * 3. Optional, a callback when the control is removed.  <br>\n     * function onRemove : void  <br>\n     *  <br>\n     * @param  {Object} [options=null] configuration options\n     */\n    constructor(options) {\n        if (options && options['position'] && !isString(options['position'])) {\n            options['position'] = extend({}, options['position']);\n        }\n        super(options);\n    }\n\n    /**\n     * Adds the control to a map.\n     * @param {Map} map\n     * @returns {control.Control} this\n     * @fires control.Control#add\n     */\n    addTo(map) {\n        this.remove();\n        if (!map.options['control']) {\n            return this;\n        }\n        this._map = map;\n        const controlContainer = map._panels.control;\n        this.__ctrlContainer = createEl('div');\n        setStyle(this.__ctrlContainer, 'position:absolute;overflow:visible;');\n        // on(this.__ctrlContainer, 'mousedown mousemove click dblclick contextmenu', stopPropagation)\n        this.update();\n        controlContainer.appendChild(this.__ctrlContainer);\n        if (this.onAdd) {\n            this.onAdd();\n        }\n        /**\n         * add event.\n         *\n         * @event control.Control#add\n         * @type {Object}\n         * @property {String} type - add\n         * @property {control.Control} target - the control instance\n         */\n        this.fire('add', {\n            'dom': controlContainer\n        });\n        return this;\n    }\n\n    /**\n     * update control container\n     * @return {control.Control} this\n     */\n    update() {\n        this.__ctrlContainer.innerHTML = '';\n        this._controlDom = this.buildOn(this.getMap());\n        if (this._controlDom) {\n            this._updatePosition();\n            this.__ctrlContainer.appendChild(this._controlDom);\n        }\n        return this;\n    }\n\n    /**\n     * Get the map that the control is added to.\n     * @return {Map}\n     */\n    getMap() {\n        return this._map;\n    }\n\n    /**\n     * Get the position of the control\n     * @return {Object}\n     */\n    getPosition() {\n        return extend({}, this._parse(this.options['position']));\n    }\n\n    /**\n     * update the control's position\n     * @param {String|Object} position - can be one of 'top-left', 'top-right', 'bottom-left', 'bottom-right' or a position object like {'top': 40,'left': 60}\n     * @return {control.Control} this\n     * @fires control.Control#positionchange\n     */\n    setPosition(position) {\n        if (isString(position)) {\n            this.options['position'] = position;\n        } else {\n            this.options['position'] = extend({}, position);\n        }\n        this._updatePosition();\n        return this;\n    }\n\n    /**\n     * Get the container point of the control.\n     * @return {Point}\n     */\n    getContainerPoint() {\n        const position = this.getPosition();\n\n        const size = this.getMap().getSize();\n        let x, y;\n        if (!isNil(position['left'])) {\n            x = parseInt(position['left']);\n        } else if (!isNil(position['right'])) {\n            x = size['width'] - parseInt(position['right']);\n        }\n        if (!isNil(position['top'])) {\n            y = parseInt(position['top']);\n        } else if (!isNil(position['bottom'])) {\n            y = size['height'] - parseInt(position['bottom']);\n        }\n        return new Point(x, y);\n    }\n\n    /**\n     * Get the control's container.\n     * Container is a div element wrapping the control's dom and decides the control's position and display.\n     * @return {HTMLElement}\n     */\n    getContainer() {\n        return this.__ctrlContainer;\n    }\n\n    /**\n     * Get html dom element of the control\n     * @return {HTMLElement}\n     */\n    getDOM() {\n        return this._controlDom;\n    }\n\n    /**\n     * Show\n     * @return {control.Control} this\n     */\n    show() {\n        this.__ctrlContainer.style.display = '';\n        return this;\n    }\n\n    /**\n     * Hide\n     * @return {control.Control} this\n     */\n    hide() {\n        this.__ctrlContainer.style.display = 'none';\n        return this;\n    }\n\n    /**\n     * Whether the control is visible\n     * @return {Boolean}\n     */\n    isVisible() {\n        return (this.__ctrlContainer && this.__ctrlContainer.style.display === '');\n    }\n\n    /**\n     * Remove itself from the map\n     * @return {control.Control} this\n     * @fires control.Control#remove\n     */\n    remove() {\n        if (!this._map) {\n            return this;\n        }\n        removeDomNode(this.__ctrlContainer);\n        if (this.onRemove) {\n            this.onRemove();\n        }\n        delete this._map;\n        delete this.__ctrlContainer;\n        delete this._controlDom;\n        /**\n         * remove event.\n         *\n         * @event control.Control#remove\n         * @type {Object}\n         * @property {String} type - remove\n         * @property {control.Control} target - the control instance\n         */\n        this.fire('remove');\n        return this;\n    }\n\n    _parse(position) {\n        let p = position;\n        if (isString(position)) {\n            p = Control['positions'][p];\n        }\n        return p;\n    }\n\n    _updatePosition() {\n        let position = this.getPosition();\n        if (!position) {\n            //default one\n            position = {\n                'top': 20,\n                'left': 20\n            };\n        }\n        for (const p in position) {\n            if (position.hasOwnProperty(p)) {\n                position[p] = parseInt(position[p]);\n                this.__ctrlContainer.style[p] = position[p] + 'px';\n            }\n        }\n        /**\n         * Control's position update event.\n         *\n         * @event control.Control#positionchange\n         * @type {Object}\n         * @property {String} type - positionchange\n         * @property {control.Control} target - the control instance\n         * @property {Object} position - Position of the control, eg:{\"top\" : 100, \"left\" : 50}\n         */\n        this.fire('positionchange', {\n            'position': extend({}, position)\n        });\n    }\n\n}\n\nControl.positions = {\n    'top-left': {\n        'top'   : 20,\n        'left'  : 20\n    },\n    'top-right': {\n        'top'   : 20,\n        'right' : 20\n    },\n    'bottom-left': {\n        'bottom': 20,\n        'left'  : 20\n    },\n    'bottom-right': {\n        'bottom': 20,\n        'right' : 20\n    }\n};\n\nMap.mergeOptions({\n    'control': true\n});\n\nMap.include(/** @lends Map.prototype */ {\n    /**\n     * Add a control on the map.\n     * @param {control.Control} control - contorl to add\n     * @return {Map} this\n     */\n    addControl: function (control) {\n        // if map container is a canvas, can't add control on it.\n        if (this._containerDOM.getContext) {\n            return this;\n        }\n        control.addTo(this);\n        return this;\n    },\n\n    /**\n     * Remove a control from the map.\n     * @param {control.Control} control - control to remove\n     * @return {Map} this\n     */\n    removeControl: function (control) {\n        if (!control || control.getMap() !== this) {\n            return this;\n        }\n        control.remove();\n        return this;\n    }\n\n});\n\nexport default Control;\n","import { createEl } from '../core/util/dom';\nimport Control from './Control';\nimport Map from '../map/Map';\n\n/**\n * @property {Object} options - options\n * @property {Object} [options.position='bottom-left'] - position of the control, this option defined in [Control.position]{@link Control#positions}.\n * @property {String} [options.content='Powered by <a href=\"http://maptalks.org\" target=\"_blank\">maptalks</a>']  - content of the attribution control, HTML format\n * @memberOf control.Attribution\n * @instance\n */\nconst options = {\n    'position': {\n        'bottom': 0,\n        'left': 0\n    },\n    'content': '<a href=\"http://maptalks.org\" target=\"_blank\">maptalks</a>'\n};\n\nconst layerEvents = 'addlayer removelayer setbaselayer baselayerremove';\n\n/**\n * @classdesc\n * A control to allows to display attribution content in a small text box on the map.\n * @category control\n * @extends control.Control\n * @memberOf control\n * @example\n * var map = new maptalks.Map('map', {\n *    center: [-0.113049, 51.498568],\n *    zoom: 14,\n *    attribution: {\n *       content : 'my attribution',\n *       position : 'bottom-left'\n *    },\n *    baseLayer: new maptalks.TileLayer('base', {\n *        urlTemplate: 'http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png',\n *        subdomains: ['a','b','c','d'],\n *        attribution: '&copy; <a href=\"http://osm.org\">OpenStreetMap</a> contributors, &copy; <a href=\"https://carto.com/\">CARTO</a>'\n *    })\n * });\n * map.addLayer(new maptalks.TileLayer('base', {\n *      urlTemplate: 'http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png',\n *      subdomains: ['a','b','c','d'],\n *      attribution: '&copy; <a href=\"http://osm.org\">OpenStreetMap</a> contributors, &copy; <a href=\"https://carto.com/\">CARTO</a>'\n * }));\n */\nclass Attribution extends Control {\n\n    buildOn() {\n        this._attributionContainer = createEl('div');\n        this._attributionContainer.className = 'maptalks-attribution';\n        this._update();\n        return this._attributionContainer;\n    }\n\n    onAdd() {\n        this.getMap().on(layerEvents, this._update, this);\n    }\n\n    onRemove() {\n        this.getMap().off(layerEvents, this._update, this);\n    }\n\n    _update() {\n        const map = this.getMap();\n        if (!map) {\n            return;\n        }\n\n        const attributions = map\n            ._getLayers(layer => layer.options['attribution'])\n            .reverse()\n            .map(layer => layer.options['attribution']);\n        const content = this.options['content'] + (attributions.length > 0 ? ' - ' + attributions.join(', ') : '');\n        this._attributionContainer.innerHTML = '<span style=\"padding:0px 4px\">' + content + '</span>';\n    }\n}\n\nAttribution.mergeOptions(options);\n\nMap.mergeOptions({\n    'attribution': true\n});\n\nMap.addOnLoadHook(function () {\n    const a = this.options['attribution'] || this.options['attributionControl'];\n    if (a) {\n        this.attributionControl = new Attribution(a);\n        this.addControl(this.attributionControl);\n    }\n});\n\nexport default Attribution;\n","import { on, off, createEl, removeDomNode, addClass, hasClass, setClass } from '../core/util/dom';\nimport Map from '../map/Map';\nimport Control from './Control';\n\n/**\n * @property {Object} options - options\n * @property {Object} [options.position='top-right'] - position of the control\n * @property {Object} [options.baseTitle='Base Layers'] - title of the base layers\n * @property {Object} [options.overlayTitle='Layers'] - title of the overlay layers\n * @property {Object} [options.excludeLayers=[]] - ids of layers that don't display in layerswitcher\n * @property {Object} [options.containerClass=maptalks-layer-switcher] - layerswitcher's container div's CSS class\n *\n * @memberOf control.LayerSwitcher\n * @instance\n */\nconst options = {\n    'position' : 'top-right',\n    'baseTitle' : 'Base Layers',\n    'overlayTitle' : 'Layers',\n    'excludeLayers' : [],\n    'containerClass' : 'maptalks-layer-switcher'\n};\n\n/**\n * @classdesc\n * A LayerSwitcher control for the map.\n * @category control\n * @extends control.Control\n * @memberOf control\n * @example\n * var LayerSwitcher = new LayerSwitcher({\n *     position : {'top': '0', 'right': '0'}\n * }).addTo(map);\n*/\nclass LayerSwitcher extends Control {\n    /**\n     * method to build DOM of the control\n     * @return {HTMLDOMElement}\n     */\n    buildOn() {\n        const container = this.container = createEl('div', this.options['containerClass']),\n            panel = this.panel = createEl('div', 'panel'),\n            button = this.button = createEl('button');\n        container.appendChild(button);\n        container.appendChild(panel);\n        return container;\n    }\n\n    onAdd() {\n        on(this.button, 'mouseover', this._show, this);\n        on(this.panel, 'mouseleave', this._hide, this);\n        on(this.getMap(), 'click', this._hide, this);\n    }\n\n    onRemove() {\n        if (this.panel) {\n            off(this.button, 'mouseover', this._show, this);\n            off(this.panel, 'mouseleave', this._hide, this);\n            off(this.getMap(), 'click', this._hide, this);\n            removeDomNode(this.panel);\n            removeDomNode(this.button);\n            delete this.panel;\n            delete this.button;\n            delete this.container;\n        }\n    }\n\n    _show() {\n        if (!hasClass(this.container, 'shown')) {\n            addClass(this.container, 'shown');\n            this._createPanel();\n        }\n    }\n\n    _hide(e) {\n        if (!this.panel.contains(e.toElement || e.relatedTarget)) {\n            setClass(this.container, this.options['containerClass']);\n        }\n    }\n\n    _createPanel() {\n        this.panel.innerHTML = '';\n        const ul = createEl('ul');\n        this.panel.appendChild(ul);\n        this._renderLayers(this.getMap(), ul);\n    }\n\n    _renderLayers(map, elm) {\n        const base = map.getBaseLayer(),\n            layers = map.getLayers(),\n            len = layers.length;\n        if (base) {\n            const baseLayers = base.layers || [base],\n                li = createEl('li', 'group'),\n                ul =  createEl('ul'),\n                label = createEl('label');\n            label.innerHTML = this.options['baseTitle'];\n            li.appendChild(label);\n            for (let i = 0, len = baseLayers.length; i < len; i++) {\n                const layer = baseLayers[i];\n                if (this._isExcluded(layer)) {\n                    ul.appendChild(this._renderLayer(baseLayers[i], true));\n                    li.appendChild(ul);\n                    elm.appendChild(li);\n                }\n            }\n        }\n\n        if (len) {\n            const li = createEl('li', 'group'),\n                ul = createEl('ul'),\n                label = createEl('label');\n            label.innerHTML = this.options['overlayTitle'];\n            li.appendChild(label);\n            for (let i = 0; i < len; i++) {\n                const layer = layers[i];\n                if (this._isExcluded(layer)) {\n                    ul.appendChild(this._renderLayer(layer));\n                }\n            }\n            li.appendChild(ul);\n            elm.appendChild(li);\n        }\n    }\n\n    _isExcluded(layer) {\n        const id = layer.getId(),\n            excludeLayers = this.options['excludeLayers'];\n        return !(excludeLayers.length && excludeLayers.indexOf(id) >= 0);\n    }\n\n    _renderLayer(layer, isBase) {\n        const li = createEl('li', 'layer'),\n            label =  createEl('label'),\n            input = createEl('input'),\n            map = this.getMap();\n        const visible = layer.options['visible'];\n        layer.options['visible'] = true;\n        const enabled = layer.isVisible();\n        layer.options['visible'] = visible;\n        li.className = 'layer';\n        if (isBase) {\n            input.type = 'radio';\n            input.name = 'base';\n        } else {\n            input.type = 'checkbox';\n        }\n\n        input.checked = visible && enabled;\n        if (!enabled) {\n            input.setAttribute('disabled', 'disabled');\n        }\n\n        input.onchange = e => {\n            if (e.target.type === 'radio') {\n                const baseLayer = map.getBaseLayer(),\n                    baseLayers = baseLayer.layers;\n                if (baseLayers) {\n                    for (let i = 0, len = baseLayers.length; i < len; i++) {\n                        const _baseLayer = baseLayers[i];\n                        _baseLayer[_baseLayer === layer ? 'show' : 'hide']();\n                    }\n                } else if (!baseLayer.isVisible()) {\n                    baseLayer.show();\n                }\n                map._fireEvent('setbaselayer');\n            } else {\n                layer[e.target.checked ? 'show' : 'hide']();\n            }\n            this.fire('layerchange', { target : layer });\n        };\n        li.appendChild(input);\n        label.innerHTML = layer.getId();\n        li.appendChild(label);\n        return li;\n    }\n}\n\nLayerSwitcher.mergeOptions(options);\n\nMap.mergeOptions({\n    'layerSwitcherControl': false\n});\n\nMap.addOnLoadHook(function () {\n    if (this.options['layerSwitcherControl']) {\n        this.layerSwitcherControl = new LayerSwitcher(this.options['layerSwitcherControl']);\n        this.addControl(this.layerSwitcherControl);\n    }\n});\n\nexport default LayerSwitcher;\n","import { extend, isFunction } from '../core/util';\nimport { on, off, createEl, computeDomPosition } from '../core/util/dom';\nimport Polygon from '../geometry/Polygon';\nimport Layer from '../layer/Layer';\nimport VectorLayer from '../layer/VectorLayer';\nimport Map from '../map/Map';\nimport Control from './Control';\n\n/**\n * @property {Object} options - options\n * @property {Object} [options.position='bottom-right'] - position of the control\n * @property {Number} [options.level=4]  - the zoom level of the overview\n * @property {Object} [options.maximize=true]  - whether to maximize overview when added\n * @property {Object} [options.size=[300, 200]  - size of the Control\n * @property {Object} [options.symbol={}] - symbol of the overview rectangle\n * @property {Object} [options.containerClass=maptalks-overview] - overview's container div's CSS class\n * @property {Object} [options.buttonClass=maptalks-overview-button] - overview's minimize/maximize button's CSS class\n *\n * @memberOf control.Overview\n * @instance\n */\nconst options = {\n    'level': 4,\n    'position': {\n        'right' : 1,\n        'bottom' : 1\n    },\n    'size': [300, 200],\n    'maximize' : true,\n    'symbol': {\n        'lineWidth': 3,\n        'lineColor': '#1bbc9b',\n        'polygonFill': '#1bbc9b',\n        'polygonOpacity': 0.4\n    },\n    'containerClass' : 'maptalks-overview',\n    'buttonClass' : 'maptalks-overview-button'\n};\n\n/**\n * @classdesc\n * An overview control for the map.\n * @category control\n * @extends control.Control\n * @memberOf control\n * @example\n * var overview = new Overview({\n *     position : {'bottom': '0', 'right': '0'},\n *     size : {'width' : 300,'height' : 200}\n * }).addTo(map);\n */\nclass Overview extends Control {\n\n    /**\n     * method to build DOM of the control\n     * @param  {Map} map map to build on\n     * @return {HTMLDOMElement}\n     */\n    buildOn() {\n        let size = this.options['size'];\n        if (!this.options['maximize']) {\n            size = [0, 0];\n        }\n        const container = createEl('div');\n\n        const mapContainer = this.mapContainer = createEl('div');\n        mapContainer.style.width = size[0] + 'px';\n        mapContainer.style.height = size[1] + 'px';\n        mapContainer.className = this.options['containerClass'];\n        const button = this.button = createEl('div');\n        button.className = this.options['buttonClass'];\n        container.appendChild(mapContainer);\n        container.appendChild(button);\n        return container;\n    }\n\n    onAdd() {\n        if (this.options['maximize']) {\n            this._createOverview();\n        }\n        this.getMap().on('resize moving zooming rotate dragrotating viewchange', this._update, this)\n            .on('setbaselayer', this._updateBaseLayer, this)\n            .on('spatialreferencechange', this._updateSpatialReference, this);\n        on(this.button, 'click', this._onButtonClick, this);\n        this._updateButtonText();\n    }\n\n    onRemove() {\n        this.getMap()\n            .off('resize moving zooming rotate dragrotating viewchange', this._update, this)\n            .off('setbaselayer', this._updateBaseLayer, this)\n            .off('spatialreferencechange', this._updateSpatialReference, this);\n        if (this._overview) {\n            this._overview.remove();\n            delete this._overview;\n            delete this._perspective;\n        }\n        off(this.button, 'click', this._onButtonClick, this);\n    }\n\n    /**\n     * Maximize overview control\n     * @returns {control.Overview}\n     */\n    maxmize() {\n        const size = this.options['size'];\n        const dom = this.mapContainer;\n        dom.style.width = size[0] + 'px';\n        dom.style.height = size[1] + 'px';\n        this._createOverview();\n        return this;\n    }\n\n    /**\n     * Minimize overview control\n     * @returns {control.Overview}\n     */\n    minimize() {\n        if (this._overview) {\n            this._overview.remove();\n        }\n        delete this._overview;\n        delete this._perspective;\n        const dom = this.mapContainer;\n        dom.style.width = 0 + 'px';\n        dom.style.height = 0 + 'px';\n        return this;\n    }\n\n    /**\n     * Return overview's map object\n     * @returns {Map}\n     */\n    getOverviewMap() {\n        return this._overview;\n    }\n\n    _onButtonClick() {\n        if (!this._overview) {\n            this.maxmize();\n        } else {\n            this.minimize();\n        }\n        this._updateButtonText();\n    }\n\n    _updateButtonText() {\n        if (this._overview) {\n            this.button.innerHTML = '-';\n        } else {\n            this.button.innerHTML = '+';\n        }\n    }\n\n    _createOverview() {\n        const map = this.getMap(),\n            dom = this.mapContainer;\n        const options = map.config();\n        extend(options, {\n            'center': map.getCenter(),\n            'zoom': this._getOverviewZoom(),\n            'zoomAnimationDuration'  : 150,\n            'pitch' : 0,\n            'bearing' : 0,\n            'scrollWheelZoom': false,\n            'checkSize': false,\n            'doubleClickZoom': false,\n            'touchZoom': false,\n            'control': false,\n            'draggable' : false,\n            'maxExtent' : null\n        });\n        this._overview = new Map(dom, options);\n        this._updateBaseLayer();\n        this._perspective = new Polygon(this._getPerspectiveCoords(), {\n            'draggable': true,\n            'cursor': 'move',\n            'symbol': this.options['symbol']\n        })\n            .on('dragend', this._onDragEnd, this);\n        new VectorLayer('perspective_layer', this._perspective).addTo(this._overview);\n        this.fire('load');\n    }\n\n    _getOverviewZoom() {\n        const map = this.getMap(),\n            zoom = map.getZoom(),\n            minZoom = map.getMinZoom(),\n            level = this.options['level'];\n        if (level > 0) {\n            for (let i = level; i > 0; i--) {\n                if (zoom - i >= minZoom) {\n                    return zoom - i;\n                }\n            }\n        } else {\n            for (let i = level; i < 0; i++) {\n                if (zoom - i >= minZoom) {\n                    return zoom - i;\n                }\n            }\n        }\n\n        return zoom;\n    }\n\n\n    _onDragEnd() {\n        const center = this._perspective.getCenter();\n        this._overview.setCenter(center);\n        this.getMap().panTo(center);\n    }\n\n    _getPerspectiveCoords() {\n        const map = this.getMap();\n        return map.getContainerExtent().toArray().map(c => map.containerPointToCoordinate(c));\n    }\n\n    _update() {\n        if (!this._overview) {\n            return;\n        }\n        // refresh map's dom position\n        computeDomPosition(this._overview._containerDOM);\n        const coords = this._getPerspectiveCoords();\n        this._perspective.setCoordinates(coords);\n        this._overview.setCenterAndZoom(this.getMap().getCenter(), this._getOverviewZoom());\n    }\n\n    _updateSpatialReference() {\n        if (!this._overview) {\n            return;\n        }\n        const map = this.getMap();\n        const spatialRef = map.options['spatialReference'];\n        this._overview.setSpatialReference(spatialRef);\n    }\n\n    _updateBaseLayer() {\n        if (!this._overview) {\n            return;\n        }\n        const map = this.getMap(),\n            baseLayer = map.getBaseLayer();\n        if (!baseLayer) {\n            this._overview.setBaseLayer(null);\n            return;\n        }\n        const layers = baseLayer.layers;\n        let showIndex = 0;\n        if (layers) {\n            for (let i = 0, l = layers.length; i < l; i++) {\n                const layer = layers[i];\n                if (layer.isVisible()) {\n                    showIndex = i;\n                    break;\n                }\n            }\n        }\n\n        const json = baseLayer.toJSON();\n        let options = null;\n        if (layers) {\n            options = json.layers[showIndex].options;\n            options.visible = true;\n        } else {\n            options = json.options;\n        }\n        this._overview.setMinZoom(options.minZoom || null)\n            .setMaxZoom(options.maxZoom || null);\n        delete options.minZoom;\n        delete options.maxZoom;\n        delete json.options.canvas;\n        json.options.visible = true;\n        json.options.renderer = 'canvas';\n        const layer = Layer.fromJSON(json);\n        for (const p in baseLayer) {\n            if (isFunction(baseLayer[p]) && baseLayer.hasOwnProperty(p) && baseLayer[p] !== baseLayer.constructor.prototype[p]) {\n                layer[p] = baseLayer[p];\n            }\n        }\n        this._overview.setBaseLayer(layer);\n    }\n}\n\nOverview.mergeOptions(options);\n\nMap.mergeOptions({\n    'overviewControl': false\n});\n\nMap.addOnLoadHook(function () {\n    if (this.options['overviewControl']) {\n        this.overviewControl = new Overview(this.options['overviewControl']);\n        this.addControl(this.overviewControl);\n    }\n});\n\nexport default Overview;\n","import { extend, isNil, isString } from '../core/util';\nimport { createEl } from '../core/util/dom';\nimport DragHandler from '../handler/Drag';\nimport Control from './Control';\n\n/**\n * @property {Object} options - options\n * @property {Object} [options.position='top-right']       - position of the control\n * @property {Boolean} [options.draggable=true]            - whether the panel can be dragged\n * @property {Boolean} [options.custom=false]              - whether the panel's content is customized .\n * @property {String|HTMLElement} options.content          - panel's content, can be a dom element or a string.\n * @property {Boolean} [options.closeButton=true]          - whether to display the close button on the panel.\n * @memberOf control.Panel\n * @instance\n */\nconst options = {\n    'position': 'top-right',\n    'draggable': true,\n    'custom': false,\n    'content': '',\n    'closeButton': true\n};\n\n\n\n/**\n * @classdesc\n * Class for panel controls.\n * @category control\n * @extends control.Control\n * @memberOf control\n * @example\n * var panel = new Panel({\n *     position : {'bottom': '0', 'right': '0'},\n *     draggable : true,\n *     custom : false,\n *     content : '<div class=\"map-panel\">hello </div>',\n *     closeButton : true\n * }).addTo(map);\n */\nclass Panel extends Control {\n\n    /**\n     * method to build DOM of the control\n     * @param  {Map} map map to build on\n     * @return {HTMLDOMElement}\n     */\n    buildOn() {\n        let dom;\n        if (this.options['custom']) {\n            if (isString(this.options['content'])) {\n                dom = createEl('div');\n                dom.innerHTML = this.options['content'];\n            } else {\n                dom = this.options['content'];\n            }\n        } else {\n            dom = createEl('div', 'maptalks-panel');\n            if (this.options['closeButton']) {\n                const closeButton = createEl('a', 'maptalks-close');\n                closeButton.href = 'javascript:;';\n                closeButton.onclick = function () {\n                    dom.style.display = 'none';\n                };\n                dom.appendChild(closeButton);\n            }\n\n            const panelContent = createEl('div', 'maptalks-panel-content');\n            panelContent.innerHTML = this.options['content'];\n            dom.appendChild(panelContent);\n        }\n\n        this.draggable = new DragHandler(dom, {\n            'cancelOn': this._cancelOn.bind(this),\n            'ignoreMouseleave' : true\n        });\n\n        this.draggable.on('dragstart', this._onDragStart, this)\n            .on('dragging', this._onDragging, this)\n            .on('dragend', this._onDragEnd, this);\n\n        if (this.options['draggable']) {\n            this.draggable.enable();\n        }\n\n        return dom;\n    }\n\n    /**\n     * update control container\n     * @return {control.Panel} this\n     */\n    update() {\n        if (this.draggable) {\n            this.draggable.disable();\n            delete this.draggable;\n        }\n        return Control.prototype.update.call(this);\n    }\n\n    /**\n     * Set the content of the Panel.\n     * @param {String|HTMLElement} content - content of the infowindow.\n     * return {control.Panel} this\n     * @fires Panel#contentchange\n     */\n    setContent(content) {\n        const old = this.options['content'];\n        this.options['content'] = content;\n        /**\n         * contentchange event.\n         *\n         * @event Panel#contentchange\n         * @type {Object}\n         * @property {String} type - contentchange\n         * @property {control.Panel} target - Panel\n         * @property {String|HTMLElement} old      - old content\n         * @property {String|HTMLElement} new      - new content\n         */\n        this.fire('contentchange', {\n            'old': old,\n            'new': content\n        });\n        if (this.isVisible()) {\n            this.update();\n        }\n        return this;\n    }\n\n    /**\n     * Get content of  the infowindow.\n     * @return {String|HTMLElement} - content of the infowindow\n     */\n    getContent() {\n        return this.options['content'];\n    }\n\n    _cancelOn(domEvent) {\n        const target = domEvent.srcElement || domEvent.target,\n            tagName = target.tagName.toLowerCase();\n        if (tagName === 'button' ||\n            tagName === 'input' ||\n            tagName === 'select' ||\n            tagName === 'option' ||\n            tagName === 'textarea') {\n            return true;\n        }\n        return false;\n    }\n\n    _onDragStart(param) {\n        this._startPos = param['mousePos'];\n        this._startPosition = extend({}, this.getPosition());\n        /**\n         * drag start event\n         * @event control.Panel#dragstart\n         * @type {Object}\n         * @property {String} type        - dragstart\n         * @property {UIMarker} target    - the panel control fires event\n         * @property {Point} mousePos     - mouse position\n         * @property {Event} domEvent     - dom event\n         */\n        this.fire('dragstart', param);\n    }\n\n    _onDragging(param) {\n        const pos = param['mousePos'];\n        const offset = pos.sub(this._startPos);\n\n        const startPosition = this._startPosition;\n        const position = this.getPosition();\n        if (!isNil(position['top'])) {\n            position['top'] = parseInt(startPosition['top']) + offset.y;\n        }\n        if (!isNil(position['bottom'])) {\n            position['bottom'] = parseInt(startPosition['bottom']) - offset.y;\n        }\n        if (!isNil(position['left'])) {\n            position['left'] = parseInt(startPosition['left']) + offset.x;\n        }\n        if (!isNil(position['right'])) {\n            position['right'] = parseInt(startPosition['right']) - offset.x;\n        }\n        this.setPosition(position);\n        /**\n         * dragging event\n         * @event control.Panel#dragging\n         * @type {Object}\n         * @property {String} type        - dragging\n         * @property {UIMarker} target    - the panel control fires event\n         * @property {Point} mousePos     - mouse position\n         * @property {Event} domEvent     - dom event\n         */\n        this.fire('dragging', param);\n    }\n\n    _onDragEnd(param) {\n        delete this._startPos;\n        delete this._startPosition;\n        /**\n         * drag end event\n         * @event control.Panel#dragend\n         * @type {Object}\n         * @property {String} type        - dragend\n         * @property {UIMarker} target    - the panel control fires event\n         * @property {Point} mousePos     - mouse position\n         * @property {Event} domEvent     - dom event\n         */\n        this.fire('dragend', param);\n    }\n\n    /**\n     * Get the connect points of panel for connector lines.\n     * @private\n     */\n    _getConnectPoints() {\n        const map = this.getMap();\n        const containerPoint = this.getContainerPoint();\n        const dom = this.getDOM(),\n            width = parseInt(dom.clientWidth),\n            height = parseInt(dom.clientHeight);\n        const anchors = [\n            //top center\n            map.containerPointToCoordinate(\n                containerPoint.add(width / 2, 0)\n            ),\n            //middle right\n            map.containerPointToCoordinate(\n                containerPoint.add(width, height / 2)\n            ),\n            //bottom center\n            map.containerPointToCoordinate(\n                containerPoint.add(width / 2, height)\n            ),\n            //middle left\n            map.containerPointToCoordinate(\n                containerPoint.add(0, height / 2)\n            )\n\n        ];\n        return anchors;\n    }\n\n}\n\nPanel.mergeOptions(options);\n\nexport default Panel;\n","import { createEl, createElOn } from '../core/util/dom';\nimport Map from '../map/Map';\nimport Control from './Control';\n\n/**\n * @property {Object} [options=null] - options\n * @property {String|Object}   [options.position=\"bottom-left\"]  - position of the scale control.\n * @property {Number} [options.maxWidth=100]               - max width of the scale control.\n * @property {Boolean} [options.metric=true]               - Whether to show the metric scale line (m/km).\n * @property {Boolean} [options.imperial=false]            - Whether to show the imperial scale line (mi/ft).\n * @property {String|Object} [options.containerClass=null]           - scalControl's container div's CSS class\n * @instance\n * @memberOf control.Scale\n */\nconst options = {\n    'position': 'bottom-left',\n    'maxWidth': 100,\n    'metric': true,\n    'imperial': false,\n    'containerClass': null\n};\n\n/**\n * @classdesc\n * Based on scale control of Leaflet, a simple scale control that shows the scale of the current center of screen in metric (m/km) and imperial (mi/ft) systems.\n * @category control\n * @extends control.Control\n * @memberOf control\n * @example\n * var scale = new Scale({\n *     position : 'bottom-left',\n *     maxWidth : 160,\n *     metric : true,\n *     imperial : true,\n *     containerClass : null\n * }).addTo(map);\n */\nclass Scale extends Control {\n\n    /**\n     * method to build DOM of the control\n     * @param  {Map} map map to build on\n     * @return {HTMLDOMElement}\n     */\n    buildOn(map) {\n        this._map = map;\n        this._scaleContainer = createEl('div', this.options['containerClass']);\n        this._addScales();\n        map.on('zoomend', this._update, this);\n        if (this._map._loaded) {\n            this._update();\n        }\n        return this._scaleContainer;\n    }\n\n    onRemove() {\n        this.getMap().off('zoomend', this._update, this);\n    }\n\n    _addScales() {\n        const css = 'border: 2px solid #000000;border-top: none;line-height: 1.1;padding: 0px;' +\n            'color: #000000;font-size: 11px;text-align:center;white-space: nowrap;overflow: hidden' +\n            ';-moz-box-sizing: content-box;box-sizing: content-box;background: #fff; background: rgba(255, 255, 255, 0);';\n        if (this.options['metric']) {\n            this._mScale = createElOn('div', this.options['containerClass'] ? null : css, this._scaleContainer);\n        }\n        if (this.options['imperial']) {\n            this._iScale = createElOn('div', this.options['containerClass'] ? null : css, this._scaleContainer);\n        }\n    }\n\n    _update() {\n        const map = this._map;\n        const maxMeters = map.pixelToDistance(this.options['maxWidth'], 0);\n        this._updateScales(maxMeters);\n    }\n\n    _updateScales(maxMeters) {\n        if (this.options['metric'] && maxMeters) {\n            this._updateMetric(maxMeters);\n        }\n        if (this.options['imperial'] && maxMeters) {\n            this._updateImperial(maxMeters);\n        }\n    }\n\n    _updateMetric(maxMeters) {\n        const meters = this._getRoundNum(maxMeters),\n            label = meters < 1000 ? meters + ' m' : (meters / 1000) + ' km';\n\n        this._updateScale(this._mScale, label, meters / maxMeters);\n    }\n\n    _updateImperial(maxMeters) {\n        const maxFeet = maxMeters * 3.2808399;\n        let maxMiles, miles, feet;\n\n        if (maxFeet > 5280) {\n            maxMiles = maxFeet / 5280;\n            miles = this._getRoundNum(maxMiles);\n            this._updateScale(this._iScale, miles + ' mile', miles / maxMiles);\n\n        } else {\n            feet = this._getRoundNum(maxFeet);\n            this._updateScale(this._iScale, feet + ' feet', feet / maxFeet);\n        }\n    }\n\n    _updateScale(scale, text, ratio) {\n        scale['style']['width'] = Math.round(this.options['maxWidth'] * ratio) + 'px';\n        scale['innerHTML'] = text;\n    }\n\n    _getRoundNum(num) {\n        const pow10 = Math.pow(10, (Math.floor(num) + '').length - 1);\n        let d = num / pow10;\n\n        d = d >= 10 ? 10 :\n            d >= 5 ? 5 :\n                d >= 3 ? 3 :\n                    d >= 2 ? 2 : 1;\n\n        return pow10 * d;\n    }\n}\n\nScale.mergeOptions(options);\n\nMap.mergeOptions({\n    'scaleControl': false\n});\n\nMap.addOnLoadHook(function () {\n    if (this.options['scaleControl']) {\n        this.scaleControl = new Scale(this.options['scaleControl']);\n        this.addControl(this.scaleControl);\n    }\n});\n\nexport default Scale;\n","import { isArrayHasData } from '../core/util';\nimport { stringLength } from '../core/util/strings';\nimport { on, createEl, addClass, stopPropagation, measureDom, isHTML } from '../core/util/dom';\nimport Control from './Control';\n\n/**\n * @property {Object}   options - options\n * @property {String|Object}   [options.position=\"top-right\"]          - position of the toolbar control.\n * @property {Boolean}  [options.vertical=true]                        - Whether the toolbar is a vertical one.\n * @property {Boolean}  [options.reverseMenu=false]                    - Whether to reverse direction of drop menu.\n * @property {Object[]} options.items                                  - items on the toolbar\n * @memberOf control.Toolbar\n * @instance\n */\nconst options = {\n    'height': 28,\n    'vertical': false,\n    'position': 'top-right',\n    'reverseMenu' : false,\n    'items': {\n        //default buttons\n    }\n};\n\n/**\n * @classdesc\n * A toolbar control of the map.\n * @category control\n * @extends control.Control\n * @memberOf control\n * @example\n * var toolbar = new Toolbar({\n *     position : 'top-right',\n *     items: [\n *          {\n *            item: 'item1',\n *            click: function () {\n *              alert('item1 clicked');\n *            }\n *          },\n *          {\n *            item: 'item2',\n *            click: function () {\n *              alert('item2 clicked');\n *            }\n *          }\n *      ]\n * }).addTo(map);\n */\nclass Toolbar extends Control {\n    /**\n     * method to build DOM of the control\n     * @param  {Map} map map to build on\n     * @return {HTMLDOMElement}\n     */\n    buildOn(map) {\n        this._map = map;\n        const dom = createEl('div');\n        const ul = createEl('ul', 'maptalks-toolbar-hx');\n        dom.appendChild(ul);\n\n        if (this.options['vertical']) {\n            addClass(dom, 'maptalks-toolbar-vertical');\n        } else {\n            addClass(dom, 'maptalks-toolbar-horizonal');\n        }\n        const me = this;\n\n        function onButtonClick(fn, index, childIndex, targetDom) {\n            const item = me._getItems()[index];\n            return function (e) {\n                stopPropagation(e);\n                return fn({\n                    'target': item,\n                    'index': index,\n                    'childIndex': childIndex,\n                    'dom': targetDom\n                });\n            };\n        }\n\n        const items = this.options['items'];\n        if (isArrayHasData(items)) {\n            for (let i = 0, len = items.length; i < len; i++) {\n                const item = items[i];\n                const li = createEl('li');\n                if (this.options['height'] !== 28) {\n                    li.style.lineHeight = this.options['height'] + 'px';\n                }\n                li.style.height = this.options['height'] + 'px';\n                li.style.cursor = 'pointer';\n                if (isHTML(item['item'])) {\n                    li.style.textAlign = 'center';\n                    const itemSize = measureDom('div', item['item']);\n                    //vertical-middle\n                    li.innerHTML = '<div style=\"margin-top:' + (this.options['height'] - itemSize['height']) / 2 + 'px;\">' + item['item'] + '</div>';\n                } else {\n                    li.innerHTML = item['item'];\n                }\n                if (item['click']) {\n                    on(li, 'click', (onButtonClick)(item['click'], i, null, li));\n                }\n                if (isArrayHasData(item['children'])) {\n                    const dropMenu = this._createDropMenu(i);\n                    li.appendChild(dropMenu);\n                    li._menu = dropMenu;\n                    on(li, 'mouseover', function () {\n                        this._menu.style.display = '';\n                    });\n                    on(li, 'mouseout', function () {\n                        this._menu.style.display = 'none';\n                    });\n                }\n                ul.appendChild(li);\n            }\n        }\n        return dom;\n    }\n\n    _createDropMenu(index) {\n        const me = this;\n\n        function onButtonClick(fn, index, childIndex) {\n            const item = me._getItems()[index]['children'][childIndex];\n            return function (e) {\n                stopPropagation(e);\n                return fn({\n                    'target': item,\n                    'index': index,\n                    'childIndex': childIndex\n                });\n            };\n        }\n        const menuDom = createEl('div', 'maptalks-dropMenu'),\n            items = this._getItems(),\n            len = items.length,\n            menuUL = createEl('ul'),\n            children = items[index]['children'];\n        if (index === len - 1 && children) {\n            menuDom.style.cssText = 'right: 0px;';\n            menuUL.style.cssText = 'right: 0px;position: absolute;';\n            if (this.options['reverseMenu']) {\n                menuUL.style.bottom = 0;\n            }\n        }\n        menuDom.appendChild(createEl('em', 'maptalks-ico'));\n\n        let liWidth = 0;\n        for (let i = 0, l = children.length; i < l; i++) {\n            const size = stringLength(children[i]['item'], '12px');\n            if (size.width > liWidth) {\n                liWidth = size.width;\n            }\n        }\n        for (let i = 0, l = children.length; i < l; i++) {\n            const child = children[i];\n            const li = createEl('li');\n            li.innerHTML = '<a href=\"javascript:;\">' + child['item'] + '</a>';\n            li.style.cursor = 'pointer';\n            li.style.width = (liWidth + 24) + 'px'; // 20 for text-intent\n            on(li.childNodes[0], 'click', (onButtonClick)(child['click'], index, i));\n            menuUL.appendChild(li);\n        }\n        if (this.options['vertical']) {\n            const width = liWidth < 95 ? 95 : liWidth;\n            if (this.options['reverseMenu']) {\n                menuDom.style.right = -(width + 10 * 2) + 'px';\n            } else {\n                menuDom.style.left = -(width + 10 * 2) + 'px'; // 10: padding in .maptalks-toolbar-vertical li\n            }\n        } else if (this.options['reverseMenu']) {\n            menuDom.style.bottom = '28px';\n        } else {\n            menuDom.style.top = '28px';\n        }\n        menuDom.appendChild(menuUL);\n        menuDom.style.display = 'none';\n        return menuDom;\n    }\n\n    _getItems() {\n        return this.options['items'] || [];\n    }\n}\n\nToolbar.mergeOptions(options);\n\nexport default Toolbar;\n","import { isInteger } from '../core/util';\nimport { on, off, createEl, preventDefault, getEventContainerPoint } from '../core/util/dom';\nimport Map from '../map/Map';\nimport Control from './Control';\nimport DragHandler from '../handler/Drag';\n\n/**\n * @property {Object}   options - options\n * @property {String|Object}   [options.position=\"top-left\"]  - position of the zoom control.\n * @property {Boolean}  [options.slider=true]                         - Whether to display the slider\n * @property {Boolean}  [options.zoomLevel=true]                      - Whether to display the text box of zoom level\n * @memberOf control.Zoom\n * @instance\n */\nconst options = {\n    'position': 'top-left',\n    'slider': true,\n    'zoomLevel': true,\n    'seamless' : false\n};\n\nconst UNIT = 10;\n\n/**\n * @classdesc\n * A zoom control with buttons to zoomin/zoomout and a slider indicator for the zoom level.\n * @category control\n * @extends control.Control\n * @memberOf control\n * @example\n * var zoomControl = new Zoom({\n *     position : 'top-left',\n *     slider : true,\n *     zoomLevel : false\n * }).addTo(map);\n */\nclass Zoom extends Control {\n    /**\n     * method to build DOM of the control\n     * @param  {Map} map map to build on\n     * @return {HTMLDOMElement}\n     */\n    buildOn(map) {\n        const options = this.options;\n\n        const dom = createEl('div', 'maptalks-zoom');\n\n        if (options['zoomLevel']) {\n            const levelDOM = createEl('span', 'maptalks-zoom-zoomlevel');\n            dom.appendChild(levelDOM);\n            this._levelDOM = levelDOM;\n        }\n\n        const zoomDOM = createEl('div', 'maptalks-zoom-slider');\n\n        const zoomInButton = createEl('a', 'maptalks-zoom-zoomin');\n        zoomInButton.href = 'javascript:;';\n        zoomInButton.innerHTML = '+';\n        zoomDOM.appendChild(zoomInButton);\n        this._zoomInButton = zoomInButton;\n\n        if (options['slider']) {\n            const box = createEl('div', 'maptalks-zoom-slider-box');\n            const ruler = createEl('div', 'maptalks-zoom-slider-ruler');\n            const reading = createEl('span', 'maptalks-zoom-slider-reading');\n            const dot = createEl('span', 'maptalks-zoom-slider-dot');\n            ruler.appendChild(reading);\n            box.appendChild(ruler);\n            box.appendChild(dot);\n            zoomDOM.appendChild(box);\n            this._sliderBox = box;\n            this._sliderRuler = ruler;\n            this._sliderReading = reading;\n            this._sliderDot = dot;\n        }\n\n        const zoomOutButton = createEl('a', 'maptalks-zoom-zoomout');\n        zoomOutButton.href = 'javascript:;';\n        zoomOutButton.innerHTML = '-';\n        zoomDOM.appendChild(zoomOutButton);\n        this._zoomOutButton = zoomOutButton;\n\n        dom.appendChild(zoomDOM);\n\n        map.on('_zoomend _zooming _zoomstart _spatialreferencechange', this._update, this);\n\n        this._update();\n        this._registerDomEvents();\n\n        return dom;\n    }\n\n    onRemove() {\n        this.getMap().off('_zoomend _zooming _zoomstart _spatialreferencechange', this._update, this);\n        if (this._zoomInButton) {\n            off(this._zoomInButton, 'click', this._onZoomInClick, this);\n        }\n        if (this._zoomOutButton) {\n            off(this._zoomOutButton, 'click', this._onZoomOutClick, this);\n        }\n        if (this._sliderRuler) {\n            off(this._sliderRuler, 'click', this._onClickRuler, this);\n            this.dotDragger.disable();\n            delete this.dotDragger;\n        }\n    }\n\n    _update() {\n        const map = this.getMap();\n        if (this._sliderBox) {\n            const totalRange = (map.getMaxZoom() - map.getMinZoom()) * UNIT;\n            this._sliderBox.style.height = totalRange + 16 + 'px';\n            this._sliderRuler.style.height = totalRange + 8 + 'px';\n            this._sliderRuler.style.cursor = 'pointer';\n            const zoomRange = (map.getMaxZoom() - map.getZoom()) * UNIT;\n            //this._sliderReading.style.height = (map.getZoom() - map.getMinZoom()) * UNIT + 'px';\n            this._sliderReading.style.height = (map.getZoom() - map.getMinZoom() + 1) * UNIT + 'px';\n            this._sliderDot.style.top = zoomRange + 'px';\n        }\n        this._updateText();\n    }\n\n    _updateText() {\n        if (this._levelDOM) {\n            const map = this.getMap();\n            let zoom = map.getZoom();\n            if (!isInteger(zoom)) {\n                zoom = Math.round(zoom * 10) / 10;\n            }\n            this._levelDOM.innerHTML = zoom;\n        }\n    }\n\n    _registerDomEvents() {\n        if (this._zoomInButton) {\n            on(this._zoomInButton, 'click', this._onZoomInClick, this);\n        }\n        if (this._zoomOutButton) {\n            on(this._zoomOutButton, 'click', this._onZoomOutClick, this);\n        }\n        if (this._sliderRuler) {\n            on(this._sliderRuler, 'click', this._onClickRuler, this);\n            this.dotDragger = new DragHandler(this._sliderDot, {\n                'ignoreMouseleave' : true\n            });\n            this.dotDragger.on('dragstart', this._onDotDragstart, this)\n                .on('dragging dragend', this._onDotDrag, this)\n                .enable();\n        }\n    }\n\n    _onZoomInClick(e) {\n        preventDefault(e);\n        this.getMap().zoomIn();\n    }\n\n    _onZoomOutClick(e) {\n        preventDefault(e);\n        this.getMap().zoomOut();\n    }\n\n    _onClickRuler(e) {\n        preventDefault(e);\n        const map = this.getMap(),\n            point = getEventContainerPoint(e, this._sliderRuler),\n            h = point.y;\n        const maxZoom = map.getMaxZoom(),\n            zoom = Math.floor(maxZoom - h / UNIT);\n        map.setZoom(zoom);\n    }\n\n    _onDotDragstart(e) {\n        preventDefault(e.domEvent);\n        const map = this.getMap(),\n            origin = map.getSize().toPoint()._multi(1 / 2);\n        map.onZoomStart(map.getZoom(), origin);\n    }\n\n    _onDotDrag(e) {\n        preventDefault(e.domEvent);\n        const map = this.getMap(),\n            origin = map.getSize().toPoint()._multi(1 / 2),\n            point = getEventContainerPoint(e.domEvent, this._sliderRuler),\n            maxZoom = map.getMaxZoom(),\n            minZoom = map.getMinZoom();\n        let top = point.y,\n            z = maxZoom - top / UNIT;\n\n        if (maxZoom < z) {\n            z = maxZoom;\n            top = 0;\n        } else if (minZoom > z) {\n            z = minZoom;\n            top = (maxZoom - minZoom) * UNIT;\n        }\n\n        if (e.type === 'dragging') {\n            map.onZooming(z, origin, 1);\n        } else if (e.type === 'dragend') {\n            if (this.options['seamless']) {\n                map.onZoomEnd(z, origin);\n            } else {\n                map.onZoomEnd(Math.round(z), origin);\n            }\n        }\n        this._sliderDot.style.top = top + 'px';\n        //this._sliderReading.style.height = (map.getZoom() - minZoom) * UNIT + 'px';\n        this._sliderReading.style.height = (map.getZoom() - minZoom + 1) * UNIT + 'px';\n        this._updateText();\n    }\n}\n\nZoom.mergeOptions(options);\n\nMap.mergeOptions({\n    'zoomControl': false\n});\n\nMap.addOnLoadHook(function () {\n    if (this.options['zoomControl']) {\n        this.zoomControl = new Zoom(this.options['zoomControl']);\n        this.addControl(this.zoomControl);\n    }\n});\n\nexport default Zoom;\n","import { extend } from '../../../core/util';\n\n/**\n * @classdesc\n * A class internally used by tile layer helps to descibe tile system used by different tile services.<br>\n *\n * @class\n * @category layer\n * @example\n * var ts = new TileSystem([1, -1, -20037508.34, 20037508.34]);\n */\nclass TileSystem {\n\n    /**\n     * Similar with [transformation]{@link Transformation}, it contains 4 numbers: sx, sy, ox, oy.<br>\n     * @see {@link http://wiki.osgeo.org/wiki/Tile_Map_Service_Specification}\n     * @param  {Number} sx the order of X-axis tile index, 1 means right is larger and -1 means the reverse, left is larger;\n     * @param  {Number} sy the order of Y-axis tile index, 1 means top is larger and -1 means the reverse, bottom is larger;\n     * @param  {Number} ox x of the origin point of the world's projected coordinate system\n     * @param  {Number} oy y of the origin point of the world's projected coordinate system\n     */\n    constructor(sx, sy, ox, oy) {\n        if (Array.isArray(sx)) {\n            this.scale = {\n                x: sx[0],\n                y: sx[1]\n            };\n            this.origin = {\n                x: sx[2],\n                y: sx[3]\n            };\n        } else {\n            this.scale = {\n                x: sx,\n                y: sy\n            };\n            this.origin = {\n                x: ox,\n                y: oy\n            };\n        }\n    }\n\n    /**\n     * Get the default tile system's code for the projection.\n     * @param  {Object} projection      - a projection object\n     * @return {String} tile system code\n     */\n    static getDefault(projection) {\n        if (projection['code'].toLowerCase() === 'baidu') {\n            return 'baidu';\n        } else if (projection['code'].toLowerCase() === 'EPSG:4326'.toLowerCase()) {\n            return 'tms-global-geodetic';\n        } else if (projection['code'].toLowerCase() === 'identity') {\n            return [1, -1, 0, 0];\n        } else {\n            return 'web-mercator';\n        }\n    }\n}\n\nconst semiCircum = 6378137 * Math.PI;\n\nextend(TileSystem, /** @lends TileSystem */ {\n    /**\n     * The most common used tile system, used by google maps, bing maps and amap, soso maps in China.\n     * @see {@link https://en.wikipedia.org/wiki/Web_Mercator}\n     * @constant\n     * @static\n     */\n    'web-mercator': new TileSystem([1, -1, -semiCircum, semiCircum]),\n\n    /**\n     * Predefined tile system for TMS tile system, A tile system published by [OSGEO]{@link http://www.osgeo.org/}. <br>\n     * Also used by mapbox's [mbtiles]{@link https://github.com/mapbox/mbtiles-spec} specification.\n     * @see {@link http://wiki.osgeo.org/wiki/Tile_Map_Service_Specification}\n     * @constant\n     * @static\n     */\n    'tms-global-mercator': new TileSystem([1, 1, -semiCircum, -semiCircum]),\n\n    /**\n     * Another tile system published by [OSGEO]{@link http://www.osgeo.org/}, based on EPSG:4326 SRS.\n     * @see {@link http://wiki.osgeo.org/wiki/Tile_Map_Service_Specification#global-geodetic}\n     * @constant\n     * @static\n     */\n    'tms-global-geodetic': new TileSystem([1, 1, -180, -90]),\n\n    /**\n     * Tile system used by [baidu]{@link http://map.baidu.com}\n     * @constant\n     * @static\n     */\n    'baidu': new TileSystem([1, 1, 0, 0])\n});\n\nexport default TileSystem;\n","import { isString } from '../../../core/util';\nimport Coordinate from '../../../geo/Coordinate';\nimport Extent from '../../../geo/Extent';\nimport Transformation from '../../../geo/transformation/Transformation';\nimport TileSystem from './TileSystem';\n\n/**\n * Tile config for tile layers, an utilities class for tile layers to render tiles\n * @class\n * @category layer\n * @private\n */\nclass TileConfig {\n\n    /**\n     * @param {TileSystem} tileSystem  - tileSystem\n     * @param {Extent} fullExtent      - fullExtent of the tile layer\n     * @param {Size} tileSize          - tile size\n     */\n    constructor(tileSystem, fullExtent, tileSize) {\n        this.tileSize = tileSize;\n        this.fullExtent = fullExtent;\n        this.prepareTileInfo(tileSystem, fullExtent);\n        this._xScale = fullExtent['right'] >= fullExtent['left'] ? 1 : -1;\n        this._yScale = fullExtent['top'] >= fullExtent['bottom'] ? 1 : -1;\n    }\n\n    prepareTileInfo(tileSystem, fullExtent) {\n        if (isString(tileSystem)) {\n            tileSystem = TileSystem[tileSystem.toLowerCase()];\n        } else if (Array.isArray(tileSystem)) {\n            tileSystem = new TileSystem(tileSystem);\n        }\n\n        if (!tileSystem) {\n            throw new Error('Invalid TileSystem');\n        }\n        this.tileSystem = tileSystem;\n\n        //自动计算transformation\n        const a = fullExtent['right'] > fullExtent['left'] ? 1 : -1,\n            b = fullExtent['top'] > fullExtent['bottom'] ? -1 : 1,\n            c = tileSystem['origin']['x'],\n            d = tileSystem['origin']['y'];\n        this.transformation = new Transformation([a, b, c, d]);\n    }\n\n    /**\n     * Get index of point's tile\n     * @param  {Point} point - transformed point, this.transformation.transform(pCoord)\n     * @param  {Number} res  - current resolution\n     * @return {Object}       tile index\n     */\n    _getTileNum(point, res) {\n        const tileSystem = this.tileSystem,\n            tileSize = this['tileSize'],\n            delta = 1E-7;\n        const tileX = Math.floor(delta + point.x / (tileSize['width'] * res));\n        const tileY = -Math.floor(delta + point.y / (tileSize['height'] * res));\n\n        return {\n            'x': tileSystem['scale']['x'] * tileX,\n            'y': tileSystem['scale']['y'] * tileY\n        };\n    }\n\n    /**\n     * Get tile index and offset from tile's northwest\n     * @param  {Coordinate} pCoord   - projected coordinate\n     * @param  {Number} res - current resolution\n     * @return {Object}   tile index and offset\n     */\n    getTileIndex(pCoord, res) {\n        const tileSystem = this.tileSystem;\n        // tileSize = this['tileSize'];\n        const point = this.transformation.transform(pCoord, 1);\n        const tileIndex = this._getTileNum(point, res);\n\n        // const tileLeft = tileIndex['x'] * tileSize['width'];\n        // const tileTop = tileIndex['y'] * tileSize['height'];\n\n        // const offsetLeft = point.x / res - tileSystem['scale']['x'] * tileLeft;\n        // const offsetTop = point.y / res + tileSystem['scale']['y'] * tileTop;\n\n        //如果x方向为左大右小\n        if (tileSystem['scale']['x'] < 0) {\n            tileIndex['x'] -= 1;\n        }\n        //如果y方向上大下小\n        if (tileSystem['scale']['y'] > 0) {\n            tileIndex['y'] -= 1;\n        }\n\n        //有可能tileIndex超出世界范围\n        return this.getNeighorTileIndex(tileIndex['x'], tileIndex['y'], 0, 0, res);\n    }\n\n    /**\n     * Get neibor's tile index\n     * @param  {Number} tileX\n     * @param  {Number} tileY\n     * @param  {Number} offsetX\n     * @param  {Number} offsetY\n     * @param  {Number} zoomLevel\n     * @return {Object}  tile's neighbor index\n     */\n    getNeighorTileIndex(tileX, tileY, offsetX, offsetY, res, repeatWorld) {\n        const tileSystem = this.tileSystem;\n        let x = (tileX + tileSystem['scale']['x'] * offsetX);\n        let y = (tileY - tileSystem['scale']['y'] * offsetY);\n        let out = false;\n        const idx = x;\n        const idy = y;\n\n        const ext = this._getTileFullIndex(res);\n        if (repeatWorld) {\n            if (repeatWorld === true || repeatWorld === 'x') {\n                //caculate tile index to request in url in repeated world.\n                if (ext['xmax'] === ext['xmin']) {\n                    x = ext['xmin'];\n                } else if (x < ext['xmin']) {\n                    x = ext['xmax'] - (ext['xmin'] - x) % (ext['xmax'] - ext['xmin']);\n                    if (x === ext['xmax']) {\n                        x = ext['xmin'];\n                    }\n                } else if (x >= ext['xmax']) {\n                    x = ext['xmin'] + (x - ext['xmin']) % (ext['xmax'] - ext['xmin']);\n                }\n            }\n\n            if (repeatWorld === true || repeatWorld === 'y') {\n                if (ext['ymax'] === ext['ymin']) {\n                    y = ext['ymin'];\n                } else if (y >= ext['ymax']) {\n                    y = ext['ymin'] + (y - ext['ymin']) % (ext['ymax'] - ext['ymin']);\n                } else if (y < ext['ymin']) {\n                    y = ext['ymax'] - (ext['ymin'] - y) % (ext['ymax'] - ext['ymin']);\n                    if (y === ext['ymax']) {\n                        y = ext['ymin'];\n                    }\n                }\n            }\n        }\n        if (x < ext['xmin'] || x > ext['xmax'] || y > ext['ymax'] || y < ext['ymin']) {\n            out = true;\n        }\n        return {\n            // tile index to request in url\n            'x': x,\n            'y': y,\n            // real tile index\n            'idx' : idx,\n            'idy' : idy,\n            out\n        };\n    }\n\n    _getTileFullIndex(res) {\n        const ext = this.fullExtent;\n        const transformation = this.transformation;\n        const nwIndex = this._getTileNum(transformation.transform(new Coordinate(ext['left'], ext['top']), 1), res);\n        const seIndex = this._getTileNum(transformation.transform(new Coordinate(ext['right'], ext['bottom']), 1), res);\n\n        const tileSystem = this.tileSystem;\n        //如果x方向为左大右小\n        if (tileSystem['scale']['x'] < 0) {\n            nwIndex.x -= 1;\n            seIndex.x -= 1;\n        }\n        //如果y方向上大下小\n        if (tileSystem['scale']['y'] > 0) {\n            nwIndex.y -= 1;\n            seIndex.y -= 1;\n        }\n        return new Extent(nwIndex, seIndex);\n    }\n\n    /**\n     * Get tile's north west's projected coordinate\n     * @param  {Number} tileX\n     * @param  {Number} tileY\n     * @param  {Number} res\n     * @return {Number[]}\n     */\n    getTilePrjNW(tileX, tileY, res) {\n        const tileSystem = this.tileSystem;\n        const tileSize = this['tileSize'];\n        const y = tileSystem['origin']['y'] + this._yScale * tileSystem['scale']['y'] * (tileY + (tileSystem['scale']['y'] === 1 ? 1 : 0)) * res * tileSize['height'];\n        const x = tileSystem['origin']['x'] + this._xScale * tileSystem['scale']['x'] * (tileX + (tileSystem['scale']['x'] === 1 ? 0 : 1)) * res * tileSize['width'];\n        return new Coordinate(x, y);\n    }\n\n    /**\n     * Get tile's south east's projected coordinate\n     * @param  {Number} tileX\n     * @param  {Number} tileY\n     * @param  {Number} res\n     * @return {Number[]}\n     */\n    getTilePrjSE(tileX, tileY, res) {\n        const tileSystem = this.tileSystem;\n        const tileSize = this['tileSize'];\n        const y = tileSystem['origin']['y'] + this._yScale * tileSystem['scale']['y'] * (tileY + (tileSystem['scale']['y'] === 1 ? 0 : 1)) * res * tileSize['height'];\n        const x = tileSystem['origin']['x'] + this._xScale * tileSystem['scale']['x'] * (tileX + (tileSystem['scale']['x'] === 1 ? 1 : 0)) * res * tileSize['width'];\n        return new Coordinate(x, y);\n    }\n\n    /**\n     * Get tile's projected extent\n     * @param  {Number} tileX\n     * @param  {Number} tileY\n     * @param  {Number} res\n     * @return {Extent}\n     */\n    getTilePrjExtent(tileX, tileY, res) {\n        const nw = this.getTilePrjNW(tileX, tileY, res),\n            se = this.getTilePrjSE(tileX, tileY, res);\n        return new Extent(nw, se);\n    }\n}\n\nexport default TileConfig;\n","import { IS_NODE, isNil, isNumber, isArrayHasData, isFunction, isInteger } from '../../core/util';\nimport Browser from '../../core/Browser';\nimport Size from '../../geo/Size';\nimport Point from '../../geo/Point';\nimport PointExtent from '../../geo/PointExtent';\nimport TileConfig from './tileinfo/TileConfig';\nimport TileSystem from './tileinfo/TileSystem';\nimport Layer from '../Layer';\nimport SpatialReference from '../../map/spatial-reference/SpatialReference';\n\n/**\n * @property {Object}              options                     - TileLayer's options\n * @property {String|Function}     options.urlTemplate         - url templates\n * @property {String[]|Number[]}   [options.subdomains=null]   - subdomains to replace '{s}' in urlTemplate\n * @property {Object}              [options.spatialReference=null] - TileLayer's spatial reference\n * @property {Number[]}            [options.tileSize=[256, 256]] - size of the tile image, [width, height]\n * @property {Number[]|Function}   [options.offset=[0, 0]]       - overall tile offset, [dx, dy], useful for tile sources from difference coordinate systems, e.g. (wgs84 and gcj02)\n * @property {Number[]}            [options.tileSystem=null]     - tile system number arrays\n * @property {Number}              [options.maxAvailableZoom=null] - Maximum zoom level for which tiles are available. Data from tiles at the maxAvailableZoom are used when displaying the map at higher zoom levels.\n * @property {Boolean}             [options.repeatWorld=true]  - tiles will be loaded repeatedly outside the world.\n * @property {Boolean}             [options.background=true]   - whether to draw a background during or after interacting, true by default\n * @property {Number}              [options.backgroundZoomDiff=6] - the zoom diff to find parent tile as background\n * @property {Boolean|Function}    [options.placeholder=false]    - a placeholder image to replace loading tile, can be a function with a parameter of the tile canvas\n * @property {String}              [options.fragmentShader=null]  - custom fragment shader, replace <a href=\"https://github.com/maptalks/maptalks.js/blob/master/src/renderer/layer/tilelayer/TileLayerGLRenderer.js#L8\">the default fragment shader</a>\n * @property {String}              [options.crossOrigin=null]    - tile image's corssOrigin\n * @property {Boolean}             [options.fadeAnimation=true]  - fade animation when loading tiles\n * @property {Boolean}             [options.debug=false]         - if set to true, tiles will have borders and a title of its coordinates.\n * @property {String}              [options.renderer=gl]         - TileLayer's renderer, canvas or gl. gl tiles requires image CORS that canvas doesn't. canvas tiles can't pitch.\n * @property {Number}              [options.maxCacheSize=256]    - maximum number of tiles to cache\n * @property {Boolean}             [options.cascadeTiles=true]      - draw cascaded tiles of different zooms to reduce tiles\n * @property {Number}              [options.minPitchToCascade=35]   - minimum pitch degree to begin tile cascade\n * @property {Number}              [options.zoomOffset=0]           - offset from map's zoom to tile's zoom\n * @property {Number}              [options.tileRetryCount=0]       - retry count of tiles\n * @memberOf TileLayer\n * @instance\n */\nconst options = {\n\n    'urlTemplate': null,\n    'subdomains': null,\n\n    'repeatWorld': true,\n\n    'background' : true,\n    'backgroundZoomDiff' : 6,\n\n    'loadingLimitOnInteracting' : 3,\n\n    'tileRetryCount' : 0,\n\n    'placeholder' : false,\n\n    'crossOrigin': null,\n\n    'tileSize': [256, 256],\n\n    'offset' : [0, 0],\n\n    'tileSystem': null,\n\n    'fadeAnimation' : !IS_NODE,\n\n    'debug': false,\n\n    'spatialReference' : null,\n\n    'maxCacheSize' : 256,\n\n    'renderer' : (() => {\n        return Browser.webgl ? 'gl' : 'canvas';\n    })(),\n\n    'clipByPitch' : true,\n\n    'maxAvailableZoom' : null,\n\n    'cascadeTiles' : true,\n    'minPitchToCascade' : 35,\n\n    'zoomOffset' : 0\n};\n\nconst URL_PATTERN = /\\{ *([\\w_]+) *\\}/g;\n\n// const MAX_VISIBLE_SIZE = 5;\n\nconst TEMP_POINT = new Point(0, 0);\nconst TEMP_POINT0 = new Point(0, 0);\nconst TEMP_POINT1 = new Point(0, 0);\nconst TEMP_POINT2 = new Point(0, 0);\nconst TEMP_POINT3 = new Point(0, 0);\nconst TEMP_POINT_EXTENT = new PointExtent();\n\n/**\n * @classdesc\n * A layer used to display tiled map services, such as [google maps]{@link http://maps.google.com}, [open street maps]{@link http://www.osm.org}\n * @category layer\n * @extends Layer\n * @param {String|Number} id - tile layer's id\n * @param {Object} [options=null] - options defined in [TileLayer]{@link TileLayer#options}\n * @example\n * new TileLayer(\"tile\",{\n        urlTemplate : 'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n        subdomains:['a','b','c']\n    })\n */\nclass TileLayer extends Layer {\n\n    /**\n     * Reproduce a TileLayer from layer's profile JSON.\n     * @param  {Object} layerJSON - layer's profile JSON\n     * @return {TileLayer}\n     * @static\n     * @private\n     * @function\n     */\n    static fromJSON(layerJSON) {\n        if (!layerJSON || layerJSON['type'] !== 'TileLayer') {\n            return null;\n        }\n        return new TileLayer(layerJSON['id'], layerJSON['options']);\n    }\n\n\n    /**\n     * Get tile size of the tile layer\n     * @return {Size}\n     */\n    getTileSize() {\n        let size = this.options['tileSize'];\n        if (isNumber(size)) {\n            size = [size, size];\n        }\n        return new Size(size);\n    }\n\n    /**\n     * Get tiles at zoom z (or current zoom)\n     * @param {Number} z - zoom\n     * @return {Object[]} tile descriptors\n     */\n    getTiles(z, parentLayer) {\n        const map = this.getMap();\n        const parentRenderer = parentLayer && parentLayer.getRenderer();\n        const mapExtent = map.getContainerExtent();\n        const tileGrids = [];\n        let count = 0;\n        const minZoom = this.getMinZoom();\n        const minPitchToCascade = this.options['minPitchToCascade'];\n        const tileZoom = isNil(z) ? this._getTileZoom(map.getZoom()) : z;\n        if (\n            !isNil(z) ||\n            !this.options['cascadeTiles'] ||\n            map.getPitch() <= minPitchToCascade ||\n            !isNil(minZoom) && tileZoom <= minZoom\n        ) {\n            const currentTiles = this._getTiles(tileZoom, mapExtent, undefined, parentRenderer);\n            if (currentTiles) {\n                count += currentTiles.tiles.length;\n                tileGrids.push(currentTiles);\n            }\n            return {\n                tileGrids, count\n            };\n        }\n\n        const visualHeight = Math.floor(map._getVisualHeight(minPitchToCascade));\n        const extent0 = new PointExtent(0, map.height - visualHeight, map.width, map.height);\n        const currentTiles = this._getTiles(tileZoom, extent0, 0, parentRenderer);\n        count += currentTiles ? currentTiles.tiles.length : 0;\n\n        const extent1 = new PointExtent(0, mapExtent.ymin, map.width, extent0.ymin);\n        const d = map.getSpatialReference().getZoomDirection();\n        const parentTiles = this._getTiles(tileZoom - d, extent1, 1, parentRenderer);\n        count += parentTiles ? parentTiles.tiles.length : 0;\n\n        tileGrids.push(currentTiles, parentTiles);\n        return {\n            tileGrids, count\n        };\n    }\n\n    /**\n     * Get tile's url\n     * @param {Number} x\n     * @param {Number} y\n     * @param {Number} z\n     * @returns {String} url\n     */\n    getTileUrl(x, y, z) {\n        const urlTemplate = this.options['urlTemplate'];\n        let domain = '';\n        if (this.options['subdomains']) {\n            const subdomains = this.options['subdomains'];\n            if (isArrayHasData(subdomains)) {\n                const length = subdomains.length;\n                let s = (x + y) % length;\n                if (s < 0) {\n                    s = 0;\n                }\n                domain = subdomains[s];\n            }\n        }\n        if (isFunction(urlTemplate)) {\n            return urlTemplate(x, y, z, domain);\n        }\n        const data = {\n            'x': x,\n            'y': y,\n            'z': z,\n            's': domain\n        };\n        return urlTemplate.replace(URL_PATTERN, function (str, key) {\n            let value = data[key];\n\n            if (value === undefined) {\n                throw new Error('No value provided for variable ' + str);\n\n            } else if (typeof value === 'function') {\n                value = value(data);\n            }\n            return value;\n        });\n    }\n\n    /**\n     * Clear the layer\n     * @return {TileLayer} this\n     */\n    clear() {\n        if (this._renderer) {\n            this._renderer.clear();\n        }\n        /**\n         * clear event, fired when tile layer is cleared.\n         *\n         * @event TileLayer#clear\n         * @type {Object}\n         * @property {String} type - clear\n         * @property {TileLayer} target - tile layer\n         */\n        this.fire('clear');\n        return this;\n    }\n\n    /**\n     * Export the tile layer's profile json. <br>\n     * Layer's profile is a snapshot of the layer in JSON format. <br>\n     * It can be used to reproduce the instance by [fromJSON]{@link Layer#fromJSON} method\n     * @return {Object} layer's profile JSON\n     */\n    toJSON() {\n        const profile = {\n            'type': this.getJSONType(),\n            'id': this.getId(),\n            'options': this.config()\n        };\n        return profile;\n    }\n\n    /**\n     * Get tilelayer's spatial reference.\n     * @returns {SpatialReference} spatial reference\n     */\n    getSpatialReference() {\n        const map = this.getMap();\n        if  (map && (!this.options['spatialReference'] || SpatialReference.equals(this.options['spatialReference'], map.options['spatialReference']))) {\n            return map.getSpatialReference();\n        }\n        this._sr = this._sr || new SpatialReference(this.options['spatialReference']);\n        return this._sr;\n    }\n\n    _getTileZoom(zoom) {\n        if (!isInteger(zoom)) {\n            zoom = Math.round(zoom);\n        }\n        const maxZoom = this.options['maxAvailableZoom'];\n        if (!isNil(maxZoom) && zoom > maxZoom) {\n            zoom = maxZoom;\n        }\n        return zoom;\n    }\n\n    _getTiles(z, containerExtent, maskID, parentRenderer) {\n        // rendWhenReady = false;\n        const map = this.getMap();\n        const zoom = z + this.options['zoomOffset'];\n        const offset = this._getTileOffset(zoom),\n            hasOffset = offset[0] || offset[1];\n        const emptyGrid = {\n            'zoom' : z,\n            'extent' : null,\n            'offset' : offset,\n            'tiles' : []\n        };\n        if (zoom < 0) {\n            return emptyGrid;\n        }\n        const minZoom = this.getMinZoom(),\n            maxZoom = this.getMaxZoom();\n        if (!map || !this.isVisible() || !map.width || !map.height) {\n            return emptyGrid;\n        }\n        if (!isNil(minZoom) && z < minZoom ||\n            !isNil(maxZoom) && z > maxZoom) {\n            return emptyGrid;\n        }\n        const tileConfig = this._getTileConfig();\n        if (!tileConfig) {\n            return emptyGrid;\n        }\n\n        const sr = this.getSpatialReference(),\n            mapSR = map.getSpatialReference(),\n            res = sr.getResolution(zoom);\n\n        const extent2d = containerExtent.convertTo(c => map._containerPointToPoint(c, undefined, TEMP_POINT));\n        const innerExtent2D = this._getInnerExtent(z, containerExtent, extent2d)._add(offset);\n        extent2d._add(offset);\n        const offsetExtent2D = extent2d.sub(offset);\n\n        const maskExtent = this._getMask2DExtent();\n        if (maskExtent) {\n            const intersection = maskExtent.intersection(extent2d);\n            if (!intersection) {\n                return emptyGrid;\n            }\n            containerExtent = intersection.convertTo(c => map._pointToContainerPoint(c, undefined, 0, TEMP_POINT));\n        }\n\n        //Get description of center tile including left and top offset\n        const prjCenter = map._containerPointToPrj(containerExtent.getCenter(), TEMP_POINT0);\n        let c;\n        if (hasOffset) {\n            c = this._project(map._pointToPrj(map._prjToPoint(prjCenter, undefined, TEMP_POINT1)._add(offset), undefined, TEMP_POINT1), TEMP_POINT1);\n        } else {\n            c = this._project(prjCenter, TEMP_POINT1);\n        }\n\n        TEMP_POINT2.x = extent2d.xmin;\n        TEMP_POINT2.y = extent2d.ymin;\n        TEMP_POINT3.x = extent2d.xmax;\n        TEMP_POINT3.y = extent2d.ymax;\n        const pmin = this._project(map._pointToPrj(TEMP_POINT2, undefined, TEMP_POINT2), TEMP_POINT2);\n        const pmax = this._project(map._pointToPrj(TEMP_POINT3, undefined, TEMP_POINT3), TEMP_POINT3);\n\n        const centerTile = tileConfig.getTileIndex(c, res);\n        const ltTile = tileConfig.getTileIndex(pmin, res);\n        const rbTile = tileConfig.getTileIndex(pmax, res);\n\n        // Number of tiles around the center tile\n        const top = Math.ceil(Math.abs(centerTile.y - ltTile.y)),\n            left = Math.ceil(Math.abs(centerTile.x - ltTile.x)),\n            bottom = Math.ceil(Math.abs(centerTile.y - rbTile.y)),\n            right = Math.ceil(Math.abs(centerTile.x - rbTile.x));\n        const tileSize = this.getTileSize();\n        const layerId = this.getId(),\n            renderer = this.getRenderer() || parentRenderer,\n            scale = this._getTileConfig().tileSystem.scale;\n        const tiles = [], extent = new PointExtent();\n        for (let i = -top; i <= bottom; i++) {\n            let j = -left;\n            let leftVisitEnd = -Infinity;\n            let rightVisitEnd = false;\n            while (j >= leftVisitEnd && j <= right) {\n                const idx = tileConfig.getNeighorTileIndex(centerTile['x'], centerTile['y'], j, i, res, sr === mapSR && this.options['repeatWorld']);\n                if (leftVisitEnd === -Infinity) {\n                    //从左往右遍历中\n                    j++;\n                } else {\n                    //从右往左遍历中\n                    j--;\n                }\n                if (idx.out) {\n                    continue;\n                }\n                let hasCachedInfo = false;\n                const tileId = this._getTileId(idx, zoom); //unique id of the tile\n                let tileInfo = renderer && renderer.isTileCachedOrLoading(tileId);\n                if (tileInfo) {\n                    tileInfo = tileInfo.info;\n                    hasCachedInfo = true;\n                }\n                let p;\n                if (tileInfo) {\n                    p = tileInfo.point0;\n                } else {\n                    const pnw = tileConfig.getTilePrjNW(idx.x, idx.y, res);\n                    p = map._prjToPoint(this._unproject(pnw, TEMP_POINT3), z);\n                }\n                let width, height;\n                if (sr === mapSR) {\n                    width = tileSize.width;\n                    height = tileSize.height;\n                } else {\n                    const pse = tileConfig.getTilePrjSE(idx.x, idx.y, res),\n                        pp = map._prjToPoint(this._unproject(pse, TEMP_POINT3), z, TEMP_POINT3)._round();\n                    const point = p._round();\n                    width = Math.abs(pp.x - point.x);\n                    height = Math.abs(pp.y - point.y);\n                }\n                const dx = scale.x * (idx.idx - idx.x) * width,\n                    dy = -scale.y * (idx.idy - idx.y) * height;\n                if (dx || dy) {\n                    p._add(dx, dy);\n                }\n                if (hasOffset) {\n                    p._sub(offset);\n                }\n                if (!tileInfo) {\n                    const tileExtent = new PointExtent(p.x, p.y, p.x + width, p.y + height);\n                    tileInfo = {\n                        //reserve point caculated by tileConfig\n                        //so add offset because we have p._sub(offset) and p._add(dx, dy) if hasOffset\n                        'point0': p.add(offset)._sub(dx, dy),\n                        'point': p,\n                        'z': z,\n                        'x' : idx.x,\n                        'y' : idx.y,\n                        'extent2d' : tileExtent,\n                        'mask' : maskID\n                    };\n                }\n\n                const tileExtent = tileInfo.extent2d;\n                if (rightVisitEnd || innerExtent2D.intersects(tileExtent) ||\n                    !innerExtent2D.equals(offsetExtent2D) && this._isTileInExtent(tileInfo, containerExtent)) {\n                    if (hasOffset) {\n                        tileInfo.point = p._add(offset);\n                        tileInfo.extent2d.set(p.x, p.y, p.x + width, p.y + height);\n                        tileInfo.extent2d = tileExtent._add(offset);\n                    }\n                    if (!hasCachedInfo) {\n                        tileInfo['size'] = [width, height];\n                        const point0 = tileInfo.point0;\n                        tileInfo['dupKey'] = z + ',' + Math.round(point0.x) + ',' + Math.round(point0.y) + ',' + width + ',' + height + ',' + layerId; //duplicate key of the tile\n                        tileInfo['id'] = this._getTileId(idx, zoom); //unique id of the tile\n                        tileInfo['layer'] = layerId;\n                        tileInfo['url'] = this.getTileUrl(idx.x, idx.y, zoom);\n                    }\n                    tiles.push(tileInfo);\n                    extent._combine(tileExtent);\n                    if (leftVisitEnd === -Infinity) {\n                        //从左往右第一次遇到可视的瓦片，改为从右往左遍历\n                        leftVisitEnd = j;\n                        j = right;\n                    } else if (!rightVisitEnd) {\n                        //从右往左第一次遇到可视瓦片，之后的瓦片全部可视\n                        rightVisitEnd = true;\n                    }\n                }\n            }\n        }\n\n        //sort tiles according to tile's distance to center\n        const center = map._containerPointToPoint(containerExtent.getCenter(), z, TEMP_POINT)._add(offset);\n        tiles.sort(function (a, b) {\n            return a.point.distanceTo(center) - b.point.distanceTo(center);\n        });\n\n        return {\n            'offset' : offset,\n            'zoom' : z,\n            'extent' : extent,\n            'tiles': tiles\n        };\n    }\n\n    _getInnerExtent(zoom, containerExtent, extent2d) {\n        const map = this.getMap(),\n            res = map.getResolution(zoom),\n            scale = map.getResolution() / res,\n            center = extent2d.getCenter()._multi(scale),\n            bearing = map.getBearing() * Math.PI / 180,\n            ch = containerExtent.getHeight() / 2 * scale,\n            cw  = containerExtent.getWidth() / 2 * scale,\n            h = Math.abs(Math.cos(bearing) * ch) || ch,\n            w  = Math.abs(Math.sin(bearing) * ch) || cw;\n        return new PointExtent(center.x - w, center.y - h, center.x + w, center.y + h);\n    }\n\n    _getTileOffset(z) {\n        const map = this.getMap();\n        const scale = map._getResolution() / map._getResolution(z);\n        let offset = this.options['offset'];\n        if (isFunction(offset)) {\n            offset = offset(this);\n        }\n        offset[0] *= scale;\n        offset[1] *= scale;\n        return offset;\n    }\n\n    _getTileId(idx, zoom, id) {\n        //id is to mark GroupTileLayer's child layers\n        return `${id || this.getId()}-${idx.idy}-${idx.idx}-${zoom}`;\n    }\n\n\n    _project(pcoord, out) {\n        const map = this.getMap();\n        const sr = this.getSpatialReference();\n        const mapSR = map.getSpatialReference();\n        if (sr !== mapSR) {\n            const mapProjection = map.getProjection();\n            const projection = sr.getProjection();\n            return projection.project(mapProjection.unproject(pcoord, out), out);\n        } else {\n            return pcoord;\n        }\n    }\n\n    _unproject(pcoord, out) {\n        const map = this.getMap();\n        const sr = this.getSpatialReference();\n        const mapSR = map.getSpatialReference();\n        if (sr !== mapSR) {\n            const mapProjection = map.getProjection();\n            const projection = sr.getProjection();\n            return mapProjection.project(projection.unproject(pcoord, out), out);\n        } else {\n            return pcoord;\n        }\n    }\n\n    /**\n     * initialize [tileConfig]{@link TileConfig} for the tilelayer\n     * @private\n     */\n    _initTileConfig() {\n        const map = this.getMap(),\n            tileSize = this.getTileSize();\n        const sr = this.getSpatialReference();\n        const projection = sr.getProjection(),\n            fullExtent = sr.getFullExtent();\n        this._defaultTileConfig = new TileConfig(TileSystem.getDefault(projection), fullExtent, tileSize);\n        if (this.options['tileSystem']) {\n            this._tileConfig = new TileConfig(this.options['tileSystem'], fullExtent, tileSize);\n        }\n        //inherit baselayer's tileconfig\n        if (map && !this._tileConfig &&\n            map.getSpatialReference() === sr &&\n            map.getBaseLayer() &&\n            map.getBaseLayer() !== this &&\n            map.getBaseLayer()._getTileConfig) {\n            const base = map.getBaseLayer()._getTileConfig();\n            this._tileConfig = new TileConfig(base.tileSystem, base.fullExtent, tileSize);\n        }\n    }\n\n    _getTileConfig() {\n        if (!this._defaultTileConfig) {\n            this._initTileConfig();\n        }\n        return this._tileConfig || this._defaultTileConfig;\n    }\n\n    _bindMap(map) {\n        const baseLayer = map.getBaseLayer();\n        if (baseLayer === this) {\n            if (!baseLayer.options.hasOwnProperty('forceRenderOnMoving')) {\n                this.config({\n                    'forceRenderOnMoving': true\n                });\n            }\n        }\n        return super._bindMap.apply(this, arguments);\n    }\n\n    _isTileInExtent(tileInfo, extent) {\n        if (!this._convertPointCallback) {\n            this._convertPointCallback = convertPoint.bind(this);\n        }\n        const tileZoom = tileInfo.z;\n        this._coordTileZoom = tileZoom;\n        const tileExtent = tileInfo.extent2d.convertTo(this._convertPointCallback, TEMP_POINT_EXTENT);\n        // if (tileExtent.getWidth() < MAX_VISIBLE_SIZE || tileExtent.getHeight() < MAX_VISIBLE_SIZE) {\n        //     return false;\n        // }\n        return extent.intersects(tileExtent);\n    }\n\n    getEvents() {\n        return {\n            'spatialreferencechange' : this._onSpatialReferenceChange\n        };\n    }\n\n    _onSpatialReferenceChange() {\n        delete this._tileConfig;\n        delete this._defaultTileConfig;\n        delete this._sr;\n        const renderer = this.getRenderer();\n        if (renderer) {\n            renderer.clear();\n        }\n    }\n}\n\nTileLayer.registerJSONType('TileLayer');\n\nTileLayer.mergeOptions(options);\n\nexport default TileLayer;\n\nfunction convertPoint(c) {\n    return this.getMap()._pointToContainerPoint(c, this._coordTileZoom, 0, TEMP_POINT);\n}\n","import { pushIn } from '../../core/util';\nimport Layer from '../Layer';\nimport TileLayer from './TileLayer';\n\n/**\n * @classdesc\n * A layer used to display a group of tile layers. <br>\n * Its performance is better than add TileLayers seperately and it can help prevent limits of active webgl contexts: <br>\n * \"WARNING: Too many active WebGL contexts. Oldest context will be lost\"\n * @category layer\n * @extends TileLayer\n * @param {String|Number} id - tile layer's id\n * @param {TileLayer[]} layers  - TileLayers to add\n * @param {Object} [options=null] - options defined in [TileLayer]{@link TileLayer#options}\n * @example\n * new GroupTileLayer(\"group-tiles\",[\n    new maptalks.WMSTileLayer('wms', {\n      'urlTemplate' : 'https://demo.boundlessgeo.com/geoserver/ows',\n      'crs' : 'EPSG:3857',\n      'layers' : 'ne:ne',\n      'styles' : '',\n      'version' : '1.3.0',\n      'format': 'image/png',\n      'transparent' : true,\n      'uppercase' : true\n    }),\n    new maptalks.TileLayer('tile2',{\n      urlTemplate: 'http://korona.geog.uni-heidelberg.de/tiles/adminb/x={x}&y={y}&z={z}'\n    })\n  ])\n */\nclass GroupTileLayer extends TileLayer {\n    /**\n     * Reproduce a GroupTileLayer from layer's profile JSON.\n     * @param  {Object} layerJSON - layer's profile JSON\n     * @return {GroupTileLayer}\n     * @static\n     * @private\n     * @function\n     */\n    static fromJSON(layerJSON) {\n        if (!layerJSON || layerJSON['type'] !== 'GroupTileLayer') {\n            return null;\n        }\n        const layers = layerJSON['layers'].map(json => Layer.fromJSON(json));\n        return new GroupTileLayer(layerJSON['id'], layers, layerJSON['options']);\n    }\n\n    /**\n     * @param {String|Number} id    - layer's id\n     * @param {TileLayer[]} layers  - TileLayers to add\n     * @param {Object}  [options=null]          - construct options\n     * @param {*}  [options.*=null]             - options defined in [TileLayer]{@link TileLayer#options}\n     */\n    constructor(id, layers, options) {\n        super(id, options);\n        this.layers = layers || [];\n        this._checkChildren();\n        this.layerMap = {};\n        this._groupChildren = [];\n    }\n\n    /**\n     * Get children TileLayer\n     * @returns {TileLayer[]}\n     */\n    getLayers() {\n        return this.layers;\n    }\n\n    /**\n     * Export the GroupTileLayer's profile json. <br>\n     * Layer's profile is a snapshot of the layer in JSON format. <br>\n     * It can be used to reproduce the instance by [fromJSON]{@link Layer#fromJSON} method\n     * @return {Object} layer's profile JSON\n     */\n    toJSON() {\n        const profile = {\n            'type': this.getJSONType(),\n            'id': this.getId(),\n            'layers' : this.layers.map(layer => layer.toJSON()),\n            'options': this.config()\n        };\n        return profile;\n    }\n\n    /**\n     * Get tiles at zoom (or current zoom)\n     * @param {Number} z\n     * @returns {Object} tiles\n     */\n    getTiles(z) {\n        const layers = this.layers;\n        const tiles = [];\n        let count = 0;\n        for (let i = 0, l = layers.length; i < l; i++) {\n            const layer = layers[i];\n            if (!layer.options['visible']) {\n                continue;\n            }\n            const childGrid = layer.getTiles(z, this);\n            if (!childGrid || childGrid.count === 0) {\n                continue;\n            }\n            count += childGrid.count;\n            pushIn(tiles, childGrid.tileGrids);\n        }\n\n        return {\n            count : count,\n            tileGrids : tiles\n        };\n    }\n\n    onAdd() {\n        const map = this.getMap();\n        this.layers.forEach(layer => {\n            this.layerMap[layer.getId()] = layer;\n            if (layer.getChildLayer) {\n                this._groupChildren.push(layer);\n            }\n            layer._bindMap(map);\n            layer.on('show hide', this._onLayerShowHide, this);\n        });\n        super.onAdd();\n    }\n\n    onRemove() {\n        this.layers.forEach(layer => {\n            layer._doRemove();\n            layer.off('show hide', this._onLayerShowHide, this);\n        });\n        this.layerMap = {};\n        this._groupChildren = [];\n        super.onRemove();\n    }\n\n    getChildLayer(id) {\n        const layer = this.layerMap[id];\n        if (layer) {\n            return layer;\n        }\n        for (let i = 0; i < this._groupChildren.length; i++) {\n            const child = this._groupChildren[i].getChildLayer(id);\n            if (child) {\n                return child;\n            }\n        }\n        return null;\n    }\n\n    _onLayerShowHide() {\n        const renderer = this.getRenderer();\n        if (renderer) {\n            renderer.setToRedraw();\n        }\n    }\n\n    isVisible() {\n        if (!super.isVisible()) {\n            return false;\n        }\n        const children = this.layers;\n        for (let i = 0, l = children.length; i < l; i++) {\n            if (children[i].isVisible()) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    _checkChildren() {\n        const ids = {};\n        this.layers.forEach(layer => {\n            const layerId = layer.getId();\n            if (ids[layerId]) {\n                throw new Error(`Duplicate child layer id (${layerId}) in the GroupTileLayer (${this.getId()})`);\n            } else {\n                ids[layerId] = 1;\n            }\n        });\n    }\n}\n\nGroupTileLayer.registerJSONType('GroupTileLayer');\n\nexport default GroupTileLayer;\n","import { extend } from '../../core/util';\nimport TileLayer from './TileLayer';\n\n/**\n * @property {Object}              options                     - TileLayer's options\n * @property {String}              [options.service=WMS]       - WMS Service\n * @property {String}              options.layers              - Comma-separated list of WMS layers to show.\n * @property {String}              [options.styles='']         - Comma-separated list of WMS styles.\n * @property {String}              [options.format=image/jpeg] - WMS image format (use `'image/png'` for layers with transparency).\n * @property {String}              [options.transparent=false] - Version of the WMS service to use\n * @property {String}              [options.version=1.1.1]     - size of the tile image\n * @property {String}              [options.crs=null]          - Coordinate Reference System to use for the WMS requests, defaults to map CRS. Don't change this if you're not sure what it means.\n * @property {Boolean}             [options.uppercase=false]   - If `true`, WMS request parameter keys will be uppercase.\n * @property {Boolean}             [options.detectRetina=false]   - If `true` and user is on a retina display, it will request four tiles of half the specified size and a bigger zoom level in place of one to utilize the high resolution.\n * @memberOf WMSTileLayer\n * @instance\n */\nconst options = {\n    crs: null,\n    uppercase: false,\n    detectRetina : false\n};\n\nconst defaultWmsParams = {\n    service: 'WMS',\n    request: 'GetMap',\n    layers: '',\n    styles: '',\n    format: 'image/jpeg',\n    transparent: false,\n    version: '1.1.1'\n};\n\n/**\n * @classdesc\n * Used to display [WMS]{https://en.wikipedia.org/wiki/Web_Map_Service} services as tile layers on the map. Extends [TileLayer]{@link TileLayer}.\n * Implemented based on Leaflet's TileLayer.WMS.\n * @category layer\n * @extends TileLayer\n * @param {String|Number} id - tile layer's id\n * @param {Object} [options=null] - options defined in [WMSTileLayer]{@link TileLayer#options}\n * @example\n * var layer = new maptalks.WMSTileLayer('wms', {\n *     'urlTemplate' : 'https://demo.boundlessgeo.com/geoserver/ows',\n *     'crs' : 'EPSG:3857',\n *     'layers' : 'ne:ne',\n *     'styles' : '',\n *     'version' : '1.3.0',\n *     'format': 'image/png',\n *     'transparent' : true,\n *     'uppercase' : true\n * });\n */\nclass WMSTileLayer extends TileLayer {\n\n    constructor(id, options) {\n        super(id);\n        const wmsParams = extend({}, defaultWmsParams);\n        for (const p in options) {\n            if (!(p in this.options)) {\n                wmsParams[p] = options[p];\n            }\n        }\n        this.setOptions(options);\n        this.setZIndex(options.zIndex);\n        const tileSize = this.getTileSize();\n        wmsParams.width = tileSize.width;\n        wmsParams.height = tileSize.height;\n        this.wmsParams = wmsParams;\n        this._wmsVersion = parseFloat(wmsParams.version);\n    }\n\n    onAdd() {\n        const dpr = this.getMap().getDevicePixelRatio();\n        const r = options.detectRetina ? dpr : 1;\n        this.wmsParams.width *= r;\n        this.wmsParams.height *= r;\n        const crs = this.options.crs || this.getMap().getProjection().code;\n        const projectionKey = this._wmsVersion >= 1.3 ? 'crs' : 'srs';\n        this.wmsParams[projectionKey] = crs;\n        super.onAdd();\n    }\n\n    getTileUrl(x, y, z) {\n        const res = this.getSpatialReference().getResolution(z),\n            tileConfig = this._getTileConfig(),\n            tileExtent = tileConfig.getTilePrjExtent(x, y, res);\n        const max = tileExtent.getMax(),\n            min = tileExtent.getMin();\n\n        const bbox = (this._wmsVersion >= 1.3  && this.wmsParams.crs === 'EPSG:4326' ?\n            [min.y, min.x, max.y, max.x] :\n            [min.x, min.y, max.x, max.y]).join(',');\n\n        const url = super.getTileUrl(x, y, z);\n\n        return url +\n            getParamString(this.wmsParams, url, this.options.uppercase) +\n            (this.options.uppercase ? '&BBOX=' : '&bbox=') + bbox;\n    }\n\n    /**\n     * Export the WMSTileLayer's json. <br>\n     * It can be used to reproduce the instance by [fromJSON]{@link Layer#fromJSON} method\n     * @return {Object} layer's JSON\n     */\n    toJSON() {\n        return {\n            'type': 'WMSTileLayer',\n            'id': this.getId(),\n            'options': this.config()\n        };\n    }\n\n    /**\n     * Reproduce a WMSTileLayer from layer's JSON.\n     * @param  {Object} layerJSON - layer's JSON\n     * @return {WMSTileLayer}\n     * @static\n     * @private\n     * @function\n     */\n    static fromJSON(layerJSON) {\n        if (!layerJSON || layerJSON['type'] !== 'WMSTileLayer') {\n            return null;\n        }\n        return new WMSTileLayer(layerJSON['id'], layerJSON['options']);\n    }\n}\n\nWMSTileLayer.registerJSONType('WMSTileLayer');\n\nWMSTileLayer.mergeOptions(options);\n\nexport default WMSTileLayer;\n\n// From Leaflet\n// Converts an object into a parameter URL string, e.g. `{a: \"foo\", b: \"bar\"}`\n// translates to `'?a=foo&b=bar'`. If `existingUrl` is set, the parameters will\n// be appended at the end. If `uppercase` is `true`, the parameter names will\n// be uppercased (e.g. `'?A=foo&B=bar'`)\nexport function getParamString(obj, existingUrl, uppercase) {\n    const params = [];\n    for (const i in obj) {\n        params.push(encodeURIComponent(uppercase ? i.toUpperCase() : i) + '=' + encodeURIComponent(obj[i]));\n    }\n    return ((!existingUrl || existingUrl.indexOf('?') === -1) ? '?' : '&') + params.join('&');\n}\n","import TileLayer from './TileLayer';\n\n/**\n * @classdesc\n * @ignore\n * @category layer\n * @extends TileLayer\n * @param {String|Number} id - tile layer's id\n * @param {Object} [options=null] - options defined in [CanvasTileLayer]{@link TileLayer#options}\n * @example\n * var layer = new CanvasTileLayer(\"tile\");\n * layer.drawTile = ()\n */\nclass CanvasTileLayer extends TileLayer {\n\n    constructor(id, options) {\n        super(id, options);\n        if (!this.options.hasOwnProperty('forceRenderOnMoving')) {\n            // force not to forceRenderOnMoving\n            this.options['forceRenderOnMoving'] = false;\n        }\n    }\n\n    /**\n     * The interface method to draw on canvsa tile\n     * @param  {HTMLCanvasElement} canvas  canvas to draw on\n     * @param  {Object} options current options\n     * @param  {Object} options current options\n     */\n    drawTile(/*canvas, options*/) {\n\n    }\n\n    /**\n     * Export the CanvasTileLayer's json. <br>\n     * It can be used to reproduce the instance by [fromJSON]{@link Layer#fromJSON} method\n     * @return {Object} layer's JSON\n     */\n    toJSON() {\n        return {\n            'type': 'CanvasTileLayer',\n            'id': this.getId(),\n            'options': this.config()\n        };\n    }\n\n    /**\n     * Reproduce a CanvasTileLayer from layer's JSON.\n     * @param  {Object} layerJSON - layer's JSON\n     * @return {CanvasTileLayer}\n     * @static\n     * @private\n     * @function\n     */\n    static fromJSON(layerJSON) {\n        if (!layerJSON || layerJSON['type'] !== 'CanvasTileLayer') {\n            return null;\n        }\n        return new CanvasTileLayer(layerJSON['id'], layerJSON['options']);\n    }\n}\n\nCanvasTileLayer.registerJSONType('CanvasTileLayer');\n\nexport default CanvasTileLayer;\n","\nexport function createGLContext(canvas, options) {\n    const attributes = {\n        'alpha': true,\n        'stencil' : true,\n        'preserveDrawingBuffer' : true,\n        'antialias' : false\n    };\n    const names = ['webgl', 'experimental-webgl'];\n    let context = null;\n    /* eslint-disable no-empty */\n    for (let i = 0; i < names.length; ++i) {\n        try {\n            context = canvas.getContext(names[i], options || attributes);\n        } catch (e) {}\n        if (context) {\n            break;\n        }\n    }\n    return context;\n    /* eslint-enable no-empty */\n}\n\n/**\n* Create a shader object\n* @param gl GL context\n* @param type the type of the shader object to be created\n* @param source shader program (string)\n* @return created shader object, or null if the creation has failed.\n* @private\n*/\nexport function compileShader(gl, type, source) {\n    const shader = gl.createShader(type);\n\n    gl.shaderSource(shader, source);\n    gl.compileShader(shader);\n\n    const compiled = gl.getShaderParameter(shader, gl.COMPILE_STATUS);\n    if (!compiled) {\n        const error = gl.getShaderInfoLog(shader);\n        gl.deleteShader(shader);\n        throw new Error('Failed to compile shader: ' + error);\n    }\n    return shader;\n}\n\n/**\n * Create the linked program object\n * @param {String} vert a vertex shader program (string)\n * @param {String} frag a fragment shader program (string)\n * @return {WebGLProgram} created program object, or null if the creation has failed\n * @private\n */\nexport function createProgram(gl, vert, frag) {\n    const vertexShader = compileShader(gl, gl.VERTEX_SHADER, vert);\n    const fragmentShader = compileShader(gl, gl.FRAGMENT_SHADER, frag);\n    if (!vertexShader || !fragmentShader) {\n        return null;\n    }\n\n    const program = gl.createProgram();\n    if (!program) {\n        return null;\n    }\n\n    gl.attachShader(program, vertexShader);\n    gl.attachShader(program, fragmentShader);\n\n    gl.linkProgram(program);\n    return { program, vertexShader, fragmentShader };\n}\n\n/**\n * Enable vertex attributes\n * @param {Array} attributes [[name, stride, type], [name, stride, type]...]\n * @example\n * rendererr.enableVertexAttrib([\n *  ['a_position', 3, 'FLOAT'],\n *  ['a_normal', 3, 'FLOAT']\n * ]);\n * @private\n */\nexport function enableVertexAttrib(gl, program, attributes) {\n    if (Array.isArray(attributes[0])) {\n        const FSIZE = Float32Array.BYTES_PER_ELEMENT;\n        let STRIDE = 0;\n        for (let i = 0; i < attributes.length; i++) {\n            STRIDE += (attributes[i][1] || 0);\n        }\n        let offset = 0;\n        for (let i = 0; i < attributes.length; i++) {\n            const attr = gl.getAttribLocation(program, attributes[i][0]);\n            if (attr < 0) {\n                throw new Error('Failed to get the storage location of ' + attributes[i][0]);\n            }\n            gl.vertexAttribPointer(attr, attributes[i][1], gl[attributes[i][2] || 'FLOAT'], false, FSIZE * STRIDE, FSIZE * offset);\n            offset += (attributes[i][1] || 0);\n            gl.enableVertexAttribArray(attr);\n        }\n    } else {\n        const attr = gl.getAttribLocation(program, attributes[0]);\n        gl.vertexAttribPointer(attr, attributes[1], gl[attributes[2] || 'FLOAT'], false, 0, 0);\n        gl.enableVertexAttribArray(attr);\n    }\n}\n","import { IS_NODE, extend, isInteger, log2 } from '../../core/util';\nimport { createGLContext, createProgram, enableVertexAttrib } from '../../core/util/gl';\nimport Browser from '../../core/Browser';\nimport * as mat4 from '../../core/util/mat4';\nimport Canvas from '../../core/Canvas';\n\nconst shaders = {\n    'vertexShader': `\n        attribute vec3 a_position;\n\n        attribute vec2 a_texCoord;\n\n        uniform mat4 u_matrix;\n\n        varying vec2 v_texCoord;\n\n        void main() {\n            gl_Position = u_matrix * vec4(a_position, 1.0);\n\n            v_texCoord = a_texCoord;\n        }\n    `,\n    // fragment shader, can be replaced by layer.options.fragmentShader\n    'fragmentShader': `\n        precision mediump float;\n\n        uniform sampler2D u_image;\n\n        uniform float u_opacity;\n\n        varying vec2 v_texCoord;\n\n        void main() {\n\n            gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;\n\n        }\n    `\n};\n\n//reusable temporary variables\nconst v2 = [0, 0],\n    v3 = [0, 0, 0],\n    arr16 = new Array(16);\n\n/**\n * A mixin providing image support in WebGL env\n * @mixin ImageGLRenderable\n * @protected\n */\nconst ImageGLRenderable = Base => {\n    const renderable = class extends Base {\n\n        /**\n         * Draw an image at x, y at map's gl zoom\n         * @param {Image|Canvas} image\n         * @param {Number} x - x at map's gl zoom\n         * @param {Number} y - y at map's gl zoom\n         * @param {Number} w - width at map's gl zoom\n         * @param {Number} h - height at map's gl zoom\n         * @param {Number} opacity\n         */\n        drawGLImage(image, x, y, w, h, opacity) {\n            const gl = this.gl;\n            this.loadTexture(image);\n\n            v3[0] = x || 0;\n            v3[1] = y || 0;\n            const uMatrix = mat4.identity(arr16);\n            mat4.translate(uMatrix, uMatrix, v3);\n            mat4.multiply(uMatrix, this.getMap().projViewMatrix, uMatrix);\n            gl.uniformMatrix4fv(this.program['u_matrix'], false, uMatrix);\n            gl.uniform1f(this.program['u_opacity'], opacity);\n\n            const { glBuffer } = image;\n            if (glBuffer && (glBuffer.width !== w || glBuffer.height !== h)) {\n                this.saveImageBuffer(glBuffer);\n                delete image.glBuffer;\n            }\n            if (!image.glBuffer) {\n                image.glBuffer = this.bufferTileData(0, 0, w, h);\n            } else {\n                gl.bindBuffer(gl.ARRAY_BUFFER, glBuffer);\n            }\n\n            v2[0] = 'a_position';\n            v2[1] = 3;\n            this.enableVertexAttrib(v2); // ['a_position', 3]\n            gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n        }\n\n        bufferTileData(x, y, w, h, buffer) {\n            const x1 = x;\n            const x2 = x + w;\n            const y1 = y;\n            const y2 = y + h;\n            const glBuffer = this.loadImageBuffer(this.set12(\n                x1, y1, 0,\n                x1, y2, 0,\n                x2, y1, 0,\n                x2, y2, 0), buffer);\n            glBuffer.width = w;\n            glBuffer.height = h;\n            return glBuffer;\n        }\n\n        /**\n         * Draw the tile image as tins\n         * @param {HtmlElement} image\n         * @param {Array} vertices  - tin vertices\n         * @param {Array} texCoords - texture coords\n         * @param {Array} indices   - element indexes\n         * @param {number} opacity\n         */\n        drawTinImage(image, vertices, texCoords, indices, opacity) {\n            const gl = this.gl;\n            this.loadTexture(image);\n            gl.uniformMatrix4fv(this.program['u_matrix'], false, this.getMap().projViewMatrix);\n            gl.uniform1f(this.program['u_opacity'], opacity);\n\n            //bufferdata vertices\n            gl.bindBuffer(gl.ARRAY_BUFFER, this.posBuffer);\n            this.enableVertexAttrib(['a_position', 3]);\n            //TODO save buffer to avoid repeatedly bufferData\n            gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertices), gl.DYNAMIC_DRAW);\n\n            //bufferdata tex coords\n            gl.bindBuffer(gl.ARRAY_BUFFER, this.texBuffer);\n            this.enableVertexAttrib(['a_texCoord', 2]);\n            gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(texCoords), gl.DYNAMIC_DRAW);\n\n            //bufferdata indices\n            gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(indices), gl.DYNAMIC_DRAW);\n            //draw\n            gl.drawElements(gl.TRIANGLES, indices.length, gl.UNSIGNED_SHORT, 0);\n        }\n\n        /**\n         * Create another GL canvas to draw gl images\n         * For layer renderer that needs 2 seperate canvases for 2d and gl\n         */\n        createCanvas2() {\n            this.canvas2 = Canvas.createCanvas(this.canvas.width, this.canvas.height);\n        }\n\n        /**\n         * Get webgl context(this.gl). It prefers canvas2, and will change to this.canvas if canvas2 is not created\n         */\n        createGLContext() {\n            if (this.canvas.gl && this.canvas.gl.wrap) {\n                this.gl = this.canvas.gl.wrap();\n            } else {\n                this.gl = createGLContext(this.canvas2 || this.canvas, this.layer.options['glOptions']);\n            }\n            const gl = this.gl;\n            gl.clearColor(0.0, 0.0, 0.0, 0.0);\n\n            gl.disable(gl.DEPTH_TEST);\n            gl.enable(gl.STENCIL_TEST);\n\n            gl.enable(gl.BLEND);\n            gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\n\n            this.program = this.createProgram(shaders['vertexShader'], this.layer.options['fragmentShader'] || shaders['fragmentShader'], ['u_matrix', 'u_image', 'u_opacity']);\n            this.useProgram(this.program);\n\n            // input texture vec data\n            this.texBuffer = this.createBuffer();\n            gl.bindBuffer(gl.ARRAY_BUFFER, this.texBuffer);\n            this.enableVertexAttrib(['a_texCoord', 2]);\n            gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([\n                0.0, 0.0,\n                0.0, 1.0,\n                1.0, 0.0,\n                1.0, 1.0\n            ]), gl.STATIC_DRAW);\n\n            this.enableSampler('u_image');\n\n            // Enable texture unit 0\n            gl.activeTexture(gl['TEXTURE0']);\n\n            gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, true);\n\n            this.posBuffer = this.createBuffer();\n            gl.bindBuffer(gl.ARRAY_BUFFER, this.posBuffer);\n            this.enableVertexAttrib(['a_position', 3]);\n\n            // Enable indices buffer\n            this.indicesBuffer = this.createBuffer();\n            gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.indicesBuffer);\n        }\n\n        /**\n         * Resize GL canvas with renderer's 2D canvas\n         */\n        resizeGLCanvas() {\n            if (this.gl) {\n                this.gl.viewport(0, 0, this.canvas.width, this.canvas.height);\n            }\n            if (!this.canvas2) {\n                return;\n            }\n            if (this.canvas2.width !== this.canvas.width || this.canvas2.height !== this.canvas.height) {\n                this.canvas2.width = this.canvas.width;\n                this.canvas2.height = this.canvas.height;\n            }\n        }\n\n        /**\n         * Clear gl canvas\n         */\n        clearGLCanvas() {\n            if (this.gl) {\n                this.gl.clear(this.gl.COLOR_BUFFER_BIT | this.gl.STENCIL_BUFFER_BIT);\n            }\n        }\n\n        disposeImage(image) {\n            if (!image) {\n                return;\n            }\n            if (image.texture) {\n                this.saveTexture(image.texture);\n            }\n            if (image.glBuffer) {\n                this.saveImageBuffer(image.glBuffer);\n            }\n            delete image.texture;\n            delete image.glBuffer;\n        }\n\n        _createTexture(image) {\n            const gl = this.gl;\n            const texture = this.getTexture() || gl.createTexture();   // Create a texture object\n            // Bind the texture object to the target\n            gl.bindTexture(gl.TEXTURE_2D, texture);\n            // from mapbox-gl-js\n            // gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_NEAREST);\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\n            gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, image);\n\n            if (isInteger(log2(image.width)) && isInteger(log2(image.width))) {\n                gl.generateMipmap(gl.TEXTURE_2D);\n            }\n\n            return texture;\n        }\n\n        /**\n         * Get a texture from cache or create one if cache is empty\n         * @returns {WebGLTexture}\n         */\n        getTexture() {\n            if (!this._textures) {\n                this._textures = [];\n            }\n            const textures = this._textures;\n            return textures && textures.length > 0 ? textures.pop() : null;\n        }\n\n        /**\n         * Save a texture to the cache\n         * @param {WebGLTexture} texture\n         */\n        saveTexture(texture) {\n            this._textures.push(texture);\n        }\n\n        /**\n         * Load image into a text and bind it with WebGLContext\n         * @param {Image|Canvas} image\n         * @returns {WebGLTexture}\n         */\n        loadTexture(image) {\n            const gl = this.gl;\n            let texture = image.texture;   // Create a texture object\n            if (!texture) {\n                texture = this._createTexture(image);\n                image.texture = texture;\n            }\n            gl.bindTexture(gl.TEXTURE_2D, texture);\n            return texture;\n        }\n\n        /**\n         * Get a texture from cache or create one if cache is empty\n         * @returns {WebGLTexture}\n         */\n        getImageBuffer() {\n            if (!this._imageBuffers) {\n                this._imageBuffers = [];\n            }\n            const imageBuffers = this._imageBuffers;\n            return imageBuffers && imageBuffers.length > 0 ? imageBuffers.pop() : null;\n        }\n\n        /**\n         * Save a texture to the cache\n         * @param {WebGLTexture} texture\n         */\n        saveImageBuffer(buffer) {\n            this._imageBuffers.push(buffer);\n        }\n\n        /**\n         * Load image into a text and bind it with WebGLContext\n         * @returns {WebGLTexture}\n         */\n        loadImageBuffer(data, glBuffer) {\n            const gl = this.gl;\n            // Create a buffer object\n            const buffer = glBuffer || this.createImageBuffer();\n            gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n            gl.bufferData(gl.ARRAY_BUFFER, data, gl.STATIC_DRAW);\n            return buffer;\n        }\n\n        createImageBuffer() {\n            return this.getImageBuffer() || this.createBuffer();\n        }\n\n        /**\n         * remove all the resources and remove gl canvas\n         */\n        removeGLCanvas() {\n            // release resources\n            const gl = this.gl;\n            if (!gl) {\n                return;\n            }\n            if (this._buffers) {\n                this._buffers.forEach(function (b) {\n                    gl.deleteBuffer(b);\n                });\n                delete this._buffers;\n            }\n            if (this._textures) {\n                this._textures.forEach(t => gl.deleteTexture(t));\n                delete this._textures;\n            }\n            delete this.posBuffer;\n            const program = gl.program;\n            gl.deleteShader(program.fragmentShader);\n            gl.deleteShader(program.vertexShader);\n            gl.deleteProgram(program);\n            delete this.gl;\n            delete this.canvas2;\n        }\n\n        //----------------------- webgl utils unlike to change ---------------------------------\n\n        /**\n         * Create a WebGL buffer\n         * @returns {WebGLBuffer}\n         */\n        createBuffer() {\n            const gl = this.gl;\n            // Create the buffer object\n            const buffer = gl.createBuffer();\n            if (!buffer) {\n                throw new Error('Failed to create the buffer object');\n            }\n            if (!this._buffers) {\n                this._buffers = [];\n            }\n            this._buffers.push(buffer);\n            return buffer;\n        }\n\n        /**\n         * Enable vertex attributes\n         * @param {Array} attributes [[name, stride, type], [name, stride, type]...]\n         * @example\n         * rendererr.enableVertexAttrib([\n         *  ['a_position', 3, 'FLOAT'],\n         *  ['a_normal', 3, 'FLOAT']\n         * ]);\n         */\n        enableVertexAttrib(attributes) {\n            enableVertexAttrib(this.gl, this.gl.program, attributes);\n        }\n\n        /**\n         * Create the linked program object\n         * @param {String} vert a vertex shader program (string)\n         * @param {String} frag a fragment shader program (string)\n         * @return {WebGLProgram} created program object, or null if the creation has failed\n         */\n        createProgram(vert, frag, uniforms) {\n            const gl = this.gl;\n            const { program, vertexShader, fragmentShader } = createProgram(gl, vert, frag);\n            program.vertexShader = vertexShader;\n            program.fragmentShader = fragmentShader;\n\n            this._initUniforms(program, uniforms);\n            return program;\n        }\n\n        /**\n         * use the given program\n         * @param {WebGLProgram} program\n         */\n        useProgram(program) {\n            const gl = this.gl;\n            gl.useProgram(program);\n            gl.program = program;\n            return this;\n        }\n\n        /**\n         * Enable a sampler, and set texture\n         * @param {WebGLSampler} sampler\n         * @param {ptr} texture id\n         */\n        enableSampler(sampler, texIdx) {\n            const gl = this.gl;\n            const uSampler = this._getUniform(gl.program, sampler);\n            if (!texIdx) {\n                texIdx = 0;\n            }\n            // Set the texture unit to the sampler\n            gl.uniform1i(uSampler, texIdx);\n            return uSampler;\n        }\n\n        _initUniforms(program, uniforms) {\n            for (let i = 0; i < uniforms.length; i++) {\n                let name = uniforms[i];\n                let uniform = uniforms[i];\n                const b = name.indexOf('[');\n                if (b >= 0) {\n                    name = name.substring(0, b);\n                    if (!IS_NODE) {\n                        // In browser, remove [0] from uniforma declaration\n                        uniform = uniform.substring(0, b);\n                    }\n                }\n                program[name] = this._getUniform(program, uniform);\n            }\n        }\n\n        _getUniform(program, uniformName) {\n            const gl = this.gl;\n            const uniform = gl.getUniformLocation(program, uniformName);\n            if (!uniform) {\n                throw new Error('Failed to get the storage location of ' + uniformName);\n            }\n            return uniform;\n        }\n    };\n\n    extend(renderable.prototype, {\n        set12: function () {\n            const out = Browser.ie9 ? null : new Float32Array(12);\n            return function (a0, a1, a2, a3, a4, a5, a6, a7, a8, a9, a10, a11) {\n                out[0] = a0;\n                out[1] = a1;\n                out[2] = a2;\n                out[3] = a3;\n                out[4] = a4;\n                out[5] = a5;\n                out[6] = a6;\n                out[7] = a7;\n                out[8] = a8;\n                out[9] = a9;\n                out[10] = a10;\n                out[11] = a11;\n                return out;\n            };\n        }()\n    });\n\n    return renderable;\n};\n\nexport default ImageGLRenderable;\n","import { extend } from '../core/util';\nimport Browser from '../core/Browser';\nimport ImageGLRenderable from '../renderer/layer/ImageGLRenderable';\nimport CanvasRenderer from '../renderer/layer/CanvasRenderer';\nimport { ResourceCache } from '../renderer/layer/CanvasRenderer';\nimport Extent from '../geo/Extent';\nimport Layer from './Layer';\n\n/**\n * @property {Object}              options                     - ImageLayer's options\n * @property {String}              [options.crossOrigin=null]    - image's corssOrigin\n * @property {String}              [options.renderer=gl]         - ImageLayer's renderer, canvas or gl. gl tiles requires image CORS that canvas doesn't. canvas tiles can't pitch.\n * @memberOf ImageLayer\n * @instance\n */\nconst options = {\n    renderer: Browser.webgl ? 'gl' : 'canvas',\n    crossOrigin: null\n};\n\n/**\n * @classdesc\n * A layer used to display images, you can specify each image's geographic extent and opacity\n * @category layer\n * @extends Layer\n * @param {String|Number} id - tile layer's id\n * @param {Object[]} [images=null] - images\n * @param {Object} [options=null] - options defined in [ImageLayer]{@link ImageLayer#options}\n * @example\n * new ImageLayer(\"images\", [{\n        url : 'http://example.com/foo.png',\n        extent: [xmin, ymin, xmax, ymax],\n        opacity : 1\n    }])\n */\nclass ImageLayer extends Layer {\n\n    constructor(id, images, options) {\n        if (images && !Array.isArray(images) && !images.url) {\n            options = images;\n            images = null;\n        }\n        super(id, options);\n        this._images = images;\n    }\n\n    onAdd() {\n        this._prepareImages(this._images);\n    }\n\n    /**\n     * Set images and redraw\n     * @param {Object[]} images - new images\n     * @return {ImageLayer} this\n     */\n    setImages(images) {\n        this._images = images;\n        this._prepareImages(images);\n        return this;\n    }\n\n    /**\n     * Get images\n     * @return {Object[]}\n     */\n    getImages() {\n        return this._images;\n    }\n\n    _prepareImages(images) {\n        images = images || [];\n        if (!Array.isArray(images)) {\n            images = [images];\n        }\n        const map = this.getMap();\n        this._imageData = images.map(img => {\n            const extent = new Extent(img.extent);\n            return extend({}, img, {\n                extent: extent,\n                extent2d: extent.convertTo(c => map.coordToPoint(c, map.getGLZoom()))\n            });\n        });\n        this._images = images;\n        const renderer = this.getRenderer();\n        if (renderer) {\n            renderer.refreshImages();\n        }\n    }\n}\n\nImageLayer.mergeOptions(options);\n\nconst EMPTY_ARRAY = [];\n\nexport class ImageLayerCanvasRenderer extends CanvasRenderer {\n    isDrawable() {\n        if (this.getMap().getPitch()) {\n            if (console) {\n                console.warn('ImageLayer with canvas renderer can\\'t be pitched, use gl renderer (\\'renderer\\' : \\'gl\\') instead.');\n            }\n            return false;\n        }\n        return true;\n    }\n\n    checkResources() {\n        if (this._imageLoaded) {\n            return EMPTY_ARRAY;\n        }\n        const layer = this.layer;\n        let urls = layer._imageData.map(img => [img.url, null, null]);\n        if (this.resources) {\n            const unloaded = [];\n            const resources = new ResourceCache();\n            urls.forEach(url => {\n                if (this.resources.isResourceLoaded(url)) {\n                    const img = this.resources.getImage(url);\n                    resources.addResource(url, img);\n                } else {\n                    unloaded.push(url);\n                }\n            });\n            this.resources.forEach((url, res) => {\n                if (!resources.isResourceLoaded(url)) {\n                    this.retireImage(res.image);\n                }\n            });\n            this.resources = resources;\n            urls = unloaded;\n        }\n        this._imageLoaded = true;\n        return urls;\n    }\n\n    retireImage(/* image */) {\n\n    }\n\n    refreshImages() {\n        this._imageLoaded = false;\n        this.setToRedraw();\n    }\n\n    needToRedraw() {\n        const map = this.getMap();\n        // don't redraw when map is zooming without pitch and layer doesn't have any point symbolizer.\n        if (map.isZooming() && !map.getPitch()) {\n            return false;\n        }\n        return super.needToRedraw();\n    }\n\n    draw() {\n        if (!this.isDrawable()) {\n            return;\n        }\n        this.prepareCanvas();\n        this._painted = false;\n        this._drawImages();\n        this.completeRender();\n    }\n\n    _drawImages() {\n        const imgData = this.layer._imageData;\n        const map = this.getMap();\n        const mapExtent = map._get2DExtent(map.getGLZoom());\n        if (imgData && imgData.length) {\n            for (let i = 0; i < imgData.length; i++) {\n                const extent = imgData[i].extent2d;\n                const image = this.resources && this.resources.getImage(imgData[i].url);\n                if (image && mapExtent.intersects(extent)) {\n                    this._painted = true;\n                    this._drawImage(image, extent, imgData[i].opacity || 1);\n                }\n            }\n        }\n    }\n\n    _drawImage(image, extent, opacity) {\n        let globalAlpha = 0;\n        const ctx = this.context;\n        if (opacity < 1) {\n            globalAlpha = ctx.globalAlpha;\n            ctx.globalAlpha = opacity;\n        }\n        const map = this.getMap();\n        const min = extent.getMin(),\n            max = extent.getMax();\n        const point = map._pointToContainerPoint(min, map.getGLZoom());\n        let x = point.x, y = point.y;\n        const bearing = map.getBearing();\n        if (bearing) {\n            ctx.save();\n            ctx.translate(x, y);\n            if (bearing) {\n                ctx.rotate(-bearing * Math.PI / 180);\n            }\n            x = y = 0;\n        }\n        const scale = map.getGLScale();\n        ctx.drawImage(image, x, y, (max.x - min.x) / scale, (max.y - min.y) / scale);\n        if (bearing) {\n            ctx.restore();\n        }\n        if (globalAlpha) {\n            ctx.globalAlpha = globalAlpha;\n        }\n    }\n\n    drawOnInteracting() {\n        this.draw();\n    }\n}\n\nexport class ImageLayerGLRenderer extends ImageGLRenderable(ImageLayerCanvasRenderer) {\n\n    //override to set to always drawable\n    isDrawable() {\n        return true;\n    }\n\n    _drawImage(image, extent, opacity) {\n        this.drawGLImage(image, extent.xmin, extent.ymin, extent.getWidth(), extent.getHeight(), opacity);\n    }\n\n    createContext() {\n        this.createGLContext();\n    }\n\n    resizeCanvas(canvasSize) {\n        if (!this.canvas) {\n            return;\n        }\n        super.resizeCanvas(canvasSize);\n        this.resizeGLCanvas();\n    }\n\n    clearCanvas() {\n        if (!this.canvas) {\n            return;\n        }\n        super.clearCanvas();\n        this.clearGLCanvas();\n    }\n\n    retireImage(image) {\n        this.disposeImage(image);\n    }\n\n    onRemove() {\n        this.removeGLCanvas();\n        super.onRemove();\n    }\n}\n\nImageLayer.registerRenderer('canvas', ImageLayerCanvasRenderer);\nImageLayer.registerRenderer('gl', ImageLayerGLRenderer);\n\nexport default ImageLayer;\n","import Canvas from '../../../core/Canvas';\nimport CanvasRenderer from '../../../renderer/layer/CanvasRenderer';\n\nexport default class CanvasLayerRenderer extends CanvasRenderer {\n\n    getPrepareParams() {\n        return [];\n    }\n\n    getDrawParams() {\n        return [];\n    }\n\n    onCanvasCreate() {\n        if (this.canvas && this.layer.options['doubleBuffer']) {\n            this.buffer = Canvas.createCanvas(this.canvas.width, this.canvas.height, this.getMap().CanvasClass);\n        }\n    }\n\n    needToRedraw() {\n        if (this.layer.options['animation']) {\n            return true;\n        }\n        const map = this.getMap();\n        if (map.isInteracting() && !this.layer.drawOnInteracting) {\n            return false;\n        }\n        return super.needToRedraw();\n    }\n\n    draw() {\n        this.prepareCanvas();\n        this.prepareDrawContext();\n        this._drawLayer();\n    }\n\n    drawOnInteracting() {\n        this._drawLayerOnInteracting();\n    }\n\n    getCanvasImage() {\n        const canvasImg = super.getCanvasImage();\n        if (canvasImg && canvasImg.image && this.layer.options['doubleBuffer']) {\n            const canvas = canvasImg.image;\n            if (this.buffer.width !== canvas.width || this.buffer.height !== canvas.height) {\n                this.buffer.width = canvas.width;\n                this.buffer.height = canvas.height;\n            }\n            const bufferContext = this.buffer.getContext('2d');\n            const prevent = this.layer.doubleBuffer(bufferContext, this.context);\n            if (prevent === undefined || prevent) {\n                Canvas.image(bufferContext, canvas, 0, 0);\n                canvasImg.image = this.buffer;\n            }\n        }\n        return canvasImg;\n    }\n\n    remove() {\n        delete this._drawContext;\n        return super.remove();\n    }\n\n\n    onZoomStart(param) {\n        this.layer.onZoomStart(param);\n        super.onZoomStart(param);\n    }\n\n    onZooming(param) {\n        this.layer.onZooming(param);\n        super.onZooming(param);\n    }\n\n    onZoomEnd(param) {\n        this.layer.onZoomEnd(param);\n        super.onZoomEnd(param);\n    }\n\n    onMoveStart(param) {\n        this.layer.onMoveStart(param);\n        super.onMoveStart(param);\n    }\n\n    onMoving(param) {\n        this.layer.onMoving(param);\n        super.onMoving(param);\n    }\n\n    onMoveEnd(param) {\n        this.layer.onMoveEnd(param);\n        super.onMoveEnd(param);\n    }\n\n    onResize(param) {\n        this.layer.onResize(param);\n        super.onResize(param);\n    }\n\n    prepareDrawContext() {\n        if (!this._predrawed) {\n            const params = ensureParams(this.getPrepareParams());\n            this._drawContext = this.layer.prepareToDraw.apply(this.layer, [this.context].concat(params));\n            if (!this._drawContext) {\n                this._drawContext = [];\n            }\n            if (!Array.isArray(this._drawContext)) {\n                this._drawContext = [this._drawContext];\n            }\n            this._predrawed = true;\n        }\n    }\n\n    _prepareDrawParams() {\n        if (!this.getMap()) {\n            return null;\n        }\n        const view = this.getViewExtent();\n        if (view['maskExtent'] && !view['extent'].intersects(view['maskExtent'])) {\n            this.completeRender();\n            return null;\n        }\n        const args = [this.context, view];\n        const params = ensureParams(this.getDrawParams());\n        args.push.apply(args, params);\n        args.push.apply(args, this._drawContext);\n        return args;\n    }\n\n    _drawLayer() {\n        const args = this._prepareDrawParams();\n        if (!args) {\n            return;\n        }\n        this.layer.draw.apply(this.layer, args);\n        this.completeRender();\n    }\n\n    _drawLayerOnInteracting() {\n        if (!this.layer.drawOnInteracting) {\n            return;\n        }\n        const args = this._prepareDrawParams();\n        if (!args) {\n            return;\n        }\n        this.layer.drawOnInteracting.apply(this.layer, args);\n        this.completeRender();\n    }\n}\n\nfunction ensureParams(params) {\n    if (!params) {\n        params = [];\n    }\n    if (!Array.isArray(params)) {\n        params = [params];\n    }\n    return params;\n}\n","import CanvasLayerRenderer from '../renderer/layer/canvaslayer/CanvasLayerRenderer';\nimport Layer from './Layer';\n\n/**\n * @property {Object} options                  - configuration options\n * @property {Boolean} [options.doubleBuffer=false]    - layer is rendered with doubleBuffer\n * @property {Boolean} [options.animation=false]       - if the layer is an animated layer\n * @property {Boolean} [fps=1000 / 16]                 - animation fps\n * @memberOf CanvasLayer\n * @instance\n */\nconst options = {\n    'doubleBuffer'  : false,\n    'animation'     : false\n};\n\n/**\n * A layer with a HTML5 2D canvas context.<br>\n * CanvasLayer provides some interface methods for canvas context operations. <br>\n * You can use it directly, but can't serialize/deserialize a CanvasLayer with JSON in this way. <br>\n * It is more recommended to extend it with a subclass and implement canvas paintings inside the subclass.\n * @example\n *  var layer = new CanvasLayer('canvas');\n *\n *  layer.prepareToDraw = function (context) {\n *      var size = map.getSize();\n *      return [size.width, size.height]\n *  };\n *\n *  layer.draw = function (context, width, height) {\n *      context.fillStyle = \"#f00\";\n *      context.fillRect(0, 0, w, h);\n *  };\n *  layer.addTo(map);\n * @category layer\n * @extends Layer\n * @param {String|Number} id - layer's id\n * @param {Object} options - options defined in [options]{@link CanvasLayer#options}\n */\nclass CanvasLayer extends Layer {\n\n    isCanvasRender() {\n        return true;\n    }\n\n    /**\n     * An optional interface function called only once before the first draw, useful for preparing your canvas operations.\n     * @param  {CanvasRenderingContext2D } context - CanvasRenderingContext2D of the layer canvas.\n     * @return {Object[]} objects that will be passed to function draw(context, ..) as parameters.\n     */\n    prepareToDraw() {}\n\n    /**\n     * The required interface function to draw things on the layer canvas.\n     * @param  {CanvasRenderingContext2D} context - CanvasRenderingContext2D of the layer canvas.\n     * @param  {*} params.. - parameters returned by function prepareToDraw(context).\n     */\n    draw() {}\n\n    /**\n     * An optional interface function to draw while map is interacting.\n     * By default, it will call draw method instead.\n     * You can override this method if you are clear with what to draw when interacting to improve performance.\n     * @param  {CanvasRenderingContext2D} context - CanvasRenderingContext2D of the layer canvas.\n     * @param  {*} params.. - parameters returned by function prepareToDraw(context).\n     */\n    // drawOnInteracting() {\n    //     return this.draw.apply(this, arguments);\n    // }\n\n    /**\n     * Redraw the layer\n     * @return {CanvasLayer} this\n     */\n    redraw() {\n        if (this._getRenderer()) {\n            this._getRenderer().setToRedraw();\n        }\n        return this;\n    }\n\n    /**\n     * Start animation\n     * @return {CanvasLayer} this\n     */\n    play() {\n        this.config('animation', true);\n        return this;\n    }\n\n    /**\n     * Pause the animation\n     * @return {CanvasLayer} this\n     */\n    pause() {\n        this.config('animation', false);\n        return this;\n    }\n\n    /**\n     * If the animation is playing\n     * @return {Boolean}\n     */\n    isPlaying() {\n        return this.options['animation'];\n    }\n\n    /**\n     * Clear layer's canvas\n     * @return {CanvasLayer} this\n     */\n    clearCanvas() {\n        if (this._getRenderer()) {\n            this._getRenderer().clearCanvas();\n        }\n        return this;\n    }\n\n    /**\n     * Ask the map to redraw the layer canvas without firing any event.\n     * @return {CanvasLayer} this\n     */\n    requestMapToRender() {\n        if (this._getRenderer()) {\n            this._getRenderer().requestMapToRender();\n        }\n        return this;\n    }\n\n    /**\n     * Ask the map to redraw the layer canvas and fire layerload event\n     * @return {CanvasLayer} this\n     */\n    completeRender() {\n        if (this._getRenderer()) {\n            this._getRenderer().completeRender();\n        }\n        return this;\n    }\n\n    /**\n     * Callback function when layer's canvas is created. <br>\n     * Override it to do anything needed.\n     */\n    onCanvasCreate() {\n        return this;\n    }\n\n    /**\n     * The event callback for map's zoomstart event.\n     * @param  {Object} param - event parameter\n     */\n    onZoomStart() {}\n\n    /**\n     * The event callback for map's zooming event.\n     * @param  {Object} param - event parameter\n     */\n    onZooming() {}\n\n    /**\n     * The event callback for map's zoomend event.\n     * @param  {Object} param - event parameter\n     */\n    onZoomEnd() {}\n\n    /**\n     * The event callback for map's movestart event.\n     * @param  {Object} param - event parameter\n     */\n    onMoveStart() {}\n\n    /**\n     * The event callback for map's moving event.\n     * @param  {Object} param - event parameter\n     */\n    onMoving() {}\n\n    /**\n     * The event callback for map's moveend event.\n     * @param  {Object} param - event parameter\n     */\n    onMoveEnd() {}\n\n    /**\n     * The event callback for map's resize event.\n     * @param  {Object} param - event parameter\n     */\n    onResize() {}\n\n    /**\n     * The callback function to double buffer. <br>\n     * In default, it just draws and return, and you can override it if you need to process the canvas image before drawn.\n     * @param  {CanvasRenderingContext2D} bufferContext CanvasRenderingContext2D of double buffer of the layer canvas.\n     * @param  {CanvasRenderingContext2D} context CanvasRenderingContext2D of the layer canvas.\n     */\n    doubleBuffer(bufferContext/*, context*/) {\n        bufferContext.clearRect(0, 0, bufferContext.canvas.width, bufferContext.canvas.height);\n        return this;\n    }\n}\n\nCanvasLayer.mergeOptions(options);\n\nCanvasLayer.registerRenderer('canvas', CanvasLayerRenderer);\n\nexport default CanvasLayer;\n","import { now } from '../core/util';\nimport CanvasLayer from './CanvasLayer';\nimport CanvasLayerRenderer from '../renderer/layer/canvaslayer/CanvasLayerRenderer';\nimport Point from '../geo/Point';\n\nconst TEMP_POINT = new Point(0, 0);\n/**\n * @property {Object} options                  - configuration options\n * @property {Boolean} [options.animation=true]       - if the layer is an animated layer\n * @memberOf ParticleLayer\n * @instance\n */\nconst options = {\n    'animation': true\n};\n\n/**\n * @classdesc\n * A layer to draw particles. <br>\n * ParticleLayer provides some interface methods to render particles. <br>\n * You can use it directly, but can't serialize/deserialize a ParticleLayer with JSON in this way. <br>\n * It is more recommended to extend it with a subclass.\n * @example\n * import { ParticleLayer } from 'maptalks';\n * var layer = new ParticleLayer('particle');\n *\n * layer.getParticles = function (t) {\n *     return particles[t];\n * };\n * layer.addTo(map);\n * @category layer\n * @extends CanvasLayer\n * @param {String} id - layer's id\n * @param {Object} [options=null] - options defined in [options]{@link ParticleLayer#options}\n */\nclass ParticleLayer extends CanvasLayer {\n\n    /**\n     * Interface method to get particles's position at time t.\n     * @param  {Number} t - current time in milliseconds\n     */\n    getParticles() {\n    }\n\n    draw(context, view) {\n        const points = this.getParticles(now());\n        if (!points || points.length === 0) {\n            const renderer = this._getRenderer();\n            if (renderer) {\n                this._getRenderer()._shouldClear = true;\n            }\n            return;\n        }\n        const map = this.getMap();\n        let extent = view.extent;\n        if (view.maskExtent) {\n            extent = view.extent.intersection(view.maskExtent);\n        }\n        extent = extent.convertTo(c => map._pointToContainerPoint(c, undefined, 0, TEMP_POINT));\n        const e = 2 * Math.PI;\n        for (let i = 0, l = points.length; i < l; i++) {\n            const pos = points[i].point;\n            if (extent.contains(pos)) {\n                const color = points[i].color || this.options['lineColor'] || '#fff',\n                    r = points[i].r;\n                if (context.fillStyle !== color) {\n                    context.fillStyle = color;\n                }\n                if (r <= 2) {\n                    context.fillRect(pos.x - r / 2, pos.y - r / 2, r, r);\n                } else {\n                    context.beginPath();\n                    context.arc(pos.x, pos.y, r / 2, 0, e);\n                    context.fill();\n                }\n            }\n        }\n        this._fillCanvas(context);\n    }\n\n    _fillCanvas(context) {\n        const g = context.globalCompositeOperation;\n        context.globalCompositeOperation = 'destination-out';\n        const trail = this.options['trail'] || 30;\n        context.fillStyle = 'rgba(0, 0, 0, ' + (1 / trail) + ')';\n        context.fillRect(0, 0, context.canvas.width, context.canvas.height);\n        context.globalCompositeOperation = g;\n    }\n}\n\nParticleLayer.mergeOptions(options);\n\nParticleLayer.registerRenderer('canvas', class extends CanvasLayerRenderer {\n    draw() {\n        if (!this.canvas || !this.layer.options['animation'] || this._shouldClear) {\n            this.prepareCanvas();\n            this._shouldClear = false;\n        }\n        this.prepareDrawContext();\n        this._drawLayer();\n    }\n\n    drawOnInteracting() {\n        this.draw();\n        this._shouldClear = false;\n    }\n\n    onSkipDrawOnInteracting() {\n        this._shouldClear = true;\n    }\n});\n\nexport default ParticleLayer;\n","import { INTERNAL_LAYER_PREFIX } from '../../core/Constants';\nimport { isNil, isNumber, sign, removeFromArray, UID } from '../../core/util';\nimport { lowerSymbolOpacity } from '../../core/util/style';\nimport Class from '../../core/Class';\nimport Eventable from '../../core/Eventable';\nimport Point from '../../geo/Point';\nimport Coordinate from '../../geo/Coordinate';\nimport { Marker, TextBox, LineString, Polygon, Circle, Ellipse, Sector, Rectangle } from '../';\nimport VectorLayer from '../../layer/VectorLayer';\nimport * as Symbolizers from '../../renderer/geometry/symbolizers';\n\nconst EDIT_STAGE_LAYER_PREFIX = INTERNAL_LAYER_PREFIX + '_edit_stage_';\n\nfunction createHandleSymbol(markerType, opacity) {\n    return {\n        'markerType': markerType,\n        'markerFill': '#fff',\n        'markerLineColor': '#000',\n        'markerLineWidth': 2,\n        'markerWidth': 10,\n        'markerHeight': 10,\n        'opacity' : opacity\n    };\n}\n\nconst options = {\n    //fix outline's aspect ratio when resizing\n    'fixAspectRatio' : false,\n    // geometry's symbol when editing\n    'symbol' : null,\n    'removeVertexOn' : 'contextmenu',\n    //symbols of edit handles\n    'centerHandleSymbol' : createHandleSymbol('ellipse', 1),\n    'vertexHandleSymbol' : createHandleSymbol('square', 1),\n    'newVertexHandleSymbol' : createHandleSymbol('square', 0.4)\n};\n\n/**\n * Geometry editor used internally for geometry editing.\n * @category geometry\n * @protected\n * @extends Class\n * @mixes Eventable\n */\nclass GeometryEditor extends Eventable(Class) {\n\n    /**\n     * @param {Geometry} geometry geometry to edit\n     * @param {Object} [opts=null] options\n     * @param {Object} [opts.symbol=null] symbol of being edited.\n     */\n    constructor(geometry, opts) {\n        super(opts);\n        this._geometry = geometry;\n        if (!this._geometry) {\n            return;\n        }\n    }\n\n    /**\n     * Get map\n     * @return {Map} map\n     */\n    getMap() {\n        return this._geometry.getMap();\n    }\n\n    /**\n     * Prepare to edit\n     */\n    prepare() {\n        const map = this.getMap();\n        if (!map) {\n            return;\n        }\n        /**\n         * reserve the original symbol\n         */\n        if (this.options['symbol']) {\n            this._originalSymbol = this._geometry.getSymbol();\n            this._geometry.setSymbol(this.options['symbol']);\n        }\n\n        this._prepareEditStageLayer();\n    }\n\n    _prepareEditStageLayer() {\n        const map = this.getMap();\n        const uid = UID();\n        const stageId = EDIT_STAGE_LAYER_PREFIX + uid,\n            shadowId = EDIT_STAGE_LAYER_PREFIX + uid + '_shadow';\n        this._editStageLayer = map.getLayer(stageId);\n        this._shadowLayer = map.getLayer(shadowId);\n        if (!this._editStageLayer) {\n            this._editStageLayer = new VectorLayer(stageId);\n            map.addLayer(this._editStageLayer);\n        }\n        if (!this._shadowLayer) {\n            this._shadowLayer = new VectorLayer(shadowId);\n            map.addLayer(this._shadowLayer);\n        }\n    }\n\n    /**\n     * Start to edit\n     */\n    start() {\n        if (!this._geometry || !this._geometry.getMap() || this._geometry.editing) {\n            return;\n        }\n        const map = this.getMap();\n        this.editing = true;\n        const geometry = this._geometry;\n        this._geometryDraggble = geometry.options['draggable'];\n        geometry.config('draggable', false);\n        this.prepare();\n        //edits are applied to a shadow of geometry to improve performance.\n        const shadow = geometry.copy();\n        shadow.setSymbol(geometry._getInternalSymbol());\n        //geometry copy没有将event复制到新建的geometry,对于编辑这个功能会存在一些问题\n        //原geometry上可能绑定了其它监听其click/dragging的事件,在编辑时就无法响应了.\n        shadow.copyEventListeners(geometry);\n        if (geometry._getParent()) {\n            shadow.copyEventListeners(geometry._getParent());\n        }\n        //drag shadow by center handle instead.\n        shadow.setId(null).config({\n            'draggable': false\n        });\n\n        this._shadow = shadow;\n\n        this._switchGeometryEvents('on');\n\n        geometry.hide();\n        if (geometry instanceof Marker ||\n            geometry instanceof Circle ||\n            geometry instanceof Rectangle ||\n            geometry instanceof Ellipse) {\n            //ouline has to be added before shadow to let shadow on top of it, otherwise shadow's events will be overrided by outline\n            this._createOrRefreshOutline();\n        }\n        this._shadowLayer.bringToFront().addGeometry(shadow);\n        this._editStageLayer.bringToFront();\n        this._addListener([map, 'zoomstart', () => { this._editStageLayer.hide(); }]);\n        this._addListener([map, 'zoomend', () => {\n            this._editStageLayer.show();\n        }]);\n        if (!(geometry instanceof Marker)) {\n            this._createCenterHandle();\n        } else {\n            shadow.config('draggable', true);\n            shadow.on('dragend', this._onMarkerDragEnd, this);\n        }\n        if (geometry instanceof Marker) {\n            this.createMarkerEditor();\n        } else if (geometry instanceof Circle) {\n            this.createCircleEditor();\n        } else if (geometry instanceof Rectangle) {\n            this.createEllipseOrRectEditor();\n        } else if (geometry instanceof Ellipse) {\n            this.createEllipseOrRectEditor();\n        } else if (geometry instanceof Sector) {\n            // TODO: createSectorEditor\n        } else if ((geometry instanceof Polygon) ||\n            (geometry instanceof LineString)) {\n            this.createPolygonEditor();\n        }\n    }\n\n    /**\n     * Stop editing\n     */\n    stop() {\n        delete this._history;\n        delete this._historyPointer;\n        delete this._editOutline;\n        this._switchGeometryEvents('off');\n        const map = this.getMap();\n        if (!map) {\n            return;\n        }\n        delete this._shadow;\n        this._geometry.config('draggable', this._geometryDraggble);\n        delete this._geometryDraggble;\n        this._geometry.show();\n\n        this._editStageLayer.remove();\n        this._shadowLayer.remove();\n        this._clearAllListeners();\n        this._refreshHooks = [];\n        if (this.options['symbol']) {\n            this._geometry.setSymbol(this._originalSymbol);\n            delete this._originalSymbol;\n        }\n        this.editing = false;\n    }\n\n    /**\n     * Whether the editor is editing\n     * @return {Boolean}\n     */\n    isEditing() {\n        if (isNil(this.editing)) {\n            return false;\n        }\n        return this.editing;\n    }\n\n    _getGeometryEvents() {\n        return {\n            'symbolchange': this._onGeoSymbolChange,\n            'positionchange shapechange' : this._exeAndReset\n        };\n    }\n\n    _switchGeometryEvents(oper) {\n        if (this._geometry) {\n            const events = this._getGeometryEvents();\n            for (const p in events) {\n                this._geometry[oper](p, events[p], this);\n            }\n        }\n    }\n\n    _onGeoSymbolChange(param) {\n        if (this._shadow) {\n            this._shadow.setSymbol(param.target._getInternalSymbol());\n        }\n    }\n\n    _onMarkerDragEnd() {\n        this._update('setCoordinates', this._shadow.getCoordinates().toArray());\n        this._refresh();\n    }\n\n    /**\n     * create rectangle outline of the geometry\n     * @private\n     */\n    _createOrRefreshOutline() {\n        const geometry = this._geometry;\n        let outline = this._editOutline;\n        if (!outline) {\n            outline = geometry.getOutline();\n            this._editStageLayer.addGeometry(outline);\n            this._editOutline = outline;\n            this._addRefreshHook(this._createOrRefreshOutline);\n        } else {\n            outline.remove();\n            this._editOutline = outline = geometry.getOutline();\n            this._editStageLayer.addGeometry(outline);\n        }\n\n        return outline;\n    }\n\n\n    _createCenterHandle() {\n        const center = this._shadow.getCenter();\n        const symbol = this.options['centerHandleSymbol'];\n        let shadow;\n        const handle = this.createHandle(center, {\n            'symbol': symbol,\n            'cursor': 'move',\n            onDown: () => {\n                shadow = this._shadow.copy();\n                const symbol = lowerSymbolOpacity(shadow._getInternalSymbol(), 0.5);\n                shadow.setSymbol(symbol).addTo(this._editStageLayer);\n            },\n            onMove: (v, param) => {\n                const offset = param['coordOffset'];\n                shadow.translate(offset);\n            },\n            onUp: () => {\n                this._update('setCoordinates', Coordinate.toNumberArrays(shadow.getCoordinates()));\n                shadow.remove();\n                this._refresh();\n            }\n        });\n        this._addRefreshHook(() => {\n            const center = this._shadow.getCenter();\n            handle.setCoordinates(center);\n        });\n    }\n\n    _createHandleInstance(coordinate, opts) {\n        const symbol = opts['symbol'];\n        const handle = new Marker(coordinate, {\n            'draggable': true,\n            'dragShadow': false,\n            'dragOnAxis': opts['axis'],\n            'cursor': opts['cursor'],\n            'symbol': symbol\n        });\n        return handle;\n    }\n\n    createHandle(coordinate, opts) {\n        if (!opts) {\n            opts = {};\n        }\n        const map = this.getMap();\n        const handle = this._createHandleInstance(coordinate, opts);\n        const me = this;\n\n        function onHandleDragstart(param) {\n            if (opts.onDown) {\n                /**\n                 * change geometry shape start event, fired when drag to change geometry shape.\n                 *\n                 * @event Geometry#handledragstart\n                 * @type {Object}\n                 * @property {String} type - handledragstart\n                 * @property {Geometry} target - the geometry fires the event\n                 */\n                this._geometry.fire('handledragstart');\n                opts.onDown.call(me, param['viewPoint'], param);\n            }\n            return false;\n        }\n\n        function onHandleDragging(param) {\n            me._hideContext();\n            const viewPoint = map._prjToViewPoint(handle._getPrjCoordinates());\n            if (opts.onMove) {\n                /**\n                 * changing geometry shape event, fired when dragging to change geometry shape.\n                 *\n                 * @event Geometry#handledragging\n                 * @type {Object}\n                 * @property {String} type - handledragging\n                 * @property {Geometry} target - the geometry fires the event\n                 */\n                this._geometry.fire('handledragging');\n                opts.onMove.call(me, viewPoint, param);\n            }\n            return false;\n        }\n\n        function onHandleDragEnd(ev) {\n            if (opts.onUp) {\n                /**\n                 * changed geometry shape event, fired when drag end to change geometry shape.\n                 *\n                 * @event Geometry#handledragend\n                 * @type {Object}\n                 * @property {String} type - handledragend\n                 * @property {Geometry} target - the geometry fires the event\n                 */\n                this._geometry.fire('handledragend');\n                opts.onUp.call(me, ev);\n            }\n            return false;\n        }\n\n        function onHandleRemove() {\n            handle.config('draggable', false);\n            handle.off('dragstart', onHandleDragstart, me);\n            handle.off('dragging', onHandleDragging, me);\n            handle.off('dragend', onHandleDragEnd, me);\n            handle.off('removestart', onHandleRemove, me);\n            delete handle['maptalks--editor-refresh-fn'];\n        }\n\n        handle.on('dragstart', onHandleDragstart, this);\n        handle.on('dragging', onHandleDragging, this);\n        handle.on('dragend', onHandleDragEnd, this);\n        handle.on('removestart', onHandleRemove, this);\n        //拖动移图\n        if (opts.onRefresh) {\n            handle['maptalks--editor-refresh-fn'] = opts.onRefresh;\n        }\n        this._editStageLayer.addGeometry(handle);\n        return handle;\n    }\n\n    /**\n     * create resize handles for geometry that can resize.\n     * @param {Array} blackList handle indexes that doesn't display, to prevent change a geometry's coordinates\n     * @param {fn} onHandleMove callback\n     * @private\n     */\n    _createResizeHandles(blackList, onHandleMove, onHandleUp) {\n        //cursor styles.\n        const cursors = [\n            'nw-resize', 'n-resize', 'ne-resize',\n            'w-resize', 'e-resize',\n            'sw-resize', 's-resize', 'se-resize'\n        ];\n        //defines dragOnAxis of resize handle\n        const axis = [\n            null, 'y', null,\n            'x', 'x',\n            null, 'y', null\n        ];\n        const geometry = this._geometry;\n\n        function getResizeAnchors(ext) {\n            return [\n                ext.getMin(),\n                new Point((ext['xmax'] + ext['xmin']) / 2, ext['ymin']),\n                new Point(ext['xmax'], ext['ymin']),\n                new Point(ext['xmin'], (ext['ymax'] + ext['ymin']) / 2),\n                new Point(ext['xmax'], (ext['ymax'] + ext['ymin']) / 2),\n                new Point(ext['xmin'], ext['ymax']),\n                new Point((ext['xmax'] + ext['xmin']) / 2, ext['ymax']),\n                ext.getMax()\n            ];\n        }\n        if (!blackList) {\n            blackList = [];\n        }\n        const me = this;\n        const resizeHandles = [],\n            anchorIndexes = {},\n            map = this.getMap(),\n            handleSymbol = this.options['vertexHandleSymbol'];\n        const fnLocateHandles = () => {\n            const pExt = geometry._getPainter().get2DExtent(),\n                anchors = getResizeAnchors(pExt);\n            for (let i = 0; i < anchors.length; i++) {\n                //ignore anchors in blacklist\n                if (Array.isArray(blackList)) {\n                    const isBlack = blackList.some(ele => ele === i);\n                    if (isBlack) {\n                        continue;\n                    }\n                }\n                const anchor = anchors[i],\n                    coordinate = map.pointToCoordinate(anchor);\n                if (resizeHandles.length < (anchors.length - blackList.length)) {\n                    const handle = this.createHandle(coordinate, {\n                        'symbol' : handleSymbol,\n                        'cursor': cursors[i],\n                        'axis': axis[i],\n                        onMove: (function (_index) {\n                            return function (handleViewPoint) {\n                                me._updating = true;\n                                onHandleMove(handleViewPoint, _index);\n                                geometry.fire('resizing');\n                            };\n                        })(i),\n                        onUp: () => {\n                            me._updating = false;\n                            onHandleUp();\n                            this._refresh();\n                        }\n                    });\n                    handle.setId(i);\n                    anchorIndexes[i] = resizeHandles.length;\n                    resizeHandles.push(handle);\n                } else {\n                    resizeHandles[anchorIndexes[i]].setCoordinates(coordinate);\n                }\n            }\n\n        };\n\n        fnLocateHandles();\n        //refresh hooks to refresh handles' coordinates\n        this._addRefreshHook(fnLocateHandles);\n        return resizeHandles;\n    }\n\n    /**\n     * Create marker editor\n     * @private\n     */\n    createMarkerEditor() {\n        const geometryToEdit = this._geometry,\n            shadow = this._shadow,\n            map = this.getMap();\n        if (!shadow._canEdit()) {\n            if (console) {\n                console.warn('A marker can\\'t be resized with symbol:', shadow.getSymbol());\n            }\n            return;\n        }\n\n        if (!this._history) {\n            this._recordHistory(getUpdates());\n        }\n        //only image marker and vector marker can be edited now.\n\n        const symbol = shadow._getInternalSymbol();\n        const dxdy = new Point(0, 0);\n        if (isNumber(symbol['markerDx'])) {\n            dxdy.x = symbol['markerDx'];\n        }\n        if (isNumber(symbol['markerDy'])) {\n            dxdy.y = symbol['markerDy'];\n        }\n\n        let blackList = null;\n\n        if (Symbolizers.VectorMarkerSymbolizer.test(symbol)) {\n            if (symbol['markerType'] === 'pin' || symbol['markerType'] === 'pie' || symbol['markerType'] === 'bar') {\n                //as these types of markers' anchor stands on its bottom\n                blackList = [5, 6, 7];\n            }\n        } else if (Symbolizers.ImageMarkerSymbolizer.test(symbol) ||\n            Symbolizers.VectorPathMarkerSymbolizer.test(symbol)) {\n            blackList = [5, 6, 7];\n        }\n\n        //defines what can be resized by the handle\n        //0: resize width; 1: resize height; 2: resize both width and height.\n        const resizeAbilities = [\n            2, 1, 2,\n            0,    0,\n            2, 1, 2\n        ];\n\n        let aspectRatio;\n        if (this.options['fixAspectRatio']) {\n            const size = shadow.getSize();\n            aspectRatio = size.width / size.height;\n        }\n\n        const resizeHandles = this._createResizeHandles(null, (handleViewPoint, i) => {\n            if (blackList && blackList.indexOf(i) >= 0) {\n                //need to change marker's coordinates\n                const newCoordinates = map.viewPointToCoordinate(handleViewPoint.sub(dxdy));\n                const coordinates = shadow.getCoordinates();\n                newCoordinates.x = coordinates.x;\n                shadow.setCoordinates(newCoordinates);\n                this._updateCoordFromShadow(true);\n                // geometryToEdit.setCoordinates(newCoordinates);\n                //coordinates changed, and use mirror handle instead to caculate width and height\n                const mirrorHandle = resizeHandles[resizeHandles.length - 1 - i];\n                const mirrorViewPoint = map.coordToViewPoint(mirrorHandle.getCoordinates());\n                handleViewPoint = mirrorViewPoint;\n            }\n\n            //caculate width and height\n            const viewCenter = map._pointToViewPoint(shadow._getCenter2DPoint()).add(dxdy),\n                symbol = shadow._getInternalSymbol();\n            const wh = handleViewPoint.sub(viewCenter);\n            if (blackList && handleViewPoint.y > viewCenter.y) {\n                wh.y = 0;\n            }\n\n            //if this marker's anchor is on its bottom, height doesn't need to multiply by 2.\n            const r = blackList ? 1 : 2;\n            let width = Math.abs(wh.x) * 2,\n                height = Math.abs(wh.y) * r;\n            if (aspectRatio) {\n                width = Math.max(width, height * aspectRatio);\n                height = width / aspectRatio;\n            }\n            const ability = resizeAbilities[i];\n            if (!(shadow instanceof TextBox)) {\n                if (aspectRatio || ability === 0 || ability === 2) {\n                    symbol['markerWidth'] = width;\n                }\n                if (aspectRatio || ability === 1 || ability === 2) {\n                    symbol['markerHeight'] = height;\n                }\n                shadow.setSymbol(symbol);\n                geometryToEdit.setSymbol(symbol);\n            } else {\n                if (aspectRatio || ability === 0 || ability === 2) {\n                    shadow.setWidth(width);\n                    geometryToEdit.setWidth(width);\n                }\n                if (aspectRatio || ability === 1 || ability === 2) {\n                    shadow.setHeight(height);\n                    geometryToEdit.setHeight(height);\n                }\n            }\n        }, () => {\n            this._update(getUpdates());\n        });\n\n        function getUpdates() {\n            const updates = [\n                ['setCoordinates', shadow.getCoordinates().toArray()]\n            ];\n            if (shadow instanceof TextBox) {\n                updates.push(['setWidth', shadow.getWidth()]);\n                updates.push(['setHeight', shadow.getHeight()]);\n            } else {\n                updates.push(['setSymbol', shadow.getSymbol()]);\n            }\n            return updates;\n        }\n\n        function onZoomEnd() {\n            this._refresh();\n        }\n\n        this._addListener([map, 'zoomend', onZoomEnd]);\n\n    }\n\n    /**\n     * Create circle editor\n     * @private\n     */\n    createCircleEditor() {\n        const circle = this._geometry,\n            shadow = this._shadow;\n        const map = this.getMap();\n\n        if (!this._history) {\n            this._recordHistory([\n                ['setCoordinates', shadow.getCoordinates().toArray()],\n                ['setRadius', shadow.getRadius()]\n            ]);\n        }\n\n        this._createResizeHandles(null, handleViewPoint => {\n            const viewCenter = map._pointToViewPoint(shadow._getCenter2DPoint());\n            const wh = handleViewPoint.sub(viewCenter);\n            const w = Math.abs(wh.x),\n                h = Math.abs(wh.y);\n            let r;\n            if (w > h) {\n                r = map.pixelToDistance(w, 0);\n            } else {\n                r = map.pixelToDistance(0, h);\n            }\n            shadow.setRadius(r);\n            circle.setRadius(r);\n        }, () => {\n            this._update('setRadius', shadow.getRadius());\n        });\n    }\n\n    /**\n     * editor of ellipse or rectangle\n     * @private\n     */\n    createEllipseOrRectEditor() {\n        //defines what can be resized by the handle\n        //0: resize width; 1: resize height; 2: resize both width and height.\n        const resizeAbilities = [\n            2, 1, 2,\n            0, 0,\n            2, 1, 2\n        ];\n        const geometryToEdit = this._geometry,\n            shadow = this._shadow;\n\n        if (!this._history) {\n            this._recordHistory(getUpdates());\n        }\n\n        const map = this.getMap();\n        const isRect = this._geometry instanceof Rectangle;\n        let aspectRatio;\n        if (this.options['fixAspectRatio']) {\n            aspectRatio = geometryToEdit.getWidth() / geometryToEdit.getHeight();\n        }\n        const resizeHandles = this._createResizeHandles(null, (mouseViewPoint, i) => {\n            //ratio of width and height\n            const r = isRect ? 1 : 2;\n            let pointSub, w, h;\n            const targetPoint = mouseViewPoint;\n            const ability = resizeAbilities[i];\n            if (isRect) {\n                const mirror = resizeHandles[7 - i];\n                const mirrorViewPoint = map.coordToViewPoint(mirror.getCoordinates());\n                pointSub = targetPoint.sub(mirrorViewPoint);\n                const absSub = pointSub.abs();\n                w = map.pixelToDistance(absSub.x, 0);\n                h = map.pixelToDistance(0, absSub.y);\n                const size = geometryToEdit.getSize();\n                if (ability === 0) {\n                    // changing width\n                    // -  -  -\n                    // 0     0\n                    // -  -  -\n                    // Rectangle's northwest's y is (y - height / 2)\n                    if (aspectRatio) {\n                        // update rectangle's height with aspect ratio\n                        absSub.y = absSub.x / aspectRatio;\n                        size.height = Math.abs(absSub.y);\n                        h = w / aspectRatio;\n                    }\n                    targetPoint.y = mirrorViewPoint.y - size.height / 2;\n                } else if (ability === 1) {\n                    // changing height\n                    // -  1  -\n                    // |     |\n                    // -  1  -\n                    // Rectangle's northwest's x is (x - width / 2)\n                    if (aspectRatio) {\n                        // update rectangle's width with aspect ratio\n                        absSub.x = absSub.y * aspectRatio;\n                        size.width = Math.abs(absSub.x);\n                        w = h * aspectRatio;\n                    }\n                    targetPoint.x = mirrorViewPoint.x - size.width / 2;\n                } else if (aspectRatio) {\n                    // corner handles, relocate the target point according to aspect ratio.\n                    if (w > h * aspectRatio) {\n                        h = w / aspectRatio;\n                        targetPoint.y = mirrorViewPoint.y + absSub.x * sign(pointSub.y) / aspectRatio;\n                    } else {\n                        w = h * aspectRatio;\n                        targetPoint.x = mirrorViewPoint.x + absSub.y  * sign(pointSub.x) * aspectRatio;\n                    }\n                }\n                //change rectangle's coordinates\n                const newCoordinates = map.viewPointToCoordinate(new Point(Math.min(targetPoint.x, mirrorViewPoint.x), Math.min(targetPoint.y, mirrorViewPoint.y)));\n                shadow.setCoordinates(newCoordinates);\n                this._updateCoordFromShadow(true);\n                // geometryToEdit.setCoordinates(newCoordinates);\n\n            } else {\n                const viewCenter = map.coordToViewPoint(geometryToEdit.getCenter());\n                pointSub = viewCenter.sub(targetPoint)._abs();\n                w = map.pixelToDistance(pointSub.x, 0);\n                h = map.pixelToDistance(0, pointSub.y);\n                if (aspectRatio) {\n                    w = Math.max(w, h * aspectRatio);\n                    h = w / aspectRatio;\n                }\n            }\n\n            if (aspectRatio || ability === 0 || ability === 2) {\n                shadow.setWidth(w * r);\n                geometryToEdit.setWidth(w * r);\n            }\n            if (aspectRatio || ability === 1 || ability === 2) {\n                shadow.setHeight(h * r);\n                geometryToEdit.setHeight(h * r);\n            }\n        }, () => {\n            this._update(getUpdates());\n        });\n\n        function getUpdates() {\n            return [\n                ['setCoordinates', shadow.getCoordinates().toArray()],\n                ['setWidth', shadow.getWidth()],\n                ['setHeight', shadow.getHeight()]\n            ];\n        }\n    }\n\n    /**\n     * Editor for polygon\n     * @private\n     */\n    createPolygonEditor() {\n\n        const map = this.getMap(),\n            shadow = this._shadow,\n            me = this,\n            projection = map.getProjection();\n        if (!this._history) {\n            this._recordHistory('setCoordinates', Coordinate.toNumberArrays(shadow.getCoordinates()));\n        }\n\n        const verticeLimit = shadow instanceof Polygon ? 3 : 2;\n        const propertyOfVertexRefreshFn = 'maptalks--editor-refresh-fn',\n            propertyOfVertexIndex = 'maptalks--editor-vertex-index';\n        const vertexHandles = [],\n            newVertexHandles = [];\n\n        function getVertexCoordinates() {\n            if (shadow instanceof Polygon) {\n                const coordinates = shadow.getCoordinates()[0];\n                return coordinates.slice(0, coordinates.length - 1);\n            } else {\n                return shadow.getCoordinates();\n            }\n\n        }\n\n        function getVertexPrjCoordinates() {\n            return shadow._getPrjCoordinates();\n        }\n\n        function onVertexAddOrRemove() {\n            //restore index property of each handles.\n            for (let i = vertexHandles.length - 1; i >= 0; i--) {\n                vertexHandles[i][propertyOfVertexIndex] = i;\n            }\n            for (let i = newVertexHandles.length - 1; i >= 0; i--) {\n                newVertexHandles[i][propertyOfVertexIndex] = i;\n            }\n            me._updateCoordFromShadow();\n        }\n\n        function removeVertex(param) {\n            const handle = param['target'],\n                index = handle[propertyOfVertexIndex];\n            const prjCoordinates = getVertexPrjCoordinates();\n            if (prjCoordinates.length <= verticeLimit) {\n                return;\n            }\n            prjCoordinates.splice(index, 1);\n            shadow._setPrjCoordinates(prjCoordinates);\n            shadow._updateCache();\n            //remove vertex handle\n            vertexHandles.splice(index, 1)[0].remove();\n            //remove two neighbor \"new vertex\" handles\n            if (index < newVertexHandles.length) {\n                newVertexHandles.splice(index, 1)[0].remove();\n            }\n            let nextIndex;\n            if (index === 0) {\n                nextIndex = newVertexHandles.length - 1;\n            } else {\n                nextIndex = index - 1;\n            }\n            newVertexHandles.splice(nextIndex, 1)[0].remove();\n            //add a new \"new vertex\" handle.\n            newVertexHandles.splice(nextIndex, 0, createNewVertexHandle.call(me, nextIndex));\n            onVertexAddOrRemove();\n            me._refresh();\n        }\n\n        function moveVertexHandle(handleViewPoint, index) {\n            const vertice = getVertexPrjCoordinates();\n            const nVertex = map._viewPointToPrj(handleViewPoint);\n            const pVertex = vertice[index];\n            pVertex.x = nVertex.x;\n            pVertex.y = nVertex.y;\n            shadow._updateCache();\n            shadow.onShapeChanged();\n            me._updateCoordFromShadow(true);\n            let nextIndex;\n            if (index === 0) {\n                nextIndex = newVertexHandles.length - 1;\n            } else {\n                nextIndex = index - 1;\n            }\n            //refresh two neighbor \"new vertex\" handles.\n            if (newVertexHandles[index]) {\n                newVertexHandles[index][propertyOfVertexRefreshFn]();\n            }\n            if (newVertexHandles[nextIndex]) {\n                newVertexHandles[nextIndex][propertyOfVertexRefreshFn]();\n            }\n        }\n\n        function createVertexHandle(index) {\n            let vertex = getVertexCoordinates()[index];\n            const handle = me.createHandle(vertex, {\n                'symbol': me.options['vertexHandleSymbol'],\n                'cursor': 'pointer',\n                'axis': null,\n                onMove: function (handleViewPoint) {\n                    moveVertexHandle(handleViewPoint, handle[propertyOfVertexIndex]);\n                },\n                onRefresh: function () {\n                    vertex = getVertexCoordinates()[handle[propertyOfVertexIndex]];\n                    handle.setCoordinates(vertex);\n                },\n                onUp: function () {\n                    me._refresh();\n                    me._updateCoordFromShadow();\n                },\n                onDown: function (param, e) {\n                    if (e && e.domEvent && e.domEvent.button === 2) {\n                        return;\n                    }\n                }\n            });\n            handle[propertyOfVertexIndex] = index;\n            handle.on(me.options['removeVertexOn'], removeVertex);\n            return handle;\n        }\n\n        function createNewVertexHandle(index) {\n            let vertexCoordinates = getVertexCoordinates();\n            let nextVertex;\n            if (index + 1 >= vertexCoordinates.length) {\n                nextVertex = vertexCoordinates[0];\n            } else {\n                nextVertex = vertexCoordinates[index + 1];\n            }\n            const vertex = vertexCoordinates[index].add(nextVertex).multi(1 / 2);\n            const handle = me.createHandle(vertex, {\n                'symbol': me.options['newVertexHandleSymbol'],\n                'cursor': 'pointer',\n                'axis': null,\n                onDown: function (param, e) {\n                    if (e && e.domEvent && e.domEvent.button === 2) {\n                        return;\n                    }\n                    const prjCoordinates = getVertexPrjCoordinates();\n                    const vertexIndex = handle[propertyOfVertexIndex];\n                    //add a new vertex\n                    const pVertex = projection.project(handle.getCoordinates());\n                    //update shadow's vertice\n                    prjCoordinates.splice(vertexIndex + 1, 0, pVertex);\n                    shadow._setPrjCoordinates(prjCoordinates);\n                    shadow._updateCache();\n\n                    const symbol = handle.getSymbol();\n                    delete symbol['opacity'];\n                    handle.setSymbol(symbol);\n\n                    //add two \"new vertex\" handles\n                    newVertexHandles.splice(vertexIndex, 0, createNewVertexHandle.call(me, vertexIndex), createNewVertexHandle.call(me, vertexIndex + 1));\n\n                },\n                onMove: function (handleViewPoint) {\n                    moveVertexHandle(handleViewPoint, handle[propertyOfVertexIndex] + 1);\n                },\n                onUp: function (e) {\n                    if (e && e.domEvent && e.domEvent.button === 2) {\n                        return;\n                    }\n                    const vertexIndex = handle[propertyOfVertexIndex];\n                    //remove this handle\n                    removeFromArray(handle, newVertexHandles);\n                    handle.remove();\n                    //add a new vertex handle\n                    vertexHandles.splice(vertexIndex + 1, 0, createVertexHandle.call(me, vertexIndex + 1));\n                    onVertexAddOrRemove();\n                    me._updateCoordFromShadow();\n                    me._refresh();\n                },\n                onRefresh: function () {\n                    vertexCoordinates = getVertexCoordinates();\n                    const vertexIndex = handle[propertyOfVertexIndex];\n                    let nextIndex;\n                    if (vertexIndex === vertexCoordinates.length - 1) {\n                        nextIndex = 0;\n                    } else {\n                        nextIndex = vertexIndex + 1;\n                    }\n                    const refreshVertex = vertexCoordinates[vertexIndex].add(vertexCoordinates[nextIndex]).multi(1 / 2);\n                    handle.setCoordinates(refreshVertex);\n                }\n            });\n            handle[propertyOfVertexIndex] = index;\n            return handle;\n        }\n        const vertexCoordinates = getVertexCoordinates();\n        for (let i = 0, len = vertexCoordinates.length; i < len; i++) {\n            vertexHandles.push(createVertexHandle.call(this, i));\n            if (i < len - 1) {\n                newVertexHandles.push(createNewVertexHandle.call(this, i));\n            }\n        }\n        if (shadow instanceof Polygon) {\n            //1 more vertex handle for polygon\n            newVertexHandles.push(createNewVertexHandle.call(this, vertexCoordinates.length - 1));\n        }\n        this._addRefreshHook(() => {\n            for (let i = newVertexHandles.length - 1; i >= 0; i--) {\n                newVertexHandles[i][propertyOfVertexRefreshFn]();\n            }\n            for (let i = vertexHandles.length - 1; i >= 0; i--) {\n                vertexHandles[i][propertyOfVertexRefreshFn]();\n            }\n        });\n    }\n\n    _refresh() {\n        if (this._refreshHooks) {\n            for (let i = this._refreshHooks.length - 1; i >= 0; i--) {\n                this._refreshHooks[i].call(this);\n            }\n        }\n    }\n\n    _hideContext() {\n        if (this._geometry) {\n            this._geometry.closeMenu();\n            this._geometry.closeInfoWindow();\n        }\n    }\n\n    _addListener(listener) {\n        if (!this._eventListeners) {\n            this._eventListeners = [];\n        }\n        this._eventListeners.push(listener);\n        listener[0].on(listener[1], listener[2], this);\n    }\n\n    _clearAllListeners() {\n        if (this._eventListeners && this._eventListeners.length > 0) {\n            for (let i = this._eventListeners.length - 1; i >= 0; i--) {\n                const listener = this._eventListeners[i];\n                listener[0].off(listener[1], listener[2], this);\n            }\n            this._eventListeners = [];\n        }\n    }\n\n    _addRefreshHook(fn) {\n        if (!fn) {\n            return;\n        }\n        if (!this._refreshHooks) {\n            this._refreshHooks = [];\n        }\n        this._refreshHooks.push(fn);\n    }\n\n    _update(method, ...args) {\n        this._exeHistory([method, args]);\n        this._recordHistory(method, ...args);\n    }\n\n    _updateCoordFromShadow(ignoreRecord) {\n        if (!this._shadow) {\n            return;\n        }\n\n        const coords = this._shadow.getCoordinates();\n        const geo = this._geometry;\n        const updating = this._updating;\n        this._updating = true;\n        geo.setCoordinates(coords);\n        if (!ignoreRecord) {\n            this._recordHistory('setCoordinates', Coordinate.toNumberArrays(geo.getCoordinates()));\n        }\n        this._updating = updating;\n    }\n\n    _recordHistory(method, ...args) {\n        if (!this._history) {\n            this._history = [];\n            this._historyPointer = 0;\n        }\n\n        if (this._historyPointer < this._history.length - 1) {\n            // remove old 'next views'\n            this._history.splice(this._historyPointer + 1);\n        }\n        this._history.push([method, args]);\n        this._historyPointer = this._history.length - 1;\n        /**\n         * edit record event, fired when an edit happend and being recorded\n         *\n         * @event Geometry#editrecord\n         * @type {Object}\n         * @property {String} type - editrecord\n         * @property {Geometry} target - the geometry fires the event\n         */\n        this._geometry.fire('editrecord');\n    }\n\n    /**\n     * Get previous map view in view history\n     * @return {Object} map view\n     */\n    undo() {\n        if (!this._history || this._historyPointer === 0) {\n            return this;\n        }\n        const record = this._history[--this._historyPointer];\n        this._exeAndReset(record);\n        return this;\n    }\n\n    /**\n     * Get next view in view history\n     * @return {Object} map view\n     */\n    redo() {\n        if (!this._history || this._historyPointer === this._history.length - 1) {\n            return null;\n        }\n        const record = this._history[++this._historyPointer];\n        this._exeAndReset(record);\n        return this;\n    }\n\n    _exeAndReset(record) {\n        if (this._updating) {\n            return;\n        }\n        this._exeHistory(record);\n        const history = this._history,\n            pointer = this._historyPointer;\n        this.stop();\n        this._history = history;\n        this._historyPointer = pointer;\n        this.start();\n    }\n\n    _exeHistory(record) {\n        if (!Array.isArray(record)) {\n            return;\n        }\n        const updating = this._updating;\n        this._updating = true;\n        const geo = this._geometry;\n        if (Array.isArray(record[0])) {\n            record[0].forEach(o => {\n                const m = o[0],\n                    args = o.slice(1);\n                this._shadow[m].apply(this._shadow, args);\n                geo[m].apply(geo, args);\n            });\n        } else {\n            this._shadow[record[0]].apply(this._shadow, record[1]);\n            geo[record[0]].apply(geo, record[1]);\n        }\n        this._updating = updating;\n    }\n\n}\n\nGeometryEditor.mergeOptions(options);\n\nexport default GeometryEditor;\n","import { on, off, createEl, stopPropagation } from '../../core/util/dom';\nimport { isNil } from '../../core/util';\nimport TextMarker from '../../geometry/TextMarker';\nimport UIMarker from '../../ui/UIMarker';\n\n/**\n * Mixin methods for text editing.\n * @mixin TextEditable\n */\nconst TextEditable = {\n    /**\n     * Start to edit the text, editing will be ended automatically whenever map is clicked.\n     *\n     * @return {TextMarker} this\n     * @fires TextMarker#edittextstart\n     */\n    startEditText() {\n        if (!this.getMap()) {\n            return this;\n        }\n        this.hide();\n        this.endEditText();\n        this._prepareEditor();\n        /**\n         * edittextstart when starting to edit text content\n         * @event TextMarker#edittextstart\n         * @type {Object}\n         * @property {String} type - edittextstart\n         * @property {TextMarker} target - fires the event\n         */\n        this._fireEvent('edittextstart');\n        return this;\n    },\n\n    /**\n     * End text edit.\n     *\n     * @return {TextMarker} this\n     * @fires TextMarker#edittextend\n     */\n    endEditText() {\n        if (this._textEditor) {\n            let html = this._textEditor.innerHTML;\n            html = html.replace(/<p>/ig, '').replace(/<\\/p>/ig, '<br/>');\n            this._textEditor.innerHTML = html;\n            // trim enter chars in the end of text for IE\n            const content = this._textEditor.innerText.replace(/[\\r\\n]+$/gi, '');\n            this.setContent(content);\n            off(this._textEditor, 'mousedown dblclick', stopPropagation);\n            this.getMap().off('mousedown', this.endEditText, this);\n            this._editUIMarker.remove();\n            delete this._editUIMarker;\n            this._textEditor.onkeyup = null;\n            delete this._textEditor;\n            this.show();\n            /**\n             * edittextend when ended editing text content\n             * @event TextMarker#edittextend\n             * @type {Object}\n             * @property {String} type - edittextend\n             * @property {TextMarker} target - textMarker fires the event\n             */\n            this._fireEvent('edittextend');\n        }\n        return this;\n    },\n\n    /**\n     * Whether the text is being edited.\n     *\n     * @return {Boolean}\n     */\n    isEditingText() {\n        if (this._textEditor) {\n            return true;\n        }\n        return false;\n    },\n\n    /**\n     * Get the text editor which is an [ui.UIMarker]{@link ui.UIMarker}\n     * @return {ui.UIMarker} text editor\n     */\n    getTextEditor() {\n        return this._editUIMarker;\n    },\n\n    _prepareEditor() {\n        const map = this.getMap();\n        const editContainer = this._createEditor();\n        this._textEditor = editContainer;\n        map.on('mousedown', this.endEditText, this);\n        const offset = this._getEditorOffset();\n        this._editUIMarker = new UIMarker(this.getCoordinates(), {\n            'animation' : null,\n            'content': editContainer,\n            'dx': offset.dx,\n            'dy': offset.dy\n        }).addTo(map);\n        this._setCursorToLast(this._textEditor);\n    },\n\n    _getEditorOffset() {\n        const symbol = this._getInternalSymbol() || {};\n        let dx = 0,\n            dy = 0;\n        const textAlign = symbol['textHorizontalAlignment'];\n        if (textAlign === 'middle' || isNil(textAlign)) {\n            dx = (symbol['textDx'] || 0) - 2;\n            dy = (symbol['textDy'] || 0) - 2;\n        } else {\n            dx = (symbol['markerDx'] || 0) - 2;\n            dy = (symbol['markerDy'] || 0) - 2;\n        }\n        return {\n            'dx': dx,\n            'dy': dy\n        };\n    },\n\n    _createEditor() {\n        const content = this.getContent();\n        const labelSize = this.getSize(),\n            symbol = this._getInternalSymbol() || {},\n            width = labelSize.width,\n            textColor = symbol['textFill'] || '#000000',\n            textSize = symbol['textSize'] || 12,\n            height = labelSize.height,\n            lineColor = symbol['markerLineColor'] || '#000',\n            fill = symbol['markerFill'] || '#3398CC',\n            spacing = symbol['textLineSpacing'] || 0;\n        const editor = createEl('div');\n        editor.contentEditable = true;\n        editor.style.cssText = `background:${fill}; border:1px solid ${lineColor};\n            color:${textColor};font-size:${textSize}px;width:${width - 2}px;height:${height - 2}px;margin: auto;\n            line-height:${textSize + spacing}px;outline: 0; padding:0; margin:0;word-wrap: break-word;\n            overflow: hidden;-webkit-user-modify: read-write-plaintext-only;`;\n\n        editor.innerText = content;\n        on(editor, 'mousedown dblclick', stopPropagation);\n        editor.onkeyup = function (event) {\n            const h = editor.style.height || 0;\n            if (event.keyCode === 13) {\n                editor.style.height = (parseInt(h) + textSize / 2) + 'px';\n            }\n        };\n        return editor;\n    },\n\n    _setCursorToLast(obj) {\n        let range;\n        if (window.getSelection) {\n            obj.focus();\n            range = window.getSelection();\n            range.selectAllChildren(obj);\n            range.collapseToEnd();\n        } else if (document.selection) {\n            range = document.selection.createRange();\n            range.moveToElementText(obj);\n            range.collapse(false);\n            range.select();\n        }\n    }\n};\n\nTextMarker.include(TextEditable);\n\nexport default TextEditable;\n","import { isFunction } from '../../core/util';\nimport { extendSymbol } from '../../core/util/style';\nimport { Animation } from '../../core/Animation';\nimport Coordinate from '../../geo/Coordinate';\nimport Geometry from '../Geometry';\n\nGeometry.include(/** @lends Geometry.prototype */ {\n    /**\n     * Animate the geometry\n     *\n     * @param  {Object}   styles          - styles to animate\n     * @param  {Object}   [options=null]  - animation options\n     * @param  {NUmber}   [options.duration=1000]      - duration\n     * @param  {Number}   [options.startTime=null]  - time to start animation in ms\n     * @param  {String}   [options.easing=linear]   - animation easing: in, out, inAndOut, linear, upAndDown\n     * @param  {Boolean}  [options.repeat=false]      - repeat animation\n     * @param  {Function} [step=null]  - step function during animation, animation frame as the parameter\n     * @return {animation.Player} animation player\n     * @example\n     * var player = marker.animate({\n     *     'symbol': {\n     *         'markerHeight': 82\n     *      }\n     * }, {\n     *     'duration': 2000\n     * }, function (frame) {\n     *     if (frame.state.playState === 'finished') {\n     *         console.log('animation finished');\n     *     }\n     * });\n     * player.pause();\n     */\n    animate: function (styles, options, step) {\n        if (this._animPlayer) {\n            this._animPlayer.finish();\n        }\n        if (isFunction(options)) {\n            step = options;\n        }\n        if (!options) {\n            options = {};\n        }\n        const map = this.getMap(),\n            projection = this._getProjection(),\n            symbol = this.getSymbol() || {},\n            stylesToAnimate = this._prepareAnimationStyles(styles);\n        let preTranslate;\n\n        const isFocusing = options['focus'];\n        delete this._animationStarted;\n        // geometry.animate can be called without map\n        if (map) {\n            // merge geometry animation framing into map's frame loop\n            const renderer = map._getRenderer();\n            const framer = function (fn) {\n                renderer.callInNextFrame(fn);\n            };\n            options['framer'] = framer;\n        }\n\n        const player = Animation.animate(stylesToAnimate, options, frame => {\n            if (map && map.isRemoved()) {\n                player.finish();\n                return;\n            }\n            if (map && !this._animationStarted && isFocusing) {\n                map.onMoveStart();\n            }\n            const styles = frame.styles;\n            for (const p in styles) {\n                if (p !== 'symbol' && p !== 'translate' && styles.hasOwnProperty(p)) {\n                    const fnName = 'set' + p[0].toUpperCase() + p.slice(1);\n                    this[fnName](styles[p]);\n                }\n            }\n            const translate = styles['translate'];\n            if (translate) {\n                let toTranslate = translate;\n                if (preTranslate) {\n                    toTranslate = translate.sub(preTranslate);\n                }\n                preTranslate = translate;\n                this.translate(toTranslate);\n            }\n            const dSymbol = styles['symbol'];\n            if (dSymbol) {\n                this.setSymbol(extendSymbol(symbol, dSymbol));\n            }\n            if (map && isFocusing) {\n                const pcenter = projection.project(this.getCenter());\n                map._setPrjCenter(pcenter);\n                const e = map._parseEventFromCoord(projection.unproject(pcenter));\n                if (player.playState !== 'running') {\n                    map.onMoveEnd(e);\n                } else {\n                    map.onMoving(e);\n                }\n            }\n            this._fireAnimateEvent(player.playState);\n            if (step) {\n                step(frame);\n            }\n        });\n        this._animPlayer = player;\n        return this._animPlayer.play();\n    },\n    /**\n     * Prepare styles for animation\n     * @return {Object} styles\n     * @private\n     */\n    _prepareAnimationStyles: function (styles) {\n        const symbol = this._getInternalSymbol();\n        const stylesToAnimate = {};\n        for (const p in styles) {\n            if (styles.hasOwnProperty(p)) {\n                const v = styles[p];\n                if (p !== 'translate' && p !== 'symbol') {\n                    //this.getRadius() / this.getWidth(), etc.\n                    const fnName = 'get' + p[0].toUpperCase() + p.substring(1);\n                    const current = this[fnName]();\n                    stylesToAnimate[p] = [current, v];\n                } else if (p === 'symbol') {\n                    let symbolToAnimate;\n                    if (Array.isArray(styles['symbol'])) {\n                        if (!Array.isArray(symbol)) {\n                            throw new Error('geometry\\'symbol isn\\'t a composite symbol, while the symbol in styles is.');\n                        }\n                        symbolToAnimate = [];\n                        const symbolInStyles = styles['symbol'];\n                        for (let i = 0; i < symbolInStyles.length; i++) {\n                            if (!symbolInStyles[i]) {\n                                symbolToAnimate.push(null);\n                                continue;\n                            }\n                            const a = {};\n                            for (const sp in symbolInStyles[i]) {\n                                if (symbolInStyles[i].hasOwnProperty(sp)) {\n                                    a[sp] = [symbol[i][sp], symbolInStyles[i][sp]];\n                                }\n                            }\n                            symbolToAnimate.push(a);\n                        }\n                    } else {\n                        if (Array.isArray(symbol)) {\n                            throw new Error('geometry\\'symbol is a composite symbol, while the symbol in styles isn\\'t.');\n                        }\n                        symbolToAnimate = {};\n                        for (const sp in v) {\n                            if (v.hasOwnProperty(sp)) {\n                                symbolToAnimate[sp] = [symbol[sp], v[sp]];\n                            }\n                        }\n                    }\n                    stylesToAnimate['symbol'] = symbolToAnimate;\n                } else if (p === 'translate') {\n                    stylesToAnimate['translate'] = new Coordinate(v);\n                }\n            }\n        }\n        return stylesToAnimate;\n    },\n\n    _fireAnimateEvent: function (playState) {\n        if (playState === 'finished') {\n            delete this._animationStarted;\n            /**\n             * fired when geometry's animation ended.\n             *\n             * @event Geometry#animateend\n             * @type {Object}\n             * @property {String} type - animateend\n             * @property {Geometry} target - the geometry fires the event\n             */\n            this._fireEvent('animateend');\n        } else if (playState === 'running') {\n            if (this._animationStarted) {\n                /**\n                 * fired when geometry is animating.\n                 *\n                 * @event Geometry#animating\n                 * @type {Object}\n                 * @property {String} type - animating\n                 * @property {Geometry} target - the geometry fires the event\n                 */\n                this._fireEvent('animating');\n            } else {\n                /**\n                 * fired when geometry's animation start.\n                 *\n                 * @event Geometry#animatestart\n                 * @type {Object}\n                 * @property {String} type - animatestart\n                 * @property {Geometry} target - the geometry fires the event\n                 */\n                this._fireEvent('animatestart');\n                this._animationStarted = true;\n            }\n        }\n    }\n});\n","import { INTERNAL_LAYER_PREFIX } from '../../core/Constants';\nimport { lowerSymbolOpacity } from '../../core/util/style';\nimport { on, off } from '../../core/util/dom';\nimport Browser from '../../core/Browser';\nimport Handler from '../../handler/Handler';\nimport Geometry from '../Geometry';\nimport DragHandler from '../../handler/Drag';\nimport VectorLayer from '../../layer/VectorLayer';\nimport { ConnectorLine } from '../ConnectorLine';\nimport { ResourceCache } from '../../renderer/layer/CanvasRenderer';\n\nconst DRAG_STAGE_LAYER_ID = INTERNAL_LAYER_PREFIX + '_drag_stage';\n\nconst EVENTS = Browser.touch ? 'touchstart mousedown' : 'mousedown';\n\n/**\n * Drag handler for geometries.\n * @category handler\n * @extends Handler\n * @ignore\n */\nclass GeometryDragHandler extends Handler  {\n\n    /**\n     * @param  {Geometry} target geometry target to drag\n     */\n    constructor(target) {\n        super(target);\n    }\n\n    addHooks() {\n        this.target.on(EVENTS, this._startDrag, this);\n    }\n\n    removeHooks() {\n        this._endDrag();\n        this.target.off(EVENTS, this._startDrag, this);\n        delete this.container;\n    }\n\n    _prepareDragHandler() {\n        this._dragHandler = new DragHandler(this.container);\n        this._dragHandler.on('dragging', this._dragging, this)\n            .on('mouseup', this._endDrag, this)\n            .enable();\n    }\n\n    _prepareShadow() {\n        const target = this.target;\n        this._prepareDragStageLayer();\n        if (this._shadow) {\n            this._shadow.remove();\n        }\n\n        const shadow = this._shadow = target.copy();\n        this._shadow.setSymbol(target._getInternalSymbol());\n        if (target.options['dragShadow']) {\n            const symbol = lowerSymbolOpacity(shadow._getInternalSymbol(), 0.5);\n            shadow.setSymbol(symbol);\n        }\n        shadow.setId(null);\n        this._prepareShadowConnectors();\n    }\n\n    _prepareShadowConnectors() {\n        //copy connectors\n        const target = this.target;\n        const shadow = this._shadow;\n        const resources = this._dragStageLayer._getRenderer().resources;\n\n        const shadowConnectors = [];\n        if (ConnectorLine._hasConnectors(target)) {\n            const connectors = ConnectorLine._getConnectors(target);\n\n            for (let i = 0, l = connectors.length; i < l; i++) {\n                const targetConn = connectors[i];\n                const connOptions = targetConn.config(),\n                    connSymbol = targetConn._getInternalSymbol();\n                connOptions['symbol'] = lowerSymbolOpacity(connSymbol, 0.5);\n                let conn;\n                if (targetConn.getConnectSource() === target) {\n                    conn = new targetConn.constructor(shadow, targetConn.getConnectTarget(), connOptions);\n                } else {\n                    conn = new targetConn.constructor(targetConn.getConnectSource(), shadow, connOptions);\n                }\n                shadowConnectors.push(conn);\n                if (targetConn.getLayer() && targetConn.getLayer()._getRenderer()) {\n                    resources.merge(targetConn.getLayer()._getRenderer().resources);\n                }\n\n            }\n        }\n        this._shadowConnectors = shadowConnectors;\n        shadowConnectors.push(shadow);\n        this._dragStageLayer.bringToFront().addGeometry(shadowConnectors);\n    }\n\n    _onTargetUpdated() {\n        if (this._shadow) {\n            this._shadow.setSymbol(this.target._getSymbol());\n        }\n    }\n\n    _prepareDragStageLayer() {\n        const map = this.target.getMap(),\n            layer = this.target.getLayer();\n        this._dragStageLayer = map.getLayer(DRAG_STAGE_LAYER_ID);\n        if (!this._dragStageLayer) {\n            this._dragStageLayer = new VectorLayer(DRAG_STAGE_LAYER_ID, {\n                enableAltitude : layer.options['enableAltitude'],\n                altitudeProperty : layer.options['altitudeProperty']\n            });\n            map.addLayer(this._dragStageLayer);\n        }\n        //copy resources to avoid repeat resource loading.\n        const resources = new ResourceCache();\n        resources.merge(layer._getRenderer().resources);\n        this._dragStageLayer._getRenderer().resources = resources;\n    }\n\n    _startDrag(param) {\n        const map = this.target.getMap();\n        if (!map) {\n            return;\n        }\n        const parent = this.target._getParent();\n        if (parent) {\n            return;\n        }\n        if (this.isDragging()) {\n            return;\n        }\n        const domEvent = param['domEvent'];\n        if (domEvent.touches && domEvent.touches.length > 1 || domEvent.button === 2) {\n            return;\n        }\n        this.container = map._panels.mapWrapper || map._containerDOM;\n        this.target.on('click', this._endDrag, this);\n        this._lastCoord = this._correctCoord(param['coordinate']);\n        this._lastPoint = param['containerPoint'];\n        this._prepareDragHandler();\n        this._dragHandler.onMouseDown(param['domEvent']);\n\n        on(this.container, 'mouseleave', this._endDrag, this);\n        this._startParam = param;\n        this._moved = false;\n\n        return;\n    }\n\n    _dragging(param) {\n        const target = this.target;\n        const map = target.getMap(),\n            e = map._parseEvent(param['domEvent']);\n\n        const domEvent = e['domEvent'];\n        if (domEvent.touches && domEvent.touches.length > 1) {\n            return;\n        }\n\n        if (!this._moved) {\n            this._moved = true;\n            target.on('symbolchange', this._onTargetUpdated, this);\n            this._isDragging = true;\n            this._prepareShadow();\n            if (!target.options['dragShadow']) {\n                target.hide();\n            }\n            this._shadow._fireEvent('dragstart', e);\n            /**\n             * drag start event\n             * @event Geometry#dragstart\n             * @type {Object}\n             * @property {String} type           - dragstart\n             * @property {Geometry} target       - the geometry fires event\n             * @property {Coordinate} coordinate - coordinate of the event\n             * @property {Point} containerPoint  - container point of the event\n             * @property {Point} viewPoint       - view point of the event\n             * @property {Event} domEvent                 - dom event\n             */\n            this.target._fireEvent('dragstart', this._startParam || e);\n            delete this._startParam;\n            return;\n        }\n        if (!this._shadow) {\n            return;\n        }\n        const axis = this._shadow.options['dragOnAxis'],\n            coord = this._correctCoord(e['coordinate']),\n            point = e['containerPoint'];\n        this._lastPoint = this._lastPoint || point;\n        this._lastCoord = this._lastCoord || coord;\n        const pointOffset = point.sub(this._lastPoint);\n        const coordOffset = coord.sub(this._lastCoord);\n        if (axis === 'x') {\n            pointOffset.y = coordOffset.y = 0;\n        } else if (axis === 'y') {\n            pointOffset.x = coordOffset.x = 0;\n        }\n        this._lastPoint = point;\n        this._lastCoord = coord;\n        this._shadow.translate(coordOffset);\n        if (!target.options['dragShadow']) {\n            target.translate(coordOffset);\n        }\n        e['coordOffset'] = coordOffset;\n        e['pointOffset'] = pointOffset;\n        this._shadow._fireEvent('dragging', e);\n\n        /**\n         * dragging event\n         * @event Geometry#dragging\n         * @type {Object}\n         * @property {String} type                    - dragging\n         * @property {Geometry} target       - the geometry fires event\n         * @property {Coordinate} coordinate - coordinate of the event\n         * @property {Point} containerPoint  - container point of the event\n         * @property {Point} viewPoint       - view point of the event\n         * @property {Event} domEvent                 - dom event\n         */\n        target._fireEvent('dragging', e);\n\n    }\n\n    _endDrag(param) {\n        if (this._dragHandler) {\n            this._dragHandler.disable();\n            delete this._dragHandler;\n        }\n        if (this.container) {\n            off(this.container, 'mouseleave', this._endDrag, this);\n        }\n        if (!this.target) {\n            return;\n        }\n        const target = this.target;\n        target.off('click', this._endDrag, this);\n\n        target.off('symbolchange', this._onTargetUpdated, this);\n\n        delete this._lastCoord;\n        delete this._lastPoint;\n\n        this._isDragging = false;\n\n        const map = target.getMap();\n        if (this.enabled() && map) {\n            const e = map._parseEvent(param ? param['domEvent'] : null);\n            this._updateTargetAndRemoveShadow(e);\n            if (this._moved) {\n                /**\n                 * dragend event\n                 * @event Geometry#dragend\n                 * @type {Object}\n                 * @property {String} type                    - dragend\n                 * @property {Geometry} target       - the geometry fires event\n                 * @property {Coordinate} coordinate - coordinate of the event\n                 * @property {Point} containerPoint  - container point of the event\n                 * @property {Point} viewPoint       - view point of the event\n                 * @property {Event} domEvent                 - dom event\n                 */\n                target._fireEvent('dragend', e);\n            }\n        }\n\n\n    }\n\n    isDragging() {\n        if (!this._isDragging) {\n            return false;\n        }\n        return true;\n    }\n\n    _updateTargetAndRemoveShadow(eventParam) {\n        const target = this.target,\n            map = target.getMap();\n        if (!target.options['dragShadow']) {\n            target.show();\n        }\n        const shadow = this._shadow;\n        if (shadow) {\n            if (target.options['dragShadow']) {\n                target.setCoordinates(shadow.getCoordinates());\n            }\n            shadow._fireEvent('dragend', eventParam);\n            shadow.remove();\n            delete this._shadow;\n        }\n        if (this._shadowConnectors) {\n            map.getLayer(DRAG_STAGE_LAYER_ID).removeGeometry(this._shadowConnectors);\n            delete this._shadowConnectors;\n        }\n        if (this._dragStageLayer) {\n            this._dragStageLayer.remove();\n        }\n    }\n\n    //find correct coordinate for coordOffset if geometry has altitude\n    _correctCoord(coord) {\n        const map = this.target.getMap();\n        if (!map.getPitch()) {\n            return coord;\n        }\n        const painter = this.target._getPainter();\n        if (!painter.getMinAltitude()) {\n            return coord;\n        }\n        const alt = (painter.getMinAltitude() + painter.getMaxAltitude()) / 2;\n        return map.locateByPoint(coord, 0, -alt);\n    }\n}\n\nGeometry.mergeOptions({\n    'draggable': false,\n    'dragShadow': true,\n    'dragOnAxis': null\n});\n\nGeometry.addInitHook('addHandler', 'draggable', GeometryDragHandler);\n\nGeometry.include(/** @lends Geometry.prototype */ {\n    /**\n     * Whether the geometry is being dragged.\n     * @reutrn {Boolean}\n     */\n    isDragging() {\n        if (this._getParent()) {\n            return this._getParent().isDragging();\n        }\n        if (this['draggable']) {\n            return this['draggable'].isDragging();\n        }\n        return false;\n    }\n});\n\nexport default GeometryDragHandler;\n","import Geometry from '../Geometry';\nimport GeometryEditor from '../editor/GeometryEditor';\n\nGeometry.include(/** @lends Geometry.prototype */ {\n    /**\n     * Start to edit\n     * @param {Object} [options=null]        - edit options\n     * @param {Object} [options.symbol=null] - symbol for the geometry during editing\n     * @param {Object} [options.fixAspectRatio=false]    - fix outline's aspect ratio when resizing\n     * @param {Object} [options.centerHandleSymbol=null] - symbol of center handle\n     * @param {Object} [options.vertexHandleSymbol=null] - symbol of vertex handle\n     * @param {Object} [options.newVertexHandleSymbol=null] - symbol of new vertex handle\n     * @param {Object} [options.removeVertexOn=contextmenu] - event to remove a vertex from line or polygon, contextmenu by default\n     * @return {Geometry} this\n     */\n    startEdit(opts) {\n        if (!this.getMap() || !this.options['editable']) {\n            return this;\n        }\n        this.endEdit();\n        this._editor = new GeometryEditor(this, opts);\n        this._editor.start();\n        /**\n         * start edit event\n         *\n         * @event Geometry#editstart\n         * @type {Object}\n         * @property {String} type - editstart\n         * @property {Geometry} target - the geometry fires the event\n         */\n        this.fire('editstart');\n        return this;\n    },\n\n    /**\n     * End editing.\n     * @return {Geometry} this\n     */\n    endEdit() {\n        if (this._editor) {\n            this._editor.stop();\n            delete this._editor;\n            /**\n             * end edit event\n             *\n             * @event Geometry#editend\n             * @type {Object}\n             * @property {String} type - editend\n             * @property {Geometry} target - the geometry fires the event\n             */\n            this.fire('editend');\n        }\n        return this;\n    },\n\n    /**\n     * Redo the edit\n     * @return {Geometry} this\n     */\n    redoEdit() {\n        if (!this.isEditing()) {\n            return this;\n        }\n        this._editor.redo();\n        /**\n         * redo edit event\n         *\n         * @event Geometry#redoedit\n         * @type {Object}\n         * @property {String} type - redoedit\n         * @property {Geometry} target - the geometry fires the event\n         */\n        this.fire('redoedit');\n        return this;\n    },\n\n    /**\n     * Undo the edit\n     * @return {Geometry} this\n     */\n    undoEdit() {\n        if (!this.isEditing()) {\n            return this;\n        }\n        this._editor.undo();\n        /**\n         * undo edit event\n         *\n         * @event Geometry#undoedit\n         * @type {Object}\n         * @property {String} type - undoedit\n         * @property {Geometry} target - the geometry fires the event\n         */\n        this.fire('undoedit');\n        return this;\n    },\n\n    /**\n     * Whether the geometry is being edited.\n     * @return {Boolean}\n     */\n    isEditing() {\n        if (this._editor) {\n            return this._editor.isEditing();\n        }\n        return false;\n    }\n});\n","import { preventDefault, stopPropagation, getEventContainerPoint } from '../../core/util/dom';\nimport Geometry from '../Geometry';\n\nGeometry.include(/** @lends Geometry.prototype */ {\n    /**\n     * The event handler for all the events.\n     * @param  {Event} event - dom event\n     * @private\n     */\n    _onEvent: function (event, type) {\n        if (!this.getMap()) {\n            return;\n        }\n        const eventType = type || this._getEventTypeToFire(event);\n        if (eventType === 'contextmenu' && this.listens('contextmenu')) {\n            stopPropagation(event);\n            preventDefault(event);\n        }\n        const params = this._getEventParams(event);\n        this._fireEvent(eventType, params);\n    },\n\n    _getEventTypeToFire: function (domEvent) {\n        // let eventType = domEvent.type;\n        // //change event type to contextmenu\n        // if (eventType === 'click' || eventType === 'mousedown') {\n        //     if (domEvent.button === 2) {\n        //         eventType = 'contextmenu';\n        //     }\n        // }\n        return domEvent.type;\n    },\n\n    /**\n     * Generate event parameters\n     * @param  {Event} event - dom event\n     * @return {Object}\n     * @private\n     */\n    _getEventParams: function (e) {\n        const map = this.getMap();\n        const eventParam = {\n            'domEvent': e\n        };\n        const actual = e.touches && e.touches.length > 0 ? e.touches[0] : e.changedTouches  && e.changedTouches.length > 0 ? e.changedTouches[0] : e;\n        if (actual) {\n            const containerPoint = getEventContainerPoint(actual, map._containerDOM);\n            eventParam['coordinate'] = map.containerPointToCoordinate(containerPoint);\n            eventParam['containerPoint'] = containerPoint;\n            eventParam['viewPoint'] = map.containerPointToViewPoint(containerPoint);\n            eventParam['pont2d'] = map._containerPointToPoint(containerPoint);\n        }\n        return eventParam;\n    }\n});\n","import { extend } from '../../core/util';\nimport Geometry from '../Geometry';\nimport InfoWindow from '../../ui/InfoWindow';\n\nGeometry.include(/** @lends Geometry.prototype */ {\n    /**\n     * Set an InfoWindow to the geometry\n     * @param {Object} options - construct [options]{@link ui.InfoWindow#options} for the InfoWindow\n     * @return {Geometry} this\n     * @example\n     * geometry.setInfoWindow({\n     *     title    : 'This is a title',\n     *     content  : '<div style=\"color:#f00\">This is content of the InfoWindow</div>'\n     * });\n     */\n    setInfoWindow(options) {\n        this.removeInfoWindow();\n        if (options instanceof InfoWindow) {\n            this._infoWindow = options;\n            this._infoWinOptions = extend({}, this._infoWindow.options);\n            this._infoWindow.addTo(this);\n            return this;\n        }\n        this._infoWinOptions = extend({}, options);\n        if (this._infoWindow) {\n            this._infoWindow.setOptions(options);\n        } else if (this.getMap()) {\n            this._bindInfoWindow(this._infoWinOptions);\n        }\n\n        return this;\n    },\n\n    /**\n     * Get the InfoWindow instance.\n     * @return {ui.InfoWindow}\n     */\n    getInfoWindow() {\n        if (!this._infoWindow) {\n            return null;\n        }\n        return this._infoWindow;\n    },\n\n    /**\n     * Open the InfoWindow, default on the center of the geometry.\n     * @param  {Coordinate} [coordinate=null] - coordinate to open the InfoWindow\n     * @return {Geometry} this\n     */\n    openInfoWindow(coordinate) {\n        if (!this.getMap()) {\n            return this;\n        }\n        if (!coordinate) {\n            coordinate = this.getCenter();\n        }\n        if (!this._infoWindow) {\n            if (this._infoWinOptions && this.getMap()) {\n                this._bindInfoWindow(this._infoWinOptions);\n                this._infoWindow.show(coordinate);\n            }\n        } else {\n            this._infoWindow.show(coordinate);\n        }\n        return this;\n    },\n\n    /**\n     * Close the InfoWindow\n     * @return {Geometry} this\n     */\n    closeInfoWindow() {\n        if (this._infoWindow) {\n            this._infoWindow.hide();\n        }\n        return this;\n    },\n\n    /**\n     * Remove the InfoWindow\n     * @return {Geometry} this\n     */\n    removeInfoWindow() {\n        this._unbindInfoWindow();\n        delete this._infoWinOptions;\n        delete this._infoWindow;\n        return this;\n    },\n\n    _bindInfoWindow(options) {\n        this._infoWindow = new InfoWindow(options);\n        this._infoWindow.addTo(this);\n\n        return this;\n    },\n\n    _unbindInfoWindow() {\n        if (this._infoWindow) {\n            this.closeInfoWindow();\n            this._infoWindow.remove();\n            delete this._infoWindow;\n        }\n        return this;\n    }\n});\n","import {\n    isNil,\n    loadImage,\n    emptyImageUrl,\n    now,\n    isFunction\n} from '../../../core/util';\nimport Canvas2D from '../../../core/Canvas';\nimport TileLayer from '../../../layer/tile/TileLayer';\nimport CanvasRenderer from '../CanvasRenderer';\nimport Point from '../../../geo/Point';\nimport LRUCache from '../../../core/util/LRUCache';\nimport Canvas from '../../../core/Canvas';\n\nconst TEMP_POINT = new Point(0, 0);\nconst TEMP_POINT1 = new Point(0, 0);\nconst TEMP_POINT2 = new Point(0, 0);\n\n/**\n * @classdesc\n * Renderer class based on HTML5 Canvas2D for TileLayers\n * @class\n * @protected\n * @memberOf renderer\n * @extends {renderer.CanvasRenderer}\n */\nclass TileLayerCanvasRenderer extends CanvasRenderer {\n\n    /**\n     *\n     * @param {TileLayer} layer - TileLayer to render\n     */\n    constructor(layer) {\n        super(layer);\n        this.tilesInView = {};\n        this.tilesLoading = {};\n        this._parentTiles = [];\n        this._childTiles = [];\n        this.tileCache = new LRUCache(layer.options['maxCacheSize'], this.deleteTile.bind(this));\n    }\n\n    getCurrentTileZoom() {\n        return this._tileZoom;\n    }\n\n    draw() {\n        const map = this.getMap();\n        if (!this.isDrawable()) {\n            return;\n        }\n        const mask2DExtent = this.prepareCanvas();\n        if (mask2DExtent) {\n            if (!mask2DExtent.intersects(this.canvasExtent2D)) {\n                this.completeRender();\n                return;\n            }\n        }\n        const layer = this.layer;\n        const tileGrids = layer.getTiles().tileGrids;\n        if (!tileGrids || !tileGrids.length) {\n            this.completeRender();\n            return;\n        }\n\n        let loadingCount = 0;\n        let loading = false;\n        const checkedTiles = {};\n        const tiles = [],\n            parentTiles = [], parentKeys = {},\n            childTiles = [], childKeys = {},\n            placeholders = [], placeholderKeys = {};\n        //visit all the tiles\n        const tileQueue = {};\n        const preLoadingCount = this._markTiles(),\n            loadingLimit = this._getLoadLimit();\n\n        const l = tileGrids.length;\n\n        // main tile grid is the last one (draws on top)\n        this._tileZoom = tileGrids[0]['zoom'];\n        this._tileOffset = tileGrids[0]['offset'];\n\n        for (let i = 0; i < l; i++) {\n            const tileGrid = tileGrids[i];\n            const allTiles = tileGrid['tiles'];\n\n            const placeholder = this._generatePlaceHolder(tileGrid.zoom);\n\n            for (let i = 0, l = allTiles.length; i < l; i++) {\n                const tile = allTiles[i],\n                    tileId = tile['id'];\n                //load tile in cache at first if it has.\n                const cached = this._getCachedTile(tileId);\n                let tileLoading = false;\n                if (this._isLoadingTile(tileId)) {\n                    tileLoading = loading = true;\n                    this.tilesLoading[tileId].current = true;\n                } else if (cached) {\n                    if (this.getTileOpacity(cached.image) < 1) {\n                        tileLoading = loading = true;\n                    }\n                    tiles.push(cached);\n                } else {\n                    tileLoading = loading = true;\n                    const hitLimit = loadingLimit && (loadingCount + preLoadingCount[0]) > loadingLimit;\n                    if (!hitLimit && (!map.isInteracting() || (map.isMoving() || map.isRotating()))) {\n                        loadingCount++;\n                        tileQueue[tileId + '@' + tile['point'].toArray().join()] = tile;\n                    }\n                }\n                if (!tileLoading) continue;\n                if (checkedTiles[tile.dupKey]) {\n                    continue;\n                }\n\n                checkedTiles[tile.dupKey] = 1;\n                if (placeholder && !placeholderKeys[tile.dupKey]) {\n                    //tell gl renderer not to bind gl buffer with image\n                    tile.cache = false;\n                    placeholders.push({\n                        image : placeholder,\n                        info : tile\n                    });\n\n                    placeholderKeys[tile.dupKey] = 1;\n                }\n\n                const parentTile = this._findParentTile(tile);\n                if (parentTile) {\n                    const dupKey = parentTile.info.dupKey;\n                    if (parentKeys[dupKey] === undefined) {\n                        parentKeys[dupKey] = parentTiles.length;\n                        parentTiles.push(parentTile);\n                    }/* else {\n                        //replace with parentTile of above tiles\n                        parentTiles[parentKeys[dupKey]] = parentTile;\n                    } */\n                } else {\n                    const children = this._findChildTiles(tile);\n                    if (children.length) {\n                        children.forEach(c => {\n                            if (!childKeys[c.info.dupKey]) {\n                                childTiles.push(c);\n                                childKeys[c.info.dupKey] = 1;\n                            }\n                        });\n                    }\n                }\n            }\n        }\n\n        this._drawTiles(tiles, parentTiles, childTiles, placeholders);\n        if (!loadingCount) {\n            if (!loading) {\n                //redraw to remove parent tiles if any left in last paint\n                if (!map.isAnimating() && (this._parentTiles.length || this._childTiles.length)) {\n                    this._parentTiles = [];\n                    this._childTiles = [];\n                    this.setToRedraw();\n                }\n                this.completeRender();\n            }\n        } else {\n            this.loadTileQueue(tileQueue);\n        }\n        this._retireTiles();\n    }\n\n    isTileCachedOrLoading(tileId) {\n        return this.tilesLoading[tileId] || this.tilesInView[tileId] || this.tileCache.get(tileId);\n    }\n\n    _drawTiles(tiles, parentTiles, childTiles, placeholders) {\n        if (parentTiles.length) {\n            //closer the latter (to draw on top)\n            parentTiles.sort((t1, t2) => Math.abs(t2.info.z - this._tileZoom) - Math.abs(t1.info.z - this._tileZoom));\n            this._parentTiles = parentTiles;\n        }\n        if (childTiles.length) {\n            this._childTiles = childTiles;\n        }\n\n        const context = { tiles, parentTiles, childTiles };\n        this.onDrawTileStart(context);\n\n        this._parentTiles.forEach(t => this._drawTileAndCache(t));\n        this._childTiles.forEach(t => this._drawTileOffset(t.info, t.image));\n\n        placeholders.forEach(t => this._drawTileOffset(t.info, t.image));\n\n        const layer = this.layer,\n            map = this.getMap();\n        if (!layer.options['cascadeTiles'] || map.getPitch() <= layer.options['minPitchToCascade']) {\n            tiles.forEach(t => this._drawTileAndCache(t));\n        } else {\n            //write current tiles and update stencil buffer to clip parent|child tiles with current tiles\n            this.writeZoomStencil();\n            let started = false;\n            for (let i = 0, l = tiles.length; i < l; i++) {\n                if (tiles[i].info.z !== this._tileZoom) {\n                    if (!started) {\n                        this.startZoomStencilTest();\n                        started = true;\n                    } else {\n                        this.resumeZoomStencilTest();\n                    }\n                } else if (started) {\n                    this.pauseZoomStencilTest();\n                }\n                this._drawTileAndCache(tiles[i]);\n            }\n            this.endZoomStencilTest();\n        }\n\n        this.onDrawTileEnd(context);\n\n    }\n\n    writeZoomStencil() {}\n    startZoomStencilTest() {}\n    endZoomStencilTest() {}\n    pauseZoomStencilTest() {}\n    resumeZoomStencilTest() {}\n\n    onDrawTileStart() {}\n    onDrawTileEnd() {}\n\n    _drawTileOffset(info, image) {\n        const offset = this._tileOffset;\n        if (!offset[0] && !offset[1]) {\n            this.drawTile(info, image);\n            return;\n        }\n        const map = this.getMap();\n        //tempararily add offset to tile info\n        const scale = map._getResolution(this._tileZoom) / map._getResolution(info.z);\n        offset[0] *= scale;\n        offset[1] *= scale;\n        info.point._sub(offset);\n        info.extent2d._sub(offset);\n        this.drawTile(info, image);\n        //restore\n        info.point._add(offset);\n        info.extent2d._add(offset);\n        offset[0] /= scale;\n        offset[1] /= scale;\n    }\n\n    _drawTileAndCache(tile) {\n        tile.current = true;\n        this.tilesInView[tile.info.id] = tile;\n        this._drawTileOffset(tile.info, tile.image);\n        this.tileCache.add(tile.info.id, tile);\n    }\n\n    drawOnInteracting() {\n        this.draw();\n    }\n\n    needToRedraw() {\n        const map = this.getMap();\n        if (map.getPitch()) {\n            return super.needToRedraw();\n        }\n        if (map.isRotating() || map.isZooming()) {\n            return true;\n        }\n        if (map.isMoving()) {\n            return !!this.layer.options['forceRenderOnMoving'];\n        }\n        return super.needToRedraw();\n    }\n\n    hitDetect() {\n        return false;\n    }\n\n    // limit tile number to load when map is interacting\n    _getLoadLimit() {\n        if (this.getMap().isInteracting()) {\n            return this.layer.options['loadingLimitOnInteracting'];\n        }\n        return 0;\n    }\n\n    isDrawable() {\n        if (this.getMap().getPitch()) {\n            if (console) {\n                console.warn('TileLayer with canvas renderer can\\'t be pitched, use gl renderer (\\'renderer\\' : \\'gl\\') instead.');\n            }\n            this.clear();\n            return false;\n        }\n        return true;\n    }\n\n    clear() {\n        this._retireTiles(true);\n        this.tileCache.reset();\n        this.tilesInView = {};\n        this.tilesLoading = {};\n        this._parentTiles = [];\n        this._childTiles = [];\n        super.clear();\n    }\n\n    _isLoadingTile(tileId) {\n        return !!this.tilesLoading[tileId];\n    }\n\n    clipCanvas(context) {\n        const mask = this.layer.getMask();\n        if (!mask) {\n            return this._clipByPitch(context);\n        }\n        return super.clipCanvas(context);\n    }\n\n    // clip canvas to avoid rough edge of tiles\n    _clipByPitch(ctx) {\n        const map = this.getMap();\n        if (map.getPitch() <= map.options['maxVisualPitch']) {\n            return false;\n        }\n        if (!this.layer.options['clipByPitch']) {\n            return false;\n        }\n        const clipExtent = map.getContainerExtent();\n        const r = map.getDevicePixelRatio();\n        ctx.save();\n        ctx.strokeStyle = 'rgba(0, 0, 0, 0)';\n        ctx.beginPath();\n        ctx.rect(0, Math.ceil(clipExtent.ymin) * r, Math.ceil(clipExtent.getWidth()) * r, Math.ceil(clipExtent.getHeight()) * r);\n        ctx.stroke();\n        ctx.clip();\n        return true;\n    }\n\n    loadTileQueue(tileQueue) {\n        for (const p in tileQueue) {\n            if (tileQueue.hasOwnProperty(p)) {\n                const tile = tileQueue[p];\n                const tileImage = this.loadTile(tile);\n                if (tileImage.loadTime === undefined) {\n                    // tile image's loading may not be async\n                    this.tilesLoading[tile['id']] = {\n                        image : tileImage,\n                        current : true,\n                        info : tile\n                    };\n                }\n            }\n        }\n    }\n\n    loadTile(tile) {\n        const tileSize = this.layer.getTileSize();\n        const tileImage = new Image();\n\n        tileImage.width = tileSize['width'];\n        tileImage.height = tileSize['height'];\n\n        tileImage.onload = this.onTileLoad.bind(this, tileImage, tile);\n        tileImage.onerror = this.onTileError.bind(this, tileImage, tile);\n\n        this.loadTileImage(tileImage, tile['url']);\n        return tileImage;\n    }\n\n    loadTileImage(tileImage, url) {\n        const crossOrigin = this.layer.options['crossOrigin'];\n        if (!isNil(crossOrigin)) {\n            tileImage.crossOrigin = crossOrigin;\n        }\n        return loadImage(tileImage, [url]);\n    }\n\n    abortTileLoading(tileImage) {\n        if (!tileImage) return;\n        tileImage.onload = falseFn;\n        tileImage.onerror = falseFn;\n        tileImage.src = emptyImageUrl;\n    }\n\n    onTileLoad(tileImage, tileInfo) {\n        if (!this.layer) {\n            return;\n        }\n        const id = tileInfo['id'];\n        if (!this.tilesInView) {\n            // removed\n            return;\n        }\n        tileImage.loadTime = now();\n        delete this.tilesLoading[id];\n        this._addTileToCache(tileInfo, tileImage);\n        this.setToRedraw();\n        /**\n         * tileload event, fired when tile is loaded.\n         *\n         * @event TileLayer#tileload\n         * @type {Object}\n         * @property {String} type - tileload\n         * @property {TileLayer} target - tile layer\n         * @property {Object} tileInfo - tile info\n         * @property {Image} tileImage - tile image\n         */\n        this.layer.fire('tileload', { tile : tileInfo, tileImage: tileImage });\n    }\n\n    onTileError(tileImage, tileInfo) {\n        if (!this.layer) {\n            return;\n        }\n        tileImage.onerrorTick = tileImage.onerrorTick || 0;\n        const tileRetryCount = this.layer.options['tileRetryCount'];\n        if (tileRetryCount > tileImage.onerrorTick) {\n            tileImage.onerrorTick++;\n            tileImage.src = tileInfo.url;\n            return;\n        }\n        if (tileImage instanceof Image) {\n            this.abortTileLoading(tileImage, tileInfo);\n        }\n        tileImage.loadTime = 0;\n        delete this.tilesLoading[tileInfo['id']];\n        this._addTileToCache(tileInfo, tileImage);\n        this.setToRedraw();\n        /**\n         * tileerror event, fired when tile loading has error.\n         *\n         * @event TileLayer#tileerror\n         * @type {Object}\n         * @property {String} type - tileerror\n         * @property {TileLayer} target - tile layer\n         * @property {Object} tileInfo - tile info\n         */\n        this.layer.fire('tileerror', { tile : tileInfo });\n    }\n\n    drawTile(tileInfo, tileImage) {\n        if (!tileImage || !this.getMap()) {\n            return;\n        }\n        const point = tileInfo.point,\n            tileZoom = tileInfo.z,\n            tileId = tileInfo.id;\n        const map = this.getMap(),\n            tileSize = tileInfo.size,\n            zoom = map.getZoom(),\n            ctx = this.context,\n            cp = map._pointToContainerPoint(point, tileZoom, 0, TEMP_POINT),\n            bearing = map.getBearing(),\n            transformed = bearing || zoom !== tileZoom;\n        const opacity = this.getTileOpacity(tileImage);\n        const alpha = ctx.globalAlpha;\n        if (opacity < 1) {\n            ctx.globalAlpha = opacity;\n            this.setToRedraw();\n        }\n        if (!transformed) {\n            cp._round();\n        }\n        let x = cp.x,\n            y = cp.y;\n        let w = tileSize[0], h = tileSize[1];\n        if (transformed) {\n            w += 0.1;\n            h += 0.1;\n            ctx.save();\n            ctx.translate(x, y);\n            if (bearing) {\n                ctx.rotate(-bearing * Math.PI / 180);\n            }\n            if (zoom !== tileZoom) {\n                const scale = map._getResolution(tileZoom) / map._getResolution();\n                ctx.scale(scale, scale);\n            }\n            x = y = 0;\n        }\n        Canvas2D.image(ctx, tileImage, x, y, w, h);\n        if (this.layer.options['debug']) {\n            const color = this.layer.options['debugOutline'],\n                xyz = tileId.split('-');\n            ctx.save();\n            ctx.strokeStyle = color;\n            ctx.fillStyle = color;\n            ctx.strokeWidth = 10;\n            ctx.font = '15px monospace';\n            Canvas2D.rectangle(ctx, x, y, { width: w, height: h }, 1, 0);\n            Canvas2D.fillText(ctx, 'x:' + xyz[xyz.length - 3] + ', y:' + xyz[xyz.length - 2] + ', z:' + xyz[xyz.length - 1], x + 10, y + 20, color);\n            Canvas2D.drawCross(ctx, x + w / 2, y + h / 2, 2, color);\n            ctx.restore();\n        }\n        if (transformed) {\n            ctx.restore();\n        }\n        if (ctx.globalAlpha !== alpha) {\n            ctx.globalAlpha = alpha;\n        }\n        this.setCanvasUpdated();\n    }\n\n    _findChildTiles(info) {\n        const layer = this._getLayerOfTile(info.layer);\n        if (!layer.options['background']) {\n            return [];\n        }\n        const map = this.getMap();\n        const children = [];\n        const min = info.extent2d.getMin(),\n            max = info.extent2d.getMax(),\n            pmin = layer._project(map._pointToPrj(min, info.z, TEMP_POINT1), TEMP_POINT1),\n            pmax = layer._project(map._pointToPrj(max, info.z, TEMP_POINT2), TEMP_POINT2);\n        const zoomDiff = 2;\n        for (let i = 1; i < zoomDiff; i++) {\n            this._findChildTilesAt(children, pmin, pmax, layer, info.z + i);\n        }\n\n        return children;\n    }\n\n    _findChildTilesAt(children, pmin, pmax, layer, childZoom) {\n        const zoomOffset = layer.options['zoomOffset'];\n        const layerId = layer.getId(),\n            res = layer.getSpatialReference().getResolution(childZoom + zoomOffset);\n        if (!res) {\n            return;\n        }\n        const dmin = layer._getTileConfig().getTileIndex(pmin, res),\n            dmax = layer._getTileConfig().getTileIndex(pmax, res);\n        const sx = Math.min(dmin.idx, dmax.idx), ex = Math.max(dmin.idx, dmax.idx);\n        const sy = Math.min(dmin.idy, dmax.idy), ey = Math.max(dmin.idy, dmax.idy);\n        let id, tile;\n        for (let i = sx; i < ex; i++) {\n            for (let ii = sy; ii < ey; ii++) {\n                id = layer._getTileId({ idx : i, idy : ii }, childZoom + zoomOffset, layerId);\n                if (this.tileCache.has(id)) {\n                    tile = this.tileCache.getAndRemove(id);\n                    children.push(tile);\n                    this.tileCache.add(id, tile);\n                }\n            }\n        }\n    }\n\n    _findParentTile(info) {\n        const map = this.getMap(),\n            layer = this._getLayerOfTile(info.layer);\n        if (!layer.options['background']) {\n            return null;\n        }\n        const sr = layer.getSpatialReference();\n        const d = sr.getZoomDirection(),\n            zoomOffset = layer.options['zoomOffset'],\n            zoomDiff = layer.options['backgroundZoomDiff'];\n        const center = info.extent2d.getCenter(),\n            prj = layer._project(map._pointToPrj(center, info.z));\n        for (let diff = 1; diff <= zoomDiff; diff++) {\n            const z = info.z - d * diff;\n            const res = sr.getResolution(z + zoomOffset);\n            if (!res) continue;\n            const tileIndex = layer._getTileConfig().getTileIndex(prj, res);\n            const id = layer._getTileId(tileIndex, z + zoomOffset, info.layer);\n            if (this.tileCache.has(id)) {\n                const tile = this.tileCache.getAndRemove(id);\n                this.tileCache.add(id, tile);\n                return tile;\n            }\n        }\n        return null;\n    }\n\n    _getLayerOfTile(layerId) {\n        return this.layer.getChildLayer ? this.layer.getChildLayer(layerId) : this.layer;\n    }\n\n    _getCachedTile(tileId) {\n        const tilesInView = this.tilesInView;\n        let cached = this.tileCache.getAndRemove(tileId);\n        if (cached) {\n            tilesInView[tileId] = cached;\n            const tilesLoading = this.tilesLoading;\n            if (tilesLoading && tilesLoading[tileId]) {\n                tilesLoading[tileId].current = false;\n                const { image, info } = tilesLoading[tileId];\n                this.abortTileLoading(image, info);\n                delete tilesLoading[tileId];\n            }\n        } else {\n            cached = tilesInView[tileId];\n        }\n        return cached;\n    }\n\n    _addTileToCache(tileInfo, tileImage) {\n        this.tilesInView[tileInfo.id] = {\n            image : tileImage,\n            current : true,\n            info : tileInfo\n        };\n    }\n\n    getTileOpacity(tileImage) {\n        if (!this.layer.options['fadeAnimation'] || !tileImage.loadTime) {\n            return 1;\n        }\n        return Math.min(1, (now() - tileImage.loadTime) / (1000 / 60 * 10));\n    }\n\n    onRemove() {\n        this.clear();\n        delete this.tileCache;\n        delete this._tilePlaceHolder;\n        super.onRemove();\n    }\n\n\n    _markTiles() {\n        let a = 0, b = 0;\n        if (this.tilesLoading) {\n            for (const p in this.tilesLoading) {\n                this.tilesLoading[p].current = false;\n                a++;\n            }\n        }\n        if (this.tilesInView) {\n            for (const p in this.tilesInView) {\n                this.tilesInView[p].current = false;\n                b++;\n            }\n        }\n        return [a, b];\n    }\n\n    _retireTiles(force) {\n        for (const i in this.tilesLoading) {\n            const tile = this.tilesLoading[i];\n            if (force || !tile.current) {\n                // abort loading tiles\n                if (tile.image) {\n                    this.abortTileLoading(tile.image, tile.info);\n                }\n                this.deleteTile(tile);\n                delete this.tilesLoading[i];\n            }\n        }\n        for (const i in this.tilesInView) {\n            const tile = this.tilesInView[i];\n            if (!tile.current) {\n                delete this.tilesInView[i];\n                if (!this.tileCache.has(i)) {\n                    this.deleteTile(tile);\n                }\n            }\n        }\n    }\n\n    deleteTile(tile) {\n        if (!tile || !tile.image) {\n            return;\n        }\n        tile.image.onload = null;\n        tile.image.onerror = null;\n    }\n\n    _generatePlaceHolder(z) {\n        const map = this.getMap();\n        const placeholder = this.layer.options['placeholder'];\n        if (!placeholder || map.getPitch()) {\n            return null;\n        }\n        const tileSize = this.layer.getTileSize(),\n            scale = map._getResolution(z) / map._getResolution(),\n            canvas = this._tilePlaceHolder = this._tilePlaceHolder || Canvas.createCanvas(1, 1);\n        canvas.width = tileSize.width * scale;\n        canvas.height = tileSize.height * scale;\n        if (isFunction(placeholder)) {\n            placeholder(canvas);\n        } else {\n            defaultPlaceholder(canvas);\n        }\n        return canvas;\n    }\n}\n\nTileLayer.registerRenderer('canvas', TileLayerCanvasRenderer);\n\nfunction falseFn() { return false; }\n\nfunction defaultPlaceholder(canvas) {\n    const ctx = canvas.getContext('2d'),\n        cw = canvas.width, ch = canvas.height,\n        w = cw / 16, h = ch / 16;\n    ctx.beginPath();\n    for (let i = 0; i < 16; i++) {\n        ctx.moveTo(0, i * h);\n        ctx.lineTo(cw, i * h);\n        ctx.moveTo(i * w, 0);\n        ctx.lineTo(i * w, ch);\n    }\n    ctx.strokeStyle = 'rgba(180, 180, 180, 0.1)';\n    ctx.lineWidth = 1;\n    ctx.stroke();\n    ctx.beginPath();\n    const path = [\n        [0, 0], [cw, 0], [0, ch], [cw, ch], [0, 0], [0, ch], [cw, 0], [cw, ch], [0, ch / 2], [cw, ch / 2], [cw / 2, 0], [cw / 2, ch]\n    ];\n    for (let i = 1; i < path.length; i += 2) {\n        ctx.moveTo(path[i - 1][0], path[i - 1][1]);\n        ctx.lineTo(path[i][0], path[i][1]);\n    }\n    ctx.lineWidth = 1 * 4;\n    ctx.stroke();\n}\n\nexport default TileLayerCanvasRenderer;\n","import TileLayer from '../../../layer/tile/TileLayer';\nimport TileLayerCanvasRenderer from './TileLayerCanvasRenderer';\nimport ImageGLRenderable from '../ImageGLRenderable';\n\n/**\n * @classdesc\n * Renderer class based on HTML5 WebGL for TileLayers\n * @class\n * @protected\n * @memberOf renderer\n * @extends {renderer.TileLayerCanvasRenderer}\n * @param {TileLayer} layer - TileLayer to render\n */\nclass TileLayerGLRenderer extends ImageGLRenderable(TileLayerCanvasRenderer) {\n\n    //override to set to always drawable\n    isDrawable() {\n        return true;\n    }\n\n    needToRedraw() {\n        const map = this.getMap();\n        if (this._gl() && !map.getPitch() && map.isZooming() && !map.isMoving() && !map.isRotating()) {\n            return true;\n        }\n        return super.needToRedraw();\n    }\n\n    drawTile(tileInfo, tileImage) {\n        const map = this.getMap();\n        if (!tileInfo || !map || !tileImage) {\n            return;\n        }\n\n        const scale = tileInfo._glScale = tileInfo._glScale || map.getGLScale(tileInfo.z),\n            w = tileInfo.size[0] * scale,\n            h = tileInfo.size[1] * scale;\n        if (tileInfo.cache !== false) {\n            this._bindGLBuffer(tileImage, w, h);\n        }\n        if (!this._gl()) {\n            // fall back to canvas 2D, which is faster\n            super.drawTile(tileInfo, tileImage);\n            return;\n        }\n        const point = tileInfo.point;\n        const x = point.x * scale,\n            y = point.y * scale;\n        const opacity = this.getTileOpacity(tileImage);\n        this.drawGLImage(tileImage, x, y, w, h, opacity);\n\n        if (opacity < 1) {\n            this.setToRedraw();\n        } else {\n            this.setCanvasUpdated();\n        }\n    }\n\n    writeZoomStencil() {\n        const gl = this.gl;\n        gl.stencilFunc(gl.ALWAYS, 1, 0xFF);\n        gl.stencilOp(gl.KEEP, gl.KEEP, gl.REPLACE);\n    }\n\n    startZoomStencilTest() {\n        const gl = this.gl;\n        gl.stencilOp(gl.KEEP, gl.KEEP, gl.KEEP);\n        gl.stencilFunc(gl.EQUAL, 0, 0xFF);\n    }\n\n    endZoomStencilTest() {\n        this.pauseZoomStencilTest();\n    }\n\n    pauseZoomStencilTest() {\n        const gl = this.gl;\n        gl.stencilFunc(gl.ALWAYS, 1, 0xFF);\n    }\n\n    resumeZoomStencilTest() {\n        const gl = this.gl;\n        gl.stencilFunc(gl.EQUAL, 0, 0xFF);\n    }\n\n    _bindGLBuffer(image, w, h) {\n        if (!image.glBuffer) {\n            image.glBuffer = this.bufferTileData(0, 0, w, h);\n        }\n    }\n\n    loadTileImage(tileImage, url) {\n        //image must set cors in webgl\n        const crossOrigin = this.layer.options['crossOrigin'];\n        tileImage.crossOrigin = crossOrigin !== null ? crossOrigin : '';\n        tileImage.src = url;\n        return;\n    }\n\n    // prepare gl, create program, create buffers and fill unchanged data: image samplers, texture coordinates\n    onCanvasCreate() {\n        //not in a GroupGLLayer\n        if (!this.canvas.gl || !this.canvas.gl.wrap) {\n            this.createCanvas2();\n        }\n    }\n\n    createContext() {\n        super.createContext();\n        this.createGLContext();\n    }\n\n    resizeCanvas(canvasSize) {\n        if (!this.canvas) {\n            return;\n        }\n        super.resizeCanvas(canvasSize);\n        this.resizeGLCanvas();\n    }\n\n    clearCanvas() {\n        if (!this.canvas) {\n            return;\n        }\n        super.clearCanvas();\n        this.clearGLCanvas();\n    }\n\n    getCanvasImage() {\n        if (!this._gl() || !this.canvas2) {\n            return super.getCanvasImage();\n        }\n        const img = super.getCanvasImage();\n        if (img) {\n            img.image = this.canvas2;\n        }\n        return img;\n    }\n\n    // decide whether the layer is renderer with gl.\n    // when map is pitching, or fragmentShader is set in options\n    _gl() {\n        if (this.canvas.gl && this.canvas.gl.wrap) {\n            //in GroupGLLayer\n            return true;\n        }\n        const map = this.getMap();\n        return map && (map.getPitch() || map.getBearing()) || this.layer && !!this.layer.options['fragmentShader'];\n    }\n\n    deleteTile(tile) {\n        super.deleteTile(tile);\n        if (tile && tile.image) {\n            this.disposeImage(tile.image);\n        }\n    }\n\n    onRemove() {\n        super.onRemove();\n        this.removeGLCanvas();\n    }\n}\n\nTileLayer.registerRenderer('gl', TileLayerGLRenderer);\n\nexport default TileLayerGLRenderer;\n\n\n","import CanvasTileLayer from '../../../layer/tile/CanvasTileLayer';\nimport Canvas2D from '../../../core/Canvas';\nimport TileLayerCanvasRenderer from './TileLayerCanvasRenderer';\nimport TileLayerGLRenderer from './TileLayerGLRenderer';\nimport Extent from '../../../geo/Extent';\n\nfunction loadTile(tile) {\n    const tileSize = this.layer.getTileSize(),\n        canvasClass = this.canvas.constructor,\n        map = this.getMap();\n    const r = map.getDevicePixelRatio();\n    const tileCanvas = Canvas2D.createCanvas(tileSize['width'] * r, tileSize['height'] * r, canvasClass);\n    tileCanvas['layer'] = this.layer;\n    const me = this;\n    const extent = new Extent(map.pointToCoordinate(tile['point']), map.pointToCoordinate(tile['point'].add(tileSize.toPoint())), map.getProjection());\n    this.layer.drawTile(tileCanvas, {\n        'url': tile['url'],\n        'point': tile['point'],\n        'center' : map.pointToCoordinate(tile['point'].add(tileSize['width'] / 2, tileSize['height'] / 2)),\n        'extent' : extent,\n        'z': tile['z'],\n        'x' : tile['x'],\n        'y' : tile['y']\n    }, error => {\n        if (error) {\n            me.onTileError(tileCanvas, tile);\n            return;\n        }\n        me.onTileLoad(tileCanvas, tile);\n    });\n    return tileCanvas;\n}\n\nclass CanvasRenderer extends TileLayerCanvasRenderer {\n    loadTile() {\n        return loadTile.apply(this, arguments);\n    }\n}\n\nclass GLRenderer extends TileLayerGLRenderer {\n    loadTile() {\n        return loadTile.apply(this, arguments);\n    }\n}\n\nCanvasTileLayer.registerRenderer('canvas', CanvasRenderer);\nCanvasTileLayer.registerRenderer('gl', GLRenderer);\n\nexport {\n    CanvasRenderer as CanvasTileLayerCanvasRenderer,\n    GLRenderer as CanvasTileLayerGLRenderer\n};\n","import { createProgram, enableVertexAttrib } from '../../../core/util/gl';\n\nconst quadVertices = typeof Int8Array !== 'undefined' ? new Int8Array([\n    // positions\n    -1,  1, 0,\n    -1, -1, 0,\n    1,  1, 0,\n    1, -1, 0,\n]) : [];\n\nconst vert = `\n    attribute vec3 a_position;\n    uniform mat4 transform;\n\n    void main()\n    {\n        gl_Position = transform * vec4(a_position, 1.0);\n    }\n`;\n\nconst frag = `\n    precision mediump float;\n    uniform vec3 color;\n    void main()\n    {\n        gl_FragColor = vec4(color, 1.0);\n    }\n`;\n\nclass QuadStencil {\n    constructor(gl, vertices, debug) {\n        this.gl = gl;\n        this.quadVertices = vertices || quadVertices;\n        this.attributes = ['a_position', 3, getType(vertices)];\n        this.debug = debug;\n    }\n\n    start() {\n        const gl = this.gl;\n        gl.enable(gl.STENCIL_TEST);\n        gl.stencilMask(0xFF);\n        gl.stencilOp(gl.KEEP, gl.REPLACE, gl.REPLACE);\n        gl.depthMask(false);\n        this._save();\n        if (!this.buffer) {\n            this._createBuffer();\n            this._createProgram();\n        }\n        gl.useProgram(this.program);\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.buffer);\n        enableVertexAttrib(gl, this.program, this.attributes);\n        if (!this.transformLoc) {\n            this.transformLoc = gl.getUniformLocation(this.program, 'transform');\n        }\n        if (!this.colorLoc) {\n            this.colorLoc = gl.getUniformLocation(this.program, 'color');\n        }\n        if (this.debug) {\n            return;\n        }\n        gl.colorMask(false, false, false, false);\n    }\n\n    end() {\n        const gl = this.gl;\n        gl.depthMask(true);\n        this._restore();\n        if (this.debug) {\n            return;\n        }\n        gl.colorMask(true, true, true, true);\n    }\n\n    draw(transform) {\n        const gl = this.gl;\n        gl.uniformMatrix4fv(this.transformLoc, false, transform);\n        gl.uniform3fv(this.colorLoc, [Math.random(), Math.random(), Math.random()]);\n        gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n    }\n\n    remove() {\n        const gl = this.gl;\n        if (this.buffer) {\n            gl.deleteBuffer(this.buffer);\n        }\n        if (this.program) {\n            gl.deleteShader(this.program.fragmentShader);\n            gl.deleteShader(this.program.vertexShader);\n            gl.deleteProgram(this.program);\n        }\n        delete this.transformLoc;\n        delete this.gl;\n        return this;\n    }\n\n    stencilMask(mask) {\n        this.gl.stencilMask(mask);\n        return this;\n    }\n\n    stencilFunc(func, ref, mask) {\n        this.ref = ref;\n        this.gl.stencilFunc(func, ref, mask);\n        return this;\n    }\n\n    stencilOp(fail, zfail, zpass) {\n        this.gl.stencilOp(fail, zfail, zpass);\n        return this;\n    }\n\n    resetFunc() {\n        this.ref = 1;\n        this.gl.stencilFunc(this.gl.ALWAYS, 1, 0xFF);\n        return this;\n    }\n\n    _save() {\n        const gl = this.gl;\n        this._savedProgram = gl.program;\n    }\n\n    _restore() {\n        const gl = this.gl;\n        gl.program = this._savedProgram;\n        if (gl.program) {\n            gl.useProgram(gl.program);\n        }\n    }\n\n    _createBuffer() {\n        const gl = this.gl;\n        this.buffer = gl.createBuffer();\n        if (!this.buffer) {\n            throw new Error('Failed to create the buffer object');\n        }\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.buffer);\n        gl.bufferData(gl.ARRAY_BUFFER, this.quadVertices, gl.STATIC_DRAW);\n    }\n\n    _createProgram() {\n        const { program, vertexShader, fragmentShader }  = createProgram(this.gl, vert, frag);\n        program.vertexShader = vertexShader;\n        program.fragmentShader = fragmentShader;\n        this.program = program;\n    }\n\n}\n\nexport default QuadStencil;\n\nfunction getType(arr) {\n    if (arr instanceof Float32Array) {\n        return 'FLOAT';\n    } else if (arr instanceof Int16Array) {\n        return 'SHORT';\n    } else if (arr instanceof Uint16Array) {\n        return 'UNSIGNED_SHORT';\n    } else if (arr instanceof Int8Array) {\n        return 'BYTE';\n    } else if (arr instanceof Uint8Array || arr instanceof Uint8ClampedArray) {\n        return 'UNSIGNED_BYTE';\n    }\n    return 'FLOAT';\n}\n","import { isArrayHasData, pushIn } from '../../../core/util';\nimport CanvasRenderer from '../CanvasRenderer';\n\n/**\n * @classdesc\n * A parent renderer class for OverlayLayer to inherit by OverlayLayer's subclasses.\n * @protected\n * @memberOf renderer\n * @name OverlayLayerCanvasRenderer\n * @extends renderer.CanvasRenderer\n */\nclass OverlayLayerRenderer extends CanvasRenderer {\n\n    // possible memory leaks:\n    // 1. if geometries' symbols with external resources change frequently,\n    // resources of old symbols will still be stored.\n    // 2. removed geometries' resources won't be removed.\n    checkResources() {\n        let geometries = this._geosToCheck;\n        if (!this._resourceChecked && !geometries) {\n            geometries = this.layer._geoList;\n        }\n        if (!isArrayHasData(geometries)) {\n            return [];\n        }\n        const resources = [];\n        const cache = {};\n\n        for (let i = geometries.length - 1; i >= 0; i--) {\n            const geo = geometries[i];\n            const res = geo._getExternalResources();\n            if (!res.length) {\n                continue;\n            }\n            if (!this.resources) {\n                resources.push.apply(resources, res);\n            } else {\n                for (let i = 0; i < res.length; i++) {\n                    const url = res[i][0];\n                    if (!this.resources.isResourceLoaded(res[i]) && !cache[url]) {\n                        resources.push(res[i]);\n                        cache[url] = 1;\n                    }\n                }\n            }\n        }\n        this._resourceChecked = true;\n        delete this._geosToCheck;\n        return resources;\n    }\n\n    render() {\n        this.layer._sortGeometries();\n        return super.render.apply(this, arguments);\n    }\n\n    _addGeoToCheckRes(res) {\n        if (!res) {\n            return;\n        }\n        if (!Array.isArray(res)) {\n            res = [res];\n        }\n        if (!this._geosToCheck) {\n            this._geosToCheck = [];\n        }\n        pushIn(this._geosToCheck, res);\n    }\n\n    onGeometryAdd(geometries) {\n        this._addGeoToCheckRes(geometries);\n        redraw(this);\n    }\n\n    onGeometryRemove() {\n        redraw(this);\n    }\n\n    onGeometrySymbolChange(e) {\n        this._addGeoToCheckRes(e.target);\n        redraw(this);\n    }\n\n    onGeometryShapeChange() {\n        redraw(this);\n    }\n\n    onGeometryPositionChange() {\n        redraw(this);\n    }\n\n    onGeometryZIndexChange() {\n        redraw(this);\n    }\n\n    onGeometryShow() {\n        redraw(this);\n    }\n\n    onGeometryHide() {\n        redraw(this);\n    }\n\n    onGeometryPropertiesChange() {\n        redraw(this);\n    }\n}\n\nfunction redraw(renderer) {\n    if (renderer.layer.options['drawImmediate']) {\n        renderer.render();\n    }\n    renderer.setToRedraw();\n}\n\nexport default OverlayLayerRenderer;\n","import { getExternalResources } from '../../../core/util/resource';\nimport VectorLayer from '../../../layer/VectorLayer';\nimport OverlayLayerCanvasRenderer from './OverlayLayerCanvasRenderer';\nimport PointExtent from '../../../geo/PointExtent';\nimport Point from '../../../geo/Point';\nimport Marker from '../../../geometry/Marker';\n\nconst TEMP_EXTENT = new PointExtent();\n\n/**\n * @classdesc\n * Renderer class based on HTML5 Canvas2D for VectorLayers\n * @protected\n * @memberOf renderer\n * @name VectorLayerCanvasRenderer\n * @extends renderer.OverlaylayerCanvasRenderer\n * @param {VectorLayer} layer - layer to render\n */\nclass VectorLayerRenderer extends OverlayLayerCanvasRenderer {\n\n    checkResources() {\n        const resources = super.checkResources.apply(this, arguments);\n        let style = this.layer.getStyle();\n        if (style) {\n            if (!Array.isArray(style)) {\n                style = [style];\n            }\n            style.forEach(s => {\n                const res = getExternalResources(s['symbol'], true);\n                for (let i = 0, l = res.length; i < l; i++) {\n                    if (!this.resources.isResourceLoaded(res[i])) {\n                        resources.push(res[i]);\n                    }\n                }\n            });\n        }\n        return resources;\n    }\n\n    needToRedraw() {\n        const map = this.getMap();\n        if (map.isInteracting() && this.layer.options['enableAltitude']) {\n            return true;\n        }\n        // don't redraw when map is zooming without pitch and layer doesn't have any point symbolizer.\n        if (map.isZooming() && !map.isRotating() && !map.getPitch() && !this._hasPoint && this.layer.constructor === VectorLayer) {\n            return false;\n        }\n        return super.needToRedraw();\n    }\n\n    /**\n     * render layer\n     * @param  {Geometry[]} geometries   geometries to render\n     * @param  {Boolean} ignorePromise   whether escape step of promise\n     */\n    draw() {\n        if (!this.getMap()) {\n            return;\n        }\n        if (!this.layer.isVisible() || this.layer.isEmpty()) {\n            this.clearCanvas();\n            this.completeRender();\n            return;\n        }\n\n        this.prepareCanvas();\n\n        this.drawGeos();\n\n        this.completeRender();\n    }\n\n    isBlank() {\n        if (!this.context) {\n            return false;\n        }\n        return !this.context.canvas._drawn;\n    }\n\n    drawOnInteracting() {\n        if (!this._geosToDraw) {\n            return;\n        }\n        this._updateDisplayExtent();\n        this._sortMarkersOnZooming();\n        const markers = this._markersOnZooming;\n        for (let i = 0, l = this._geosToDraw.length; i < l; i++) {\n            const geo = this._geosToDraw[i];\n            if (!geo.isVisible()) {\n                continue;\n            }\n            if ((geo instanceof Marker) && markers && !markers[i]) {\n                continue;\n            }\n            geo._paint(this._displayExtent);\n        }\n    }\n\n    /**\n     * Show and render\n     * @override\n     */\n    show() {\n        this.layer.forEach(function (geo) {\n            geo._repaint();\n        });\n        super.show.apply(this, arguments);\n    }\n\n    forEachGeo(fn, context) {\n        this.layer.forEach(fn, context);\n    }\n\n    drawGeos() {\n        this._updateDisplayExtent();\n        this.prepareToDraw();\n\n        this.forEachGeo(this.checkGeo, this);\n        for (let i = 0, len = this._geosToDraw.length; i < len; i++) {\n            this._geosToDraw[i]._paint();\n        }\n    }\n\n    prepareToDraw() {\n        this._hasPoint = false;\n        this._geosToDraw = [];\n        this._markersToDraw = [];\n        this._markersIdx = [];\n    }\n\n    checkGeo(geo) {\n        if (!geo || !geo.isVisible() || !geo.getMap() ||\n            !geo.getLayer() || (!geo.getLayer().isCanvasRender())) {\n            return;\n        }\n\n        const painter = geo._getPainter();\n        const extent2D = painter.get2DExtent(this.resources, TEMP_EXTENT);\n        if (!extent2D || !extent2D.intersects(this._displayExtent)) {\n            return;\n        }\n        if (painter.hasPoint()) {\n            this._hasPoint = true;\n        }\n        this._geosToDraw.push(geo);\n        if (geo instanceof Marker) {\n            this._markersToDraw.push(this._geosToDraw.length - 1);\n        }\n    }\n\n    onZoomStart(zoom, origin) {\n        const map = this.getMap();\n        this._zoomOrigin = origin || new Point(map.width / 2, map.height / 2);\n        super.onZoomStart.apply(this, arguments);\n    }\n\n    onZoomEnd() {\n        delete this.canvasExtent2D;\n        delete this._markersOnZooming;\n        delete this._zoomOrigin;\n        super.onZoomEnd.apply(this, arguments);\n    }\n\n    onRemove() {\n        this.forEachGeo(function (g) {\n            g.onHide();\n        });\n        delete this._geosToDraw;\n    }\n\n    onGeometryPropertiesChange(param) {\n        if (param) {\n            this.layer._styleGeometry(param['target']);\n        }\n        super.onGeometryPropertiesChange(param);\n    }\n\n    _sortMarkersOnZooming() {\n        const map = this.getMap();\n        if (!this._isLimitMarkerOnZooming() || this._markersOnZooming) {\n            return;\n        }\n\n        const center = map.containerPointToCoord(this._zoomOrigin);\n\n        this._markersToDraw.sort((a, b) => {\n            const marker0 = this._geosToDraw[a];\n            const marker1 = this._geosToDraw[b];\n            return distanceTo(marker0.getCoordinates(), center) - distanceTo(marker1.getCoordinates(), center);\n        });\n        const limit = this.layer.options['markerLimitOnZooming'];\n        const sortedMarkers = this._markersOnZooming = {};\n        for (let i = 0; i < limit; i++) {\n            sortedMarkers[this._markersToDraw[i]] = 1;\n        }\n    }\n\n    _isLimitMarkerOnZooming() {\n        const map = this.getMap();\n        const limit = this.layer.options['markerLimitOnZooming'];\n        return map.isZooming() && this._zoomOrigin && limit > 0 && limit < this._markersToDraw.length;\n    }\n\n    _updateDisplayExtent() {\n        let extent2D = this.canvasExtent2D;\n        if (this._maskExtent) {\n            if (!this._maskExtent.intersects(extent2D)) {\n                this.completeRender();\n                return;\n            }\n            extent2D = extent2D.intersection(this._maskExtent);\n        }\n        this._displayExtent = extent2D;\n    }\n\n    identify(coordinate, options = {}) {\n        const geometries = this._geosToDraw;\n        if (!geometries) {\n            return [];\n        }\n        return this.layer._hitGeos(geometries, coordinate, options);\n    }\n}\n\nVectorLayer.registerRenderer('canvas', VectorLayerRenderer);\n\nexport default VectorLayerRenderer;\n\nfunction distanceTo(a, b) {\n    const x = a.x - b.x,\n        y = a.y - b.y;\n    return Math.sqrt(x * x + y * y);\n}\n","import { offsetDom } from '../../core/util/dom';\nimport Class from '../../core/Class';\nimport Point from '../../geo/Point';\n\n/**\n * @classdesc\n * Base class for all the map renderers.\n * @class\n * @abstract\n * @protected\n * @memberOf renderer\n * @extends {Class}\n */\nclass MapRenderer extends Class {\n\n    constructor(map) {\n        super();\n        this.map = map;\n        this._handlerQueue = {};\n    }\n\n    callInNextFrame(fn) {\n        this._handlerQueue.push(fn);\n    }\n\n    executeFrameCallbacks() {\n        const running = this._handlerQueue;\n        this._handlerQueue = [];\n        for (let i = 0, l = running.length; i < l; i++) {\n            running[i]();\n        }\n    }\n\n    /**\n     * Move map platform with offset\n     * @param  {Point} offset\n     * @return {this}\n     */\n    offsetPlatform(offset) {\n        if (!this.map._panels.front) {\n            return this;\n        }\n        if (offset.x === 0 && offset.y === 0) {\n            return this;\n        }\n        const pos = this.map.offsetPlatform().add(offset)._round();\n        const panels = this.map._panels;\n        offsetDom(panels.back, pos);\n        offsetDom(panels.front, pos);\n        return this;\n    }\n\n    resetContainer() {\n        if (!this.map) {\n            return;\n        }\n        this.map._resetMapViewPoint();\n        if (this.map._panels.front) {\n            const pos = new Point(0, 0);\n            offsetDom(this.map._panels.back, pos);\n            offsetDom(this.map._panels.front, pos);\n        }\n    }\n\n    onZoomEnd() {\n        this.resetContainer();\n    }\n\n    onLoad() {\n        this._frameLoop();\n    }\n}\n\nexport default MapRenderer;\n","import { IS_NODE, isNumber, isFunction, requestAnimFrame, cancelAnimFrame, equalMapView } from '../../core/util';\nimport { createEl, preventSelection, computeDomPosition, addDomEvent, removeDomEvent } from '../../core/util/dom';\nimport Browser from '../../core/Browser';\nimport Point from '../../geo/Point';\nimport Canvas2D from '../../core/Canvas';\nimport MapRenderer from './MapRenderer';\nimport Map from '../../map/Map';\n\n/**\n * @classdesc\n * Renderer class based on HTML5 Canvas for maps.\n * @class\n * @protected\n * @extends {renderer.MapRenderer}\n * @memberOf renderer\n */\nclass MapCanvasRenderer extends MapRenderer {\n    /**\n     * @param {Map} map - map for the renderer\n     */\n    constructor(map) {\n        super(map);\n        //container is a <canvas> element\n        this._containerIsCanvas = !!map._containerDOM.getContext;\n        this._registerEvents();\n        this._loopTime = 0;\n    }\n\n    load() {\n        this.initContainer();\n    }\n\n    /**\n     * render layers in current frame\n     * @return {Boolean} return false to cease frame loop\n     */\n    renderFrame(framestamp) {\n        if (!this.map) {\n            return false;\n        }\n        const map = this.map;\n        map._fireEvent('framestart');\n        this.updateMapDOM();\n        map.clearCollisionIndex();\n        const layers = this._getAllLayerToRender();\n        this.drawLayers(layers, framestamp);\n        this.drawLayerCanvas(layers);\n        // CAUTION: the order to fire frameend and layerload events\n        // fire frameend before layerload, reason:\n        // 1. frameend is often used internally by maptalks and plugins\n        // 2. layerload is often used externally by tests or user apps\n        map._fireEvent('frameend');\n        this._recordView();\n        // refresh map's state\n        // It must be before events and frame callback, because map state may be changed in callbacks.\n        this._mapview = this._getMapView();\n        delete this._spatialRefChanged;\n        this._fireLayerLoadEvents();\n        this.executeFrameCallbacks();\n        this._canvasUpdated = false;\n        return true;\n    }\n\n    updateMapDOM() {\n        const map = this.map;\n        // when map is zooming, container is being transformed with matrix, panel doesn't need to be moved.\n        if (map.isZooming()) {\n            return;\n        }\n        const offset = map._getViewPointFrameOffset();\n        if (offset) {\n            map.offsetPlatform(offset);\n        }\n    }\n\n    drawLayers(layers, framestamp) {\n        const map = this.map,\n            isInteracting = map.isInteracting(),\n            // all the visible canvas layers' ids.\n            canvasIds = [],\n            // all the updated canvas layers's ids.\n            updatedIds = [],\n            fps = map.options['fpsOnInteracting'] || 0,\n            timeLimit = fps === 0 ? 0 : 1000 / fps,\n            // time of layer drawing\n            layerLimit = this.map.options['layerCanvasLimitOnInteracting'],\n            l = layers.length;\n        const baseLayer = map.getBaseLayer();\n        let t = 0;\n        for (let i = 0; i < l; i++) {\n            const layer = layers[i];\n            if (!layer.isVisible()) {\n                continue;\n            }\n            const isCanvas = layer.isCanvasRender();\n            if (isCanvas) {\n                canvasIds.push(layer.getId());\n            }\n            const renderer = layer._getRenderer();\n            if (!renderer) {\n                continue;\n            }\n            // if need to call layer's draw/drawInteracting\n            const needsRedraw = this._checkLayerRedraw(layer);\n            if (isCanvas && renderer.isCanvasUpdated()) {\n                // don't need to call layer's draw/drawOnInteracting but need to redraw layer's updated canvas\n                if (!needsRedraw) {\n                    updatedIds.push(layer.getId());\n                }\n                this.setLayerCanvasUpdated();\n            }\n            const transformMatrix = renderer.__zoomTransformMatrix;\n            delete renderer.__zoomTransformMatrix;\n            if (!needsRedraw) {\n                if (isCanvas && isInteracting) {\n                    if (map.isZooming() && !map.getPitch()) {\n                        // transform layer's current canvas when zooming\n                        renderer.prepareRender();\n                        renderer.__zoomTransformMatrix = this._zoomMatrix;\n                    } else if (map.getPitch() || map.isRotating()) {\n                        // when map is pitching or rotating, clear the layer canvas\n                        // otherwise, leave layer's canvas unchanged\n                        renderer.clearCanvas();\n                    }\n                }\n                continue;\n            }\n\n            if (isInteracting && isCanvas) {\n                if (layerLimit > 0 && l - 1 - i > layerLimit && layer !== baseLayer) {\n                    layer._getRenderer().clearCanvas();\n                    continue;\n                }\n                t += this._drawCanvasLayerOnInteracting(layer, t, timeLimit, framestamp);\n            } else if (isInteracting && renderer.drawOnInteracting) {\n                // dom layers\n                if (renderer.prepareRender) {\n                    renderer.prepareRender();\n                }\n                renderer.drawOnInteracting(this._eventParam, framestamp);\n            } else {\n                // map is not interacting, call layer's render\n                renderer.render(framestamp);\n                //地图缩放完以后，如果下一次render需要载入资源，仍需要设置transformMatrix\n                //防止在资源载入完成之前，缺少transformMatrix导致的绘制错误\n                if (isCanvas && transformMatrix && renderer.isLoadingResource()) {\n                    renderer.__zoomTransformMatrix = transformMatrix;\n                }\n            }\n\n            if (isCanvas) {\n                updatedIds.push(layer.getId());\n                this.setLayerCanvasUpdated();\n            }\n        }\n        // compare:\n        // 1. previous drawn layers and current drawn layers\n        // 2. previous canvas layers and current canvas layers\n        // set map to redraw if either changed\n        const preCanvasIds = this._canvasIds || [];\n        const preUpdatedIds = this._updatedIds || [];\n        this._canvasIds = canvasIds;\n        this._updatedIds = updatedIds;\n        if (!this.isLayerCanvasUpdated()) {\n            const sep = '---';\n            if (preCanvasIds.join(sep) !== canvasIds.join(sep) || preUpdatedIds.join(sep) !== updatedIds.join(sep)) {\n                this.setLayerCanvasUpdated();\n            }\n        }\n    }\n\n    /**\n     * check if need to call layer's draw/drawInteracting\n     * @param  {Layer} layer\n     * @return {Boolean}\n     */\n    _checkLayerRedraw(layer) {\n        if (this.isSpatialReferenceChanged()) {\n            return true;\n        }\n        const map = this.map;\n        const renderer = layer._getRenderer();\n        if (layer.isCanvasRender()) {\n            return renderer.testIfNeedRedraw();\n        } else {\n            if (renderer.needToRedraw && renderer.needToRedraw()) {\n                return true;\n            }\n            // dom layers, redraw it if map is interacting or state is changed\n            return map.isInteracting() || this.isViewChanged();\n        }\n    }\n\n    /**\n     * Draw canvas rendered layer when map is interacting\n     * @param  {Layer} layer\n     * @param  {Number} t     current consumed time of layer drawing\n     * @param  {Number} timeLimit time limit for layer drawing\n     * @return {Number}       time to draw this layer\n     * @private\n     */\n    _drawCanvasLayerOnInteracting(layer, t, timeLimit, framestamp) {\n        const map = this.map,\n            renderer = layer._getRenderer(),\n            drawTime = renderer.getDrawTime(),\n            inTime = timeLimit === 0 || timeLimit > 0 && t + drawTime <= timeLimit;\n        if (renderer.mustRenderOnInteracting && renderer.mustRenderOnInteracting()) {\n            renderer.render(framestamp);\n        } else if (renderer.drawOnInteracting &&\n            (layer === map.getBaseLayer() || inTime ||\n            map.isZooming() && layer.options['forceRenderOnZooming'] ||\n            map.isMoving() && layer.options['forceRenderOnMoving'] ||\n            map.isRotating() && layer.options['forceRenderOnRotating'])\n        ) {\n            // call drawOnInteracting to redraw the layer\n            renderer.prepareRender();\n            renderer.prepareCanvas();\n            renderer.drawOnInteracting(this._eventParam, framestamp);\n            return drawTime;\n        } else if (map.isZooming() && !map.getPitch() && !map.isRotating()) {\n            // when:\n            // 1. layer's renderer doesn't have drawOnInteracting\n            // 2. timeLimit is exceeded\n            // then:\n            // transform layer's current canvas when zooming\n            renderer.prepareRender();\n            renderer.__zoomTransformMatrix = this._zoomMatrix;\n        } else if (map.getPitch() || map.isRotating()) {\n            // when map is pitching or rotating, clear the layer canvas\n            // otherwise, leave layer's canvas unchanged\n            renderer.clearCanvas();\n        }\n        if (renderer.drawOnInteracting && !inTime) {\n            renderer.onSkipDrawOnInteracting(this._eventParam, framestamp);\n        }\n        return 0;\n    }\n\n    /**\n     * Fire layerload events.\n     * Make sure layer are drawn on map when firing the events\n     * @private\n     */\n    _fireLayerLoadEvents() {\n        if (this._updatedIds && this._updatedIds.length > 0) {\n            const map = this.map;\n            //firing order as FIFO, painting as FILO, so the order needs to be reversed\n            this._updatedIds.reverse().forEach(id => {\n                const layer = map.getLayer(id);\n                if (!layer) {\n                    return;\n                }\n                const renderer = layer._getRenderer();\n                if (!renderer || !renderer.isRenderComplete()) {\n                    return;\n                }\n                /**\n                 * layerload event, fired when layer is loaded.\n                 *\n                 * @event Layer#layerload\n                 * @type {Object}\n                 * @property {String} type - layerload\n                 * @property {Layer} target - layer\n                 */\n                layer.fire('layerload');\n            });\n        }\n\n    }\n\n    isLayerCanvasUpdated() {\n        return this._canvasUpdated;\n    }\n\n    setLayerCanvasUpdated() {\n        this._canvasUpdated = true;\n    }\n\n    /**\n     * Renders the layers\n     */\n    drawLayerCanvas(layers) {\n        const map = this.map;\n        if (!map) {\n            return;\n        }\n        if (!this.isLayerCanvasUpdated() && !this.isViewChanged()) {\n            return;\n        }\n        if (!this.canvas) {\n            this.createCanvas();\n        }\n\n        /**\n         * renderstart event, an event fired when map starts to render.\n         * @event Map#renderstart\n         * @type {Object}\n         * @property {String} type           - renderstart\n         * @property {Map} target            - the map fires event\n         * @property {CanvasRenderingContext2D} context  - canvas context\n         */\n        map._fireEvent('renderstart', {\n            'context': this.context\n        });\n\n        if (!this._updateCanvasSize()) {\n            this.clearCanvas();\n        }\n\n        const interacting = map.isInteracting(),\n            limit = map.options['layerCanvasLimitOnInteracting'];\n        let len = layers.length;\n\n        let baseLayerImage;\n        const images = [];\n        for (let i = 0; i < len; i++) {\n            if (!layers[i].isVisible() || !layers[i].isCanvasRender()) {\n                continue;\n            }\n            const renderer = layers[i]._getRenderer();\n            if (!renderer) {\n                continue;\n            }\n            const layerImage = this._getLayerImage(layers[i]);\n            if (layerImage && layerImage['image']) {\n                if (layers[i] === map.getBaseLayer()) {\n                    baseLayerImage = [layers[i], layerImage];\n                } else {\n                    images.push([layers[i], layerImage]);\n                }\n            }\n        }\n\n        if (baseLayerImage) {\n            this._drawLayerCanvasImage(baseLayerImage[0], baseLayerImage[1]);\n            this._drawFog();\n        }\n\n        len = images.length;\n        const start = interacting && limit >= 0 && len > limit ? len - limit : 0;\n        for (let i = start; i < len; i++) {\n            this._drawLayerCanvasImage(images[i][0], images[i][1]);\n        }\n\n\n        this._drawCenterCross();\n        /**\n         * renderend event, an event fired when map ends rendering.\n         * @event Map#renderend\n         * @type {Object}\n         * @property {String} type                      - renderend\n         * @property {Map} target              - the map fires event\n         * @property {CanvasRenderingContext2D} context - canvas context\n         */\n        map._fireEvent('renderend', {\n            'context': this.context\n        });\n    }\n\n    setToRedraw() {\n        const layers = this._getAllLayerToRender();\n        for (let i = 0, l = layers.length; i < l; i++) {\n            const renderer = layers[i].getRenderer();\n            if (renderer && renderer.canvas && renderer.setToRedraw) {\n                //to fix lost webgl context\n                renderer.setToRedraw();\n            }\n        }\n    }\n\n    updateMapSize(size) {\n        if (!size || this._containerIsCanvas) {\n            return;\n        }\n        const width = size['width'] + 'px',\n            height = size['height'] + 'px';\n        const panels = this.map._panels;\n        panels.mapWrapper.style.width = width;\n        panels.mapWrapper.style.height = height;\n        this._updateCanvasSize();\n    }\n\n    getMainPanel() {\n        if (!this.map) {\n            return null;\n        }\n        if (this._containerIsCanvas) {\n            return this.map._containerDOM;\n        }\n        if (this.map._panels) {\n            return this.map._panels.mapWrapper;\n        }\n        return null;\n    }\n\n    toDataURL(mimeType) {\n        if (!this.canvas) {\n            return null;\n        }\n        return this.canvas.toDataURL(mimeType);\n    }\n\n    remove() {\n        if (Browser.webgl && typeof document !== 'undefined') {\n            removeDomEvent(document, 'visibilitychange', this._onVisibilitychange, this);\n        }\n        if (this._resizeInterval) {\n            clearInterval(this._resizeInterval);\n        }\n        delete this.context;\n        delete this.canvas;\n        delete this.map;\n        delete this._spatialRefChanged;\n        this._cancelFrameLoop();\n    }\n\n    hitDetect(point) {\n        const map = this.map;\n        if (!map || !map.options['hitDetect'] || map.isInteracting()) {\n            return;\n        }\n        const layers = map._getLayers();\n        let cursor = 'default';\n        const limit = map.options['hitDetectLimit'] || 0;\n        let counter = 0;\n        for (let i = layers.length - 1; i >= 0; i--) {\n            const layer = layers[i];\n            if (layer.isEmpty && layer.isEmpty()) {\n                continue;\n            }\n            const renderer = layer._getRenderer();\n            if (!renderer || !renderer.hitDetect) {\n                continue;\n            }\n            if (renderer.isBlank && renderer.isBlank()) {\n                continue;\n            }\n            if (layer.options['cursor'] !== 'default' && renderer.hitDetect(point)) {\n                cursor = layer.options['cursor'] || 'pointer';\n                break;\n            }\n            counter++;\n            if (limit > 0 && counter > limit) {\n                break;\n            }\n        }\n\n        map._trySetCursor(cursor);\n    }\n\n    _getLayerImage(layer) {\n        const renderer = layer._getRenderer();\n        if (renderer.getCanvasImage) {\n            return renderer.getCanvasImage();\n        }\n        return null;\n    }\n\n    /**\n     * initialize container DOM of panels\n     */\n    initContainer() {\n        const panels = this.map._panels;\n\n        function createContainer(name, className, cssText, enableSelect) {\n            const c = createEl('div', className);\n            if (cssText) {\n                c.style.cssText = cssText;\n            }\n            panels[name] = c;\n            if (!enableSelect) {\n                preventSelection(c);\n            }\n            return c;\n        }\n        const containerDOM = this.map._containerDOM;\n\n        if (this._containerIsCanvas) {\n            //container is a <canvas> element.\n            return;\n        }\n\n        containerDOM.innerHTML = '';\n\n        const POSITION0 = 'position:absolute;top:0px;left:0px;';\n\n        const mapWrapper = createContainer('mapWrapper', 'maptalks-wrapper', 'position:absolute;overflow:hidden;', true),\n            mapAllLayers = createContainer('allLayers', 'maptalks-all-layers', POSITION0 + 'padding:0px;margin:0px;z-index:0;overflow:visible;', true),\n            backStatic = createContainer('backStatic', 'maptalks-back-static', POSITION0 + 'z-index:0;', true),\n            back = createContainer('back', 'maptalks-back', POSITION0 + 'z-index:1;'),\n            backLayer = createContainer('backLayer', 'maptalks-back-layer', POSITION0),\n            canvasContainer = createContainer('canvasContainer', 'maptalks-canvas-layer', POSITION0 + 'border:none;z-index:2;'),\n            frontStatic = createContainer('frontStatic', 'maptalks-front-static', POSITION0 + 'z-index:3;', true),\n            front = createContainer('front', 'maptalks-front', POSITION0 + 'z-index:4;', true),\n            frontLayer = createContainer('frontLayer', 'maptalks-front-layer', POSITION0 + 'z-index:0;'),\n            // children's zIndex in frontLayer will be set by map.addLayer, ui container's z-index is set to 10000 to make sure it's always on the top.\n            ui = createContainer('ui', 'maptalks-ui', POSITION0 + 'border:none;z-index:1;', true),\n            control = createContainer('control', 'maptalks-control', 'z-index:1', true);\n\n        containerDOM.appendChild(mapWrapper);\n\n        mapAllLayers.appendChild(backStatic);\n        back.appendChild(backLayer);\n        mapAllLayers.appendChild(back);\n        mapAllLayers.appendChild(canvasContainer);\n        front.appendChild(frontLayer);\n        mapAllLayers.appendChild(frontStatic);\n        mapAllLayers.appendChild(front);\n        front.appendChild(ui);\n\n        mapWrapper.appendChild(mapAllLayers);\n        mapWrapper.appendChild(control);\n\n        this.createCanvas();\n\n        this.resetContainer();\n        const mapSize = this.map._getContainerDomSize();\n        this.updateMapSize(mapSize);\n    }\n\n    /**\n     * Is current map's state changed?\n     * @return {Boolean}\n     */\n    isViewChanged() {\n        const previous = this._mapview;\n        const view = this._getMapView();\n        if (!previous || !equalMapView(previous, view)) {\n            return true;\n        }\n        return false;\n    }\n\n    _recordView() {\n        const map = this.map;\n        if (!map._onViewChange || map.isInteracting() || map.isAnimating()) {\n            return;\n        }\n        if (!equalMapView(map.getView(), map._getCurrentView())) {\n            map._onViewChange(map.getView());\n        }\n    }\n\n    isSpatialReferenceChanged() {\n        return this._spatialRefChanged;\n    }\n\n    _getMapView() {\n        const map = this.map;\n        const center = map._getPrjCenter();\n        return {\n            x       : center.x,\n            y       : center.y,\n            zoom    : map.getZoom(),\n            pitch   : map.getPitch(),\n            bearing : map.getBearing(),\n            width   : map.width,\n            height  : map.height\n        };\n    }\n\n    /**\n    * Main frame loop\n    */\n    _frameLoop(framestamp) {\n        if (!this.map) {\n            this._cancelFrameLoop();\n            return;\n        }\n        this.renderFrame(framestamp);\n        // Keep registering ourselves for the next animation frame\n        this._animationFrame = requestAnimFrame((framestamp) => { this._frameLoop(framestamp); });\n    }\n\n    _cancelFrameLoop() {\n        if (this._animationFrame) {\n            cancelAnimFrame(this._animationFrame);\n        }\n    }\n\n    _drawLayerCanvasImage(layer, layerImage) {\n        const ctx = this.context;\n        const point = layerImage['point'].round();\n        const dpr = this.map.getDevicePixelRatio();\n        if (dpr !== 1) {\n            point._multi(dpr);\n        }\n        const canvasImage = layerImage['image'];\n        const width = canvasImage.width, height = canvasImage.height;\n        if (point.x + width <= 0 || point.y + height <= 0) {\n            return;\n        }\n        //opacity of the layer image\n        let op = layer.options['opacity'];\n        if (!isNumber(op)) {\n            op = 1;\n        }\n        if (op <= 0) {\n            return;\n        }\n        let imgOp = layerImage['opacity'];\n        if (!isNumber(imgOp)) {\n            imgOp = 1;\n        }\n        if (imgOp <= 0) {\n            return;\n        }\n        const alpha = ctx.globalAlpha;\n\n        if (op < 1) {\n            ctx.globalAlpha *= op;\n        }\n        if (imgOp < 1) {\n            ctx.globalAlpha *= imgOp;\n        }\n        if (layer.options['cssFilter']) {\n            ctx.filter = layer.options['cssFilter'];\n        }\n        const renderer = layer.getRenderer();\n        const matrix = renderer.__zoomTransformMatrix;\n        const clipped = renderer.clipCanvas(this.context);\n        if (matrix) {\n            ctx.save();\n            ctx.setTransform.apply(ctx, matrix);\n        }\n\n        /*let outlineColor = layer.options['debugOutline'];\n        if (outlineColor) {\n            if (outlineColor === true) {\n                outlineColor = '#0f0';\n            }\n            this.context.strokeStyle = outlineColor;\n            this.context.fillStyle = outlineColor;\n            this.context.lineWidth = 10;\n            Canvas2D.rectangle(ctx, point.x, point.y, layerImage.size, 1, 0);\n            ctx.fillText([layer.getId(), point.toArray().join(), layerImage.size.toArray().join(), canvasImage.width + ',' + canvasImage.height].join(' '),\n                point.x + 18, point.y + 18);\n        }*/\n\n        ctx.drawImage(canvasImage, 0, 0, width, height, point.x, point.y, width, height);\n        if (matrix) {\n            ctx.restore();\n        }\n        if (clipped) {\n            ctx.restore();\n        }\n        if (ctx.filter !== 'none') {\n            ctx.filter = 'none';\n        }\n        ctx.globalAlpha = alpha;\n    }\n\n    _drawCenterCross() {\n        const cross = this.map.options['centerCross'];\n        if (cross) {\n            const ctx = this.context;\n            const p = new Point(this.canvas.width / 2, this.canvas.height / 2);\n            if (isFunction(cross)) {\n                cross(ctx, p);\n            } else {\n                Canvas2D.drawCross(this.context, p.x, p.y, 2, '#f00');\n            }\n        }\n    }\n\n    _drawFog() {\n        const map = this.map;\n        if (map.getPitch() <= map.options['maxVisualPitch'] || !map.options['fog']) {\n            return;\n        }\n        const fogThickness = 30;\n        const r = map.getDevicePixelRatio();\n        const ctx = this.context,\n            clipExtent = map.getContainerExtent();\n        let top = (map.height - map._getVisualHeight(75)) * r;\n        if (top < 0) top = 0;\n        const bottom = clipExtent.ymin * r,\n            h = Math.ceil(bottom - top),\n            color = map.options['fogColor'].join();\n        const gradient = ctx.createLinearGradient(0, top, 0, bottom + fogThickness);\n        const landscape = 1 - fogThickness / (h + fogThickness);\n        gradient.addColorStop(0, `rgba(${color}, 0)`);\n        gradient.addColorStop(0.3, `rgba(${color}, 0.3)`);\n        gradient.addColorStop(landscape, `rgba(${color}, 1)`);\n        gradient.addColorStop(1, `rgba(${color}, 0)`);\n        ctx.beginPath();\n        ctx.fillStyle = gradient;\n        ctx.fillRect(0, top, Math.ceil(clipExtent.getWidth()) * r, Math.ceil(h + fogThickness));\n    }\n\n    _getAllLayerToRender() {\n        return this.map._getLayers();\n    }\n\n    clearCanvas() {\n        if (!this.canvas) {\n            return;\n        }\n        Canvas2D.clearRect(this.context, 0, 0, this.canvas.width, this.canvas.height);\n    }\n\n    _updateCanvasSize() {\n        if (!this.canvas || this._containerIsCanvas) {\n            return false;\n        }\n        const map = this.map,\n            mapSize = map.getSize(),\n            canvas = this.canvas,\n            r = map.getDevicePixelRatio();\n        if (mapSize['width'] * r === canvas.width && mapSize['height'] * r === canvas.height) {\n            return false;\n        }\n        //retina屏支持\n\n        canvas.height = r * mapSize['height'];\n        canvas.width = r * mapSize['width'];\n        if (canvas.style) {\n            canvas.style.width = mapSize['width'] + 'px';\n            canvas.style.height = mapSize['height'] + 'px';\n        }\n\n        return true;\n    }\n\n    createCanvas() {\n        if (this._containerIsCanvas) {\n            this.canvas = this.map._containerDOM;\n        } else {\n            this.canvas = createEl('canvas');\n            this._updateCanvasSize();\n            this.map._panels.canvasContainer.appendChild(this.canvas);\n        }\n        this.context = this.canvas.getContext('2d');\n    }\n\n    _checkSize() {\n        if (!this.map || this.map.isInteracting()) {\n            return;\n        }\n        // refresh map's dom position\n        computeDomPosition(this.map._containerDOM);\n        this.map.checkSize();\n    }\n\n    _setCheckSizeInterval(interval) {\n        clearInterval(this._resizeInterval);\n        this._checkSizeInterval = interval;\n        this._resizeInterval = setInterval(() => {\n            if (!this.map || this.map.isRemoved()) {\n                //is deleted\n                clearInterval(this._resizeInterval);\n            } else {\n                this._checkSize();\n            }\n        }, this._checkSizeInterval);\n    }\n\n    _registerEvents() {\n        const map = this.map;\n\n        if (map.options['checkSize'] && !IS_NODE && (typeof window !== 'undefined')) {\n            this._setCheckSizeInterval(map.options['checkSizeInterval']);\n        }\n        if (!Browser.mobile) {\n            map.on('_mousemove', this._onMapMouseMove, this);\n        }\n\n        map.on('_dragrotatestart _dragrotating _dragrotateend _movestart _moving _moveend _zoomstart', (param) => {\n            this._eventParam = param;\n        });\n\n        map.on('_zooming', (param) => {\n            if (!map.getPitch()) {\n                this._zoomMatrix = param['matrix']['container'];\n            }\n            this._eventParam = param;\n        });\n\n        map.on('_zoomend', (param) => {\n            this._eventParam = param;\n            delete this._zoomMatrix;\n        });\n\n        map.on('_spatialreferencechange', () => {\n            this._spatialRefChanged = true;\n        });\n\n        if (Browser.webgl && typeof document !== 'undefined') {\n            addDomEvent(document, 'visibilitychange', this._onVisibilitychange, this);\n        }\n    }\n\n    _onMapMouseMove(param) {\n        const map = this.map;\n        if (map.isInteracting() || !map.options['hitDetect']) {\n            return;\n        }\n        if (this._hitDetectFrame) {\n            cancelAnimFrame(this._hitDetectFrame);\n        }\n        this._hitDetectFrame = requestAnimFrame(() => {\n            this.hitDetect(param['containerPoint']);\n        });\n    }\n\n    _getCanvasLayers() {\n        return this.map._getLayers(layer => layer.isCanvasRender());\n    }\n\n    _onVisibilitychange() {\n        if (document.visibilityState !== 'visible') {\n            return;\n        }\n        this.setToRedraw();\n    }\n}\n\nMap.registerRenderer('canvas', MapCanvasRenderer);\n\nMap.mergeOptions({\n    'fog' : true,\n    'fogColor' : [233, 233, 233]\n});\n\nexport default MapCanvasRenderer;\n","import Marker from '../../geometry/Marker';\nimport Ellipse from '../../geometry/Ellipse';\nimport Circle from '../../geometry/Circle';\nimport Sector from '../../geometry/Sector';\nimport Rectangle from '../../geometry/Rectangle';\nimport LineString from '../../geometry/LineString';\nimport Polygon from '../../geometry/Polygon';\n\n// 有中心点的图形的共同方法\nconst CenterPointRenderer = {\n    _getRenderPoints() {\n        return [[this._getCenter2DPoint(this.getMap().getGLZoom())], null];\n    }\n};\n\n/**\n * 获取symbolizer所需的数据\n */\nMarker.include(CenterPointRenderer);\n\nEllipse.include(CenterPointRenderer);\n\nCircle.include(CenterPointRenderer);\n//----------------------------------------------------\nSector.include(CenterPointRenderer);\n//----------------------------------------------------\nRectangle.include({\n    _getRenderPoints(placement) {\n        const map = this.getMap();\n        if (placement === 'vertex') {\n            const shell = this._trimRing(this.getShell());\n            const points = [];\n            for (let i = 0, len = shell.length; i < len; i++) {\n                points.push(map.coordToPoint(shell[i], map.getGLZoom()));\n            }\n            return [points, null];\n        } else {\n            const c = map.coordToPoint(this.getCenter(), map.getGLZoom());\n            return [\n                [c], null\n            ];\n        }\n    }\n});\n\n//----------------------------------------------------\nconst PolyRenderer = {\n    _getRenderPoints(placement) {\n        const map = this.getMap();\n        const glZoom = map.getGLZoom();\n        let points, rotations = null;\n        if (placement === 'point') {\n            points = this._getPath2DPoints(this._getPrjCoordinates(), false, glZoom);\n            if (points && points.length > 0 && Array.isArray(points[0])) {\n                //anti-meridian\n                points = points[0].concat(points[1]);\n            }\n        } else if (placement === 'vertex') {\n            points = this._getPath2DPoints(this._getPrjCoordinates(), false, glZoom);\n            rotations = [];\n            if (points && points.length > 0 && Array.isArray(points[0])) {\n                for (let i = 0, l = points.length; i < l; i++) {\n                    for (let ii = 0, ll = points[i].length; ii < ll; ii++) {\n                        if (ii === 0) {\n                            rotations.push([points[i][ii], points[i][ii + 1]]);\n                        } else {\n                            rotations.push([points[i][ii - 1], points[i][ii]]);\n                        }\n                    }\n                }\n                points = points[0].concat(points[1]);\n            } else {\n                for (let i = 0, l = points.length; i < l; i++) {\n                    if (i === 0) {\n                        rotations.push([points[i], points[i + 1]]);\n                    } else {\n                        rotations.push([points[i - 1], points[i]]);\n                    }\n                }\n            }\n        } else if (placement === 'line') {\n            points = [];\n            rotations = [];\n            const vertice = this._getPath2DPoints(this._getPrjCoordinates(), false, glZoom),\n                isSplitted =  vertice.length > 0 && Array.isArray(vertice[0]);\n            if (isSplitted) {\n                //anti-meridian splitted\n                let ring;\n                for (let i = 1, l = vertice.length; i < l; i++) {\n                    ring = vertice[i];\n                    if (this instanceof Polygon && ring.length > 0 && !ring[0].equals(ring[ring.length - 1])) {\n                        ring.push(ring[0]);\n                    }\n                    for (let ii = 1, ll = ring.length; ii < ll; ii++) {\n                        points.push(ring[ii].add(ring[ii - 1])._multi(0.5));\n                        rotations.push([ring[ii - 1], ring[ii]]);\n                    }\n                }\n            } else {\n                if (this instanceof Polygon && vertice.length > 0 && !vertice[0].equals(vertice[vertice.length - 1])) {\n                    vertice.push(vertice[0]);\n                }\n                for (let i = 1, l = vertice.length; i < l; i++) {\n                    points.push(vertice[i].add(vertice[i - 1])._multi(0.5));\n                    rotations.push([vertice[i - 1], vertice[i]]);\n                }\n            }\n\n        } else if (placement === 'vertex-first') {\n            const coords = this._getPrjCoordinates();\n            points = coords.length ? [map._prjToPoint(coords[0], glZoom)] : [];\n            rotations = coords.length ? [[map._prjToPoint(coords[0], glZoom), map._prjToPoint(coords[1], glZoom)]] : [];\n        } else if (placement === 'vertex-last') {\n            const coords = this._getPrjCoordinates();\n            const l = coords.length;\n            points = l ? [map._prjToPoint(coords[l - 1], glZoom)] : [];\n            const current = l - 1,\n                previous = l > 1 ? l - 2 : l - 1;\n            rotations = l ? [[map._prjToPoint(coords[previous], glZoom), map._prjToPoint(coords[current], glZoom)]] : [];\n        } else {\n            const pcenter = this._getProjection().project(this.getCenter());\n            points = [map._prjToPoint(pcenter, glZoom)];\n        }\n        return [points, rotations];\n    }\n};\n\nLineString.include(PolyRenderer);\n\nPolygon.include(PolyRenderer);\n","import { pushIn, isNumber } from '../../core/util';\nimport Size from '../../geo/Size';\nimport Point from '../../geo/Point';\nimport Canvas from '../../core/Canvas';\nimport Geometry from '../../geometry/Geometry';\nimport Ellipse from '../../geometry/Ellipse';\nimport Circle from '../../geometry/Circle';\nimport Sector from '../../geometry/Sector';\nimport Rectangle from '../../geometry/Rectangle';\nimport Path from '../../geometry/Path';\nimport LineString from '../../geometry/LineString';\nimport Polygon from '../../geometry/Polygon';\n\nGeometry.include({\n    _redrawWhenPitch: () => false,\n\n    _redrawWhenRotate: () => false\n});\n\nconst el = {\n    _redrawWhenPitch: () => true,\n\n    _redrawWhenRotate: function () {\n        return (this instanceof Ellipse) || (this instanceof Sector);\n    },\n\n    _paintAsPath: function () {\n        const map = this.getMap();\n        const altitude = this._getPainter().getAltitude();\n        // when map is tilting, draw the circle/ellipse as a polygon by vertexes.\n        return altitude > 0 || map.getPitch() || ((this instanceof Ellipse) && map.getBearing());\n    },\n\n    _getPaintParams() {\n        const map = this.getMap();\n        if (this._paintAsPath()) {\n            return Polygon.prototype._getPaintParams.call(this, true);\n        }\n        const pcenter = this._getPrjCoordinates();\n        const pt = map._prjToPoint(pcenter, map.getGLZoom());\n        const size = this._getRenderSize();\n        return [pt, size['width'], size['height']];\n    },\n\n    _paintOn: function () {\n        if (this._paintAsPath()) {\n            return Canvas.polygon.apply(Canvas, arguments);\n        } else {\n            return Canvas.ellipse.apply(Canvas, arguments);\n        }\n    },\n\n    _getRenderSize() {\n        const map = this.getMap(),\n            z = map.getGLZoom();\n        const prjExtent = this._getPrjExtent();\n        const pmin = map._prjToPoint(prjExtent.getMin(), z),\n            pmax = map._prjToPoint(prjExtent.getMax(), z);\n        return new Size(Math.abs(pmax.x - pmin.x) / 2, Math.abs(pmax.y - pmin.y) / 2);\n    }\n};\n\nEllipse.include(el);\n\nCircle.include(el);\n//----------------------------------------------------\nRectangle.include({\n    _getPaintParams() {\n        const map = this.getMap();\n        const pointZoom = map.getGLZoom();\n        const shell = this._getPrjShell();\n        const points = this._getPath2DPoints(shell, false, pointZoom);\n        return [points];\n    },\n\n    _paintOn: Canvas.polygon\n});\n//----------------------------------------------------\nSector.include(el, {\n    _redrawWhenPitch: () => true,\n\n    _getPaintParams() {\n        if (this._paintAsPath()) {\n            return Polygon.prototype._getPaintParams.call(this, true);\n        }\n        const map = this.getMap();\n        const pt = map._prjToPoint(this._getPrjCoordinates(), map.getGLZoom());\n        const size = this._getRenderSize();\n        return [pt, size['width'],\n            [this.getStartAngle(), this.getEndAngle()]\n        ];\n    },\n\n    _paintOn: function () {\n        if (this._paintAsPath()) {\n            return Canvas.polygon.apply(Canvas, arguments);\n        } else {\n            const r = this.getMap().getBearing();\n            const args = arguments;\n            if (r) {\n                args[3] = args[3].slice(0);\n                args[3][0] += r;\n                args[3][1] += r;\n            }\n            return Canvas.sector.apply(Canvas, args);\n        }\n    }\n\n});\n//----------------------------------------------------\nPath.include({\n    _paintAsPath: () => true\n});\n\n\nLineString.include({\n\n    arrowStyles: {\n        'classic': [3, 4]\n    },\n\n    _getArrowShape(prePoint, point, lineWidth, arrowStyle, tolerance) {\n        if (!tolerance) {\n            tolerance = 0;\n        }\n        const width = lineWidth * arrowStyle[0],\n            height = lineWidth * arrowStyle[1] + tolerance,\n            hw = width / 2 + tolerance;\n\n        let normal;\n        if (point.nextCtrlPoint || point.prevCtrlPoint) {\n            // use control points to caculate normal if it's a bezier curve\n            if (point.prevCtrlPoint) {\n                normal = point.sub(new Point(point.prevCtrlPoint));\n            } else {\n                normal = point.sub(new Point(point.nextCtrlPoint));\n            }\n        } else {\n            normal = point.sub(prePoint);\n        }\n        normal._unit();\n        const p1 = point.sub(normal.multi(height));\n        normal._perp();\n        const p0 = p1.add(normal.multi(hw));\n        normal._multi(-1);\n        const p2 = p1.add(normal.multi(hw));\n        return [p0, point, p2, p0];\n    },\n\n    _getPaintParams() {\n        const prjVertexes = this._getPrjCoordinates();\n        const points = this._getPath2DPoints(prjVertexes, false, this.getMap().getGLZoom());\n        return [points];\n    },\n\n    _paintOn(ctx, points, lineOpacity, fillOpacity, dasharray) {\n        if (this.options['smoothness']) {\n            Canvas.paintSmoothLine(ctx, points, lineOpacity, this.options['smoothness'], false, this._animIdx, this._animTailRatio);\n        } else {\n            Canvas.path(ctx, points, lineOpacity, null, dasharray);\n        }\n        this._paintArrow(ctx, points, lineOpacity);\n    },\n\n    _getArrowPlacement() {\n        return this.options['arrowPlacement'];\n    },\n\n    _getArrowStyle() {\n        const arrowStyle = this.options['arrowStyle'];\n        if (arrowStyle) {\n            return Array.isArray(arrowStyle) ? arrowStyle : this.arrowStyles[arrowStyle];\n        }\n        return null;\n    },\n\n    _getArrows(points, lineWidth, tolerance) {\n        const arrowStyle = this._getArrowStyle();\n        if (!arrowStyle || points.length < 2) {\n            return [];\n        }\n        const isSplitted = points.length > 0 && Array.isArray(points[0]);\n        const segments = isSplitted ? points : [points];\n        const placement = this._getArrowPlacement();\n        const arrows = [];\n        const map = this.getMap(),\n            first = map.coordToContainerPoint(this.getFirstCoordinate()),\n            last = map.coordToContainerPoint(this.getLastCoordinate());\n        for (let i = segments.length - 1; i >= 0; i--) {\n            if (placement === 'vertex-first' || placement === 'vertex-firstlast' && segments[i][0].closeTo(first, 0.01)) {\n                arrows.push(this._getArrowShape(segments[i][1], segments[i][0], lineWidth, arrowStyle, tolerance));\n            }\n            if (placement === 'vertex-last' || placement === 'vertex-firstlast' && segments[i][segments[i].length - 1].closeTo(last, 0.01)) {\n                arrows.push(this._getArrowShape(segments[i][segments[i].length - 2], segments[i][segments[i].length - 1], lineWidth, arrowStyle, tolerance));\n            } else if (placement === 'point') {\n                this._getArrowPoints(arrows, segments[i], lineWidth, arrowStyle, tolerance);\n            }\n        }\n        return arrows;\n    },\n\n    _getArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance) {\n        for (let ii = 0, ll = segments.length - 1; ii < ll; ii++) {\n            arrows.push(this._getArrowShape(segments[ii], segments[ii + 1], lineWidth, arrowStyle, tolerance));\n        }\n    },\n\n    _paintArrow(ctx, points, lineOpacity) {\n        let lineWidth = this._getInternalSymbol()['lineWidth'];\n        if (!isNumber(lineWidth) || lineWidth < 3) {\n            lineWidth = 3;\n        }\n        const arrows = this._getArrows(points, lineWidth);\n        if (!arrows.length) {\n            return;\n        }\n        if (ctx.setLineDash) {\n            //remove line dash effect if any\n            ctx.setLineDash([]);\n        }\n        for (let i = arrows.length - 1; i >= 0; i--) {\n            ctx.fillStyle = ctx.strokeStyle;\n            Canvas.polygon(ctx, arrows[i], lineOpacity, lineOpacity);\n        }\n    }\n});\n\nPolygon.include({\n    _getPaintParams(disableSimplify) {\n        const maxZoom = this.getMap().getGLZoom();\n        const prjVertexes = this._getPrjShell();\n        let points = this._getPath2DPoints(prjVertexes, disableSimplify, maxZoom);\n        //splitted by anti-meridian\n        const isSplitted = points.length > 0 && Array.isArray(points[0]);\n        if (isSplitted) {\n            points = [\n                [points[0]],\n                [points[1]]\n            ];\n        }\n        const prjHoles = this._getPrjHoles();\n        const holePoints = [];\n        if (prjHoles && prjHoles.length > 0) {\n            //outer ring  simplify result;\n            const simplified = this._simplified;\n            for (let i = 0; i < prjHoles.length; i++) {\n                const hole = this._getPath2DPoints(prjHoles[i], disableSimplify, maxZoom);\n                if (Array.isArray(hole) && isSplitted) {\n                    if (Array.isArray(hole[0])) {\n                        points[0].push(hole[0]);\n                        points[1].push(hole[1]);\n                    } else {\n                        points[0].push(hole);\n                    }\n                } else {\n                    holePoints.push(hole);\n                }\n            }\n            // if outer ring  simplify==true , Ignore inner ring  simplify result\n            if (simplified) {\n                this._simplified = simplified;\n            }\n        }\n        if (!isSplitted) {\n            points = [points];\n            pushIn(points, holePoints);\n        }\n        return [points];\n    },\n\n    _paintOn(ctx, points, lineOpacity, fillOpacity, dasharray) {\n        Canvas.polygon(ctx, points, lineOpacity, fillOpacity, dasharray, this.options['smoothness']);\n    }\n});\n\n","let adapters = {};\n/**\n * Register a worker adapter\n * @param {String} workerKey  - an unique key name of the worker adapter\n * @param {Function} adapter  - the worker adapter function, it must be a complete packaged function with no dependency of other functions\n * @example\n * maptalks.registerWorkerAdapter('foo', function (exports, global) {\n        //will be called only for once when loaded in worker thread\n        exports.initialize = function () {\n          console.log('[worker] initialized');\n        };\n        //to receive message from main thread sent by maptalks.worker.Actor\n        exports.onmessage = function (message, postResponse) {\n          const data = message.data;\n          console.log(`[worker] received data : ` + data);\n          //send message back to main thread\n          //the parameters:\n          //error, data, buffers (arraybuffers in data)\n          postResponse(null, 'message from worker thread', null);\n        };\n     });\n    @global\n    @static\n */\nexport function registerWorkerAdapter(workerKey, adapter) {\n    adapters[workerKey] = adapter;\n}\n\nconst header = `\n    var adapters = {};\n    onmessage = function (msg) {\n        msg = msg.data;\n        var workerKey = msg.workerKey;\n        var adapter = adapters[workerKey];\n        if (!adapter) {\n            post(msg.callback, 'Unregistered worker adapters for ' + workerKey);\n            return;\n        }\n        try {\n            adapter.onmessage(msg, wrap(msg.callback));\n        } catch (err) {\n            post(msg.callback, workerKey + ':' + err.message);\n            console.error(err);\n            throw err;\n        }\n    };\n    function post(callback, err, data, buffers) {\n        var msg = {\n            callback : callback\n        };\n        if (err) {\n            msg.error = err;\n        } else {\n            msg.data = data;\n        }\n        if (buffers && buffers.length > 0) {\n            postMessage(msg, buffers);\n        } else {\n            postMessage(msg);\n        }\n    }\n    function wrap(callback) {\n        return function (err, data, buffers) {\n            post(callback, err, data, buffers);\n        };\n    }\n    var workerExports;\n`;\n\nconst footer = `\n    workerExports = null;\n`;\n\nfunction compileWorkerSource() {\n    let source = header;\n    for (const p in adapters) {\n        const adapter = adapters[p];\n        source += `\n    workerExports = {};\n    (${adapter})(workerExports, self);\n    adapters['${p}'] = workerExports`;\n        source += `\n    workerExports.initialize && workerExports.initialize(self);\n        `;\n\n    }\n    source += footer;\n    return source;\n}\n\nlet url;\n\nexport function getWorkerSourcePath() {\n    if (!url) {\n        const source = compileWorkerSource();\n        url = window.URL.createObjectURL(new Blob([source], { type: 'text/javascript' }));\n        //clear cached worker adapters\n        adapters = null;\n    }\n    return url;\n}\n","import { getWorkerSourcePath } from './Worker';\n\nconst hardwareConcurrency = window.navigator.hardwareConcurrency || 4;\nconst workerCount = Math.max(Math.floor(hardwareConcurrency / 2), 1);\n\n/**\n * Worker Pool\n * contains code from [mapbox-gl-js](https://github.com/mapbox/mapbox-gl-js)\n * @private\n */\nexport default class WorkerPool {\n    constructor() {\n        this.active = {};\n        this.workerCount = window.MAPTALKS_WORKER_COUNT || workerCount;\n    }\n\n    acquire(id) {\n        if (!this.workers) {\n            this.workers = [];\n            const url = getWorkerSourcePath();\n            for (let i = 0; i < this.workerCount; i++) {\n                const worker = new Worker(url);\n                worker.id = i;\n                this.workers.push(worker);\n            }\n        }\n        this.active[id] = true;\n\n        return this.workers.slice();\n    }\n\n    release(id) {\n        delete this.active[id];\n        if (Object.keys(this.active).length === 0) {\n            this.workers.forEach((w) => {\n                w.terminate();\n            });\n            this.workers = null;\n        }\n    }\n\n}\n\nlet globalWorkerPool;\n\nexport function getGlobalWorkerPool() {\n    if (!globalWorkerPool) {\n        globalWorkerPool = new WorkerPool();\n    }\n    return globalWorkerPool;\n}\n","import { getGlobalWorkerPool } from './WorkerPool';\nimport { UID } from '../util';\n\nlet dedicatedWorker = 0;\n\nconst EMPTY_BUFFERS = [];\n\n/**\n * An actor to exchange data from main-thread to workers\n * contains code from [mapbox-gl-js](https://github.com/mapbox/mapbox-gl-js)\n * @category core\n * @memberof worker\n * @example\n *  const workerKey = 'test_worker_key';\n    maptalks.registerWorkerAdapter(workerKey, function (exports, global) {\n      //will be called only for once when loaded in worker thread\n      exports.initialize = function () {\n        console.log('[worker] initialized');\n      };\n      //to receive message from main thread sent by maptalks.worker.Actor\n      exports.onmessage = function (message, postResponse) {\n        const data = message.data;\n        console.log(`[worker] received data : ` + data);\n        //send message back to main thread\n        //the parameters:\n        //error, data, buffers (arraybuffers in data)\n        postResponse(null, 'message from worker thread', null);\n      };\n    });\n\n    const MyActor = class extends maptalks.worker.Actor {\n      test(info, cb) {\n        //send data to worker thread\n        this.send(info, null, cb);\n      }\n    }\n\n    //must be same with workerKey for maptalks.registerWorkerAdapter\n    const actor = new MyActor(workerKey);\n    actor.test('hi', (err, data) => {\n      //received data from worker thread\n      console.log(data);\n    });\n */\nexport default class Actor {\n\n    constructor(workerKey) {\n        this.workerKey = workerKey;\n        this.workerPool = getGlobalWorkerPool();\n        this.currentActor = 0;\n        this.actorId = UID();\n        this.workers = this.workerPool.acquire(this.actorId);\n        this.callbacks = {};\n        this.callbackID = 0;\n        this.receiveFn = this.receive.bind(this);\n        this.workers.forEach(w => {\n            w.addEventListener('message', this.receiveFn, false);\n        });\n    }\n\n    /**\n     * If the actor is active\n     * @returns {Boolean}\n     */\n    isActive() {\n        return !!this.workers;\n    }\n\n    /**\n     * Broadcast a message to all Workers.\n     * @param {Object} data - data to send to worker thread\n     * @param {ArrayBuffer[]} buffers - arraybuffers in data as transferables\n     * @param {Function} cb - callback function when received message from worker thread\n     */\n    broadcast(data, buffers, cb) {\n        cb = cb || function () {};\n        asyncAll(this.workers, (worker, done) => {\n            this.send(data, buffers, done, worker.id);\n        }, cb);\n        return this;\n    }\n\n    /**\n     * Sends a message from a main-thread to a Worker and call callback when response received.\n     *\n     * @param {Object} data - data to send to worker thread\n     * @param {ArrayBuffer[]} buffers - arraybuffers in data as transferables\n     * @param {Function} cb - callback function when received message from worker thread\n     * @param {Number} [workerId=undefined] - Optional, a particular worker id to which to send this message.\n     */\n    send(data, buffers, cb, workerId) {\n        const id = cb ? `${this.actorId}:${this.callbackID++}` : null;\n        if (cb) this.callbacks[id] = cb;\n        this.post({\n            data : data,\n            callback: String(id)\n        }, buffers, workerId);\n        return this;\n    }\n\n    /**\n     * A listener callback for incoming message from worker thread.\n     * SHOULD NOT BE OVERRIDED only if you know what you are doing.\n     * @param {Object} message - response message from worker thread\n     */\n    receive(message) {\n        const data = message.data,\n            id = data.callback;\n        const callback = this.callbacks[id];\n        delete this.callbacks[id];\n        if (data.type === '<request>') {\n            if (this.actorId === data.actorId) {\n                //request from worker to main thread\n                this[data.command](data.params,  (err, cbData, buffers) => {\n                    const message = {\n                        type : '<response>',\n                        callback : data.callback\n                    };\n                    if (err) {\n                        message.error = err.message;\n                    } else {\n                        message.data = cbData;\n                    }\n                    this.post(message, buffers || EMPTY_BUFFERS, data.workerId);\n                });\n            }\n        } else if (callback && data.error) {\n            callback(data.error);\n        } else if (callback) {\n            callback(null, data.data);\n        }\n    }\n\n    /**\n     * Remove the actor\n     */\n    remove() {\n        this.workers.forEach(w => {\n            w.removeEventListener('message', this.receiveFn, false);\n        });\n        this.workerPool.release(this.actorId);\n        delete this.receiveFn;\n        delete this.workers;\n        delete this.callbacks;\n        delete this.workerPool;\n    }\n\n    /**\n     * Send a message to a Worker.\n     * @param {Object} data - data to send\n     * @param {ArrayBuffer[]} buffers   - arraybuffers in data\n     * @param {Number} targetID The ID of the Worker to which to send this message. Omit to allow the dispatcher to choose.\n     * @returns {Number} The ID of the worker to which the message was sent.\n     */\n    post(data, buffers, targetID) {\n        if (typeof targetID !== 'number' || isNaN(targetID)) {\n            // Use round robin to send requests to web workers.\n            targetID = this.currentActor = (this.currentActor + 1) % this.workerPool.workerCount;\n        }\n        data.workerId = targetID;\n        data.workerKey = this.workerKey;\n        data.actorId = this.actorId;\n        this.workers[targetID].postMessage(data, buffers || EMPTY_BUFFERS);\n\n        return targetID;\n    }\n\n    /**\n     * Get a dedicated worker in a round-robin fashion\n     */\n    getDedicatedWorker() {\n        dedicatedWorker = (dedicatedWorker + 1) % this.workerPool.workerCount;\n        return dedicatedWorker;\n    }\n\n}\n\nfunction asyncAll(array, fn, callback) {\n    if (!array.length) { callback(null, []); }\n    let remaining = array.length;\n    const results = new Array(array.length);\n    let error = null;\n    array.forEach((item, i) => {\n        fn(item, (err, result) => {\n            if (err) error = err;\n            results[i] = result;\n            if (--remaining === 0) callback(error, results);\n        });\n    });\n}\n","import { version } from '../package.json';\nexport * from './core/Constants';\nexport { default as Browser } from './core/Browser';\nimport * as Util from './core/util';\nimport * as DomUtil from './core/util/dom';\nimport * as StringUtil from './core/util/strings';\nimport * as MapboxUtil from './core/mapbox';\nexport { Util, DomUtil, StringUtil, MapboxUtil };\nexport { default as LRUCache } from './core/util/LRUCache';\nexport { default as Ajax } from './core/Ajax';\nexport { default as Canvas } from './core/Canvas';\nexport { default as Promise } from './core/Promise';\n\n// core classes\nexport { default as Class } from './core/Class';\nexport { default as Eventable } from './core/Eventable';\nexport { default as JSONAble } from './core/JSONAble';\nexport { default as CollisionIndex } from './core/CollisionIndex';\n\nexport { default as Handlerable } from './handler/Handlerable';\nexport { default as Handler } from './handler/Handler';\nexport { default as DragHandler } from './handler/Drag';\n\n// geo classes\nexport * from './geo';\n\nimport { Map } from './map';\nMap.VERSION = version;\nexport { Map };\n\nexport { MapTool, DrawTool, AreaTool, DistanceTool } from './map/tool';\nexport { default as SpatialReference } from './map/spatial-reference/SpatialReference';\nimport './map/spatial-reference/SpatialReference.Arc';\n\n/** @namespace ui */\nimport * as ui from './ui';\n/** @namespace control */\nimport * as control from './control';\nexport { ui, control };\n\nexport * from './layer';\n\nexport * from './geometry';\n\nimport './geometry/editor/GeometryEditor';\nimport './geometry/editor/TextEditable';\n\nimport './geometry/ext/Geometry.Animation';\nimport './geometry/ext/Geometry.Drag';\nimport './geometry/ext/Geometry.Edit';\nimport './geometry/ext/Geometry.Events';\nimport './geometry/ext/Geometry.InfoWindow';\n\n/**\n * @namespace renderer\n */\n// import layer renderers\nimport * as renderer from './renderer';\nexport { renderer };\n// import geometry renderers\nimport './renderer/geometry';\nimport * as symbolizer from './renderer/geometry/symbolizers';\n/** @namespace animation */\nimport * as animation from './core/Animation';\nexport { symbolizer, animation };\n\nexport { registerWorkerAdapter } from './core/worker/Worker';\n\nimport Actor from './core/worker/Actor';\n\n/**\n * @namespace worker\n */\nconst worker = {\n    Actor : Actor\n};\n\nexport { worker };\n"],"names":["INTERNAL_LAYER_PREFIX","GEOMETRY_COLLECTION_TYPES","GEOJSON_TYPES","concat","RESOURCE_PROPERTIES","RESOURCE_SIZE_PROPERTIES","NUMERICAL_PROPERTIES","COLOR_PROPERTIES","colorNames","now","Date","extend","dest","i","arguments","length","src","k","isNil","obj","isNumber","val","isNaN","isInteger","n","isObject","isString","constructor","String","isFunction","Function","hasOwnProperty","Object","prototype","hasOwn","key","call","join","arr","seperator","Array","pi","Math","PI","toRadian","d","toDegree","r","IS_NODE","toString","process","versions","requestAnimFrame","cancelAnimFrame","fn","setTimeout","clearTimeout","requestFn","cancelFn","timeToCall","timeoutDefer","getPrefixed","name","window","id","isSVG","url","prefix","slice","loadImage","img","imgDesc","node","uid","UID","GUID","parseJSON","str","JSON","parse","pushIn","ii","ll","push","removeFromArray","array","indexOf","splice","forEachCoord","context","isArray","result","p","pp","len","getValueOrDefault","v","undefined","sign","x","Number","log2","log","LOG2E","rounded","round","abs","interpolate","a","b","t","wrap","min","max","w","clamp","isArrayHasData","isURL","head","cssUrlReWithQuote","cssUrlRe","isCssUrl","test","extractCssUrl","matches","exec","b64chrs","btoa","input","output","block","charCode","idx","map","charAt","charCodeAt","Error","b64toBlob","b64Data","contentType","byteCharacters","atob","arraybuffer","ArrayBuffer","view","Uint8Array","blob","Blob","type","computeDegree","x0","y0","x1","y1","dx","dy","atan2","emptyImageUrl","equalMapView","obj1","obj2","approx","expected","delta","flash","interval","count","cb","me","_flashTimeout","flashGeo","show","hide","_defaults","defaults","keys","getOwnPropertyNames","value","getOwnPropertyDescriptor","configurable","defineProperty","types","createFilter","filter","compile","op","compileComparisonOp","compileLogicalOp","compileNegation","compileInOp","compileHasOp","compilePropertyReference","property","substring","stringify","checkType","left","right","expressions","values","sort","compare","expression","getFilterFeature","geometry","json","_toJSON","g","compileStyle","styles","compiled","createFunction","parameters","defaultType","fun","isFunctionDefinition","zoomAndFeatureDependent","stops","featureDependent","zoomDependent","innerFun","evaluateExponentialFunction","evaluateIntervalFunction","evaluateCategoricalFunction","evaluateIdentityFunction","featureFunctions","featureFunctionStops","s","stop","zoom","z","feature","base","coalesce","c","inputLower","inputUpper","outputLower","outputUpper","evaluatedLower","apply","evaluatedUpper","interpolateArray","interpolateNumber","difference","progress","ratio","pow","hasFunctionDefinition","interpolated","piecewiseConstant","loadFunctionTypes","argFn","hit","multResult","loaded","props","buildFn","get","set","enumerable","getFunctionTypeResources","res","l","translateToSVGStyles","getMarkerPathBase64","symbol","width","height","svgStyles","pathes","path","pathesToRender","svg","strPath","b64","getExternalResources","toAbsolute","symbols","resources","resSizeProp","h","convertResourceUrl","iii","_convertUrlToAbsolute","embed","_absolute","location","href","relative","stack","split","parts","pop","isGradient","getGradientStamp","getSymbolStamp","lowerSymbolOpacity","_symbol","_ratio","lower","extendSymbol","sources","args","Browser","ua","navigator","userAgent","toLowerCase","doc","document","documentElement","ie","webkit","phantomjs","android23","search","chrome","gecko","opera","mobile","orientation","msPointer","PointerEvent","MSPointerEvent","pointer","pointerEnabled","ie3d","style","webkit3d","WebKitCSSMatrix","gecko3d","opera12","any3d","chromeVersion","match","touch","DocumentTouch","webgl","canvas","createElement","gl","getContext","WebGLRenderingContext","err","devicePixelRatio","screen","deviceXDPI","logicalXDPI","ielt9","addEventListener","edge","android","safari","mobileWebkit","mobileWebkit3d","mobileOpera","mobileGecko","retina","language","browserLanguage","ie9","documentMode","ie10","Position","y","_isNaN","_abs","_round","_ceil","ceil","_floor","floor","copy","_add","add","nx","ny","_sub","_substract","sub","substract","multi","_multi","div","_div","equals","isZero","toArray","toFixed","toJSON","Point","closeTo","distanceTo","point","sqrt","mag","unit","_unit","perp","_perp","angleWith","angleWithSep","_rotate","angle","cos","sin","rotate","Size","size","toPoint","trim","replace","specialPattern","escapeSpecialChars","splitWords","chr","rulerCtx","stringWidth","text","font","measureText","fontHeight","stringLength","getFontHeight","domRuler","getDomRuler","innerHTML","clientHeight","removeDomNode","splitContent","content","wrapWidth","textWidth","chrWidth","minChrCount","testStr","prew","contentExpRe","replaceVariable","getAlignPoint","horizontalAlignment","verticalAlignment","alignW","alignH","DEFAULT_FONT","getFont","splitTextToRow","lineSpacing","textHeight","wrapChar","textRows","actualWidth","texts","tWidth","contents","rowNum","textSize","first","testProp","TRANSFORM","TRANSFORMORIGIN","TRANSITION","CSSFILTER","createEl","tagName","className","el","setClass","createElOn","container","setStyle","appendChild","parentNode","removeChild","addDomEvent","typeArr","handler","eventHandler","e","event","listensDomEvent","removeDomEvent","callback","doRemove","removeEventListener","handlers","j","jlen","hitHandler","preventDefault","returnValue","stopPropagation","cancelBubble","preventSelection","dom","onselectstart","ondragstart","setAttribute","offsetDom","offset","setTransform","top","computeDomPosition","getComputedStyle","padding","parseInt","rect","getBoundingClientRect","offsetWidth","offsetHeight","scaleX","scaleY","__position","getEventContainerPoint","ev","domPos","clientX","clientLeft","clientY","clientTop","endsWith","suffix","strCss","cssText","hasClass","classList","contains","getClass","RegExp","addClass","classes","baseVal","setOpacity","opacity","pos","setTransformMatrix","m","removeTransform","isHTML","measureDom","parentTag","ruler","clientWidth","tag","span","body","on","off","LRUCache","onRemove","reset","data","order","clear","has","removedData","getAndRemove","remove","setMaxSize","Ajax","jsonp","script","getElementsByTagName","options","client","_getClient","open","headers","setRequestHeader","withCredentials","credentials","responseType","send","post","postData","_wrapCallback","readyState","status","response","byteLength","cacheControl","getResponseHeader","expires","responseText","statusText","XMLHttpRequest","ActiveXObject","onreadystatechange","getArrayBuffer","getImage","imgData","onerror","URL","webkitURL","onload","revokeObjectURL","createObjectURL","getJSON","resp","DEFAULT_STROKE_COLOR","DEFAULT_FILL_COLOR","DEFAULT_TEXT_COLOR","hitTesting","TEMP_CANVAS","Canvas","setHitTesting","testing","createCanvas","canvasClass","prepareCanvasFont","ctx","textBaseline","fill","fillStyle","getRgba","prepareCanvas","strokeWidth","lineWidth","strokeColor","strokeStyle","isImageUrl","patternOffset","_setStrokePattern","_createGradient","lineJoin","lineCap","setLineDash","fillImgUrl","extractImageUrl","fillTexture","Image","image","console","warn","createPattern","extent","gradient","places","getMin","getMax","getWidth","getHeight","createLinearGradient","getCenter","createRadialGradient","forEach","addColorStop","strokePattern","linePatternOffset","imgUrl","imageTexture","imageRes","patternCanvas","addResource","clearRect","x2","y2","_drawn","fillCanvas","fillOpacity","isPattern","_isPattern","alpha","globalAlpha","translate","color","drawImage","error","pt","textDesc","_textOnMultiRow","splitTextSize","ptAlign","lineHeight","basePoint","maxHeight","rowAlign","_textOnLine","textHaloRadius","textHaloFill","textHaloAlpha","drawHalo","gco","shadowBlur","shadowOffsetX","shadowOffsetY","miterLimit","strokeText","globalCompositeOperation","fillText","rgba","_stroke","strokeOpacity","stroke","_path","points","lineDashArray","lineOpacity","ignoreStrokePattern","fillWithPattern","p1","p2","degree","save","restore","isDashed","isPatternLine","prePoint","nextPoint","lineTo","beginPath","moveTo","drawDashLine","_multiClip","polygon","smoothness","isMultiClip","fillFirst","savedCtx","copyProperties","_ring","paintSmoothLine","closePath","ring","ignorePattern","smoothValue","close","tailIdx","tailRatio","t0","t1","bx1","by1","bx2","by2","u0","u1","qxa","qxb","qxc","qxd","qya","qyb","qyc","qyd","xb","xc","xd","yb","yc","yd","getCubicControlPoints","x3","y3","xc1","yc1","xc2","yc2","xc3","yc3","len1","len2","len3","k1","k2","xm1","ym1","xm2","ym2","ctrl1X","ctrl1Y","ctrl2X","ctrl2Y","ctrlPoints","preCtrlPoints","bezierCurveTo","lastPoint","prevCtrlPoint","nextCtrlPoint","_arcBetween","dist","p1p2","asin","cp2","da","cx","cy","startAngle","endAngle","arc","_lineTo","bezierCurveAndFill","start","_bezierCurveTo","p3","ellipse","bezierEllipse","ox","oy","rectangle","sector","angles","rad","radius","sDeg","eDeg","drawCross","target","startPoint","endPoint","dashArray","fromX","fromY","toX","toY","pattern","lt","gt","capmin","capmax","checkX","thereYet","cap","checkY","offsetX","offsetY","dash","ang","lineDashOffset","shadowColor","u","f","o","MutationObserver","nextTick","setImmediate","observe","attributes","TypeError","resolve","reject","state","then","handled","suppressUncaughtRejectionError","timeout","all","module","exports","define","amd","Zousan","soon","global","this","promise","Promise","Eventable","Base","eventsOn","_switch","_eventMap","eventTypes","evtType","handlerChain","once","_wrapOnceHandler","evetTypes","eventsOff","eventType","listeners","wrapKey","jl","listener","listens","getListeningEvents","copyEventListeners","eventMap","fire","_eventParent","_fire","called","onceHandler","to","eventKeys","_clearListeners","_clearAllListeners","_setEventParent","parent","param","queue","bubble","passed","Handler","enable","_enabled","addHooks","disable","removeHooks","enabled","Class","setOptions","callInitHooks","proto","getPrototypeOf","_visitInitHooks","create","config","conf","onConfig","_initHooksCalled","parentProto","hooks","_initHooks","addInitHook","init","include","mergeOptions","registeredTypes","registerJSONType","getJSONClass","getJSONType","_jsonType","clazz","factory","quickselect","quickselectStep","defaultCompare","exp","sd","newLeft","newRight","swap","tmp","rbush","maxEntries","format","_maxEntries","_minEntries","_initFormat","_all","bbox","toBBox","intersects","nodesToSearch","child","childBBox","children","leaf","collides","load","insert","_build","_splitRoot","tmpNode","_insert","item","createNode","equalsFn","indexes","index","goingUp","findItem","_condense","compareMinX","compareNodeMinX","compareMinY","compareNodeMinY","fromJSON","items","N","M","calcBBox","N2","N1","right2","right3","multiSelect","_chooseSubtree","level","targetNode","area","enlargement","minArea","minEnlargement","Infinity","bboxArea","enlargedArea","isNode","insertPath","_split","_adjustParentBBoxes","_chooseSplitAxis","splitIndex","_chooseSplitIndex","newNode","bbox1","bbox2","overlap","minOverlap","distBBox","intersectionArea","xMargin","_allDistMargin","yMargin","leftBBox","rightBBox","margin","bboxMargin","siblings","compareArr","destNode","minX","minY","maxX","maxY","mid","CollisionIndex","_tree","box","insertBox","tree","bulkInsertBox","boxes","addHandler","handlerClass","_handlers","removeHandler","_clearHandlers","START_EVENTS","MOVE_EVENTS","mousedown","touchstart","pointerdown","MSPointerDown","END_EVENTS","DragHandler","_onMouseDown","onMouseDown","_offEvents","button","touches","setCapture","captureEvents","MOUSEMOVE","MOUSEUP","moved","actual","startPos","onMouseMove","onMouseUp","interupted","newPos","changedTouches","Coordinate","toNumberArrays","coordinates","coord","toCoordinates","CRS","properties","createProj4","proj","fromProjectionCode","code","toUpperCase","WGS84","EPSG4326","EPSG3857","IDENTITY","CGCS2000","EPSG4490","BD09LL","GCJ02","TEMP_POINT0","TEMP_COORD0","TEMP_COORD1","TEMP_COORD2","TEMP_COORD3","TEMP_COORD4","TEMP_COORD5","TEMP_COORD6","TEMP_COORD7","MINMAX","TEMP_EXTENT","TEMP_COMBINE","Extent","p4","_clazz","unproject","projection","_dirty","_initialize","xmin","xmax","ymin","ymax","_scale","out","isValid","ext2","_project","rxmin","rymin","rxmax","rymax","within","pxmin","pxmax","pymin","pymax","project","getSize","__combine","inited","_combine","ext","combine","intersection","expand","distance","_expand","convertTo","minmax","projectCoords","PointExtent","Transformation","matrix","transform","scale","untransform","isSphere","coords","circum","getCircum","getSphereExtent","sx","sy","wrapX","wrapY","pre","current","prj","unprojectCoords","projCoords","sphere","isOutSphere","pcoord","wrapCoord","wrapped","measureLength","c1","c2","measureLenBetween","measureArea","locate","xDist","yDist","_locate","pivot","Common","Sphere","ry","rx","initialAngle","rhumbBearing","finalAngle","calculateRhumbDestination","end","bear360","calculateRhumbBearing","bear180","from","phi1","phi2","deltaLambda","deltaPsi","tan","theta","origin","bearing","lambda1","DeltaPhi","DeltaPsi","q","DeltaLambda","lambda2","WGS84Sphere","BaiduSphere","DEFAULT","measurers","registerMeasurer","measure","Identity","Measurer","getInstance","mName","metersPerDegree","maxLatitude","lnglat","lng","lat","pLnglat","atan","PROJ4326","convertLL2MC","convertMC2LL","EARTHRADIUS","MCBAND","LLBAND","MC2LL","LL2MC","cB","cE","cD","T","convertor","cC","getLoop","getRange","toRadians","toDegrees","registerRenderer","_rendererClasses","getRendererClass","CanvasRenderer","layer","_painted","_drawTime","setToRedraw","render","framestamp","prepareRender","getMap","isVisible","ResourceCache","checkResources","_loadingResource","loadResources","_tryToDraw","testIfNeedRedraw","_toRedraw","isInteracting","drawOnInteracting","needToRedraw","getPitch","isMoving","isZooming","isRotating","onSkipDrawOnInteracting","isLoadingResource","isRenderComplete","_renderComplete","mustRenderOnInteracting","setCanvasUpdated","_canvasUpdated","isCanvasUpdated","southWest","canvasExtent2D","_extent2D","onAdd","getCanvasImage","_renderZoom","getZoom","isBlank","isEmpty","containerPoint","_pointToContainerPoint","clearCanvas","setZIndex","hitDetect","_errorThrown","getDevicePixelRatio","getImageData","resourceUrls","promises","cache","isResourceLoaded","_promiseResource","_get2DExtent","_containerPointToPoint","_canvas","Canvas2D","CanvasClass","onCanvasCreate","createContext","dpr","resetCanvasTransform","resizeCanvas","canvasSize","_maskExtent","mask","getMask","maskExtent2D","_getPainter","get2DExtent","clipCanvas","old","getGeometries","masks","_mask","painter","paint","clip","getViewExtent","completeRender","getEvents","onZoomStart","onZooming","onZoomEnd","onResize","onMoveStart","onMoving","onMoveEnd","onDragRotateStart","onDragRotating","onDragRotateEnd","onSpatialReferenceChange","getDrawTime","_drawAndRecord","painted","draw","getId","crossOrigin","_cacheResource","onabort","markErrorResource","_errors","checkSVG","_getImgUrl","merge","Layer","setId","zIndex","onLoad","_initRenderer","getZIndex","_renderer","isCanvasRender","onLoadEnd","_id","addTo","addLayer","_zIndex","_sortLayersByZIndex","getMinZoom","minZoom","getMaxZoom","maxZoom","getOpacity","renderer","_getRenderer","getProjection","bringToFront","layers","_getLayerList","topLayer","bringToBack","bottomLayer","getRenderer","removeLayer","setMask","_isVectorMarker","updateSymbol","setSymbol","_bindLayer","removeMask","isLoaded","_loaded","getCollisionIndex","_collisionIndex","clearCollisionIndex","_bindMap","_switchEvents","_doRemove","emitter","_layers","_getMask2DExtent","JSONAble","Renderable","_onLayerEvent","DefaultSpatialReference","resolutions","SpatialReference","_initSpatialRef","getProjectionInstance","prjName","projections","sp1","sp2","f1","fullExtent","f2","bottom","r1","r2","_projection","defaultSpatialRef","isEPSG","_resolutions","_fullExtent","_transformation","getResolutions","getResolution","next","getFullExtent","getTransformation","getZoomDirection","Map","opts","center","baseLayer","VERSION","writable","_initContainer","_panels","_baseLayer","_zoomLevel","_center","setSpatialReference","_mapViewPoint","_updateMapSize","_getContainerDomSize","setBaseLayer","_Load","addOnLoadHook","_onLoadHooks","getContainer","_containerDOM","getSpatialReference","_spatialReference","ref","oldRef","_updateSpatialReference","_resetMapStatus","_fireEvent","setCursor","cursor","_cursor","_trySetCursor","resetCursor","_prjCenter","setCenter","_verifyExtent","_pcenter","_setPrjCenter","_parseEventFromCoord","getContainerExtent","visualHeight","pitch","maxVisualPitch","_getVisualHeight","visualDistance","getExtent","_pointToExtent","getProjExtent","extent2D","_pointToPrj","getPrjExtent","getMaxExtent","setMaxExtent","maxExt","panTo","getZoomForScale","fromZoom","isFraction","_getResolution","targetRes","scaleZoom","getZoomFromRes","_getResolutions","minRes","maxRes","gap","setZoom","_zoomAnimation","_zoom","getMaxNativeZoom","setMaxZoom","viewMaxZoom","setMinZoom","viewMinZoom","getGLZoom","getGLScale","zoomIn","zoomOut","_zooming","setCenterAndZoom","animation","getFitZoom","containerExtent","coordToContainerPoint","getView","getBearing","setView","setPitch","setBearing","getScale","fitExtent","zoomOffset","step","animateTo","getBaseLayer","isChange","onbaseLayerload","removeBaseLayer","getLayers","_getLayers","getLayer","_layerCache","mapLayers","removed","_removeLayer","sortLayers","layersToOrder","minZ","MAX_VALUE","toDataURL","mimeType","file","dataURL","imgURL","dlLink","download","click","coordToPoint","coordinate","coordinateToPoint","pointToCoord","pointToCoordinate","coordToViewPoint","coordinateToViewPoint","viewPointToCoord","viewPoint","viewPointToCoordinate","coordinateToContainerPoint","containerPointToCoord","containerPointToCoordinate","containerPointToViewPoint","getViewPoint","viewPointToContainerPoint","checkSize","justStart","_initTime","watched","oldHeight","oldWidth","resizeOffset","_offsetCenterByPixel","_mapViewCoord","_getPrjCenter","hided","_noEvent","getMainPanel","getPanels","isRemoved","_removeDomEvents","_moving","_originCenter","_parseEvent","_dragRotating","isDragRotating","isOffscreen","viewportPadding","screenRightBoundary","screenBottomBoundary","getElementById","childNodes","_priorityCursor","_setCursorToPanel","_setPriorityCursor","hasCursor","panel","layerList","_order","eventName","_loadAllLayers","_callOnLoadHooks","loadLayer","_eachLayer","layerLists","_calcMatrices","resetContainer","containerDOM","mSize","updateMapSize","pcenter","_setPrjCoordAtContainerPoint","_prjToPoint","pixel","pCenter","_containerPointToPrj","offsetPlatform","_getViewPointFrameOffset","panelOffset","_resetMapViewPoint","_mapRes","_mapGlRes","pCoord","_pointToPoint","_pointToPointAtZoom","Handlerable","COORD","prjCoord","_prjToViewPoint","_viewPointToPrj","pCoordinate","_prjToContainerPoint","containerToExtent","POINT0","POINT1","distanceToPixel","p0","distanceToPoint","POINT","pixelToDistance","COORD0","COORD1","fullExt","pointToDistance","locateByPoint","px","py","cached","_mapExtent2D","_mapGlExtent2D","cExtent","min2d","max2d","minx","maxx","miny","maxy","_viewPointToPoint","_pointToViewPoint","MapDoubleClickZoomHandler","_onDoubleClick","oldZoom","MapDragHandler","mapWrapper","_dragHandler","_cancelOn","bind","_onDragStart","_onDragging","_onDragEnd","domEvent","_ignore","_ignoreEvent","startDragTime","_mode","ctrlKey","_stopAnim","_animPlayer","_moveStart","_rotateStart","_isEventOutMap","_rotating","_moveEnd","_rotateEnd","startBearing","_start","preX","preY","startX","startY","_getActualEvent","startPrjCoord","mx","my","_clear","panBy","_rotateMode","_db","prePitch","preBearing","db","clipLine","bounds","noCut","segment","clipSegment","_lastCode","useLastCode","codeA","_getBitCode","codeB","codeOut","newCode","_getEdgeIntersection","clipPolygon","edges","clippedPoints","_code","withInEllipse","southeast","tolerance","xfocus","Symbolizer","getPainter","testColor","prop","CanvasSymbolizer","_prepareContext","isHitTesting","_defineStyle","getProperties","setProp","a0","a1","TEMP_POINT1","PointSymbolizer","glZoom","renderPoints","_getRenderPoints","_rotateExtent","fixedExtent","placement","isSpriting","getPlacement","getRenderPoints","_getRenderContainerPoints","ignoreAltitude","dxdy","getDxDy","cpoints","_pointContainerPoints","flat","_getRotationAt","getRotation","rotations","isTransforming","rotation","VectorMarkerSymbolizer","_dynamic","strokeAndFill","translateLineAndFill","symbolize","cookedPoints","_drawMarkers","_drawMarkersWithCache","_drawVectorMarker","stamp","_stampSymbol","_createMarkerImage","anchor","_getAnchor","_calMarkerSize","_size","shadow","_getCacheImageAnchor","_stamp","markerType","_getGraidentExtent","getFixedExtent","vectorArray","_getVectorPoints","gradientExtent","hLineWidth","alignPoint","ha","va","hh","hw","v0","v1","v2","v3","extWidth","DebugSymbolizer","outline","cross","keyword","hex","getColor","string","rgb","hexAlpha","i2","parseFloat","ImageMarkerSymbolizer","_tempCanvas","_tempCtx","_getImage","_url","replaceColor_","removeCache","markerReplaceColor","putImageData","StrokeAndFillSymbolizer","paintParams","_getPaintParams","checkGradient","isPath","isSplitted","params","_paintOn","_getPrjExtent","_extMin","_extMax","_pxExtent","getPaintParams","lineColor","grad","CACHE_KEY","TextMarkerSymbolizer","textContent","_cacheKey","genCacheKey","_descText","_measureText","_loadFromCache","_storeToCache","active","desc","VectorPathMarkerSymbolizer","defaultSymbol","polygonFill","polygonOpacity","DrawAltitudeSymbolizer","_getStyle","groundPoints","_drawLineAltitude","groundPoint","_drawMarkerAltitude","_drawLine","registerSymbolizers","Symbolizers","testCanvas","TEMP_POINT2","TEMP_PAINT_EXTENT","TEMP_FIXED_EXTENT","TEMP_CLIP_EXTENT0","TEMP_CLIP_EXTENT1","Painter","symbolizers","_createSymbolizers","_altAtGLZoom","_getGeometryAltitude","geoSymbol","getSymbol","regSymbolizers","symbolizer","_hasPoint","getType","_debugSymbolizer","hasPoint","_renderPoints","pitched","rotated","_cachedParams","paintAsPath","_paintAsPath","_unsimpledParams","_res","_pitched","_redrawWhenPitch","_rotated","_redrawWhenRotate","_simplified","zoomScale","tr","mapExtent","cPoints","_hitPoint","disableClip","pointPlacement","_aboveCamera","containerOffset","pointContainerPoint","alt","altitude","getAltitude","clipped","_clip","clipPoints","cring","cc","cameraLookAt","cameraPosition","glExtent2D","_glScale","getShell","getHoles","part","_interpolateSegAlt","clipSegs","orig","segsWithAlt","interpolateAlt","cp","_getInternalSymbol","minAltitude","getMinAltitude","frustumAlt","getFrustumAltitude","_beforePaint","contexts","_prepareShadow","_afterPaint","getSprite","_spriting","_sprite","markerExtent","bak","hitTest","_eachSymbolizer","_verifyProjection","_fixedExtent","fixedExt","glScale","maxAltitude","getMaxAltitude","extent2","groundExtent","change","repaint","refreshSymbol","_removeSymbolizers","_paintParams","propAlt","_getAltitudeProperty","_propAlt","MIN_VALUE","_meterToPoint","layerOpts","_getProjection","_projCode","textcache","w0","w1","CollectionPainter","_eachPainter","geometries","Geometry","setProperties","getFirstCoordinate","getCoordinates","getLastCoordinate","fitview","addGeometry","_layer","oldId","_getParent","_repaint","_prepareSymbol","onSymbolChanged","_getSymbol","_computeCenter","_getMeasurer","prjExt","_computeExtent","containsPoint","_containsPoint","_hitTestTolerance","onHide","setZIndexSilently","getGeoMaxZIndex","topZ","getGeoMinZIndex","bottomZ","translated","setCoordinates","ret","_unbind","toGeoJSONGeometry","gJson","_exportGeoJSONGeometry","toGeoJSON","geoJSON","_exportProperties","other","_exportGraphicOptions","getLength","_computeGeodesicLength","getArea","_computeGeodesicArea","measurer","_getConnectPoints","_initOptions","_clearCache","_clearProjection","cookedSymbols","_checkAndCopySymbol","_setExternSymbol","_externSymbol","_extent","_computePrjExtent","finish","_unbindMenu","_unbindInfoWindow","isEditing","endEdit","_removePainter","onRemoveGeometry","_internalId","_getInternalId","_setInternalId","_getExternalResources","_painter","_paint","closeMenu","closeInfoWindow","onShapeChanged","onPositionChanged","needRepaint","_setParent","_parent","_onGeometryEvent","_infoWinOptions","geoProperties","EVENTS","MapGeometryEventsHandler","allLayers","_identifyGeometryEvents","identify","oneMoreEvent","_mouseDownTime","downTime","time","geometryCursorStyle","identifyOptions","eventToFire","_getEventTypeToFire","fireGeometryEvent","_queryIdentifyTimeout","propagation","geoMap","geo","iid","_onEvent","_prevOverGeos","geomap","oldTargets","geos","oldTarget","oldTargetId","wheelZoomDelta","defaultZoomRate","wheelZoomRate","maxScalePerFrame","MapScrollWheelZoomHandler","_thisScrollZoom","_scrollZoom","_wheelZoomRate","_defaultZoomRate","_delta","_onWheelScroll","evt","_checkZoomOrigin","_trackPadSuspect","_ensureTrackpad","_seamless","_interval","deltaMode","WheelEvent","DOM_DELTA_LINE","deltaY","shiftKey","_lastWheelEvent","_zoomOrigin","_active","callInNextFrame","zoomRate","targetZoom","_timeout","_requesting","levelValue","wheelDelta","detail","nextZoom","_checkZoom","_origin","_startZoom","duration","frame","playState","MapTouchZoomHandler","_onTouchStart","_startP1","_startP2","_startDist","_startVector","_startBearing","_onTouchMove","_onTouchEnd","d1","d2","vector","mode","_startTouching","_Origin","Easing","inAndOut","linear","upAndDown","Frame","Player","onFrame","_animation","_onFrame","ready","finished","Animation","speed","_resolveStyles","resolveChild","resolveVal","isChild","childStyles","framing","easing","dStyles","startStyles","destStyles","deltaStyles","_startStyles","_dStyles","elapsed","_requestAnimFrame","_frameQueue","_a","_animationFrameId","_frameFn","_run","running","animate","_prepare","_framer","play","currentTime","startTime","_playStartTime","pause","cancel","reverse","getSqDist","getSqSegDist","simplifyRadialDist","sqTolerance","prevPoint","newPoints","simplifyDPStep","last","simplified","maxSqDist","sqDist","simplifyDouglasPeucker","simplify","highestQuality","Path","getOutline","Polygon","animateShow","_showPlayer","_animIdx","_animLenSoFar","isPolygon","animCoords","_aniShowCenter","player","currentCoord","_drawAnimShowFrame","_animTailRatio","targetLength","segLen","computeLength","targetCoord","_getCenterInExtent","clipFn","meExtent","sumx","sumy","counter","_getPath2DPoints","prjCoords","disableSimplify","isSimplify","_shouldSimplify","isMulti","hasAltitude","_setPrjCoordinates","prjPoints","_prjCoords","_getPrjCoordinates","_projectCoords","_coordinates","_updateCache","_unprojectCoords","shell","rings","hasHoles","_coords2Extent","_getPrjHoles","_get2DLength","vertexes","JSON_TYPE","_holes","_projectRings","_trimRing","holes","_copyAndCloseRing","getCenterInExtent","_prjHoles","_cleanRing","_checkRing","isClose","_getPrjShell","_prjShell","_getCenter2DPoint","Marker","_canEdit","computeExtent","_getSprite","CenterMixin","LineString","GeometryCollection","setGeometries","_geometries","_checkGeometries","_bindGeometriesToLayer","selected","isFn","is","invalidGeoError","_checkGeo","sumX","sumY","anchors","startEdit","_originalSymbol","_draggbleBeforeEdit","_editing","geoExtent","MultiGeometry","geoType","GeometryType","_initData","MultiPoint","findClosest","MultiPath","MultiLineString","MultiPolygon","GeoJSON","toGeometry","foreachFn","resultGeos","_convert","resultGeo","features","mGeos","Circle","circle","_radius","getRadius","setRadius","numberOfPoints","vertex","se","_getMinMax","pminmax","Ellipse","setWidth","setHeight","deg","pps","longer","Rectangle","_width","_height","nw","fExt","_pnw","pnw","sphereExtent","_getSouthEast","prjs","Sector","getStartAngle","setStartAngle","getEndAngle","setEndAngle","pc","sAngle","eAngle","between","Curve","_arc","Canvas2d","ctrlPoint","_quadraticCurve","quadraticCurveTo","_bezierCurve","_getCurveArrowPoints","arrows","segments","arrowStyle","_getArrowShape","ArcCurve","_paintArrow","CubicBezierCurve","curve","_getArrowPoints","QuadBezierCurve","defaultBoxSymbol","TextMarker","getContent","_content","setContent","_refresh","_refreshing","_parseSymbol","setTextStyle","getTextStyle","setTextSymbol","setBoxStyle","getBoxStyle","setBoxSymbol","_getTextSize","_getDefaultTextSymbol","_getDefaultBoxSymbol","_getDefaultPadding","TextBox","boxSymbol","textStyle","getBoxSymbol","textBox","maxWidth","hAlign","vAlign","textSymbol","Label","boxStyle","getTextSymbol","label","sizes","_getBoxSize","boxSize","textAlignPoint","Connectable","_hasConnectors","__connectors","_getConnectors","getConnectSource","_connSource","setConnectSource","_connTarget","getConnectTarget","setConnectTarget","_updateCoordinates","_registerEvents","srcPoints","targetPoints","minDist","oldCoordinates","_showConnect","trigger","showOn","ConnectorLine","ArcConnectorLine","OverlayLayer","_maxZIndex","_minZIndex","_initCache","getGeometryById","_geoMap","_geoList","filtered","getFirstGeometry","getLastGeometry","getCount","copyOnWrite","fitView","_toSort","onGeometryAdd","_updateZIndex","geoId","internalId","onAddGeometry","removeGeometry","_clearing","onGeometryRemove","_findInList","_hitGeos","hits","_getArrowStyle","_sortGeometries","_compare","low","high","middle","_onGeometryIdChange","_onGeometryZIndexChange","_onGeometryPositionChange","_onGeometryShapeChange","_onGeometrySymbolChange","_onGeometryShow","_onGeometryHide","_onGeometryPropertiesChange","onGeometryZIndexChange","onGeometryPositionChange","onGeometryShapeChange","onGeometrySymbolChange","onGeometryShow","onGeometryHide","onGeometryPropertiesChange","VectorLayer","getStyle","_style","_cookedStyles","_styleGeometry","removeStyle","profile","clipExtent","geoJSONs","geoExt","MapTool","_map","onEnable","onDisable","isEnabled","events","registeredMode","DrawTool","registerMode","modeAction","getRegisterMode","_checkMode","_events","_firstClickHandler","_mouseMoveHandler","_doubleClickHandler","_mouseDownHandler","_mouseUpHandler","getMode","setMode","_geometry","_clearStage","_restoreMapCfg","_saveMapCfg","getCurrentGeometry","_drawToolLayer","_getDrawLayer","_loadResources","_mapAutoPanAtEdge","autoPanAtEdge","endDraw","undo","_getRegisterMode","action","_shouldRecordHistory","_historyPointer","_clickCoords","update","redo","actions","_mapDoubleClickZoom","_mapDraggable","_createGeometry","drawTool","_addGeometryToStage","_getMouseContainerPoint","_isValidContainerPoint","clickCoords","drawLayer","_ending","mapSize","drawLayerId","drawToolLayer","MapBoxZoomHander","_boxZoom","markerWidth","markerHeight","PANOFFSET","MapAutoPanAtEdgeHandler","_onMouseMove","equalView","view1","view2","currView","empty","zoomOrigin","preView","framer","_interupted","_endAnim","_startAnim","isAnimating","_animRotating","endCoord","_registerDomEvents","_handleDOMEvent","mimicClick","_fireDOMEvent","_clickTime","control","srcElement","preTarget","actualEvent","eventPos","eventParam","isFullScreen","webkitIsFullScreen","mozFullScreen","msFullscreenElement","fullscreenElement","requestFullScreen","_requestFullScreen","cancelFullScreen","_cancelFullScreen","mozRequestFullScreen","webkitRequestFullScreen","msRequestFullScreen","availWidth","availHeight","newWin","opener","mozCancelFullScreen","webkitCancelFullScreen","_panAnimation","setInfoWindow","layerJSON","layerType","extraLayerOptions","layersJSON","exportOption","layerJSONs","coord1","coord2","computeGeometryLength","computeGeometryArea","reqLayers","layerHits","_frameZoom","startScale","_startZoomAnim","endScale","_startZoomVal","_startZoomCoord","frameZoom","_zoomTo","fromRes","originOffset","startZoomVal","perspective","fovy","aspect","near","far","nf","a00","a01","a02","a03","a10","a11","a12","a13","a20","a21","a22","a23","rotateX","rotateZ","multiply","a30","a31","a32","a33","b0","b1","b2","b3","invert","b00","b01","b02","b03","b04","b05","b06","b07","b08","b09","b10","b11","det","identity","subtract","normalize","dot","ax","ay","az","bx","by","bz","applyMatrix","matrixToQuaternion","te","m11","m12","m13","m21","m22","m23","m31","m32","m33","trace","quaternionToMatrix","z2","xx","xy","xz","yy","yz","zz","wx","wy","wz","setPosition","lookAt","eye","up","RADIAN","DEFAULT_FOV","TEMP_COORD","getFov","_fov","setFov","fov","_renderLayers","_angle","_pitch","_frustumAltitude","_calcFrustumAltitude","cameraAlt","_projIfBehindCamera","cameraForward","projViewMatrix","w2","h2","centerPoint","vectorFromCam","position","cameraPos","camForward","camNormDot","coord0","projViewMatrixInverse","z0","z1","m0","createMat4","m1","sr","worldMatrix","_getCameraWorldMatrix","halfFov","groundAngle","topHalfSurfaceDistance","cameraToCenterDistance","furthestDistance","cameraFar","cameraNear","projMatrix","mat4","viewMatrix","domCssMatrix","_calcDomMatrix","minusY","targetZ","center2D","_getFovRatio","cz","cameraUp","cameraWorldMatrix","_onViewChange","_viewHistory","_viewHistoryPointer","_getCurrentView","_fireViewChange","zoomToPreviousView","hasPreviousView","_zoomToView","zoomToNextView","hasNextView","getViewHistory","createCollisionIndex","DistanceTool","_afterEnable","_afterDisable","_measureLayers","_lastMeasure","_lastVertex","getMeasureLayers","getLastMeasure","_measure","toMeasure","units","_registerMeasureEvents","_msOnDrawStart","_msOnDrawVertex","_msOnMouseMove","_msOnDrawEnd","layerId","markerLayerId","_measureLineLayer","_measureMarkerLayer","startLabel","ms","_msGetCoordsToMeasure","_tailMarker","_tailLabel","vertexLabel","_clearTailMarker","_addClearMarker","dxSymbol","endMarker","measureLineLayer","measureMarkerLayer","AreaTool","sqmi","vertexMarker","endLabel","_firstClick","firstClick","pSymbol","marker","arcConf","tileInfo","tileSize","lods","tileSystem","loadArcgis","spatialRef","UIComponent","owner","_owner","_mapEventsOn","_switchMapEvents","_coordinate","visible","_getUIContainer","_removePrevDOM","__uiDOM","buildOn","_measureSize","_singleton","_uiDomKey","_setPosition","anim","_getAnimation","ok","fade","getTransformOrigin","_toCSSTranslate","_pos","display","_autoPan","transition","getDOM","getOwner","getPosition","_getViewPoint","getOffset","animations","trimed","mapWidth","mapHeight","onDomRemove","eventsToStop","_getClassName","_getDefaultEvents","ownerEvents","_getOwnerEvents","onEvent","positionchange","getOwnerEvents","_updatePosition","domEvents","UIMarker","_markerCoord","_registerDOMEvents","_removeDOMEvents","isDragging","_onDomEvents","UIMarkerDragHandler","_startDrag","_endDrag","_lastCoord","_lastPoint","_prepareDragHandler","_dragging","_isDragging","coordOffset","pointOffset","InfoWindow","getInfoWindow","removeInfoWindow","_infoWindow","setTitle","title","getTitle","_getWindowWidth","msgContent","querySelector","_onCloseBtnClick","closeBtn","markerSize","fixExtent","_onAutoOpen","defaultWidth","ToolTip","onMouseOut","cssName","onMouseOver","defaultOptions","Menu","_menu","removeMenu","setItems","getItems","_getMenuWidth","menuItems","_createMenuItemDom","ul","onMenuClick","_callback","itemDOM","itemTitle","Menuable","setMenu","_menuOptions","_defaultOpenMenu","openMenu","_bindMenu","setMenuItems","getMenuItems","Control","controlContainer","__ctrlContainer","_controlDom","_parse","getContainerPoint","positions","addControl","removeControl","layerEvents","Attribution","_attributionContainer","_update","attributions","attributionControl","LayerSwitcher","_show","_hide","_createPanel","toElement","relatedTarget","elm","baseLayers","li","_isExcluded","_renderLayer","excludeLayers","isBase","checked","onchange","layerSwitcherControl","Overview","mapContainer","_createOverview","_updateBaseLayer","_onButtonClick","_updateButtonText","_overview","_perspective","maxmize","minimize","getOverviewMap","_getOverviewZoom","_getPerspectiveCoords","showIndex","overviewControl","Panel","closeButton","onclick","panelContent","draggable","_startPos","_startPosition","startPosition","Scale","_scaleContainer","_addScales","css","_mScale","_iScale","maxMeters","_updateScales","_updateMetric","_updateImperial","meters","_getRoundNum","_updateScale","maxFeet","maxMiles","miles","feet","num","pow10","scaleControl","Toolbar","onButtonClick","childIndex","targetDom","_getItems","textAlign","itemSize","dropMenu","_createDropMenu","menuDom","menuUL","liWidth","UNIT","Zoom","levelDOM","_levelDOM","zoomDOM","zoomInButton","_zoomInButton","reading","_sliderBox","_sliderRuler","_sliderReading","_sliderDot","zoomOutButton","_zoomOutButton","_onZoomInClick","_onZoomOutClick","_onClickRuler","dotDragger","totalRange","zoomRange","_updateText","_onDotDragstart","_onDotDrag","zoomControl","TileSystem","getDefault","semiCircum","TileConfig","prepareTileInfo","_xScale","_yScale","transformation","_getTileNum","tileX","tileY","getTileIndex","tileIndex","getNeighorTileIndex","repeatWorld","idy","_getTileFullIndex","nwIndex","seIndex","getTilePrjNW","getTilePrjSE","getTilePrjExtent","URL_PATTERN","TEMP_POINT","TEMP_POINT3","TEMP_POINT_EXTENT","TileLayer","getTileSize","getTiles","parentLayer","parentRenderer","tileGrids","minPitchToCascade","tileZoom","_getTileZoom","currentTiles","_getTiles","tiles","extent0","extent1","parentTiles","getTileUrl","urlTemplate","domain","subdomains","_sr","maskID","_getTileOffset","hasOffset","emptyGrid","tileConfig","_getTileConfig","mapSR","extent2d","innerExtent2D","_getInnerExtent","offsetExtent2D","maskExtent","prjCenter","pmin","pmax","centerTile","ltTile","rbTile","leftVisitEnd","rightVisitEnd","hasCachedInfo","tileId","_getTileId","isTileCachedOrLoading","info","point0","_unproject","pse","tileExtent","_isTileInExtent","ch","cw","mapProjection","_initTileConfig","_defaultTileConfig","_tileConfig","_convertPointCallback","convertPoint","_coordTileZoom","_onSpatialReferenceChange","GroupTileLayer","_checkChildren","layerMap","_groupChildren","childGrid","getChildLayer","_onLayerShowHide","ids","crs","uppercase","detectRetina","defaultWmsParams","service","request","transparent","version","WMSTileLayer","wmsParams","_wmsVersion","projectionKey","getParamString","existingUrl","encodeURIComponent","CanvasTileLayer","drawTile","createGLContext","names","compileShader","source","shader","createShader","shaderSource","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","deleteShader","createProgram","vert","frag","vertexShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","program","attachShader","linkProgram","enableVertexAttrib","FSIZE","Float32Array","BYTES_PER_ELEMENT","STRIDE","attr","getAttribLocation","vertexAttribPointer","enableVertexAttribArray","shaders","arr16","ImageGLRenderable","renderable","drawGLImage","loadTexture","uMatrix","uniformMatrix4fv","uniform1f","glBuffer","saveImageBuffer","bufferTileData","bindBuffer","ARRAY_BUFFER","drawArrays","TRIANGLE_STRIP","buffer","loadImageBuffer","set12","drawTinImage","vertices","texCoords","indices","posBuffer","bufferData","DYNAMIC_DRAW","texBuffer","ELEMENT_ARRAY_BUFFER","Uint16Array","drawElements","TRIANGLES","UNSIGNED_SHORT","createCanvas2","canvas2","clearColor","DEPTH_TEST","STENCIL_TEST","BLEND","blendFunc","ONE","ONE_MINUS_SRC_ALPHA","useProgram","createBuffer","STATIC_DRAW","enableSampler","activeTexture","pixelStorei","UNPACK_PREMULTIPLY_ALPHA_WEBGL","indicesBuffer","resizeGLCanvas","viewport","clearGLCanvas","COLOR_BUFFER_BIT","STENCIL_BUFFER_BIT","disposeImage","texture","saveTexture","_createTexture","getTexture","createTexture","bindTexture","TEXTURE_2D","texParameteri","TEXTURE_MIN_FILTER","LINEAR","TEXTURE_MAG_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","texImage2D","RGBA","UNSIGNED_BYTE","generateMipmap","_textures","textures","getImageBuffer","_imageBuffers","imageBuffers","createImageBuffer","removeGLCanvas","_buffers","deleteBuffer","deleteTexture","deleteProgram","uniforms","_initUniforms","sampler","texIdx","uSampler","_getUniform","uniform1i","uniform","uniformName","getUniformLocation","a2","a3","a4","a5","a6","a7","a8","a9","ImageLayer","images","_images","_prepareImages","setImages","getImages","_imageData","refreshImages","EMPTY_ARRAY","ImageLayerCanvasRenderer","isDrawable","_imageLoaded","urls","unloaded","retireImage","_drawImages","_drawImage","ImageLayerGLRenderer","CanvasLayerRenderer","getPrepareParams","getDrawParams","prepareDrawContext","_drawLayer","_drawLayerOnInteracting","canvasImg","bufferContext","prevent","doubleBuffer","_drawContext","_predrawed","ensureParams","prepareToDraw","_prepareDrawParams","CanvasLayer","redraw","isPlaying","requestMapToRender","ParticleLayer","getParticles","_shouldClear","fillRect","_fillCanvas","trail","EDIT_STAGE_LAYER_PREFIX","createHandleSymbol","GeometryEditor","prepare","_prepareEditStageLayer","stageId","shadowId","_editStageLayer","_shadowLayer","editing","_geometryDraggble","_shadow","_switchGeometryEvents","_createOrRefreshOutline","_addListener","_createCenterHandle","_onMarkerDragEnd","createMarkerEditor","createCircleEditor","createEllipseOrRectEditor","createPolygonEditor","_history","_editOutline","_refreshHooks","_getGeometryEvents","_onGeoSymbolChange","_exeAndReset","oper","_addRefreshHook","handle","createHandle","onDown","onMove","onUp","_createHandleInstance","onHandleDragstart","onHandleDragging","_hideContext","onHandleDragEnd","onHandleRemove","onRefresh","_createResizeHandles","blackList","onHandleMove","onHandleUp","cursors","axis","getResizeAnchors","resizeHandles","anchorIndexes","handleSymbol","fnLocateHandles","pExt","isBlack","some","ele","_index","handleViewPoint","_updating","geometryToEdit","_recordHistory","getUpdates","resizeAbilities","aspectRatio","newCoordinates","_updateCoordFromShadow","mirrorHandle","mirrorViewPoint","viewCenter","wh","ability","updates","isRect","mouseViewPoint","pointSub","targetPoint","mirror","absSub","verticeLimit","propertyOfVertexRefreshFn","propertyOfVertexIndex","vertexHandles","newVertexHandles","getVertexCoordinates","getVertexPrjCoordinates","onVertexAddOrRemove","removeVertex","prjCoordinates","nextIndex","createNewVertexHandle","moveVertexHandle","vertice","nVertex","pVertex","createVertexHandle","vertexCoordinates","nextVertex","vertexIndex","refreshVertex","_eventListeners","method","_exeHistory","ignoreRecord","updating","record","history","TextEditable","startEditText","endEditText","_prepareEditor","_textEditor","html","innerText","_editUIMarker","onkeyup","isEditingText","getTextEditor","editContainer","_createEditor","_getEditorOffset","_setCursorToLast","labelSize","textColor","spacing","editor","contentEditable","keyCode","range","getSelection","focus","selectAllChildren","collapseToEnd","selection","createRange","moveToElementText","collapse","select","stylesToAnimate","_prepareAnimationStyles","preTranslate","isFocusing","_animationStarted","fnName","toTranslate","dSymbol","_fireAnimateEvent","symbolToAnimate","symbolInStyles","sp","DRAG_STAGE_LAYER_ID","GeometryDragHandler","_prepareDragStageLayer","_prepareShadowConnectors","_dragStageLayer","shadowConnectors","connectors","targetConn","connOptions","connSymbol","conn","_shadowConnectors","_onTargetUpdated","enableAltitude","altitudeProperty","_correctCoord","_startParam","_moved","_updateTargetAndRemoveShadow","_editor","redoEdit","undoEdit","_getEventParams","_bindInfoWindow","openInfoWindow","TileLayerCanvasRenderer","tilesInView","tilesLoading","_parentTiles","_childTiles","tileCache","deleteTile","getCurrentTileZoom","_tileZoom","mask2DExtent","loadingCount","loading","checkedTiles","parentKeys","childTiles","childKeys","placeholders","placeholderKeys","tileQueue","preLoadingCount","_markTiles","loadingLimit","_getLoadLimit","_tileOffset","tileGrid","allTiles","placeholder","_generatePlaceHolder","tile","_getCachedTile","tileLoading","_isLoadingTile","getTileOpacity","hitLimit","dupKey","parentTile","_findParentTile","_findChildTiles","_drawTiles","loadTileQueue","_retireTiles","t2","onDrawTileStart","_drawTileAndCache","_drawTileOffset","writeZoomStencil","started","startZoomStencilTest","resumeZoomStencilTest","pauseZoomStencilTest","endZoomStencilTest","onDrawTileEnd","_clipByPitch","tileImage","loadTile","loadTime","onTileLoad","onTileError","loadTileImage","abortTileLoading","falseFn","_addTileToCache","onerrorTick","tileRetryCount","transformed","xyz","_getLayerOfTile","zoomDiff","_findChildTilesAt","childZoom","dmin","dmax","ex","ey","diff","_tilePlaceHolder","force","defaultPlaceholder","TileLayerGLRenderer","_gl","_bindGLBuffer","stencilFunc","ALWAYS","stencilOp","KEEP","REPLACE","EQUAL","tileCanvas","GLRenderer","quadVertices","Int8Array","QuadStencil","debug","stencilMask","depthMask","_save","_createBuffer","_createProgram","transformLoc","colorLoc","colorMask","_restore","uniform3fv","random","func","fail","zfail","zpass","resetFunc","_savedProgram","Int16Array","Uint8ClampedArray","OverlayLayerRenderer","_geosToCheck","_resourceChecked","_addGeoToCheckRes","VectorLayerRenderer","drawGeos","_geosToDraw","_updateDisplayExtent","_sortMarkersOnZooming","markers","_markersOnZooming","_displayExtent","forEachGeo","checkGeo","_markersToDraw","_markersIdx","_isLimitMarkerOnZooming","marker0","marker1","limit","sortedMarkers","OverlayLayerCanvasRenderer","MapRenderer","_handlerQueue","executeFrameCallbacks","front","panels","back","_frameLoop","MapCanvasRenderer","_containerIsCanvas","_loopTime","initContainer","renderFrame","updateMapDOM","_getAllLayerToRender","drawLayers","drawLayerCanvas","_recordView","_mapview","_getMapView","_spatialRefChanged","_fireLayerLoadEvents","canvasIds","updatedIds","fps","timeLimit","layerLimit","isCanvas","needsRedraw","_checkLayerRedraw","setLayerCanvasUpdated","transformMatrix","__zoomTransformMatrix","_zoomMatrix","_drawCanvasLayerOnInteracting","_eventParam","preCanvasIds","_canvasIds","preUpdatedIds","_updatedIds","isLayerCanvasUpdated","sep","isSpatialReferenceChanged","isViewChanged","drawTime","inTime","_updateCanvasSize","interacting","baseLayerImage","layerImage","_getLayerImage","_drawLayerCanvasImage","_drawFog","_drawCenterCross","_onVisibilitychange","_resizeInterval","clearInterval","_cancelFrameLoop","createContainer","enableSelect","POSITION0","mapAllLayers","backStatic","backLayer","canvasContainer","frontStatic","frontLayer","ui","previous","_animationFrame","canvasImage","imgOp","fogThickness","landscape","_checkSize","_setCheckSizeInterval","_checkSizeInterval","setInterval","_onMapMouseMove","_hitDetectFrame","_getCanvasLayers","visibilityState","CenterPointRenderer","PolyRenderer","_getRenderSize","prjExtent","pointZoom","arrowStyles","normal","prjVertexes","dasharray","_getArrowPlacement","_getArrows","prjHoles","holePoints","hole","adapters","registerWorkerAdapter","workerKey","adapter","header","footer","compileWorkerSource","getWorkerSourcePath","hardwareConcurrency","workerCount","WorkerPool","MAPTALKS_WORKER_COUNT","acquire","workers","worker","Worker","release","terminate","globalWorkerPool","getGlobalWorkerPool","dedicatedWorker","EMPTY_BUFFERS","Actor","workerPool","currentActor","actorId","callbacks","callbackID","receiveFn","receive","isActive","broadcast","buffers","asyncAll","done","workerId","message","command","cbData","targetID","postMessage","getDedicatedWorker","remaining","results"],"mappings":"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"}