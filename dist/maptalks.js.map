{"version":3,"file":"maptalks.js","sources":["../src/core/Constants.js","../src/core/util/common.js","../src/core/util/env.js","../src/core/util/util.js","../node_modules/@maptalks/feature-filter/index.js","../node_modules/@maptalks/function-type/index.js","../src/core/util/resource.js","../src/core/util/style.js","../src/core/Browser.js","../src/geo/Position.js","../src/geo/Point.js","../src/geo/Size.js","../src/core/util/strings.js","../src/core/util/dom.js","../src/core/Ajax.js","../src/core/Canvas.js","../node_modules/zousan/zousan-min.js","../src/core/Promise.js","../src/core/Eventable.js","../src/handler/Handler.js","../src/core/Class.js","../src/core/JSONAble.js","../src/handler/Handlerable.js","../src/handler/Drag.js","../src/geo/Coordinate.js","../src/geo/CRS.js","../src/geo/Extent.js","../src/geo/PointExtent.js","../src/geo/transformation/Transformation.js","../src/geo/projection/Projection.js","../src/geo/measurer/Common.js","../src/geo/measurer/Identity.js","../src/geo/measurer/Sphere.js","../src/geo/measurer/index.js","../src/geo/projection/Projection.EPSG3857.js","../src/geo/projection/Projection.EPSG4326.js","../src/geo/projection/Projection.EPSG4490.js","../src/geo/projection/Projection.Baidu.js","../src/geo/projection/Projection.IDENTITY.js","../src/geo/projection/index.js","../src/renderer/Renderable.js","../src/renderer/layer/CanvasRenderer.js","../src/layer/Layer.js","../src/map/spatial-reference/SpatialReference.js","../src/map/Map.js","../src/map/handler/Map.DoubleClickZoom.js","../src/map/handler/Map.Drag.js","../src/core/util/path.js","../src/renderer/geometry/symbolizers/Symbolizer.js","../src/renderer/geometry/symbolizers/CanvasSymbolizer.js","../src/renderer/geometry/symbolizers/PointSymbolizer.js","../src/renderer/geometry/symbolizers/VectorMarkerSymbolizer.js","../src/renderer/geometry/symbolizers/DebugSymbolizer.js","../src/renderer/geometry/symbolizers/ImageMarkerSymbolizer.js","../src/renderer/geometry/symbolizers/StrokeAndFillSymbolizer.js","../src/renderer/geometry/symbolizers/TextMarkerSymbolizer.js","../src/renderer/geometry/symbolizers/VectorPathMarkerSymbolizer.js","../src/renderer/geometry/symbolizers/DrawAltitudeSymbolizer.js","../src/renderer/geometry/Painter.js","../src/renderer/geometry/CollectionPainter.js","../src/geometry/Geometry.js","../src/map/handler/Map.GeometryEvents.js","../src/map/handler/Map.ScrollWheelZoom.js","../src/map/handler/Map.Touch.js","../src/core/Animation.js","../node_modules/simplify-js/simplify.js","../src/geometry/Path.js","../src/geometry/Polygon.js","../src/geometry/CenterMixin.js","../src/geometry/Marker.js","../src/geometry/LineString.js","../src/geometry/GeometryCollection.js","../src/geometry/MultiGeometry.js","../src/geometry/MultiPoint.js","../src/geometry/MultiPath.js","../src/geometry/MultiLineString.js","../src/geometry/MultiPolygon.js","../src/geometry/GeoJSON.js","../src/geometry/Circle.js","../src/geometry/Ellipse.js","../src/geometry/Rectangle.js","../src/geometry/Sector.js","../src/geometry/Curve.js","../src/geometry/ArcCurve.js","../src/geometry/CubicBezierCurve.js","../src/geometry/QuadBezierCurve.js","../src/geometry/TextMarker.js","../src/geometry/TextBox.js","../src/geometry/Label.js","../src/geometry/ConnectorLine.js","../src/layer/OverlayLayer.js","../src/layer/VectorLayer.js","../src/map/tool/MapTool.js","../src/map/tool/DrawTool.js","../src/map/handler/Map.BoxZoom.js","../src/map/handler/Map.AutoPanAtEdge.js","../src/map/Map.Anim.js","../src/map/Map.DomEvents.js","../src/map/Map.FullScreen.js","../src/map/Map.Pan.js","../src/map/Map.Profile.js","../src/map/Map.Topo.js","../src/map/Map.Zoom.js","../src/core/util/mat4.js","../src/core/util/vec3.js","../src/core/util/math.js","../src/map/Map.Camera.js","../src/map/Map.ViewHistory.js","../src/map/tool/DistanceTool.js","../src/map/tool/AreaTool.js","../src/map/tool/DrawToolRegister.js","../src/map/spatial-reference/SpatialReference.Arc.js","../src/ui/UIComponent.js","../src/ui/UIMarker.js","../src/ui/InfoWindow.js","../src/ui/ToolTip.js","../src/ui/Menu.js","../src/ui/Menuable.js","../src/control/Control.js","../src/control/Control.Attribution.js","../src/control/Control.LayerSwitcher.js","../src/control/Control.Overview.js","../src/control/Control.Panel.js","../src/control/Control.Scale.js","../src/control/Control.Toolbar.js","../src/control/Control.Zoom.js","../src/layer/tile/tileinfo/TileSystem.js","../src/layer/tile/tileinfo/TileConfig.js","../src/layer/tile/TileLayer.js","../src/layer/tile/GroupTileLayer.js","../src/layer/tile/WMSTileLayer.js","../src/layer/tile/CanvasTileLayer.js","../src/core/util/gl.js","../src/renderer/layer/ImageGLRenderable.js","../src/layer/ImageLayer.js","../src/renderer/layer/canvaslayer/CanvasLayerRenderer.js","../src/layer/CanvasLayer.js","../src/layer/ParticleLayer.js","../src/geometry/editor/GeometryEditor.js","../src/geometry/editor/TextEditable.js","../src/geometry/ext/Geometry.Animation.js","../src/geometry/ext/Geometry.Drag.js","../src/geometry/ext/Geometry.Edit.js","../src/geometry/ext/Geometry.Events.js","../src/geometry/ext/Geometry.InfoWindow.js","../src/core/util/LruCache.js","../src/renderer/layer/tilelayer/TileLayerCanvasRenderer.js","../src/renderer/layer/tilelayer/TileLayerGLRenderer.js","../src/renderer/layer/tilelayer/CanvasTileLayerRenderer.js","../src/renderer/layer/vectorlayer/OverlayLayerCanvasRenderer.js","../src/renderer/layer/vectorlayer/VectorLayerCanvasRenderer.js","../src/renderer/map/MapRenderer.js","../src/renderer/map/MapCanvasRenderer.js","../src/renderer/geometry/PointRenderer.js","../src/renderer/geometry/VectorRenderer.js","../src/index.js"],"sourcesContent":["/**\n * INTERNAL_LAYER_PREFIX The id prefix of internal layers\n * @global\n */\nexport const INTERNAL_LAYER_PREFIX = '_maptalks__internal_layer_';\n\nexport const GEOMETRY_COLLECTION_TYPES = [\n    'MultiPoint',\n    'MultiLineString',\n    'MultiPolygon',\n    'GeometryCollection'\n];\n\nexport const GEOJSON_TYPES = ['FeatureCollection', 'Feature', 'Point', 'LineString', 'Polygon'].concat(GEOMETRY_COLLECTION_TYPES);\n\n/**\n * Symbol properties containing external resources\n */\nexport const RESOURCE_PROPERTIES = [\n    'markerFile', 'polygonPatternFile', 'linePatternFile', 'markerFillPatternFile', 'markerLinePatternFile'\n];\n\n/**\n * Corresponding size properties for the above resource properties\n */\nexport const RESOURCE_SIZE_PROPERTIES = [\n    ['markerWidth', 'markerHeight'],\n    [],\n    [null, 'lineWidth'],\n    [],\n    [null, 'markerLineWidth']\n];\n\n/**\n * numeric symbol properties\n */\nexport const NUMERICAL_PROPERTIES = {\n    'lineWidth': 1,\n    'lineOpacity': 1,\n    'lineDx': 1,\n    'lineDy': 1,\n    'polygonOpacity': 1,\n    'markerWidth': 1,\n    'markerHeight': 1,\n    'markerDx': 1,\n    'markerDy': 1,\n    'markerOpacity': 1,\n    'markerFillOpacity': 1,\n    'markerLineWidth': 1,\n    'markerLineOpacity': 1,\n    'textSize': 1,\n    'textOpacity': 1,\n    'textHaloRadius': 1,\n    'textWrapWidth': 1,\n    'textLineSpacing': 1,\n    'textDx': 1,\n    'textDy': 1\n};\n\n/**\n *  color symbol properties\n */\nexport const COLOR_PROPERTIES = [\n    'lineColor', 'polygonFill', 'markerFill', 'markerLineColor', 'textFill'\n];\n","export function now() {\n    return Date.now();\n}\n\n/**\n * @classdesc\n * Utilities methods used internally. It is static and should not be initiated.\n * @class\n * @static\n * @category core\n * @name Util\n */\n\n/**\n * Merges the properties of sources into destination object.\n * @param  {Object} dest   - object to extend\n * @param  {...Object} src - sources\n * @return {Object}\n * @memberOf Util\n */\nexport function extend(dest) { // (Object[, Object, ...]) ->\n    for (let i = 1; i < arguments.length; i++) {\n        const src = arguments[i];\n        for (const k in src) {\n            dest[k] = src[k];\n        }\n    }\n    return dest;\n}\n\n/**\n * Whether the object is null or undefined.\n * @param  {Object}  obj - object\n * @return {Boolean}\n * @memberOf Util\n */\nexport function isNil(obj) {\n    return obj == null;\n}\n\n/**\n * Whether val is a number and not a NaN.\n * @param  {Object}  val - val\n * @return {Boolean}\n * @memberOf Util\n */\nexport function isNumber(val) {\n    return (typeof val === 'number') && !isNaN(val);\n}\n\n/**\n * Whether a number is an integer\n * @param  {Number}  n\n * @return {Boolean}\n * @memberOf Util\n */\nexport function isInteger(n) {\n    return (n | 0) === n;\n}\n\n/**\n * Whether the obj is a javascript object.\n * @param  {Object}  obj  - object\n * @return {Boolean}\n * @memberOf Util\n */\nexport function isObject(obj) {\n    return typeof obj === 'object' && !!obj;\n}\n\n/**\n * Check whether the object is a string\n * @param {Object} obj\n * @return {Boolean}\n * @memberOf Util\n */\nexport function isString(obj) {\n    if (isNil(obj)) {\n        return false;\n    }\n    return typeof obj === 'string' || (obj.constructor !== null && obj.constructor === String);\n}\n\n/**\n * Check whether the object is a function\n * @param {Object} obj\n * @return {Boolean}\n * @memberOf Util\n */\nexport function isFunction(obj) {\n    if (isNil(obj)) {\n        return false;\n    }\n    return typeof obj === 'function' || (obj.constructor !== null && obj.constructor === Function);\n}\n\nconst hasOwnProperty = Object.prototype.hasOwnProperty;\n/**\n * Check whether the object owns the property.\n * @param  {Object}  obj - object\n * @param  {String}  key - property\n * @return {Boolean}\n * @memberOf Util\n */\nexport function hasOwn(obj, key) {\n    return hasOwnProperty.call(obj, key);\n}\n\n/**\n * Join an array, standard or a typed one.\n * @param  {Object[]} arr       array to join\n * @param  {String} seperator  seperator\n * @return {String}           result string\n * @private\n * @memberOf Util\n */\nexport function join(arr, seperator) {\n    if (arr.join) {\n        return arr.join(seperator || ',');\n    } else {\n        return Array.prototype.join.call(arr, seperator || ',');\n    }\n}\n\nconst pi = Math.PI / 180;\n\nexport function toRadian(d) {\n    return d * pi;\n}\n\nexport function toDegree(r) {\n    return r / pi;\n}\n","/**\n * from detect-node\n * https://github.com/iliakan/detect-node\n *\n * @property {boolean} IS_NODE - whether running in nodejs but not on electron,node-webkit\n * @global\n * @name IS_NODE\n */\nexport const IS_NODE = Object.prototype.toString.call(typeof process !== 'undefined' ? process : 0) === '[object process]' && !process.versions['electron'] && !process.versions['nw'] && !process.versions['node-webkit'];\n","import { IS_NODE } from './env';\nimport { isString, isNil } from './common';\n\n// RequestAnimationFrame, inspired by Leaflet\nlet requestAnimFrame, cancelAnimFrame;\n/* istanbul ignore next */\n(function () {\n    if (IS_NODE) {\n        requestAnimFrame = function (fn) {\n            return setTimeout(fn, 16);\n        };\n\n        cancelAnimFrame = clearTimeout;\n        return;\n    }\n\n    let requestFn, cancelFn;\n    // slow down fps in IE9 for performance\n    const timeToCall = 1000 / 30;\n    function timeoutDefer(fn) {\n        return setTimeout(fn, timeToCall);\n    }\n\n    function getPrefixed(name) {\n        return window['webkit' + name] || window['moz' + name] || window['ms' + name];\n    }\n    if (typeof (window) != 'undefined') {\n        // inspired by http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n\n        requestFn = window['requestAnimationFrame'] || getPrefixed('RequestAnimationFrame') || timeoutDefer;\n        cancelFn = window['cancelAnimationFrame'] || getPrefixed('CancelAnimationFrame') ||\n            getPrefixed('CancelRequestAnimationFrame') || function (id) { window.clearTimeout(id); };\n    } else {\n        requestFn = timeoutDefer;\n        cancelFn = clearTimeout;\n    }\n    /**\n     * Polyfill of RequestAnimationFrame\n     * @param  {Function} fn callback\n     * @return {Number}      request id\n     * @memberOf Util\n     */\n    requestAnimFrame = function (fn) {\n        return requestFn(fn);\n    };\n\n    /**\n     * Polyfill of cancelAnimationFrame\n     * @param  {Number}      request id\n     * @memberOf Util\n     */\n    cancelAnimFrame = function (id) {\n        if (id) {\n            cancelFn(id);\n        }\n    };\n})();\nexport { requestAnimFrame, cancelAnimFrame };\n\nexport function isSVG(url) {\n    const prefix = 'data:image/svg+xml';\n    if (url.length > 4 && url.slice(-4) === '.svg') {\n        return 1;\n    } else if (url.slice(0, prefix.length) === prefix) {\n        return 2;\n    }\n    return 0;\n}\n\n/**\n * Load a image, can be a remote one or a local file. <br>\n * If in node, a SVG image will be converted to a png file by [svg2img]{@link https://github.com/FuZhenn/node-svg2img}<br>\n * @param  {Image} img  - the image object to load.\n * @param  {Object[]} imgDesc - image's descriptor, it's an array. imgUrl[0] is the url string, imgUrl[1] is the width, imgUrl[2] is the height.\n * @private\n * @memberOf Util\n */\nexport function loadImage(img, imgDesc) {\n    /* istanbul ignore next */\n    if (IS_NODE && loadImage.node) {\n        loadImage.node(img, imgDesc);\n        return;\n    }\n    img.src = imgDesc[0];\n}\n\nlet uid = 0;\n\nexport function UID() {\n    return uid++;\n}\nexport const GUID = UID;\n\n/**\n * Parse a JSON string to a object\n * @param {String} str      - a JSON string\n * @return {Object}\n * @memberOf Util\n */\nexport function parseJSON(str) {\n    if (!str || !isString(str)) {\n        return str;\n    }\n    return JSON.parse(str);\n}\n\nexport function pushIn(dest) {\n    for (let i = 1; i < arguments.length; i++) {\n        const src = arguments[i];\n        if (src) {\n            for (let ii = 0, ll = src.length; ii < ll; ii++) {\n                dest.push(src[ii]);\n            }\n        }\n    }\n    return dest.length;\n}\n\nexport function removeFromArray(obj, array) {\n    const i = array.indexOf(obj);\n    if (i > -1) {\n        array.splice(i, 1);\n    }\n}\n\nexport function forEachCoord(arr, fn, context) {\n    if (!Array.isArray(arr)) {\n        return context ? fn.call(context, arr) : fn(arr);\n    }\n    const result = [];\n    let p, pp;\n    for (let i = 0, len = arr.length; i < len; i++) {\n        p = arr[i];\n        if (isNil(p)) {\n            result.push(null);\n            continue;\n        }\n        if (Array.isArray(p)) {\n            result.push(forEachCoord(p, fn, context));\n        } else {\n            pp = context ? fn.call(context, p) : fn(p);\n            result.push(pp);\n        }\n\n    }\n    return result;\n}\n\nexport function getValueOrDefault(v, d) {\n    return v === undefined ? d : v;\n}\n\n/**\n * Polyfill for Math.sign\n * @param  {Number} x\n * @return {Number}\n * @memberOf Util\n */\n/* istanbul ignore next */\nexport function sign(x) {\n    if (Math.sign) {\n        return Math.sign(x);\n    }\n    x = +x; // convert to a number\n    if (x === 0 || isNaN(x)) {\n        return Number(x);\n    }\n    return x > 0 ? 1 : -1;\n}\n\nexport function log2(x) {\n    if (Math.log2) {\n        return Math.log2(x);\n    }\n    const v = Math.log(x) * Math.LOG2E;\n    const rounded = Math.round(v);\n    if (Math.abs(rounded - v) < 1E-14) {\n        return rounded;\n    } else {\n        return v;\n    }\n}\n\n/*\n * Interpolate between two number.\n *\n * @param {Number} from\n * @param {Number} to\n * @param {Number} t interpolation factor between 0 and 1\n * @returns {Number} interpolated color\n */\nexport function interpolate(a, b, t) {\n    return (a * (1 - t)) + (b * t);\n}\n\n/*\n * constrain n to the given range, via modular arithmetic\n * @param {Number} n value\n * @param {Number} min the minimum value to be returned, inclusive\n * @param {Number} max the maximum value to be returned, inclusive\n * @returns {Number} constrained number\n * @private\n */\nexport function wrap(n, min, max) {\n    if (n === max || n === min) {\n        return n;\n    }\n    const d = max - min;\n    const w = ((n - min) % d + d) % d + min;\n    return w;\n}\n\n/**\n * constrain n to the given range via min + max\n *\n * @param {Number} n value\n * @param {Number} min the minimum value to be returned\n * @param {Number} max the maximum value to be returned\n * @returns {Number} the clamped value\n * @private\n */\nexport function clamp(n, min, max) {\n    return Math.min(max, Math.max(min, n));\n}\n\n/*\n * Is object an array and not empty.\n * @param {Object} obj\n * @return {Boolean} true|false\n * @private\n * @memberOf Util\n */\nexport function isArrayHasData(obj) {\n    return Array.isArray(obj) && obj.length > 0;\n}\n\n/**\n * Whether the input string is a valid url.\n * @param  {String}  url - url to check\n * @return {Boolean}\n * @memberOf Util\n * @private\n */\nexport function isURL(url) {\n    if (!url) {\n        return false;\n    }\n    const head = url.slice(0, 6);\n    if (head === 'http:/' || head === 'https:' || head === 'file:/') {\n        return true;\n    }\n    return false;\n}\n\n//改原先的regex名字为xWithQuote；不带引号的regex，/^url\\(([^\\'\\\"].*[^\\'\\\"])\\)$/i，为xWithoutQuote。然后在is函数里||测试，extract函数里if...else处理。没引号的匹配后，取matches[1]\n\n// match: url('x'), url(\"x\").\n// TODO: url(x)\nconst cssUrlReWithQuote = /^url\\((['\"])(.+)\\1\\)$/i;\n\nconst cssUrlRe = /^url\\(([^'\"].*[^'\"])\\)$/i;\n\nexport function isCssUrl(str) {\n    if (!isString(str)) {\n        return 0;\n    }\n    const head = str.slice(0, 6);\n    if (head === 'http:/' || head === 'https:') {\n        return 3;\n    }\n    if (cssUrlRe.test(str)) {\n        return 1;\n    }\n    if (cssUrlReWithQuote.test(str)) {\n        return 2;\n    }\n    return 0;\n}\n\nexport function extractCssUrl(str) {\n    const test = isCssUrl(str);\n    let matches;\n    if (test === 3) {\n        return str;\n    }\n    if (test === 1) {\n        matches = cssUrlRe.exec(str);\n        return matches[1];\n    } else if (test === 2) {\n        matches = cssUrlReWithQuote.exec(str);\n        return matches[2];\n    } else {\n        // return as is if not an css url\n        return str;\n    }\n}\n\nconst b64chrs = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n\n/**\n * btoa or a polyfill in old browsers. <br>\n * Creates a base-64 encoded ASCII string from a String object in which each character in the string is treated as a byte of binary data.<br>\n * From https://github.com/davidchambers/Base64.js\n * @param  {Buffer} input - input string to convert\n * @return {String} ascii\n * @memberOf Util\n * @example\n *     const encodedData = Util.btoa(stringToEncode);\n */\n/* istanbul ignore next */\nexport function btoa(input) {\n    if ((typeof window !== 'undefined') && window.btoa) {\n        return window.btoa(input);\n    }\n    const str = String(input);\n    let output = '';\n    for (\n        // initialize result and counter\n        let block, charCode, idx = 0, map = b64chrs;\n        // if the next str index does not exist:\n        //   change the mapping table to \"=\"\n        //   check if d has no fractional digits\n        str.charAt(idx | 0) || (map = '=', idx % 1);\n        // \"8 - idx % 1 * 8\" generates the sequence 2, 4, 6, 8\n        output += map.charAt(63 & block >> 8 - idx % 1 * 8)\n    ) {\n        charCode = str.charCodeAt(idx += 3 / 4);\n        if (charCode > 0xFF) {\n            throw new Error('\\'btoa\\' failed: The string to be encoded contains characters outside of the Latin1 range.');\n        }\n        block = block << 8 | charCode;\n    }\n    return output;\n}\n\nexport function b64toBlob(b64Data, contentType) {\n    const byteCharacters = atob(b64Data);\n    const arraybuffer = new ArrayBuffer(byteCharacters.length);\n    const view = new Uint8Array(arraybuffer);\n    for (let i = 0; i < byteCharacters.length; i++) {\n        view[i] = byteCharacters.charCodeAt(i) & 0xff;\n    }\n    const blob = new Blob([arraybuffer], { type: contentType });\n    return blob;\n}\n\n/**\n * Compute degree bewteen 2 points.\n * @param  {Point} p1 point 1\n * @param  {Point} p2 point 2\n * @return {Number}    degree between 2 points\n * @memberOf Util\n */\nexport function computeDegree(x0, y0, x1, y1) {\n    const dx = x1 - x0;\n    const dy = y1 - y0;\n    return Math.atan2(dy, dx);\n}\n\n/**\n * Transparent 1X1 gif image\n * from https://css-tricks.com/snippets/html/base64-encode-of-1x1px-transparent-gif/\n * @type {String}\n * @memberOf Util\n */\nexport const emptyImageUrl = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';\n\n\n/**\n * shallow equal\n * @param  {Object} obj1\n * @param  {Object} obj2\n * @return {Boolean}\n * @private\n * @memberOf Util\n */\nexport function equalMapView(obj1, obj2) {\n    if (!obj1 && !obj2) {\n        return true;\n    } else if (!obj1 || !obj2) {\n        return false;\n    }\n    for (const p in obj1) {\n        if (p === 'center') {\n            if (!obj2[p] || !approx(obj1[p][0], obj2[p][0]) || !approx(obj1[p][1], obj2[p][1])) {\n                return false;\n            }\n        } else if (obj1[p] !== obj2[p]) {\n            return false;\n        }\n    }\n    return true;\n}\n\nfunction approx(val, expected, delta) {\n    if (delta == null) { delta = 1e-6; }\n    return val >= expected - delta && val <= expected + delta;\n}\n\n/**\n * Flash something, show and hide by certain internal for times of count.\n *\n * @param {Number} [interval=100]     - interval of flash, in millisecond (ms)\n * @param {Number} [count=4]          - flash times\n * @param {Function} [cb=null]        - callback function when flash ended\n * @param {*} [context=null]          - callback context\n * @return {*} this\n * @private\n * @memberOf Util\n */\nexport function flash(interval, count, cb, context) {\n    if (!interval) {\n        interval = 100;\n    }\n    if (!count) {\n        count = 4;\n    }\n    const me = this;\n    count *= 2;\n    if (this._flashTimeout) {\n        clearTimeout(this._flashTimeout);\n    }\n\n    function flashGeo() {\n        if (count === 0) {\n            me.show();\n            if (cb) {\n                if (context) {\n                    cb.call(context);\n                } else {\n                    cb();\n                }\n            }\n            return;\n        }\n\n        if (count % 2 === 0) {\n            me.hide();\n        } else {\n            me.show();\n        }\n        count--;\n        me._flashTimeout = setTimeout(flashGeo, interval);\n    }\n    this._flashTimeout = setTimeout(flashGeo, interval);\n    return this;\n}\n\nexport function _defaults(obj, defaults) {\n    const keys = Object.getOwnPropertyNames(defaults);\n    for (let i = 0; i < keys.length; i++) {\n        const key = keys[i];\n        const value = Object.getOwnPropertyDescriptor(defaults, key);\n        if (value && value.configurable && obj[key] === undefined) {\n            Object.defineProperty(obj, key, value);\n        }\n    }\n    return obj;\n}\n","/*!\r\n    Feature Filter by\r\n\r\n    (c) mapbox 2016 and maptalks 2018\r\n    www.mapbox.com | www.maptalks.org\r\n    License: MIT, header required.\r\n*/\r\nconst types = ['Unknown', 'Point', 'LineString', 'Polygon', 'MultiPoint', 'MultiLineString', 'MultiPolygon', 'GeometryCollection'];\r\n\r\n/**\r\n * Given a filter expressed as nested arrays, return a new function\r\n * that evaluates whether a given feature (with a .properties or .tags property)\r\n * passes its test.\r\n *\r\n * @param {Array} filter mapbox gl filter\r\n * @returns {Function} filter-evaluating function\r\n */\r\nexport function createFilter(filter) {\r\n    return new Function('f', `var p = (f && f.properties || {}); return ${compile(filter)}`);\r\n}\r\n\r\nfunction compile(filter) {\r\n    if (!filter) return 'true';\r\n    const op = filter[0];\r\n    if (filter.length <= 1) return op === 'any' ? 'false' : 'true';\r\n    const str =\r\n        op === '==' ? compileComparisonOp(filter[1], filter[2], '===', false) :\r\n            op === '!=' ? compileComparisonOp(filter[1], filter[2], '!==', false) :\r\n                op === '<' ||\r\n                    op === '>' ||\r\n        op === '<=' ||\r\n        op === '>=' ? compileComparisonOp(filter[1], filter[2], op, true) :\r\n                    op === 'any' ? compileLogicalOp(filter.slice(1), '||') :\r\n                        op === 'all' ? compileLogicalOp(filter.slice(1), '&&') :\r\n                            op === 'none' ? compileNegation(compileLogicalOp(filter.slice(1), '||')) :\r\n                                op === 'in' ? compileInOp(filter[1], filter.slice(2)) :\r\n                                    op === '!in' ? compileNegation(compileInOp(filter[1], filter.slice(2))) :\r\n                                        op === 'has' ? compileHasOp(filter[1]) :\r\n                                            op === '!has' ? compileNegation(compileHasOp(filter[1])) :\r\n                                                'true';\r\n    return `(${str})`;\r\n}\r\n\r\nfunction compilePropertyReference(property) {\r\n    // const ref =\r\n    //     property === '$type' ? 'f.type' :\r\n    //         property === '$id' ? 'f.id' : `p[${JSON.stringify(property)}]`;\r\n    // return ref;\r\n    return property[0] === '$' ? 'f.' + property.substring(1) : 'p[' + JSON.stringify(property) + ']';\r\n}\r\n\r\nfunction compileComparisonOp(property, value, op, checkType) {\r\n    const left = compilePropertyReference(property);\r\n    const right = property === '$type' ? types.indexOf(value) : JSON.stringify(value);\r\n    return (checkType ? `typeof ${left}=== typeof ${right}&&` : '') + left + op + right;\r\n}\r\n\r\nfunction compileLogicalOp(expressions, op) {\r\n    return expressions.map(compile).join(op);\r\n}\r\n\r\nfunction compileInOp(property, values) {\r\n    if (property === '$type') values = values.map((value) => {\r\n        return types.indexOf(value);\r\n    });\r\n    const left = JSON.stringify(values.sort(compare));\r\n    const right = compilePropertyReference(property);\r\n\r\n    if (values.length <= 200) return `${left}.indexOf(${right}) !== -1`;\r\n\r\n    return `function(v, a, i, j) {\r\n        while (i <= j) { var m = (i + j) >> 1;\r\n            if (a[m] === v) return true; if (a[m] > v) j = m - 1; else i = m + 1;\r\n        }\r\n    return false; }(${right}, ${left},0,${values.length - 1})`;\r\n}\r\n\r\nfunction compileHasOp(property) {\r\n    return property === '$id' ? '\"id\" in f' : `${JSON.stringify(property)} in p`;\r\n}\r\n\r\nfunction compileNegation(expression) {\r\n    return `!(${expression})`;\r\n}\r\n\r\n// Comparison function to sort numbers and strings\r\nfunction compare(a, b) {\r\n    return a < b ? -1 : a > b ? 1 : 0;\r\n}\r\n\r\n/**\r\n * Get feature object from a geometry for filter functions.\r\n * @param  {Geometry} geometry geometry\r\n * @return {Object}          feature for filter functions\r\n */\r\nexport function getFilterFeature(geometry) {\r\n    const json = geometry._toJSON(),\r\n        g = json['feature'];\r\n    g['type'] = types.indexOf(g['geometry']['type']);\r\n    g['subType'] = json['subType'];\r\n    return g;\r\n}\r\n\r\n/**\r\n * Compile layer's style, styles to symbolize layer's geometries, e.g.<br>\r\n * <pre>\r\n * [\r\n *   {\r\n *     'filter' : ['==', 'foo', 'val'],\r\n *     'symbol' : {'markerFile':'foo.png'}\r\n *   }\r\n * ]\r\n * </pre>\r\n * @param  {Object|Object[]} styles - style to compile\r\n * @return {Object[]}       compiled styles\r\n */\r\nexport function compileStyle(styles) {\r\n    if (!Array.isArray(styles)) {\r\n        return compileStyle([styles]);\r\n    }\r\n    const compiled = [];\r\n    for (let i = 0; i < styles.length; i++) {\r\n        let filter;\r\n        if (styles[i]['filter'] === true) {\r\n            filter = function () { return true; };\r\n        } else {\r\n            filter = createFilter(styles[i]['filter']);\r\n        }\r\n        compiled.push(extend({}, styles[i], {\r\n            filter : filter\r\n        }));\r\n    }\r\n    return compiled;\r\n}\r\n\r\nfunction extend(dest) { // (Object[, Object, ...]) ->\r\n    for (let i = 1; i < arguments.length; i++) {\r\n        const src = arguments[i];\r\n        for (const k in src) {\r\n            dest[k] = src[k];\r\n        }\r\n    }\r\n    return dest;\r\n}\r\n","/*eslint-disable no-var, prefer-const*/\r\nfunction createFunction(parameters, defaultType) {\r\n    var fun;\r\n\r\n    if (!isFunctionDefinition(parameters)) {\r\n        fun = function () { return parameters; };\r\n        // fun.isFeatureConstant = true;\r\n        // fun.isZoomConstant = true;\r\n\r\n    } else {\r\n        var zoomAndFeatureDependent = parameters.stops && typeof parameters.stops[0][0] === 'object';\r\n        var featureDependent = zoomAndFeatureDependent || parameters.property !== undefined;\r\n        var zoomDependent = zoomAndFeatureDependent || !featureDependent;\r\n        var type = parameters.type || defaultType || 'exponential';\r\n\r\n        var innerFun;\r\n        if (type === 'exponential') {\r\n            innerFun = evaluateExponentialFunction;\r\n        } else if (type === 'interval') {\r\n            innerFun = evaluateIntervalFunction;\r\n        } else if (type === 'categorical') {\r\n            innerFun = evaluateCategoricalFunction;\r\n        } else if (type === 'identity') {\r\n            innerFun = evaluateIdentityFunction;\r\n        } else {\r\n            throw new Error('Unknown function type \"' + type + '\"');\r\n        }\r\n\r\n        if (zoomAndFeatureDependent) {\r\n            var featureFunctions = {};\r\n            var featureFunctionStops = [];\r\n            for (let s = 0; s < parameters.stops.length; s++) {\r\n                var stop = parameters.stops[s];\r\n                if (featureFunctions[stop[0].zoom] === undefined) {\r\n                    featureFunctions[stop[0].zoom] = {\r\n                        zoom: stop[0].zoom,\r\n                        type: parameters.type,\r\n                        property: parameters.property,\r\n                        default: parameters.default,\r\n                        stops: []\r\n                    };\r\n                }\r\n                featureFunctions[stop[0].zoom].stops.push([stop[0].value, stop[1]]);\r\n            }\r\n\r\n            for (let z in featureFunctions) {\r\n                featureFunctionStops.push([featureFunctions[z].zoom, createFunction(featureFunctions[z])]);\r\n            }\r\n            fun = function (zoom, feature) {\r\n                return evaluateExponentialFunction({ stops: featureFunctionStops, base: parameters.base }, zoom)(zoom, feature);\r\n            };\r\n            // fun.isFeatureConstant = false;\r\n            // fun.isZoomConstant = false;\r\n\r\n        } else if (zoomDependent) {\r\n            fun = function (zoom) {\r\n                return innerFun(parameters, zoom);\r\n            };\r\n            // fun.isFeatureConstant = true;\r\n            // fun.isZoomConstant = false;\r\n        } else {\r\n            fun = function (zoom, feature) {\r\n                return innerFun(parameters, feature ? feature[parameters.property] : null);\r\n            };\r\n            // fun.isFeatureConstant = false;\r\n            // fun.isZoomConstant = true;\r\n        }\r\n    }\r\n\r\n    return fun;\r\n}\r\n\r\nfunction coalesce(a, b, c) {\r\n    if (a !== undefined) return a;\r\n    if (b !== undefined) return b;\r\n    if (c !== undefined) return c;\r\n    return null;\r\n}\r\n\r\nfunction evaluateCategoricalFunction(parameters, input) {\r\n    for (let i = 0; i < parameters.stops.length; i++) {\r\n        if (input === parameters.stops[i][0]) {\r\n            return parameters.stops[i][1];\r\n        }\r\n    }\r\n    return parameters.default;\r\n}\r\n\r\nfunction evaluateIntervalFunction(parameters, input) {\r\n    for (var i = 0; i < parameters.stops.length; i++) {\r\n        if (input < parameters.stops[i][0]) break;\r\n    }\r\n    return parameters.stops[Math.max(i - 1, 0)][1];\r\n}\r\n\r\nfunction evaluateExponentialFunction(parameters, input) {\r\n    var base = parameters.base !== undefined ? parameters.base : 1;\r\n\r\n    var i = 0;\r\n    while (true) {\r\n        if (i >= parameters.stops.length) break;\r\n        else if (input <= parameters.stops[i][0]) break;\r\n        else i++;\r\n    }\r\n\r\n    if (i === 0) {\r\n        return parameters.stops[i][1];\r\n\r\n    } else if (i === parameters.stops.length) {\r\n        return parameters.stops[i - 1][1];\r\n\r\n    } else {\r\n        return interpolate(\r\n            input,\r\n            base,\r\n            parameters.stops[i - 1][0],\r\n            parameters.stops[i][0],\r\n            parameters.stops[i - 1][1],\r\n            parameters.stops[i][1]\r\n        );\r\n    }\r\n}\r\n\r\nfunction evaluateIdentityFunction(parameters, input) {\r\n    return coalesce(input, parameters.default);\r\n}\r\n\r\nfunction interpolate(input, base, inputLower, inputUpper, outputLower, outputUpper) {\r\n    if (typeof outputLower === 'function') {\r\n        return function () {\r\n            var evaluatedLower = outputLower.apply(undefined, arguments);\r\n            var evaluatedUpper = outputUpper.apply(undefined, arguments);\r\n            return interpolate(input, base, inputLower, inputUpper, evaluatedLower, evaluatedUpper);\r\n        };\r\n    } else if (outputLower.length) {\r\n        return interpolateArray(input, base, inputLower, inputUpper, outputLower, outputUpper);\r\n    } else {\r\n        return interpolateNumber(input, base, inputLower, inputUpper, outputLower, outputUpper);\r\n    }\r\n}\r\n\r\nfunction interpolateNumber(input, base, inputLower, inputUpper, outputLower, outputUpper) {\r\n    var difference =  inputUpper - inputLower;\r\n    var progress = input - inputLower;\r\n\r\n    var ratio;\r\n    if (base === 1) {\r\n        ratio = progress / difference;\r\n    } else {\r\n        ratio = (Math.pow(base, progress) - 1) / (Math.pow(base, difference) - 1);\r\n    }\r\n\r\n    return (outputLower * (1 - ratio)) + (outputUpper * ratio);\r\n}\r\n\r\nfunction interpolateArray(input, base, inputLower, inputUpper, outputLower, outputUpper) {\r\n    var output = [];\r\n    for (let i = 0; i < outputLower.length; i++) {\r\n        output[i] = interpolateNumber(input, base, inputLower, inputUpper, outputLower[i], outputUpper[i]);\r\n    }\r\n    return output;\r\n}\r\n\r\n/**\r\n * Check if object is a definition of function type\r\n * @param  {Object}  obj object\r\n * @return {Boolean}\r\n * @memberOf MapboxUtil\r\n */\r\nexport function isFunctionDefinition(obj) {\r\n    return obj && typeof obj === 'object' && (obj.stops || obj.property && obj.type === 'identity');\r\n}\r\n\r\n/**\r\n * Check if obj's properties has function definition\r\n * @param  {Object}  obj object to check\r\n * @return {Boolean}\r\n * @memberOf MapboxUtil\r\n */\r\nexport function hasFunctionDefinition(obj) {\r\n    for (const p in obj) {\r\n        if (isFunctionDefinition(obj[p])) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nexport function interpolated(parameters) {\r\n    return createFunction(parameters, 'exponential');\r\n}\r\n\r\n\r\nexport function piecewiseConstant(parameters) {\r\n    return createFunction(parameters, 'interval');\r\n}\r\n\r\n/**\r\n * Load function types defined in object\r\n * @param  {Object[]} parameters parameters\r\n * @return {Object}   loaded object\r\n * @memberOf MapboxUtil\r\n */\r\nexport function loadFunctionTypes(obj, argFn) {\r\n    if (!obj) {\r\n        return null;\r\n    }\r\n    var hit = false;\r\n    if (Array.isArray(obj)) {\r\n        var multResult = [],\r\n            loaded;\r\n        for (let i = 0; i < obj.length; i++) {\r\n            loaded = loadFunctionTypes(obj[i], argFn);\r\n            if (!loaded) {\r\n                multResult.push(obj[i]);\r\n            } else {\r\n                multResult.push(loaded);\r\n                hit = true;\r\n            }\r\n        }\r\n        return hit ? multResult : obj;\r\n    }\r\n    var result = {\r\n            '__fn_types_loaded' : true\r\n        },\r\n        props = [],\r\n        p;\r\n    for (p in obj) {\r\n        if (obj.hasOwnProperty(p)) {\r\n            props.push(p);\r\n        }\r\n    }\r\n\r\n    const buildFn = function (p) {\r\n        Object.defineProperty(result, p, {\r\n            get: function () {\r\n                if (!this['__fn_' + p]) {\r\n                    this['__fn_' + p] = interpolated(this['_' + p]);\r\n                }\r\n                return this['__fn_' + p].apply(this, argFn());\r\n            },\r\n            set: function (v) {\r\n                this['_' + p] = v;\r\n            },\r\n            configurable: true,\r\n            enumerable: true\r\n        });\r\n    };\r\n\r\n    for (let i = 0, len = props.length; i < len; i++) {\r\n        p = props[i];\r\n        if (isFunctionDefinition(obj[p])) {\r\n            hit = true;\r\n            result['_' + p] = obj[p];\r\n            buildFn(p);\r\n        } else {\r\n            result[p] = obj[p];\r\n        }\r\n    }\r\n    return hit ? result : obj;\r\n}\r\n\r\n/**\r\n * Get external resources in the function type\r\n * @param  {Object} t Function type definition\r\n * @return {String[]}   resouces\r\n * @memberOf MapboxUtil\r\n */\r\nexport function getFunctionTypeResources(t) {\r\n    if (!t || !t.stops) {\r\n        return [];\r\n    }\r\n    const res = [];\r\n    for (let i = 0, l = t.stops.length; i < l; i++) {\r\n        res.push(t.stops[i][1]);\r\n    }\r\n    return res;\r\n}\r\n/*eslint-enable no-var, prefer-const*/\r\n","import { RESOURCE_PROPERTIES, RESOURCE_SIZE_PROPERTIES } from '../Constants';\nimport { IS_NODE } from './env';\nimport { extend, isNil, isNumber, isString } from './common';\nimport { isURL, extractCssUrl, btoa } from './util';\nimport { isFunctionDefinition, getFunctionTypeResources } from '../mapbox';\n\n\n/**\n * Translate symbol properties to SVG properties\n * @param  {Object} s - object with symbol properties\n * @return {Object}   object with SVG properties\n * @memberOf Util\n */\nexport function translateToSVGStyles(s) {\n    const result = {\n        'stroke': {\n            'stroke': s['markerLineColor'],\n            'stroke-width': s['markerLineWidth'],\n            'stroke-opacity': s['markerLineOpacity'],\n            'stroke-dasharray': null,\n            'stroke-linecap': 'butt',\n            'stroke-linejoin': 'round'\n        },\n        'fill': {\n            'fill': s['markerFill'],\n            'fill-opacity': s['markerFillOpacity']\n        }\n    };\n    if (result['stroke']['stroke-width'] === 0) {\n        result['stroke']['stroke-opacity'] = 0;\n    }\n    return result;\n}\n\n/**\n * Get SVG Base64 String from a marker symbol with (markerType : path)\n * @param  {Object} symbol - symbol with markerType of path\n * @return {String}        SVG Base64 String\n * @memberOf Util\n */\nexport function getMarkerPathBase64(symbol, width, height) {\n    if (!symbol['markerPath']) {\n        return null;\n    }\n    let op = 1;\n    const styles = translateToSVGStyles(symbol);\n    //context.globalAlpha doesn't take effect with drawing SVG in IE9/10/11 and EGDE, so set opacity in SVG element.\n    if (isNumber(symbol['markerOpacity'])) {\n        op = symbol['markerOpacity'];\n    }\n    if (isNumber(symbol['opacity'])) {\n        op *= symbol['opacity'];\n    }\n    const svgStyles = {};\n    if (styles) {\n        for (const p in styles['stroke']) {\n            if (styles['stroke'].hasOwnProperty(p)) {\n                if (!isNil(styles['stroke'][p])) {\n                    svgStyles[p] = styles['stroke'][p];\n                }\n            }\n        }\n        for (const p in styles['fill']) {\n            if (styles['fill'].hasOwnProperty(p)) {\n                if (!isNil(styles['fill'][p])) {\n                    svgStyles[p] = styles['fill'][p];\n                }\n            }\n        }\n    }\n\n    const pathes = Array.isArray(symbol['markerPath']) ? symbol['markerPath'] : [symbol['markerPath']];\n    let path;\n    const pathesToRender = [];\n    for (let i = 0; i < pathes.length; i++) {\n        path = isString(pathes[i]) ? {\n            'path': pathes[i]\n        } : pathes[i];\n        path = extend({}, path, svgStyles);\n        path['d'] = path['path'];\n        delete path['path'];\n        pathesToRender.push(path);\n    }\n    const svg = ['<svg version=\"1.1\"', 'xmlns=\"http://www.w3.org/2000/svg\"'];\n    if (op < 1) {\n        svg.push('opacity=\"' + op + '\"');\n    }\n    // if (symbol['markerWidth'] && symbol['markerHeight']) {\n    //     svg.push('height=\"' + symbol['markerHeight'] + '\" width=\"' + symbol['markerWidth'] + '\"');\n    // }\n    if (symbol['markerPathWidth'] && symbol['markerPathHeight']) {\n        svg.push('viewBox=\"0 0 ' + symbol['markerPathWidth'] + ' ' + symbol['markerPathHeight'] + '\"');\n    }\n    svg.push('preserveAspectRatio=\"none\"');\n    if (width) {\n        svg.push('width=\"' + width + '\"');\n    }\n    if (height) {\n        svg.push('height=\"' + height + '\"');\n    }\n    svg.push('><defs></defs>');\n\n    for (let i = 0; i < pathesToRender.length; i++) {\n        let strPath = '<path ';\n        for (const p in pathesToRender[i]) {\n            if (pathesToRender[i].hasOwnProperty(p)) {\n                strPath += ' ' + p + '=\"' + pathesToRender[i][p] + '\"';\n            }\n        }\n        strPath += '></path>';\n        svg.push(strPath);\n    }\n    svg.push('</svg>');\n    const b64 = 'data:image/svg+xml;base64,' + btoa(svg.join(' '));\n    return b64;\n}\n\n/**\n * Get external resources from the given symbol\n * @param  {Object} symbol      - symbol\n * @param  {Boolean} toAbsolute - whether convert url to aboslute\n * @return {String[]}           - resource urls\n * @memberOf Util\n */\nexport function getExternalResources(symbol, toAbsolute) {\n    if (!symbol) {\n        return [];\n    }\n    let symbols = symbol;\n    if (!Array.isArray(symbol)) {\n        symbols = [symbol];\n    }\n    const resources = [];\n    const props = RESOURCE_PROPERTIES;\n    let res, resSizeProp;\n    let w, h;\n    for (let i = symbols.length - 1; i >= 0; i--) {\n        symbol = symbols[i];\n        if (!symbol) {\n            continue;\n        }\n        if (toAbsolute) {\n            symbol = convertResourceUrl(symbol);\n        }\n        for (let ii = 0; ii < props.length; ii++) {\n            res = symbol[props[ii]];\n            if (isFunctionDefinition(res)) {\n                res = getFunctionTypeResources(res);\n            }\n            if (!res) {\n                continue;\n            }\n            if (!Array.isArray(res)) {\n                res = [res];\n            }\n            for (let iii = 0; iii < res.length; iii++) {\n                if (res[iii].slice(0, 4) === 'url(') {\n                    res[iii] = extractCssUrl(res[iii]);\n                }\n                resSizeProp = RESOURCE_SIZE_PROPERTIES[ii];\n                resources.push([res[iii], symbol[resSizeProp[0]], symbol[resSizeProp[1]]]);\n            }\n        }\n        if (symbol['markerType'] === 'path' && symbol['markerPath']) {\n            w = isFunctionDefinition(symbol['markerWidth']) ? 200 : symbol['markerWidth'];\n            h = isFunctionDefinition(symbol['markerHeight']) ? 200 : symbol['markerHeight'];\n            if (isFunctionDefinition(symbol['markerPath'])) {\n                res = getFunctionTypeResources(symbol['markerPath']);\n                const path = symbol['markerPath'];\n                for (let iii = 0; iii < res.length; iii++) {\n                    symbol['markerPath'] = res[iii];\n                    resources.push([getMarkerPathBase64(symbol), w, h]);\n                }\n                symbol['markerPath'] = path;\n            } else {\n                resources.push([getMarkerPathBase64(symbol), w, h]);\n            }\n        }\n    }\n    return resources;\n}\n\n/**\n * Convert symbol's resources' urls from relative path to an absolute path.\n * @param  {Object} symbol\n * @private\n * @memberOf Util\n */\nexport function convertResourceUrl(symbol) {\n    if (!symbol) {\n        return null;\n    }\n\n    const s = symbol;\n    if (IS_NODE) {\n        return s;\n    }\n    const props = RESOURCE_PROPERTIES;\n    let res;\n    for (let ii = 0, len = props.length; ii < len; ii++) {\n        res = s[props[ii]];\n        if (!res) {\n            continue;\n        }\n        s[props[ii]] = _convertUrlToAbsolute(res);\n    }\n    return s;\n}\n\nfunction _convertUrlToAbsolute(res) {\n    if (isFunctionDefinition(res)) {\n        const stops = res.stops;\n        for (let i = 0; i < stops.length; i++) {\n            stops[i][1] = _convertUrlToAbsolute(stops[i][1]);\n        }\n        return res;\n    }\n    const embed = 'data:';\n    if (res.slice(0, 4) === 'url(') {\n        res = extractCssUrl(res);\n    }\n    if (!isURL(res) &&\n        (res.length <= embed.length || res.substring(0, embed.length) !== embed)) {\n        res = _absolute(location.href, res);\n    }\n    return res;\n}\n\nfunction _absolute(base, relative) {\n    const stack = base.split('/'),\n        parts = relative.split('/');\n    if (relative.slice(0, 1) === 0) {\n        return stack.slice(0, 3).join('/') + relative;\n    } else {\n        stack.pop(); // remove current file name (or empty string)\n        // (omit if \"base\" is the current folder without trailing slash)\n        for (let i = 0; i < parts.length; i++) {\n            if (parts[i] === '.')\n                continue;\n            if (parts[i] === '..')\n                stack.pop();\n            else\n                stack.push(parts[i]);\n        }\n        return stack.join('/');\n    }\n}\n","import { extend, isNil, isFunction, hasOwn } from './common';\n\n/**\n * Whether the color is a gradient\n * @param  {Object}  g - color to test\n * @return {Boolean}\n * @memberOf Util\n */\nexport function isGradient(g) {\n    return g && g['colorStops'];\n}\n\n/**\n * Get stamp of a gradient color object.\n * @param  {Object} g gradient color object\n * @return {String}     gradient stamp\n * @memberOf Util\n */\nexport function getGradientStamp(g) {\n    const keys = [g['type']];\n    if (g['places']) {\n        keys.push(g['places'].join());\n    }\n    if (g['colorStops']) {\n        const stops = [];\n        for (let i = g['colorStops'].length - 1; i >= 0; i--) {\n            stops.push(g['colorStops'][i].join());\n        }\n        keys.push(stops.join(','));\n    }\n    return keys.join('_');\n}\n\n/**\n * Get stamp of a symbol\n * @param  {Object|Object[]} symbol symbol\n * @return {String}        symbol's stamp\n * @memberOf Util\n */\nexport function getSymbolStamp(symbol) {\n    const keys = [];\n    if (Array.isArray(symbol)) {\n        for (let i = 0; i < symbol.length; i++) {\n            keys.push(getSymbolStamp(symbol[i]));\n        }\n        return '[ ' + keys.join(' , ') + ' ]';\n    }\n    for (const p in symbol) {\n        if (hasOwn(symbol, p)) {\n            if (!isFunction(symbol[p])) {\n                if (isGradient(symbol[p])) {\n                    keys.push(p + '=' + getGradientStamp(symbol[p]));\n                } else {\n                    keys.push(p + '=' + symbol[p]);\n                }\n            }\n        }\n    }\n    return keys.join(';');\n}\n\n/**\n * Reduce opacity of the color by ratio\n * @param  {Object|Object[]} symbol symbols to set\n * @param  {Number} ratio  ratio of opacity to reduce\n * @return {Object|Object[]}      new symbol or symbols\n * @memberOf Util\n */\nexport function lowerSymbolOpacity(symbol, ratio) {\n    function s(_symbol, _ratio) {\n        const op = _symbol['opacity'];\n        if (isNil(op)) {\n            _symbol['opacity'] = _ratio;\n        } else {\n            _symbol['opacity'] *= _ratio;\n        }\n    }\n    let lower;\n    if (Array.isArray(symbol)) {\n        lower = [];\n        for (let i = 0; i < symbol.length; i++) {\n            const d = extend({}, symbol[i]);\n            s(d, ratio);\n            lower.push(d);\n        }\n    } else {\n        lower = extend({}, symbol);\n        s(lower, ratio);\n    }\n    return lower;\n}\n\n/**\n * Merges the properties of sources into the symbol. <br>\n * @param  {Object|Object[]} symbol symbol to extend\n * @param  {...Object} src - sources\n * @return {Object|Object[]}        merged symbol\n * @memberOf Util\n */\nexport function extendSymbol(symbol) {\n    let sources = Array.prototype.slice.call(arguments, 1);\n    if (!sources || !sources.length) {\n        sources = [{}];\n    }\n    if (Array.isArray(symbol)) {\n        let s, dest;\n        const result = [];\n        for (let i = 0, l = symbol.length; i < l; i++) {\n            s = symbol[i];\n            dest = {};\n            for (let ii = 0, ll = sources.length; ii < ll; ii++) {\n                if (!Array.isArray(sources[ii])) {\n                    extend(dest, s, sources[ii] ? sources[ii] : {});\n                } else if (!isNil(sources[ii][i])) {\n                    extend(dest, s, sources[ii][i]);\n                } else {\n                    extend(dest, s ? s : {});\n                }\n            }\n            result.push(dest);\n        }\n        return result;\n    } else {\n        const args = [{}, symbol];\n        args.push.apply(args, sources);\n        return extend.apply(this, args);\n    }\n}\n","import { IS_NODE } from './util';\n\nlet Browser = {};\n\nif (!IS_NODE) {\n    const ua = navigator.userAgent.toLowerCase(),\n        doc = document.documentElement,\n\n        ie = 'ActiveXObject' in window,\n\n        webkit = ua.indexOf('webkit') !== -1,\n        phantomjs = ua.indexOf('phantom') !== -1,\n        android23 = ua.search('android [23]') !== -1,\n        chrome = ua.indexOf('chrome') !== -1,\n        gecko = ua.indexOf('gecko') !== -1 && !webkit && !window.opera && !ie,\n\n        mobile = typeof orientation !== 'undefined' || ua.indexOf('mobile') !== -1,\n        msPointer = !window.PointerEvent && window.MSPointerEvent,\n        pointer = (window.PointerEvent && navigator.pointerEnabled) || msPointer,\n\n        ie3d = ie && ('transition' in doc.style),\n        webkit3d = ('WebKitCSSMatrix' in window) && ('m11' in new window.WebKitCSSMatrix()) && !android23,\n        gecko3d = 'MozPerspective' in doc.style,\n        opera12 = 'OTransition' in doc.style,\n        any3d = (ie3d || webkit3d || gecko3d) && !opera12 && !phantomjs;\n\n    let chromeVersion = 0;\n    if (chrome) {\n        chromeVersion = ua.match(/chrome\\/([\\d.]+)/)[1];\n    }\n\n    const touch = !phantomjs && (pointer || 'ontouchstart' in window ||\n        (window.DocumentTouch && document instanceof window.DocumentTouch));\n\n    let webgl;\n    try {\n        const canvas = document.createElement('canvas');\n        const gl = canvas.getContext('webgl') ||\n            canvas.getContext('experimental-webgl');\n        webgl = gl && gl instanceof WebGLRenderingContext;\n    } catch (err) {\n        webgl = false;\n    }\n\n    const devicePixelRatio = (window.devicePixelRatio || (window.screen.deviceXDPI / window.screen.logicalXDPI));\n\n    Browser = {\n        ie: ie,\n        ielt9: ie && !document.addEventListener,\n        edge: 'msLaunchUri' in navigator && !('documentMode' in document),\n        webkit: webkit,\n        gecko: gecko,\n        android: ua.indexOf('android') !== -1,\n        android23: android23,\n        chrome: chrome,\n        chromeVersion : chromeVersion,\n        safari: !chrome && ua.indexOf('safari') !== -1,\n        phantomjs: phantomjs,\n\n        ie3d: ie3d,\n        webkit3d: webkit3d,\n        gecko3d: gecko3d,\n        opera12: opera12,\n        any3d: any3d,\n\n        mobile: mobile,\n        mobileWebkit: mobile && webkit,\n        mobileWebkit3d: mobile && webkit3d,\n        mobileOpera: mobile && window.opera,\n        mobileGecko: mobile && gecko,\n\n        touch: !!touch,\n        msPointer: !!msPointer,\n        pointer: !!pointer,\n\n        retina: devicePixelRatio > 1,\n        devicePixelRatio,\n\n        language: navigator.browserLanguage ? navigator.browserLanguage : navigator.language,\n        ie9: (ie && document.documentMode === 9),\n        ie10: (ie && document.documentMode === 10),\n\n        webgl : webgl\n    };\n}\n\nexport default Browser;\n","import { isNil } from '../core/util';\n\n/**\n * Abstract parent class for Point and Coordinate\n * @abstract\n * @category basic types\n */\nclass Position {\n\n    constructor(x, y) {\n        if (!isNil(x) && !isNil(y)) {\n            /**\n             * @property x {Number} - x value\n             */\n            this.x = +(x);\n            /**\n             * @property y {Number} - y value\n             */\n            this.y = +(y);\n        } else if (!isNil(x.x) && !isNil(x.y)) {\n            this.x = +(x.x);\n            this.y = +(x.y);\n        } else if (Array.isArray(x)) {\n            this.x = +(x[0]);\n            this.y = +(x[1]);\n        }\n        if (this._isNaN()) {\n            throw new Error('Position is NaN');\n        }\n    }\n\n    /**\n     * Return abs value of the point\n     * @return {Coordinate|Point} abs point\n     */\n    abs() {\n        return new this.constructor(Math.abs(this.x), Math.abs(this.y));\n    }\n\n    //destructive abs\n    _abs() {\n        this.x = Math.abs(this.x);\n        this.y = Math.abs(this.y);\n        return this;\n    }\n\n    _round() {\n        this.x = Math.round(this.x);\n        this.y = Math.round(this.y);\n        return this;\n    }\n\n    /**\n     * Like math.round, rounding the point's xy.\n     * @return {Coordinate|Point} rounded point\n     */\n    round() {\n        return new this.constructor(Math.round(this.x), Math.round(this.y));\n    }\n\n    _ceil() {\n        this.x = Math.ceil(this.x);\n        this.y = Math.ceil(this.y);\n        return this;\n    }\n\n    ceil() {\n        return new this.constructor(Math.ceil(this.x), Math.ceil(this.y));\n    }\n\n    _floor() {\n        this.x = Math.floor(this.x);\n        this.y = Math.floor(this.y);\n        return this;\n    }\n\n    floor() {\n        return new this.constructor(Math.floor(this.x), Math.floor(this.y));\n    }\n\n    /**\n     * Returns a copy of the coordinate\n     * @return {Coordinate|Point} copy\n     */\n    copy() {\n        return new this.constructor(this.x, this.y);\n    }\n\n    //destructive add\n    _add(x, y) {\n        if (!isNil(x.x)) {\n            this.x += x.x;\n            this.y += x.y;\n        } else if (!isNil(x[0])) {\n            this.x += x[0];\n            this.y += x[1];\n        } else {\n            this.x += x;\n            this.y += y;\n        }\n        return this;\n    }\n\n    /**\n     * Returns the result of addition of another coordinate.\n     * @param {Coordinate|Point|Array|Number} x - coordinate to add\n     * @param {Number} [y=undefined] - optional, coordinate to add\n     * @return {Coordinate|Point} result\n     */\n    add(x, y) {\n        let nx, ny;\n        if (!isNil(x.x)) {\n            nx = this.x + x.x;\n            ny = this.y + x.y;\n        } else if (!isNil(x[0])) {\n            nx = this.x + x[0];\n            ny = this.y + x[1];\n        } else {\n            nx = this.x + x;\n            ny = this.y + y;\n        }\n        return new this.constructor(nx, ny);\n    }\n\n    //destructive substract\n    _sub(x, y) {\n        if (!isNil(x.x)) {\n            this.x -= x.x;\n            this.y -= x.y;\n        } else if (!isNil(x[0])) {\n            this.x -= x[0];\n            this.y -= x[1];\n        } else {\n            this.x -= x;\n            this.y -= y;\n        }\n        return this;\n    }\n\n    _substract() {\n        return this._sub.apply(this, arguments);\n    }\n\n    /**\n     * Returns the result of subtraction of another coordinate.\n     * @param {Coordinate|Point|Array|Number} x - coordinate to add\n     * @param {Number} [y=undefined] - optional, coordinate to add\n     * @return {Coordinate|Point} result\n     */\n    sub(x, y) {\n        let nx, ny;\n        if (!isNil(x.x)) {\n            nx = this.x - x.x;\n            ny = this.y - x.y;\n        } else if (!isNil(x[0])) {\n            nx = this.x - x[0];\n            ny = this.y - x[1];\n        } else {\n            nx = this.x - x;\n            ny = this.y - y;\n        }\n        return new this.constructor(nx, ny);\n    }\n\n    /**\n     * Alias for sub\n     * @param {Coordinate|Point|Array|Number} x - coordinate to add\n     * @param {Number} [y=undefined] - optional, coordinate to add\n     * @return {Coordinate|Point} result\n     */\n    substract() {\n        return this.sub.apply(this, arguments);\n    }\n\n    /**\n     * Returns the result of multiplication of the current coordinate by the given number.\n     * @param {Number} ratio - ratio to multi\n     * @return {Coordinate|Point} result\n     */\n    multi(ratio) {\n        return new this.constructor(this.x * ratio, this.y * ratio);\n    }\n\n    _multi(ratio) {\n        this.x *= ratio;\n        this.y *= ratio;\n        return this;\n    }\n\n    /**\n     * Returns the result of division of the current point by the given number.\n     * @param {Number} n - number to div\n     * @return {Coordinate|Point} result\n     */\n    div(n) {\n        return this.multi(1 / n);\n    }\n\n    _div(n) {\n        return this._multi(1 / n);\n    }\n\n    /**\n     * Compare with another coordinate to see whether they are equal.\n     * @param {Coordinate|Point} c - coordinate to compare\n     * @return {Boolean}\n     */\n    equals(c) {\n        if (!(c instanceof this.constructor)) {\n            return false;\n        }\n        return this.x === c.x && this.y === c.y;\n    }\n\n    /**\n     * Whether the coordinate is NaN\n     * @return {Boolean}\n     * @private\n     */\n    _isNaN() {\n        return isNaN(this.x) || isNaN(this.y);\n    }\n\n    /**\n     * Whether the coordinate/point is zero\n     */\n    isZero() {\n        return this.x === 0 && this.y === 0;\n    }\n\n    /**\n     * Convert to a number array [x, y]\n     * @return {Number[]} number array\n     */\n    toArray() {\n        return [this.x, this.y];\n    }\n\n    /**\n     * Formats coordinate number using fixed-point notation.\n     * @param  {Number} n The number of digits to appear after the decimal point\n     * @return {Coordinate}   fixed coordinate\n     */\n    toFixed(n) {\n        return new this.constructor(this.x.toFixed(n), this.y.toFixed(n));\n    }\n\n    /**\n     * Convert to a json object {x : .., y : ..}\n     * @return {Object} json\n     */\n    toJSON() {\n        return {\n            x: this.x,\n            y: this.y\n        };\n    }\n}\n\nexport default Position;\n","import Position from './Position';\n\n/**\n * Represents a 2d point.<br>\n * Can be created in serveral ways:\n * @example\n * var point = new Point(1000, 1000);\n * @example\n * var point = new Point([1000,1000]);\n * @example\n * var point = new Point({x:1000, y:1000});\n * @category basic types\n */\nclass Point extends Position {\n\n    /**\n     * Compare with another point with a delta\n     * @param {Point} p\n     * @param {Number} delta\n     * @return {Boolean}\n     */\n    closeTo(p, delta) {\n        if (!delta) {\n            delta = 0;\n        }\n        return this.x >= (p.x - delta) && this.x <= (p.x + delta) &&\n            this.y >= (p.y - delta) && this.y <= (p.y + delta);\n    }\n\n    /**\n     * Returns the distance between the current and the given point.\n     * @param  {Point} point - another point\n     * @return {Number} distance\n     */\n    distanceTo(point) {\n        const x = point.x - this.x,\n            y = point.y - this.y;\n        return Math.sqrt(x * x + y * y);\n    }\n\n    /**\n     * Return the magitude of this point: this is the Euclidean\n     * distance from the 0, 0 coordinate to this point's x and y\n     * coordinates.\n     * @return {Number} magnitude\n     */\n    mag() {\n        return Math.sqrt(this.x * this.x + this.y * this.y);\n    }\n\n    /**\n     * Calculate this point but as a unit vector from 0, 0, meaning\n     * that the distance from the resulting point to the 0, 0\n     * coordinate will be equal to 1 and the angle from the resulting\n     * point to the 0, 0 coordinate will be the same as before.\n     * @return {Point} unit vector point\n     */\n    unit() {\n        return this.copy()._unit();\n    }\n\n    _unit() {\n        this._div(this.mag());\n        return this;\n    }\n\n    /**\n     * Compute a perpendicular point, where the new y coordinate\n     * is the old x coordinate and the new x coordinate is the old y\n     * coordinate multiplied by -1\n     * @return {Point} perpendicular point\n     */\n    perp() {\n        return this.copy()._perp();\n    }\n\n    _perp() {\n        const y = this.y;\n        this.y = this.x;\n        this.x = -y;\n        return this;\n    }\n\n\n\n    /**\n     * Get the angle between this point and another point, in radians\n     * from mapbox/point-geometry\n     * @param {Point} b the other point\n     * @return {Number} angle\n     */\n    angleWith(b) {\n        return this.angleWithSep(b.x, b.y);\n    }\n\n    /*\n     * Find the angle of the two vectors, solving the formula for\n     * the cross product a x b = |a||b|sin(θ) for θ.\n     * from mapbox/point-geometry\n     *\n     * @param {Number} x the x-coordinate\n     * @param {Number} y the y-coordinate\n     * @return {Number} the angle in radians\n     */\n    angleWithSep(x, y) {\n        return Math.atan2(\n            this.x * y - this.y * x,\n            this.x * x + this.y * y);\n    }\n\n    _rotate(angle) {\n        const cos = Math.cos(angle),\n            sin = Math.sin(angle),\n            x = cos * this.x - sin * this.y,\n            y = sin * this.x + cos * this.y;\n        this.x = x;\n        this.y = y;\n        return this;\n    }\n\n    /**\n     * Rotate this point around the 0, 0 origin by an angle a,\n     * given in radians\n     * from mapbox/point-geometry\n     *\n     * @param {Number} a angle to rotate around, in radians\n     * @return {Point} output point\n     */\n    rotate(a) {\n        return this.copy()._rotate(a);\n    }\n}\n\nexport default Point;\n","import Point from './Point';\nimport { isNumber } from '../core/util';\n\n/**\n * Represents a size.\n * @category basic types\n */\nclass Size {\n\n    /**\n     * @param {Number} width - width value\n     * @param {Number} height - height value\n     */\n    constructor(width, height) {\n        if (isNumber(width) && isNumber(height)) {\n            /**\n             * @property {Number} width - width\n             */\n            this.width = width;\n            /**\n             * @property {Number} height - height\n             */\n            this.height = height;\n        } else if (isNumber(width['width'])) {\n            this.width = width.width;\n            this.height = width.height;\n        } else if (Array.isArray(width)) {\n            this.width = width[0];\n            this.height = width[1];\n        }\n    }\n\n    /**\n     * Returns a copy of the size\n     * @return {Size} copy\n     */\n    copy() {\n        return new Size(this['width'], this['height']);\n    }\n\n    /**\n     * Returns the result of addition of another size.\n     * @param {Size} size - size to add\n     * @return {Size} result\n     */\n    add(x, y) {\n        let w, h;\n        if (x instanceof Size) {\n            w = this.width + x.width;\n            h = this.height + x.height;\n        } else {\n            w = this.width + x;\n            h = this.height + y;\n        }\n        return new Size(w, h);\n    }\n\n    /**\n     * Compare with another size to see whether they are equal.\n     * @param {Size} size - size to compare\n     * @return {Boolean}\n     */\n    equals(size) {\n        return this['width'] === size['width'] && this['height'] === size['height'];\n    }\n\n    /**\n     * Returns the result of multiplication of the current size by the given number.\n     * @param {Number} ratio - ratio to multi\n     * @return {Size} result\n     */\n    multi(ratio) {\n        return new Size(this['width'] * ratio, this['height'] * ratio);\n    }\n\n    _multi(ratio) {\n        this['width'] *= ratio;\n        this['height'] *= ratio;\n        return this;\n    }\n\n    _round() {\n        this['width'] = Math.round(this['width']);\n        this['height'] = Math.round(this['height']);\n        return this;\n    }\n\n    /**\n     * Converts the size object to a [Point]{Point}\n     * @return {Point} point\n     */\n    toPoint() {\n        return new Point(this['width'], this['height']);\n    }\n\n    /**\n     * Converts the size object to an array [width, height]\n     * @return {Number[]}\n     */\n    toArray() {\n        return [this['width'], this['height']];\n    }\n\n    /**\n     * Convert the size object to a json object {width : .., height : ..}\n     * @return {Object} json\n     */\n    toJSON() {\n        return {\n            'width': this['width'],\n            'height': this['height']\n        };\n    }\n}\n\nexport default Size;\n","import { isString, isNil } from './common';\nimport { getDomRuler, removeDomNode } from './dom';\nimport Point from '../../geo/Point';\nimport Size from '../../geo/Size';\n\n/**\n * @classdesc\n * Utilities methods for Strings used internally. It is static and should not be initiated.\n * @class\n * @static\n * @category core\n * @name StringUtil\n */\n\n/**\n * Trim the string\n * @param {String} str\n * @return {String}\n * @memberOf StringUtil\n */\nexport function trim(str) {\n    return str.trim ? str.trim() : str.replace(/^\\s+|\\s+$/g, '');\n}\n\nconst specialPattern = /[\\b\\t\\r\\v\\f]/igm;\n\n/**\n * Escape special characters from string.\n * Including: \\b \\t \\r \\v \\f\n * @param  {String} str string to escape\n * @return {String}\n * @memberOf StringUtil\n */\nexport function escapeSpecialChars(str) {\n    if (!isString(str)) {\n        return str;\n    }\n    return str.replace(specialPattern, '');\n}\n\n/**\n * Split string by specified char\n * @param {String} chr - char to split\n * @return {String[]}\n * @memberOf StringUtil\n */\nexport function splitWords(chr) {\n    return trim(chr).split(/\\s+/);\n}\n\nconst rulerCtx = typeof document !== 'undefined' ? document.createElement('canvas').getContext('2d') : null;\n\n/**\n * Gets width of the text with a certain font.\n * More performant than stringLength.\n * @param {String} text - text to measure\n * @param {String} font - font of the text, same as the CSS font.\n * @return {Number}\n * @memberOf StringUtil\n */\nexport function stringWidth(text, font) {\n    if (stringWidth.node) {\n        return stringWidth.node(text, font);\n    }\n    rulerCtx.font = font;\n    return rulerCtx.measureText(text).width;\n}\n\nconst fontHeight = {};\n\n/**\n * Gets size in pixel of the text with a certain font.\n * @param {String} text - text to measure\n * @param {String} font - font of the text, same as the CSS font.\n * @return {Size}\n * @memberOf StringUtil\n */\nexport function stringLength(text, font) {\n    if (stringLength.node) {\n        return stringLength.node(text, font);\n    } else {\n        const w = stringWidth(text, font);\n        if (!font) {\n            font = '_default_';\n        }\n        if (!fontHeight[font]) {\n            fontHeight[font] = getFontHeight(font);\n        }\n        return new Size(w, fontHeight[font]);\n    }\n}\n\nexport function getFontHeight(font) {\n    //dom\n    const domRuler = getDomRuler();\n    if (font !== '_default_') {\n        domRuler.style.font = font;\n    }\n    domRuler.innerHTML = '秦';\n    const h = domRuler.clientHeight;\n    //if not removed, the canvas container on chrome will turn to unexpected blue background.\n    // Reason is unknown.\n    removeDomNode(domRuler);\n    return h;\n}\n\n/**\n * Split text content by dom.\n * @param {String} content - content to split\n * @param {String} font - font of the text, same as the CSS font.\n * @return {Number} wrapWidth - width to wrap\n * @return {String[]}\n * @memberOf StringUtil\n */\nexport function splitContent(content, font, wrapWidth, textWidth) {\n    if (!content || content.length === 0) {\n        return [{ 'text' : '', 'width' : 0 }];\n    }\n    const width = isNil(textWidth) ? stringWidth(content, font) : textWidth;\n    const chrWidth = width / content.length,\n        minChrCount = Math.floor(wrapWidth / chrWidth / 2);\n    if (chrWidth >= wrapWidth || minChrCount <= 0) {\n        return [{ 'text' : '', 'width' : wrapWidth }];\n    }\n    if (width <= wrapWidth) return [{ 'text' : content, 'width' : width }];\n    const result = [];\n    let testStr = content.substring(0, minChrCount), prew = chrWidth * minChrCount;\n    for (let i = minChrCount, l = content.length; i < l; i++) {\n        const chr = content[i];\n        const w = stringWidth(testStr + chr);\n        if (w >= wrapWidth) {\n            result.push({ 'text' : testStr, 'width' : prew });\n            testStr = content.substring(i, minChrCount + i);\n            i += (minChrCount - 1);\n            prew = chrWidth * minChrCount;\n        } else {\n            testStr += chr;\n            prew = w;\n        }\n        if (i >= l - 1) {\n            prew = stringWidth(testStr);\n            result.push({ 'text' : testStr, 'width' : prew });\n        }\n    }\n    return result;\n}\n\nconst contentExpRe = /\\{([\\w_]+)\\}/g;\n\n/**\n * Replace variables wrapped by square brackets ({foo}) with actual values in props.\n * @example\n *     // will returns 'John is awesome'\n *     const actual = replaceVariable('{foo} is awesome', {'foo' : 'John'});\n * @param {String} str      - string to replace\n * @param {Object} props    - variable value properties\n * @return {String}\n * @memberOf StringUtil\n */\nexport function replaceVariable(str, props) {\n    if (!isString(str)) {\n        return str;\n    }\n    return str.replace(contentExpRe, function (str, key) {\n        if (!props) {\n            return '';\n        }\n        const value = props[key];\n        if (isNil(value)) {\n            return '';\n        } else if (Array.isArray(value)) {\n            return value.join();\n        }\n        return value;\n    });\n}\n\n/**\n * Gets text's align point according to the horizontalAlignment and verticalAlignment\n * @param  {Size} size                  - text size\n * @param  {String} horizontalAlignment - horizontalAlignment: left/middle/right\n * @param  {String} verticalAlignment   - verticalAlignment: top/middle/bottom\n * @return {Point}\n * @memberOf StringUtil\n */\nexport function getAlignPoint(size, horizontalAlignment, verticalAlignment) {\n    const width = size['width'],\n        height = size['height'];\n    let alignW, alignH;\n    if (horizontalAlignment === 'left') {\n        alignW = -width;\n    } else if (horizontalAlignment === 'right') {\n        alignW = 0;\n    } else {\n        alignW = -width / 2;\n    }\n    if (verticalAlignment === 'top') {\n        alignH = -height;\n    } else if (verticalAlignment === 'bottom') {\n        alignH = 0;\n    } else {\n        alignH = -height / 2;\n    }\n    return new Point(alignW, alignH);\n}\n\nconst DEFAULT_FONT = 'monospace';\n\n/**\n * Returns CSS Font from a symbol with text styles.\n * @param  {Object} style symbol with text styles\n * @return {String}       CSS Font String\n * @memberOf StringUtil\n */\nexport function getFont(style) {\n    if (style['textFont']) {\n        return style['textFont'];\n    } else {\n        return (style['textStyle'] && style['textStyle'] !== 'normal' ? style['textStyle'] + ' ' : '') +\n            (style['textWeight'] && style['textWeight'] !== 'normal' ? style['textWeight'] + ' ' : '') +\n            style['textSize'] + 'px ' +\n            (!style['textFaceName'] ? DEFAULT_FONT : (style['textFaceName'][0] === '\"' ? style['textFaceName'] : '\"' + style['textFaceName'] + '\"'));\n    }\n}\n\n/**\n * Split a text to multiple rows according to the style.\n * @param {String} text     - text to split\n * @param {Object} style    - text style\n * @return {Object[]} the object's structure: { rowNum: rowNum, textSize: textSize, rows: textRows, rawSize : rawSize }\n * @memberOf StringUtil\n */\nexport function splitTextToRow(text, style) {\n    const font = getFont(style),\n        lineSpacing = style['textLineSpacing'] || 0,\n        size = stringLength(text, font),\n        textWidth = size['width'],\n        textHeight = size['height'],\n        wrapChar = style['textWrapCharacter'],\n        textRows = [];\n    let wrapWidth = style['textWrapWidth'];\n    if (!wrapWidth || wrapWidth > textWidth) {\n        wrapWidth = textWidth;\n    }\n    if (!isString(text)) {\n        text += '';\n    }\n    let actualWidth = 0;\n    if (wrapChar && text.indexOf(wrapChar) >= 0) {\n        const texts = text.split(wrapChar);\n        for (let i = 0, l = texts.length; i < l; i++) {\n            const t = texts[i];\n            const tWidth = stringWidth(t, font);\n            if (tWidth > wrapWidth) {\n                const contents = splitContent(t, font, wrapWidth, tWidth);\n                for (let ii = 0, ll = contents.length; ii < ll; ii++) {\n                    const w = contents[ii].width;\n                    if (w > actualWidth) {\n                        actualWidth = w;\n                    }\n                    textRows.push({\n                        'text': contents[ii].text,\n                        'size': new Size(w, textHeight)\n                    });\n                }\n            } else {\n                if (tWidth > actualWidth) {\n                    actualWidth = tWidth;\n                }\n                textRows.push({\n                    'text': t,\n                    'size': new Size(tWidth, textHeight)\n                });\n            }\n        }\n    } else if (textWidth > wrapWidth) {\n        const contents = splitContent(text, font, wrapWidth, textWidth);\n        for (let i = 0; i < contents.length; i++) {\n            const w = contents[i].width;\n            if (w > actualWidth) {\n                actualWidth = w;\n            }\n            textRows.push({\n                'text': contents[i].text,\n                'size': new Size(w, textHeight)\n            });\n        }\n    } else {\n        if (textWidth > actualWidth) {\n            actualWidth = textWidth;\n        }\n        textRows.push({\n            'text': text,\n            'size': size\n        });\n    }\n\n    const rowNum = textRows.length;\n    const textSize = new Size(actualWidth, textHeight * rowNum + lineSpacing * (rowNum - 1));\n    return {\n        'total': rowNum,\n        'size': textSize,\n        'rows': textRows,\n        'rawSize': size\n    };\n}\n","/**\n * DOM utilities used internally.\n * Learned a lot from Leaflet.DomUtil\n * @class\n * @category core\n * @name DomUtil\n */\n\nimport Browser from  '../Browser';\nimport { IS_NODE } from './env';\nimport { isString, isNil } from './common';\nimport { splitWords } from './strings';\nimport Point from '../../geo/Point';\nimport Size from '../../geo/Size';\n\nconst first = (props) => {\n    return props[0];\n};\n\n/**\n * From Leaflet.DomUtil\n * Goes through the array of style names and returns the first name\n * that is a valid style name for an element. If no such name is found,\n * it returns false. Useful for vendor-prefixed styles like `transform`.\n * @param  {String[]} props\n * @return {Boolean}\n * @memberOf DomUtil\n * @private\n */\nconst testProp = IS_NODE ? first : (props) => {\n\n    const style = document.documentElement.style;\n\n    for (let i = 0; i < props.length; i++) {\n        if (props[i] in style) {\n            return props[i];\n        }\n    }\n    return false;\n};\n\n// prefix style property names\n\n/**\n * Vendor-prefixed fransform style name (e.g. `'webkitTransform'` for WebKit).\n * @property {String} TRANSFORM\n * @memberOf DomUtil\n * @type {String}\n */\nexport const TRANSFORM = testProp(\n    ['transform', 'WebkitTransform', 'OTransform', 'MozTransform', 'msTransform']);\n\n/**\n * Vendor-prefixed tfransform-origin name (e.g. `'webkitTransformOrigin'` for WebKit).\n * @property {String} TRANSFORMORIGIN\n * @memberOf DomUtil\n * @type {String}\n */\nexport const TRANSFORMORIGIN = testProp(\n    ['transformOrigin', 'WebkitTransformOrigin', 'OTransformOrigin', 'MozTransformOrigin', 'msTransformOrigin']);\n\n/**\n * Vendor-prefixed transition name (e.g. `'WebkitTransition'` for WebKit).\n * @property {String} TRANSITION\n * @memberOf DomUtil\n * @type {String}\n */\nexport const TRANSITION = testProp(\n    ['transition', 'WebkitTransition', 'OTransition', 'MozTransition', 'msTransition']);\n\n/**\n * Vendor-prefixed filter name (e.g. `'WebkitFilter'` for WebKit).\n * @property {String} FILTER\n * @memberOf DomUtil\n * @type {String}\n */\nexport const CSSFILTER = testProp(\n    ['filter', 'WebkitFilter', 'OFilter', 'MozFilter', 'msFilter']);\n\n/**\n * Create a html element.\n * @param {String} tagName\n * @returns {HTMLElement}\n * @memberOf DomUtil\n */\nexport function createEl(tagName, className) {\n    const el = document.createElement(tagName);\n    if (className) {\n        setClass(el, className);\n    }\n    return el;\n}\n\n/**\n * Create a html element on the specified container\n * @param {String} tagName\n * @param {String} style - css styles\n * @param {HTMLElement} container\n * @return {HTMLElement}\n * @memberOf DomUtil\n */\nexport function createElOn(tagName, style, container) {\n    const el = createEl(tagName);\n    if (style) {\n        setStyle(el, style);\n    }\n    if (container) {\n        container.appendChild(el);\n    }\n    return el;\n}\n\n/**\n * Removes a html element.\n * @param {HTMLElement} node\n * @memberOf DomUtil\n */\n/* istanbul ignore next */\nexport function removeDomNode(node) {\n    if (!node) {\n        return this;\n    }\n    if (Browser.ielt9 || Browser.ie9) {\n        //fix memory leak in IE9-\n        //http://com.hemiola.com/2009/11/23/memory-leaks-in-ie8/\n        let d = createEl('div');\n        d.appendChild(node);\n        d.innerHTML = '';\n        d = null;\n    } else if (node.parentNode) {\n        node.parentNode.removeChild(node);\n    }\n    return this;\n}\n\n/**\n * Adds a event listener to the dom element.\n * @param {HTMLElement} obj     - dom element to listen on\n * @param {String} typeArr      - event types, seperated by space\n * @param {Function} handler    - listener function\n * @param {Object} context      - function context\n * @memberOf DomUtil\n */\nexport function addDomEvent(obj, typeArr, handler, context) {\n    if (!obj || !obj.addEventListener || !typeArr || !handler) {\n        return this;\n    }\n    const eventHandler = function (e) {\n        if (!e) {\n            e = window.event;\n        }\n        handler.call(context || obj, e);\n        return;\n    };\n    const types = typeArr.split(' ');\n    for (let i = types.length - 1; i >= 0; i--) {\n        let type = types[i];\n        if (!type) {\n            continue;\n        }\n\n        if (!obj['Z__' + type]) {\n            obj['Z__' + type] = [];\n\n        }\n        const hit = listensDomEvent(obj, type, handler);\n        if (hit >= 0) {\n            removeDomEvent(obj, type, handler);\n        }\n        obj['Z__' + type].push({\n            callback: eventHandler,\n            src: handler\n        });\n        //firefox\n        if (type === 'mousewheel' && Browser.gecko) {\n            type = 'DOMMouseScroll';\n        }\n        obj.addEventListener(type, eventHandler, false);\n    }\n    return this;\n}\n\n/**\n * Removes event listener from a dom element\n * @param {HTMLElement} obj         - dom element\n * @param {String} typeArr          - event types, separated by space\n * @param {Function} handler        - listening function\n * @memberOf DomUtil\n */\nexport function removeDomEvent(obj, typeArr, handler) {\n    function doRemove(type, callback) {\n        //mouse wheel in firefox\n        if (type === 'mousewheel' && Browser.gecko) {\n            type = 'DOMMouseScroll';\n        }\n        obj.removeEventListener(type, callback, false);\n    }\n    if (!obj || !obj.removeEventListener || !typeArr) {\n        return this;\n    }\n    const types = typeArr.split(' ');\n    for (let i = types.length - 1; i >= 0; i--) {\n        const type = types[i];\n        if (!type) {\n            continue;\n        }\n        //remove all the listeners if handler is not given.\n        if (!handler && obj['Z__' + type]) {\n            const handlers = obj['Z__' + type];\n            for (let j = 0, jlen = handlers.length; j < jlen; j++) {\n                doRemove(handlers[j].callback);\n            }\n            delete obj['Z__' + type];\n            return this;\n        }\n        const hit = listensDomEvent(obj, type, handler);\n        if (hit < 0) {\n            return this;\n        }\n        const hitHandler = obj['Z__' + type][hit];\n        doRemove(type, hitHandler.callback);\n        obj['Z__' + type].splice(hit, 1);\n    }\n    return this;\n}\n\n/**\n * Check if event type of the dom is listened by the handler\n * @param {HTMLElement} obj     - dom element to check\n * @param {String} typeArr      - event\n * @param {Function} handler    - the listening function\n * @return {Number} - the handler's index in the listener chain, returns -1 if not.\n * @memberOf DomUtil\n */\nexport function listensDomEvent(obj, type, handler) {\n    if (!obj || !obj['Z__' + type] || !handler) {\n        return -1;\n    }\n    const handlers = obj['Z__' + type];\n    for (let i = 0, len = handlers.length; i < len; i++) {\n        if (handlers[i].src === handler) {\n            return i;\n        }\n    }\n    return -1;\n}\n\n/**\n * Prevent default behavior of the browser. <br/>\n * preventDefault Cancels the event if it is cancelable, without stopping further propagation of the event.\n * @param {Event} event - browser event\n * @memberOf DomUtil\n */\nexport function preventDefault(event) {\n    if (event.preventDefault) {\n        event.preventDefault();\n    } else {\n        event.returnValue = false;\n    }\n    return this;\n}\n\n/**\n * Stop browser event propagation\n * @param  {Event} e - browser event.\n * @memberOf DomUtil\n */\nexport function stopPropagation(e) {\n    if (e.stopPropagation) {\n        e.stopPropagation();\n    } else {\n        e.cancelBubble = true;\n    }\n    return this;\n}\n\nexport function preventSelection(dom) {\n    dom.onselectstart = function () {\n        return false;\n    };\n    dom.ondragstart = function () {\n        return false;\n    };\n    dom.setAttribute('unselectable', 'on');\n    return this;\n}\n\n/**\n * Get the dom element's current position or offset its position by offset\n * @param  {HTMLElement} dom - HTMLElement\n * @param  {Point} [offset=null] - position to set.\n * @return {Point} - dom element's current position if offset is null.\n * @memberOf DomUtil\n */\nexport function offsetDom(dom, offset) {\n    if (!dom) {\n        return null;\n    }\n\n    if (Browser.any3d) {\n        setTransform(dom, offset);\n    } else {\n        dom.style.left = offset.x + 'px';\n        dom.style.top = offset.y + 'px';\n    }\n    return offset;\n}\n\n/**\n * Compute dom's position\n * @param  {HTMLElement} dom\n * @return {Number[]}\n * @memberOf DomUtil\n */\nexport function computeDomPosition(dom) {\n    const style = window.getComputedStyle(dom);\n    const padding = [\n        parseInt(style['padding-left']),\n        parseInt(style['padding-top'])\n    ];\n    const rect = dom.getBoundingClientRect();\n    //fix #450, inspired by https://github.com/Leaflet/Leaflet/pull/5794/files\n    const offsetWidth = dom.offsetWidth,\n        offsetHeight = dom.offsetHeight;\n    const scaleX = offsetWidth ? rect.width / offsetWidth : 1,\n        scaleY = offsetHeight ? rect.height / offsetHeight : 1;\n    dom.__position = [rect.left + padding[0], rect.top + padding[1], scaleX, scaleY];\n    return dom.__position;\n}\n\n/**\n * Get event's position from the top-left corner of the dom container\n * @param {Event} ev    event\n * @return {Point}\n * @memberOf DomUtil\n */\nexport function getEventContainerPoint(ev, dom) {\n    if (!ev) {\n        ev = window.event;\n    }\n    let domPos = dom.__position;\n    if (!domPos) {\n        domPos = computeDomPosition(dom);\n    }\n    // div by scaleX, scaleY to fix #450\n    return new Point(\n        (ev.clientX - domPos[0] - dom.clientLeft) / domPos[2],\n        (ev.clientY - domPos[1] - dom.clientTop) / domPos[3]\n    );\n}\n\nfunction endsWith(str, suffix) {\n    const l = str.length - suffix.length;\n    return l >= 0 && str.indexOf(suffix, l) === l;\n}\n\n/**\n * set css style to the dom element\n * @param {HTMLElement} dom dom element\n * @param {String} strCss css text\n * @memberOf DomUtil\n */\nexport function setStyle(dom, strCss) {\n    let cssText = dom.style.cssText;\n    if (!endsWith(cssText, ';')) {\n        cssText += ';';\n    }\n    dom.style.cssText = cssText + strCss;\n    return this;\n}\n\n/**\n * Whether the dom has the given css class.\n * @param {HTMLElement} el HTML Element\n * @param {String} name css class\n * @memberOf DomUtil\n */\nexport function hasClass(el, name) {\n    if (el.classList !== undefined) {\n        return el.classList.contains(name);\n    }\n    const className = getClass(el);\n    return className.length > 0 && new RegExp('(^|\\\\s)' + name + '(\\\\s|$)').test(className);\n}\n\n/**\n * add css class to dom element\n * @param {HTMLElement} el HTML Element\n * @param {String} name css class\n * @memberOf DomUtil\n */\nexport function addClass(el, name) {\n    if (el.classList !== undefined && !hasClass(el, name)) {\n        const classes = splitWords(name);\n        for (let i = 0, len = classes.length; i < len; i++) {\n            el.classList.add(classes[i]);\n        }\n    } else {\n        const className = getClass(el);\n        setClass(el, (className ? className + ' ' : '') + name);\n    }\n    return this;\n}\n\n/**\n * Set dom's css class\n * @param {HTMLElement} el HTML Element\n * @param {String} name css class\n * @memberOf DomUtil\n */\nexport function setClass(el, name) {\n    if (isNil(el.className.baseVal)) {\n        el.className = name;\n    } else {\n        el.className.baseVal = name;\n    }\n    return this;\n}\n\n/**\n * Get dom's css class\n * @param {String} name css class\n * @retrun {String} class字符串\n * @memberOf DomUtil\n */\nexport function getClass(el) {\n    return isNil(el.className.baseVal) ? el.className : el.className.baseVal;\n}\n\n\nexport function setOpacity(el, value) {\n    el.style.opacity = value;\n    return this;\n}\n\n// export function copyCanvas(src) {\n//     if (IS_NODE) {\n//         return null;\n//     }\n//     const target = createEl('canvas');\n//     target.width = src.width;\n//     target.height = src.height;\n//     target.getContext('2d').drawImage(src, 0, 0);\n//     return target;\n// }\n\n/**\n * Resets the 3D CSS transform of `el` so it is translated by `offset` pixels\n * @param {HTMLElement} el\n * @param {Point} offset\n * @memberOf DomUtil\n */\nexport function setTransform(el, offset) {\n    const pos = offset || new Point(0, 0);\n    el.style[TRANSFORM] =\n        Browser.any3d ?\n            'translate3d(' + pos.x + 'px,' + pos.y + 'px,0px)' :\n            'translate(' + pos.x + 'px,' + pos.y + 'px)';\n\n    return this;\n}\n\nexport function setTransformMatrix(el, m) {\n    const text = 'matrix(' + (isString(m) ? m : m.join()) + ')';\n    if (el.style[TRANSFORM] !== text) {\n        el.style[TRANSFORM] = text;\n    }\n    return this;\n}\n\nexport function removeTransform(el) {\n    if (el.style[TRANSFORM]) {\n        el.style[TRANSFORM] = '';\n    }\n    return this;\n}\n\nexport function isHTML(str) {\n    return /<[a-z\\][\\s\\S]*>/i.test(str);\n}\n\nexport function measureDom(parentTag, dom) {\n    const ruler = getDomRuler(parentTag);\n    if (isString(dom)) {\n        ruler.innerHTML = dom;\n    } else {\n        ruler.appendChild(dom);\n    }\n    const result = new Size(ruler.clientWidth, ruler.clientHeight);\n    removeDomNode(ruler);\n    return result;\n}\n\nexport function getDomRuler(tag) {\n    const span = document.createElement(tag);\n    span.style.cssText = 'position:absolute;left:-10000px;top:-10000px;';\n    document.body.appendChild(span);\n    return span;\n}\n\n/**\n * Alias for [addDomEvent]{@link DomUtil.addDomEvent}\n * @param {HTMLElement} obj     - dom element to listen on\n * @param {String} typeArr      - event types, seperated by space\n * @param {Function} handler    - listener function\n * @param {Object} context      - function context\n * @static\n * @function\n * @return {DomUtil}\n * @memberOf DomUtil\n */\nexport const on = addDomEvent;\n\n/**\n * Alias for [removeDomEvent]{@link DomUtil.removeDomEvent}\n * @param {HTMLElement} obj         - dom element\n * @param {String} typeArr          - event types, separated by space\n * @param {Function} handler        - listening function\n * @static\n * @function\n * @return {DomUtil}\n * @memberOf DomUtil\n */\nexport const off = removeDomEvent;\n","import { IS_NODE, isString, isFunction, parseJSON, emptyImageUrl, UID } from './util';\n\n/**\n * @classdesc\n * Ajax Utilities. It is static and should not be initiated.\n * @class\n * @static\n * @category core\n */\nconst Ajax = {\n\n    /**\n     * Get JSON data by jsonp\n     * from https://gist.github.com/gf3/132080/110d1b68d7328d7bfe7e36617f7df85679a08968\n     * @param  {String}   url - resource url\n     * @param  {Function} cb  - callback function when completed\n     */\n    jsonp: function (url, callback) {\n        // INIT\n        const name = '_maptalks_jsonp_' + UID();\n        if (url.match(/\\?/)) url += '&callback=' + name;\n        else url += '?callback=' + name;\n\n        // Create script\n        let script = document.createElement('script');\n        script.type = 'text/javascript';\n        script.src = url;\n\n        // Setup handler\n        window[name] = function (data) {\n            callback(null, data);\n            document.getElementsByTagName('head')[0].removeChild(script);\n            script = null;\n            delete window[name];\n        };\n\n        // Load JSON\n        document.getElementsByTagName('head')[0].appendChild(script);\n        return this;\n    },\n\n    /**\n     * Fetch remote resource by HTTP \"GET\" method\n     * @param  {String}   url - resource url\n     * @param  {Object}   [options=null] - request options\n     * @param  {Object}   [options.headers=null] - HTTP headers\n     * @param  {String}   [options.responseType=null] - responseType\n     * @param  {String}   [options.credentials=null]  - if with credentials, set it to \"include\"\n     * @param  {Function} cb  - callback function when completed\n     * @return {Ajax}  Ajax\n     * @example\n     * maptalks.Ajax.get(\n     *     'url/to/resource',\n     *     (err, data) => {\n     *         if (err) {\n     *             throw new Error(err);\n     *         }\n     *         // do things with data\n     *     }\n     * );\n     */\n    get: function (url, options, cb) {\n        if (isFunction(options)) {\n            const t = cb;\n            cb = options;\n            options = t;\n        }\n        if (IS_NODE && Ajax.get.node) {\n            return Ajax.get.node(url, cb, options);\n        }\n        const client = Ajax._getClient(cb);\n        client.open('GET', url, true);\n        if (options) {\n            for (const k in options.headers) {\n                client.setRequestHeader(k, options.headers[k]);\n            }\n            client.withCredentials = options.credentials === 'include';\n            if (options['responseType']) {\n                client.responseType = options['responseType'];\n            }\n        }\n        client.send(null);\n        return client;\n    },\n\n    /**\n     * Fetch remote resource by HTTP \"POST\" method\n     * @param  {String}   url - resource url\n     * @param  {Object}   options - request options\n     * @param  {String|Object}  options.postData - post data\n     * @param  {Object}   [options.headers=null]  - HTTP headers\n     * @param  {Function} cb  - callback function when completed\n     * @return {Ajax}  Ajax\n     * @example\n     * maptalks.Ajax.post(\n     *   'url/to/post',\n     *   {\n     *     postData : {\n     *       'param0' : 'val0',\n     *       'param1' : 1\n     *     }\n     *   },\n     *   (err, data) => {\n     *     if (err) {\n     *       throw new Error(err);\n     *     }\n     *     // do things with data\n     *   }\n     * );\n     */\n    post: function (url, options, cb) {\n        let postData;\n        if (!isString(url)) {\n            //for compatible\n            //options, postData, cb\n            const t = cb;\n            postData = options;\n            options = url;\n            url = options.url;\n            cb = t;\n        } else {\n            if (isFunction(options)) {\n                const t = cb;\n                cb = options;\n                options = t;\n            }\n            options = options || {};\n            postData = options.postData;\n        }\n        if (IS_NODE && Ajax.post.node) {\n            options.url = url;\n            return Ajax.post.node(options, postData, cb);\n        }\n        const client = Ajax._getClient(cb);\n        client.open('POST', options.url, true);\n        if (!options.headers) {\n            options.headers = {};\n        }\n        if (!options.headers['Content-Type']) {\n            options.headers['Content-Type'] = 'application/x-www-form-urlencoded';\n        }\n        if ('setRequestHeader' in client) {\n            for (const p in options.headers) {\n                if (options.headers.hasOwnProperty(p)) {\n                    client.setRequestHeader(p, options.headers[p]);\n                }\n            }\n        }\n        if (!isString(postData)) {\n            postData = JSON.stringify(postData);\n        }\n        client.send(postData);\n        return client;\n    },\n\n    _wrapCallback: function (client, cb) {\n        return function () {\n            if (client.readyState === 4) {\n                if (client.status === 200) {\n                    if (client.responseType === 'arraybuffer') {\n                        const response = client.response;\n                        if (response.byteLength === 0) {\n                            cb(new Error('http status 200 returned without content.'));\n                        } else {\n                            cb(null, {\n                                data: client.response,\n                                cacheControl: client.getResponseHeader('Cache-Control'),\n                                expires: client.getResponseHeader('Expires'),\n                                contentType : client.getResponseHeader('Content-Type')\n                            });\n                        }\n                    } else {\n                        cb(null, client.responseText);\n                    }\n                } else {\n                    cb(new Error(client.statusText + ',' + client.status));\n                }\n            }\n        };\n    },\n\n    _getClient: function (cb) {\n        /*eslint-disable no-empty, no-undef*/\n        let client;\n        try {\n            client = new XMLHttpRequest();\n        } catch (e) {\n            try { client = new ActiveXObject('Msxml2.XMLHTTP'); } catch (e) {\n                try { client = new ActiveXObject('Microsoft.XMLHTTP'); } catch (e) {}\n            }\n        }\n        client.onreadystatechange = Ajax._wrapCallback(client, cb);\n        return client;\n        /*eslint-enable no-empty, no-undef*/\n    },\n    /**\n     * Fetch resource as arraybuffer.\n     * @param {String} url    - url\n     * @param {Object} [options=null] - options, same as Ajax.get\n     * @param {Function} cb   - callback function when completed.\n     * @example\n     * maptalks.Ajax.getArrayBuffer(\n     *     'url/to/resource.bin',\n     *     (err, data) => {\n     *         if (err) {\n     *             throw new Error(err);\n     *         }\n     *         // data is a binary array\n     *     }\n     * );\n     */\n    getArrayBuffer(url, options, cb) {\n        if (isFunction(options)) {\n            const t = cb;\n            cb = options;\n            options = t;\n        }\n        if (!options) {\n            options = {};\n        }\n        options['responseType'] = 'arraybuffer';\n        return Ajax.get(url, options, cb);\n    },\n\n    // from mapbox-gl-js\n    getImage(img, url, options) {\n        return Ajax.getArrayBuffer(url, options, (err, imgData) => {\n            if (err) {\n                if (img.onerror) {\n                    img.onerror(err);\n                }\n            } else if (imgData) {\n                const URL = window.URL || window.webkitURL;\n                const onload = img.onload;\n                img.onload = () => {\n                    if (onload) {\n                        onload();\n                    }\n                    URL.revokeObjectURL(img.src);\n                };\n                const blob = new Blob([new Uint8Array(imgData.data)], { type: imgData.contentType });\n                img.cacheControl = imgData.cacheControl;\n                img.expires = imgData.expires;\n                img.src = imgData.data.byteLength ? URL.createObjectURL(blob) : emptyImageUrl;\n            }\n        });\n    }\n};\n\n/**\n * Fetch resource as a JSON Object.\n * @param {String} url          - json's url\n * @param {Object} [options=null]        - optional options\n * @param {String} [options.jsonp=false] - fetch by jsonp, false by default\n * @param {Function} cb   - callback function when completed.\n * @example\n * maptalks.Ajax.getJSON(\n *     'url/to/resource.json',\n *     { jsonp : true },\n *     (err, json) => {\n *         if (err) {\n *             throw new Error(err);\n *         }\n *         // json is a JSON Object\n *         console.log(json.foo);\n *     }\n * );\n * @static\n */\nAjax.getJSON = function (url, options, cb) {\n    if (isFunction(options)) {\n        const t = cb;\n        cb = options;\n        options = t;\n    }\n    const callback = function (err, resp) {\n        const data = resp ? parseJSON(resp) : null;\n        cb(err, data);\n    };\n    if (options && options['jsonp']) {\n        return Ajax.jsonp(url, callback);\n    }\n    return Ajax.get(url, options, callback);\n};\n\nexport default Ajax;\n","import {\n    IS_NODE,\n    isNil,\n    isNumber,\n    isString,\n    isArrayHasData,\n    isSVG,\n    isCssUrl,\n    extractCssUrl,\n    computeDegree\n} from './util';\nimport { isGradient } from './util/style';\nimport { createEl } from './util/dom';\nimport Browser from './Browser';\nimport Point from '../geo/Point';\nimport { getFont, getAlignPoint } from './util/strings';\n\nconst DEFAULT_STROKE_COLOR = '#000';\nconst DEFAULT_FILL_COLOR = 'rgba(255,255,255,0)';\nconst DEFAULT_TEXT_COLOR = '#000';\n\nlet hitTesting = false;\n\nlet TEMP_CANVAS = null;\n\nconst Canvas = {\n    setHitTesting(testing) {\n        hitTesting = testing;\n    },\n\n    createCanvas(width, height, canvasClass) {\n        let canvas;\n        if (!IS_NODE) {\n            canvas = createEl('canvas');\n            canvas.width = width;\n            canvas.height = height;\n        } else {\n            //can be node-canvas or any other canvas mock\n            canvas = new canvasClass(width, height);\n        }\n        return canvas;\n    },\n\n    prepareCanvasFont(ctx, style) {\n        ctx.textBaseline = 'top';\n        ctx.font = getFont(style);\n        let fill = style['textFill'];\n        if (!fill) {\n            fill = DEFAULT_TEXT_COLOR;\n        }\n        ctx.fillStyle = Canvas.getRgba(fill, style['textOpacity']);\n    },\n\n    /**\n     * Set canvas's fill and stroke style\n     * @param {CanvasRenderingContext2D} ctx\n     * @param {Object} style\n     * @param {Object} resources\n     * @param {Boolean} testing  - paint for testing, ignore stroke and fill patterns\n     */\n    prepareCanvas(ctx, style, resources, testing) {\n        if (!style) {\n            return;\n        }\n        const strokeWidth = style['lineWidth'];\n        if (!isNil(strokeWidth) && ctx.lineWidth !== strokeWidth) {\n            ctx.lineWidth = strokeWidth;\n        }\n        const strokeColor = style['linePatternFile'] || style['lineColor'] || DEFAULT_STROKE_COLOR;\n        if (testing) {\n            ctx.strokeStyle = '#000';\n        } else if (isImageUrl(strokeColor) && resources) {\n            let patternOffset;\n            if (style['linePatternDx'] || style['linePatternDy']) {\n                patternOffset = [style['linePatternDx'], style['linePatternDy']];\n            }\n            Canvas._setStrokePattern(ctx, strokeColor, strokeWidth, patternOffset, resources);\n            //line pattern will override stroke-dasharray\n            style['lineDasharray'] = [];\n        } else if (isGradient(strokeColor)) {\n            if (style['lineGradientExtent']) {\n                ctx.strokeStyle = Canvas._createGradient(ctx, strokeColor, style['lineGradientExtent']);\n            } else {\n                ctx.strokeStyle = DEFAULT_STROKE_COLOR;\n            }\n        } else /*if (ctx.strokeStyle !== strokeColor)*/ {\n            ctx.strokeStyle = strokeColor;\n        }\n        if (style['lineJoin']) {\n            ctx.lineJoin = style['lineJoin'];\n        }\n        if (style['lineCap']) {\n            ctx.lineCap = style['lineCap'];\n        }\n        if (ctx.setLineDash && isArrayHasData(style['lineDasharray'])) {\n            ctx.setLineDash(style['lineDasharray']);\n        }\n        const fill = style['polygonPatternFile'] || style['polygonFill'] || DEFAULT_FILL_COLOR;\n        if (testing) {\n            ctx.fillStyle = '#000';\n        } else if (isImageUrl(fill) && resources) {\n            const fillImgUrl = extractImageUrl(fill);\n            let fillTexture = resources.getImage([fillImgUrl, null, null]);\n            if (!fillTexture) {\n                //if the linestring has a arrow and a linePatternFile, polygonPatternFile will be set with the linePatternFile.\n                fillTexture = resources.getImage([fillImgUrl + '-texture', null, strokeWidth]);\n            }\n            if (isSVG(fillImgUrl) && (fillTexture instanceof Image) && (Browser.edge || Browser.ie)) {\n                //opacity of svg img painted on canvas is always 1, so we paint svg on a canvas at first.\n                const w = fillTexture.width || 20,\n                    h = fillTexture.height || 20;\n                const canvas = Canvas.createCanvas(w, h);\n                Canvas.image(canvas.getContext('2d'), fillTexture, 0, 0, w, h);\n                fillTexture = canvas;\n            }\n            if (!fillTexture) {\n                if (typeof console !== 'undefined') {\n                    console.warn('img not found for', fillImgUrl);\n                }\n            } else {\n                ctx.fillStyle = ctx.createPattern(fillTexture, 'repeat');\n                if (style['polygonPatternDx'] || style['polygonPatternDy']) {\n                    ctx.fillStyle['polygonPatternOffset'] = [style['polygonPatternDx'], style['polygonPatternDy']];\n                }\n            }\n\n        } else if (isGradient(fill)) {\n            if (style['polygonGradientExtent']) {\n                ctx.fillStyle = Canvas._createGradient(ctx, fill, style['polygonGradientExtent']);\n            } else {\n                ctx.fillStyle = 'rgba(255,255,255,0)';\n            }\n        } else /*if (ctx.fillStyle !== fill)*/ {\n            ctx.fillStyle = fill;\n        }\n    },\n\n    _createGradient(ctx, g, extent) {\n        let gradient = null,\n            places = g['places'];\n        const min = extent.getMin(),\n            max = extent.getMax(),\n            width = extent.getWidth(),\n            height = extent.getHeight();\n        if (!g['type'] || g['type'] === 'linear') {\n            if (!places) {\n                places = [min.x, min.y, max.x, min.y];\n            } else {\n                if (places.length !== 4) {\n                    throw new Error('A linear gradient\\'s places should have 4 numbers.');\n                }\n                places = [\n                    min.x + places[0] * width, min.y + places[1] * height,\n                    min.x + places[2] * width, min.y + places[3] * height\n                ];\n            }\n            gradient = ctx.createLinearGradient.apply(ctx, places);\n        } else if (g['type'] === 'radial') {\n            if (!places) {\n                const c = extent.getCenter()._round();\n                places = [c.x, c.y, Math.abs(c.x - min.x), c.x, c.y, 0];\n            } else {\n                if (places.length !== 6) {\n                    throw new Error('A radial gradient\\'s places should have 6 numbers.');\n                }\n                places = [\n                    min.x + places[0] * width, min.y + places[1] * height, width * places[2],\n                    min.x + places[3] * width, min.y + places[4] * height, width * places[5]\n                ];\n            }\n            gradient = ctx.createRadialGradient.apply(ctx, places);\n        }\n        g['colorStops'].forEach(stop => {\n            gradient.addColorStop.apply(gradient, stop);\n        });\n        return gradient;\n    },\n\n    _setStrokePattern(ctx, strokePattern, strokeWidth, linePatternOffset, resources) {\n        const imgUrl = extractImageUrl(strokePattern);\n        let imageTexture;\n        if (IS_NODE) {\n            imageTexture = resources.getImage([imgUrl, null, strokeWidth]);\n        } else {\n            const key = imgUrl + '-texture-' + strokeWidth;\n            imageTexture = resources.getImage(key);\n            if (!imageTexture) {\n                const imageRes = resources.getImage([imgUrl, null, null]);\n                if (imageRes) {\n                    let w;\n                    if (!imageRes.width || !imageRes.height) {\n                        w = strokeWidth;\n                    } else {\n                        w = Math.round(imageRes.width * strokeWidth / imageRes.height);\n                    }\n                    const patternCanvas = Canvas.createCanvas(w, strokeWidth, ctx.canvas.constructor);\n                    Canvas.image(patternCanvas.getContext('2d'), imageRes, 0, 0, w, strokeWidth);\n                    resources.addResource([key, null, strokeWidth], patternCanvas);\n                    imageTexture = patternCanvas;\n                }\n            }\n        }\n        if (imageTexture) {\n            ctx.strokeStyle = ctx.createPattern(imageTexture, 'repeat');\n            ctx.strokeStyle['linePatternOffset'] = linePatternOffset;\n        } else if (typeof console !== 'undefined') {\n            console.warn('img not found for', imgUrl);\n        }\n    },\n\n    clearRect(ctx, x1, y1, x2, y2) {\n        ctx.canvas._drawn = false;\n        ctx.clearRect(x1, y1, x2, y2);\n    },\n\n    fillCanvas(ctx, fillOpacity, x, y) {\n        if (hitTesting) {\n            fillOpacity = 1;\n        }\n        ctx.canvas._drawn = true;\n        if (fillOpacity === 0) {\n            return;\n        }\n        const isPattern = Canvas._isPattern(ctx.fillStyle);\n\n        const offset = ctx.fillStyle && ctx.fillStyle['polygonPatternOffset'];\n        const dx = offset ? offset[0] : 0,\n            dy = offset ? offset[1] : 0;\n\n        if (isNil(fillOpacity)) {\n            fillOpacity = 1;\n        }\n        let alpha;\n        if (fillOpacity < 1) {\n            alpha = ctx.globalAlpha;\n            ctx.globalAlpha *= fillOpacity;\n        }\n        if (isPattern) {\n            x = x || 0;\n            y = y || 0;\n            // x = round(x);\n            // y = round(y);\n            ctx.translate(x + dx, y + dy);\n        }\n        ctx.fill();\n        if (isPattern) {\n            ctx.translate(-x - dx, -y - dy);\n        }\n        if (fillOpacity < 1) {\n            ctx.globalAlpha = alpha;\n        }\n    },\n\n    // hexColorRe: /^#([0-9a-f]{6}|[0-9a-f]{3})$/i,\n\n    // support #RRGGBB/#RGB now.\n    // if color was like [red, orange...]/rgb(a)/hsl(a), op will not combined to result\n    getRgba(color, op) {\n        if (isNil(op)) {\n            op = 1;\n        }\n        if (color[0] !== '#') {\n            return color;\n        }\n        let r, g, b;\n        if (color.length === 7) {\n            r = parseInt(color.substring(1, 3), 16);\n            g = parseInt(color.substring(3, 5), 16);\n            b = parseInt(color.substring(5, 7), 16);\n        } else {\n            r = parseInt(color.substring(1, 2), 16) * 17;\n            g = parseInt(color.substring(2, 3), 16) * 17;\n            b = parseInt(color.substring(3, 4), 16) * 17;\n        }\n        return 'rgba(' + r + ',' + g + ',' + b + ',' + op + ')';\n    },\n\n    image(ctx, img, x, y, width, height) {\n        ctx.canvas._drawn = true;\n        try {\n            if (isNumber(width) && isNumber(height)) {\n                ctx.drawImage(img, x, y, width, height);\n            } else {\n                ctx.drawImage(img, x, y);\n            }\n        } catch (error) {\n            if (console) {\n                console.warn('error when drawing image on canvas:', error);\n                console.warn(img);\n            }\n        }\n    },\n\n    text(ctx, text, pt, style, textDesc) {\n        Canvas._textOnMultiRow(ctx, textDesc['rows'], style, pt, textDesc['size'], textDesc['rawSize']);\n    },\n\n    _textOnMultiRow(ctx, texts, style, point, splitTextSize, textSize) {\n        const ptAlign = getAlignPoint(splitTextSize, style['textHorizontalAlignment'], style['textVerticalAlignment']),\n            lineHeight = textSize['height'] + style['textLineSpacing'],\n            basePoint = point.add(0, ptAlign.y),\n            maxHeight = style['textMaxHeight'];\n        let text, rowAlign, height = 0;\n        for (let i = 0, len = texts.length; i < len; i++) {\n            text = texts[i]['text'];\n            rowAlign = getAlignPoint(texts[i]['size'], style['textHorizontalAlignment'], style['textVerticalAlignment']);\n            Canvas._textOnLine(ctx, text, basePoint.add(rowAlign.x, i * lineHeight), style['textHaloRadius'], style['textHaloFill'], style['textHaloOpacity']);\n            if (maxHeight > 0) {\n                height += lineHeight;\n                if (height + textSize['height'] >= maxHeight) {\n                    break;\n                }\n            }\n        }\n    },\n\n    _textOnLine(ctx, text, pt, textHaloRadius, textHaloFill, textHaloAlpha) {\n        if (hitTesting) {\n            textHaloAlpha = 1;\n        }\n        const drawHalo = textHaloAlpha !== 0 && textHaloRadius !== 0;\n        // pt = pt._round();\n        ctx.textBaseline = 'top';\n        let gco, fill;\n        const shadowBlur = ctx.shadowBlur,\n            shadowOffsetX = ctx.shadowOffsetX,\n            shadowOffsetY = ctx.shadowOffsetY;\n        if (drawHalo) {\n            const alpha = ctx.globalAlpha;\n            //http://stackoverflow.com/questions/14126298/create-text-outline-on-canvas-in-javascript\n            //根据text-horizontal-alignment和text-vertical-alignment计算绘制起始点偏移量\n            ctx.globalAlpha *= textHaloAlpha;\n\n            ctx.miterLimit = 2;\n            ctx.lineJoin = 'round';\n            ctx.lineCap = 'round';\n            ctx.lineWidth = textHaloRadius * 2;\n            ctx.strokeStyle = textHaloFill;\n            ctx.strokeText(text, Math.round(pt.x), Math.round(pt.y));\n            ctx.miterLimit = 10; //default\n\n            ctx.globalAlpha = alpha;\n\n            gco = ctx.globalCompositeOperation;\n            ctx.globalCompositeOperation = 'destination-out';\n            fill = ctx.fillStyle;\n            ctx.fillStyle = '#000';\n        }\n\n        if (shadowBlur && drawHalo) {\n            ctx.shadowBlur = ctx.shadowOffsetX = ctx.shadowOffsetY = 0;\n        }\n        Canvas.fillText(ctx, text, pt.x, pt.y);\n        if (gco) {\n            ctx.globalCompositeOperation = gco;\n            Canvas.fillText(ctx, text, pt.x, pt.y, fill);\n            if (shadowBlur) {\n                ctx.shadowBlur = shadowBlur;\n                ctx.shadowOffsetX = shadowOffsetX;\n                ctx.shadowOffsetY = shadowOffsetY;\n            }\n        }\n    },\n\n    fillText(ctx, text, x, y, rgba) {\n        ctx.canvas._drawn = true;\n        if (rgba) {\n            ctx.fillStyle = rgba;\n        }\n        ctx.fillText(text, Math.round(x), Math.round(y));\n    },\n\n    _stroke(ctx, strokeOpacity, x, y) {\n        if (hitTesting) {\n            strokeOpacity = 1;\n        }\n        ctx.canvas._drawn = true;\n        if (strokeOpacity === 0) {\n            return;\n        }\n        const offset = ctx.strokeStyle && ctx.strokeStyle['linePatternOffset'];\n        const dx = offset ? offset[0] : 0,\n            dy = offset ? offset[1] : 0;\n\n        const isPattern = Canvas._isPattern(ctx.strokeStyle) && (!isNil(x) && !isNil(y) || !isNil(dx) && !isNil(dy));\n\n        if (isNil(strokeOpacity)) {\n            strokeOpacity = 1;\n        }\n        let alpha;\n        if (strokeOpacity < 1) {\n            alpha = ctx.globalAlpha;\n            ctx.globalAlpha *= strokeOpacity;\n        }\n        if (isPattern) {\n            x = x || 0;\n            y = y || 0;\n            // x = round(x);\n            // y = round(y);\n            ctx.translate(x + dx, y + dy);\n        }\n        ctx.stroke();\n        if (isPattern) {\n            ctx.translate(-x - dx, -y - dy);\n        }\n        if (strokeOpacity < 1) {\n            ctx.globalAlpha = alpha;\n        }\n    },\n\n    _path(ctx, points, lineDashArray, lineOpacity, ignoreStrokePattern) {\n        if (!isArrayHasData(points)) {\n            return;\n        }\n\n        function fillWithPattern(p1, p2) {\n            const degree = computeDegree(p1.x, p1.y, p2.x, p2.y);\n            ctx.save();\n            ctx.translate(p1.x, p1.y - ctx.lineWidth / 2 / Math.cos(degree));\n            ctx.rotate(degree);\n            Canvas._stroke(ctx, lineOpacity);\n            ctx.restore();\n        }\n\n        const isDashed = isArrayHasData(lineDashArray);\n        const isPatternLine = (ignoreStrokePattern === true ? false : Canvas._isPattern(ctx.strokeStyle));\n        let point, prePoint, nextPoint;\n        for (let i = 0, len = points.length; i < len; i++) {\n            point = points[i];\n            if (!isDashed || ctx.setLineDash) { //IE9+\n                ctx.lineTo(point.x, point.y);\n                if (isPatternLine && i > 0) {\n                    prePoint = points[i - 1];\n                    fillWithPattern(prePoint, point);\n                    ctx.beginPath();\n                    ctx.moveTo(point.x, point.y);\n                }\n            } else if (isDashed) {\n                if (i === len - 1) {\n                    break;\n                }\n                nextPoint = points[i + 1];\n                drawDashLine(ctx, point, nextPoint, lineDashArray, isPatternLine);\n            }\n        }\n    },\n\n    path(ctx, points, lineOpacity, fillOpacity, lineDashArray) {\n        if (!isArrayHasData(points)) {\n            return;\n        }\n        ctx.beginPath();\n        ctx.moveTo(points[0].x, points[0].y);\n        Canvas._path(ctx, points, lineDashArray, lineOpacity);\n        Canvas._stroke(ctx, lineOpacity);\n    },\n\n    _multiClip(ctx, points) {\n        if (!points || points.length === 0) return;\n        //not Handle holes\n        points = points[0];\n        for (let i = 0, len = points.length; i < len; i++) {\n            const point = points[i];\n            let x = point.x, y = point.y;\n            if (i === 0) {\n                ctx.moveTo(x, y);\n            } else {\n                ctx.lineTo(x, y);\n            }\n            if (i === len - 1) {\n                x = points[0].x;\n                y = points[0].y;\n                ctx.lineTo(x, y);\n            }\n        }\n    },\n\n    polygon(ctx, points, lineOpacity, fillOpacity, lineDashArray, smoothness) {\n        // if MultiClip\n        if (ctx.isMultiClip) {\n            Canvas._multiClip(ctx, points);\n            return;\n        }\n        if (!isArrayHasData(points)) {\n            return;\n        }\n\n        const isPatternLine = Canvas._isPattern(ctx.strokeStyle),\n            fillFirst = (isArrayHasData(lineDashArray) && !ctx.setLineDash) || isPatternLine && !smoothness;\n        if (!isArrayHasData(points[0])) {\n            points = [points];\n        }\n        const savedCtx = ctx;\n        if (points.length > 1 && !IS_NODE) {\n            if (!TEMP_CANVAS) {\n                TEMP_CANVAS = Canvas.createCanvas(1, 1);\n            }\n            ctx.canvas._drawn = false;\n            TEMP_CANVAS.width = ctx.canvas.width;\n            TEMP_CANVAS.height = ctx.canvas.height;\n            ctx = TEMP_CANVAS.getContext('2d');\n            copyProperties(ctx, savedCtx);\n        }\n        // function fillPolygon(points, i, op) {\n        //     Canvas.fillCanvas(ctx, op, points[i][0].x, points[i][0].y);\n        // }\n        let op, i, len;\n        if (fillFirst) {\n            //因为canvas只填充moveto,lineto,lineto的空间, 而dashline的moveto不再构成封闭空间, 所以重新绘制图形轮廓用于填充\n            ctx.save();\n            for (i = 0, len = points.length; i < len; i++) {\n                if (!isArrayHasData(points[i])) {\n                    continue;\n                }\n                Canvas._ring(ctx, points[i], null, 0, true);\n                op = fillOpacity;\n                if (i > 0) {\n                    ctx.globalCompositeOperation = 'destination-out';\n                    op = 1;\n                }\n                Canvas.fillCanvas(ctx, op, points[i][0].x, points[i][0].y);\n                if (i > 0) {\n                    ctx.globalCompositeOperation = 'source-over';\n                } else if (len > 1) {\n                    // make sure 'destination-out'\n                    ctx.fillStyle = '#fff';\n                }\n                Canvas._stroke(ctx, 0);\n            }\n            ctx.restore();\n        }\n        for (i = 0, len = points.length; i < len; i++) {\n            if (!isArrayHasData(points[i])) {\n                continue;\n            }\n\n            if (smoothness) {\n                Canvas.paintSmoothLine(ctx, points[i], lineOpacity, smoothness, true);\n                ctx.closePath();\n            } else {\n                Canvas._ring(ctx, points[i], lineDashArray, lineOpacity);\n            }\n\n            if (!fillFirst) {\n                op = fillOpacity;\n                if (i > 0) {\n                    ctx.globalCompositeOperation = 'destination-out';\n                    op = 1;\n                }\n                Canvas.fillCanvas(ctx, op, points[i][0].x, points[i][0].y);\n                if (i > 0) {\n                    //return to default compositeOperation to display strokes.\n                    ctx.globalCompositeOperation = 'source-over';\n                } else if (len > 1) {\n                    // make sure 'destination-out'\n                    ctx.fillStyle = '#fff';\n                }\n            }\n            Canvas._stroke(ctx, lineOpacity);\n        }\n        if (points.length > 1 && !IS_NODE) {\n            savedCtx.drawImage(TEMP_CANVAS, 0, 0);\n            savedCtx.canvas._drawn = ctx.canvas._drawn;\n            copyProperties(savedCtx, ctx);\n        }\n    },\n\n    _ring(ctx, ring, lineDashArray, lineOpacity, ignorePattern) {\n        const isPattern = Canvas._isPattern(ctx.strokeStyle);\n        if (!ignorePattern && isPattern && !ring[0].equals(ring[ring.length - 1])) {\n            ring = ring.concat([ring[0]]);\n        }\n        ctx.beginPath();\n        ctx.moveTo(ring[0].x, ring[0].y);\n        Canvas._path(ctx, ring, lineDashArray, lineOpacity, ignorePattern);\n        if (!isPattern) {\n            ctx.closePath();\n        }\n    },\n\n    paintSmoothLine(ctx, points, lineOpacity, smoothValue, close, tailIdx, tailRatio) {\n        if (!points) {\n            return;\n        }\n        if (points.length <= 2 || !smoothValue) {\n            Canvas.path(ctx, points, lineOpacity);\n            return;\n        }\n\n        //推算 cubic 贝塞尔曲线片段的起终点和控制点坐标\n        //t0: 片段起始比例 0-1\n        //t1: 片段结束比例 0-1\n        //x1, y1, 曲线起点\n        //bx1, by1, bx2, by2，曲线控制点\n        //x2, y2  曲线终点\n        //结果是曲线片段的起点，2个控制点坐标和终点坐标\n        //https://stackoverflow.com/questions/878862/drawing-part-of-a-b%C3%A9zier-curve-by-reusing-a-basic-b%C3%A9zier-curve-function/879213#879213\n        function interpolate(t0, t1, x1, y1, bx1, by1, bx2, by2, x2, y2) {\n            const u0 = 1.0 - t0;\n            const u1 = 1.0 - t1;\n\n            const qxa =  x1 * u0 * u0 + bx1 * 2 * t0 * u0 + bx2 * t0 * t0;\n            const qxb =  x1 * u1 * u1 + bx1 * 2 * t1 * u1 + bx2 * t1 * t1;\n            const qxc = bx1 * u0 * u0 + bx2 * 2 * t0 * u0 +  x2 * t0 * t0;\n            const qxd = bx1 * u1 * u1 + bx2 * 2 * t1 * u1 +  x2 * t1 * t1;\n\n            const qya =  y1 * u0 * u0 + by1 * 2 * t0 * u0 + by2 * t0 * t0;\n            const qyb =  y1 * u1 * u1 + by1 * 2 * t1 * u1 + by2 * t1 * t1;\n            const qyc = by1 * u0 * u0 + by2 * 2 * t0 * u0 +  y2 * t0 * t0;\n            const qyd = by1 * u1 * u1 + by2 * 2 * t1 * u1 +  y2 * t1 * t1;\n\n            // const xa = qxa * u0 + qxc * t0;\n            const xb = qxa * u1 + qxc * t1;\n            const xc = qxb * u0 + qxd * t0;\n            const xd = qxb * u1 + qxd * t1;\n\n            // const ya = qya * u0 + qyc * t0;\n            const yb = qya * u1 + qyc * t1;\n            const yc = qyb * u0 + qyd * t0;\n            const yd = qyb * u1 + qyd * t1;\n\n            return [xb, yb, xc, yc, xd, yd];\n        }\n\n        //from http://www.antigrain.com/research/bezier_interpolation/\n        function getCubicControlPoints(x0, y0, x1, y1, x2, y2, x3, y3, smoothValue, t) {\n            // Assume we need to calculate the control\n            // points between (x1,y1) and (x2,y2).\n            // Then x0,y0 - the previous vertex,\n            //      x3,y3 - the next one.\n            const xc1 = (x0 + x1) / 2.0, yc1 = (y0 + y1) / 2.0;\n            const xc2 = (x1 + x2) / 2.0, yc2 = (y1 + y2) / 2.0;\n            const xc3 = (x2 + x3) / 2.0, yc3 = (y2 + y3) / 2.0;\n\n            const len1 = Math.sqrt((x1 - x0) * (x1 - x0) + (y1 - y0) * (y1 - y0));\n            const len2 = Math.sqrt((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1));\n            const len3 = Math.sqrt((x3 - x2) * (x3 - x2) + (y3 - y2) * (y3 - y2));\n\n            const k1 = len1 / (len1 + len2);\n            const k2 = len2 / (len2 + len3);\n\n            const xm1 = xc1 + (xc2 - xc1) * k1, ym1 = yc1 + (yc2 - yc1) * k1;\n\n            const xm2 = xc2 + (xc3 - xc2) * k2, ym2 = yc2 + (yc3 - yc2) * k2;\n\n            // Resulting control points. Here smoothValue is mentioned\n            // above coefficient K whose value should be in range [0...1].\n            const ctrl1X = xm1 + (xc2 - xm1) * smoothValue + x1 - xm1,\n                ctrl1Y = ym1 + (yc2 - ym1) * smoothValue + y1 - ym1,\n\n                ctrl2X = xm2 + (xc2 - xm2) * smoothValue + x2 - xm2,\n                ctrl2Y = ym2 + (yc2 - ym2) * smoothValue + y2 - ym2;\n\n            const ctrlPoints = [ctrl1X, ctrl1Y, ctrl2X, ctrl2Y];\n            if (t < 1) {\n                return interpolate(0, t, x1, y1, ctrl1X, ctrl1Y, ctrl2X, ctrl2Y, x2, y2);\n            } else {\n                return ctrlPoints;\n            }\n        }\n        let count = points.length;\n        let l = close ? count : count - 1;\n\n        ctx.beginPath();\n        ctx.moveTo(points[0].x, points[0].y);\n        if (tailRatio !== undefined) l -= Math.max(l - tailIdx - 1, 0);\n        let preCtrlPoints;\n        for (let i = 0; i < l; i++) {\n            const x1 = points[i].x, y1 = points[i].y;\n\n            let x0, y0, x2, y2, x3, y3;\n            if (i - 1 < 0) {\n                if (!close) {\n                    x0 = points[i + 1].x;\n                    y0 = points[i + 1].y;\n                } else {\n                    x0 = points[l - 1].x;\n                    y0 = points[l - 1].y;\n                }\n            } else {\n                x0 = points[i - 1].x;\n                y0 = points[i - 1].y;\n            }\n            if (i + 1 < count) {\n                x2 = points[i + 1].x;\n                y2 = points[i + 1].y;\n            } else {\n                x2 = points[i + 1 - count].x;\n                y2 = points[i + 1 - count].y;\n            }\n            if (i + 2 < count) {\n                x3 = points[i + 2].x;\n                y3 = points[i + 2].y;\n            } else if (!close) {\n                x3 = points[i].x;\n                y3 = points[i].y;\n            } else {\n                x3 = points[i + 2 - count].x;\n                y3 = points[i + 2 - count].y;\n            }\n\n            const ctrlPoints = getCubicControlPoints(x0, y0, x1, y1, x2, y2, x3, y3, smoothValue, i === l - 1 ? tailRatio : 1);\n            if (i === l - 1 && tailRatio >= 0 && tailRatio < 1) {\n                ctx.bezierCurveTo(ctrlPoints[0], ctrlPoints[1], ctrlPoints[2], ctrlPoints[3], ctrlPoints[4], ctrlPoints[5]);\n                points.splice(l - 1, count - (l - 1) - 1);\n                const lastPoint = new Point(ctrlPoints[4], ctrlPoints[5]);\n                lastPoint.prevCtrlPoint = new Point(ctrlPoints[2], ctrlPoints[3]);\n                points.push(lastPoint);\n                count = points.length;\n            } else {\n                ctx.bezierCurveTo(ctrlPoints[0], ctrlPoints[1], ctrlPoints[2], ctrlPoints[3], x2, y2);\n            }\n            points[i].nextCtrlPoint = ctrlPoints.slice(0, 2);\n            points[i].prevCtrlPoint = preCtrlPoints ? preCtrlPoints.slice(2) : null;\n            preCtrlPoints = ctrlPoints;\n        }\n        if (!close && points[1].prevCtrlPoint) {\n            points[0].nextCtrlPoint = points[1].prevCtrlPoint;\n            delete points[0].prevCtrlPoint;\n        }\n        if (!points[count - 1].prevCtrlPoint) {\n            points[count - 1].prevCtrlPoint = points[count - 2].nextCtrlPoint;\n        }\n        Canvas._stroke(ctx, lineOpacity);\n    },\n\n    /**\n     * draw an arc from p1 to p2 with degree of (p1, center) and (p2, center)\n     * @param  {Context} ctx    canvas context\n     * @param  {Point} p1      point 1\n     * @param  {Point} p2      point 2\n     * @param  {Number} degree arc degree between p1 and p2\n     */\n    _arcBetween(ctx, p1, p2, degree) {\n        const a = degree,\n            dist = p1.distanceTo(p2),\n            //radius of circle\n            r = dist / 2 / Math.sin(a / 2);\n        //angle between p1 and p2\n        let p1p2 = Math.asin((p2.y - p1.y) / dist);\n        if (p1.x > p2.x) {\n            p1p2 = Math.PI - p1p2;\n        }\n        //angle between circle center and p2\n        const cp2 = 90 * Math.PI / 180 - a / 2,\n            da = p1p2 - cp2;\n\n        const dx = Math.cos(da) * r,\n            dy = Math.sin(da) * r,\n            cx = p1.x + dx,\n            cy = p1.y + dy;\n\n        let startAngle = Math.asin((p2.y - cy) / r);\n        if (cx > p2.x) {\n            startAngle = Math.PI - startAngle;\n        }\n        const endAngle = startAngle + a;\n\n        ctx.beginPath();\n        ctx.arc(cx, cy, r, startAngle, endAngle);\n        return [cx, cy];\n    },\n\n    _lineTo(ctx, p) {\n        ctx.lineTo(p.x, p.y);\n    },\n\n    bezierCurveAndFill(ctx, points, lineOpacity, fillOpacity) {\n        ctx.beginPath();\n        const start = points[0];\n        ctx.moveTo(start.x, start.y);\n        const args = [ctx];\n        args.push.apply(args, points.splice(1));\n        Canvas._bezierCurveTo.apply(Canvas, args);\n        Canvas.fillCanvas(ctx, fillOpacity);\n        Canvas._stroke(ctx, lineOpacity);\n    },\n\n    _bezierCurveTo(ctx, p1, p2, p3) {\n        ctx.bezierCurveTo(p1.x, p1.y, p2.x, p2.y, p3.x, p3.y);\n    },\n\n\n    //各种图形的绘制方法\n    ellipse(ctx, pt, width, height, lineOpacity, fillOpacity) {\n        function bezierEllipse(x, y, a, b) {\n            const k = 0.5522848,\n                ox = a * k,\n                oy = b * k;\n            ctx.moveTo(x - a, y);\n            ctx.bezierCurveTo(x - a, y - oy, x - ox, y - b, x, y - b);\n            ctx.bezierCurveTo(x + ox, y - b, x + a, y - oy, x + a, y);\n            ctx.bezierCurveTo(x + a, y + oy, x + ox, y + b, x, y + b);\n            ctx.bezierCurveTo(x - ox, y + b, x - a, y + oy, x - a, y);\n            ctx.closePath();\n        }\n        ctx.beginPath();\n        if (width === height) {\n            ctx.arc(pt.x, pt.y, width, 0, 2 * Math.PI);\n        } else if (ctx.ellipse) {\n            ctx.ellipse(pt.x, pt.y, width, height, 0, 0, Math.PI / 180 * 360);\n        } else {\n            // IE\n            bezierEllipse(pt.x, pt.y, width, height);\n        }\n        Canvas.fillCanvas(ctx, fillOpacity, pt.x - width, pt.y - height);\n        Canvas._stroke(ctx, lineOpacity, pt.x - width, pt.y - height);\n    },\n\n    rectangle(ctx, x, y, size, lineOpacity, fillOpacity) {\n        // pt = pt._round();\n        ctx.beginPath();\n        ctx.rect(x, y, size['width'], size['height']);\n        Canvas.fillCanvas(ctx, fillOpacity, x, y);\n        Canvas._stroke(ctx, lineOpacity, x, y);\n    },\n\n    sector(ctx, pt, size, angles, lineOpacity, fillOpacity) {\n        const rad = Math.PI / 180;\n        const startAngle = angles[0],\n            endAngle = angles[1];\n\n        function sector(ctx, x, y, radius, startAngle, endAngle) {\n            const sDeg = rad * -endAngle;\n            const eDeg = rad * -startAngle;\n            ctx.beginPath();\n            ctx.moveTo(x, y);\n            ctx.arc(x, y, radius, sDeg, eDeg);\n            ctx.lineTo(x, y);\n            Canvas.fillCanvas(ctx, fillOpacity, x - radius, y - radius);\n            Canvas._stroke(ctx, lineOpacity, x - radius, y - radius);\n        }\n        sector(ctx, pt.x, pt.y, size, startAngle, endAngle);\n    },\n\n    _isPattern(style) {\n        return !isString(style) && !('addColorStop' in style);\n    },\n\n    drawCross(ctx, x, y, lineWidth, color) {\n        ctx.canvas._drawn = true;\n        ctx.strokeStyle = color;\n        ctx.lineWidth = lineWidth;\n        ctx.beginPath();\n        ctx.moveTo(x - 5, y);\n        ctx.lineTo(x + 5, y);\n        ctx.moveTo(x, y - 5);\n        ctx.lineTo(x, y + 5);\n        ctx.stroke();\n    },\n\n    copy(canvas, c) {\n        const target = c || createEl('canvas');\n        target.width = canvas.width;\n        target.height = canvas.height;\n        target.getContext('2d').drawImage(canvas, 0, 0);\n        return target;\n    }\n};\n\nexport default Canvas;\n\n\n/* istanbul ignore next */\nfunction drawDashLine(ctx, startPoint, endPoint, dashArray) {\n    //https://davidowens.wordpress.com/2010/09/07/html-5-canvas-and-dashed-lines/\n    //\n    // Our growth rate for our line can be one of the following:\n    //   (+,+), (+,-), (-,+), (-,-)\n    // Because of this, our algorithm needs to understand if the x-coord and\n    // y-coord should be getting smaller or larger and properly cap the values\n    // based on (x,y).\n    const fromX = startPoint.x,\n        fromY = startPoint.y,\n        toX = endPoint.x,\n        toY = endPoint.y;\n    const pattern = dashArray;\n    const lt = function (a, b) {\n        return a <= b;\n    };\n    const gt = function (a, b) {\n        return a >= b;\n    };\n    const capmin = function (a, b) {\n        return Math.min(a, b);\n    };\n    const capmax = function (a, b) {\n        return Math.max(a, b);\n    };\n\n    const checkX = {\n        thereYet: gt,\n        cap: capmin\n    };\n    const checkY = {\n        thereYet: gt,\n        cap: capmin\n    };\n\n    if (fromY - toY > 0) {\n        checkY.thereYet = lt;\n        checkY.cap = capmax;\n    }\n    if (fromX - toX > 0) {\n        checkX.thereYet = lt;\n        checkX.cap = capmax;\n    }\n\n    ctx.moveTo(fromX, fromY);\n    let offsetX = fromX;\n    let offsetY = fromY;\n    let idx = 0,\n        dash = true;\n    let ang, len;\n    while (!(checkX.thereYet(offsetX, toX) && checkY.thereYet(offsetY, toY))) {\n        ang = Math.atan2(toY - fromY, toX - fromX);\n        len = pattern[idx];\n\n        offsetX = checkX.cap(toX, offsetX + (Math.cos(ang) * len));\n        offsetY = checkY.cap(toY, offsetY + (Math.sin(ang) * len));\n\n        if (dash) {\n            ctx.lineTo(offsetX, offsetY);\n        } else {\n            ctx.moveTo(offsetX, offsetY);\n        }\n\n        idx = (idx + 1) % pattern.length;\n        dash = !dash;\n    }\n}\n\nconst prefix = 'data:image/';\nfunction isImageUrl(url) {\n    return url.length > prefix.length && url.substring(0, prefix.length) === prefix || isCssUrl(url);\n}\n\nfunction extractImageUrl(url) {\n    if (url.substring(0, prefix.length) === prefix) {\n        return url;\n    }\n    return extractCssUrl(url);\n}\n\nfunction copyProperties(ctx, savedCtx) {\n    ctx.filter = savedCtx.filter;\n    ctx.fillStyle = savedCtx.fillStyle;\n    ctx.globalAlpha = savedCtx.globalAlpha;\n    ctx.lineCap = savedCtx.lineCap;\n    ctx.lineDashOffset = savedCtx.lineDashOffset;\n    ctx.lineJoin = savedCtx.lineJoin;\n    ctx.lineWidth = savedCtx.lineWidth;\n    ctx.shadowBlur = savedCtx.shadowBlur;\n    ctx.shadowColor = savedCtx.shadowColor;\n    ctx.shadowOffsetX = savedCtx.shadowOffsetX;\n    ctx.shadowOffsetY = savedCtx.shadowOffsetY;\n    ctx.strokeStyle = savedCtx.strokeStyle;\n}\n","!function(i){\"use strict\";var c,s,u=\"fulfilled\",f=\"undefined\",a=function(){var e=[],n=0;function o(){for(;e.length-n;){try{e[n]()}catch(t){i.console&&i.console.error(t)}e[n++]=s,1024==n&&(e.splice(0,1024),n=0)}}var r=function(){if(typeof MutationObserver===f)return typeof process!==f&&\"function\"==typeof process.nextTick?function(){process.nextTick(o)}:typeof setImmediate!==f?function(){setImmediate(o)}:function(){setTimeout(o,0)};var t=document.createElement(\"div\");return new MutationObserver(o).observe(t,{attributes:!0}),function(){t.setAttribute(\"a\",0)}}();return function(t){e.push(t),e.length-n==1&&r()}}();function l(t){if(!(this instanceof l))throw new TypeError(\"Zousan must be created with the new keyword\");if(\"function\"==typeof t){var e=this;try{t(function(t){e.resolve(t)},function(t){e.reject(t)})}catch(t){e.reject(t)}}else if(0<arguments.length)throw new TypeError(\"Zousan resolver \"+t+\" is not a function\")}function h(e,t){if(\"function\"==typeof e.y)try{var n=e.y.call(s,t);e.p.resolve(n)}catch(t){e.p.reject(t)}else e.p.resolve(t)}function v(e,t){if(\"function\"==typeof e.n)try{var n=e.n.call(s,t);e.p.resolve(n)}catch(t){e.p.reject(t)}else e.p.reject(t)}l.prototype={resolve:function(n){if(this.state===c){if(n===this)return this.reject(new TypeError(\"Attempt to resolve promise with self\"));var o=this;if(n&&(\"function\"==typeof n||\"object\"==typeof n))try{var e=!0,t=n.then;if(\"function\"==typeof t)return void t.call(n,function(t){e&&(e=!1,o.resolve(t))},function(t){e&&(e=!1,o.reject(t))})}catch(t){return void(e&&this.reject(t))}this.state=u,this.v=n,o.c&&a(function(){for(var t=0,e=o.c.length;t<e;t++)h(o.c[t],n)})}},reject:function(n){if(this.state===c){var t=this;this.state=\"rejected\",this.v=n;var o=this.c;a(o?function(){for(var t=0,e=o.length;t<e;t++)v(o[t],n)}:function(){t.handled||!l.suppressUncaughtRejectionError&&i.console&&l.warn(\"You upset Zousan. Please catch rejections: \",n,n?n.stack:null)})}},then:function(t,e){var n=new l,o={y:t,n:e,p:n};if(this.state===c)this.c?this.c.push(o):this.c=[o];else{var r=this.state,i=this.v;this.handled=!0,a(function(){r===u?h(o,i):v(o,i)})}return n},catch:function(t){return this.then(null,t)},finally:function(t){return this.then(t,t)},timeout:function(t,o){o=o||\"Timeout\";var r=this;return new l(function(e,n){setTimeout(function(){n(Error(o))},t),r.then(function(t){e(t)},function(t){n(t)})})}},l.resolve=function(t){var e=new l;return e.resolve(t),e},l.reject=function(t){var e=new l;return e.c=[],e.reject(t),e},l.all=function(n){var o=[],r=0,i=new l;function t(t,e){t&&\"function\"==typeof t.then||(t=l.resolve(t)),t.then(function(t){o[e]=t,++r==n.length&&i.resolve(o)},function(t){i.reject(t)})}for(var e=0;e<n.length;e++)t(n[e],e);return n.length||i.resolve(o),i},l.warn=console.warn,typeof module!=f&&module.exports&&(module.exports=l),i.define&&i.define.amd&&i.define([],function(){return l}),(i.Zousan=l).soon=a}(\"undefined\"!=typeof global?global:this);","import Zousan from 'zousan';\n\nlet promise;\n\nif (typeof Promise !== 'undefined') {\n    // built-in Promise\n    promise = Promise;\n} else {\n    promise = Zousan;\n}\n\nexport default promise;\n","import { extend, isString, isNil } from './util';\nimport { stopPropagation } from './util/dom';\n/**\n * This provides methods used for event handling. It's a mixin and not meant to be used directly.\n * @mixin Eventable\n */\n\nconst Eventable = Base =>\n\n    class extends Base {\n        /**\n         * Register a handler function to be called whenever this event is fired.\n         *\n         * @param {String} eventsOn                  - event types to register, seperated by space if more than one.\n         * @param {Function} handler                 - handler function to be called\n         * @param {Object} [context=null]            - the context of the handler\n         * @return {Any} this\n         * @function Eventable.on\n         * @example\n         * foo.on('mousedown mousemove mouseup', onMouseEvent, foo);\n         */\n        on(eventsOn, handler, context) {\n            if (!eventsOn) {\n                return this;\n            }\n            if (!isString(eventsOn)) {\n                return this._switch('on', eventsOn, handler);\n            }\n            if (!handler) {\n                return this;\n            }\n            if (!this._eventMap) {\n                this._eventMap = {};\n            }\n            const eventTypes = eventsOn.toLowerCase().split(' ');\n            let evtType;\n            if (!context) {\n                context = this;\n            }\n            let handlerChain;\n            for (let ii = 0, ll = eventTypes.length; ii < ll; ii++) {\n                evtType = eventTypes[ii];\n                handlerChain = this._eventMap[evtType];\n                if (!handlerChain) {\n                    handlerChain = [];\n                    this._eventMap[evtType] = handlerChain;\n                }\n                const l = handlerChain.length;\n                if (l > 0) {\n                    for (let i = 0; i < l; i++) {\n                        if (handler === handlerChain[i].handler && handlerChain[i].context === context) {\n                            return this;\n                        }\n                    }\n                }\n                handlerChain.push({\n                    handler: handler,\n                    context: context\n                });\n            }\n            return this;\n        }\n\n        /**\n         * Alias for [on]{@link Eventable.on}\n         *\n         * @param {String} eventTypes     - event types to register, seperated by space if more than one.\n         * @param {Function} handler                 - handler function to be called\n         * @param {Object} [context=null]            - the context of the handler\n         * @return {} this\n         * @function Eventable.addEventListener\n         */\n        addEventListener() {\n            return this.on.apply(this, arguments);\n        }\n\n        /**\n         * Same as on, except the listener will only get fired once and then removed.\n         *\n         * @param {String} eventTypes                - event types to register, seperated by space if more than one.\n         * @param {Function} handler                 - listener handler\n         * @param {Object} [context=null]            - the context of the handler\n         * @return {} this\n         * @example\n         * foo.once('mousedown mousemove mouseup', onMouseEvent, foo);\n         * @function Eventable.once\n         */\n        once(eventTypes, handler, context) {\n            if (!isString(eventTypes)) {\n                const once = {};\n                for (const p in eventTypes) {\n                    if (eventTypes.hasOwnProperty(p)) {\n                        once[p] = this._wrapOnceHandler(p, eventTypes[p], context);\n                    }\n                }\n                return this._switch('on', once);\n            }\n            const evetTypes = eventTypes.split(' ');\n            for (let i = 0, l = evetTypes.length; i < l; i++) {\n                this.on(evetTypes[i], this._wrapOnceHandler(evetTypes[i], handler, context));\n            }\n            return this;\n        }\n\n        /**\n         * Unregister the event handler for the specified event types.\n         *\n         * @param {String} eventsOff                - event types to unregister, seperated by space if more than one.\n         * @param {Function} handler                - listener handler\n         * @param {Object} [context=null]           - the context of the handler\n         * @return {} this\n         * @example\n         * foo.off('mousedown mousemove mouseup', onMouseEvent, foo);\n         * @function Eventable.off\n         */\n        off(eventsOff, handler, context) {\n            if (!this._eventMap || !eventsOff) {\n                return this;\n            }\n            if (!isString(eventsOff)) {\n                return this._switch('off', eventsOff, handler);\n            }\n            if (!handler) {\n                return this;\n            }\n            const eventTypes = eventsOff.split(' ');\n            let eventType, listeners, wrapKey;\n            if (!context) {\n                context = this;\n            }\n            for (let j = 0, jl = eventTypes.length; j < jl; j++) {\n                eventType = eventTypes[j].toLowerCase();\n                wrapKey = 'Z__' + eventType;\n                listeners = this._eventMap[eventType];\n                if (!listeners) {\n                    return this;\n                }\n                for (let i = listeners.length - 1; i >= 0; i--) {\n                    const listener = listeners[i];\n                    if ((handler === listener.handler || handler === listener.handler[wrapKey]) && listener.context === context) {\n                        delete listener.handler[wrapKey];\n                        listeners.splice(i, 1);\n                    }\n                }\n                if (!listeners.length) {\n                    delete this._eventMap[eventType];\n                }\n            }\n            return this;\n        }\n\n        /**\n         * Alias for [off]{@link Eventable.off}\n         *\n         * @param {String} eventTypes    - event types to unregister, seperated by space if more than one.\n         * @param {Function} handler                - listener handler\n         * @param {Object} [context=null]           - the context of the handler\n         * @return {} this\n         * @function Eventable.removeEventListener\n         */\n        removeEventListener() {\n            return this.off.apply(this, arguments);\n        }\n\n        /**\n         * Returns listener's count registered for the event type.\n         *\n         * @param {String} eventType        - an event type\n         * @param {Function} [hanlder=null] - listener function\n         * @param {Object} [context=null]   - the context of the handler\n         * @return {Number}\n         * @function Eventable.listens\n         */\n        listens(eventType, handler, context) {\n            if (!this._eventMap || !isString(eventType)) {\n                return 0;\n            }\n            const handlerChain = this._eventMap[eventType.toLowerCase()];\n            if (!handlerChain || !handlerChain.length) {\n                return 0;\n            }\n            if (!handler) {\n                return handlerChain.length;\n            }\n            for (let i = 0, len = handlerChain.length; i < len; i++) {\n                if (handler === handlerChain[i].handler &&\n                    (isNil(context) || handlerChain[i].context === context)) {\n                    return 1;\n                }\n            }\n            return 0;\n        }\n\n        /**\n         * Get all the listening event types\n         *\n         * @returns {String[]} events\n         */\n        getListeningEvents() {\n            if (!this._eventMap) {\n                return [];\n            }\n            return Object.keys(this._eventMap);\n        }\n\n        /**\n         * Copy all the event listener to the target object\n         * @param {Object} target - target object to copy to.\n         * @return {} this\n         * @function Eventable.copyEventListeners\n         */\n        copyEventListeners(target) {\n            const eventMap = target._eventMap;\n            if (!eventMap) {\n                return this;\n            }\n            let handlerChain;\n            for (const eventType in eventMap) {\n                handlerChain = eventMap[eventType];\n                for (let i = 0, len = handlerChain.length; i < len; i++) {\n                    this.on(eventType, handlerChain[i].handler, handlerChain[i].context);\n                }\n            }\n            return this;\n        }\n\n        /**\n         * Fire an event, causing all handlers for that event name to run.\n         *\n         * @param  {String} eventType - an event type to fire\n         * @param  {Object} param     - parameters for the listener function.\n         * @return {} this\n         * @function Eventable.fire\n         */\n        fire() {\n            if (this._eventParent) {\n                return this._eventParent.fire.apply(this._eventParent, arguments);\n            }\n            return this._fire.apply(this, arguments);\n        }\n\n        _wrapOnceHandler(evtType, handler, context) {\n            const me = this;\n            const key = 'Z__' + evtType;\n            let called = false;\n            const fn = function onceHandler() {\n                if (called) {\n                    return;\n                }\n                delete fn[key];\n                called = true;\n                if (context) {\n                    handler.apply(context, arguments);\n                } else {\n                    handler.apply(this, arguments);\n                }\n                me.off(evtType, onceHandler, this);\n            };\n            fn[key] = handler;\n            return fn;\n        }\n\n        _switch(to, eventKeys, context) {\n            for (const p in eventKeys) {\n                if (eventKeys.hasOwnProperty(p)) {\n                    this[to](p, eventKeys[p], context);\n                }\n            }\n            return this;\n        }\n\n        _clearListeners(eventType) {\n            if (!this._eventMap || !isString(eventType)) {\n                return;\n            }\n            const handlerChain = this._eventMap[eventType.toLowerCase()];\n            if (!handlerChain) {\n                return;\n            }\n            this._eventMap[eventType] = null;\n        }\n\n        _clearAllListeners() {\n            this._eventMap = null;\n        }\n\n        /**\n         * Set a event parent to handle all the events\n         * @param {Any} parent - event parent\n         * @return {Any} this\n         * @private\n         * @function Eventable._setEventParent\n         */\n        _setEventParent(parent) {\n            this._eventParent = parent;\n            return this;\n        }\n\n        _fire(eventType, param) {\n            if (!this._eventMap) {\n                return this;\n            }\n            const handlerChain = this._eventMap[eventType.toLowerCase()];\n            if (!handlerChain) {\n                return this;\n            }\n            if (!param) {\n                param = {};\n            }\n            param['type'] = eventType;\n            param['target'] = this;\n            //in case of deleting a listener in a execution, copy the handlerChain to execute.\n            const queue = handlerChain.slice(0);\n            let context, bubble, passed;\n            for (let i = 0, len = queue.length; i < len; i++) {\n                if (!queue[i]) {\n                    continue;\n                }\n                context = queue[i].context;\n                bubble = true;\n                passed = extend({}, param);\n                if (context) {\n                    bubble = queue[i].handler.call(context, passed);\n                } else {\n                    bubble = queue[i].handler(passed);\n                }\n                //stops the event propagation if the handler returns false.\n                if (bubble === false) {\n                    if (param['domEvent']) {\n                        stopPropagation(param['domEvent']);\n                    }\n                }\n            }\n            return this;\n        }\n    };\n\nexport default Eventable;\n","import Eventable from '../core/Eventable';\n\n/**\n * Base class for all the interaction handlers\n * @category handler\n * @abstract\n * @protected\n */\nclass Handler {\n    constructor(target) {\n        this.target = target;\n    }\n\n    /**\n     * Enables the handler\n     * @return {Handler} this\n     */\n    enable() {\n        if (this._enabled) {\n            return this;\n        }\n        this._enabled = true;\n        this.addHooks();\n        return this;\n    }\n\n    /**\n     * Disablesthe handler\n     * @return {Handler} this\n     */\n    disable() {\n        if (!this._enabled) {\n            return this;\n        }\n        this._enabled = false;\n        this.removeHooks();\n        return this;\n    }\n\n    /**\n     * Returns true if the handler is enabled.\n     * @return {Boolean}\n     */\n    enabled() {\n        return !!this._enabled;\n    }\n\n    remove() {\n        this.disable();\n        delete this.target;\n        delete this.dom;\n    }\n}\n\n\nexport default Eventable(Handler);\n","import { extend } from './util/common';\nimport Handler from '../handler/Handler';\n\n/**\n * This library uses ES2015 class system. <br />\n * Class is the root class of class hierachy. <br />\n * It provides utility methods to make it easier to manage configration options, merge mixins and add init hooks.\n * @example\n * var defaultOptions = {\n *     'foo' : 'bar'\n * };\n * class Foo extends maptalks.Class {\n *     constructor(id, options) {\n *         super(options);\n *         this.setId(id);\n *     }\n *\n *     setId(id) {\n *         this.id = id;\n *     }\n *\n *     whenCreated() {\n *         // .....\n *     }\n * }\n *\n * Foo.mergeOptions(defaultOptions);\n *\n * Foo.addInitHook('whenCreated');\n * @category core\n * @abstract\n */\nclass Class {\n\n    /**\n     * Create an object, set options if given and call all the init hooks.<br />\n     * Options is where the object manages its configuration. Options passed to the object will be merged with parent's instead of overriding it.\n     *\n     * @param  {Object} options - options to set\n     */\n    constructor(options) {\n        if (!this || !this.setOptions) {\n            throw new Error('Class instance is being created without \"new\" operator.');\n        }\n        this.setOptions(options);\n        this.callInitHooks();\n    }\n\n    /**\n     * Visit and call all the init hooks defined on Class and its parents.\n     * @return {Class} this\n     */\n    callInitHooks() {\n        const proto = Object.getPrototypeOf(this);\n        this._visitInitHooks(proto);\n        return this;\n    }\n\n    /**\n     * Merges options with the default options of the object.\n     * @param {Object} options - options to set\n     * @return {Class} this\n     */\n    setOptions(options) {\n        if (!this.hasOwnProperty('options')) {\n            this.options = this.options ? Object.create(this.options) : {};\n        }\n        if (!options) {\n            return this;\n        }\n        for (const i in options) {\n            this.options[i] = options[i];\n        }\n        return this;\n    }\n\n    /**\n     * 1. Return object's options if no parameter is provided. <br/>\n     *\n     * 2. update an option and enable/disable the handler if a handler with the same name existed.\n     * @example\n     * // Get marker's options;\n     * var options = marker.config();\n     * // Set map's option \"draggable\" to false and disable map's draggable handler.\n     * map.config('draggable', false);\n     * // You can update more than one options like this:\n     * map.config({\n     *     'scrollWheelZoom' : false,\n     *     'doubleClickZoom' : false\n     * });\n     * @param  {Object} conf - config to update\n     * @return {Class} this\n     */\n    config(conf) {\n        if (!conf) {\n            const config = {};\n            for (const p in this.options) {\n                if (this.options.hasOwnProperty(p)) {\n                    config[p] = this.options[p];\n                }\n            }\n            return config;\n        } else {\n            if (arguments.length === 2) {\n                const t = {};\n                t[conf] = arguments[1];\n                conf = t;\n            }\n            for (const i in conf) {\n                this.options[i] = conf[i];\n                // enable/disable handler\n                if (this[i] && (this[i] instanceof Handler)) {\n                    if (conf[i]) {\n                        this[i].enable();\n                    } else {\n                        this[i].disable();\n                    }\n                }\n            }\n            // callback when set config\n            this.onConfig(conf);\n        }\n        return this;\n    }\n\n    /**\n     * Default callback when config is called\n     */\n    onConfig(/*conf*/) {\n\n    }\n\n    _visitInitHooks(proto) {\n        if (this._initHooksCalled) {\n            return;\n        }\n        const parentProto = Object.getPrototypeOf(proto);\n        if (parentProto._visitInitHooks) {\n            parentProto._visitInitHooks.call(this, parentProto);\n        }\n        this._initHooksCalled = true;\n        const hooks = proto._initHooks;\n        if (hooks && hooks !== parentProto._initHooks) {\n            for (let i = 0; i < hooks.length; i++) {\n                hooks[i].call(this);\n            }\n        }\n    }\n\n    /**\n     * Add an init hook, which will be called when the object is initiated. <br>\n     * It is useful in plugin developing to do things when creating objects without changing class's constructor.\n     * @param {String|Function} fn - a hook function or name of the hook function\n     * @param {Any[]} args         - arguments for the init hook function\n     */\n    static addInitHook(fn, ...args) {\n        const init = typeof fn === 'function' ? fn : function () {\n            this[fn].apply(this, args);\n        };\n        const proto = this.prototype;\n        const parentProto = Object.getPrototypeOf(proto);\n        if (!proto._initHooks || proto._initHooks === parentProto._initHooks) {\n            proto._initHooks = [];\n        }\n        proto._initHooks.push(init);\n        return this;\n    }\n\n    /**\n     * Mixin the specified objects into the class as prototype properties or methods.\n     * @param  {...Object} sources - objects to mixin\n     */\n    static include(...sources) {\n        for (let i = 0; i < sources.length; i++) {\n            extend(this.prototype, sources[i]);\n        }\n        return this;\n    }\n\n    /**\n     * Mixin options with the class's default options. <br />\n     * @param  {Object} options - options to merge.\n     */\n    static mergeOptions(options) {\n        const proto = this.prototype;\n        const parentProto = Object.getPrototypeOf(proto);\n        if (!proto.options || proto.options === parentProto.options) {\n            proto.options = proto.options ? Object.create(proto.options) : {};\n        }\n        extend(proto.options, options);\n        return this;\n    }\n}\n\nexport default Class;\n","\nconst registeredTypes = {};\n\n/**\n * A helper mixin for JSON serialization.\n * @mixin JSONAble\n */\nexport default Base =>\n    class extends Base {\n        /**\n         * It is a static method. <br>\n         * Register layer for JSON serialization and assign a JSON type.\n         * @param  {String} type - JSON type\n         * @function JSONAble.registerJSONType\n         */\n        static registerJSONType(type) {\n            if (!type) {\n                return this;\n            }\n            registeredTypes[type] = this;\n            return this;\n        }\n\n        /**\n         * It is a static method. <br>\n         * Get class of input JSON type\n         * @param  {String} type - JSON type\n         * @return {Class}      Class\n         * @function JSONAble.getJSONClass\n         */\n        static getJSONClass(type) {\n            if (!type) {\n                return null;\n            }\n            return registeredTypes[type];\n        }\n\n        /**\n         * Get object's JSON Type\n         * @return {String}\n         * @function JSONAble.getJSONType\n         */\n        getJSONType() {\n            if (this._jsonType === undefined) {\n                const clazz = Object.getPrototypeOf(this).constructor;\n                for (const p in registeredTypes) {\n                    if (registeredTypes[p] === clazz) {\n                        this._jsonType = p;\n                        break;\n                    }\n                }\n            }\n            if (!this._jsonType) {\n                throw new Error('Found an unregistered geometry class!');\n            }\n            return this._jsonType;\n        }\n    };\n","/**\n * A mixin, to enable a class with [interaction handlers]{@link Handler}\n * @protected\n * @category handler\n * @mixin Handlerable\n */\nexport default function (Base) {\n    return class extends Base {\n        /**\n         * Register a handler\n         * @param {String} name       - name of the handler\n         * @param {Handler}           - handler class\n         * @return {*} this\n         * @protected\n         * @function Handerable.addHandler\n         */\n        addHandler(name, handlerClass) {\n            if (!handlerClass) {\n                return this;\n            }\n            if (!this._handlers) {\n                this._handlers = [];\n            }\n            //handler已经存在\n            if (this[name]) {\n                this[name].enable();\n                return this;\n            }\n\n            const handler = this[name] = new handlerClass(this);\n\n            this._handlers.push(handler);\n\n            if (this.options[name]) {\n                handler.enable();\n            }\n            return this;\n        }\n\n        /**\n         * Removes a handler\n         * @param {String} name       - name of the handler\n         * @return {*} this\n         * @protected\n         * @function Handerable.removeHandler\n         */\n        removeHandler(name) {\n            if (!name) {\n                return this;\n            }\n            const handler = this[name];\n            if (handler) {\n                //handler registered\n                const hit = this._handlers.indexOf(handler);\n                if (hit >= 0) {\n                    this._handlers.splice(hit, 1);\n                }\n                this[name].remove();\n                delete this[name];\n            }\n            return this;\n        }\n\n        _clearHandlers() {\n            for (let i = 0, len = this._handlers.length; i < len; i++) {\n                this._handlers[i].remove();\n            }\n            this._handlers = [];\n        }\n    };\n}\n","import { isNumber } from '../core/util';\nimport Handler from './Handler';\nimport { on, off } from '../core/util/dom';\nimport Point from '../geo/Point';\n\nconst START_EVENTS = 'touchstart mousedown';\nconst MOVE_EVENTS = {\n    mousedown: 'mousemove',\n    touchstart: 'touchmove',\n    pointerdown: 'touchmove',\n    MSPointerDown: 'touchmove'\n};\nconst END_EVENTS = {\n    mousedown: 'mouseup',\n    touchstart: 'touchend',\n    pointerdown: 'touchend',\n    MSPointerDown: 'touchend'\n};\n\n/**\n * Drag handler\n * @category handler\n * @protected\n * @extends Handler\n */\nclass DragHandler extends Handler {\n\n    constructor(dom, options = {}) {\n        super(null);\n        this.dom = dom;\n        this.options = options;\n    }\n\n    enable() {\n        if (!this.dom) {\n            return this;\n        }\n        //create a dynamic method to resolve conflicts with other drag handler\n        this._onMouseDown = function (e) {\n            return this.onMouseDown(e);\n        };\n        on(this.dom, START_EVENTS, this._onMouseDown, this);\n        return this;\n    }\n\n\n    disable() {\n        if (!this.dom) {\n            return this;\n        }\n        this._offEvents();\n        off(this.dom, START_EVENTS, this._onMouseDown);\n        delete this._onMouseDown;\n        return this;\n    }\n\n    onMouseDown(event) {\n        if (!this.options['rightclick'] && event.button === 2) {\n            //ignore right mouse down\n            return;\n        }\n        if (event.touches && event.touches.length > 1) {\n            return;\n        }\n        if (this.options['cancelOn'] && this.options['cancelOn'](event) === true) {\n            return;\n        }\n        const dom = this.dom;\n        if (dom.setCapture) {\n            dom.setCapture();\n        } else if (window.captureEvents) {\n            window.captureEvents(window['Event'].MOUSEMOVE | window['Event'].MOUSEUP);\n        }\n        dom['ondragstart'] = function () {\n            return false;\n        };\n        delete this.moved;\n        const actual = event.touches ? event.touches[0] : event;\n        this.startPos = new Point(actual.clientX, actual.clientY);\n        on(document, MOVE_EVENTS[event.type], this.onMouseMove, this);\n        on(document, END_EVENTS[event.type], this.onMouseUp, this);\n        if (!this.options['ignoreMouseleave']) {\n            on(this.dom, 'mouseleave', this.onMouseUp, this);\n        }\n        this.fire('mousedown', {\n            'domEvent': event,\n            'mousePos': new Point(actual.clientX, actual.clientY)\n        });\n    }\n\n    onMouseMove(event) {\n        if (event.touches && event.touches.length > 1) {\n            if (this.moved) {\n                this.interupted = true;\n                this.onMouseUp(event);\n            }\n            return;\n        }\n        const actual = event.touches ? event.touches[0] : event;\n\n        const newPos = new Point(actual.clientX, actual.clientY),\n            offset = newPos.sub(this.startPos);\n        if (!offset.x && !offset.y) {\n            return;\n        }\n        if (!this.moved) {\n            this.fire('dragstart', {\n                'domEvent': event,\n                'mousePos': this.startPos.copy()\n            });\n            this.moved = true;\n        } else {\n            this.fire('dragging', {\n                'domEvent': event,\n                'mousePos': new Point(actual.clientX, actual.clientY)\n            });\n        }\n    }\n\n    onMouseUp(event) {\n        const actual = event.changedTouches ? event.changedTouches[0] : event;\n        this._offEvents();\n        const param = {\n            'domEvent': event\n        };\n        if (isNumber(actual.clientX)) {\n            param['mousePos'] = new Point(parseInt(actual.clientX, 0), parseInt(actual.clientY, 0));\n        }\n        if (this.moved/* && this.moving*/) {\n            param.interupted = this.interupted;\n            this.fire('dragend', param);\n            delete this.interupted;\n            delete this.moved;\n        }\n\n        this.fire('mouseup', param);\n    }\n\n    _offEvents() {\n        const dom = this.dom;\n        off(dom, 'mouseleave', this.onMouseUp, this);\n        if ((typeof document === 'undefined') || (typeof window === 'undefined')) {\n            return;\n        }\n        for (const i in MOVE_EVENTS) {\n            off(document, MOVE_EVENTS[i], this.onMouseMove, this);\n            off(document, END_EVENTS[i], this.onMouseUp, this);\n        }\n\n        if (dom['releaseCapture']) {\n            dom['releaseCapture']();\n        } else if (window.captureEvents) {\n            window.captureEvents(window['Event'].MOUSEMOVE | window['Event'].MOUSEUP);\n        }\n    }\n}\n\nexport default DragHandler;\n","import { isNumber, forEachCoord } from '../core/util';\nimport Position from './Position';\n/**\n * Represents a coordinate point <br>\n * e.g. <br>\n * A geographical point (longitude, latitude)\n * @example\n * var coord = new Coordinate(0, 0);\n * @example\n * var coord = new Coordinate([ 0, 0 ]);\n * @example\n * var coord = new Coordinate({ x : 0, y : 0 });\n * @category basic types\n */\nclass Coordinate extends Position {\n\n    /**\n     * Convert one or more Coordinate objects to GeoJSON style coordinates\n     * @param  {Coordinate|Coordinate[]} coordinates - coordinates to convert\n     * @return {Number[]|Number[][]}\n     * @example\n     * // result is [[100,0], [101,1]]\n     * var numCoords = Coordinate.toNumberArrays([new Coordinate(100,0), new Coordinate(101,1)]);\n     */\n    static toNumberArrays(coordinates) {\n        if (!Array.isArray(coordinates)) {\n            return [coordinates.x, coordinates.y];\n        }\n        return forEachCoord(coordinates, function (coord) {\n            return [coord.x, coord.y];\n        });\n    }\n\n    /**\n     * Convert one or more GeoJSON style coordiantes to Coordinate objects\n     * @param  {Number[]|Number[][]} coordinates - coordinates to convert\n     * @return {Coordinate|Coordinate[]}\n     * @example\n     * var coordinates = Coordinate.toCoordinates([[100,0], [101,1]]);\n     */\n    static toCoordinates(coordinates) {\n        if (isNumber(coordinates[0]) && isNumber(coordinates[1])) {\n            return new Coordinate(coordinates);\n        }\n        const result = [];\n        for (let i = 0, len = coordinates.length; i < len; i++) {\n            const child = coordinates[i];\n            if (Array.isArray(child)) {\n                if (isNumber(child[0])) {\n                    result.push(new Coordinate(child));\n                } else {\n                    result.push(Coordinate.toCoordinates(child));\n                }\n            } else {\n                result.push(new Coordinate(child));\n            }\n        }\n        return result;\n    }\n\n\n}\n\nexport default Coordinate;\n","/**\n * Represent CRS defined by [GeoJSON]{@link http://geojson.org/geojson-spec.html#coordinate-reference-system-objects}\n *\n * @category geo\n */\nclass CRS {\n\n    /**\n     * @param {String} type          - type of the CRS\n     * @param {Object} properties    - CRS's properties\n     */\n    constructor(type, properties) {\n        this.type = type;\n        this.properties = properties;\n    }\n\n    /**\n     * Create a [proj4]{@link https://github.com/OSGeo/proj.4} style CRS used by maptalks <br>\n     * @example\n     * {\n     *     \"type\"       : \"proj4\",\n     *     \"properties\" : {\n     *         \"proj\"   : \"+proj=longlat +datum=WGS84 +no_defs\"\n     *     }\n     * }\n     * var crs_wgs84 = CRS.createProj4(\"+proj=longlat +datum=WGS84 +no_defs\");\n     * @param  {String} proj - a proj4 projection string.\n     * @return {CRS}\n     */\n    static createProj4(proj) {\n        return new CRS('proj4', {\n            'proj': proj\n        });\n    }\n\n    static fromProjectionCode(code) {\n        if (!code) {\n            return null;\n        }\n        code = code.toUpperCase().replace(':', '');\n        return CRS[code] || null;\n    }\n}\n\n// some common CRS definitions\n\n/**\n * Predefined CRS of well-known WGS84 (aka EPSG:4326)\n * @type {CRS}\n * @constant\n */\nCRS.WGS84 = CRS.createProj4('+proj=longlat +datum=WGS84 +no_defs');\n\n/**\n * Alias for CRS.WGS84\n * @type {CRS}\n * @constant\n */\nCRS.EPSG4326 = CRS.WGS84;\n\n/**\n * Projected Coordinate System used by google maps that has the following alias: 'EPSG:3785', 'GOOGLE', 'EPSG:900913'\n * @type {CRS}\n * @constant\n */\nCRS.EPSG3857 = CRS.createProj4('+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs');\n\n/**\n * A CRS represents a simple Cartesian coordinate system. <br>\n * Maps x, y directly, is useful for maps of flat surfaces (e.g. indoor maps, game maps).\n * @type {CRS}\n * @constant\n */\nCRS.IDENTITY = CRS.createProj4('+proj=identity +no_defs');\n\n/**\n * Official coordinate system in China (aka EPSG:4490), in most cases, it can be considered the same with WGS84.\n * @type {CRS}\n * @see  {@link http://spatialreference.org/ref/sr-org/7408/}\n * @constant\n */\nCRS.CGCS2000 = CRS.createProj4('+proj=longlat +datum=CGCS2000');\n\n/**\n * Alias for CRS.CGCS2000\n * @type {CRS}\n * @constant\n */\nCRS.EPSG4490 = CRS.CGCS2000;\n\n/**\n * Projection used by [Baidu Map]{@link http://map.baidu.com}, a popular web map service in China.\n * @type {CRS}\n * @constant\n */\nCRS.BD09LL = CRS.createProj4('+proj=longlat +datum=BD09');\n\n/**\n * A encrypted CRS usded in the most online map services in China..\n * @type {CRS}\n * @see {@link https://en.wikipedia.org/wiki/Restrictions_on_geographic_data_in_China}\n * @constant\n */\nCRS.GCJ02 = CRS.createProj4('+proj=longlat +datum=GCJ02');\n\nexport default CRS;\n","import { isNil, isNumber } from '../core/util';\nimport Coordinate from './Coordinate';\nimport Point from './Point';\nimport Size from './Size';\n\n//temparary variables\nconst TEMP_POINT0 = new Point(0, 0);\nconst TEMP_COORD0 = new Coordinate(0, 0);\nconst TEMP_COORD1 = new Coordinate(0, 0);\nconst MINMAX = [];\n/* eslint-disable prefer-const */\nlet TEMP_EXTENT;\n/* eslint-enable prefer-const */\nconst TEMP_COMBINE = [];\n\n/**\n * Represent a bounding box on the map, a rectangular geographical area with minimum and maximum coordinates. <br>\n * There are serveral ways to create a extent:\n * @category basic types\n * @example\n * //with 4 numbers: xmin, ymin, xmax and ymax\n * var extent = new Extent(100, 10, 120, 20);\n * @example\n * //with 2 coordinates\n * var extent = new Extent(new Coordinate(100, 10), new Coordinate(120, 20));\n * @example\n * //with a json object containing xmin, ymin, xmax and ymax\n * var extent = new Extent({xmin : 100, ymin: 10, xmax: 120, ymax:20});\n * @example\n * var extent1 = new Extent(100, 10, 120, 20);\n * //with another extent\n * var extent2 = new Extent(extent1);\n */\nclass Extent {\n\n    /**\n     * @param {Number} x1   - x of coordinate 1\n     * @param {Number} y1   - y of coordinate 1\n     * @param {Number} x2   - x of coordinate 2\n     * @param {Number} y2   - y of coordinate 2\n     */\n    constructor(p1, p2, p3, p4) {\n        this._clazz = Coordinate;\n        const l = arguments.length;\n        const proj = l > 0 ? arguments[l - 1] : null;\n        if (proj && proj.unproject) {\n            this.projection = arguments[l - 1];\n        }\n        this._dirty = true;\n        this._initialize(p1, p2, p3, p4);\n    }\n\n    _initialize(p1, p2, p3, p4) {\n        /**\n         * @property {Number} xmin - minimum x\n         */\n        this.xmin = null;\n        /**\n         * @property {Number} xmax - maximum x\n         */\n        this.xmax = null;\n        /**\n         * @property {Number} ymin - minimum y\n         */\n        this.ymin = null;\n        /**\n         * @property {Number} ymax - maximum y\n         */\n        this.ymax = null;\n        if (isNil(p1)) {\n            return;\n        }\n        const projection = this.projection;\n        //Constructor 1: all numbers\n        if (isNumber(p1) &&\n            isNumber(p2) &&\n            isNumber(p3) &&\n            isNumber(p4)) {\n            if (projection) {\n                this.set(p1, p2, p3, p4);\n            } else {\n                this.set(\n                    Math.min(p1, p3),\n                    Math.min(p2, p4),\n                    Math.max(p1, p3),\n                    Math.max(p2, p4)\n                );\n            }\n            return;\n        } else if (Array.isArray(p1)) {\n            if (projection) {\n                this.set(p1[0], p1[1], p1[2], p1[3]);\n            } else {\n                this.set(\n                    Math.min(p1[0], p1[2]),\n                    Math.min(p1[1], p1[3]),\n                    Math.max(p1[0], p1[2]),\n                    Math.max(p1[1], p1[3])\n                );\n            }\n        } else if (isNumber(p1.x) &&\n            isNumber(p2.x) &&\n            isNumber(p1.y) &&\n            isNumber(p2.y)) {\n            //Constructor 2: two coordinates\n            if (projection) {\n                this.set(p1.x, p1.y, p2.x, p2.y);\n            } else {\n                if (p1.x > p2.x) {\n                    this['xmin'] = p2.x;\n                    this['xmax'] = p1.x;\n                } else {\n                    this['xmin'] = p1.x;\n                    this['xmax'] = p2.x;\n                }\n                if (p1.y > p2.y) {\n                    this['ymin'] = p2.y;\n                    this['ymax'] = p1.y;\n                } else {\n                    this['ymin'] = p1.y;\n                    this['ymax'] = p2.y;\n                }\n            }\n            //constructor 3: another extent or a object containing xmin, ymin, xmax and ymax\n        } else if (isNumber(p1['xmin']) &&\n            isNumber(p1['xmax']) &&\n            isNumber(p1['ymin']) &&\n            isNumber(p1['ymax'])) {\n            this.set(p1['xmin'], p1['ymin'], p1['xmax'], p1['ymax']);\n        }\n    }\n\n    _add(p) {\n        this._dirty = true;\n        if (!isNil(p.x)) {\n            this['xmin'] += p.x;\n            this['ymin'] += p.y;\n            this['xmax'] += p.x;\n            this['ymax'] += p.y;\n        } else if (!isNil(p.xmin)) {\n            this['xmin'] += p.xmin;\n            this['ymin'] += p.ymin;\n            this['xmax'] += p.xmax;\n            this['ymax'] += p.ymax;\n        } else if (!isNil(p[0])) {\n            this['xmin'] += p[0];\n            this['ymin'] += p[1];\n            this['xmax'] += p[0];\n            this['ymax'] += p[1];\n        }\n        return this;\n    }\n\n    /**\n     * Add the extent with a coordinate or a point.\n     * @param {Coordinate|Point} p - point or coordinate to add\n     * @returns {Extent} a new extent\n     */\n    add() {\n        const e = new this.constructor(this['xmin'], this['ymin'], this['xmax'], this['ymax'], this.projection);\n        return e._add.apply(e, arguments);\n    }\n\n    _scale(s) {\n        this._dirty = true;\n        this['xmin'] *= s;\n        this['ymin'] *= s;\n        this['xmax'] *= s;\n        this['ymax'] *= s;\n        return this;\n    }\n\n    _sub(p) {\n        this._dirty = true;\n        if (!isNil(p.x)) {\n            this['xmin'] -= p.x;\n            this['ymin'] -= p.y;\n            this['xmax'] -= p.x;\n            this['ymax'] -= p.y;\n        } else if (!isNil(p.xmin)) {\n            this['xmin'] -= p.xmin;\n            this['ymin'] -= p.ymin;\n            this['xmax'] -= p.xmax;\n            this['ymax'] -= p.ymax;\n        } else if (!isNil(p[0])) {\n            this['xmin'] -= p[0];\n            this['ymin'] -= p[1];\n            this['xmax'] -= p[0];\n            this['ymax'] -= p[1];\n        }\n        return this;\n    }\n\n    _substract() {\n        return this._sub.apply(this, arguments);\n    }\n\n    /**\n     * Substract the extent with a coordinate or a point.\n     * @param {Coordinate|Point} p - point or coordinate to substract\n     * @returns {Extent} a new extent\n     */\n    sub() {\n        const e = new this.constructor(this['xmin'], this['ymin'], this['xmax'], this['ymax'], this.projection);\n        return e._sub.apply(e, arguments);\n    }\n\n    /**\n     * Alias for sub\n     * @param {Coordinate|Point} p - point or coordinate to substract\n     * @returns {Extent} a new extent\n     */\n    substract() {\n        return this.sub.apply(this, arguments);\n    }\n\n\n    /**\n     * Round the extent\n     * @return {Extent} rounded extent\n     */\n    round() {\n        return new this.constructor(Math.round(this['xmin']), Math.round(this['ymin']),\n            Math.round(this['xmax']), Math.round(this['ymax']), this.projection);\n    }\n\n    _round() {\n        this._dirty = true;\n        this['xmin'] = Math.round(this['xmin']);\n        this['ymin'] = Math.round(this['ymin']);\n        this['xmax'] = Math.round(this['xmax']);\n        this['ymax'] = Math.round(this['ymax']);\n        return this;\n    }\n\n    /**\n     * Get the minimum point\n     * @return {Coordinate}\n     */\n    getMin() {\n        return new this._clazz(this['xmin'], this['ymin']);\n    }\n\n    /**\n     * Get the maximum point\n     * @return {Coordinate}\n     */\n    getMax() {\n        return new this._clazz(this['xmax'], this['ymax']);\n    }\n\n    /**\n     * Get center of the extent.\n     * @return {Coordinate}\n     */\n    getCenter() {\n        return new this._clazz((this['xmin'] + this['xmax']) / 2, (this['ymin'] + this['ymax']) / 2);\n    }\n\n    /**\n     * Whether the extent is valid\n     * @protected\n     * @return {Boolean}\n     */\n    isValid() {\n        return !isNil(this['xmin']) &&\n            !isNil(this['ymin']) &&\n            !isNil(this['xmax']) &&\n            !isNil(this['ymax']);\n    }\n\n    /**\n     * Compare with another extent to see whether they are equal.\n     * @param  {Extent}  ext2 - extent to compare\n     * @return {Boolean}\n     */\n    equals(ext2) {\n        return (this['xmin'] === ext2['xmin'] &&\n            this['xmax'] === ext2['xmax'] &&\n            this['ymin'] === ext2['ymin'] &&\n            this['ymax'] === ext2['ymax']);\n    }\n\n    /**\n     * Whether it intersects with another extent\n     * @param  {Extent}  ext2 - another extent\n     * @return {Boolean}\n     */\n    intersects(ext2) {\n        this._project(this);\n        this._project(ext2);\n        const rxmin = Math.max(this['pxmin'], ext2['pxmin']);\n        const rymin = Math.max(this['pymin'], ext2['pymin']);\n        const rxmax = Math.min(this['pxmax'], ext2['pxmax']);\n        const rymax = Math.min(this['pymax'], ext2['pymax']);\n        const intersects = !((rxmin > rxmax) || (rymin > rymax));\n        return intersects;\n    }\n\n    /**\n     * Whether the extent is within another extent\n     * @param  {Extent}  ext2 - another extent\n     * @returns {Boolean}\n     */\n    within(extent) {\n        this._project(this);\n        this._project(extent);\n        return this.pxmin >= extent.pxmin && this.pxmax <= extent.pxmax && this.pymin >= extent.pymin && this.pymax <= extent.pymax;\n    }\n\n    /**\n     * Whether the extent contains the input point.\n     * @param  {Coordinate|Number[]} coordinate - input point\n     * @returns {Boolean}\n     */\n    contains(c) {\n        if (!c) {\n            return false;\n        }\n        this._project(this);\n        const proj = this.projection;\n        if (proj) {\n            if (c.x !== undefined) {\n                const coord = TEMP_COORD0;\n                if (Array.isArray(c)) {\n                    coord.x = c[0];\n                    coord.y = c[1];\n                } else {\n                    coord.x = c.x;\n                    coord.y = c.y;\n                }\n                c = proj.project(coord, coord);\n            } else if (c.xmin !== undefined) {\n                this._project(c);\n            }\n        }\n        return ((c.x || c.pxmin || 0) >= this.pxmin) &&\n            ((c.x || c.pxmax || 0) <= this.pxmax) &&\n            ((c.y || c.pymin || 0) >= this.pymin) &&\n            ((c.y || c.pymax || 0) <= this.pymax);\n    }\n\n    /**\n     * Get the width of the Extent\n     * @return {Number}\n     */\n    getWidth() {\n        return Math.abs(this['xmax'] - this['xmin']);\n    }\n\n    /**\n     * Get the height of the Extent\n     * @return {Number}\n     */\n    getHeight() {\n        return Math.abs(this['ymax'] - this['ymin']);\n    }\n\n    /**\n     * Get size of the Extent\n     * @return {Size}\n     */\n    getSize() {\n        return new Size(this.getWidth(), this.getHeight());\n    }\n\n    set(xmin, ymin, xmax, ymax) {\n        this.xmin = xmin;\n        this.ymin = ymin;\n        this.xmax = xmax;\n        this.ymax = ymax;\n        return this;\n    }\n\n    __combine(extent) {\n        if (extent.x !== undefined) {\n            TEMP_EXTENT.xmin = TEMP_EXTENT.xmax = extent.x;\n            TEMP_EXTENT.ymin = TEMP_EXTENT.ymax = extent.y;\n            extent = TEMP_EXTENT;\n        }\n        this._project(extent);\n        this._project(this);\n        const inited = isNumber(this.pxmin);\n        let xmin, ymin, xmax, ymax;\n        if (!inited) {\n            xmin = extent['pxmin'];\n            ymin = extent['pymin'];\n            xmax = extent['pxmax'];\n            ymax = extent['pymax'];\n        } else {\n            xmin = Math.min(this['pxmin'], extent['pxmin']);\n            ymin = Math.min(this['pymin'], extent['pymin']);\n            xmax = Math.max(this['pxmax'], extent['pxmax']);\n            ymax = Math.max(this['pymax'], extent['pymax']);\n        }\n        const proj = this.projection;\n        if (proj) {\n            TEMP_COORD0.x = xmin;\n            TEMP_COORD0.y = ymin;\n            TEMP_COORD1.x = xmax;\n            TEMP_COORD1.y = ymax;\n            const min = proj.unproject(TEMP_COORD0, TEMP_COORD0),\n                max = proj.unproject(TEMP_COORD1, TEMP_COORD1);\n            xmin = min.x;\n            ymin = min.y;\n            xmax = max.x;\n            ymax = max.y;\n        }\n        TEMP_COMBINE[0] = xmin;\n        TEMP_COMBINE[1] = ymin;\n        TEMP_COMBINE[2] = xmax;\n        TEMP_COMBINE[3] = ymax;\n        return TEMP_COMBINE;\n    }\n\n    _combine(extent) {\n        if (!extent || extent.isValid && !extent.isValid()) {\n            return this;\n        }\n        const ext = this.__combine(extent);\n        this.set(ext[0], ext[1], ext[2], ext[3]);\n        this._dirty = true;\n        return this;\n    }\n\n    /**\n     * Combine it with another extent to a larger extent.\n     * @param  {Extent|Coordinate|Point} extent - extent/coordinate/point to combine into\n     * @returns {Extent} extent combined\n     */\n    combine(extent) {\n        if (!extent || extent.isValid && !extent.isValid()) {\n            return this;\n        }\n        const ext = this.__combine(extent);\n        return new this.constructor(ext[0], ext[1], ext[2], ext[3], this.projection);\n    }\n\n    /**\n     * Gets the intersection extent of this and another extent.\n     * @param  {Extent} extent - another extent\n     * @return {Extent} intersection extent\n     */\n    intersection(extent) {\n        if (!this.intersects(extent)) {\n            return null;\n        }\n        TEMP_COORD0.x = Math.max(this['pxmin'], extent['pxmin']);\n        TEMP_COORD0.y = Math.max(this['pymin'], extent['pymin']);\n        TEMP_COORD1.x = Math.min(this['pxmax'], extent['pxmax']);\n        TEMP_COORD1.y = Math.min(this['pymax'], extent['pymax']);\n        let min = TEMP_COORD0,\n            max = TEMP_COORD1;\n        const proj = this.projection;\n        if (proj) {\n            min = proj.unproject(min, min);\n            max = proj.unproject(max, max);\n        }\n        return new this.constructor(min, max, proj);\n    }\n\n    /**\n     * Expand the extent by distance\n     * @param  {Size|Number} distance  - distance to expand\n     * @returns {Extent} a new extent expanded from\n     */\n    expand(distance) {\n        let w, h;\n        if (!isNumber(distance)) {\n            w = distance['width'] || distance['x'] || distance[0] || 0;\n            h = distance['height'] || distance['y'] || distance[1] || 0;\n        } else {\n            w = h = distance;\n        }\n        return new this.constructor(this['xmin'] - w, this['ymin'] - h, this['xmax'] + w, this['ymax'] + h, this.projection);\n    }\n\n    _expand(distance) {\n        let w, h;\n        if (!isNumber(distance)) {\n            w = distance['width'] || distance['x'] || distance[0] || 0;\n            h = distance['height'] || distance['y'] || distance[1] || 0;\n        } else {\n            w = h = distance;\n        }\n        this['xmin'] -= w;\n        this['ymin'] -= h;\n        this['xmax'] += w;\n        this['ymax'] += h;\n        this._dirty = true;\n        return this;\n    }\n\n    /**\n     * Get extent's JSON object.\n     * @return {Object} jsonObject\n     * @example\n     * // {xmin : 100, ymin: 10, xmax: 120, ymax:20}\n     * var json = extent.toJSON();\n     */\n    toJSON() {\n        return {\n            'xmin': this['xmin'],\n            'ymin': this['ymin'],\n            'xmax': this['xmax'],\n            'ymax': this['ymax']\n        };\n    }\n\n    /**\n     * Get a coordinate array of extent's rectangle area, containing 5 coordinates in which the first equals with the last.\n     * @return {Coordinate[]} coordinates array\n     */\n    toArray() {\n        const xmin = this['xmin'],\n            ymin = this['ymin'],\n            xmax = this['xmax'],\n            ymax = this['ymax'];\n        return [\n            new this._clazz([xmin, ymax]), new this._clazz([xmax, ymax]),\n            new this._clazz([xmax, ymin]), new this._clazz([xmin, ymin]),\n            new this._clazz([xmin, ymax])\n        ];\n    }\n\n    toString() {\n        return `${this.xmin},${this.ymin},${this.xmax},${this.ymax}`;\n    }\n\n    /**\n     * Get a copy of the extent.\n     * @return {Extent} copy\n     */\n    copy() {\n        return new this.constructor(this['xmin'], this['ymin'], this['xmax'], this['ymax'], this.projection);\n    }\n\n    /**\n     * Convert to a new extent\n     * @param  {Function} fn convert function on each point\n     * @return {Extent}\n     */\n    convertTo(fn, out) {\n        if (!this.isValid()) {\n            return null;\n        }\n        const e = out || new this.constructor();\n        if (out) {\n            e.xmin = e.ymin = e.xmax = e.ymax = 0;\n        }\n        let coord;\n        if (this._clazz === Coordinate) {\n            coord = TEMP_COORD0;\n        } else if (this._clazz === Point) {\n            coord = TEMP_POINT0;\n        }\n        coord.x = this.xmin;\n        coord.y = this.ymax;\n        e._combine(fn(coord));\n        coord.x = this.xmax;\n        e._combine(fn(coord));\n        coord.y = this.ymin;\n        e._combine(fn(coord));\n        coord.x = this.xmin;\n        e._combine(fn(coord));\n        return e;\n    }\n\n    _project(ext) {\n        if (!ext || !ext.isValid()) {\n            return;\n        }\n        const proj = this.projection;\n        if (proj) {\n            //FIXME a rare but potential bug:\n            //An extent may be projected by multiple projection\n            if (ext._dirty) {\n                TEMP_COORD0.x = ext.xmax;\n                TEMP_COORD0.y = ext.ymin;\n                TEMP_COORD1.x = ext.xmin;\n                TEMP_COORD1.y = ext.ymax;\n                MINMAX[0] = TEMP_COORD0;\n                MINMAX[1] = TEMP_COORD1;\n                const minmax = proj.projectCoords(MINMAX);\n                const min = minmax[0],\n                    max = minmax[1];\n                ext.pxmin = Math.min(min.x, max.x);\n                ext.pymin = Math.min(min.y, max.y);\n                ext.pxmax = Math.max(min.x, max.x);\n                ext.pymax = Math.max(min.y, max.y);\n            }\n            delete ext._dirty;\n        } else {\n            ext.pxmin = ext.xmin;\n            ext.pxmax = ext.xmax;\n            ext.pymin = ext.ymin;\n            ext.pymax = ext.ymax;\n        }\n    }\n}\n\nTEMP_EXTENT = new Extent(0, 0, 0, 0);\n\nexport default Extent;\n","import Extent from './Extent';\nimport Point from './Point';\n\n/**\n * Represent a bounding box on 2d surface , a rectangular area with minimum and maximum points. <br>\n * There are serveral ways to create a PointExtent:\n * @category basic types\n * @extends Extent\n * @example\n * //with 4 numbers\n * var extent = new PointExtent(100, 10, 120, 20);\n * @example\n * //with 2 points\n * var extent = new PointExtent(new Point(100, 10), new Point(120, 20));\n * @example\n * //with a json object containing xmin, ymin, xmax and ymax\n * var extent = new PointExtent({xmin : 100, ymin: 10, xmax: 120, ymax:20});\n * @example\n * var extent1 = new PointExtent(100, 10, 120, 20);\n * //with another extent\n * var extent2 = new PointExtent(extent1);\n */\nclass PointExtent extends Extent {\n\n    /**\n     * @param {Number} x1   - x of point 1\n     * @param {Number} y1   - y of point 1\n     * @param {Number} x2   - x of point 2\n     * @param {Number} y2   - y of point 2\n     */\n    constructor(p1, p2, p3, p4) {\n        super(p1, p2, p3, p4);\n        this._clazz = Point;\n    }\n}\n\nexport default PointExtent;\n","import Coordinate from '../Coordinate';\nimport Point from '../Point';\n\n/**\n * Transformation between projected coordinates and base 2d point system.\n * A core class used internally for mapping map's (usually geographical) coordinates to 2d points.<br>\n *\n * @category geo\n * @protected\n */\nclass Transformation {\n    /**\n     * The base 2d point system is a fixed system that is consistent with HTML coordinate system: on X-Axis, left is smaller and right is larger; on Y-Axis, top is smaller and bottom is larger. <br>\n     * As map's coordinates may not be in the same order(e.g. on a mercator projected earth, top is larger and bottom is smaller), <br>\n     * transformation provides mapping functions to map arbitrary coordinates system to the fixed 2d point system. <br>\n     * How to transform is decided by the constructor parameters which is a 4 number array [a, b, c, d]:<br>\n     * a : the order scale of X-axis values 1 means right is larger and -1 means the reverse, left is larger;<br>\n     * b : the order scale of Y-axis values 1 means bottom is larger and -1 means the reverse, top is larger;<br>\n     * c : x of the origin point of the projected coordinate system <br>\n     * d : y of the origin point of the projected coordinate system <br>\n     * e.g.: Transformation parameters for Google map: [1, -1, -20037508.34, 20037508.34] <br>\n     * @param  {Number[]} matrix transformation array\n     */\n    constructor(matrix) {\n        this.matrix = matrix;\n    }\n\n    /**\n     * Transform a projected coordinate to a 2d point. <br>\n     * Parameter scale in transform/untransform method is used to scale the result 2d points on map's different zoom levels.\n     * @param  {Number[]|Coordinate} coordinates - projected coordinate to transform\n     * @param  {Number} scale                              - transform scale\n     * @return {Point} 2d point.\n     */\n    transform(coordinates, scale, out) {\n        const x = this.matrix[0] * (coordinates.x - this.matrix[2]) / scale;\n        const y = this.matrix[1] * (coordinates.y - this.matrix[3]) / scale;\n        if (out) {\n            out.x = x;\n            out.y = y;\n            return out;\n        }\n        return new Point(x, y);\n    }\n\n    /**\n     * Transform a 2d point to a projected coordinate.\n     * @param  {Point} point   - 2d point\n     * @param  {Number} scale           - transform scale\n     * @return {Coordinate}  projected coordinate.\n     */\n    untransform(point, scale, out) {\n        const x = point.x * scale / this.matrix[0] + this.matrix[2];\n        const y = point.y * scale / this.matrix[1] + this.matrix[3];\n        if (out) {\n            out.x = x;\n            out.y = y;\n            return out;\n        }\n        return new Coordinate(x, y);\n    }\n}\n\nexport default Transformation;\n","import { forEachCoord, sign, wrap } from '../../core/util';\nimport Coordinate from '../Coordinate';\nimport Extent from '../Extent';\n\n/**\n * Common Methods of Projections.\n * @mixin\n * @protected\n * @memberOf projection\n * @name Common\n */\nexport default /** @lends projection.Common */ {\n    /**\n     * Project a geographical coordinate to a projected coordinate (2d coordinate)\n     * @param  {Coordinate} p - coordinate to project\n     * @return {Coordinate}\n     * @function projection.Common.project\n     */\n    project() {},\n    /**\n     * Unproject a projected coordinate to a geographical coordinate (2d coordinate)\n     * @param  {Coordinate} p - coordinate to project\n     * @return {Coordinate}\n     * @function projection.Common.unproject\n     */\n    unproject() {},\n    /**\n     * Project a group of geographical coordinates to projected coordinates.\n     * @param  {Coordinate[]|Coordinate[][]|Coordinate[][][]} coordinates - coordinates to project\n     * @return {Coordinate[]|Coordinate[][]|Coordinate[][][]}\n     * @function projection.Common.projectCoords\n     */\n    projectCoords(coordinates) {\n        if (!coordinates) {\n            return [];\n        }\n        if (!Array.isArray(coordinates)) {\n            return this.project(coordinates);\n        }\n        if (coordinates.length === 0) {\n            return [];\n        }\n        if (!this.isSphere()) {\n            return forEachCoord(coordinates, this.project, this);\n        }\n        if (Array.isArray(coordinates[0])) {\n            return coordinates.map(coords => this.projectCoords(coords));\n        } else {\n            const circum = this.getCircum();\n            const extent = this.getSphereExtent(),\n                sx = extent.sx,\n                sy = extent.sy;\n            let wrapX, wrapY;\n            let pre = coordinates[0], current, dx, dy, p;\n            const prj = [this.project(pre)];\n            for (let i = 1, l = coordinates.length; i < l; i++) {\n                current = coordinates[i];\n                dx = current.x - pre.x;\n                dy = current.y - pre.y;\n                p = this.project(current);\n                if (Math.abs(dx) > 180) {\n                    if (wrapX === undefined) {\n                        wrapX = current.x > pre.x;\n                    }\n                    if (wrapX) {\n                        p._add(-circum.x * sign(dx) * sx, 0);\n                        current._add(-360 * sign(dx), 0);\n                    }\n                }\n                if (Math.abs(dy) > 90) {\n                    if (wrapY === undefined) {\n                        wrapY = current.y < pre.y;\n                    }\n                    if (wrapY) {\n                        p._add(0, -circum.y * sign(dy) * sy);\n                        current._add(0, -180 * sign(dy));\n                    }\n                }\n                pre = current;\n                prj.push(p);\n            }\n            return prj;\n        }\n    },\n\n    /**\n     * Unproject a group of projected coordinates to geographical coordinates.\n     * @param  {Coordinate[]|Coordinate[][]|Coordinate[][][]} projCoords - projected coordinates to unproject\n     * @return {Coordinate[]|Coordinate[][]|Coordinate[][][]}\n     * @function projection.Common.unprojectCoords\n     */\n    unprojectCoords(projCoords) {\n        if (!projCoords) {\n            return [];\n        }\n        if (!Array.isArray(projCoords)) {\n            return this.unproject(projCoords);\n        }\n        return forEachCoord(projCoords, this.unproject, this);\n    },\n\n    /**\n     * Whether the projection is spherical\n     * @return {Boolean}\n     */\n    isSphere() {\n        return !!this.sphere;\n    },\n\n    /**\n     * If the projected coord out of the sphere\n     * @param  {Coordinate}  pcoord projected coord\n     * @return {Boolean}\n     */\n    isOutSphere(pcoord) {\n        if (!this.isSphere()) {\n            return false;\n        }\n        const extent = this.getSphereExtent();\n        return !extent.contains(pcoord);\n    },\n\n    /**\n     * Wrap the projected coord in the sphere\n     * @param  {Coordinate} pcoord projected coord\n     * @return {Coordinate} wrapped projected coord\n     */\n    wrapCoord(pcoord) {\n        if (!this.isSphere()) {\n            return pcoord;\n        }\n        const extent = this.getSphereExtent();\n        const wrapped = new Coordinate(pcoord);\n        if (!extent.contains(wrapped)) {\n            // wrapped.x = wrap(pcoord.x, extent.xmin, extent.xmax);\n            // wrapped.y = wrap(pcoord.y, extent.ymin, extent.ymax);\n            // FIXME: sakitam-fdd - config wrap coordinates\n            wrapped.x = pcoord.x;\n            wrapped.y = pcoord.y;\n        }\n        return wrapped;\n    },\n\n    getCircum() {\n        if (!this.circum && this.isSphere()) {\n            const extent = this.getSphereExtent();\n            this.circum = {\n                x : extent.getWidth(),\n                y : extent.getHeight()\n            };\n        }\n        return this.circum;\n    },\n\n    getSphereExtent() {\n        if (!this.extent && this.isSphere()) {\n            const max = this.project(new Coordinate(180, 90)),\n                min = this.project(new Coordinate(-180, -90));\n            this.extent = new Extent(min, max, this);\n            this.extent.sx = max.x > min.x ? 1 : -1;\n            this.extent.sy = max.y > min.y ? 1 : -1;\n        }\n        return this.extent;\n    }\n};\n","/**\n * This provides methods used for event handling. It's a mixin and not meant to be used directly.\n * @mixin Common\n * @memberOf measurer\n * @protected\n */\nexport default {\n    /**\n     * Measure length between coordinate c1 and coordinate c2\n     * @param  {coordinate} c1 coordinate\n     * @param  {coordinate} c2 coordinate\n     * @return {Number}    length\n     * @function measurer.Common.measureLength\n     */\n    measureLength: function (c1, c2) {\n        if (!Array.isArray(c1)) {\n            return this.measureLenBetween(c1, c2);\n        }\n        let len = 0;\n        for (let i = 0, l = c1.length; i < l - 1; i++) {\n            len += this.measureLenBetween(c1[i], c1[i + 1]);\n        }\n        return len;\n    }\n};\n","import { extend } from '../../core/util';\nimport Coordinate from '../Coordinate';\nimport Point from '../Point';\nimport Common from './Common';\n/**\n * Identity measurer, a measurer for Cartesian coordinate system.\n *\n * @class\n * @category geo\n * @protected\n * @memberOf measurer\n * @name Identity\n * @mixes measurer.Common\n */\nexport default extend(/** @lends measurer.Identity */{\n    /**\n     * the code of the measurer\n     * @static\n     * @type {String}\n     */\n    'measure': 'IDENTITY',\n    /**\n     * Measure the length between 2 coordinates.\n     * @param  {Coordinate} c1\n     * @param  {Coordinate} c2\n     * @return {Number}\n     */\n    measureLenBetween: function (c1, c2) {\n        if (!c1 || !c2) {\n            return 0;\n        }\n        try {\n            return Math.sqrt(Math.pow(c1.x - c2.x, 2) + Math.pow(c1.y - c2.y, 2));\n        } catch (err) {\n            return 0;\n        }\n    },\n    /**\n     * Measure the area closed by the given coordinates.\n     * @param  {Coordinate[]} coordinates\n     * @return {number}\n     */\n    measureArea: function (coordinates) {\n        if (!Array.isArray(coordinates)) {\n            return 0;\n        }\n        let area = 0;\n        for (let i = 0, len = coordinates.length; i < len; i++) {\n            const c1 = coordinates[i];\n            let c2 = null;\n            if (i === len - 1) {\n                c2 = coordinates[0];\n            } else {\n                c2 = coordinates[i + 1];\n            }\n            area += c1.x * c2.y - c1.y * c2.x;\n        }\n        return Math.abs(area / 2);\n    },\n\n    locate : function (c, xDist, yDist) {\n        c = new Coordinate(c.x, c.y);\n        return this._locate(c, xDist, yDist);\n    },\n\n    /**\n     * Locate a coordinate from the given source coordinate with a x-axis distance and a y-axis distance.\n     * @param  {Coordinate} c     - source coordinate\n     * @param  {Number} xDist     - x-axis distance\n     * @param  {Number} yDist     - y-axis distance\n     * @return {Coordinate}\n     */\n    _locate: function (c, xDist, yDist) {\n        if (!c) {\n            return null;\n        }\n        if (!xDist) {\n            xDist = 0;\n        }\n        if (!yDist) {\n            yDist = 0;\n        }\n        if (!xDist && !yDist) {\n            return c;\n        }\n        c.x = c.x + xDist;\n        c.y = c.y + yDist;\n        return c;\n    },\n\n    rotate : function (c, pivot, angle) {\n        c = new Coordinate(c.x, c.y);\n        return this._rotate(c, pivot, angle);\n    },\n\n    /**\n     * Rotate a coordinate of given angle around pivot\n     * @param {Coordinate} c  - source coordinate\n     * @param {Coordinate} pivot - pivot\n     * @param {Number} angle - angle in degree\n     * @return {Coordinate}\n     */\n    _rotate : function () {\n        const tmp = new Point(0, 0);\n        return function (c, pivot, angle) {\n            tmp.x = c.x - pivot.x;\n            tmp.y = c.y - pivot.y;\n            tmp._rotate(angle * Math.PI / 180);\n            c.x = pivot.x + tmp.x;\n            c.y = pivot.y + tmp.y;\n            return c;\n        };\n    }()\n}, Common);\n","import { toRadian, toDegree, extend, wrap } from '../../core/util';\nimport Coordinate from '../Coordinate';\nimport Common from './Common';\n\n/**\n * A helper class with common measure methods for Sphere.\n * @memberOf measurer\n * @private\n */\nclass Sphere {\n    /**\n     * @param  {Number} radius Sphere's radius\n     */\n    constructor(radius) {\n        this.radius = radius;\n    }\n\n    measureLenBetween(c1, c2) {\n        if (!c1 || !c2) {\n            return 0;\n        }\n        let b = toRadian(c1.y);\n        const d = toRadian(c2.y),\n            e = b - d,\n            f = toRadian(c1.x) - toRadian(c2.x);\n        b = 2 * Math.asin(Math.sqrt(Math.pow(Math.sin(e / 2), 2) + Math.cos(b) * Math.cos(d) * Math.pow(Math.sin(f / 2), 2)));\n        b *= this.radius;\n        return Math.round(b * 1E5) / 1E5;\n    }\n\n    measureArea(coordinates) {\n        const a = toRadian(this.radius);\n        let b = 0,\n            c = coordinates,\n            d = c.length;\n        if (d < 3) {\n            return 0;\n        }\n        let i;\n        for (i = 0; i < d - 1; i++) {\n            const e = c[i],\n                f = c[i + 1];\n            b += e.x * a * Math.cos(toRadian(e.y)) * f.y * a - f.x * a * Math.cos(toRadian(f.y)) * e.y * a;\n        }\n        d = c[i];\n        c = c[0];\n        b += d.x * a * Math.cos(toRadian(d.y)) * c.y * a - c.x * a * Math.cos(toRadian(c.y)) * d.y * a;\n        return 0.5 * Math.abs(b);\n    }\n\n    locate(c, xDist, yDist) {\n        c = new Coordinate(c.x, c.y);\n        return this._locate(c, xDist, yDist);\n    }\n\n    _locate(c, xDist, yDist) {\n        if (!c) {\n            return null;\n        }\n        if (!xDist) {\n            xDist = 0;\n        }\n        if (!yDist) {\n            yDist = 0;\n        }\n        if (!xDist && !yDist) {\n            return c;\n        }\n        let x, y;\n        let ry = toRadian(c.y);\n        if (yDist !== 0) {\n            const dy = Math.abs(yDist);\n            const sy = Math.sin(dy / (2 * this.radius)) * 2;\n            ry = ry + sy * (yDist > 0 ? 1 : -1);\n            y = wrap(ry * 180 / Math.PI, -90, 90);\n        } else {\n            y = c.y;\n        }\n        if (xDist !== 0) {\n            // distance per degree\n            const dx = Math.abs(xDist);\n            let rx = toRadian(c.x);\n            const sx = 2 * Math.sqrt(Math.pow(Math.sin(dx / (2 * this.radius)), 2) / Math.pow(Math.cos(ry), 2));\n            rx = rx + sx * (xDist > 0 ? 1 : -1);\n            x = wrap(rx * 180 / Math.PI, -180, 180);\n        } else {\n            x = c.x;\n        }\n        c.x = x;\n        c.y = y;\n        return c;\n    }\n\n    rotate(c, pivot, angle) {\n        c = new Coordinate(c);\n        return this._rotate(c, pivot, angle);\n    }\n\n    /**\n     * Rotate a coordinate of given angle around pivot\n     * @param {Coordinate} c  - source coordinate\n     * @param {Coordinate} pivot - pivot\n     * @param {Number} angle - angle in degree\n     * @return {Coordinate}\n     */\n    _rotate(c, pivot, angle) {\n        const initialAngle = rhumbBearing(pivot, c);\n        const finalAngle = initialAngle - angle;\n        const distance = this.measureLenBetween(pivot, c);\n        c.x = pivot.x;\n        c.y = pivot.y;\n        return calculateRhumbDestination(c, distance, finalAngle, this.radius);\n    }\n}\n\n// from turf.js\nfunction rhumbBearing(start, end, options = {}) {\n    let bear360;\n    if (options.final) bear360 = calculateRhumbBearing(end, start);\n    else bear360 = calculateRhumbBearing(start, end);\n\n    const bear180 = (bear360 > 180) ? -(360 - bear360) : bear360;\n\n    return bear180;\n}\n\nfunction calculateRhumbBearing(from, to) {\n    // φ => phi\n    // Δλ => deltaLambda\n    // Δψ => deltaPsi\n    // θ => theta\n    const phi1 = toRadian(from.y);\n    const phi2 = toRadian(to.y);\n    let deltaLambda = toRadian((to.x - from.x));\n    // if deltaLambdaon over 180° take shorter rhumb line across the anti-meridian:\n    if (deltaLambda > Math.PI) deltaLambda -= 2 * Math.PI;\n    if (deltaLambda < -Math.PI) deltaLambda += 2 * Math.PI;\n\n    const deltaPsi = Math.log(Math.tan(phi2 / 2 + Math.PI / 4) / Math.tan(phi1 / 2 + Math.PI / 4));\n\n    const theta = Math.atan2(deltaLambda, deltaPsi);\n\n    return (toDegree(theta) + 360) % 360;\n}\n\nfunction calculateRhumbDestination(origin, distance, bearing, radius) {\n    // φ => phi\n    // λ => lambda\n    // ψ => psi\n    // Δ => Delta\n    // δ => delta\n    // θ => theta\n\n    const delta = distance / radius; // angular distance in radians\n    const lambda1 = origin.x * Math.PI / 180; // to radians, but without normalize to 𝜋\n    const phi1 = toRadian(origin.y);\n    const theta = toRadian(bearing);\n\n    const DeltaPhi = delta * Math.cos(theta);\n    let phi2 = phi1 + DeltaPhi;\n\n    // check for some daft bugger going past the pole, normalise latitude if so\n    if (Math.abs(phi2) > Math.PI / 2) phi2 = phi2 > 0 ? Math.PI - phi2 : -Math.PI - phi2;\n\n    const DeltaPsi = Math.log(Math.tan(phi2 / 2 + Math.PI / 4) / Math.tan(phi1 / 2 + Math.PI / 4));\n    const q = Math.abs(DeltaPsi) > 10e-12 ? DeltaPhi / DeltaPsi : Math.cos(phi1); // E-W course becomes ill-conditioned with 0/0\n    const DeltaLambda = delta * Math.sin(theta) / q;\n    const lambda2 = lambda1 + DeltaLambda;\n\n    origin.x = ((lambda2 * 180 / Math.PI) + 540) % 360 - 180;\n    origin.y = phi2 * 180 / Math.PI;\n    return origin; // normalise to −180..+180°\n}\n\n/**\n * WGS84 Sphere measurer.\n * @class\n * @category geo\n * @protected\n * @memberOf measurer\n * @name WGS84Sphere\n * @mixes measurer.Common\n */\nexport const WGS84Sphere = extend(/** @lends measurer.WGS84Sphere */{\n    'measure': 'EPSG:4326',\n    sphere: new Sphere(6378137),\n    /**\n     * Measure the length between 2 coordinates.\n     * @param  {Coordinate} c1\n     * @param  {Coordinate} c2\n     * @return {Number}\n     */\n    measureLenBetween() {\n        return this.sphere.measureLenBetween.apply(this.sphere, arguments);\n    },\n    /**\n     * Measure the area closed by the given coordinates.\n     * @param  {Coordinate[]} coordinates\n     * @return {number}\n     */\n    measureArea() {\n        return this.sphere.measureArea.apply(this.sphere, arguments);\n    },\n\n    _locate() {\n        return this.sphere._locate.apply(this.sphere, arguments);\n    },\n\n    /**\n     * Locate a coordinate from the given source coordinate with a x-axis distance and a y-axis distance.\n     * @param  {Coordinate} c     - source coordinate\n     * @param  {Number} xDist              - x-axis distance\n     * @param  {Number} yDist              - y-axis distance\n     * @return {Coordinate}\n     */\n    locate() {\n        return this.sphere.locate.apply(this.sphere, arguments);\n    },\n\n    _rotate() {\n        return this.sphere._rotate.apply(this.sphere, arguments);\n    },\n\n    /**\n     * Rotate a coordinate of given angle around pivot\n     * @param {Coordinate} c  - source coordinate\n     * @param {Coordinate} pivot - pivot\n     * @param {Number} angle - angle in degree\n     * @return {Coordinate}\n     */\n    rotate() {\n        return this.sphere.rotate.apply(this.sphere, arguments);\n    }\n}, Common);\n\n/**\n * Baidu sphere measurer\n * @class\n * @category geo\n * @protected\n * @memberOf measurer\n * @name BaiduSphere\n * @mixes measurer.Common\n */\nexport const BaiduSphere = extend(/** @lends measurer.BaiduSphere */{\n    'measure': 'BAIDU',\n    sphere: new Sphere(6370996.81),\n    /**\n     * Measure the length between 2 coordinates.\n     * @param  {Coordinate} c1\n     * @param  {Coordinate} c2\n     * @return {Number}\n     */\n    measureLenBetween() {\n        return this.sphere.measureLenBetween.apply(this.sphere, arguments);\n    },\n    /**\n     * Measure the area closed by the given coordinates.\n     * @param  {Coordinate[]} coordinates\n     * @return {number}\n     */\n    measureArea() {\n        return this.sphere.measureArea.apply(this.sphere, arguments);\n    },\n\n    _locate() {\n        return this.sphere._locate.apply(this.sphere, arguments);\n    },\n\n    /**\n     * Locate a coordinate from the given source coordinate with a x-axis distance and a y-axis distance.\n     * @param  {Coordinate} c     - source coordinate\n     * @param  {Number} xDist              - x-axis distance\n     * @param  {Number} yDist              - y-axis distance\n     * @return {Coordinate}\n     */\n    locate() {\n        return this.sphere.locate.apply(this.sphere, arguments);\n    },\n\n    _rotate() {\n        return this.sphere._rotate.apply(this.sphere, arguments);\n    },\n\n    /**\n     * Rotate a coordinate of given angle around pivot\n     * @param {Coordinate} c  - source coordinate\n     * @param {Coordinate} pivot - pivot\n     * @param {Number} angle - angle in degree\n     * @return {Coordinate}\n     */\n    rotate() {\n        return this.sphere.rotate.apply(this.sphere, arguments);\n    }\n}, Common);\n","/** @namespace measurer */\n\nimport { hasOwn } from '../../core/util';\nimport Identity from './Identity';\nimport { WGS84Sphere, BaiduSphere } from './Sphere';\n\nexport { Identity };\nexport * from './Sphere';\n\n/**\n * Default measurer, [WGS84Sphere]{@link measurer.WGS84Sphere}\n *\n * @class\n * @category geo\n * @protected\n * @memberOf measurer\n * @name DEFAULT\n * @extends measurer.WGS84Sphere\n */\nexport const DEFAULT = WGS84Sphere;\n\n\nconst measurers = {};\n\nfunction registerMeasurer(m) {\n    measurers[m.measure] = m;\n}\n\nregisterMeasurer(Identity);\nregisterMeasurer(WGS84Sphere);\nregisterMeasurer(BaiduSphere);\n\n/**\n * @classdesc\n * Utilities with measurers. It is static and should not be initiated.<br>\n * Measurer provides methods for geographical computations such as length and area measuring, etc.\n * @class\n * @name Measurer\n * @memberOf measurer\n * @category geo\n */\nexport const Measurer = {\n    /**\n     * Get a measurer instance.\n     * @param  {String} name - code of the measurer: 'EPSG:4326', 'Identity', 'BAIDU'\n     * @return {Object} a measurer object\n     * @function measurer.Measurer.getInstance\n     */\n    getInstance(name) {\n        if (!name) {\n            return DEFAULT;\n        }\n        for (const p in measurers) {\n            if (hasOwn(measurers, p)) {\n                const mName = measurers[p]['measure'];\n                if (!mName) {\n                    continue;\n                }\n                if (name.toLowerCase() === mName.toLowerCase()) {\n                    return measurers[p];\n                }\n            }\n        }\n        return null;\n    }\n};\n\n","import { extend, wrap, sign } from '../../core/util';\nimport Common from './Projection';\nimport Coordinate from '../Coordinate';\nimport { WGS84Sphere } from '../measurer';\n\nconst delta = 1E-7;\n\n/**\n * Well-known projection used by Google maps or Open Street Maps, aka Mercator Projection.<br>\n * It is map's default projection.\n * @class\n * @category geo\n * @protected\n * @memberOf projection\n * @name EPSG3857\n * @mixes projection.Common\n * @mixes measurer.WGS84Sphere\n */\nexport default extend({}, Common, /** @lends projection.EPSG3857 */ {\n    /**\n     * \"EPSG:3857\", Code of the projection\n     * @type {String}\n     * @constant\n     */\n    code: 'EPSG:3857',\n    rad: Math.PI / 180,\n    metersPerDegree: 6378137 * Math.PI / 180,\n    maxLatitude: 85.0511287798,\n\n    project: function (lnglat, out) {\n        const rad = this.rad,\n            metersPerDegree = this.metersPerDegree,\n            max = this.maxLatitude;\n        const lng = lnglat.x,\n            lat = Math.max(Math.min(max, lnglat.y), -max);\n        let c;\n        if (lat === 0) {\n            c = 0;\n        } else {\n            c = Math.log(Math.tan((90 + lat) * rad / 2)) / rad;\n        }\n        const x = lng * metersPerDegree;\n        const y = c * metersPerDegree;\n        if (out) {\n            out.x = x;\n            out.y = y;\n            return out;\n        }\n        return new Coordinate(x, y);\n    },\n\n    unproject: function (pLnglat, out) {\n        const rad = this.rad;\n        const metersPerDegree = this.metersPerDegree;\n        let x = pLnglat.x / metersPerDegree;\n        const y = pLnglat.y;\n        let c;\n        if (y === 0) {\n            c = 0;\n        } else {\n            c = y / metersPerDegree;\n            c = (2 * Math.atan(Math.exp(c * rad)) - Math.PI / 2) / rad;\n        }\n        if (Math.abs(Math.abs(x) - 180) < delta) {\n            x = sign(x) * 180;\n        }\n        if (Math.abs(Math.abs(c) - this.maxLatitude) < delta) {\n            c = sign(c) * this.maxLatitude;\n        }\n        // const rx = wrap(x, -180, 180);\n        // const ry = wrap(c, -this.maxLatitude, this.maxLatitude);\n        // FIXME: sakitam-fdd - config wrap coordinates\n        // return new Coordinate(x / metersPerDegree, c);\n\n        // const rx = wrap(x / metersPerDegree, -180, 180);\n        const rx = x;\n        const ry = c;\n        if (out) {\n            out.x = rx;\n            out.y = ry;\n            return out;\n        }\n        return new Coordinate(rx, ry);\n    }\n}, WGS84Sphere);\n","import { extend } from '../../core/util';\nimport Common from './Projection';\nimport Coordinate from '../Coordinate';\nimport { WGS84Sphere } from '../measurer';\n\n/**\n * A common CRS among GIS enthusiasts. Uses simple Equirectangular projection.\n *\n * @class\n * @category geo\n * @protected\n * @memberOf projection\n * @name EPSG4326\n * @mixes projection.Common\n * @mixes measurer.WGS84Sphere\n */\nexport default extend({}, Common, /** @lends projection.EPSG4326 */ {\n    /**\n     * \"EPSG:4326\", Code of the projection\n     * @type {String}\n     * @constant\n     */\n    code: 'EPSG:4326',\n    project: function (p, out) {\n        if (out) {\n            out.x = p.x;\n            out.y = p.y;\n            return out;\n        }\n        return new Coordinate(p);\n    },\n    unproject: function (p, out) {\n        if (out) {\n            out.x = p.x;\n            out.y = p.y;\n            return out;\n        }\n        return new Coordinate(p);\n    }\n}, WGS84Sphere);\n","import { extend } from '../../core/util';\nimport PROJ4326 from './Projection.EPSG4326';\n\n/**\n * For CGCS2000\n *\n * @class\n * @category geo\n * @protected\n * @memberOf projection\n * @name EPSG4490\n * @mixes projection.EPSG4326\n * @mixes measurer.WGS84Sphere\n */\nexport default extend({}, PROJ4326, /** @lends projection.EPSG4490 */ {\n    /**\n     * \"EPSG:4490\", Code of the projection\n     * @type {String}\n     * @constant\n     */\n    code: 'EPSG:4490'\n});\n","import { extend } from '../../core/util';\nimport Common from './Projection';\nimport Coordinate from '../Coordinate';\nimport { BaiduSphere } from '../measurer';\n\n/**\n * Projection used by [Baidu Map]{@link http://map.baidu.com}\n * @class\n * @category geo\n * @protected\n * @memberOf projection\n * @name BAIDU\n * @mixes projection.Common\n * @mixes measurer.BaiduSphere\n */\nexport default extend({}, Common, /** @lends projection.BAIDU */ {\n    /**\n     * \"BAIDU\", Code of the projection\n     * @type {String}\n     * @constant\n     */\n    code: 'BAIDU',\n\n    project: function (p, out) {\n        return this.convertLL2MC(p, out);\n    },\n\n    unproject: function (p, out) {\n        return this.convertMC2LL(p, out);\n    }\n}, BaiduSphere, {\n    EARTHRADIUS: 6370996.81,\n    MCBAND: [12890594.86, 8362377.87, 5591021, 3481989.83, 1678043.12, 0],\n    LLBAND: [75, 60, 45, 30, 15, 0],\n    MC2LL: [\n        [1.410526172116255e-8, 0.00000898305509648872, -1.9939833816331, 200.9824383106796, -187.2403703815547, 91.6087516669843, -23.38765649603339, 2.57121317296198, -0.03801003308653, 17337981.2],\n        [-7.435856389565537e-9, 0.000008983055097726239, -0.78625201886289, 96.32687599759846, -1.85204757529826, -59.36935905485877, 47.40033549296737, -16.50741931063887, 2.28786674699375, 10260144.86],\n        [-3.030883460898826e-8, 0.00000898305509983578, 0.30071316287616, 59.74293618442277, 7.357984074871, -25.38371002664745, 13.45380521110908, -3.29883767235584, 0.32710905363475, 6856817.37],\n        [-1.981981304930552e-8, 0.000008983055099779535, 0.03278182852591, 40.31678527705744, 0.65659298677277, -4.44255534477492, 0.85341911805263, 0.12923347998204, -0.04625736007561, 4482777.06],\n        [3.09191371068437e-9, 0.000008983055096812155, 0.00006995724062, 23.10934304144901, -0.00023663490511, -0.6321817810242, -0.00663494467273, 0.03430082397953, -0.00466043876332, 2555164.4],\n        [2.890871144776878e-9, 0.000008983055095805407, -3.068298e-8, 7.47137025468032, -0.00000353937994, -0.02145144861037, -0.00001234426596, 0.00010322952773, -0.00000323890364, 826088.5]\n    ],\n    LL2MC: [\n        [-0.0015702102444, 111320.7020616939, 1704480524535203, -10338987376042340, 26112667856603880, -35149669176653700, 26595700718403920, -10725012454188240, 1800819912950474, 82.5],\n        [0.0008277824516172526, 111320.7020463578, 647795574.6671607, -4082003173.641316, 10774905663.51142, -15171875531.51559, 12053065338.62167, -5124939663.577472, 913311935.9512032, 67.5],\n        [0.00337398766765, 111320.7020202162, 4481351.045890365, -23393751.19931662, 79682215.47186455, -115964993.2797253, 97236711.15602145, -43661946.33752821, 8477230.501135234, 52.5],\n        [0.00220636496208, 111320.7020209128, 51751.86112841131, 3796837.749470245, 992013.7397791013, -1221952.21711287, 1340652.697009075, -620943.6990984312, 144416.9293806241, 37.5],\n        [-0.0003441963504368392, 111320.7020576856, 278.2353980772752, 2485758.690035394, 6070.750963243378, 54821.18345352118, 9540.606633304236, -2710.55326746645, 1405.483844121726, 22.5],\n        [-0.0003218135878613132, 111320.7020701615, 0.00369383431289, 823725.6402795718, 0.46104986909093, 2351.343141331292, 1.58060784298199, 8.77738589078284, 0.37238884252424, 7.45]\n    ],\n\n    convertMC2LL: function (cB, out) {\n        let cE;\n        for (let cD = 0, len = this.MCBAND.length; cD < len; cD++) {\n            if (Math.abs(cB.y) >= this.MCBAND[cD]) {\n                cE = this.MC2LL[cD];\n                break;\n            }\n        }\n        const T = this.convertor(cB, cE, out);\n        return T;\n    },\n    convertLL2MC: function (T, out) {\n        let cD, cC, len;\n        T.x = this.getLoop(T.x, -180, 180);\n        T.y = this.getRange(T.y, -74, 74);\n        const cB = new Coordinate(T.x, T.y);\n        for (cC = 0, len = this.LLBAND.length; cC < len; cC++) {\n            if (cB.y >= this.LLBAND[cC]) {\n                cD = this.LL2MC[cC];\n                break;\n            }\n        }\n        if (!cD) {\n            for (cC = this.LLBAND.length - 1; cC >= 0; cC--) {\n                if (cB.y <= -this.LLBAND[cC]) {\n                    cD = this.LL2MC[cC];\n                    break;\n                }\n            }\n        }\n        const cE = this.convertor(T, cD, out);\n        return cE;\n    },\n    convertor: function (cC, cD, out) {\n        if (!cC || !cD) {\n            return null;\n        }\n        let T = cD[0] + cD[1] * Math.abs(cC.x);\n        const cB = Math.abs(cC.y) / cD[9];\n        let cE = cD[2] + cD[3] * cB + cD[4] * cB * cB +\n            cD[5] * cB * cB * cB + cD[6] * cB * cB * cB * cB +\n            cD[7] * cB * cB * cB * cB * cB +\n            cD[8] * cB * cB * cB * cB * cB * cB;\n        T *= (cC.x < 0 ? -1 : 1);\n        cE *= (cC.y < 0 ? -1 : 1);\n        if (out) {\n            out.x = T;\n            out.y = cE;\n            return out;\n        }\n        return new Coordinate(T, cE);\n    },\n    toRadians: function (T) {\n        return Math.PI * T / 180;\n    },\n    toDegrees: function (T) {\n        return (180 * T) / Math.PI;\n    },\n    getRange: function (cC, cB, T) {\n        if (cB != null) {\n            cC = Math.max(cC, cB);\n        }\n        if (T != null) {\n            cC = Math.min(cC, T);\n        }\n        return cC;\n    },\n    getLoop: function (cC, cB, T) {\n        if (cC === Infinity) {\n            return T;\n        } else if (cC === -Infinity) {\n            return cB;\n        }\n        while (cC > T) {\n            cC -= T - cB;\n        }\n        while (cC < cB) {\n            cC += T - cB;\n        }\n        return cC;\n    }\n});\n","import { extend } from '../../core/util';\nimport Common from './Projection';\nimport { Identity } from '../measurer';\n\n/**\n * A projection based on Cartesian coordinate system.<br>\n * This projection maps x, y directly, it is useful for maps of flat surfaces (e.g. indoor maps, game maps).\n * @class\n * @category geo\n * @protected\n * @memberOf projection\n * @name IDENTITY\n * @mixes projection.Common\n * @mixes measurer.Identity\n */\nexport default extend({}, Common, /** @lends projection.IDENTITY */ {\n    /**\n     * \"IDENTITY\", Code of the projection\n     * @type {String}\n     * @constant\n     */\n    code: 'IDENTITY',\n    project: function (p, out) {\n        if (out) {\n            out.x = p.x;\n            out.y = p.y;\n            return out;\n        }\n        return p.copy();\n    },\n    unproject: function (p, out) {\n        if (out) {\n            out.x = p.x;\n            out.y = p.y;\n            return out;\n        }\n        return p.copy();\n    }\n}, Identity);\n","/** @namespace projection */\n\nimport EPSG3857 from './Projection.EPSG3857';\n\nexport { default as EPSG4326 } from './Projection.EPSG4326';\nexport { default as EPSG4490 } from './Projection.EPSG4490';\nexport { default as BAIDU } from './Projection.Baidu';\nexport { default as IDENTITY } from './Projection.IDENTITY';\nexport { EPSG3857 };\nexport { default as Common } from './Projection';\n/**\n * Default projection, [EPSG3857]{@link projection.EPSG3857}\n *\n * @class\n * @category geo\n * @protected\n * @memberOf projection\n * @name DEFAULT\n * @extends projection.EPSG3857\n */\nexport const DEFAULT = EPSG3857;\n","/**\n * Common methods for classes can be rendered, e.g. Map, Layers\n * @mixin Renderable\n * @protected\n */\nexport default Base =>\n    class extends Base {\n        /**\n         * Register a renderer class with the given name.\n         * @param  {String} name  - renderer's register key\n         * @param  {Function} clazz - renderer's class, a function (not necessarily a [Class]{@link Class}).\n         * @return {*} this\n         * @function Renderable.registerRenderer\n         */\n        static registerRenderer(name, clazz) {\n            const proto = this.prototype;\n            const parentProto = Object.getPrototypeOf(proto);\n            if (!proto._rendererClasses || proto._rendererClasses === parentProto._rendererClasses) {\n                proto._rendererClasses = proto._rendererClasses ? Object.create(proto._rendererClasses) : {};\n            }\n            proto._rendererClasses[name.toLowerCase()] = clazz;\n            return this;\n        }\n\n        /**\n         * Get the registered renderer class by the given name\n         * @param  {String} name  - renderer's register key\n         * @return {Function} renderer's class\n         * @function Renderable.getRendererClass\n         */\n        static getRendererClass(name) {\n            const proto = this.prototype;\n            if (!proto._rendererClasses) {\n                return null;\n            }\n            return proto._rendererClasses[name.toLowerCase()];\n        }\n    };\n","import { now, isNil, isArrayHasData, isSVG, IS_NODE, loadImage, hasOwn } from '../../core/util';\nimport Class from '../../core/Class';\nimport Browser from '../../core/Browser';\nimport Promise from '../../core/Promise';\nimport Canvas2D from '../../core/Canvas';\nimport Point from '../../geo/Point';\n\n/**\n * @classdesc\n * Base Class to render layer on HTMLCanvasElement\n * @abstract\n * @protected\n * @memberOf renderer\n * @extends Class\n */\nclass CanvasRenderer extends Class {\n\n    /**\n     * @param  {Layer} layer the layer to render\n     */\n    constructor(layer) {\n        super();\n        this.layer = layer;\n        this._painted = false;\n        this._drawTime = 0;\n        this.setToRedraw();\n    }\n\n\n    /**\n     * Render the layer.\n     * Call checkResources\n     */\n    render(framestamp) {\n        this.prepareRender();\n        if (!this.getMap() || !this.layer.isVisible()) {\n            return;\n        }\n        if (!this.resources) {\n            /* eslint-disable no-use-before-define */\n            this.resources = new ResourceCache();\n            /* eslint-enable no-use-before-define */\n        }\n        if (this.checkResources) {\n            const resources = this.checkResources();\n            if (resources.length > 0) {\n                this._loadingResource = true;\n                this.loadResources(resources).then(() => {\n                    this._loadingResource = false;\n                    if (this.layer) {\n                        /**\n                         * resourceload event, fired when external resources of the layer complete loading.\n                         *\n                         * @event Layer#resourceload\n                         * @type {Object}\n                         * @property {String} type     - resourceload\n                         * @property {Layer} target    - layer\n                         */\n                        this.layer.fire('resourceload');\n                        this.setToRedraw();\n                    }\n                });\n            } else {\n                this._tryToDraw(framestamp);\n            }\n        } else {\n            this._tryToDraw(framestamp);\n        }\n    }\n\n    /**\n     * Check if has any external resources to load\n     * If yes, load the resources before calling draw method\n     * @abstract\n     * @method checkResources\n     * @instance\n     * @returns {Array[]} an array of resource arrays [ [url1, width, height], [url2, width, height], [url3, width, height] .. ]\n     * @memberOf renderer.CanvasRenderer\n     */\n\n    /**\n     * a required abstract method to implement\n     * draw the layer when map is not interacting\n     * @abstract\n     * @instance\n     * @method draw\n     * @memberOf renderer.CanvasRenderer\n     */\n\n    /**\n     * an optional abstract method to implement\n     * draw the layer when map is interacting (moving/zooming/dragrotating)\n     * @abstract\n     * @instance\n     * @method drawOnInteracting\n     * @param {Object} eventParam event parameters\n     * @memberOf renderer.CanvasRenderer\n     */\n\n    /**\n     * @private\n     */\n    testIfNeedRedraw() {\n        const map = this.getMap();\n        if (this._loadingResource) {\n            return false;\n        }\n        if (this._toRedraw) {\n            return true;\n        }\n        if (map.isInteracting() && !this.drawOnInteracting) {\n            return false;\n        }\n        if (this.needToRedraw()) {\n            return true;\n        }\n        return false;\n    }\n\n    /**\n     * Ask whether the layer renderer needs to redraw\n     * @return {Boolean}\n     */\n    needToRedraw() {\n        const map = this.getMap();\n        if (map.isInteracting()) {\n            // don't redraw when map is moving without any pitch\n            return !(!map.getPitch() && map.isMoving() && !map.isZooming() && !map.isRotating() && !this.layer.options['forceRenderOnMoving']);\n        }\n        return false;\n    }\n\n    /**\n     * A callback for overriding when drawOnInteracting is skipped due to low fps\n     */\n    onSkipDrawOnInteracting() {\n\n    }\n\n    isLoadingResource() {\n        return this._loadingResource;\n    }\n\n    isRenderComplete() {\n        return !!this._renderComplete;\n    }\n\n    /**\n     * Whether must call render instead of drawOnInteracting when map is interacting\n     */\n    mustRenderOnInteracting() {\n        return !this._painted || (this.checkResources && this.checkResources().length > 0);\n    }\n\n    /**\n     * Set to redraw, ask map to call draw/drawOnInteracting to redraw the layer\n     */\n    setToRedraw() {\n        this._toRedraw = true;\n        return this;\n    }\n\n    /**\n     *  Mark layer's canvas updated\n     */\n    setCanvasUpdated() {\n        this._canvasUpdated = true;\n        return this;\n    }\n\n    /**\n     * Only called by map's renderer to check whether the layer's canvas is updated\n     * @protected\n     * @return {Boolean}\n     */\n    isCanvasUpdated() {\n        return !!this._canvasUpdated;\n    }\n\n    /**\n     * Remove the renderer, will be called when layer is removed\n     */\n    remove() {\n        this.onRemove();\n        delete this._loadingResource;\n        delete this.southWest;\n        delete this.canvas;\n        delete this.context;\n        delete this.canvasExtent2D;\n        delete this._extent2D;\n        delete this.resources;\n        delete this.layer;\n    }\n\n    onRemove() {}\n\n    onAdd() {}\n\n    /**\n     * Get map\n     * @return {Map}\n     */\n    getMap() {\n        if (!this.layer) {\n            return null;\n        }\n        return this.layer.getMap();\n    }\n\n    /**\n     * Get renderer's Canvas image object\n     * @return {HTMLCanvasElement}\n     */\n    getCanvasImage() {\n        const map = this.getMap();\n        this._canvasUpdated = false;\n        if (this._renderZoom !== map.getZoom() || !this.canvas || !this._extent2D) {\n            return null;\n        }\n        if (this.isBlank()) {\n            return null;\n        }\n        if (this.layer.isEmpty && this.layer.isEmpty()) {\n            return null;\n        }\n        // size = this._extent2D.getSize(),\n        const containerPoint = map._pointToContainerPoint(this.southWest)._add(0, -map.height);\n        return {\n            'image': this.canvas,\n            'layer': this.layer,\n            'point': containerPoint/* ,\n            'size': size */\n        };\n    }\n\n    /**\n     * Clear canvas\n     */\n    clear() {\n        this.clearCanvas();\n    }\n\n    /**\n     * A method to help improve performance.\n     * If you are sure that layer's canvas is blank, returns true to save unnecessary layer works of maps.\n     * @return {Boolean}\n     */\n    isBlank() {\n        if (!this._painted) {\n            return true;\n        }\n        return false;\n    }\n\n    /**\n     * Show the layer\n     */\n    show() {\n        this.setToRedraw();\n    }\n\n    /**\n     * Hide the layer\n     */\n    hide() {\n        this.clear();\n        this.setToRedraw();\n    }\n\n    /**\n     * Set z-index of layer\n     */\n    setZIndex(/*z*/) {\n        this.setToRedraw();\n    }\n\n    /**\n     * Detect if there is anything painted on the given point\n     * @param  {Point} point containerPoint\n     * @return {Boolean}\n     */\n    hitDetect(point) {\n        if (!this.context || (this.layer.isEmpty && this.layer.isEmpty()) || this.isBlank() || this._errorThrown) {\n            return false;\n        }\n        const map = this.getMap();\n        const r = map.getDevicePixelRatio();\n        const size = map.getSize();\n        if (point.x < 0 || point.x > size['width'] * r || point.y < 0 || point.y > size['height'] * r) {\n            return false;\n        }\n        try {\n            const imgData = this.context.getImageData(r * point.x, r * point.y, 1, 1).data;\n            if (imgData[3] > 0) {\n                return true;\n            }\n        } catch (error) {\n            if (!this._errorThrown) {\n                if (console) {\n                    console.warn('hit detect failed with tainted canvas, some geometries have external resources in another domain:\\n', error);\n                }\n                this._errorThrown = true;\n            }\n            //usually a CORS error will be thrown if the canvas uses resources from other domain.\n            //this may happen when a geometry is filled with pattern file.\n            return false;\n        }\n        return false;\n\n    }\n\n    /**\n     * loadResource from resourceUrls\n     * @param  {String[]} resourceUrls    - Array of urls to load\n     * @param  {Function} onComplete          - callback after loading complete\n     * @param  {Object} context         - callback's context\n     * @returns {Promise[]}\n     */\n    loadResources(resourceUrls) {\n        if (!this.resources) {\n            /* eslint-disable no-use-before-define */\n            this.resources = new ResourceCache();\n            /* eslint-enable no-use-before-define */\n        }\n        const resources = this.resources,\n            promises = [];\n        if (isArrayHasData(resourceUrls)) {\n            const cache = {};\n            for (let i = resourceUrls.length - 1; i >= 0; i--) {\n                const url = resourceUrls[i];\n                if (!url || !url.length || cache[url.join('-')]) {\n                    continue;\n                }\n                cache[url.join('-')] = 1;\n                if (!resources.isResourceLoaded(url, true)) {\n                    //closure it to preserve url's value\n                    promises.push(new Promise(this._promiseResource(url)));\n                }\n            }\n        }\n        return Promise.all(promises);\n    }\n\n    /**\n     * Prepare rendering\n     * Set necessary properties, like this._renderZoom/ this.canvasExtent2D, this.southWest\n     * @private\n     */\n    prepareRender() {\n        delete this._renderComplete;\n        const map = this.getMap();\n        this._renderZoom = map.getZoom();\n        this.canvasExtent2D = this._extent2D = map._get2DExtent();\n        //change from northWest to southWest, because northwest's point <=> containerPoint changes when pitch >= 72\n        this.southWest = map._containerPointToPoint(new Point(0, map.height));\n    }\n\n    /**\n     * Create renderer's Canvas\n     */\n    createCanvas() {\n        if (this.canvas) {\n            return;\n        }\n        const map = this.getMap();\n        const size = map.getSize();\n        const r = map.getDevicePixelRatio(),\n            w = r * size.width,\n            h = r * size.height;\n        if (this.layer._canvas) {\n            const canvas = this.layer._canvas;\n            canvas.width = w;\n            canvas.height = h;\n            if (canvas.style) {\n                canvas.style.width = size.width + 'px';\n                canvas.style.height = size.height + 'px';\n            }\n            this.canvas = this.layer._canvas;\n        } else {\n            this.canvas = Canvas2D.createCanvas(w, h, map.CanvasClass);\n        }\n\n        this.onCanvasCreate();\n\n    }\n\n    onCanvasCreate() {\n\n    }\n\n    createContext() {\n        //Be compatible with layer renderers that overrides create canvas and create gl/context\n        if (this.gl && this.gl.canvas === this.canvas || this.context) {\n            return;\n        }\n        this.context = this.canvas.getContext('2d');\n        if (!this.context) {\n            return;\n        }\n        if (this.layer.options['globalCompositeOperation']) {\n            this.context.globalCompositeOperation = this.layer.options['globalCompositeOperation'];\n        }\n        const dpr = this.getMap().getDevicePixelRatio();\n        if (dpr !== 1) {\n            this.context.scale(dpr, dpr);\n        }\n    }\n\n    resetCanvasTransform() {\n        if (!this.context) {\n            return;\n        }\n        const dpr = this.getMap().getDevicePixelRatio();\n        this.context.setTransform(dpr, 0, 0, dpr, 0, 0);\n    }\n\n    /**\n     * Resize the canvas\n     * @param  {Size} canvasSize the size resizing to\n     */\n    resizeCanvas(canvasSize) {\n        const canvas = this.canvas;\n        if (!canvas) {\n            return;\n        }\n        const size = canvasSize || this.getMap().getSize();\n        const r = this.getMap().getDevicePixelRatio();\n        if (canvas.width === r * size.width && canvas.height === r * size.height) {\n            return;\n        }\n        //retina support\n        canvas.height = r * size.height;\n        canvas.width = r * size.width;\n        if (r !== 1 && this.context) {\n            this.context.scale(r, r);\n        }\n        if (this.layer._canvas && canvas.style) {\n            canvas.style.width = size.width + 'px';\n            canvas.style.height = size.height + 'px';\n        }\n    }\n\n    /**\n     * Clear the canvas to blank\n     */\n    clearCanvas() {\n        if (!this.context) {\n            return;\n        }\n        Canvas2D.clearRect(this.context, 0, 0, this.canvas.width, this.canvas.height);\n    }\n\n    /**\n     * Prepare the canvas for rendering. <br>\n     * 1. Clear the canvas to blank. <br>\n     * 2. Clip the canvas by mask if there is any and return the mask's extent\n     * @return {PointExtent} mask's extent of current zoom's 2d point.\n     */\n    prepareCanvas() {\n        if (!this.canvas) {\n            this.createCanvas();\n            this.createContext();\n            /**\n             * canvascreate event, fired when canvas created.\n             *\n             * @event Layer#canvascreate\n             * @type {Object}\n             * @property {String} type     - canvascreate\n             * @property {Layer} target    - layer\n             * @property {CanvasRenderingContext2D} context - canvas's context\n             * @property {WebGLRenderingContext2D} gl  - canvas's webgl context\n             */\n            this.layer.fire('canvascreate', {\n                'context' : this.context,\n                'gl' : this.gl\n            });\n        } else {\n            this.clearCanvas();\n            this.resizeCanvas();\n            this.resetCanvasTransform();\n        }\n        delete this._maskExtent;\n        const mask = this.layer.getMask();\n        // this.context may be not available\n        if (!mask) {\n            this.layer.fire('renderstart', {\n                'context': this.context,\n                'gl' : this.gl\n            });\n            return null;\n        }\n        const maskExtent2D = this._maskExtent = mask._getPainter().get2DExtent();\n        if (!maskExtent2D.intersects(this._extent2D)) {\n            this.layer.fire('renderstart', {\n                'context': this.context,\n                'gl' : this.gl\n            });\n            return maskExtent2D;\n        }\n        /**\n         * renderstart event, fired when layer starts to render.\n         *\n         * @event Layer#renderstart\n         * @type {Object}\n         * @property {String} type              - renderstart\n         * @property {Layer} target    - layer\n         * @property {CanvasRenderingContext2D} context - canvas's context\n         */\n        this.layer.fire('renderstart', {\n            'context': this.context,\n            'gl' : this.gl\n        });\n        return maskExtent2D;\n    }\n\n    clipCanvas(context) {\n        const mask = this.layer.getMask();\n        if (!mask) {\n            return false;\n        }\n        const old = this.southWest;\n        const map = this.getMap();\n        //when clipping, layer's southwest needs to be reset for mask's containerPoint conversion\n        this.southWest = map._containerPointToPoint(new Point(0, map.height));\n        context.save();\n        const dpr = map.getDevicePixelRatio();\n        if (dpr !== 1) {\n            context.save();\n            context.scale(dpr, dpr);\n        }\n        // Handle MultiPolygon\n        if (mask.getGeometries) {\n            context.isMultiClip = true;\n            const masks = mask.getGeometries() || [];\n            context.beginPath();\n            masks.forEach(_mask => {\n                const painter =  _mask._getPainter();\n                painter.paint(null, context);\n            });\n            context.stroke();\n            delete context.isMultiClip;\n        } else {\n            const painter = mask._getPainter();\n            painter.paint(null, context);\n        }\n        if (dpr !== 1) {\n            context.restore();\n        }\n        context.clip();\n        this.southWest = old;\n        return true;\n    }\n\n    /**\n     * Get renderer's current view extent in 2d point\n     * @return {Object} view.extent, view.maskExtent, view.zoom, view.southWest\n     */\n    getViewExtent() {\n        return {\n            'extent' : this._extent2D,\n            'maskExtent' : this._maskExtent,\n            'zoom' : this._renderZoom,\n            'southWest' : this.southWest\n        };\n    }\n\n    /**\n     * call when rendering completes, this will fire necessary events and call setCanvasUpdated\n     */\n    completeRender() {\n        if (this.getMap()) {\n            this._renderComplete = true;\n            /**\n             * renderend event, fired when layer ends rendering.\n             *\n             * @event Layer#renderend\n             * @type {Object}\n             * @property {String} type              - renderend\n             * @property {Layer} target    - layer\n             * @property {CanvasRenderingContext2D} context - canvas's context\n             */\n            this.layer.fire('renderend', {\n                'context': this.context,\n                'gl' : this.gl\n            });\n            this.setCanvasUpdated();\n        }\n    }\n\n    /**\n     * Get renderer's event map registered on the map\n     * @return {Object} events\n     */\n    getEvents() {\n        return {\n            '_zoomstart' : this.onZoomStart,\n            '_zooming' : this.onZooming,\n            '_zoomend' : this.onZoomEnd,\n            '_resize'  : this.onResize,\n            '_movestart' : this.onMoveStart,\n            '_moving' : this.onMoving,\n            '_moveend' : this.onMoveEnd,\n            '_dragrotatestart' : this.onDragRotateStart,\n            '_dragrotating' : this.onDragRotating,\n            '_dragrotateend' : this.onDragRotateEnd,\n            '_spatialreferencechange' : this.onSpatialReferenceChange\n        };\n    }\n\n    /**\n    /**\n     * onZoomStart\n     * @param  {Object} param event parameters\n     */\n    onZoomStart() {\n    }\n\n    /**\n    * onZoomEnd\n    * @param  {Object} param event parameters\n    */\n    onZoomEnd() {\n        this.setToRedraw();\n    }\n\n    /**\n    * onZooming\n    * @param  {Object} param event parameters\n    */\n    onZooming() {}\n\n    /**\n    * onMoveStart\n    * @param  {Object} param event parameters\n    */\n    onMoveStart() {}\n\n    /**\n    * onMoving\n    * @param  {Object} param event parameters\n    */\n    onMoving() {}\n\n    /**\n    * onMoveEnd\n    * @param  {Object} param event parameters\n    */\n    onMoveEnd() {\n        this.setToRedraw();\n    }\n\n    /**\n    * onResize\n    * @param  {Object} param event parameters\n    */\n    onResize() {\n        delete this._extent2D;\n        this.resizeCanvas();\n        this.setToRedraw();\n    }\n\n    /**\n    * onDragRotateStart\n    * @param  {Object} param event parameters\n    */\n    onDragRotateStart() {}\n\n    /**\n    * onDragRotating\n    * @param  {Object} param event parameters\n    */\n    onDragRotating() {}\n\n    /**\n    * onDragRotateEnd\n    * @param  {Object} param event parameters\n    */\n    onDragRotateEnd() {\n        this.setToRedraw();\n    }\n\n    /**\n    * onSpatialReferenceChange\n    * @param  {Object} param event parameters\n    */\n    onSpatialReferenceChange() {\n    }\n\n    /**\n     * Get ellapsed time of previous drawing\n     * @return {Number}\n     */\n    getDrawTime() {\n        return this._drawTime;\n    }\n\n    _tryToDraw(framestamp) {\n        this._toRedraw = false;\n        if (!this.canvas && this.layer.isEmpty && this.layer.isEmpty()) {\n            this._renderComplete = true;\n            // not to create canvas when layer is empty\n            return;\n        }\n        this._drawAndRecord(framestamp);\n    }\n\n    _drawAndRecord(framestamp) {\n        if (!this.getMap()) {\n            return;\n        }\n        const painted = this._painted;\n        this._painted = true;\n        let t = now();\n        this.draw(framestamp);\n        t = now() - t;\n        //reduce some time in the first draw\n        this._drawTime = painted ? t  : t / 2;\n        if (painted && this.layer && this.layer.options['logDrawTime']) {\n            console.log(this.layer.getId(), 'frameTimeStamp:', framestamp, 'drawTime:', this._drawTime);\n        }\n    }\n\n    _promiseResource(url) {\n        const me = this, resources = this.resources,\n            crossOrigin = this.layer.options['crossOrigin'];\n        return function (resolve) {\n            if (resources.isResourceLoaded(url, true)) {\n                resolve(url);\n                return;\n            }\n            const img = new Image();\n            if (!isNil(crossOrigin)) {\n                img['crossOrigin'] = crossOrigin;\n            }\n            if (isSVG(url[0]) && !IS_NODE) {\n                //amplify the svg image to reduce loading.\n                if (url[1]) { url[1] *= 2; }\n                if (url[2]) { url[2] *= 2; }\n            }\n            img.onload = function () {\n                me._cacheResource(url, img);\n                resolve(url);\n            };\n            img.onabort = function (err) {\n                if (console) { console.warn('image loading aborted: ' + url[0]); }\n                if (err) {\n                    if (console) { console.warn(err); }\n                }\n                resolve(url);\n            };\n            img.onerror = function (err) {\n                // if (console) { console.warn('image loading failed: ' + url[0]); }\n                if (err && typeof console !== 'undefined') {\n                    console.warn(err);\n                }\n                resources.markErrorResource(url);\n                resolve(url);\n            };\n            loadImage(img,  url);\n        };\n\n    }\n\n    _cacheResource(url, img) {\n        if (!this.layer || !this.resources) {\n            return;\n        }\n        let w = url[1], h = url[2];\n        if (this.layer.options['cacheSvgOnCanvas'] && isSVG(url[0]) === 1 && (Browser.edge || Browser.ie)) {\n            //opacity of svg img painted on canvas is always 1, so we paint svg on a canvas at first.\n            if (isNil(w)) {\n                w = img.width || this.layer.options['defaultIconSize'][0];\n            }\n            if (isNil(h)) {\n                h = img.height || this.layer.options['defaultIconSize'][1];\n            }\n            const canvas = Canvas2D.createCanvas(w, h);\n            Canvas2D.image(canvas.getContext('2d'), img, 0, 0, w, h);\n            img = canvas;\n        }\n        this.resources.addResource(url, img);\n    }\n}\n\nexport default CanvasRenderer;\n\nexport class ResourceCache {\n    constructor() {\n        this.resources = {};\n        this._errors = {};\n    }\n\n    addResource(url, img) {\n        this.resources[url[0]] = {\n            image: img,\n            width: +url[1],\n            height: +url[2]\n        };\n    }\n\n    isResourceLoaded(url, checkSVG) {\n        if (!url) {\n            return false;\n        }\n        const imgUrl = this._getImgUrl(url);\n        if (this._errors[imgUrl]) {\n            return true;\n        }\n        const img = this.resources[imgUrl];\n        if (!img) {\n            return false;\n        }\n        if (checkSVG && isSVG(url[0]) && (+url[1] > img.width || +url[2] > img.height)) {\n            return false;\n        }\n        return true;\n    }\n\n    getImage(url) {\n        const imgUrl = this._getImgUrl(url);\n        if (!this.isResourceLoaded(url) || this._errors[imgUrl]) {\n            return null;\n        }\n        return this.resources[imgUrl].image;\n    }\n\n    markErrorResource(url) {\n        this._errors[this._getImgUrl(url)] = 1;\n    }\n\n    merge(res) {\n        if (!res) {\n            return this;\n        }\n        for (const p in res.resources) {\n            const img = res.resources[p];\n            this.addResource([p, img.width, img.height], img.image);\n        }\n        return this;\n    }\n\n    forEach(fn) {\n        if (!this.resources) {\n            return this;\n        }\n        for (const p in this.resources) {\n            if (hasOwn(this.resources, p)) {\n                fn(p, this.resources[p]);\n            }\n        }\n        return this;\n    }\n\n    _getImgUrl(url) {\n        if (!Array.isArray(url)) {\n            return url;\n        }\n        return url[0];\n    }\n}\n","import Class from '../core/Class';\nimport { isNil, isNumber } from '../core/util';\nimport Eventable from '../core/Eventable';\nimport JSONAble from '../core/JSONAble';\nimport Renderable from '../renderer/Renderable';\nimport CanvasRenderer from '../renderer/layer/CanvasRenderer';\n\n/**\n * @property {Object}  [options=null] - base options of layer.\n * @property {String}  [options.attribution= null] - the attribution of this layer, you can specify company or other information of this layer.\n * @property {Number}  [options.minZoom=-1] - the minimum zoom to display the layer, set to -1 to unlimit it.\n * @property {Number}  [options.maxZoom=-1] - the maximum zoom to display the layer, set to -1 to unlimit it.\n * @property {Boolean} [options.visible=true] - whether to display the layer.\n * @property {Number}  [options.opacity=1] - opacity of the layer, from 0 to 1.\n * @property {Number}  [options.zIndex=undefined] - z index of the layer\n * @property {String}  [options.renderer=canvas]  - renderer type, \"canvas\" in default.\n * @property {String}   [options.globalCompositeOperation=null] - (Only for layer rendered with [CanvasRenderer]{@link renderer.CanvasRenderer}) globalCompositeOperation of layer's canvas 2d context.\n * @property {String}   [options.debugOutline='#0f0']  - debug outline's color.\n * @property {String}   [options.cssFilter=null]       - css filter apply to canvas context's filter\n * @property {Boolean}  [options.forceRenderOnMoving=false]    - force to render layer when map is moving\n * @property {Boolean}  [options.forceRenderOnZooming=false]   - force to render layer when map is zooming\n * @property {Boolean}  [options.forceRenderOnRotating=false]  - force to render layer when map is Rotating\n * @memberOf Layer\n * @instance\n */\nconst options = {\n    'attribution': null,\n    'minZoom': null,\n    'maxZoom': null,\n    'visible': true,\n    'opacity': 1,\n    // context.globalCompositeOperation, 'source-over' in default\n    'globalCompositeOperation': null,\n    'renderer': 'canvas',\n    'debugOutline' : '#0f0',\n    'cssFilter': null,\n    'forceRenderOnMoving' : false,\n    'forceRenderOnZooming' : false,\n    'forceRenderOnRotating' : false\n};\n\n/**\n * @classdesc\n * Base class for all the layers, defines common methods that all the layer classes share. <br>\n * It is abstract and not intended to be instantiated.\n *\n * @category layer\n * @abstract\n * @extends Class\n * @mixes Eventable\n * @mixes JSONAble\n * @mixes Renderable\n */\nclass Layer extends JSONAble(Eventable(Renderable(Class))) {\n\n    constructor(id, options) {\n        let canvas;\n        if (options) {\n            canvas = options.canvas;\n            delete options.canvas;\n        }\n        super(options);\n        this._canvas = canvas;\n        this.setId(id);\n        if (options) {\n            this.setZIndex(options.zIndex);\n        }\n    }\n\n    /**\n     * load the tile layer, can't be overrided by sub-classes\n     */\n    load() {\n        if (!this.getMap()) {\n            return this;\n        }\n        if (this.onLoad()) {\n            this._initRenderer();\n            const zIndex = this.getZIndex();\n            if (!isNil(zIndex)) {\n                this._renderer.setZIndex(zIndex);\n                if (!this.isCanvasRender()) {\n                    this._renderer.render();\n                }\n            }\n            this.onLoadEnd();\n        }\n        return this;\n    }\n\n    /**\n     * Get the layer id\n     * @returns {String} id\n     */\n    getId() {\n        return this._id;\n    }\n\n    /**\n     * Set a new id to the layer\n     * @param {String} id - new layer id\n     * @return {Layer} this\n     * @fires Layer#idchange\n     */\n    setId(id) {\n        const old = this._id;\n        if (!isNil(id)) {\n            id = id + '';\n        }\n        this._id = id;\n        /**\n         * idchange event.\n         *\n         * @event Layer#idchange\n         * @type {Object}\n         * @property {String} type - idchange\n         * @property {Layer} target    - the layer fires the event\n         * @property {String} old        - value of the old id\n         * @property {String} new        - value of the new id\n         */\n        this.fire('idchange', {\n            'old': old,\n            'new': id\n        });\n        return this;\n    }\n\n    /**\n     * Adds itself to a map.\n     * @param {Map} map - map added to\n     * @return {Layer} this\n     */\n    addTo(map) {\n        map.addLayer(this);\n        return this;\n    }\n\n    /**\n     * Set a z-index to the layer\n     * @param {Number} zIndex - layer's z-index\n     * @return {Layer} this\n     */\n    setZIndex(zIndex) {\n        this._zIndex = zIndex;\n        if (isNil(zIndex)) {\n            delete this.options['zIndex'];\n        } else {\n            this.options.zIndex = zIndex;\n        }\n        if (this.map) {\n            this.map._sortLayersByZIndex();\n        }\n        if (this._renderer) {\n            this._renderer.setZIndex(zIndex);\n        }\n        return this;\n    }\n\n    /**\n     * Get the layer's z-index\n     * @return {Number}\n     */\n    getZIndex() {\n        return this._zIndex || 0;\n    }\n\n    /**\n     * Get Layer's minZoom to display\n     * @return {Number}\n     */\n    getMinZoom() {\n        const map = this.getMap();\n        const minZoom = this.options['minZoom'];\n        return map ? Math.max(map.getMinZoom(), minZoom || 0) : minZoom;\n    }\n\n    /**\n     * Get Layer's maxZoom to display\n     * @return {Number}\n     */\n    getMaxZoom() {\n        const map = this.getMap();\n        const maxZoom = this.options['maxZoom'];\n        return map ? Math.min(map.getMaxZoom(), isNil(maxZoom) ? Infinity : maxZoom) : maxZoom;\n    }\n\n    /**\n     * Get layer's opacity\n     * @returns {Number}\n     */\n    getOpacity() {\n        return this.options['opacity'];\n    }\n\n    /**\n     * Set opacity to the layer\n     * @param {Number} opacity - layer's opacity\n     * @return {Layer} this\n     */\n    setOpacity(op) {\n        this.config('opacity', op);\n        return this;\n    }\n\n    /**\n     * If the layer is rendered by HTML5 Canvas.\n     * @return {Boolean}\n     * @protected\n     */\n    isCanvasRender() {\n        const renderer = this._getRenderer();\n        return (renderer && (renderer instanceof CanvasRenderer));\n    }\n\n    /**\n     * Get the map that the layer added to\n     * @returns {Map}\n     */\n    getMap() {\n        if (this.map) {\n            return this.map;\n        }\n        return null;\n    }\n\n    /**\n     * Get projection of layer's map\n     * @returns {Object}\n     */\n    getProjection() {\n        const map = this.getMap();\n        return map ? map.getProjection() : null;\n    }\n\n    /**\n     * Brings the layer to the top of all the layers\n     * @returns {Layer} this\n     */\n    bringToFront() {\n        const layers = this._getLayerList();\n        if (!layers.length) {\n            return this;\n        }\n        const topLayer = layers[layers.length - 1];\n        if (layers.length === 1 || topLayer === this) {\n            return this;\n        }\n        const max = topLayer.getZIndex();\n        this.setZIndex(max + 1);\n        return this;\n    }\n\n    /**\n     * Brings the layer under the bottom of all the layers\n     * @returns {Layer} this\n     */\n    bringToBack() {\n        const layers = this._getLayerList();\n        if (!layers.length) {\n            return this;\n        }\n        const bottomLayer = layers[0];\n        if (layers.length === 1 || bottomLayer === this) {\n            return this;\n        }\n        const min = bottomLayer.getZIndex();\n        this.setZIndex(min - 1);\n        return this;\n    }\n\n    /**\n     * Show the layer\n     * @returns {Layer} this\n     */\n    show() {\n        if (!this.options['visible']) {\n            this.options['visible'] = true;\n            const renderer = this.getRenderer();\n            if (renderer) {\n                renderer.show();\n            }\n\n            const map = this.getMap();\n            if (renderer && map) {\n                //fire show at renderend to make sure layer is shown\n                map.once('renderend', () => {\n                    this.fire('show');\n                });\n            } else {\n                this.fire('show');\n            }\n        }\n        return this;\n    }\n\n    /**\n     * Hide the layer\n     * @returns {Layer} this\n     */\n    hide() {\n        if (this.options['visible']) {\n            this.options['visible'] = false;\n            const renderer = this.getRenderer();\n            if (renderer) {\n                renderer.hide();\n            }\n\n            const map = this.getMap();\n            if (renderer && map) {\n                //fire hide at renderend to make sure layer is hidden\n                map.once('renderend', () => {\n                    this.fire('hide');\n                });\n            } else {\n                this.fire('hide');\n            }\n        }\n        // this.fire('hide');\n        return this;\n    }\n\n    /**\n     * Whether the layer is visible now.\n     * @return {Boolean}\n     */\n    isVisible() {\n        if (isNumber(this.options['opacity']) && this.options['opacity'] <= 0) {\n            return false;\n        }\n        const map = this.getMap();\n        if (map) {\n            const zoom = map.getZoom();\n            if ((!isNil(this.options['maxZoom']) && this.options['maxZoom'] < zoom) ||\n                (!isNil(this.options['minZoom']) && this.options['minZoom'] > zoom)) {\n                return false;\n            }\n        }\n\n        if (isNil(this.options['visible'])) {\n            this.options['visible'] = true;\n        }\n        return this.options['visible'];\n    }\n\n    /**\n     * Remove itself from the map added to.\n     * @returns {Layer} this\n     */\n    remove() {\n        if (this.map) {\n            this.map.removeLayer(this);\n        }\n        return this;\n    }\n\n    /**\n     * Get the mask geometry of the layer\n     * @return {Geometry}\n     */\n    getMask() {\n        return this._mask;\n    }\n\n    /**\n     * Set a mask geometry on the layer, only the area in the mask will be displayed.\n     * @param {Geometry} mask - mask geometry, can only be a Marker with vector symbol, a Polygon or a MultiPolygon\n     * @returns {Layer} this\n     */\n    setMask(mask) {\n        if (!((mask.type === 'Point' && mask._isVectorMarker()) || mask.type === 'Polygon' || mask.type === 'MultiPolygon')) {\n            throw new Error('Mask for a layer must be a marker with vector marker symbol or a Polygon(MultiPolygon).');\n        }\n\n        if (mask.type === 'Point') {\n            mask.updateSymbol({\n                'markerLineColor': 'rgba(0, 0, 0, 0)',\n                'markerFillOpacity': 0\n            });\n        } else {\n            mask.setSymbol({\n                'lineColor': 'rgba(0, 0, 0, 0)',\n                'polygonOpacity': 0\n            });\n        }\n        mask._bindLayer(this);\n        this._mask = mask;\n        if (!this.getMap() || this.getMap().isZooming()) {\n            return this;\n        }\n        const renderer = this._getRenderer();\n        if (renderer && renderer.setToRedraw) {\n            this._getRenderer().setToRedraw();\n        }\n        return this;\n    }\n\n    /**\n     * Remove the mask\n     * @returns {Layer} this\n     */\n    removeMask() {\n        delete this._mask;\n        if (!this.getMap() || this.getMap().isZooming()) {\n            return this;\n        }\n        const renderer = this._getRenderer();\n        if (renderer && renderer.setToRedraw) {\n            this._getRenderer().setToRedraw();\n        }\n        return this;\n    }\n\n    /**\n     * Prepare Layer's loading, this is a method intended to be overrided by subclasses.\n     * @return {Boolean} true to continue loading, false to cease.\n     * @protected\n     */\n    onLoad() {\n        return true;\n    }\n\n    onLoadEnd() {\n    }\n\n    /**\n     * Whether the layer is loaded\n     * @return {Boolean}\n     */\n    isLoaded() {\n        return !!this._loaded;\n    }\n\n    getRenderer() {\n        return this._getRenderer();\n    }\n\n    onConfig(conf) {\n        if (isNumber(conf['opacity']) || conf['cssFilter']) {\n            const renderer = this.getRenderer();\n            if (renderer) {\n                renderer.setToRedraw();\n            }\n        }\n    }\n\n    onAdd() {}\n\n    onRemove() {}\n\n    _bindMap(map, zIndex) {\n        if (!map) {\n            return;\n        }\n        this.map = map;\n        if (!isNil(zIndex)) {\n            this.setZIndex(zIndex);\n        }\n        this._switchEvents('on', this);\n\n        this.onAdd();\n\n        this.fire('add');\n    }\n\n    _initRenderer() {\n        const renderer = this.options['renderer'];\n        if (!this.constructor.getRendererClass) {\n            return;\n        }\n        const clazz = this.constructor.getRendererClass(renderer);\n        if (!clazz) {\n            throw new Error('Invalid renderer for Layer(' + this.getId() + '):' + renderer);\n        }\n        this._renderer = new clazz(this);\n        this._renderer.layer = this;\n        this._renderer.setZIndex(this.getZIndex());\n        this._switchEvents('on', this._renderer);\n        // some plugin of dom renderer doesn't implement onAdd\n        if (this._renderer.onAdd) {\n            this._renderer.onAdd();\n        }\n\n        /**\n         * renderercreate event, fired when renderer is created.\n         *\n         * @event Layer#renderercreate\n         * @type {Object}\n         * @property {String} type - renderercreate\n         * @property {Layer} target    - the layer fires the event\n         * @property {Any} renderer    - renderer of the layer\n         */\n        this.fire('renderercreate', {\n            'renderer': this._renderer\n        });\n    }\n\n    _doRemove() {\n        this._loaded = false;\n        this.onRemove();\n\n        this._switchEvents('off', this);\n        if (this._renderer) {\n            this._switchEvents('off', this._renderer);\n            this._renderer.remove();\n            delete this._renderer;\n        }\n        delete this.map;\n    }\n\n    _switchEvents(to, emitter) {\n        if (emitter && emitter.getEvents) {\n            this.getMap()[to](emitter.getEvents(), emitter);\n        }\n    }\n\n    _getRenderer() {\n        return this._renderer;\n    }\n\n    _getLayerList() {\n        if (!this.map) {\n            return [];\n        }\n        return this.map._layers;\n    }\n\n    _getMask2DExtent() {\n        if (!this._mask || !this.getMap()) {\n            return null;\n        }\n        const painter = this._mask._getPainter();\n        if (!painter) {\n            return null;\n        }\n        return painter.get2DExtent();\n    }\n}\n\nLayer.mergeOptions(options);\n\nconst fire = Layer.prototype.fire;\n\nLayer.prototype.fire = function (eventType, param) {\n    if (eventType === 'layerload') {\n        this._loaded = true;\n    }\n    if (this.map) {\n        if (!param) {\n            param = {};\n        }\n        param['type'] = eventType;\n        param['target'] = this;\n        this.map._onLayerEvent(param);\n    }\n    return fire.apply(this, arguments);\n};\n\nexport default Layer;\n","import { extend, isNil, isObject, hasOwn, sign } from '../../core/util';\nimport Coordinate from '../../geo/Coordinate';\nimport Extent from '../../geo/Extent';\nimport * as projections from '../../geo/projection';\nimport Transformation from '../../geo/transformation/Transformation';\nimport { Measurer } from '../../geo/measurer';\n\nconst DefaultSpatialReference = {\n    'EPSG:3857': {\n        'resolutions': (function () {\n            const resolutions = [];\n            const d = 2 * 6378137 * Math.PI;\n            for (let i = 0; i < 21; i++) {\n                resolutions[i] = d / (256 * Math.pow(2, i));\n            }\n            return resolutions;\n        })(),\n        'fullExtent': {\n            'top': 6378137 * Math.PI,\n            'left': -6378137 * Math.PI,\n            'bottom': -6378137 * Math.PI,\n            'right': 6378137 * Math.PI\n        }\n    },\n    'EPSG:4326': {\n        'fullExtent': {\n            'top': 90,\n            'left': -180,\n            'bottom': -90,\n            'right': 180\n        },\n        'resolutions': (function () {\n            const resolutions = [];\n            for (let i = 0; i < 20; i++) {\n                resolutions[i] = 180 / (Math.pow(2, i) * 128);\n            }\n            return resolutions;\n        })()\n    },\n    'BAIDU': {\n        'resolutions': (function () {\n            let res = Math.pow(2, 18);\n            const resolutions = [];\n            for (let i = 0; i < 20; i++) {\n                resolutions[i] = res;\n                res *= 0.5;\n            }\n            resolutions[0] = null;\n            resolutions[1] = null;\n            resolutions[2] = null;\n            return resolutions;\n        })(),\n        'fullExtent': {\n            'top': 33554432,\n            'left': -33554432,\n            'bottom': -33554432,\n            'right': 33554432\n        }\n    },\n    'IDENTITY' : {\n        'resolutions': (function () {\n            let res = Math.pow(2, 8);\n            const resolutions = [];\n            for (let i = 0; i < 18; i++) {\n                resolutions[i] = res;\n                res *= 0.5;\n            }\n            return resolutions;\n        })(),\n        'fullExtent': {\n            'top': 200000,\n            'left': -200000,\n            'bottom': -200000,\n            'right': 200000\n        }\n    }\n};\n\nDefaultSpatialReference['EPSG:4490'] = DefaultSpatialReference['EPSG:4326'];\n\nexport default class SpatialReference {\n    constructor(options = {}) {\n        this.options = options;\n        this._initSpatialRef();\n    }\n\n    static getProjectionInstance(prjName) {\n        if (!prjName) {\n            return null;\n        }\n        if (isObject(prjName)) {\n            return prjName;\n        }\n        prjName = (prjName + '').toLowerCase();\n        for (const p in projections) {\n            if (hasOwn(projections, p)) {\n                const code = projections[p]['code'];\n                if (code && code.toLowerCase() === prjName) {\n                    return projections[p];\n                }\n            }\n        }\n        return null;\n    }\n\n    static equals(sp1, sp2) {\n        if (!sp1 && !sp2) {\n            return true;\n        } else if (!sp1 || !sp2) {\n            return false;\n        }\n        if (sp1.projection !== sp2.projection) {\n            return false;\n        }\n        const f1 = sp1.fullExtent, f2 = sp2.fullExtent;\n        if (f1 && !f2 || !f1 && f2) {\n            return false;\n        }\n        if (f1 && f2) {\n            if (f1.top !== f2.top || f1.bottom !== f2.bottom || f1.left !== f2.left || f1.right !== f2.right) {\n                return false;\n            }\n        }\n        const r1 = sp1.resolutions, r2 = sp2.resolutions;\n        if (r1 && r2) {\n            if (r1.length !== r2.length) {\n                return false;\n            }\n            for (let i = 0; i < r1.length; i++) {\n                if (r1[i] !== r2[i]) {\n                    return false;\n                }\n            }\n        }\n        return true;\n    }\n\n    _initSpatialRef() {\n        let projection = this.options['projection'];\n        if (projection) {\n            projection = SpatialReference.getProjectionInstance(projection);\n        } else {\n            projection = projections.DEFAULT;\n        }\n        if (!projection) {\n            throw new Error('must provide a valid projection in map\\'s spatial reference.');\n        }\n        projection = extend({}, projections.Common, projection);\n        if (!projection.measureLength) {\n            extend(projection, Measurer.DEFAULT);\n        }\n        this._projection = projection;\n        let defaultSpatialRef,\n            resolutions = this.options['resolutions'];\n        if (!resolutions) {\n            if (projection['code']) {\n                defaultSpatialRef = DefaultSpatialReference[projection['code']];\n                if (defaultSpatialRef) {\n                    resolutions = defaultSpatialRef['resolutions'];\n                    this.isEPSG = projection['code'] !== 'IDENTITY';\n                }\n            }\n            if (!resolutions) {\n                throw new Error('must provide valid resolutions in map\\'s spatial reference.');\n            }\n        }\n        this._resolutions = resolutions;\n        let fullExtent = this.options['fullExtent'];\n        if (!fullExtent) {\n            if (projection['code']) {\n                defaultSpatialRef = DefaultSpatialReference[projection['code']];\n                if (defaultSpatialRef) {\n                    fullExtent = defaultSpatialRef['fullExtent'];\n                }\n            }\n            if (!fullExtent) {\n                throw new Error('must provide a valid fullExtent in map\\'s spatial reference.');\n            }\n        }\n        if (!isNil(fullExtent['left'])) {\n            this._fullExtent = new Extent(new Coordinate(fullExtent['left'], fullExtent['top']),\n                new Coordinate(fullExtent['right'], fullExtent['bottom']));\n        } else {\n            //xmin, ymin, xmax, ymax\n            this._fullExtent = new Extent(fullExtent);\n            fullExtent['left'] = fullExtent['xmin'];\n            fullExtent['right'] = fullExtent['xmax'];\n            fullExtent['top'] = fullExtent['ymax'];\n            fullExtent['bottom'] = fullExtent['ymin'];\n        }\n\n        if (isNil(fullExtent['top']) || isNil(fullExtent['bottom']) || isNil(fullExtent['left']) || isNil(fullExtent['right'])) {\n            throw new Error('must provide valid top/bottom/left/right in fullExtent.');\n        }\n\n        //set left, right, top, bottom value\n        extend(this._fullExtent, fullExtent);\n\n        this._projection.fullExtent = fullExtent;\n\n        const a = fullExtent['right'] >= fullExtent['left'] ? 1 : -1,\n            b = fullExtent['top'] >= fullExtent['bottom'] ? -1 : 1;\n        this._transformation = new Transformation([a, b, 0, 0]);\n    }\n\n    getResolutions() {\n        return this._resolutions || [];\n    }\n\n    getResolution(zoom) {\n        let z = (zoom | 0);\n        if (z < 0) {\n            z = 0;\n        } else if (z > this._resolutions.length - 1) {\n            z = this._resolutions.length - 1;\n        }\n        const res = this._resolutions[z];\n        if (z !== zoom && zoom > 0 && z < this._resolutions.length - 1) {\n            const next = this._resolutions[z + 1];\n            return res + (next - res) * (zoom - z);\n        }\n        return res;\n    }\n\n    getProjection() {\n        return this._projection;\n    }\n\n    getFullExtent() {\n        return this._fullExtent;\n    }\n\n    getTransformation() {\n        return this._transformation;\n    }\n\n    getMinZoom() {\n        for (let i = 0; i < this._resolutions.length; i++) {\n            if (!isNil(this._resolutions[i])) {\n                return i;\n            }\n        }\n        return 0;\n    }\n\n    getMaxZoom() {\n        for (let i = this._resolutions.length - 1; i >= 0; i--) {\n            if (!isNil(this._resolutions[i])) {\n                return i;\n            }\n        }\n        return this._resolutions.length - 1;\n    }\n\n    getZoomDirection() {\n        return sign(this._resolutions[this.getMinZoom()] - this._resolutions[this.getMaxZoom()]);\n    }\n\n    toJSON() {\n        if (!this.json) {\n            this.json = {\n                'resolutions' : this._resolutions,\n                'fullExtent' : {\n                    'top': this._fullExtent.top,\n                    'left': this._fullExtent.left,\n                    'bottom': this._fullExtent.bottom,\n                    'right': this._fullExtent.right\n                },\n                'projection' : this._projection.code\n            };\n        }\n        return this.json;\n    }\n}\n","import { INTERNAL_LAYER_PREFIX } from '../core/Constants';\nimport {\n    now,\n    extend,\n    IS_NODE,\n    isNil,\n    isString,\n    isFunction,\n    sign,\n    UID,\n    b64toBlob\n} from '../core/util';\nimport Class from '../core/Class';\nimport Browser from '../core/Browser';\nimport Eventable from '../core/Eventable';\nimport Handlerable from '../handler/Handlerable';\nimport Point from '../geo/Point';\nimport Size from '../geo/Size';\nimport PointExtent from '../geo/PointExtent';\nimport Extent from '../geo/Extent';\nimport Coordinate from '../geo/Coordinate';\nimport Layer from '../layer/Layer';\nimport Renderable from '../renderer/Renderable';\nimport SpatialReference from './spatial-reference/SpatialReference';\n\nconst TEMP_POINT = new Point(0, 0);\n\n/**\n * @property {Object} options                                   - map's options, options must be updated by config method:<br> map.config('zoomAnimation', false);\n * @property {Boolean} [options.centerCross=false]              - Display a red cross in the center of map\n * @property {Boolean} [options.seamlessZoom=false]             - whether to use seamless zooming mode\n * @property {Boolean} [options.zoomInCenter=false]             - whether to fix in the center when zooming\n * @property {Boolean} [options.zoomAnimation=true]             - enable zooming animation\n * @property {Number}  [options.zoomAnimationDuration=330]      - zoom animation duration.\n * @property {Boolean} [options.panAnimation=true]              - continue to animate panning when draging or touching ended.\n * @property {Boolean} [options.panAnimationDuration=600]       - duration of pan animation.\n * @property {Boolean} [options.zoomable=true]                  - whether to enable map zooming.\n * @property {Boolean} [options.enableInfoWindow=true]          - whether to enable infowindow on this map.\n * @property {Boolean} [options.hitDetect=true]                 - whether to enable hit detecting of layers for cursor style on this map, disable it to improve performance.\n * @property {Boolean} [options.hitDetectLimit=5]               - the maximum number of layers to perform hit detect.\n * @property {Boolean} [options.fpsOnInteracting=25]            - fps when map is interacting, some slow layers will not be drawn on interacting when fps is low. Set to 0 to disable it.\n * @property {Boolean} [options.layerCanvasLimitOnInteracting=-1]    - limit of layer canvas to draw on map when interacting, set it to improve perf.\n * @property {Number}  [options.maxZoom=null]                   - the maximum zoom the map can be zooming to.\n * @property {Number}  [options.minZoom=null]                   - the minimum zoom the map can be zooming to.\n * @property {Extent}  [options.maxExtent=null]         - when maxExtent is set, map will be restricted to the give max extent and bouncing back when user trying to pan ouside the extent.\n * @property {Boolean} [options.fixCenterOnResize=false]        - whether to fix map center when map is resized\n *\n * @property {Number}  [options.maxPitch=80]                    - max pitch\n * @property {Number}  [options.maxVisualPitch=60]              - the max pitch to be visual\n *\n * @property {Extent}  [options.viewHistory=true]               -  whether to record view history\n * @property {Extent}  [options.viewHistoryCount=10]            -  the count of view history record.\n *\n * @property {Boolean} [options.draggable=true]                         - disable the map dragging if set to false.\n * @property {Boolean} [options.dragPan=true]                           - if true, map can be dragged to pan.\n * @property {Boolean} [options.dragRotate=true]                        - default true. If true, map can be dragged to rotate by right click or ctrl + left click.\n * @property {Boolean} [options.dragPitch=true]                         - default true. If true, map can be dragged to pitch by right click or ctrl + left click.\n * @property {Boolean} [options.dragRotatePitch=true]                  - if true, map is dragged to pitch and rotate at the same time.\n * @property {Boolean} [options.touchGesture=true]                      - whether to allow map to zoom/rotate/tilt by two finger touch gestures.\n * @property {Boolean} [options.touchZoom=true]                         - whether to allow map to zoom by touch pinch.\n * @property {Boolean} [options.touchRotate=true]                       - whether to allow map to rotate by touch pinch.\n * @property {Boolean} [options.touchPitch=true]                        - whether to allow map to pitch by touch pinch.\n * @property {Boolean} [options.touchZoomRotate=false]                  - if true, map is to zoom and rotate at the same time by touch pinch.\n * @property {Boolean} [options.doubleClickZoom=true]                    - whether to allow map to zoom by double click events.\n * @property {Boolean} [options.scrollWheelZoom=true]                   - whether to allow map to zoom by scroll wheel events.\n * @property {Boolean} [options.geometryEvents=true]                    - enable/disable firing geometry events\n *\n * @property {Boolean}        [options.control=true]                    - whether allow map to add controls.\n * @property {Boolean|Object} [options.attribution=true]                - whether to display the attribution control on the map. if true, attribution display maptalks info; if object, you can specify positon or your base content, and both;\n * @property {Boolean|Object} [options.zoomControl=false]               - display the zoom control on the map if set to true or a object as the control construct option.\n * @property {Boolean|Object} [options.scaleControl=false]              - display the scale control on the map if set to true or a object as the control construct option.\n * @property {Boolean|Object} [options.overviewControl=false]           - display the overview control on the map if set to true or a object as the control construct option.\n *\n * @property {Boolean}        [options.fog=true]                        - whether to draw fog in far distance.\n * @property {Number[]}       [options.fogColor=[233, 233, 233]]        - color of fog: [r, g, b]\n *\n * @property {String} [options.renderer=canvas]                 - renderer type. Don't change it if you are not sure about it. About renderer, see [TODO]{@link tutorial.renderer}.\n * @property {Number} [options.devicePixelRatio=null]           - device pixel ratio to override device's default one\n * @memberOf Map\n * @instance\n */\nconst options = {\n    'maxVisualPitch' : 60,\n    'maxPitch' : 80,\n    'centerCross': false,\n\n    'zoomInCenter' : false,\n    'zoomAnimation': (function () {\n        return !IS_NODE;\n    })(),\n    'zoomAnimationDuration': 330,\n\n    'panAnimation': (function () {\n        return !IS_NODE;\n    })(),\n    //default pan animation duration\n    'panAnimationDuration': 600,\n\n    'zoomable': true,\n    'enableInfoWindow': true,\n\n    'hitDetect': (function () {\n        return !Browser.mobile;\n    })(),\n\n    'hitDetectLimit' : 5,\n\n    'fpsOnInteracting' : 25,\n\n    'layerCanvasLimitOnInteracting' : -1,\n\n    'maxZoom': null,\n    'minZoom': null,\n    'maxExtent': null,\n    'fixCenterOnResize' : false,\n\n    'checkSize': true,\n    'checkSizeInterval' : 1000,\n\n    'renderer': 'canvas'\n};\n\n/**\n * The central class of the library, to create a map on a container.\n * @category map\n * @extends Class\n *\n * @mixes Eventable\n * @mixes Handlerable\n * @mixes ui.Menuable\n * @mixes Renderable\n *\n * @example\n * var map = new maptalks.Map(\"map\",{\n *      center:     [180,0],\n *      zoom:  4,\n *      baseLayer : new maptalks.TileLayer(\"base\",{\n *          urlTemplate:'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n *          subdomains:['a','b','c']\n *      }),\n *      layers : [\n *          new maptalks.VectorLayer('v', [new maptalks.Marker([180, 0])])\n *      ]\n * });\n */\nclass Map extends Handlerable(Eventable(Renderable(Class))) {\n\n    /**\n     * @param {(string|HTMLElement|object)} container - The container to create the map on, can be:<br>\n     *                                          1. A HTMLElement container.<br/>\n     *                                          2. ID of a HTMLElement container.<br/>\n     *                                          3. Any canvas compatible container\n     * @param {Object} options - construct options\n     * @param {(Number[]|Coordinate)} options.center - initial center of the map.\n     * @param {Number} options.zoom - initial zoom of the map.\n     * @param {Object} [options.spatialReference=null] - map's spatial reference, default is using projection EPSG:3857 with resolutions used by google map/osm.\n     * @param {Layer} [options.baseLayer=null] - base layer that will be set to map initially.\n     * @param {Layer[]} [options.layers=null] - layers that will be added to map initially.\n     * @param {*} options.* - any other option defined in [Map.options]{@link Map#options}      [description]\n     */\n    constructor(container, options) {\n        if (!options) {\n            throw new Error('Invalid options when creating map.');\n        }\n        if (!options['center']) {\n            throw new Error('Invalid center when creating map.');\n        }\n        // prepare options\n        const opts = extend({}, options);\n        const zoom = opts['zoom'];\n        delete opts['zoom'];\n        const center = new Coordinate(opts['center']);\n        delete opts['center'];\n\n        const baseLayer = opts['baseLayer'];\n        delete opts['baseLayer'];\n        const layers = opts['layers'];\n        delete opts['layers'];\n        super(opts);\n\n        this.VERSION = Map.VERSION;\n\n        Object.defineProperty(this, 'id', {\n            value: UID(),\n            writable: false\n        });\n\n        this._loaded = false;\n        this._initContainer(container);\n\n        this._panels = {};\n\n        //Layers\n        this._baseLayer = null;\n        this._layers = [];\n\n        this._zoomLevel = zoom;\n        this._center = center;\n\n        this.setSpatialReference(opts['spatialReference'] || opts['view']);\n\n\n        this._mapViewPoint = new Point(0, 0);\n\n        this._initRenderer();\n        this._updateMapSize(this._getContainerDomSize());\n\n        if (baseLayer) {\n            this.setBaseLayer(baseLayer);\n        }\n        if (layers) {\n            this.addLayer(layers);\n        }\n\n        this._Load();\n    }\n\n    /**\n     * Add hooks for additional codes when map's loading complete, useful for plugin developping.\n     * Note that it can only be called before the map is created.\n     * @param {Function} fn\n     * @returns {Map}\n     * @protected\n     */\n    static addOnLoadHook(fn) { // (Function) || (String, args...)\n        const args = Array.prototype.slice.call(arguments, 1);\n        const onload = typeof fn === 'function' ? fn : function () {\n            this[fn].apply(this, args);\n        };\n        this.prototype._onLoadHooks = this.prototype._onLoadHooks || [];\n        this.prototype._onLoadHooks.push(onload);\n        return this;\n    }\n\n\n    /**\n     * Whether the map is loaded or not.\n     * @return {Boolean}\n     */\n    isLoaded() {\n        return !!this._loaded;\n    }\n\n    /**\n     * Get map's container\n     * @returns {HTMLElement}\n     */\n    getContainer() {\n        return this._containerDOM;\n    }\n\n    /**\n     * Get the spatial reference of the Map.\n     * @return {SpatialReference} map's spatial reference\n     */\n    getSpatialReference() {\n        return this._spatialReference;\n    }\n\n    /**\n     * Change the spatial reference of the map. <br>\n     * A SpatialReference is a series of settings to decide the map presentation:<br>\n     * 1. the projection.<br>\n     * 2. zoom levels and resolutions. <br>\n     * 3. full extent.<br>\n     * There are some [predefined spatial references]{@link http://www.foo.com}, and surely you can [define a custom one.]{@link http://www.foo.com}.<br>\n     * SpatialReference can also be updated by map.config('spatialReference', spatialReference);\n     * @param {SpatialReference} spatialReference - spatial reference\n     * @returns {Map} this\n     * @fires Map#spatialreferencechange\n     * @example\n     *  map.setSpatialReference({\n            projection:'EPSG:4326',\n            resolutions: (function() {\n                const resolutions = [];\n                for (let i=0; i < 19; i++) {\n                    resolutions[i] = 180/(Math.pow(2, i)*128);\n                }\n                return resolutions;\n            })()\n     *  });\n       @example\n     *  map.config('spatialReference', {\n            projection:'EPSG:4326',\n            resolutions: (function() {\n                const resolutions = [];\n                for (let i=0; i < 19; i++) {\n                    resolutions[i] = 180/(Math.pow(2, i)*128);\n                }\n                return resolutions;\n            })()\n        });\n     */\n    setSpatialReference(ref) {\n        const oldRef = this.options['spatialReference'];\n        if (this._loaded && SpatialReference.equals(oldRef, ref)) {\n            return this;\n        }\n        this._updateSpatialReference(ref, oldRef);\n        return this;\n    }\n\n    _updateSpatialReference(ref, oldRef) {\n        ref = extend({}, ref);\n        this._center = this.getCenter();\n        this.options['spatialReference'] = ref;\n        this._spatialReference = new SpatialReference(ref);\n        if (this.options['spatialReference'] && isFunction(this.options['spatialReference']['projection'])) {\n            const projection = this._spatialReference.getProjection();\n            //save projection code for map profiling (toJSON/fromJSON)\n            this.options['spatialReference']['projection'] = projection['code'];\n        }\n        this._resetMapStatus();\n        /**\n         * spatialreferencechange event, fired when map's spatial reference is updated.\n         *\n         * @event Map#spatialreferencechange\n         * @type {Object}\n         * @property {String} type - spatialreferencechange\n         * @property {Map} target - map\n         * @property {Map} old - the old spatial reference\n         * @property {Map} new - the new spatial reference changed to\n         */\n        this._fireEvent('spatialreferencechange', {\n            'old': oldRef,\n            'new': extend({}, this.options['spatialReference'])\n        });\n        return this;\n    }\n\n    // _syncWorld() {\n    //     const projection = this.getProjection();\n    //     if (!projection) {\n    //         return false;\n    //     }\n    //     const pcenter = this._getPrjCenter();\n    //     if (projection.isOutSphere(pcenter)) {\n    //         const wrapped = projection.wrapCoord(pcenter);\n    //         this._setPrjCenter(wrapped);\n    //         this._fireEvent('syncworld', { 'old' : pcenter.toArray(), 'new' : wrapped.toArray() });\n    //         return true;\n    //     }\n    //     return false;\n    // }\n\n    /**\n     * Callback when any option is updated\n     * @private\n     * @param  {Object} conf - options to update\n     * @return {Map}   this\n     */\n    onConfig(conf) {\n        const ref = conf['spatialReference'] || conf['view'];\n        if (!isNil(ref)) {\n            this._updateSpatialReference(ref, null);\n        }\n        return this;\n    }\n\n    /**\n     * Get the projection of the map. <br>\n     * Projection is an algorithm for map projection, e.g. well-known [Mercator Projection]{@link https://en.wikipedia.org/wiki/Mercator_projection} <br>\n     * A projection must have 2 methods: <br>\n     * 1. project(coordinate) - project the input coordinate <br>\n     * 2. unproject(coordinate) - unproject the input coordinate <br>\n     * Projection also contains measuring method usually extended from a measurer: <br>\n     * 1. measureLength(coord1, coord2) - compute length between 2 coordinates.  <br>\n     * 2. measureArea(coords[]) - compute area of the input coordinates. <br>\n     * 3. locate(coord, distx, disty) - compute the coordinate from the coord with xdist on axis x and ydist on axis y.\n     * @return {Object}\n     */\n    getProjection() {\n        if (!this._spatialReference) {\n            return null;\n        }\n        return this._spatialReference.getProjection();\n    }\n\n    /**\n     * Get map's full extent, which is defined in map's spatial reference. <br>\n     * eg: {'left': -180, 'right' : 180, 'top' : 90, 'bottom' : -90}\n     * @return {Extent}\n     */\n    getFullExtent() {\n        if (!this._spatialReference) {\n            return null;\n        }\n        return this._spatialReference.getFullExtent();\n    }\n\n    /**\n     * Set map's cursor style, cursor style is same with CSS.\n     * @param {String} cursor - cursor style\n     * @returns {Map} this\n     * @example\n     * map.setCursor('url(cursor.png) 4 12, auto');\n     */\n    setCursor(cursor) {\n        delete this._cursor;\n        this._trySetCursor(cursor);\n        this._cursor = cursor;\n        return this;\n    }\n\n    /**\n     * Reset map's cursor style.\n     * @return {Map} this\n     * @example\n     * map.resetCursor();\n     */\n    resetCursor() {\n        return this.setCursor(null);\n    }\n\n    /**\n     * Get center of the map.\n     * @return {Coordinate}\n     */\n    getCenter() {\n        if (!this._loaded || !this._prjCenter) {\n            return this._center;\n        }\n        const projection = this.getProjection();\n        return projection.unproject(this._prjCenter);\n    }\n\n    /**\n     * Set a new center to the map.\n     * @param {Coordinate} center\n     * @return {Map} this\n     */\n    setCenter(center) {\n        if (!center) {\n            return this;\n        }\n        center = new Coordinate(center);\n        if (!this._verifyExtent(center)) {\n            return this;\n        }\n        if (!this._loaded) {\n            this._center = center;\n            return this;\n        }\n        this.onMoveStart();\n        const projection = this.getProjection();\n        const _pcenter = projection.project(center);\n        this._setPrjCenter(_pcenter);\n        this.onMoveEnd(this._parseEventFromCoord(this.getCenter()));\n        return this;\n    }\n\n    /**\n     * Get map's size (width and height) in pixel.\n     * @return {Size}\n     */\n    getSize() {\n        if (isNil(this.width) || isNil(this.height)) {\n            return this._getContainerDomSize();\n        }\n        return new Size(this.width, this.height);\n    }\n\n    /**\n     * Get container extent of the map\n     * @return {PointExtent}\n     */\n    getContainerExtent() {\n        let visualHeight = this.height;\n        const pitch = this.getPitch(),\n            maxVisualPitch = this.options['maxVisualPitch'];\n        if (maxVisualPitch && pitch > maxVisualPitch) {\n            visualHeight = this._getVisualHeight(maxVisualPitch);\n        }\n        return new PointExtent(0, this.height - visualHeight, this.width, this.height);\n    }\n\n    _getVisualHeight(maxVisualPitch) {\n        const pitch = this.getPitch();\n        const visualDistance = this.height / 2 * Math.tan(maxVisualPitch * Math.PI / 180);\n        return this.height / 2 + visualDistance *  Math.tan((90 - pitch) * Math.PI / 180);\n    }\n\n    /**\n     * Get the geographical extent of map's current view extent.\n     *\n     * @return {Extent}\n     */\n    getExtent() {\n        return this._pointToExtent(this._get2DExtent());\n    }\n\n    /**\n     * Get the projected geographical extent of map's current view extent.\n     *\n     * @return {Extent}\n     */\n    getProjExtent() {\n        const extent2D = this._get2DExtent();\n        return new Extent(\n            this._pointToPrj(extent2D.getMin()),\n            this._pointToPrj(extent2D.getMax())\n        );\n    }\n\n    /**\n     * Alias for getProjExtent\n     *\n     * @return {Extent}\n     */\n    getPrjExtent() {\n        return this.getProjExtent();\n    }\n\n    /**\n     * Get the max extent that the map is restricted to.\n     * @return {Extent}\n     */\n    getMaxExtent() {\n        if (!this.options['maxExtent']) {\n            return null;\n        }\n        return new Extent(this.options['maxExtent'], this.getProjection());\n    }\n\n    /**\n     * Sets the max extent that the map is restricted to.\n     * @param {Extent}\n     * @return {Map} this\n     * @example\n     * map.setMaxExtent(map.getExtent());\n     */\n    setMaxExtent(extent) {\n        if (extent) {\n            const maxExt = new Extent(extent, this.getProjection());\n            this.options['maxExtent'] = maxExt;\n            const center = this.getCenter();\n            if (!this._verifyExtent(center)) {\n                this.panTo(maxExt.getCenter());\n            }\n        } else {\n            delete this.options['maxExtent'];\n        }\n        return this;\n    }\n\n    /**\n     * Get map's current zoom.\n     * @return {Number}\n     */\n    getZoom() {\n        return this._zoomLevel;\n    }\n\n    /**\n     * Caculate the target zoom if scaling from \"fromZoom\" by \"scale\"\n     * @param  {Number} scale\n     * @param  {Number} fromZoom\n     * @param  {Boolean} isFraction - can return fractional zoom\n     * @return {Number} zoom fit for scale starting from fromZoom\n     */\n    getZoomForScale(scale, fromZoom, isFraction) {\n        const zoom = this.getZoom();\n        if (isNil(fromZoom)) {\n            fromZoom = zoom;\n        }\n        if (scale === 1 && fromZoom === zoom) {\n            return zoom;\n        }\n        const res = this._getResolution(fromZoom),\n            targetRes = res / scale;\n        const scaleZoom = this.getZoomFromRes(targetRes);\n        if (isFraction) {\n            return scaleZoom;\n        } else {\n            const delta = 1E-6; //avoid precision\n            return this.getSpatialReference().getZoomDirection() < 0 ?\n                Math.ceil(scaleZoom - delta) : Math.floor(scaleZoom + delta);\n        }\n    }\n\n    getZoomFromRes(res) {\n        const resolutions = this._getResolutions(),\n            minRes = this._getResolution(this.getMinZoom()),\n            maxRes = this._getResolution(this.getMaxZoom());\n        if (minRes <= maxRes) {\n            if (res <= minRes) {\n                return this.getMinZoom();\n            } else if (res >= maxRes) {\n                return this.getMaxZoom();\n            }\n        } else if (res >= minRes) {\n            return this.getMinZoom();\n        } else if (res <= maxRes) {\n            return this.getMaxZoom();\n        }\n\n        const l = resolutions.length;\n        for (let i = 0; i < l - 1; i++) {\n            if (!resolutions[i]) {\n                continue;\n            }\n            const gap = resolutions[i + 1] - resolutions[i];\n            const test = res - resolutions[i];\n            if (sign(gap) === sign(test) && Math.abs(gap) >= Math.abs(test)) {\n                return i + test / gap;\n            }\n        }\n        return l - 1;\n    }\n\n    /**\n     * Sets zoom of the map\n     * @param {Number} zoom\n     * @param {Object} [options=null] options\n     * @param {Boolean} [options.animation=true] whether zoom is animation, true by default\n     * @returns {Map} this\n     */\n    setZoom(zoom, options = { 'animation' : true }) {\n        if (isNaN(zoom) || isNil(zoom)) {\n            return this;\n        }\n        zoom = +zoom;\n        if (this._loaded && this.options['zoomAnimation'] && options['animation']) {\n            this._zoomAnimation(zoom);\n        } else {\n            this._zoom(zoom);\n        }\n        return this;\n    }\n\n    /**\n     * Get the max zoom that the map can be zoom to.\n     * @return {Number}\n     */\n    getMaxZoom() {\n        if (!isNil(this.options['maxZoom'])) {\n            return this.options['maxZoom'];\n        }\n        return this.getMaxNativeZoom();\n    }\n\n    /**\n     * Sets the max zoom that the map can be zoom to.\n     * @param {Number} maxZoom\n     * @returns {Map} this\n     */\n    setMaxZoom(maxZoom) {\n        const viewMaxZoom = this.getMaxNativeZoom();\n        if (maxZoom > viewMaxZoom) {\n            maxZoom = viewMaxZoom;\n        }\n        if (maxZoom !== null && maxZoom < this._zoomLevel) {\n            this.setZoom(maxZoom);\n            maxZoom = +maxZoom;\n        }\n        this.options['maxZoom'] = maxZoom;\n        return this;\n    }\n\n    /**\n     * Get the min zoom that the map can be zoom to.\n     * @return {Number}\n     */\n    getMinZoom() {\n        if (!isNil(this.options['minZoom'])) {\n            return this.options['minZoom'];\n        }\n        return this._spatialReference.getMinZoom();\n    }\n\n    /**\n     * Sets the min zoom that the map can be zoom to.\n     * @param {Number} minZoom\n     * @return {Map} this\n     */\n    setMinZoom(minZoom) {\n        if (minZoom !== null) {\n            minZoom = +minZoom;\n            const viewMinZoom = this._spatialReference.getMinZoom();\n            if (minZoom < viewMinZoom) {\n                minZoom = viewMinZoom;\n            }\n            if (minZoom > this._zoomLevel) {\n                this.setZoom(minZoom);\n            }\n        }\n        this.options['minZoom'] = minZoom;\n        return this;\n    }\n\n    /**\n     * Maximum zoom the map has\n     * @return {Number}\n     */\n    getMaxNativeZoom() {\n        const ref = this.getSpatialReference();\n        if (!ref) {\n            return null;\n        }\n        return ref.getMaxZoom();\n    }\n\n    /**\n     * Zoom for world point in WebGL context\n     * @returns {Number}\n     */\n    getGLZoom() {\n        return this.getMaxNativeZoom() / 2;\n    }\n\n    /**\n     * Caculate scale from gl zoom to given zoom (default by current zoom)\n     * @param {Number} [zoom=undefined] target zoom, current zoom by default\n     * @returns {Number}\n     * @examples\n     * const point = map.coordToPoint(map.getCenter());\n     * // convert to point in gl zoom\n     * const glPoint = point.multi(this.getGLScale());\n     */\n    getGLScale(zoom) {\n        if (isNil(zoom)) {\n            zoom = this.getZoom();\n        }\n        return this._getResolution(zoom) / this._getResolution(this.getGLZoom());\n    }\n\n    /**\n     * zoom in\n     * @return {Map} this\n     */\n    zoomIn() {\n        return this.setZoom(this.getZoom() + 1);\n    }\n\n    /**\n     * zoom out\n     * @return {Map} this\n     */\n    zoomOut() {\n        return this.setZoom(this.getZoom() - 1);\n    }\n\n    /**\n     * Whether the map is zooming\n     * @return {Boolean}\n     */\n    isZooming() {\n        return !!this._zooming;\n    }\n\n    /**\n     * Whether the map is being interacted\n     * @return {Boolean}\n     */\n    isInteracting() {\n        return this.isZooming() || this.isMoving() || this.isRotating();\n    }\n\n    /**\n     * Sets the center and zoom at the same time.\n     * @param {Coordinate} center\n     * @param {Number} zoom\n     * @return {Map} this\n     */\n    setCenterAndZoom(center, zoom) {\n        if (!isNil(zoom) && this._zoomLevel !== zoom) {\n            this.setCenter(center);\n            this.setZoom(zoom, { animation : false });\n        } else {\n            this.setCenter(center);\n        }\n        return this;\n    }\n\n\n    /**\n     * Caculate the zoom level that contains the given extent with the maximum zoom level possible.\n     * @param {Extent} extent\n     * @return {Number} zoom fit for the extent\n     */\n    getFitZoom(extent) {\n        if (!extent || !(extent instanceof Extent)) {\n            return this._zoomLevel;\n        }\n        //It's a point\n        if (extent['xmin'] === extent['xmax'] && extent['ymin'] === extent['ymax']) {\n            return this.getMaxZoom();\n        }\n        const size = this.getSize();\n        const containerExtent = extent.convertTo(p => this.coordToContainerPoint(p));\n        const w = containerExtent.getWidth(),\n            h = containerExtent.getHeight();\n        const scaleX = size['width'] / w,\n            scaleY = size['height'] / h;\n        const scale = this.getSpatialReference().getZoomDirection() < 0 ?\n            Math.max(scaleX, scaleY) : Math.min(scaleX, scaleY);\n        const zoom = this.getZoomForScale(scale);\n        return zoom;\n    }\n\n    /**\n     * Get map's current view (center/zoom/pitch/bearing)\n     * @return {Object} { center : *, zoom : *, pitch : *, bearing : * }\n     */\n    getView() {\n        return {\n            'center' : this.getCenter().toArray(),\n            'zoom'  : this.getZoom(),\n            'pitch' : this.getPitch(),\n            'bearing' : this.getBearing()\n        };\n    }\n\n    /**\n     * Set map's center/zoom/pitch/bearing at one time\n     * @param {Object} view - a object containing center/zoom/pitch/bearing\n     * return {Map} this\n     */\n    setView(view) {\n        if (!view) {\n            return this;\n        }\n        if (view['center']) {\n            this.setCenter(view['center']);\n        }\n        if (view['zoom'] !== null && !isNaN(+view['zoom'])) {\n            this.setZoom(+view['zoom'], { 'animation' : false });\n        }\n        if (view['pitch'] !== null && !isNaN(+view['pitch'])) {\n            this.setPitch(+view['pitch']);\n        }\n        if (view['pitch'] !== null && !isNaN(+view['bearing'])) {\n            this.setBearing(+view['bearing']);\n        }\n        return this;\n    }\n\n    /**\n     * Get map's resolution\n     * @param {Number} zoom - zoom or current zoom if not given\n     * @return {Number} resolution\n     */\n    getResolution(zoom) {\n        return this._getResolution(zoom);\n    }\n\n    /**\n     * Get scale of resolutions from zoom to max zoom\n     * @param {Number} zoom - zoom or current zoom if not given\n     * @return {Number} scale\n     */\n    getScale(zoom) {\n        const z = (isNil(zoom) ? this.getZoom() : zoom);\n        const max = this._getResolution(this.getMaxNativeZoom()),\n            res = this._getResolution(z);\n        return res / max;\n    }\n\n    /**\n     * Set the map to be fit for the given extent with the max zoom level possible.\n     * @param  {Extent} extent - extent\n     * @param  {Number} zoomOffset - zoom offset\n     * @return {Map} - this\n     */\n    fitExtent(extent, zoomOffset, options = {}, step) {\n        if (!extent) {\n            return this;\n        }\n        extent = new Extent(extent, this.getProjection());\n        const zoom = this.getFitZoom(extent) + (zoomOffset || 0);\n        const center = extent.getCenter();\n        if (typeof (options['animation']) === 'undefined' || options['animation'])\n            return this.animateTo({\n                center,\n                zoom\n            }, {\n                'duration' : options['duration'] || this.options['zoomAnimationDuration'],\n                'easing' : options['easing'] || 'out',\n            }, step);\n        else\n            return this.setCenterAndZoom(center, zoom);\n    }\n\n    /**\n     * Get the base layer of the map.\n     * @return {Layer}\n     */\n    getBaseLayer() {\n        return this._baseLayer;\n    }\n\n    /**\n     * Sets a new base layer to the map.<br>\n     * Some events will be thrown such as baselayerchangestart, baselayerload, baselayerchangeend.\n     * @param  {Layer} baseLayer - new base layer\n     * @return {Map} this\n     * @fires Map#setbaselayer\n     * @fires Map#baselayerchangestart\n     * @fires Map#baselayerchangeend\n     */\n    setBaseLayer(baseLayer) {\n        let isChange = false;\n        if (this._baseLayer) {\n            isChange = true;\n            /**\n             * baselayerchangestart event, fired when base layer is changed.\n             *\n             * @event Map#baselayerchangestart\n             * @type {Object}\n             * @property {String} type - baselayerchangestart\n             * @property {Map} target - map\n             */\n            this._fireEvent('baselayerchangestart');\n            this._baseLayer.remove();\n        }\n        if (!baseLayer) {\n            delete this._baseLayer;\n            /**\n             * baselayerchangeend event, fired when base layer is changed.\n             *\n             * @event Map#baselayerchangeend\n             * @type {Object}\n             * @property {String} type - baselayerchangeend\n             * @property {Map} target - map\n             */\n            this._fireEvent('baselayerchangeend');\n            /**\n             * setbaselayer event, fired when base layer is set.\n             *\n             * @event Map#setbaselayer\n             * @type {Object}\n             * @property {String} type - setbaselayer\n             * @property {Map} target - map\n             */\n            this._fireEvent('setbaselayer');\n            return this;\n        }\n\n        this._baseLayer = baseLayer;\n        baseLayer._bindMap(this, -1);\n\n        function onbaseLayerload() {\n            /**\n             * baselayerload event, fired when base layer is loaded.\n             *\n             * @event Map#baselayerload\n             * @type {Object}\n             * @property {String} type - baselayerload\n             * @property {Map} target - map\n             */\n            this._fireEvent('baselayerload');\n            if (isChange) {\n                isChange = false;\n                this._fireEvent('baselayerchangeend');\n            }\n        }\n        this._baseLayer.on('layerload', onbaseLayerload, this);\n        if (this._loaded) {\n            this._baseLayer.load();\n        }\n        this._fireEvent('setbaselayer');\n        return this;\n    }\n\n    /**\n     * Remove the base layer from the map\n     * @return {Map} this\n     * @fires Map#baselayerremove\n     */\n    removeBaseLayer() {\n        if (this._baseLayer) {\n            this._baseLayer.remove();\n            delete this._baseLayer;\n            /**\n             * baselayerremove event, fired when base layer is removed.\n             *\n             * @event Map#baselayerremove\n             * @type {Object}\n             * @property {String} type - baselayerremove\n             * @property {Map} target - map\n             */\n            this._fireEvent('baselayerremove');\n        }\n        return this;\n    }\n\n    /**\n     * Get the layers of the map, except base layer (which should be by getBaseLayer). <br>\n     * A filter function can be given to filter layers, e.g. exclude all the VectorLayers.\n     * @param {Function} [filter=undefined] - a filter function of layers, return false to exclude the given layer.\n     * @return {Layer[]}\n     * @example\n     * var vectorLayers = map.getLayers(function (layer) {\n     *     return (layer instanceof VectorLayer);\n     * });\n     */\n    getLayers(filter) {\n        return this._getLayers(function (layer) {\n            if (layer === this._baseLayer || layer.getId().indexOf(INTERNAL_LAYER_PREFIX) >= 0) {\n                return false;\n            }\n            if (filter) {\n                return filter(layer);\n            }\n            return true;\n        });\n    }\n\n    /**\n     * Get the layer with the given id.\n     * @param  {String} id - layer id\n     * @return {Layer}\n     */\n    getLayer(id) {\n        if (!id) {\n            return null;\n        }\n        const layer =  this._layerCache ? this._layerCache[id] : null;\n        if (layer) {\n            return layer;\n        }\n        const baseLayer = this.getBaseLayer();\n        if (baseLayer && baseLayer.getId() === id) {\n            return baseLayer;\n        }\n        return null;\n    }\n\n    /**\n     * Add a new layer on the top of the map.\n     * @param  {Layer|Layer[]} layer - one or more layers to add\n     * @return {Map} this\n     * @fires Map#addlayer\n     */\n    addLayer(layers) {\n        if (!layers) {\n            return this;\n        }\n        if (!Array.isArray(layers)) {\n            layers = Array.prototype.slice.call(arguments, 0);\n            return this.addLayer(layers);\n        }\n        if (!this._layerCache) {\n            this._layerCache = {};\n        }\n        const mapLayers = this._layers;\n        for (let i = 0, len = layers.length; i < len; i++) {\n            const layer = layers[i];\n            const id = layer.getId();\n            if (isNil(id)) {\n                throw new Error('Invalid id for the layer: ' + id);\n            }\n            if (layer.getMap() === this) {\n                continue;\n            }\n            if (this._layerCache[id]) {\n                throw new Error('Duplicate layer id in the map: ' + id);\n            }\n            this._layerCache[id] = layer;\n            layer._bindMap(this);\n            mapLayers.push(layer);\n            if (this._loaded) {\n                layer.load();\n            }\n        }\n\n        this._sortLayersByZIndex();\n\n        /**\n         * addlayer event, fired when adding layers.\n         *\n         * @event Map#addlayer\n         * @type {Object}\n         * @property {String} type - addlayer\n         * @property {Map} target - map\n         * @property {Layer[]} layers - layers to add\n         */\n        this._fireEvent('addlayer', {\n            'layers': layers\n        });\n        return this;\n    }\n\n    /**\n     * Remove a layer from the map\n     * @param  {String|String[]|Layer|Layer[]} layer - one or more layers or layer ids\n     * @return {Map} this\n     * @fires Map#removelayer\n     */\n    removeLayer(layers) {\n        if (!layers) {\n            return this;\n        }\n        if (!Array.isArray(layers)) {\n            return this.removeLayer([layers]);\n        }\n        const removed = [];\n        for (let i = 0, len = layers.length; i < len; i++) {\n            let layer = layers[i];\n            if (!(layer instanceof Layer)) {\n                layer = this.getLayer(layer);\n            }\n            if (!layer) {\n                continue;\n            }\n            const map = layer.getMap();\n            if (!map || map !== this) {\n                continue;\n            }\n            removed.push(layer);\n            this._removeLayer(layer, this._layers);\n            if (this._loaded) {\n                layer._doRemove();\n            }\n            const id = layer.getId();\n            if (this._layerCache) {\n                delete this._layerCache[id];\n            }\n        }\n        if (removed.length > 0) {\n            this.once('frameend', () => {\n                removed.forEach(layer => {\n                    layer.fire('remove');\n                });\n            });\n        }\n        /**\n         * removelayer event, fired when removing layers.\n         *\n         * @event Map#removelayer\n         * @type {Object}\n         * @property {String} type - removelayer\n         * @property {Map} target - map\n         * @property {Layer[]} layers - layers to remove\n         */\n        this._fireEvent('removelayer', {\n            'layers': layers\n        });\n        return this;\n    }\n\n    /**\n     * Sort layers according to the order provided, the last will be on the top.\n     * @param  {string[]|Layer[]} layers - layers or layer ids to sort\n     * @return {Map} this\n     * @example\n     * map.addLayer([layer1, layer2, layer3]);\n     * map.sortLayers([layer2, layer3, layer1]);\n     * map.sortLayers(['3', '2', '1']); // sort by layer ids.\n     */\n    sortLayers(layers) {\n        if (!layers || !Array.isArray(layers)) {\n            return this;\n        }\n        const layersToOrder = [];\n        let minZ = Number.MAX_VALUE;\n        for (let i = 0, l = layers.length; i < l; i++) {\n            let layer = layers[i];\n            if (isString(layers[i])) {\n                layer = this.getLayer(layer);\n            }\n            if (!(layer instanceof Layer) || !layer.getMap() || layer.getMap() !== this) {\n                throw new Error('It must be a layer added to this map to order.');\n            }\n            if (layer.getZIndex() < minZ) {\n                minZ = layer.getZIndex();\n            }\n            layersToOrder.push(layer);\n        }\n        for (let i = 0, l = layersToOrder.length; i < l; i++) {\n            layersToOrder[i].setZIndex(minZ + i);\n        }\n\n        return this;\n    }\n\n    /**\n     * Exports image from the map's canvas.\n     * @param {Object} [options=undefined] - options\n     * @param {String} [options.mimeType=image/png] - mime type of the image\n     * @param {Boolean} [options.save=false] - whether pop a file save dialog to save the export image.\n     * @param {String} [options.fileName=export] - specify the file name, if options.save is true.\n     * @return {String} image of base64 format.\n     */\n    toDataURL(options) {\n        if (!options) {\n            options = {};\n        }\n        let mimeType = options['mimeType'];\n        if (!mimeType) {\n            mimeType = 'image/png';\n        }\n        const save = options['save'];\n        const renderer = this._getRenderer();\n        if (renderer && renderer.toDataURL) {\n            let file = options['fileName'];\n            if (!file) {\n                file = 'export';\n            }\n            const dataURL = renderer.toDataURL(mimeType);\n            if (save && dataURL) {\n                let imgURL;\n                if (typeof Blob !== 'undefined' && typeof atob !== 'undefined') {\n                    const blob = b64toBlob(dataURL.replace(/^data:image\\/(png|jpeg|jpg);base64,/, ''), mimeType);\n                    imgURL = URL.createObjectURL(blob);\n                } else {\n                    imgURL = dataURL;\n                }\n                const dlLink = document.createElement('a');\n                dlLink.download = file;\n                dlLink.href = imgURL;\n\n                document.body.appendChild(dlLink);\n                dlLink.click();\n                document.body.removeChild(dlLink);\n            }\n            return dataURL;\n        }\n        return null;\n    }\n\n\n    /**\n     * Converts a coordinate to the 2D point in current zoom or in the specific zoom. <br>\n     * The 2D point's coordinate system's origin is the same with map's origin.\n     * Usually used in plugin development.\n     * @param  {Coordinate} coordinate - coordinate\n     * @param  {Number} [zoom=undefined]       - zoom level\n     * @return {Point}  2D point\n     * @example\n     * var point = map.coordinateToPoint(new Coordinate(121.3, 29.1));\n     */\n    coordinateToPoint(coordinate, zoom) {\n        const prjCoord = this.getProjection().project(coordinate);\n        return this._prjToPoint(prjCoord, zoom);\n    }\n\n    /**\n     * shorter alias for coordinateToPoint\n     */\n    coordToPoint(coordinate, zoom) {\n        return this.coordinateToPoint(coordinate, zoom);\n    }\n\n    /**\n     * Converts a 2D point in current zoom or a specific zoom to a coordinate.\n     * Usually used in plugin development.\n     * @param  {Point} point - 2D point\n     * @param  {Number} zoom  - point's zoom level\n     * @return {Coordinate} coordinate\n     * @example\n     * var coord = map.pointToCoordinate(new Point(4E6, 3E4));\n     */\n    pointToCoordinate(point, zoom) {\n        const prjCoord = this._pointToPrj(point, zoom);\n        return this.getProjection().unproject(prjCoord);\n    }\n\n    /**\n     * shorter alias for pointToCoordinate\n     */\n    pointToCoord(point, zoom) {\n        return this.pointToCoordinate(point, zoom);\n    }\n\n    /**\n     * Converts a geographical coordinate to view point.<br>\n     * A view point is a point relative to map's mapPlatform panel's position. <br>\n     * Usually used in plugin development.\n     * @param {Coordinate} coordinate\n     * @return {Point}\n     */\n    coordinateToViewPoint(coordinate) {\n        return this._prjToViewPoint(this.getProjection().project(coordinate));\n    }\n\n    /**\n     * shorter alias for coordinateToViewPoint\n     */\n    coordToViewPoint(coordinate) {\n        return this.coordinateToViewPoint(coordinate);\n    }\n\n    /**\n     * Converts a view point to the geographical coordinate.\n     * Usually used in plugin development.\n     * @param {Point} viewPoint\n     * @return {Coordinate}\n     */\n    viewPointToCoordinate(viewPoint) {\n        return this.getProjection().unproject(this._viewPointToPrj(viewPoint));\n    }\n\n    /**\n     * shorter alias for viewPointToCoordinate\n     */\n    viewPointToCoord(viewPoint) {\n        return this.viewPointToCoordinate(viewPoint);\n    }\n\n    /**\n     * Convert a geographical coordinate to the container point. <br>\n     *  A container point is a point relative to map container's top-left corner. <br>\n     * @param {Coordinate}                - coordinate\n     * @param  {Number} [zoom=undefined]  - zoom level\n     * @return {Point}\n     */\n    coordinateToContainerPoint(coordinate, zoom) {\n        const pCoordinate = this.getProjection().project(coordinate);\n        return this._prjToContainerPoint(pCoordinate, zoom);\n    }\n\n    /**\n     * shorter alias for coordinateToContainerPoint\n     */\n    coordToContainerPoint(coordinate, zoom) {\n        return this.coordinateToContainerPoint(coordinate, zoom);\n    }\n\n    /**\n     * Converts a container point to geographical coordinate.\n     * @param {Point}\n     * @return {Coordinate}\n     */\n    containerPointToCoordinate(containerPoint) {\n        const pCoordinate = this._containerPointToPrj(containerPoint);\n        return this.getProjection().unproject(pCoordinate);\n    }\n\n    /**\n     * shorter alias for containerPointToCoordinate\n     */\n    containerPointToCoord(containerPoint) {\n        return this.containerPointToCoordinate(containerPoint);\n    }\n\n    /**\n     * Converts a container point to the view point.\n     * Usually used in plugin development.\n     * @param {Point}\n     * @returns {Point}\n     */\n    containerPointToViewPoint(containerPoint) {\n        return containerPoint.sub(this.getViewPoint());\n    }\n\n    /**\n     * Converts a view point to the container point.\n     * Usually used in plugin development.\n     * @param {Point}\n     * @returns {Point}\n     */\n    viewPointToContainerPoint(viewPoint) {\n        return viewPoint.add(this.getViewPoint());\n    }\n\n    /**\n     * Converts a container point extent to the geographic extent.\n     * @param  {PointExtent} containerExtent - containeproints extent\n     * @return {Extent}  geographic extent\n     */\n    containerToExtent(containerExtent) {\n        const extent2D = new PointExtent(\n            this._containerPointToPoint(containerExtent.getMin()),\n            this._containerPointToPoint(containerExtent.getMax())\n        );\n        return this._pointToExtent(extent2D);\n    }\n\n    /**\n     * Checks if the map container size changed and updates the map if so.\n     * @return {Map} this\n     * @fires Map#resize\n     */\n    checkSize() {\n        const justStart = ((now() - this._initTime) < 1500) && this.width === 0 || this.height === 0;\n\n        const watched = this._getContainerDomSize(),\n            oldHeight = this.height,\n            oldWidth = this.width;\n        if (watched['width'] === oldWidth && watched['height'] === oldHeight) {\n            return this;\n        }\n        const center = this.getCenter();\n        this._updateMapSize(watched);\n\n        if (!this.options['fixCenterOnResize']) {\n            const resizeOffset = new Point((oldWidth - watched.width) / 2, (oldHeight - watched.height) / 2);\n            this._offsetCenterByPixel(resizeOffset);\n            // when size changed, center is updated but panel's offset remains.\n            this._mapViewCoord = this._getPrjCenter();\n        }\n\n        const hided = (watched['width'] === 0 ||  watched['height'] === 0 || oldWidth === 0 || oldHeight === 0);\n\n        if (justStart || hided) {\n            this._noEvent = true;\n            this.setCenter(center);\n            delete this._noEvent;\n        }\n        /**\n         * resize event when map container's size changes\n         * @event Map#resize\n         * @type {Object}\n         * @property {String} type - resize\n         * @property {Map} target - map fires the event\n         */\n        this._fireEvent('resize');\n\n        return this;\n    }\n\n    /**\n     * Converts geographical distances to the pixel length.<br>\n     * The value varis with difference zoom level.\n     *\n     * @param  {Number} xDist - distance on X axis.\n     * @param  {Number} yDist - distance on Y axis.\n     * @return {Size} result.width: pixel length on X axis; result.height: pixel length on Y axis\n     */\n    distanceToPixel(xDist, yDist, zoom) {\n        const projection = this.getProjection();\n        if (!projection) {\n            return null;\n        }\n        const scale = this.getScale() / this.getScale(zoom);\n        const center = this.getCenter(),\n            target = projection.locate(center, xDist, yDist);\n        const p0 = this.coordToContainerPoint(center),\n            p1 = this.coordToContainerPoint(target);\n        p1._sub(p0)._multi(scale)._abs();\n        return new Size(p1.x, p1.y);\n    }\n\n    /**\n     * Converts geographical distances to the 2d point length.<br>\n     * The value varis with difference zoom level.\n     *\n     * @param  {Number} xDist - distance on X axis.\n     * @param  {Number} yDist - distance on Y axis.\n     * @param  {Number} zoom - point's zoom\n     * @return {Point}\n     */\n    distanceToPoint(xDist, yDist, zoom) {\n        const projection = this.getProjection();\n        if (!projection) {\n            return null;\n        }\n        const center = this.getCenter(),\n            target = projection.locate(center, xDist, yDist);\n        const p0 = this.coordToPoint(center, zoom),\n            p1 = this.coordToPoint(target, zoom);\n        p1._sub(p0)._abs();\n        return p1;\n    }\n\n    /**\n     * Converts pixel size to geographical distance.\n     *\n     * @param  {Number} width - pixel width\n     * @param  {Number} height - pixel height\n     * @return {Number}  distance - Geographical distance\n     */\n    pixelToDistance(width, height) {\n        const projection = this.getProjection();\n        if (!projection) {\n            return null;\n        }\n        const fullExt = this.getFullExtent();\n        const d = fullExt['top'] > fullExt['bottom'] ? -1 : 1;\n        const target = new Point(this.width / 2 + width, this.height / 2 + d * height);\n        const coord = this.containerPointToCoord(target);\n        return projection.measureLength(this.getCenter(), coord);\n    }\n\n    /**\n     * Converts 2d point distances to geographic length.<br>\n     *\n     * @param  {Number} dx - distance on X axis.\n     * @param  {Number} dy - distance on Y axis.\n     * @param  {Number} zoom - point's zoom\n     * @return {Number} distance\n     */\n    pointToDistance(dx, dy, zoom) {\n        const projection = this.getProjection();\n        if (!projection) {\n            return null;\n        }\n        const c = this._prjToPoint(this._getPrjCenter(), zoom);\n        c._add(dx, dy);\n        const target = this.pointToCoord(c, zoom);\n        return projection.measureLength(this.getCenter(), target);\n    }\n\n    /**\n     * Computes the coordinate from the given meter distance.\n     * @param  {Coordinate} coordinate - source coordinate\n     * @param  {Number} dx           - meter distance on X axis\n     * @param  {Number} dy           - meter distance on Y axis\n     * @return {Coordinate} Result coordinate\n     */\n    locate(coordinate, dx, dy) {\n        return this.getProjection()._locate(new Coordinate(coordinate), dx, dy);\n    }\n\n    /**\n     * Computes the coordinate from the given pixel distance.\n     * @param  {Coordinate} coordinate - source coordinate\n     * @param  {Number} px           - pixel distance on X axis\n     * @param  {Number} py           - pixel distance on Y axis\n     * @return {Coordinate} Result coordinate\n     */\n    locateByPoint(coordinate, px, py) {\n        const point = this.coordToContainerPoint(coordinate);\n        return this.containerPointToCoord(point._add(px, py));\n    }\n\n    /**\n     * Return map's main panel\n     * @returns {HTMLElement}\n     */\n    getMainPanel() {\n        return this._getRenderer().getMainPanel();\n    }\n\n    /**\n     * Returns map panels.\n     * @return {Object}\n     */\n    getPanels() {\n        return this._panels;\n    }\n\n    /**\n     * Remove the map\n     * @return {Map} this\n     */\n    remove() {\n        if (this.isRemoved()) {\n            return this;\n        }\n        this._fireEvent('removestart');\n        this._removeDomEvents();\n        this._clearHandlers();\n        this.removeBaseLayer();\n        const layers = this.getLayers();\n        for (let i = 0; i < layers.length; i++) {\n            layers[i].remove();\n        }\n        if (this._getRenderer()) {\n            this._getRenderer().remove();\n        }\n        if (this._containerDOM.innerHTML) {\n            this._containerDOM.innerHTML = '';\n        }\n        delete this._panels;\n        delete this._containerDOM;\n        delete this.renderer;\n        this._fireEvent('removeend');\n        this._clearAllListeners();\n        return this;\n    }\n\n    /**\n     * whether the map is removed\n     * @return {Boolean}\n     */\n    isRemoved() {\n        return !this._containerDOM;\n    }\n\n    /**\n     * Whether the map is moving\n     * @return {Boolean}\n     */\n    isMoving() {\n        return !!this._moving;\n    }\n\n    /**\n     * The callback function when move started\n     * @private\n     * @fires Map#movestart\n     */\n    onMoveStart(param) {\n        this._originCenter = this.getCenter();\n        this._moving = true;\n        this._trySetCursor('move');\n        /**\n         * movestart event\n         * @event Map#movestart\n         * @type {Object}\n         * @property {String} type - movestart\n         * @property {Map} target - map fires the event\n         * @property {Coordinate} coordinate - coordinate of the event\n         * @property {Point} containerPoint  - container point of the event\n         * @property {Point} viewPoint       - view point of the event\n         * @property {Event} domEvent                 - dom event\n         */\n        this._fireEvent('movestart', this._parseEvent(param ? param['domEvent'] : null, 'movestart'));\n    }\n\n    onMoving(param) {\n        /**\n         * moving event\n         * @event Map#moving\n         * @type {Object}\n         * @property {String} type - moving\n         * @property {Map} target - map fires the event\n         * @property {Coordinate} coordinate - coordinate of the event\n         * @property {Point} containerPoint  - container point of the event\n         * @property {Point} viewPoint       - view point of the event\n         * @property {Event} domEvent                 - dom event\n         */\n        this._fireEvent('moving', this._parseEvent(param ? param['domEvent'] : null, 'moving'));\n    }\n\n    onMoveEnd(param) {\n        this._moving = false;\n        this._trySetCursor('default');\n        /**\n         * moveend event\n         * @event Map#moveend\n         * @type {Object}\n         * @property {String} type - moveend\n         * @property {Map} target - map fires the event\n         * @property {Coordinate} coordinate - coordinate of the event\n         * @property {Point} containerPoint  - container point of the event\n         * @property {Point} viewPoint       - view point of the event\n         * @property {Event} domEvent                 - dom event\n         */\n        this._fireEvent('moveend',  (param && param['domEvent']) ? this._parseEvent(param['domEvent'], 'moveend') : param);\n        if (!this._verifyExtent(this.getCenter())) {\n            let moveTo = this._originCenter;\n            if (!this._verifyExtent(moveTo)) {\n                moveTo = this.getMaxExtent().getCenter();\n            }\n            this.panTo(moveTo);\n        }\n    }\n\n    onDragRotateStart(param) {\n        this._dragRotating = true;\n        /**\n         * dragrotatestart event\n         * @event Map#dragrotatestart\n         * @type {Object}\n         * @property {String} type - dragrotatestart\n         * @property {Map} target - map fires the event\n         * @property {Coordinate} coordinate - coordinate of the event\n         * @property {Point} containerPoint  - container point of the event\n         * @property {Point} viewPoint       - view point of the event\n         * @property {Event} domEvent                 - dom event\n         */\n        this._fireEvent('dragrotatestart', this._parseEvent(param ? param['domEvent'] : null, 'dragrotatestart'));\n    }\n\n    onDragRotating(param) {\n        /**\n         * dragrotating event\n         * @event Map#dragrotating\n         * @type {Object}\n         * @property {String} type - dragrotating\n         * @property {Map} target - map fires the event\n         * @property {Coordinate} coordinate - coordinate of the event\n         * @property {Point} containerPoint  - container point of the event\n         * @property {Point} viewPoint       - view point of the event\n         * @property {Event} domEvent                 - dom event\n         */\n        this._fireEvent('dragrotating', this._parseEvent(param ? param['domEvent'] : null, 'dragrotating'));\n    }\n\n    onDragRotateEnd(param) {\n        this._dragRotating = false;\n        /**\n         * dragrotateend event\n         * @event Map#dragrotateend\n         * @type {Object}\n         * @property {String} type - dragrotateend\n         * @property {Map} target - map fires the event\n         * @property {Coordinate} coordinate - coordinate of the event\n         * @property {Point} containerPoint  - container point of the event\n         * @property {Point} viewPoint       - view point of the event\n         * @property {Event} domEvent                 - dom event\n         */\n        this._fireEvent('dragrotateend', this._parseEvent(param ? param['domEvent'] : null, 'dragrotateend'));\n    }\n\n    isDragRotating() {\n        return !!this._dragRotating;\n    }\n\n    getRenderer() {\n        return this._getRenderer();\n    }\n\n    /**\n     * Get device's devicePixelRatio, you can override it by setting devicePixelRatio in options.\n     * @returns {Number}\n     */\n    getDevicePixelRatio() {\n        return this.options['devicePixelRatio'] || Math.ceil(Browser.devicePixelRatio) || 1;\n    }\n\n    //-----------------------------------------------------------\n\n    _initContainer(container) {\n        if (isString(container)) {\n            this._containerDOM = document.getElementById(container);\n            if (!this._containerDOM) {\n                throw new Error('Invalid container when creating map: \\'' + container + '\\'');\n            }\n        } else {\n            this._containerDOM = container;\n            if (IS_NODE) {\n                //Reserve container's constructor in node for canvas creating.\n                this.CanvasClass = this._containerDOM.constructor;\n            }\n        }\n\n        if (this._containerDOM.childNodes && this._containerDOM.childNodes.length > 0) {\n            if (this._containerDOM.childNodes[0].className === 'maptalks-wrapper') {\n                throw new Error('Container is already loaded with another map instance, use map.remove() to clear it.');\n            }\n        }\n    }\n\n    /**\n     * try to change cursor when map is not setCursored\n     * @private\n     * @param  {String} cursor css cursor\n     */\n    _trySetCursor(cursor) {\n        if (!this._cursor && !this._priorityCursor) {\n            if (!cursor) {\n                cursor = 'default';\n            }\n            this._setCursorToPanel(cursor);\n        }\n        return this;\n    }\n\n    _setPriorityCursor(cursor) {\n        if (!cursor) {\n            let hasCursor = false;\n            if (this._priorityCursor) {\n                hasCursor = true;\n            }\n            delete this._priorityCursor;\n            if (hasCursor) {\n                this.setCursor(this._cursor);\n            }\n        } else {\n            this._priorityCursor = cursor;\n            this._setCursorToPanel(cursor);\n        }\n        return this;\n    }\n\n    _setCursorToPanel(cursor) {\n        const panel = this.getMainPanel();\n        if (panel && panel.style && panel.style.cursor !== cursor) {\n            panel.style.cursor = cursor;\n        }\n    }\n\n    /**\n     * Get map's extent in view points.\n     * @param {Number} zoom - zoom\n     * @return {PointExtent}\n     * @private\n     */\n    _get2DExtent(zoom, out) {\n        let cached;\n        if ((zoom === undefined || zoom === this._zoomLevel) && this._mapExtent2D) {\n            cached = this._mapExtent2D;\n        } else if (zoom === this.getGLZoom() && this._mapGlExtent2D) {\n            cached = this._mapGlExtent2D;\n        }\n        if (cached) {\n            if (out) {\n                out.set(cached['xmin'], cached['ymin'], cached['xmax'], cached['ymax']);\n                return out;\n            }\n            return cached.copy();\n        }\n        const cExtent = this.getContainerExtent();\n        return cExtent.convertTo(c => this._containerPointToPoint(c, zoom, TEMP_POINT), out);\n    }\n\n    /**\n     * Converts a view point extent to the geographic extent.\n     * @param  {PointExtent} extent2D - view points extent\n     * @return {Extent}  geographic extent\n     * @protected\n     */\n    _pointToExtent(extent2D) {\n        const min2d = extent2D.getMin(),\n            max2d = extent2D.getMax();\n        const fullExtent = this.getFullExtent();\n        const [minx, maxx] = (!fullExtent || fullExtent.left <= fullExtent.right) ? [min2d.x, max2d.x] : [max2d.x, min2d.x];\n        const [miny, maxy] = (!fullExtent || fullExtent.top > fullExtent.bottom) ? [max2d.y, min2d.y] : [min2d.y, max2d.y];\n        const min = new Coordinate(minx, miny),\n            max = new Coordinate(maxx, maxy);\n        return new Extent(\n            this.pointToCoord(min),\n            this.pointToCoord(max),\n            this.getProjection()\n        );\n    }\n\n    //remove a layer from the layerList\n    _removeLayer(layer, layerList) {\n        if (!layer || !layerList) {\n            return;\n        }\n        const index = layerList.indexOf(layer);\n        if (index > -1) {\n            layerList.splice(index, 1);\n        }\n    }\n\n    _sortLayersByZIndex() {\n        if (!this._layers) {\n            return;\n        }\n        for (let i = 0, l = this._layers.length; i < l; i++) {\n            this._layers[i]._order = i;\n        }\n        this._layers.sort(function (a, b) {\n            const c = a.getZIndex() - b.getZIndex();\n            if (c === 0) {\n                return a._order - b._order;\n            }\n            return c;\n        });\n    }\n\n\n    _fireEvent(eventName, param) {\n        if (this._noEvent) {\n            return;\n        }\n        //fire internal events at first\n        this.fire('_' + eventName, param);\n        this.fire(eventName, param);\n    }\n\n    _Load() {\n        this._resetMapStatus();\n        if (this.options['pitch']) {\n            this.setPitch(this.options['pitch']);\n            delete this.options['pitch'];\n        }\n        if (this.options['bearing']) {\n            this.setBearing(this.options['bearing']);\n            delete this.options['bearing'];\n        }\n        this._loadAllLayers();\n        this._getRenderer().onLoad();\n        this._loaded = true;\n        this._callOnLoadHooks();\n        this._initTime = now();\n    }\n\n    _initRenderer() {\n        const renderer = this.options['renderer'];\n        const clazz = Map.getRendererClass(renderer);\n        this._renderer = new clazz(this);\n        this._renderer.load();\n    }\n\n    _getRenderer() {\n        return this._renderer;\n    }\n\n    _loadAllLayers() {\n        function loadLayer(layer) {\n            if (layer) {\n                layer.load();\n            }\n        }\n        if (this._baseLayer) {\n            this._baseLayer.load();\n        }\n        this._eachLayer(loadLayer, this.getLayers());\n    }\n\n    /**\n     * Gets layers that fits for the filter\n     * @param  {fn} filter - filter function\n     * @return {Layer[]}\n     * @private\n     */\n    _getLayers(filter) {\n        const layers = this._baseLayer ? [this._baseLayer].concat(this._layers) : this._layers;\n        const result = [];\n        for (let i = 0; i < layers.length; i++) {\n            if (!filter || filter.call(this, layers[i])) {\n                result.push(layers[i]);\n            }\n        }\n        return result;\n    }\n\n    _eachLayer(fn) {\n        if (arguments.length < 2) {\n            return;\n        }\n        let layerLists = Array.prototype.slice.call(arguments, 1);\n        if (layerLists && !Array.isArray(layerLists)) {\n            layerLists = [layerLists];\n        }\n        let layers = [];\n        for (let i = 0, len = layerLists.length; i < len; i++) {\n            layers = layers.concat(layerLists[i]);\n        }\n        for (let j = 0, jlen = layers.length; j < jlen; j++) {\n            fn.call(fn, layers[j]);\n        }\n    }\n\n    _onLayerEvent(param) {\n        if (!param) {\n            return;\n        }\n        if (param['type'] === 'idchange') {\n            delete this._layerCache[param['old']];\n            this._layerCache[param['new']] = param['target'];\n        }\n    }\n\n    //Check and reset map's status when map's spatial reference is changed.\n    _resetMapStatus() {\n        let maxZoom = this.getMaxZoom(),\n            minZoom = this.getMinZoom();\n        const viewMaxZoom = this._spatialReference.getMaxZoom(),\n            viewMinZoom = this._spatialReference.getMinZoom();\n        if (isNil(maxZoom) || maxZoom === -1 || maxZoom > viewMaxZoom) {\n            this.setMaxZoom(viewMaxZoom);\n        }\n        if (isNil(minZoom) || minZoom === -1 || minZoom < viewMinZoom) {\n            this.setMinZoom(viewMinZoom);\n        }\n        maxZoom = this.getMaxZoom();\n        minZoom = this.getMinZoom();\n        if (maxZoom < minZoom) {\n            this.setMaxZoom(minZoom);\n        }\n        if (isNil(this._zoomLevel) || this._zoomLevel > maxZoom) {\n            this._zoomLevel = maxZoom;\n        }\n        if (this._zoomLevel < minZoom) {\n            this._zoomLevel = minZoom;\n        }\n        delete this._prjCenter;\n        const projection = this.getProjection();\n        this._prjCenter = projection.project(this._center);\n        this._calcMatrices();\n        const renderer = this._getRenderer();\n        if (renderer) {\n            renderer.resetContainer();\n        }\n    }\n\n    _getContainerDomSize() {\n        if (!this._containerDOM) {\n            return null;\n        }\n        const containerDOM = this._containerDOM;\n        let width, height;\n        if (!isNil(containerDOM.width) && !isNil(containerDOM.height)) {\n            width = containerDOM.width;\n            height = containerDOM.height;\n            const dpr = this.getDevicePixelRatio();\n            if (dpr !== 1 && containerDOM['layer']) {\n                //is a canvas tile of CanvasTileLayer\n                width /= dpr;\n                height /= dpr;\n            }\n        } else if (!isNil(containerDOM.clientWidth) && !isNil(containerDOM.clientHeight)) {\n            width = parseInt(containerDOM.clientWidth, 0);\n            height = parseInt(containerDOM.clientHeight, 0);\n        } else {\n            throw new Error('can not get size of container');\n        }\n        return new Size(width, height);\n    }\n\n    _updateMapSize(mSize) {\n        this.width = mSize['width'];\n        this.height = mSize['height'];\n        this._getRenderer().updateMapSize(mSize);\n        this._calcMatrices();\n        return this;\n    }\n\n    /**\n     * Gets projected center of the map\n     * @return {Coordinate}\n     * @private\n     */\n    _getPrjCenter() {\n        return this._prjCenter;\n    }\n\n    _setPrjCenter(pcenter) {\n        this._prjCenter = pcenter;\n        if (this.isInteracting() && !this.isMoving()) {\n            // when map is not moving, map's center is updated but map platform won't\n            // mapViewCoord needs to be synced\n            this._mapViewCoord = pcenter;\n        }\n        this._calcMatrices();\n    }\n\n    _setPrjCoordAtContainerPoint(coordinate, point) {\n        if (point.x === this.width / 2 && point.y === this.height / 2) {\n            return this;\n        }\n        const t = this._containerPointToPoint(point)._sub(this._prjToPoint(this._getPrjCenter()));\n        const pcenter = this._pointToPrj(this._prjToPoint(coordinate).sub(t));\n        this._setPrjCenter(pcenter);\n        return this;\n    }\n\n    _verifyExtent(center) {\n        if (!center) {\n            return false;\n        }\n        const maxExt = this.getMaxExtent();\n        if (!maxExt) {\n            return true;\n        }\n        return maxExt.contains(center);\n    }\n\n    /**\n     * Move map's center by pixels.\n     * @param  {Point} pixel - pixels to move, the relation between value and direction is as:\n     * -1,1 | 1,1\n     * ------------\n     *-1,-1 | 1,-1\n     * @private\n     * @returns {Coordinate} the new projected center.\n     */\n    _offsetCenterByPixel(pixel) {\n        const pos = new Point(this.width / 2 - pixel.x, this.height / 2 - pixel.y);\n        const pCenter = this._containerPointToPrj(pos);\n        this._setPrjCenter(pCenter);\n        return pCenter;\n    }\n\n    /**\n     * offset map panels.\n     *\n     * @param  {Point} offset - offset in pixel to move\n     * @return {Map} this\n     */\n    /**\n     * Gets map panel's current view point.\n     * @return {Point}\n     */\n    offsetPlatform(offset) {\n        if (!offset) {\n            return this._mapViewPoint;\n        } else {\n            this._getRenderer().offsetPlatform(offset);\n            this._mapViewCoord = this._getPrjCenter();\n            this._mapViewPoint = this._mapViewPoint.add(offset);\n            return this;\n        }\n    }\n\n    /**\n     * Get map's view point, adding in frame offset\n     * @return {Point} map view point\n     */\n    getViewPoint() {\n        const offset = this._getViewPointFrameOffset();\n        let panelOffset = this.offsetPlatform();\n        if (offset) {\n            panelOffset = panelOffset.add(offset);\n        }\n        return panelOffset;\n    }\n\n    /**\n     * When moving map, map's center is updated in real time, but platform will be moved in the next frame to keep syncing with other layers\n     * Get the offset in current frame and the next frame\n     * @return {Point} view point offset\n     * @private\n     */\n    _getViewPointFrameOffset() {\n        // when zooming, view point is not updated, and container is being transformed with matrix.\n        // so ignore the frame offset\n        if (this.isZooming()) {\n            return null;\n        }\n        const pcenter = this._getPrjCenter();\n        if (this._mapViewCoord && !this._mapViewCoord.equals(pcenter)) {\n            return this._prjToContainerPoint(this._mapViewCoord).sub(this._prjToContainerPoint(pcenter));\n        }\n        return null;\n    }\n\n    _resetMapViewPoint() {\n        this._mapViewPoint = new Point(0, 0);\n        // mapViewCoord is the proj coordinate of current view point\n        this._mapViewCoord = this._getPrjCenter();\n    }\n\n    /**\n     * Get map's current resolution\n     * @return {Number} resolution\n     * @private\n     */\n    _getResolution(zoom) {\n        if ((zoom === undefined || zoom === this._zoomLevel) && this._mapRes !== undefined) {\n            return this._mapRes;\n        } else if (zoom === this.getGLZoom() && this._mapGlRes !== undefined) {\n            return this._mapGlRes;\n        }\n        if (isNil(zoom)) {\n            zoom = this._zoomLevel;\n        }\n        return this._spatialReference.getResolution(zoom);\n    }\n\n    _getResolutions() {\n        return this._spatialReference.getResolutions();\n    }\n\n    /**\n     * Converts the projected coordinate to a 2D point in the specific zoom\n     * @param  {Coordinate} pCoord - projected Coordinate\n     * @param  {Number} zoom   - point's zoom level\n     * @return {Point} 2D point\n     * @private\n     */\n    _prjToPoint(pCoord, zoom, out) {\n        zoom = (isNil(zoom) ? this.getZoom() : zoom);\n        return this._spatialReference.getTransformation().transform(pCoord, this._getResolution(zoom), out);\n    }\n\n    /**\n     * Converts the 2D point to projected coordinate\n     * @param  {Point} point - 2D point\n     * @param  {Number} zoom   - point's zoom level\n     * @return {Coordinate} projected coordinate\n     * @private\n     */\n    _pointToPrj(point, zoom, out) {\n        zoom = (isNil(zoom) ? this.getZoom() : zoom);\n        return this._spatialReference.getTransformation().untransform(point, this._getResolution(zoom), out);\n    }\n\n    /**\n     * Convert point at zoom to point at current zoom\n     * @param  {Point} point point\n     * @param  {Number} zoom point's zoom\n     * @return {Point} point at current zoom\n     * @private\n     */\n    _pointToPoint(point, zoom, out) {\n        if (out) {\n            out.x = point.x;\n            out.y = point.y;\n        } else {\n            out = point.copy();\n        }\n        if (!isNil(zoom)) {\n            return out._multi(this._getResolution(zoom) / this._getResolution());\n        }\n        return out;\n    }\n\n    /**\n     * Convert point at current zoom to point at target zoom\n     * @param  {Point} point point\n     * @param  {Number} zoom target zoom\n     * @return {Point} point at current zoom\n     * @private\n     */\n    _pointToPointAtZoom(point, zoom, out) {\n        if (out) {\n            out.x = point.x;\n            out.y = point.y;\n        } else {\n            out = point.copy();\n        }\n        if (!isNil(zoom)) {\n            return out._multi(this._getResolution() / this._getResolution(zoom));\n        }\n        return out;\n    }\n\n    /**\n     * transform container point to geographical projected coordinate\n     *\n     * @param  {Point} containerPoint\n     * @return {Coordinate}\n     * @private\n     */\n    _containerPointToPrj(containerPoint, out) {\n        return this._pointToPrj(this._containerPointToPoint(containerPoint, undefined, out), undefined, out);\n    }\n\n    /**\n     * transform view point to geographical projected coordinate\n     * @param  {Point} viewPoint\n     * @return {Coordinate}\n     * @private\n     */\n    _viewPointToPrj(viewPoint) {\n        return this._containerPointToPrj(this.viewPointToContainerPoint(viewPoint));\n    }\n\n    /**\n     * transform geographical projected coordinate to container point\n     * @param  {Coordinate} pCoordinate\n     * @return {Point}\n     * @private\n     */\n    _prjToContainerPoint(pCoordinate, zoom) {\n        return this._pointToContainerPoint(this._prjToPoint(pCoordinate, zoom), zoom);\n    }\n\n    /**\n     * transform geographical projected coordinate to view point\n     * @param  {Coordinate} pCoordinate\n     * @return {Point}\n     * @private\n     */\n    _prjToViewPoint(pCoordinate) {\n        const containerPoint = this._prjToContainerPoint(pCoordinate);\n        return this._containerPointToViewPoint(containerPoint);\n    }\n\n    //destructive containerPointToViewPoint\n    _containerPointToViewPoint(containerPoint) {\n        if (!containerPoint) {\n            return null;\n        }\n        return containerPoint._sub(this.getViewPoint());\n    }\n\n    _viewPointToPoint(viewPoint, zoom) {\n        return this._containerPointToPoint(this.viewPointToContainerPoint(viewPoint), zoom);\n    }\n\n    _pointToViewPoint(point, zoom) {\n        return this._prjToViewPoint(this._pointToPrj(point, zoom));\n    }\n\n    /* eslint no-extend-native: 0 */\n    _callOnLoadHooks() {\n        const proto = Map.prototype;\n        if (!proto._onLoadHooks) {\n            return;\n        }\n        for (let i = 0, l = proto._onLoadHooks.length; i < l; i++) {\n            proto._onLoadHooks[i].call(this);\n        }\n    }\n}\n\nMap.mergeOptions(options);\n\nexport default Map;\n","import Handler from '../../handler/Handler';\nimport Map from '../Map';\n\nclass MapDoubleClickZoomHandler extends Handler {\n    addHooks() {\n        if (!this.target) {\n            return;\n        }\n        this.target.on('_dblclick', this._onDoubleClick, this);\n    }\n\n    removeHooks() {\n        if (!this.target) {\n            return;\n        }\n        this.target.off('_dblclick', this._onDoubleClick, this);\n    }\n\n    _onDoubleClick(param) {\n        const map = this.target;\n        if (map.options['doubleClickZoom']) {\n            const oldZoom = map.getZoom(),\n                zoom = param['domEvent']['shiftKey'] ? Math.ceil(oldZoom) - 1 : Math.floor(oldZoom) + 1;\n            map._zoomAnimation(zoom, param['containerPoint']);\n        }\n\n    }\n}\n\nMap.mergeOptions({\n    'doubleClickZoom': true\n});\n\nMap.addOnLoadHook('addHandler', 'doubleClickZoom', MapDoubleClickZoomHandler);\n\nexport default MapDoubleClickZoomHandler;\n","import { now } from '../../core/util';\nimport { preventDefault, getEventContainerPoint } from '../../core/util/dom';\nimport Handler from '../../handler/Handler';\nimport DragHandler from '../../handler/Drag';\nimport Point from '../../geo/Point';\nimport Map from '../Map';\n\nclass MapDragHandler extends Handler {\n    addHooks() {\n        const map = this.target;\n        if (!map) {\n            return;\n        }\n        const dom = map._panels.mapWrapper || map._containerDOM;\n        this._dragHandler = new DragHandler(dom, {\n            'cancelOn': this._cancelOn.bind(this),\n            'rightclick' : true\n        });\n        this._dragHandler.on('mousedown', this._onMouseDown, this)\n            .on('dragstart', this._onDragStart, this)\n            .on('dragging', this._onDragging, this)\n            .on('dragend', this._onDragEnd, this)\n            .enable();\n    }\n\n    removeHooks() {\n        this._dragHandler.off('mousedown', this._onMouseDown, this)\n            .off('dragstart', this._onDragStart, this)\n            .off('dragging', this._onDragging, this)\n            .off('dragend', this._onDragEnd, this);\n        this._dragHandler.remove();\n        delete this._dragHandler;\n    }\n\n    _cancelOn(domEvent) {\n        if (this.target.isZooming() || this._ignore(domEvent)) {\n            return true;\n        }\n        return false;\n    }\n\n    _ignore(param) {\n        if (!param) {\n            return false;\n        }\n        if (param.domEvent) {\n            param = param.domEvent;\n        }\n        return this.target._ignoreEvent(param);\n    }\n\n    _onMouseDown(param) {\n        delete this.startDragTime;\n        delete this._mode;\n        if (param.domEvent.button === 2 || param.domEvent.ctrlKey) {\n            if (this.target.options['dragRotate'] || this.target.options['dragPitch']) {\n                this._mode = 'rotatePitch';\n            }\n        } else if (this.target.options['dragPan']) {\n            this._mode = 'move';\n        }\n        this.target._stopAnim(this.target._animPlayer);\n        preventDefault(param['domEvent']);\n    }\n\n    _onDragStart(param) {\n        this.startDragTime = now();\n        if (this._mode === 'move') {\n            this._moveStart(param);\n        } else if (this._mode === 'rotatePitch') {\n            this._rotateStart(param);\n        }\n    }\n\n    _onDragging(param) {\n        const map = this.target;\n        if (map._isEventOutMap(param['domEvent'])) {\n            return;\n        }\n        if (this._mode === 'move') {\n            this._moving(param);\n        } else if (this._mode === 'rotatePitch') {\n            this._rotating(param);\n        }\n    }\n\n    _onDragEnd(param) {\n        if (this._mode === 'move') {\n            this._moveEnd(param);\n        } else if (this._mode === 'rotatePitch') {\n            this._rotateEnd(param);\n        }\n        delete this.startDragTime;\n        delete this.startBearing;\n    }\n\n    _start(param) {\n        this.preX = param['mousePos'].x;\n        this.preY = param['mousePos'].y;\n        this.startX = this.preX;\n        this.startY = this.preY;\n    }\n\n    _moveStart(param) {\n        this._start(param);\n        const map = this.target;\n        map.onMoveStart(param);\n        const p = getEventContainerPoint(map._getActualEvent(param.domEvent), map.getContainer());\n        this.startPrjCoord = map._containerPointToPrj(p);\n    }\n\n    _moving(param) {\n        if (!this.startDragTime) {\n            return;\n        }\n        const map = this.target;\n        const p = getEventContainerPoint(map._getActualEvent(param.domEvent), map.getContainer());\n        map._setPrjCoordAtContainerPoint(this.startPrjCoord, p);\n        map.onMoving(param);\n    }\n\n    _moveEnd(param) {\n        if (!this.startDragTime) {\n            return;\n        }\n        const map = this.target;\n        let t = now() - this.startDragTime;\n        const mx = param['mousePos'].x,\n            my = param['mousePos'].y;\n        const dx = mx - this.startX;\n        const dy = my - this.startY;\n\n        this._clear();\n\n        if (map.options['panAnimation'] && !param.interupted && map._verifyExtent(map.getCenter()) && t < 280 && Math.abs(dy) + Math.abs(dx) > 5) {\n            t = 5 * t * (Math.abs(dx) + Math.abs(dy)) / 500;\n            map.panBy(new Point(dx, dy), { 'duration' : t });\n        } else {\n            map.onMoveEnd(param);\n        }\n    }\n\n    _rotateStart(param) {\n        this._start(param);\n        delete this._rotateMode;\n        this.startBearing = this.target.getBearing();\n        this.target.onDragRotateStart(param);\n        this._db = 0;\n    }\n\n    _rotating(param) {\n        const map = this.target;\n        const mx = param['mousePos'].x,\n            my = param['mousePos'].y;\n        const prePitch = map.getPitch(),\n            preBearing = map.getBearing();\n        const dx = Math.abs(mx - this.preX),\n            dy = Math.abs(my - this.preY);\n\n        if (!this._rotateMode) {\n            if (map.options['dragRotatePitch']) {\n                this._rotateMode = 'rotate_pitch';\n            } else if (dx > dy) {\n                this._rotateMode = 'rotate';\n            } else if (dx < dy) {\n                this._rotateMode = 'pitch';\n            } else {\n                this._rotateMode = 'rotate';\n            }\n        }\n\n        if (this._rotateMode === 'pitch' && prePitch === 0 && dy < 10) {\n            return;\n        }\n\n        if (this._rotateMode.indexOf('rotate') >= 0 && map.options['dragRotate']) {\n\n            let db = 0;\n            if (map.options['dragPitch'] || dx > dy) {\n                db = -0.6 * (this.preX - mx);\n            } else if (mx > map.width / 2) {\n                db = 0.6 * (this.preY - my);\n            } else {\n                db = -0.6 * (this.preY - my);\n            }\n            const bearing = map.getBearing() + db;\n            this._db = this._db || 0;\n            this._db += db;\n\n            map.setBearing(bearing);\n        }\n        if (this._rotateMode.indexOf('pitch') >= 0 && map.options['dragPitch']) {\n            map.setPitch(map.getPitch() + (this.preY - my) * 0.4);\n        }\n        this.preX = mx;\n        this.preY = my;\n        if (map.getBearing() !== preBearing || map.getPitch() !== prePitch) {\n            map.onDragRotating(param);\n        }\n    }\n\n    _rotateEnd(param) {\n        const map = this.target;\n        const bearing = map.getBearing();\n        this._clear();\n        const t = now() - this.startDragTime;\n        map.onDragRotateEnd(param);\n        if (Math.abs(bearing - this.startBearing) > 20 && (this._rotateMode === 'rotate' || this._rotateMode === 'rotate_pitch') && !param.interupted && t < 400) {\n            const bearing = map.getBearing();\n            map.animateTo({\n                'bearing' : bearing + this._db / 2\n            }, {\n                'easing'  : 'out',\n                'duration' : 800\n            });\n        }\n    }\n\n    _clear() {\n        delete this.startPrjCoord;\n        delete this.preX;\n        delete this.preY;\n        delete this.startX;\n        delete this.startY;\n    }\n}\n\nMap.mergeOptions({\n    'draggable': true,\n    'dragPan' : true,\n    'dragRotatePitch' : true,\n    'dragRotate' : true,\n    'dragPitch' : true\n});\n\nMap.addOnLoadHook('addHandler', 'draggable', MapDragHandler);\n\nexport default MapDragHandler;\n","import Point from '../../geo/Point';\n\n\nexport function clipLine(points, bounds, round, noCut) {\n    const parts = [];\n    let k = 0, segment;\n    for (let j = 0, l = points.length; j < l - 1; j++) {\n        segment = clipSegment(points[j], points[j + 1], bounds, j, round, noCut);\n\n        if (!segment) { continue; }\n\n        parts[k] = parts[k] || [];\n        parts[k].push({\n            'point' : segment[0],\n            'index' : j\n        });\n\n        // if segment goes out of screen, or it's the last one, it's the end of the line part\n        if ((segment[1] !== points[j + 1]) || (j === l - 2)) {\n            // parts[k].push(segment[1]);\n            parts[k].push({\n                'point' : segment[1],\n                'index' : j + 1\n            });\n            k++;\n        }\n    }\n    return parts;\n}\n\nlet _lastCode;\n\n// @function clipSegment(a: Point, b: Point, bounds: Bounds, useLastCode?: Boolean, round?: Boolean): Point[]|Boolean\n// Clips the segment a to b by rectangular bounds with the\n// [Cohen-Sutherland algorithm](https://en.wikipedia.org/wiki/Cohen%E2%80%93Sutherland_algorithm)\n// (modifying the segment points directly!). Used by Leaflet to only show polyline\n// points that are on the screen or near, increasing performance.\n// @copyright Leaflet\nexport function clipSegment(a, b, bounds, useLastCode, round, noCut) {\n    let codeA = useLastCode ? _lastCode : _getBitCode(a, bounds),\n        codeB = _getBitCode(b, bounds),\n\n        codeOut, p, newCode;\n\n    // save 2nd code to avoid calculating it on the next segment\n    _lastCode = codeB;\n\n    while (true) {\n        // if a,b is inside the clip window (trivial accept)\n        if (!(codeA | codeB)) {\n            return [a, b];\n        }\n\n        // if a,b is outside the clip window (trivial reject)\n        if (codeA & codeB) {\n            return false;\n        }\n\n        if (noCut) {\n            return [a, b];\n        }\n        // other cases\n        codeOut = codeA || codeB;\n        p = _getEdgeIntersection(a, b, codeOut, bounds, round);\n        newCode = _getBitCode(p, bounds);\n\n        if (codeOut === codeA) {\n            a = p;\n            codeA = newCode;\n        } else {\n            b = p;\n            codeB = newCode;\n        }\n    }\n}\n\n/* @function clipPolygon(points: Point[], bounds: Bounds, round?: Boolean): Point[]\n * Clips the polygon geometry defined by the given `points` by the given bounds (using the [Sutherland-Hodgeman algorithm](https://en.wikipedia.org/wiki/Sutherland%E2%80%93Hodgman_algorithm)).\n * Used by Leaflet to only show polygon points that are on the screen or near, increasing\n * performance. Note that polygon points needs different algorithm for clipping\n * than polyline, so there's a seperate method for it.\n * @copyright Leaflet\n */\nexport function clipPolygon(points, bounds, round) {\n    const edges = [1, 4, 2, 8];\n    let clippedPoints,\n        i, j, k,\n        a, b,\n        len, edge, p;\n\n    for (i = 0, len = points.length; i < len; i++) {\n        points[i]._code = _getBitCode(points[i], bounds);\n    }\n\n    // for each edge (left, bottom, right, top)\n    for (k = 0; k < 4; k++) {\n        edge = edges[k];\n        clippedPoints = [];\n\n        for (i = 0, len = points.length, j = len - 1; i < len; j = i++) {\n            a = points[i];\n            b = points[j];\n\n            // if a is inside the clip window\n            if (!(a._code & edge)) {\n                // if b is outside the clip window (a->b goes out of screen)\n                if (b._code & edge) {\n                    p = _getEdgeIntersection(b, a, edge, bounds, round);\n                    p._code = _getBitCode(p, bounds);\n                    clippedPoints.push(p);\n                }\n                clippedPoints.push(a);\n\n            // else if b is inside the clip window (a->b enters the screen)\n            } else if (!(b._code & edge)) {\n                p = _getEdgeIntersection(b, a, edge, bounds, round);\n                p._code = _getBitCode(p, bounds);\n                clippedPoints.push(p);\n            }\n        }\n        points = clippedPoints;\n    }\n\n    return points;\n}\n\n/**\n * caculate the distance from a point to a segment.\n * @param {Point} p\n * @param {Point} p1\n * @param {Point} p2\n * @return {Number} distance from p to (p1, p2)\n * @memberOf Util\n */\nexport function distanceToSegment(p, p1, p2) {\n    const x = p.x,\n        y = p.y,\n        x1 = p1.x,\n        y1 = p1.y,\n        x2 = p2.x,\n        y2 = p2.y;\n\n    const cross = (x2 - x1) * (x - x1) + (y2 - y1) * (y - y1);\n    if (cross <= 0) {\n        // P->P1\n        return Math.sqrt((x - x1) * (x - x1) + (y - y1) * (y - y1));\n    }\n    const d2 = (x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1);\n    if (cross >= d2) {\n        // P->P2\n        return Math.sqrt((x - x2) * (x - x2) + (y - y2) * (y - y2));\n    }\n    const r = cross / d2;\n    const px = x1 + (x2 - x1) * r;\n    const py = y1 + (y2 - y1) * r;\n    // P->P(px,py)\n    return Math.sqrt((x - px) * (x - px) + (y - py) * (y - py));\n}\n\n/**\n * Whether the coordinate is inside the polygon\n * @param {Polygon}         - polygon\n * @param {Coordinate}      - coordinate\n * @return {Boolean}\n * @memberOf Util\n */\nexport function pointInsidePolygon(p, points) {\n    let p1, p2;\n    const len = points.length;\n    let c = false;\n\n    for (let i = 0, j = len - 1; i < len; j = i++) {\n        p1 = points[i];\n        p2 = points[j];\n        if (((p1.y > p.y) !== (p2.y > p.y)) &&\n            (p.x < (p2.x - p1.x) * (p.y - p1.y) / (p2.y - p1.y) + p1.x)) {\n            c = !c;\n        }\n    }\n\n    return c;\n}\n\nfunction _getEdgeIntersection(a, b, code, bounds, round) {\n    const dx = b.x - a.x,\n        dy = b.y - a.y,\n        min = bounds.getMin(),\n        max = bounds.getMax();\n    let x, y;\n\n    if (code & 8) { // top\n        x = a.x + dx * (max.y - a.y) / dy;\n        y = max.y;\n\n    } else if (code & 4) { // bottom\n        x = a.x + dx * (min.y - a.y) / dy;\n        y = min.y;\n\n    } else if (code & 2) { // right\n        x = max.x;\n        y = a.y + dy * (max.x - a.x) / dx;\n\n    } else if (code & 1) { // left\n        x = min.x;\n        y = a.y + dy * (min.x - a.x) / dx;\n    }\n\n    const p = new Point(x, y);\n    if (round) {\n        p._round();\n    }\n    return p;\n}\n\nfunction _getBitCode(p, bounds) {\n    let code = 0;\n\n    if (p.x < bounds.getMin().x) { // left\n        code |= 1;\n    } else if (p.x > bounds.getMax().x) { // right\n        code |= 2;\n    }\n\n    if (p.y < bounds.getMin().y) { // bottom\n        code |= 4;\n    } else if (p.y > bounds.getMax().y) { // top\n        code |= 8;\n    }\n\n    return code;\n}\n\n/**\n * Is the point within an ellipse\n * @param {Point} point\n * @param {Point} center ellipse's center\n * @param {Point} southeast ellipse's southeast point\n * @param {Number} tolerance\n * @returns {Boolean}\n * @private\n * @memberOf Util\n */\nexport function withInEllipse(point, center, southeast, tolerance) {\n    point = new Point(point);\n    const a = Math.abs(southeast.x - center.x),\n        b = Math.abs(southeast.y - center.y),\n        c = Math.sqrt(Math.abs(a * a - b * b)),\n        xfocus = a >= b;\n    let f1, f2, d;\n    if (xfocus) {\n        f1 = new Point(center.x - c, center.y);\n        f2 = new Point(center.x + c, center.y);\n        d = a * 2;\n    } else {\n        f1 = new Point(center.x, center.y - c);\n        f2 = new Point(center.x, center.y + c);\n        d = b * 2;\n    }\n    /*\n    L1 + L2 = D\n    L1 + t >= L1'\n    L2 + t >= L2'\n    D + 2t >= L1' + L2'\n    */\n    return (point.distanceTo(f1) + point.distanceTo(f2)) <= (d + 2 * tolerance);\n}\n","import { COLOR_PROPERTIES } from '../../../core/Constants';\nimport { isString } from '../../../core/util';\n\n/**\n * @classdesc\n * Base class for all the symbolilzers\n * @class\n * @extends Class\n * @abstract\n * @private\n */\nclass Symbolizer {\n    getMap() {\n        return this.geometry.getMap();\n    }\n\n    getPainter() {\n        return this.painter;\n    }\n\n    /**\n     * Test if the property is a property related with coloring\n     * @param {String} prop - property name to test\n     * @static\n     * @function\n     * @return {Boolean}\n     * @memberof symbolizer.Symbolizer\n     */\n    static testColor(prop) {\n        if (!prop || !isString(prop)) {\n            return false;\n        }\n        if (COLOR_PROPERTIES.indexOf(prop) >= 0) {\n            return true;\n        }\n        return false;\n    }\n}\n\nexport default Symbolizer;\n","import { isNumber, extend } from '../../../core/util';\nimport { loadFunctionTypes } from '../../../core/mapbox';\nimport Symbolizer from './Symbolizer';\nimport Canvas from '../../../core/Canvas';\n\n/**\n * @classdesc\n * Base symbolizer class for all the symbolizers base on HTML5 Canvas2D\n * @abstract\n * @class\n * @private\n * @memberOf symbolizer\n * @name CanvasSymbolizer\n * @extends {Symbolizer}\n */\nclass CanvasSymbolizer extends Symbolizer {\n    _prepareContext(ctx) {\n        if (isNumber(this.symbol['opacity'])) {\n            if (ctx.globalAlpha !== this.symbol['opacity']) {\n                ctx.globalAlpha = this.symbol['opacity'];\n            }\n        } else if (ctx.globalAlpha !== 1) {\n            ctx.globalAlpha = 1;\n        }\n    }\n\n    prepareCanvas(ctx, style, resources) {\n        Canvas.prepareCanvas(ctx, style, resources, this.getPainter().isHitTesting());\n    }\n\n    remove() {}\n\n    setZIndex() {}\n\n    show() {}\n\n    hide() {}\n\n    _defineStyle(style) {\n        return function () {\n            const arr = [],\n                prop = {};\n            return loadFunctionTypes(style, () => {\n                const map = this.getMap();\n                return set(arr, map.getZoom(),\n                    extend({},\n                        this.geometry.getProperties(),\n                        setProp(prop, map.getBearing(), map.getPitch(), map.getZoom())\n                    )\n                );\n            });\n        }.bind(this)();\n    }\n}\n\nfunction set(arr, a0, a1) {\n    arr[0] = a0;\n    arr[1] = a1;\n    return arr;\n}\n\nfunction setProp(prop, b, p, z) {\n    prop['{bearing}'] = b;\n    prop['{pitch}'] = p;\n    prop['{zoom}'] = z;\n    return prop;\n}\n\nexport default CanvasSymbolizer;\n","import { computeDegree } from '../../../core/util';\nimport PointExtent from '../../../geo/PointExtent';\nimport CanvasSymbolizer from './CanvasSymbolizer';\n\n/**\n * @classdesc\n * Base symbolizer class for all the point type symbol styles.\n * @abstract\n * @class\n * @private\n * @memberOf symbolizer\n * @name PointSymbolizer\n * @extends {symbolizer.CanvasSymbolizer}\n */\nclass PointSymbolizer extends CanvasSymbolizer {\n\n    constructor(symbol, geometry, painter) {\n        super();\n        this.symbol = symbol;\n        this.geometry = geometry;\n        this.painter = painter;\n    }\n\n    get2DExtent() {\n        const map = this.getMap();\n        const glZoom = map.getGLZoom();\n        const extent = new PointExtent();\n        const renderPoints = this._getRenderPoints()[0];\n        for (let i = renderPoints.length - 1; i >= 0; i--) {\n            if (renderPoints[i]) {\n                extent._combine(map._pointToPoint(renderPoints[i], glZoom));\n            }\n        }\n        return extent;\n    }\n\n    _rotateExtent(fixedExtent, angle) {\n        return fixedExtent.convertTo(p => p._rotate(angle));\n    }\n\n    _getRenderPoints() {\n        const painter = this.getPainter();\n        const placement = painter.isSpriting() ? 'center' : this.getPlacement();\n        return this.getPainter().getRenderPoints(placement);\n    }\n\n    /**\n     * Get container points to draw on Canvas\n     * @return {Point[]}\n     */\n    _getRenderContainerPoints(ignoreAltitude) {\n        const painter = this.getPainter(),\n            points = this._getRenderPoints()[0];\n        if (painter.isSpriting()) {\n            return points;\n        }\n        const dxdy = this.getDxDy();\n        const cpoints = this.painter._pointContainerPoints(points, dxdy.x, dxdy.y, ignoreAltitude, true, this.getPlacement());\n        if (!cpoints || !Array.isArray(cpoints[0])) {\n            return cpoints;\n        }\n        const flat = [];\n        for (let i = 0, l = cpoints.length; i < l; i++) {\n            for (let ii = 0, ll = cpoints[i].length; ii < ll; ii++) {\n                flat.push(cpoints[i][ii]);\n            }\n        }\n        return flat;\n    }\n\n    _getRotationAt(i) {\n        let r = this.getRotation();\n        if (!r) {\n            r = 0;\n        }\n        const rotations = this._getRenderPoints()[1];\n        if (!rotations || !rotations[i]) {\n            return r;\n        }\n\n        const map = this.getMap();\n        let p0 = rotations[i][0], p1 = rotations[i][1];\n        if (map.isTransforming()) {\n            const maxZoom = map.getGLZoom();\n            p0 = map._pointToContainerPoint(rotations[i][0], maxZoom);\n            p1 = map._pointToContainerPoint(rotations[i][1], maxZoom);\n        }\n        return r + computeDegree(p0.x, p0.y, p1.x, p1.y);\n    }\n\n    _rotate(ctx, origin, rotation) {\n        if (rotation) {\n            const dxdy = this.getDxDy();\n            const p = origin.sub(dxdy);\n            ctx.save();\n            ctx.translate(p.x, p.y);\n            ctx.rotate(rotation);\n            return this.getDxDy();\n        }\n        return null;\n    }\n}\n\nexport default PointSymbolizer;\n","import { isNil, isNumber, isArrayHasData, getValueOrDefault, sign } from '../../../core/util';\nimport { isGradient, getGradientStamp } from '../../../core/util/style';\nimport { getAlignPoint } from '../../../core/util/strings';\nimport { hasFunctionDefinition } from '../../../core/mapbox';\nimport Size from '../../../geo/Size';\nimport Point from '../../../geo/Point';\nimport PointExtent from '../../../geo/PointExtent';\nimport Canvas from '../../../core/Canvas';\nimport PointSymbolizer from './PointSymbolizer';\n\nexport default class VectorMarkerSymbolizer extends PointSymbolizer {\n\n    static test(symbol) {\n        if (!symbol) {\n            return false;\n        }\n        if (isNil(symbol['markerFile']) && !isNil(symbol['markerType']) && (symbol['markerType'] !== 'path')) {\n            return true;\n        }\n        return false;\n    }\n\n    constructor(symbol, geometry, painter) {\n        super(symbol, geometry, painter);\n        this._dynamic = hasFunctionDefinition(symbol);\n        this.style = this._defineStyle(this.translate());\n        this.strokeAndFill = this._defineStyle(VectorMarkerSymbolizer.translateLineAndFill(this.style));\n        const lineWidth = this.strokeAndFill['lineWidth'];\n        if (lineWidth % 2 === 0) {\n            this.padding = 2;\n        } else {\n            this.padding = 1.5;\n        }\n    }\n\n    symbolize(ctx, resources) {\n        const style = this.style;\n        if (!this.painter.isHitTesting() && (style['markerWidth'] === 0 || style['markerHeight'] === 0 ||\n            (style['polygonOpacity'] === 0 && style['lineOpacity'] === 0))) {\n            return;\n        }\n        const cookedPoints = this._getRenderContainerPoints();\n        if (!isArrayHasData(cookedPoints)) {\n            return;\n        }\n        this._prepareContext(ctx);\n        if (this.getPainter().isSpriting() ||\n            this.geometry.getLayer().getMask() === this.geometry ||\n            this._dynamic ||\n            this.geometry.getLayer().options['cacheVectorOnCanvas'] === false) {\n            this._drawMarkers(ctx, cookedPoints, resources);\n        } else {\n            this._drawMarkersWithCache(ctx, cookedPoints, resources);\n        }\n\n    }\n\n    getDxDy() {\n        const s = this.style;\n        const dx = s['markerDx'],\n            dy = s['markerDy'];\n        return new Point(dx, dy);\n    }\n\n    _drawMarkers(ctx, cookedPoints, resources) {\n        const strokeAndFill = this.strokeAndFill;\n        const gradient = isGradient(strokeAndFill['lineColor']) || isGradient(strokeAndFill['polygonFill']);\n        if (!gradient) {\n            this.prepareCanvas(ctx, strokeAndFill, resources);\n        }\n        for (let i = cookedPoints.length - 1; i >= 0; i--) {\n            let point = cookedPoints[i];\n            const origin = this._rotate(ctx, point, this._getRotationAt(i));\n            if (origin) {\n                point = origin;\n            }\n\n            this._drawVectorMarker(ctx, point, resources);\n            if (origin) {\n                ctx.restore();\n            }\n        }\n    }\n\n    _drawMarkersWithCache(ctx, cookedPoints, resources) {\n        const stamp = this._stampSymbol();\n        let image = resources.getImage(stamp);\n        if (!image) {\n            image = this._createMarkerImage(ctx, resources);\n            resources.addResource([stamp, image.width, image.height], image);\n        }\n        const anchor = this._getAnchor(image.width, image.height);\n        for (let i = cookedPoints.length - 1; i >= 0; i--) {\n            let point = cookedPoints[i];\n            const origin = this._rotate(ctx, point, this._getRotationAt(i));\n            if (origin) {\n                point = origin;\n            }\n            Canvas.image(ctx, image, point.x + anchor.x, point.y + anchor.y);\n            if (origin) {\n                ctx.restore();\n            }\n        }\n    }\n\n    _calMarkerSize() {\n        if (!this._size) {\n            const lineWidth = this.strokeAndFill['lineWidth'],\n                shadow = 2 * (this.symbol['shadowBlur'] || 0), // add some tolerance for shadowOffsetX/Y\n                w = Math.round(this.style['markerWidth'] + lineWidth + 2 * shadow + this.padding * 2),\n                h = Math.round(this.style['markerHeight'] + lineWidth + 2 * shadow + this.padding * 2);\n            this._size = [w, h];\n        }\n        return this._size;\n    }\n\n    _createMarkerImage(ctx, resources) {\n        const canvasClass = ctx.canvas.constructor,\n            size = this._calMarkerSize(),\n            canvas = Canvas.createCanvas(size[0], size[1], canvasClass),\n            point = this._getCacheImageAnchor(size[0], size[1]);\n        const context = canvas.getContext('2d');\n        const gradient = isGradient(this.strokeAndFill['lineColor']) || isGradient(this.strokeAndFill['polygonFill']);\n        if (!gradient) {\n            this.prepareCanvas(context, this.strokeAndFill, resources);\n        }\n        this._drawVectorMarker(context, point, resources);\n        return canvas;\n    }\n\n    _stampSymbol() {\n        if (!this._stamp) {\n            this._stamp = [\n                this.style['markerType'],\n                isGradient(this.style['markerFill']) ? getGradientStamp(this.style['markerFill']) : this.style['markerFill'],\n                this.style['markerFillOpacity'],\n                this.style['markerFillPatternFile'],\n                isGradient(this.style['markerLineColor']) ? getGradientStamp(this.style['markerLineColor']) : this.style['markerLineColor'],\n                this.style['markerLineWidth'],\n                this.style['markerLineOpacity'],\n                this.style['markerLineDasharray'] ? this.style['markerLineDasharray'].join(',') : '',\n                this.style['markerLinePatternFile'],\n                this.style['markerWidth'],\n                this.style['markerHeight'],\n                this.style['markerHorizontalAlignment'],\n                this.style['markerVerticalAlignment']\n            ].join('_');\n        }\n        return this._stamp;\n    }\n\n    _getAnchor(w, h) {\n        const shadow = 2 * (this.symbol['shadowBlur'] || 0),\n            margin = shadow + this.padding;\n        const p = getAlignPoint(new Size(w, h), this.style['markerHorizontalAlignment'], this.style['markerVerticalAlignment']);\n        if (p.x !== -w  / 2) {\n            p.x -= sign(p.x + w / 2) * margin;\n        }\n        if (p.y !== -h / 2) {\n            p.y -= sign(p.y + h / 2) * margin;\n        }\n        return p;\n    }\n\n    _getCacheImageAnchor(w, h) {\n        const shadow = 2 * (this.symbol['shadowBlur'] || 0),\n            margin = shadow + this.padding;\n        const markerType = this.style['markerType'];\n        if (markerType === 'bar' || markerType === 'pie' || markerType === 'pin') {\n            return new Point(w / 2, h - margin);\n        } else if (markerType === 'rectangle') {\n            return new Point(margin, margin);\n        } else {\n            return new Point(w / 2, h / 2);\n        }\n    }\n\n    _getGraidentExtent(points) {\n        const e = new PointExtent(),\n            dxdy = this.getDxDy(),\n            m = this.getFixedExtent();\n        if (Array.isArray(points)) {\n            for (let i = points.length - 1; i >= 0; i--) {\n                e._combine(points[i]);\n            }\n        } else {\n            e._combine(points);\n        }\n        e['xmin'] += m['xmin'] - dxdy.x;\n        e['ymin'] += m['ymin'] - dxdy.y;\n        e['xmax'] += m['xmax'] - dxdy.x;\n        e['ymax'] += m['ymax'] - dxdy.y;\n        return e;\n    }\n\n    _drawVectorMarker(ctx, point, resources) {\n        const style = this.style,\n            strokeAndFill = this.strokeAndFill,\n            markerType = style['markerType'].toLowerCase(),\n            vectorArray = VectorMarkerSymbolizer._getVectorPoints(markerType, style['markerWidth'], style['markerHeight']),\n            lineOpacity = strokeAndFill['lineOpacity'],\n            fillOpacity = strokeAndFill['polygonOpacity'];\n        const gradient = isGradient(strokeAndFill['lineColor']) || isGradient(strokeAndFill['polygonFill']);\n        if (gradient) {\n            let gradientExtent;\n            if (isGradient(strokeAndFill['lineColor'])) {\n                gradientExtent = this._getGraidentExtent(point);\n                strokeAndFill['lineGradientExtent'] = gradientExtent.expand(strokeAndFill['lineWidth']);\n            }\n            if (isGradient(strokeAndFill['polygonFill'])) {\n                if (!gradientExtent) {\n                    gradientExtent = this._getGraidentExtent(point);\n                }\n                strokeAndFill['polygonGradientExtent'] = gradientExtent;\n            }\n            this.prepareCanvas(ctx, strokeAndFill, resources);\n        }\n\n\n        const width = style['markerWidth'],\n            height = style['markerHeight'],\n            hLineWidth = style['markerLineWidth'] / 2;\n        if (markerType === 'ellipse') {\n            //ellipse default\n            Canvas.ellipse(ctx, point, width / 2, height / 2, lineOpacity, fillOpacity);\n        } else if (markerType === 'cross' || markerType === 'x') {\n            for (let j = vectorArray.length - 1; j >= 0; j--) {\n                vectorArray[j]._add(point);\n            }\n            //线类型\n            Canvas.path(ctx, vectorArray.slice(0, 2), lineOpacity);\n            Canvas.path(ctx, vectorArray.slice(2, 4), lineOpacity);\n        } else if (markerType === 'diamond' || markerType === 'bar' || markerType === 'square' || markerType === 'rectangle' || markerType === 'triangle') {\n            if (markerType === 'bar') {\n                point = point.add(0, -hLineWidth);\n            } else if (markerType === 'rectangle') {\n                point = point.add(hLineWidth, hLineWidth);\n            }\n            for (let j = vectorArray.length - 1; j >= 0; j--) {\n                vectorArray[j]._add(point);\n            }\n            //面类型\n            Canvas.polygon(ctx, vectorArray, lineOpacity, fillOpacity);\n        } else if (markerType === 'pin') {\n            point = point.add(0, -hLineWidth);\n            for (let j = vectorArray.length - 1; j >= 0; j--) {\n                vectorArray[j]._add(point);\n            }\n            const lineCap = ctx.lineCap;\n            ctx.lineCap = 'round'; //set line cap to round to close the pin bottom\n            Canvas.bezierCurveAndFill(ctx, vectorArray, lineOpacity, fillOpacity);\n            ctx.lineCap = lineCap;\n        } else if (markerType === 'pie') {\n            point = point.add(0, hLineWidth);\n            const angle = Math.atan(width / 2 / height) * 180 / Math.PI;\n            const lineCap = ctx.lineCap;\n            ctx.lineCap = 'round';\n            Canvas.sector(ctx, point, height, [90 - angle, 90 + angle], lineOpacity, fillOpacity);\n            ctx.lineCap = lineCap;\n        } else {\n            throw new Error('unsupported markerType: ' + markerType);\n        }\n    }\n\n    getPlacement() {\n        return this.symbol['markerPlacement'];\n    }\n\n    getRotation() {\n        const r = this.style['markerRotation'];\n        if (!isNumber(r)) {\n            return null;\n        }\n        //to radian\n        return -r * Math.PI / 180;\n    }\n\n    getFixedExtent() {\n        const dxdy = this.getDxDy(),\n            padding = this.padding * 2;\n        const size = this._calMarkerSize().map(d => d - padding);\n        const alignPoint = this._getAnchor(size[0], size[1]);\n        let result = new PointExtent(dxdy.add(0, 0), dxdy.add(size[0], size[1]));\n        result._add(alignPoint);\n        const rotation = this.getRotation();\n        if (rotation) {\n            result = this._rotateExtent(result, rotation);\n        }\n\n        return result;\n    }\n\n    translate() {\n        const s = this.symbol;\n        const result = {\n            'markerType': getValueOrDefault(s['markerType'], 'ellipse'), //<----- ellipse | cross | x | triangle | diamond | square | bar | pin等,默认ellipse\n            'markerFill': getValueOrDefault(s['markerFill'], '#00f'), //blue as cartoCSS\n            'markerFillOpacity': getValueOrDefault(s['markerFillOpacity'], 1),\n            'markerFillPatternFile': getValueOrDefault(s['markerFillPatternFile'], null),\n            'markerLineColor': getValueOrDefault(s['markerLineColor'], '#000'), //black\n            'markerLineWidth': getValueOrDefault(s['markerLineWidth'], 1),\n            'markerLineOpacity': getValueOrDefault(s['markerLineOpacity'], 1),\n            'markerLineDasharray': getValueOrDefault(s['markerLineDasharray'], []),\n            'markerLinePatternFile': getValueOrDefault(s['markerLinePatternFile'], null),\n\n            'markerDx': getValueOrDefault(s['markerDx'], 0),\n            'markerDy': getValueOrDefault(s['markerDy'], 0),\n\n            'markerWidth': getValueOrDefault(s['markerWidth'], 10),\n            'markerHeight': getValueOrDefault(s['markerHeight'], 10),\n\n            'markerRotation' : getValueOrDefault(s['markerRotation'], 0)\n        };\n        const markerType = result['markerType'];\n        let ha, va;\n        if (markerType === 'bar' || markerType === 'pie' || markerType === 'pin') {\n            ha = 'middle';\n            va = 'top';\n        } else if (markerType === 'rectangle') {\n            ha = 'right';\n            va = 'bottom';\n        } else {\n            ha = 'middle';\n            va = 'middle';\n        }\n\n        result['markerHorizontalAlignment'] = getValueOrDefault(s['markerHorizontalAlignment'], ha); //left | middle | right\n        result['markerVerticalAlignment'] = getValueOrDefault(s['markerVerticalAlignment'], va); // top | middle | bottom\n\n        //markerOpacity覆盖fillOpacity和lineOpacity\n        if (isNumber(s['markerOpacity'])) {\n            if (isNumber(s['markerFillOpacity'])) {\n                result['markerFillOpacity'] *= s['markerOpacity'];\n            }\n            if (isNumber(s['markerLineOpacity'])) {\n                result['markerLineOpacity'] *= s['markerOpacity'];\n            }\n        }\n        return result;\n    }\n\n    static translateLineAndFill(s) {\n        const result = {\n            'lineColor': s['markerLineColor'],\n            'linePatternFile': s['markerLinePatternFile'],\n            'lineWidth': s['markerLineWidth'],\n            'lineOpacity': s['markerLineOpacity'],\n            'lineDasharray': s['markerLineDasharray'],\n            'lineCap': 'butt',\n            'lineJoin': 'round',\n            'polygonFill': s['markerFill'],\n            'polygonPatternFile': s['markerFillPatternFile'],\n            'polygonOpacity': s['markerFillOpacity']\n        };\n        if (result['lineWidth'] === 0) {\n            result['lineOpacity'] = 0;\n        }\n        return result;\n    }\n\n    static _getVectorPoints(markerType, width, height) {\n        //half height and half width\n        const hh = height / 2,\n            hw = width / 2;\n        const left = 0,\n            top = 0;\n        let v0, v1, v2, v3;\n        if (markerType === 'triangle') {\n            v0 = new Point(left, top - hh);\n            v1 = new Point(left - hw, top + hh);\n            v2 = new Point(left + hw, top + hh);\n            return [v0, v1, v2];\n        } else if (markerType === 'cross') {\n            v0 = new Point((left - hw), top);\n            v1 = new Point((left + hw), top);\n            v2 = new Point((left), (top - hh));\n            v3 = new Point((left), (top + hh));\n            return [v0, v1, v2, v3];\n        } else if (markerType === 'diamond') {\n            v0 = new Point((left - hw), top);\n            v1 = new Point(left, (top - hh));\n            v2 = new Point((left + hw), top);\n            v3 = new Point((left), (top + hh));\n            return [v0, v1, v2, v3];\n        } else if (markerType === 'square') {\n            v0 = new Point((left - hw), (top + hh));\n            v1 = new Point((left + hw), (top + hh));\n            v2 = new Point((left + hw), (top - hh));\n            v3 = new Point((left - hw), (top - hh));\n            return [v0, v1, v2, v3];\n        } else if (markerType === 'rectangle') {\n            v0 = new Point(left, top);\n            v1 = v0.add(width, 0);\n            v2 = v0.add(width, height);\n            v3 = v0.add(0, height);\n            return [v0, v1, v2, v3];\n        } else if (markerType === 'x') {\n            v0 = new Point(left - hw, top + hh);\n            v1 = new Point(left + hw, top - hh);\n            v2 = new Point(left + hw, top + hh);\n            v3 = new Point(left - hw, top - hh);\n            return [v0, v1, v2, v3];\n        } else if (markerType === 'bar') {\n            v0 = new Point((left - hw), (top - height));\n            v1 = new Point((left + hw), (top - height));\n            v2 = new Point((left + hw), top);\n            v3 = new Point((left - hw), top);\n            return [v0, v1, v2, v3];\n        } else if (markerType === 'pin') {\n            const extWidth = height * Math.atan(hw / hh);\n            v0 = new Point(left, top);\n            v1 = new Point(left - extWidth, top - height);\n            v2 = new Point(left + extWidth, top - height);\n            v3 = new Point(left, top);\n            return [v0, v1, v2, v3];\n        }\n        return [];\n    }\n}\n\n\n","import {\n    isNil\n} from '../../../core/util';\nimport Point from '../../../geo/Point';\nimport Canvas from '../../../core/Canvas';\nimport PointSymbolizer from './PointSymbolizer';\nimport VectorMarkerSymbolizer from './VectorMarkerSymbolizer';\n\nexport default class DebugSymbolizer extends PointSymbolizer {\n\n    getPlacement() {\n        return 'point';\n    }\n\n    getDxDy() {\n        return new Point(0, 0);\n    }\n\n    symbolize(ctx) {\n        const geometry = this.geometry,\n            layer = geometry.getLayer();\n        if (!geometry.options['debug'] && (layer && !layer.options['debug'])) {\n            return;\n        }\n        const map = this.getMap();\n        if (!map || map.isZooming()) {\n            return;\n        }\n        const color = layer.options['debugOutline'],\n            op = 1;\n        ctx.strokeStyle = color;\n        ctx.fillStyle = color;\n\n        //outline\n        const outline = this.getPainter().getContainerExtent().toArray();\n        Canvas.polygon(ctx, [outline], op, 0);\n\n        //center cross and id if have any.\n        const points = this._getRenderContainerPoints(),\n            id = this.geometry.getId(),\n            cross = VectorMarkerSymbolizer._getVectorPoints('cross', 10, 10);\n        for (let i = 0; i < points.length; i++) {\n            const p = points[i];\n            if (!isNil(id)) {\n                Canvas.fillText(ctx, id, p.x + 8, p.y - 4, color);\n            }\n            const c = [];\n            for (let ii = 0; ii < cross.length; ii++) {\n                c.push(cross[ii].add(p));\n            }\n            Canvas.path(ctx, c.slice(0, 2), op);\n            Canvas.path(ctx, c.slice(2, 4), op);\n        }\n    }\n\n}\n","import { isNil, isNumber, isArrayHasData, getValueOrDefault } from '../../../core/util';\nimport { getAlignPoint } from '../../../core/util/strings';\nimport Size from '../../../geo/Size';\nimport Point from '../../../geo/Point';\nimport PointExtent from '../../../geo/PointExtent';\nimport Canvas from '../../../core/Canvas';\nimport PointSymbolizer from './PointSymbolizer';\n\nexport default class ImageMarkerSymbolizer extends PointSymbolizer {\n\n    static test(symbol) {\n        if (!symbol) {\n            return false;\n        }\n        if (!isNil(symbol['markerFile'])) {\n            return true;\n        }\n        return false;\n    }\n\n    constructor(symbol, geometry, painter) {\n        super(symbol, geometry, painter);\n        this.style = this._defineStyle(this.translate());\n    }\n\n    symbolize(ctx, resources) {\n        const style = this.style;\n        if (!this.painter.isHitTesting() && (style['markerWidth'] === 0 || style['markerHeight'] === 0 || style['markerOpacity'] === 0)) {\n            return;\n        }\n        const cookedPoints = this._getRenderContainerPoints();\n        if (!isArrayHasData(cookedPoints)) {\n            return;\n        }\n\n        const img = this._getImage(resources);\n        if (!img) {\n            if (typeof console !== 'undefined') {\n                console.warn('no img found for ' + (this.style['markerFile'] || this._url[0]));\n            }\n            return;\n        }\n        this._prepareContext(ctx);\n        let width = style['markerWidth'];\n        let height = style['markerHeight'];\n        if (!isNumber(width) || !isNumber(height)) {\n            width = img.width;\n            height = img.height;\n            style['markerWidth'] = width;\n            style['markerHeight'] = height;\n            const imgURL = [style['markerFile'], style['markerWidth'], style['markerHeight']];\n            if (!resources.isResourceLoaded(imgURL)) {\n                resources.addResource(imgURL, img);\n            }\n            const painter = this.getPainter();\n            if (!painter.isSpriting()) {\n                painter.removeCache();\n            }\n        }\n        let alpha;\n        // for VectorPathMarkerSymbolizer, opacity is already set into SVG element.\n        if (this.symbol['markerType'] !== 'path' &&\n            isNumber(style['markerOpacity']) && style['markerOpacity'] < 1) {\n            alpha = ctx.globalAlpha;\n            ctx.globalAlpha *= style['markerOpacity'];\n        }\n        const alignPoint = getAlignPoint(new Size(width, height), style['markerHorizontalAlignment'], style['markerVerticalAlignment']);\n        for (let i = 0, len = cookedPoints.length; i < len; i++) {\n            let p = cookedPoints[i];\n            const origin = this._rotate(ctx, p, this._getRotationAt(i));\n            if (origin) {\n                p = origin;\n            }\n            Canvas.image(ctx, img,\n                p.x + alignPoint.x,\n                p.y + alignPoint.y,\n                width, height);\n            if (origin) {\n                ctx.restore();\n            }\n        }\n        if (alpha !== undefined) {\n            ctx.globalAlpha = alpha;\n        }\n\n        if ('markerReplaceColor' in this.style) {\n            this.replaceColor_(ctx);\n        }\n    }\n\n    _getImage(resources) {\n        const img = !resources ? null : resources.getImage([this.style['markerFile'], this.style['markerWidth'], this.style['markerHeight']]);\n        return img;\n    }\n\n    getPlacement() {\n        return this.symbol['markerPlacement'];\n    }\n\n    getRotation() {\n        const r = this.style['markerRotation'];\n        if (!isNumber(r)) {\n            return null;\n        }\n        //to radian\n        return -r * Math.PI / 180;\n    }\n\n    getDxDy() {\n        const s = this.style;\n        const dx = s['markerDx'],\n            dy = s['markerDy'];\n        return new Point(dx, dy);\n    }\n\n    getFixedExtent(resources) {\n        const style = this.style;\n        const url = style['markerFile'],\n            img = resources ? resources.getImage(url) : null;\n        const width = style['markerWidth'] || (img ? img.width : 0),\n            height = style['markerHeight'] || (img ? img.height : 0);\n        const dxdy = this.getDxDy();\n        const alignPoint = getAlignPoint(new Size(width, height), style['markerHorizontalAlignment'], style['markerVerticalAlignment']);\n        let result = new PointExtent(dxdy.add(0, 0), dxdy.add(width, height));\n        result._add(alignPoint);\n        const rotation = this.getRotation();\n        if (rotation) {\n            result = this._rotateExtent(result, rotation);\n        }\n        return result;\n    }\n\n    translate() {\n        const s = this.symbol;\n        return {\n            'markerReplaceColor': s['markerReplaceColor'],\n            'markerFile': s['markerFile'],\n            'markerOpacity': getValueOrDefault(s['markerOpacity'], 1),\n            'markerWidth': getValueOrDefault(s['markerWidth'], null),\n            'markerHeight': getValueOrDefault(s['markerHeight'], null),\n            'markerRotation' : getValueOrDefault(s['markerRotation'], 0),\n\n            'markerDx': getValueOrDefault(s['markerDx'], 0),\n            'markerDy': getValueOrDefault(s['markerDy'], 0),\n\n            'markerHorizontalAlignment': getValueOrDefault(s['markerHorizontalAlignment'], 'middle'), //left | middle | right\n            'markerVerticalAlignment': getValueOrDefault(s['markerVerticalAlignment'], 'top'), // top | middle | bottom\n        };\n    }\n\n    replaceColor_(ctx) {\n        if (!this.style.markerReplaceColor) {\n            return;\n        }\n        const color = this.style.markerReplaceColor;\n        const imgData = ctx.getImageData(0, 0, ctx.canvas.width, ctx.canvas.height);\n        const data = imgData.data;\n        const r = color[0] / 255.0;\n        const g = color[1] / 255.0;\n        const b = color[2] / 255.0;\n\n        for (let i = 0, ii = data.length; i < ii; i += 4) {\n            data[i] *= r;\n            data[i + 1] *= g;\n            data[i + 2] *= b;\n        }\n        ctx.putImageData(imgData, 0, 0);\n    }\n}\n","import { getValueOrDefault } from '../../../core/util';\nimport { isGradient as checkGradient } from '../../../core/util/style';\nimport Coordinate from '../../../geo/Coordinate';\nimport PointExtent from '../../../geo/PointExtent';\nimport CanvasSymbolizer from './CanvasSymbolizer';\n\nconst TEMP_COORD0 = new Coordinate(0, 0);\nconst TEMP_COORD1 = new Coordinate(0, 0);\n\nexport default class StrokeAndFillSymbolizer extends CanvasSymbolizer {\n\n    static test(symbol, geometry) {\n        if (!symbol) {\n            return false;\n        }\n        if (geometry && (geometry.type === 'Point')) {\n            return false;\n        }\n        for (const p in symbol) {\n            const f = p.slice(0, 4);\n            if (f === 'line' || f === 'poly') {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    constructor(symbol, geometry, painter) {\n        super();\n        this.symbol = symbol;\n        this.geometry = geometry;\n        this.painter = painter;\n        if (geometry.type === 'Point') {\n            return;\n        }\n        this.style = this._defineStyle(this.translate());\n    }\n\n    symbolize(ctx, resources) {\n        const style = this.style;\n        if (style['polygonOpacity'] === 0 && style['lineOpacity'] === 0 && !this.painter.isHitTesting()) {\n            return;\n        }\n        const paintParams = this._getPaintParams();\n        if (!paintParams) {\n            return;\n        }\n        this._prepareContext(ctx);\n        const isGradient = checkGradient(style['lineColor']),\n            isPath = (this.geometry.getJSONType() === 'Polygon') || (this.geometry.type === 'LineString');\n        if (isGradient && (style['lineColor']['places'] || !isPath)) {\n            style['lineGradientExtent'] = this.getPainter().getContainerExtent()._expand(style['lineWidth']);\n        }\n        if (checkGradient(style['polygonFill'])) {\n            style['polygonGradientExtent'] = this.getPainter().getContainerExtent();\n        }\n\n        const points = paintParams[0],\n            isSplitted = (this.geometry.getJSONType() === 'Polygon' && points.length > 0 && Array.isArray(points[0][0])) ||\n            (this.geometry.type === 'LineString' && points.length > 0 && Array.isArray(points[0]));\n\n        if (isSplitted) {\n            for (let i = 0; i < points.length; i++) {\n                this.prepareCanvas(ctx, style, resources);\n                if (isGradient && isPath && !style['lineColor']['places']) {\n                    this._createGradient(ctx, points[i], style['lineColor']);\n                }\n                const params = [ctx, points[i]];\n                if (paintParams.length > 1) {\n                    params.push.apply(params, paintParams.slice(1));\n                }\n                params.push(style['lineOpacity'], style['polygonOpacity'], style['lineDasharray']);\n                this.geometry._paintOn.apply(this.geometry, params);\n            }\n        } else {\n            this.prepareCanvas(ctx, style, resources);\n            if (isGradient && isPath && !style['lineColor']['places']) {\n                this._createGradient(ctx, points, style['lineColor']);\n            }\n            const params = [ctx];\n            params.push.apply(params, paintParams);\n            params.push(style['lineOpacity'], style['polygonOpacity'], style['lineDasharray']);\n            this.geometry._paintOn.apply(this.geometry, params);\n        }\n\n        if (ctx.setLineDash && Array.isArray(style['lineDasharray'])) {\n            ctx.setLineDash([]);\n        }\n    }\n\n    get2DExtent() {\n        const map = this.getMap();\n        const extent = this.geometry._getPrjExtent();\n        if (!extent) {\n            return null;\n        }\n        // this ugly implementation is to improve perf as we can\n        // it tries to avoid creating instances to save cpu consumption.\n        if (!this._extMin || !this._extMax) {\n            this._extMin = new Coordinate(0, 0);\n            this._extMax = new Coordinate(0, 0);\n        }\n        this._extMin.x = extent['xmin'];\n        this._extMin.y = extent['ymin'];\n        this._extMax.x = extent['xmax'];\n        this._extMax.y = extent['ymax'];\n        const min = map._prjToPoint(this._extMin, undefined, TEMP_COORD0),\n            max = map._prjToPoint(this._extMax, undefined, TEMP_COORD1);\n        if (!this._pxExtent) {\n            this._pxExtent = new PointExtent(min, max);\n        } else {\n            this._pxExtent.set(\n                Math.min(min.x, max.x),\n                Math.min(min.y, max.y),\n                Math.max(min.x, max.x),\n                Math.max(min.y, max.y)\n            );\n        }\n        return this._pxExtent;\n    }\n\n    getFixedExtent() {\n        const t = this.style['lineWidth'] / 2;\n        return new PointExtent(-t, -t, t, t);\n    }\n\n    _getPaintParams() {\n        return this.getPainter().getPaintParams(this.style['lineDx'], this.style['lineDy']);\n    }\n\n    translate() {\n        const s = this.symbol;\n        const result = {\n            'lineColor': getValueOrDefault(s['lineColor'], '#000'),\n            'lineWidth': getValueOrDefault(s['lineWidth'], 2),\n            'lineOpacity': getValueOrDefault(s['lineOpacity'], 1),\n            'lineDasharray': getValueOrDefault(s['lineDasharray'], []),\n            'lineCap': getValueOrDefault(s['lineCap'], 'butt'), //“butt”, “square”, “round”\n            'lineJoin': getValueOrDefault(s['lineJoin'], 'miter'), //“bevel”, “round”, “miter”\n            'linePatternFile': getValueOrDefault(s['linePatternFile'], null),\n            'lineDx' : getValueOrDefault(s['lineDx'], 0),\n            'lineDy' : getValueOrDefault(s['lineDy'], 0),\n            'polygonFill': getValueOrDefault(s['polygonFill'], null),\n            'polygonOpacity': getValueOrDefault(s['polygonOpacity'], 1),\n            'polygonPatternFile': getValueOrDefault(s['polygonPatternFile'], null),\n            'polygonPatternDx' : getValueOrDefault(s['polygonPatternDx'], 0),\n            'polygonPatternDy' : getValueOrDefault(s['polygonPatternDy'], 0),\n            'linePatternDx' : getValueOrDefault(s['linePatternDx'], 0),\n            'linePatternDy' : getValueOrDefault(s['linePatternDy'], 0)\n        };\n        if (result['lineWidth'] === 0) {\n            result['lineOpacity'] = 0;\n        }\n        // fill of arrow\n        if ((this.geometry.type === 'LineString') && !result['polygonFill']) {\n            result['polygonFill'] = result['lineColor'];\n        }\n        return result;\n    }\n\n    _createGradient(ctx, points, lineColor) {\n        if (!Array.isArray(points) || !points.length) {\n            return;\n        }\n        const len = points.length;\n        const grad = ctx.createLinearGradient(points[0].x, points[0].y, points[len - 1].x, points[len - 1].y);\n        lineColor['colorStops'].forEach(function (stop) {\n            grad.addColorStop.apply(grad, stop);\n        });\n        ctx.strokeStyle = grad;\n    }\n\n}\n","import {\n    IS_NODE,\n    isNil,\n    isNumber,\n    isArrayHasData,\n    getValueOrDefault\n} from '../../../core/util';\nimport Point from '../../../geo/Point';\nimport { hasFunctionDefinition } from '../../../core/mapbox';\nimport { splitTextToRow, getAlignPoint, replaceVariable } from '../../../core/util/strings';\nimport PointExtent from '../../../geo/PointExtent';\nimport Canvas from '../../../core/Canvas';\nimport PointSymbolizer from './PointSymbolizer';\n\nexport const CACHE_KEY = '___text_symbol_cache';\n\nexport default class TextMarkerSymbolizer extends PointSymbolizer {\n\n    static test(symbol) {\n        if (!symbol) {\n            return false;\n        }\n        if (!isNil(symbol['textName'])) {\n            return true;\n        }\n        return false;\n    }\n\n    constructor(symbol, geometry, painter) {\n        super(symbol, geometry, painter);\n        this._dynamic = hasFunctionDefinition(symbol);\n        this.style = this._defineStyle(this.translate());\n        if (this.style['textWrapWidth'] === 0) {\n            return;\n        }\n        this.strokeAndFill = this._defineStyle(this.translateLineAndFill(this.style));\n        const textContent = replaceVariable(this.style['textName'], this.geometry.getProperties());\n        if (!this._dynamic) {\n            // the key to cache text descriptor\n            this._cacheKey = genCacheKey(textContent, this.style);\n        }\n        this._descText(textContent);\n    }\n\n    symbolize(ctx, resources) {\n        if (!this.painter.isHitTesting() && (this.style['textSize'] === 0 ||\n            !this.style['textOpacity'] && (!this.style['textHaloRadius'] || !this.style['textHaloOpacity']) ||\n            this.style['textWrapWidth'] === 0)) {\n            return;\n        }\n        const cookedPoints = this._getRenderContainerPoints();\n        if (!isArrayHasData(cookedPoints)) {\n            return;\n        }\n        const style = this.style,\n            strokeAndFill = this.strokeAndFill;\n        const textContent = replaceVariable(this.style['textName'], this.geometry.getProperties());\n        this._descText(textContent);\n        this._prepareContext(ctx);\n        this.prepareCanvas(ctx, strokeAndFill, resources);\n        Canvas.prepareCanvasFont(ctx, style);\n        for (let i = 0, len = cookedPoints.length; i < len; i++) {\n            let p = cookedPoints[i];\n            const origin = this._rotate(ctx, p, this._getRotationAt(i));\n            if (origin) {\n                p = origin;\n            }\n            Canvas.text(ctx, textContent, p, style, this.textDesc);\n            if (origin) {\n                ctx.restore();\n            }\n        }\n    }\n\n    getPlacement() {\n        return this.symbol['textPlacement'];\n    }\n\n    getRotation() {\n        const r = this.style['textRotation'];\n        if (!isNumber(r)) {\n            return null;\n        }\n        //to radian\n        return -r * Math.PI / 180;\n    }\n\n    getDxDy() {\n        const s = this.style;\n        return new Point(s['textDx'], s['textDy']);\n    }\n\n    getFixedExtent() {\n        const dxdy = this.getDxDy(),\n            style = this.style;\n        let size = this.textDesc['size'];\n        const alignPoint = getAlignPoint(size, style['textHorizontalAlignment'], style['textVerticalAlignment']);\n        const alignW = alignPoint.x,\n            alignH = alignPoint.y;\n        if (style['textHaloRadius']) {\n            const r = style['textHaloRadius'];\n            size = size.add(r * 2, r * 2);\n        }\n        let result = new PointExtent(\n            dxdy.add(alignW, alignH),\n            dxdy.add(alignW + size['width'], alignH + size['height'])\n        );\n        const rotation = this.getRotation();\n        if (rotation) {\n            result = this._rotateExtent(result, rotation);\n        }\n        return result;\n    }\n\n    translate() {\n        const s = this.symbol;\n        const result = {\n            'textName': s['textName'],\n            'textFaceName': getValueOrDefault(s['textFaceName'], 'monospace'),\n            'textWeight': getValueOrDefault(s['textWeight'], 'normal'), //'bold', 'bolder'\n            'textStyle': getValueOrDefault(s['textStyle'], 'normal'), //'italic', 'oblique'\n            'textSize': getValueOrDefault(s['textSize'], 10),\n            'textFont': getValueOrDefault(s['textFont'], null),\n            'textFill': getValueOrDefault(s['textFill'], '#000'),\n            'textOpacity': getValueOrDefault(s['textOpacity'], 1),\n\n            'textHaloFill': getValueOrDefault(s['textHaloFill'], '#ffffff'),\n            'textHaloRadius': getValueOrDefault(s['textHaloRadius'], 0),\n            'textHaloOpacity': getValueOrDefault(s['textHaloOpacity'], 1),\n\n            'textWrapWidth': getValueOrDefault(s['textWrapWidth'], null),\n            'textWrapCharacter': getValueOrDefault(s['textWrapCharacter'], '\\n'),\n            'textLineSpacing': getValueOrDefault(s['textLineSpacing'], 0),\n\n            'textDx': getValueOrDefault(s['textDx'], 0),\n            'textDy': getValueOrDefault(s['textDy'], 0),\n\n            'textHorizontalAlignment': getValueOrDefault(s['textHorizontalAlignment'], 'middle'), //left | middle | right | auto\n            'textVerticalAlignment': getValueOrDefault(s['textVerticalAlignment'], 'middle'), // top | middle | bottom | auto\n            'textAlign': getValueOrDefault(s['textAlign'], 'center'), //left | right | center | auto\n\n            'textRotation' : getValueOrDefault(s['textRotation'], 0),\n\n            'textMaxWidth' : getValueOrDefault(s['textMaxWidth'], 0),\n            'textMaxHeight' : getValueOrDefault(s['textMaxHeight'], 0)\n        };\n\n        if (result['textMaxWidth'] > 0 && (!result['textWrapWidth'] || result['textWrapWidth'] > result['textMaxWidth'])) {\n            if (!result['textWrapWidth']) {\n                result['textMaxHeight'] = 1;\n            }\n            result['textWrapWidth'] = result['textMaxWidth'];\n        }\n        return result;\n    }\n\n    translateLineAndFill(s) {\n        return {\n            'lineColor': s['textHaloRadius'] ? s['textHaloFill'] : s['textFill'],\n            'lineWidth': s['textHaloRadius'],\n            'lineOpacity': s['textOpacity'],\n            'lineDasharray': null,\n            'lineCap': 'butt',\n            'lineJoin': 'round',\n            'polygonFill': s['textFill'],\n            'polygonOpacity': s['textOpacity']\n        };\n    }\n\n    _descText(textContent) {\n        if (this._dynamic) {\n            this.textDesc = this._measureText(textContent);\n            return;\n        }\n        this.textDesc = this._loadFromCache();\n        if (!this.textDesc) {\n            this.textDesc = this._measureText(textContent);\n            this._storeToCache(this.textDesc);\n        }\n    }\n\n    _measureText(textContent) {\n        const maxHeight = this.style['textMaxHeight'];\n        const textDesc = splitTextToRow(textContent, this.style);\n        if (maxHeight && maxHeight < textDesc.size.height) {\n            textDesc.size.height = maxHeight;\n        }\n        return textDesc;\n    }\n\n    _storeToCache(textDesc) {\n        if (IS_NODE) {\n            return;\n        }\n        if (!this.geometry[CACHE_KEY]) {\n            this.geometry[CACHE_KEY] = {};\n        }\n        this.geometry[CACHE_KEY][this._cacheKey] = { 'desc' : textDesc, 'active' : true };\n    }\n\n    _loadFromCache() {\n        if (!this.geometry[CACHE_KEY]) {\n            return null;\n        }\n        const cache = this.geometry[CACHE_KEY][this._cacheKey];\n        if (!cache) {\n            return null;\n        }\n        cache.active = true;\n        return cache.desc;\n    }\n}\n\nTextMarkerSymbolizer.CACHE_KEY = CACHE_KEY;\n\nfunction genCacheKey(textContent, style) {\n    const key = [textContent];\n    for (const p in style) {\n        if (style.hasOwnProperty(p) && p.length > 4 && p.substring(0, 4) === 'text') {\n            key.push(p + '=' + style[p]);\n        }\n    }\n    return key.join('-');\n}\n","import { isNil } from '../../../core/util';\nimport Browser from '../../../core/Browser';\nimport { getMarkerPathBase64 } from '../../../core/util/resource';\nimport ImageMarkerSymbolizer from './ImageMarkerSymbolizer';\n\nexport default class VectorPathMarkerSymbolizer extends ImageMarkerSymbolizer {\n\n    static test(symbol) {\n        if (!symbol) {\n            return false;\n        }\n        if (isNil(symbol['markerFile']) && symbol['markerType'] === 'path') {\n            return true;\n        }\n        return false;\n    }\n\n    constructor(symbol, geometry, painter) {\n        super(symbol, geometry, painter);\n        this.style = this._defineStyle(this.translate());\n        //IE must have a valid width and height to draw a svg image\n        //otherwise, error will be thrown\n        if (isNil(this.style['markerWidth'])) {\n            this.style['markerWidth'] = 80;\n        }\n        if (isNil(this.style['markerHeight'])) {\n            this.style['markerHeight'] = 80;\n        }\n        if (Browser.gecko) {\n            // Firefox requires valid width and height attributes in SVG's root element.\n            this._url = [getMarkerPathBase64(symbol, this.style['markerWidth'], this.style['markerHeight']), this.style['markerWidth'], this.style['markerHeight']];\n        } else {\n            this._url = [getMarkerPathBase64(symbol), symbol['markerWidth'], symbol['markerHeight']];\n        }\n    }\n\n    _prepareContext() {\n        //for VectorPathMarkerSymbolizer, opacity is already added into SVG element.\n    }\n\n    _getImage(resources) {\n        if (resources && resources.isResourceLoaded(this._url)) {\n            return resources.getImage(this._url);\n        }\n        const image = new Image();\n        image.src = this._url[0];\n        if (resources) {\n            resources.addResource(this._url, image);\n        }\n        return image;\n        // return resources ? resources.getImage(this._url) : null;\n    }\n}\n","import { isObject } from '../../../core/util';\nimport Point from '../../../geo/Point';\nimport PointSymbolizer from './PointSymbolizer';\nimport StrokeAndFillSymbolizer from './StrokeAndFillSymbolizer';\nimport Canvas from '../../../core/Canvas';\n\nconst defaultSymbol = {\n    lineWidth : 1,\n    polygonFill : '#fff',\n    polygonOpacity : 0.5\n};\n\nexport default class DrawAltitudeSymbolizer extends PointSymbolizer {\n    static test(symbol, geometry) {\n        const layer = geometry.getLayer();\n        if (!layer) {\n            return false;\n        }\n        const type = geometry.getJSONType();\n        // shoule be a point or linestring\n        return (type === 'Marker' || type === 'LineString');\n    }\n\n    constructor(symbol, geometry, painter) {\n        super(symbol, geometry, painter);\n        this.style = geometry.getLayer().options['drawAltitude'];\n        if (!this.style || !isObject(this.style)) {\n            this.style = {\n                'lineWidth' : 2\n            };\n        }\n        if (!this.style['lineWidth']) {\n            // for get2DExtent\n            this.style['lineWidth'] = 0;\n        }\n        this.dxdy = this._defineStyle({\n            'dx' : symbol['textDx'] || symbol['markerDx'],\n            'dy' : symbol['textDy'] || symbol['markerDy']\n        });\n    }\n\n    symbolize(ctx) {\n        const layer = this.geometry.getLayer();\n        if (!layer.options['drawAltitude']) {\n            return;\n        }\n        const properties = this.geometry.getProperties();\n        if (!properties || !properties[layer.options['altitudeProperty']]) {\n            return;\n        }\n        const style = this._getStyle();\n        this._prepareContext(ctx);\n        if (this.geometry.type === 'LineString') {\n            const paintParams = this._getPaintParams(style['lineDx'], style['lineDy']);\n            if (!paintParams) {\n                return;\n            }\n            //container points that ignore altitude\n            const groundPoints = this.getPainter().getPaintParams(style['lineDx'], style['lineDy'], true)[0];\n            this._drawLineAltitude(ctx, paintParams[0], groundPoints);\n        } else {\n            const point = this._getRenderContainerPoints(),\n                groundPoint = this._getRenderContainerPoints(true);\n            if (!point || point.length === 0) {\n                return;\n            }\n            this._drawMarkerAltitude(ctx, point[0], groundPoint[0]);\n        }\n    }\n\n    getDxDy() {\n        const s = this.dxdy;\n        return new Point(s['dx'] || 0, s['dy'] || 0);\n    }\n\n    get2DExtent() {\n        if (this.geometry.type === 'LineString') {\n            return StrokeAndFillSymbolizer.prototype.get2DExtent.apply(this);\n        } else {\n            return super.get2DExtent();\n        }\n    }\n\n    getPlacement() {\n        return 'point';\n    }\n\n    _getPaintParams(dx, dy) {\n        return this.getPainter().getPaintParams(dx || 0, dy || 0);\n    }\n\n    _drawMarkerAltitude(ctx, point, groundPoint) {\n        const style = this._getStyle();\n        this.prepareCanvas(ctx, style);\n        Canvas.path(ctx, [point, groundPoint], style['lineOpacity'], null, style['lineDasharray']);\n    }\n\n    _drawLineAltitude(ctx, points, groundPoints) {\n        const style = this._getStyle();\n        const isSplitted = points.length > 0 && Array.isArray(points[0]);\n\n        if (isSplitted) {\n            for (let i = 0; i < points.length; i++) {\n                this._drawLine(ctx, points[i], groundPoints[i]);\n            }\n        } else {\n            this._drawLine(ctx, points, groundPoints);\n        }\n\n        if (ctx.setLineDash && Array.isArray(style['lineDasharray'])) {\n            ctx.setLineDash([]);\n        }\n    }\n\n    _drawLine(ctx, points, groundPoints) {\n        const style = this._getStyle();\n        this.prepareCanvas(ctx, style);\n        for (let i = 0, l = points.length - 1; i < l; i++) {\n            Canvas.polygon(ctx, [points[i], points[i + 1], groundPoints[i + 1], groundPoints[i]], style['lineOpacity'], style['polygonOpacity'], style['lineDasharray']);\n        }\n    }\n\n    _getStyle() {\n        // read drawAltitude from layer every time\n        let style = this.geometry.getLayer().options['drawAltitude'];\n        if (!isObject(style)) {\n            style = defaultSymbol;\n        }\n        if (!style['lineWidth']) {\n            // for get2DExtent\n            style['lineWidth'] = 0;\n            style['lineOpacity'] = 0;\n        }\n        return style;\n    }\n}\n","import { isNumber, sign, pushIn, hasOwn } from '../../core/util';\nimport { clipPolygon, clipLine } from '../../core/util/path';\nimport Class from '../../core/Class';\nimport Size from '../../geo/Size';\nimport Point from '../../geo/Point';\nimport PointExtent from '../../geo/PointExtent';\nimport Canvas from '../../core/Canvas';\nimport * as Symbolizers from './symbolizers';\nimport { interpolate } from '../../core/util/util';\n\n//registered symbolizers\n//the latter will paint at the last\nconst registerSymbolizers = [\n    Symbolizers.DrawAltitudeSymbolizer,\n    Symbolizers.StrokeAndFillSymbolizer,\n    Symbolizers.ImageMarkerSymbolizer,\n    Symbolizers.VectorPathMarkerSymbolizer,\n    Symbolizers.VectorMarkerSymbolizer,\n    Symbolizers.TextMarkerSymbolizer\n];\n\n\nlet testCanvas;\n\nconst TEMP_POINT0 = new Point(0, 0);\nconst TEMP_PAINT_EXTENT = new PointExtent();\nconst TEMP_EXTENT = new PointExtent();\nconst TEMP_FIXED_EXTENT = new PointExtent();\nconst TEMP_CLIP_EXTENT0 = new PointExtent();\nconst TEMP_CLIP_EXTENT1 = new PointExtent();\n// const TEMP_CONTAINER_EXTENT = new PointExtent();\n\n/**\n * @classdesc\n * Painter class for all geometry types except the collection types.\n * @class\n * @private\n */\nclass Painter extends Class {\n\n    /**\n     *  @param {Geometry} geometry - geometry to paint\n     */\n    constructor(geometry) {\n        super();\n        this.geometry = geometry;\n        this.symbolizers = this._createSymbolizers();\n        this._altAtGLZoom = this._getGeometryAltitude();\n    }\n\n    getMap() {\n        return this.geometry.getMap();\n    }\n\n    getLayer() {\n        return this.geometry.getLayer();\n    }\n\n    /**\n     * create symbolizers\n     */\n    _createSymbolizers() {\n        const geoSymbol = this.getSymbol(),\n            symbolizers = [],\n            regSymbolizers = registerSymbolizers;\n        let symbols = geoSymbol;\n        if (!Array.isArray(geoSymbol)) {\n            symbols = [geoSymbol];\n        }\n        for (let ii = symbols.length - 1; ii >= 0; ii--) {\n            const symbol = symbols[ii];\n            for (let i = regSymbolizers.length - 1; i >= 0; i--) {\n                if (regSymbolizers[i].test(symbol, this.geometry)) {\n                    const symbolizer = new regSymbolizers[i](symbol, this.geometry, this);\n                    symbolizers.push(symbolizer);\n                    if (symbolizer instanceof Symbolizers.PointSymbolizer) {\n                        this._hasPoint = true;\n                    }\n                }\n            }\n        }\n        if (!symbolizers.length) {\n            if (console) {\n                const id = this.geometry.getId();\n                console.warn('invalid symbol for geometry(' + (this.geometry ? this.geometry.getType() + (id ? ':' + id : '') : '') + ') to draw : ' + JSON.stringify(geoSymbol));\n            }\n            // throw new Error('no symbolizers can be created to draw, check the validity of the symbol.');\n        }\n        this._debugSymbolizer = new Symbolizers.DebugSymbolizer(geoSymbol, this.geometry, this);\n        return symbolizers;\n    }\n\n    hasPoint() {\n        return !!this._hasPoint;\n    }\n\n    /**\n     * for point symbolizers\n     * @return {Point[]} points to render\n     */\n    getRenderPoints(placement) {\n        if (!this._renderPoints) {\n            this._renderPoints = {};\n        }\n        if (!placement) {\n            placement = 'center';\n        }\n        if (!this._renderPoints[placement]) {\n            this._renderPoints[placement] = this.geometry._getRenderPoints(placement);\n        }\n        return this._renderPoints[placement];\n    }\n\n    /**\n     * for strokeAndFillSymbolizer\n     * @return {Object[]} resources to render vector\n     */\n    getPaintParams(dx, dy, ignoreAltitude) {\n        const map = this.getMap(),\n            geometry = this.geometry,\n            res = map.getResolution(),\n            pitched = (map.getPitch() !== 0),\n            rotated = (map.getBearing() !== 0);\n        let params = this._cachedParams;\n\n        const paintAsPath = geometry._paintAsPath && geometry._paintAsPath();\n        if (paintAsPath && this._unsimpledParams && res <= this._unsimpledParams._res) {\n            //if res is smaller, return unsimplified params directly\n            params = this._unsimpledParams;\n        } else if (!params ||\n            // refresh paint params\n            // simplified, but not same zoom\n            params._res !== map.getResolution() ||\n            // refresh if requested by geometry\n            this._pitched !== pitched && geometry._redrawWhenPitch() ||\n            this._rotated !== rotated && geometry._redrawWhenRotate()\n        ) {\n            //render resources geometry returned are based on 2d points.\n            params = geometry._getPaintParams();\n            if (!params) {\n                return null;\n            }\n            params._res = res;\n\n            if (!geometry._simplified && paintAsPath) {\n                if (!this._unsimpledParams) {\n                    this._unsimpledParams = params;\n                }\n                if (res > this._unsimpledParams._res) {\n                    this._unsimpledParams._res = res;\n                }\n            }\n            this._cachedParams = params;\n        }\n        if (!params) {\n            return null;\n        }\n        this._pitched = pitched;\n        this._rotated = rotated;\n        const zoomScale = map.getGLScale(),\n            // paintParams = this._paintParams,\n            tr = [], // transformed params\n            points = params[0];\n\n        const mapExtent = map.getContainerExtent();\n        const cPoints = this._pointContainerPoints(points, dx, dy, ignoreAltitude, this._hitPoint && !mapExtent.contains(this._hitPoint));\n        if (!cPoints) {\n            return null;\n        }\n        tr.push(cPoints);\n        for (let i = 1, l = params.length; i < l; i++) {\n            if (isNumber(params[i]) || (params[i] instanceof Size)) {\n                if (isNumber(params[i])) {\n                    tr.push(params[i] / zoomScale);\n                } else {\n                    tr.push(params[i].multi(1 / zoomScale));\n                }\n            } else {\n                tr.push(params[i]);\n            }\n        }\n        return tr;\n    }\n\n    _pointContainerPoints(points, dx, dy, ignoreAltitude, disableClip, pointPlacement) {\n        if (this._aboveCamera()) {\n            return null;\n        }\n        const map = this.getMap(),\n            glZoom = map.getGLZoom(),\n            containerOffset = this.containerOffset;\n        let cPoints;\n        function pointContainerPoint(point, alt) {\n            const p = map._pointToContainerPoint(point, glZoom, alt)._sub(containerOffset);\n            if (dx || dy) {\n                p._add(dx || 0, dy || 0);\n            }\n            return p;\n        }\n\n        let altitude = this.getAltitude();\n\n        //convert 2d points to container points needed by canvas\n        if (Array.isArray(points)) {\n            const geometry = this.geometry;\n            let clipped;\n            if (!disableClip && geometry.options['enableClip']) {\n                clipped = this._clip(points, altitude);\n            } else {\n                clipped = {\n                    points : points,\n                    altitude : altitude\n                };\n            }\n            const clipPoints = clipped.points;\n            altitude = clipped.altitude;\n            if (ignoreAltitude) {\n                altitude = 0;\n            }\n            let alt = altitude;\n            cPoints = [];\n            for (let i = 0, l = clipPoints.length; i < l; i++) {\n                const c = clipPoints[i];\n                if (Array.isArray(c)) {\n                    const cring = [];\n                    //polygon rings or clipped line string\n                    for (let ii = 0, ll = c.length; ii < ll; ii++) {\n                        const cc = c[ii];\n                        if (Array.isArray(altitude)) {\n                            if (altitude[i]) {\n                                alt = altitude[i][ii];\n                            } else {\n                                alt = 0;\n                            }\n                        }\n                        cring.push(pointContainerPoint(cc, alt));\n                    }\n                    cPoints.push(cring);\n                } else {\n                    //line string\n                    if (Array.isArray(altitude)) {\n                        // altitude of different placement for point symbolizers\n                        if (pointPlacement === 'vertex-last') {\n                            alt = altitude[altitude.length - 1 - i];\n                        } else if (pointPlacement === 'line') {\n                            alt = (altitude[i] + altitude[i + 1]) / 2;\n                        } else {\n                            //vertex, vertex-first\n                            alt = altitude[i];\n                        }\n                    }\n                    cPoints.push(pointContainerPoint(c, alt));\n                }\n            }\n        } else if (points instanceof Point) {\n            if (ignoreAltitude) {\n                altitude = 0;\n            }\n            cPoints = map._pointToContainerPoint(points, glZoom, altitude)._sub(containerOffset);\n            if (dx || dy) {\n                cPoints._add(dx, dy);\n            }\n        }\n        return cPoints;\n    }\n\n    _clip(points, altitude) {\n        const map = this.getMap(),\n            geometry = this.geometry;\n        let lineWidth = this.getSymbol()['lineWidth'];\n        if (!isNumber(lineWidth)) {\n            lineWidth = 4;\n        }\n        let extent2D = map._get2DExtent(undefined, TEMP_CLIP_EXTENT0)._expand(lineWidth);\n        if (map.getPitch() > 0 && altitude) {\n            const c = map.cameraLookAt;\n            const pos = map.cameraPosition;\n            //add [1px, 1px] towards camera's lookAt\n            TEMP_POINT0.x = pos.x;\n            TEMP_POINT0.y = pos.y;\n            extent2D = extent2D._combine(TEMP_POINT0._add(sign(c[0] - pos[0]), sign(c[1] - pos[1])));\n        }\n        const e = this.get2DExtent(null, TEMP_CLIP_EXTENT1);\n        let clipPoints = points;\n        if (e.within(extent2D)) {\n            // if (this.geometry.getJSONType() === 'LineString') {\n            //     // clip line with altitude\n            //     return this._clipLineByAlt(clipPoints, altitude);\n            // }\n            return {\n                points : clipPoints,\n                altitude : altitude\n            };\n        }\n        const glExtent2D = map._get2DExtent(map.getGLZoom(), TEMP_CLIP_EXTENT0)._expand(lineWidth / map._glScale);\n        const smoothness = geometry.options['smoothness'];\n        // if (this.geometry instanceof Polygon) {\n        if (geometry.getShell && this.geometry.getHoles && !smoothness) {\n            // clip the polygon to draw less and improve performance\n            if (!Array.isArray(points[0])) {\n                clipPoints = clipPolygon(points, glExtent2D);\n            } else {\n                clipPoints = [];\n                for (let i = 0; i < points.length; i++) {\n                    const part = clipPolygon(points[i], glExtent2D);\n                    if (part.length) {\n                        clipPoints.push(part);\n                    }\n                }\n            }\n        } else if (geometry.getJSONType() === 'LineString') {\n            // clip the line string to draw less and improve performance\n            if (!Array.isArray(points[0])) {\n                clipPoints = clipLine(points, glExtent2D, false, !!smoothness);\n            } else {\n                clipPoints = [];\n                for (let i = 0; i < points.length; i++) {\n                    pushIn(clipPoints, clipLine(points[i], glExtent2D, false, !!smoothness));\n                }\n            }\n            //interpolate line's segment's altitude if altitude is an array\n            return this._interpolateSegAlt(clipPoints, points, altitude);\n            // const segs = this._interpolateSegAlt(clipPoints, points, altitude);\n            // return this._clipLineByAlt(segs.points, segs.altitude);\n        }\n\n        return {\n            points : clipPoints,\n            altitude : altitude\n        };\n    }\n\n    // _clipLineByAlt(clipSegs, altitude) {\n    //     const frustumAlt = this.getMap().getFrustumAltitude();\n    //     if (!Array.isArray(altitude) || this.maxAltitude <= frustumAlt) {\n    //         return {\n    //             points : clipSegs,\n    //             altitude : altitude\n    //         };\n    //     }\n    //     return clipByALt(clipSegs, altitude, frustumAlt);\n    // }\n\n    /**\n     * interpolate clipped line segs's altitude\n     * @param {Point[]|Point[][]} clipSegs\n     * @param {Point[]|Point[][]} orig\n     * @param {Number|Number[]} altitude\n     * @private\n     */\n    _interpolateSegAlt(clipSegs, orig, altitude) {\n        if (!Array.isArray(altitude)) {\n            const fn = cc => cc.point;\n            return {\n                points : clipSegs.map(c => {\n                    if (Array.isArray(c)) {\n                        return c.map(fn);\n                    }\n                    return c.point;\n                }),\n                altitude : altitude\n            };\n        }\n        const segsWithAlt = interpolateAlt(clipSegs, orig, altitude);\n        altitude = [];\n        const points = segsWithAlt.map(p => {\n            if (Array.isArray(p)) {\n                const alt = [];\n                const cp = p.map(pp => {\n                    alt.push(pp.altitude);\n                    return pp.point;\n                });\n                altitude.push(alt);\n                return cp;\n            }\n            altitude.push(p.altitude);\n            return p.point;\n        });\n        return {\n            points : points,\n            altitude : altitude\n        };\n    }\n\n    getSymbol() {\n        return this.geometry._getInternalSymbol();\n    }\n\n    paint(extent, context, offset) {\n        if (!this.symbolizers) {\n            return;\n        }\n        const renderer = this.getLayer()._getRenderer();\n        if (!renderer || !renderer.context && !context) {\n            return;\n        }\n        //reduce geos to paint when drawOnInteracting\n        if (extent && !extent.intersects(this.get2DExtent(renderer.resources, TEMP_PAINT_EXTENT))) {\n            return;\n        }\n        const map = this.getMap();\n        const minAltitude = this.getMinAltitude();\n        const frustumAlt = map.getFrustumAltitude();\n        if (minAltitude && frustumAlt && frustumAlt < minAltitude) {\n            return;\n        }\n        this.containerOffset = offset || map._pointToContainerPoint(renderer.southWest)._add(0, -map.height);\n        this._beforePaint();\n        const ctx = context || renderer.context;\n        const contexts = [ctx, renderer.resources];\n        for (let i = this.symbolizers.length - 1; i >= 0; i--) {\n            this._prepareShadow(ctx, this.symbolizers[i].symbol);\n            this.symbolizers[i].symbolize.apply(this.symbolizers[i], contexts);\n        }\n        this._afterPaint();\n        this._painted = true;\n        this._debugSymbolizer.symbolize.apply(this._debugSymbolizer, contexts);\n    }\n\n    getSprite(resources, canvasClass) {\n        if (this.geometry.type !== 'Point') {\n            return null;\n        }\n        this._spriting = true;\n        if (!this._sprite && this.symbolizers.length > 0) {\n            const extent = new PointExtent();\n            this.symbolizers.forEach(s => {\n                const markerExtent = s.getFixedExtent(resources);\n                extent._combine(markerExtent);\n            });\n            const origin = extent.getMin().multi(-1);\n            const clazz = canvasClass || (this.getMap() ? this.getMap().CanvasClass : null);\n            const canvas = Canvas.createCanvas(extent.getWidth(), extent.getHeight(), clazz);\n            let bak;\n            if (this._renderPoints) {\n                bak = this._renderPoints;\n            }\n            const ctx = canvas.getContext('2d');\n            const contexts = [ctx, resources];\n            for (let i = this.symbolizers.length - 1; i >= 0; i--) {\n                const dxdy = this.symbolizers[i].getDxDy();\n                this._renderPoints = {\n                    'center': [\n                        [origin.add(dxdy)]\n                    ]\n                };\n                this._prepareShadow(ctx, this.symbolizers[i].symbol);\n                this.symbolizers[i].symbolize.apply(this.symbolizers[i], contexts);\n            }\n            if (bak) {\n                this._renderPoints = bak;\n            }\n            this._sprite = {\n                'canvas': canvas,\n                'offset': extent.getCenter()\n            };\n        }\n        this._spriting = false;\n        return this._sprite;\n    }\n\n    isSpriting() {\n        return !!this._spriting;\n    }\n\n    hitTest(cp, tolerance) {\n        if (!tolerance || tolerance < 0.5) {\n            tolerance = 0.5;\n        }\n        if (!testCanvas) {\n            testCanvas = Canvas.createCanvas(1, 1);\n        }\n        Canvas.setHitTesting(true);\n        testCanvas.width = testCanvas.height = 2 * tolerance;\n        const ctx = testCanvas.getContext('2d');\n        this._hitPoint = cp.sub(tolerance, tolerance);\n        try {\n            this.paint(null, ctx, this._hitPoint);\n        } catch (e) {\n            throw e;\n        } finally {\n            Canvas.setHitTesting(false);\n        }\n        delete this._hitPoint;\n        const imgData = ctx.getImageData(0, 0, testCanvas.width, testCanvas.height).data;\n        for (let i = 3, l = imgData.length; i < l; i += 4) {\n            if (imgData[i] > 0) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    isHitTesting() {\n        return !!this._hitPoint;\n    }\n\n    _prepareShadow(ctx, symbol) {\n        if (symbol['shadowBlur']) {\n            ctx.shadowBlur = symbol['shadowBlur'];\n            ctx.shadowColor = symbol['shadowColor'] || '#000';\n            ctx.shadowOffsetX = symbol['shadowOffsetX'] || 0;\n            ctx.shadowOffsetY = symbol['shadowOffsetY'] || 0;\n        } else if (ctx.shadowBlur) {\n            ctx.shadowBlur = null;\n            ctx.shadowColor = null;\n            ctx.shadowOffsetX = null;\n            ctx.shadowOffsetY = null;\n        }\n    }\n\n    _eachSymbolizer(fn, context) {\n        if (!this.symbolizers) {\n            return;\n        }\n        if (!context) {\n            context = this;\n        }\n        for (let i = this.symbolizers.length - 1; i >= 0; i--) {\n            fn.apply(context, [this.symbolizers[i]]);\n        }\n    }\n\n    get2DExtent(resources, out) {\n        this._verifyProjection();\n        const map = this.getMap();\n        resources = resources || this.getLayer()._getRenderer().resources;\n        const zoom = map.getZoom();\n        if (!this._extent2D || this._extent2D._zoom !== zoom) {\n            delete this._extent2D;\n            delete this._fixedExtent;\n            if (this.symbolizers) {\n                const extent = this._extent2D = new PointExtent();\n                const fixedExt = this._fixedExtent = new PointExtent();\n                for (let i = this.symbolizers.length - 1; i >= 0; i--) {\n                    const symbolizer = this.symbolizers[i];\n                    extent._combine(symbolizer.get2DExtent());\n                    if (symbolizer.getFixedExtent) {\n                        fixedExt._combine(symbolizer.getFixedExtent(resources));\n                    }\n                }\n                extent._zoom = zoom;\n            }\n        }\n        if (!this._extent2D) {\n            return null;\n        }\n        if (out) {\n            out.set(this._extent2D['xmin'], this._extent2D['ymin'], this._extent2D['xmax'], this._extent2D['ymax']);\n            out._add(this._fixedExtent);\n            return out;\n        }\n        return this._extent2D.add(this._fixedExtent);\n    }\n\n    getContainerExtent(out) {\n        if (this._aboveCamera()) {\n            return null;\n        }\n        this._verifyProjection();\n        const map = this.getMap();\n        const zoom = map.getZoom();\n        const glScale = map._glScale;\n        if (!this._extent2D || this._extent2D._zoom !== zoom) {\n            this.get2DExtent(null, TEMP_EXTENT);\n        }\n        const altitude = this.getMinAltitude();\n        const extent = this._extent2D.convertTo(c => map._pointToContainerPoint(c, zoom, altitude / glScale, TEMP_POINT0), out);\n        const maxAltitude = this.getMaxAltitude();\n        if (maxAltitude !== altitude) {\n            const extent2 = this._extent2D.convertTo(c => map._pointToContainerPoint(c, zoom, maxAltitude / glScale, TEMP_POINT0), TEMP_EXTENT);\n            extent._combine(extent2);\n        }\n        const layer = this.geometry.getLayer();\n        if (this.geometry.type === 'LineString' && maxAltitude && layer.options['drawAltitude']) {\n            const groundExtent = this._extent2D.convertTo(c => map._pointToContainerPoint(c, zoom, 0, TEMP_POINT0), TEMP_EXTENT);\n            extent._combine(groundExtent);\n        }\n        if (extent) {\n            extent._add(this._fixedExtent);\n        }\n        const smoothness = this.geometry.options['smoothness'];\n        if (smoothness) {\n            extent._expand(extent.getWidth() * 0.15);\n        }\n        return extent;\n    }\n\n    _aboveCamera() {\n        const altitude = this.getMinAltitude();\n        const map = this.getMap();\n        const frustumAlt = map.getFrustumAltitude();\n        return altitude && frustumAlt && frustumAlt < altitude;\n    }\n\n    getFixedExtent() {\n        const map = this.getMap();\n        const zoom = map.getZoom();\n        if (!this._extent2D || this._extent2D._zoom !== zoom) {\n            this.get2DExtent(null, TEMP_FIXED_EXTENT);\n        }\n        return this._fixedExtent;\n    }\n\n    setZIndex(change) {\n        this._eachSymbolizer(function (symbolizer) {\n            symbolizer.setZIndex(change);\n        });\n    }\n\n    show() {\n        if (!this._painted) {\n            const layer = this.getLayer();\n            if (!layer.isCanvasRender()) {\n                this.paint();\n            }\n        } else {\n            this.removeCache();\n            this._eachSymbolizer(function (symbolizer) {\n                symbolizer.show();\n            });\n        }\n    }\n\n    hide() {\n        this._eachSymbolizer(function (symbolizer) {\n            symbolizer.hide();\n        });\n    }\n\n    repaint() {\n        this._altAtGLZoom = this._getGeometryAltitude();\n        this.removeCache();\n        const layer = this.getLayer();\n        if (!layer) {\n            return;\n        }\n        const renderer = layer.getRenderer();\n        if (!renderer || !renderer.setToRedraw()) {\n            return;\n        }\n        renderer.setToRedraw();\n    }\n\n    /**\n     * refresh symbolizers when symbol changed\n     */\n    refreshSymbol() {\n        this.removeCache();\n        this._removeSymbolizers();\n        this.symbolizers = this._createSymbolizers();\n    }\n\n    remove() {\n        this.removeCache();\n        this._removeSymbolizers();\n    }\n\n    _removeSymbolizers() {\n        this._eachSymbolizer(function (symbolizer) {\n            delete symbolizer.painter;\n            symbolizer.remove();\n        });\n        delete this.symbolizers;\n    }\n\n    /**\n     * delete painter's caches\n     */\n    removeCache() {\n        delete this._renderPoints;\n        delete this._paintParams;\n        delete this._sprite;\n        delete this._extent2D;\n        delete this._fixedExtent;\n        delete this._cachedParams;\n        delete this._unsimpledParams;\n        if (this.geometry) {\n            delete this.geometry[Symbolizers.TextMarkerSymbolizer.CACHE_KEY];\n        }\n    }\n\n    getAltitude() {\n        const propAlt = this._getAltitudeProperty();\n        if (propAlt !== this._propAlt) {\n            this._altAtGLZoom = this._getGeometryAltitude();\n        }\n        if (!this._altAtGLZoom) {\n            return 0;\n        }\n        return this._altAtGLZoom;\n    }\n\n    getMinAltitude() {\n        if (!this.minAltitude) {\n            return 0;\n        }\n        return this.minAltitude;\n    }\n\n    getMaxAltitude() {\n        if (!this.maxAltitude) {\n            return 0;\n        }\n        return this.maxAltitude;\n    }\n\n    _getGeometryAltitude() {\n        const map = this.getMap();\n        if (!map) {\n            return 0;\n        }\n        const altitude = this._getAltitudeProperty();\n        this._propAlt = altitude;\n        if (!altitude) {\n            this.minAltitude = this.maxAltitude = 0;\n            return 0;\n        }\n        const center = this.geometry.getCenter();\n        if (!center) {\n            return 0;\n        }\n        if (Array.isArray(altitude)) {\n            this.minAltitude = Number.MAX_VALUE;\n            this.maxAltitude = Number.MIN_VALUE;\n            return altitude.map(alt => {\n                const a = this._meterToPoint(center, alt);\n                if (a < this.minAltitude) {\n                    this.minAltitude = a;\n                }\n                if (a > this.maxAltitude) {\n                    this.maxAltitude = a;\n                }\n                return a;\n            });\n        } else {\n            this.minAltitude = this.maxAltitude = this._meterToPoint(center, altitude);\n            return this.minAltitude;\n        }\n    }\n\n    _meterToPoint(center, altitude) {\n        const map = this.getMap();\n        const z = map.getGLZoom();\n        const target = map.locate(center, altitude, 0);\n        const p0 = map.coordToPoint(center, z),\n            p1 = map.coordToPoint(target, z);\n        return Math.abs(p1.x - p0.x) * sign(altitude);\n    }\n\n    _getAltitudeProperty() {\n        const geometry = this.geometry,\n            layerOpts = geometry.getLayer().options,\n            properties = geometry.getProperties();\n        const altitude = layerOpts['enableAltitude'] ? properties ? properties[layerOpts['altitudeProperty']] : 0 : 0;\n        return altitude;\n    }\n\n    _verifyProjection() {\n        const projection = this.geometry._getProjection();\n        if (this._projCode && this._projCode !== projection.code) {\n            this.removeCache();\n        }\n        this._projCode = projection.code;\n    }\n\n    _beforePaint() {\n        const textcache = this.geometry[Symbolizers.TextMarkerSymbolizer.CACHE_KEY];\n        if (!textcache) {\n            return;\n        }\n        for (const p in textcache) {\n            if (hasOwn(textcache, p)) {\n                textcache[p].active = false;\n            }\n        }\n    }\n\n    _afterPaint() {\n        const textcache = this.geometry[Symbolizers.TextMarkerSymbolizer.CACHE_KEY];\n        if (!textcache) {\n            return;\n        }\n        for (const p in textcache) {\n            if (hasOwn(textcache, p)) {\n                if (!textcache[p].active) {\n                    delete textcache[p];\n                }\n            }\n        }\n    }\n}\n\nfunction interpolateAlt(points, orig, altitude) {\n    if (!Array.isArray(altitude)) {\n        return points;\n    }\n    const parts = [];\n    for (let i = 0, l = points.length; i < l; i++) {\n        if (Array.isArray(points[i])) {\n            parts.push(interpolateAlt(points[i], orig, altitude));\n        } else {\n            const p = points[i];\n            if (!p.point.equals(orig[p.index])) {\n                let w0, w1;\n                if (p.index === 0) {\n                    w0 = p.index;\n                    w1 = p.index + 1;\n                } else {\n                    w0 = p.index - 1;\n                    w1 = p.index;\n                }\n\n                const t0 = p.point.distanceTo(orig[w1]);\n                const t = t0 / (t0 + orig[w0].distanceTo(p.point));\n                const alt = interpolate(altitude[w0], altitude[w1], 1 - t);\n                p.altitude = alt;\n                parts.push(p);\n            } else {\n                p.altitude = altitude[p.index];\n                parts.push(p);\n            }\n        }\n    }\n    return parts;\n}\n\nexport default Painter;\n","import Class from '../../core/Class';\nimport PointExtent from '../../geo/PointExtent';\n\nconst TEMP_EXTENT = new PointExtent();\n\n/**\n * @classdesc\n * Painter for collection type geometries\n * @class\n * @private\n */\nexport default class CollectionPainter extends Class {\n    /**\n     * @param {GeometryCollection} geometry - geometry to paint\n     */\n    constructor(geometry) {\n        super();\n        this.geometry = geometry;\n    }\n\n    _eachPainter(fn) {\n        const geometries = this.geometry.getGeometries();\n        let painter;\n        for (let i = 0, len = geometries.length; i < len; i++) {\n            painter = geometries[i]._getPainter();\n            if (!painter) {\n                continue;\n            }\n            if (painter) {\n                if (fn.call(this, painter) === false) {\n                    break;\n                }\n            }\n        }\n    }\n\n    paint(extent) {\n        if (!this.geometry) {\n            return;\n        }\n        this._eachPainter(painter => {\n            painter.paint(extent);\n        });\n    }\n\n    get2DExtent(resources, out) {\n        if (out) {\n            out.set(null, null, null, null);\n        }\n        let extent = out || new PointExtent();\n        this._eachPainter(painter => {\n            extent = extent._combine(painter.get2DExtent(resources, TEMP_EXTENT));\n        });\n        return extent;\n    }\n\n    getContainerExtent() {\n        let extent = new PointExtent();\n        this._eachPainter(painter => {\n            extent = extent.combine(painter.getContainerExtent());\n        });\n        return extent;\n    }\n\n    remove() {\n        const args = arguments;\n        this._eachPainter(painter => {\n            painter.remove.apply(painter, args);\n        });\n    }\n\n    setZIndex() {\n        const args = arguments;\n        this._eachPainter(painter => {\n            painter.setZIndex.apply(painter, args);\n        });\n    }\n\n    show() {\n        const args = arguments;\n        this._eachPainter(painter => {\n            painter.show.apply(painter, args);\n        });\n    }\n\n    hide() {\n        const args = arguments;\n        this._eachPainter(painter => {\n            painter.hide.apply(painter, args);\n        });\n    }\n\n    repaint() {\n        const args = arguments;\n        this._eachPainter(painter => {\n            painter.repaint.apply(painter, args);\n        });\n    }\n\n    refreshSymbol() {\n        const args = arguments;\n        this._eachPainter(painter => {\n            painter.refreshSymbol.apply(painter, args);\n        });\n    }\n\n    hasPoint() {\n        let result = false;\n        this._eachPainter(painter => {\n            if (painter.hasPoint()) {\n                result = true;\n                return false;\n            }\n            return true;\n        });\n        return result;\n    }\n\n    getMinAltitude() {\n        let first = true;\n        let result = 0;\n        this._eachPainter(painter => {\n            const alt = painter.getMinAltitude();\n            if (first || alt < result) {\n                first = false;\n                result = alt;\n            }\n        });\n        return result;\n    }\n\n    getMaxAltitude() {\n        let result = 0;\n        this._eachPainter(painter => {\n            const alt = painter.getMaxAltitude();\n            if (alt > result) {\n                result = alt;\n            }\n        });\n        return result;\n    }\n\n}\n","import { GEOMETRY_COLLECTION_TYPES, NUMERICAL_PROPERTIES } from '../core/Constants';\nimport Class from '../core/Class';\nimport Eventable from '../core/Eventable';\nimport JSONAble from '../core/JSONAble';\nimport Handlerable from '../handler/Handlerable';\nimport {\n    extend,\n    isNil,\n    isString,\n    isNumber,\n    isObject,\n    forEachCoord,\n    flash\n} from '../core/util';\nimport { extendSymbol } from '../core/util/style';\nimport { convertResourceUrl, getExternalResources } from '../core/util/resource';\nimport Coordinate from '../geo/Coordinate';\nimport Extent from '../geo/Extent';\nimport Painter from '../renderer/geometry/Painter';\nimport CollectionPainter from '../renderer/geometry/CollectionPainter';\nimport SpatialReference from '../map/spatial-reference/SpatialReference';\n\n/**\n * @property {Object} options                       - geometry options\n * @property {Boolean} [options.id=null]            - id of the geometry\n * @property {Boolean} [options.visible=true]       - whether the geometry is visible.\n * @property {Boolean} [options.editable=true]      - whether the geometry can be edited.\n * @property {Boolean} [options.interactive=true]   - whether the geometry can be interactived.\n * @property {String} [options.cursor=null]         - cursor style when mouseover the geometry, same as the definition in CSS.\n * @property {String} [options.measure=EPSG:4326]   - the measure code for the geometry, defines {@tutorial measureGeometry how it can be measured}.\n * @property {Boolean} [options.draggable=false]    - whether the geometry can be dragged.\n * @property {Boolean} [options.dragShadow=true]    - if true, during geometry dragging, a shadow will be dragged before geometry was moved.\n * @property {Boolean} [options.dragOnAxis=null]    - if set, geometry can only be dragged along the specified axis, possible values: x, y\n * @property {Number}  [options.zIndex=undefined]   - geometry's initial zIndex\n * @memberOf Geometry\n * @instance\n */\nconst options = {\n    'id': null,\n    'visible': true,\n    'interactive':true,\n    'editable': true,\n    'cursor': null,\n    'defaultProjection': 'EPSG:4326' // BAIDU, IDENTITY\n};\n\n/**\n * Base class for all the geometries. <br/>\n * It defines common methods that all the geometry classes share. <br>\n * It is abstract and not intended to be instantiated but extended.\n *\n * @category geometry\n * @abstract\n * @extends Class\n * @mixes Eventable\n * @mixes Handlerable\n * @mixes JSONAble\n * @mixes ui.Menuable\n */\nclass Geometry extends JSONAble(Eventable(Handlerable(Class))) {\n\n    constructor(options) {\n        const opts = extend({}, options);\n        const symbol = opts['symbol'];\n        const properties = opts['properties'];\n        const id = opts['id'];\n        delete opts['symbol'];\n        delete opts['id'];\n        delete opts['properties'];\n        super(opts);\n        if (symbol) {\n            this.setSymbol(symbol);\n        }\n        if (properties) {\n            this.setProperties(properties);\n        }\n        if (!isNil(id)) {\n            this.setId(id);\n        }\n    }\n\n    /**\n     * Returns the first coordinate of the geometry.\n     *\n     * @return {Coordinate} First Coordinate\n     */\n    getFirstCoordinate() {\n        if (this.type === 'GeometryCollection') {\n            const geometries = this.getGeometries();\n            if (!geometries.length) {\n                return null;\n            }\n            return geometries[0].getFirstCoordinate();\n        }\n        let coordinates = this.getCoordinates();\n        if (!Array.isArray(coordinates)) {\n            return coordinates;\n        }\n        do {\n            coordinates = coordinates[0];\n        } while (Array.isArray(coordinates) && coordinates.length > 0);\n        return coordinates;\n    }\n\n    /**\n     * Returns the last coordinate of the geometry.\n     *\n     * @return {Coordinate} Last Coordinate\n     */\n    getLastCoordinate() {\n        if (this.type === 'GeometryCollection') {\n            const geometries = this.getGeometries();\n            if (!geometries.length) {\n                return null;\n            }\n            return geometries[geometries.length - 1].getLastCoordinate();\n        }\n        let coordinates = this.getCoordinates();\n        if (!Array.isArray(coordinates)) {\n            return coordinates;\n        }\n        do {\n            coordinates = coordinates[coordinates.length - 1];\n        } while (Array.isArray(coordinates) && coordinates.length > 0);\n        return coordinates;\n    }\n\n    /**\n     * Adds the geometry to a layer\n     * @param {Layer} layer    - layer add to\n     * @param {Boolean} [fitview=false] - automatically set the map to a fit center and zoom for the geometry\n     * @return {Geometry} this\n     * @fires Geometry#add\n     */\n    addTo(layer, fitview) {\n        layer.addGeometry(this, fitview);\n        return this;\n    }\n\n    /**\n     * Get the layer which this geometry added to.\n     * @returns {Layer} - layer added to\n     */\n    getLayer() {\n        if (!this._layer) {\n            return null;\n        }\n        return this._layer;\n    }\n\n    /**\n     * Get the map which this geometry added to\n     * @returns {Map} - map added to\n     */\n    getMap() {\n        if (!this._layer) {\n            return null;\n        }\n        return this._layer.getMap();\n    }\n\n    /**\n     * Gets geometry's id. Id is set by setId or constructor options.\n     * @returns {String|Number} geometry的id\n     */\n    getId() {\n        return this._id;\n    }\n\n    /**\n     * Set geometry's id.\n     * @param {String} id - new id\n     * @returns {Geometry} this\n     * @fires Geometry#idchange\n     */\n    setId(id) {\n        const oldId = this.getId();\n        this._id = id;\n        /**\n         * idchange event.\n         *\n         * @event Geometry#idchange\n         * @type {Object}\n         * @property {String} type - idchange\n         * @property {Geometry} target - the geometry fires the event\n         * @property {String|Number} old        - value of the old id\n         * @property {String|Number} new        - value of the new id\n         */\n        this._fireEvent('idchange', {\n            'old': oldId,\n            'new': id\n        });\n\n        return this;\n    }\n\n    /**\n     * Get geometry's properties. Defined by GeoJSON as [feature's properties]{@link http://geojson.org/geojson-spec.html#feature-objects}.\n     *\n     * @returns {Object} properties\n     */\n    getProperties() {\n        if (!this.properties) {\n            if (this._getParent()) {\n                return this._getParent().getProperties();\n            }\n            return null;\n        }\n        return this.properties;\n    }\n\n    /**\n     * Set a new properties to geometry.\n     * @param {Object} properties - new properties\n     * @returns {Geometry} this\n     * @fires Geometry#propertieschange\n     */\n    setProperties(properties) {\n        const old = this.properties;\n        this.properties = isObject(properties) ? extend({}, properties) : properties;\n        this._repaint();\n        /**\n         * propertieschange event, thrown when geometry's properties is changed.\n         *\n         * @event Geometry#propertieschange\n         * @type {Object}\n         * @property {String} type - propertieschange\n         * @property {Geometry} target - the geometry fires the event\n         * @property {String|Number} old        - value of the old properties\n         * @property {String|Number} new        - value of the new properties\n         */\n        this._fireEvent('propertieschange', {\n            'old': old,\n            'new': properties\n        });\n\n        return this;\n    }\n\n    /**\n     * Get type of the geometry, e.g. \"Point\", \"LineString\"\n     * @returns {String} type of the geometry\n     */\n    getType() {\n        return this.type;\n    }\n\n    /**\n     * Get symbol of the geometry\n     * @returns {Object} geometry's symbol\n     */\n    getSymbol() {\n        const s = this._symbol;\n        if (s) {\n            if (!Array.isArray(s)) {\n                return extend({}, s);\n            } else {\n                return extendSymbol(s);\n            }\n        }\n        return null;\n    }\n\n    /**\n     * Set a new symbol to style the geometry.\n     * @param {Object} symbol - new symbol\n     * @see {@tutorial symbol Style a geometry with symbols}\n     * @return {Geometry} this\n     * @fires Geometry#symbolchange\n     */\n    setSymbol(symbol) {\n        this._symbol = this._prepareSymbol(symbol);\n        this.onSymbolChanged();\n        return this;\n    }\n\n    /**\n     * Update geometry's current symbol.\n     *\n     * @param  {Object} props - symbol properties to update\n     * @return {Geometry} this\n     * @fires Geometry#symbolchange\n     * @example\n     * var marker = new Marker([0, 0], {\n     *    symbol : {\n     *       markerType : 'ellipse',\n     *       markerWidth : 20,\n     *       markerHeight : 30\n     *    }\n     * });\n     * // update symbol's markerWidth to 40\n     * marker.updateSymbol({\n     *     markerWidth : 40\n     * });\n     */\n    updateSymbol(props) {\n        if (!props) {\n            return this;\n        }\n        let s = this._getSymbol();\n        if (s) {\n            s = extendSymbol(s, props);\n        } else {\n            s = extendSymbol(this._getInternalSymbol(), props);\n        }\n        return this.setSymbol(s);\n    }\n\n    /**\n     * Get the geographical center of the geometry.\n     *\n     * @returns {Coordinate}\n     */\n    getCenter() {\n        return this._computeCenter(this._getMeasurer());\n    }\n\n    /**\n     * Get the geometry's geographical extent\n     *\n     * @returns {Extent} geometry's extent\n     */\n    getExtent() {\n        const prjExt = this._getPrjExtent();\n        if (prjExt) {\n            const p = this._getProjection();\n            const min = p.unproject(new Coordinate(prjExt['xmin'], prjExt['ymin'])),\n                max = p.unproject(new Coordinate(prjExt['xmax'], prjExt['ymax']));\n            return new Extent(min, max, this._getProjection());\n        } else {\n            return this._computeExtent(this._getMeasurer());\n        }\n    }\n\n    /**\n     * Get geometry's screen extent in pixel\n     *\n     * @returns {PointExtent}\n     */\n    getContainerExtent(out) {\n        const painter = this._getPainter();\n        return painter ? painter.getContainerExtent(out) : null;\n    }\n\n    /**\n     * Get pixel size of the geometry, which may vary in different zoom levels.\n     *\n     * @returns {Size}\n     */\n    getSize() {\n        const extent = this.getContainerExtent();\n        return extent ? extent.getSize() : null;\n    }\n\n    /**\n     * Whehter the geometry contains the input container point.\n     *\n     * @param  {Point|Coordinate} point - input container point or coordinate\n     * @param  {Number} [t=undefined] - tolerance in pixel\n     * @return {Boolean}\n     * @example\n     * var circle = new Circle([0, 0], 1000)\n     *     .addTo(layer);\n     * var contains = circle.containsPoint(new maptalks.Point(400, 300));\n     */\n    containsPoint(containerPoint, t) {\n        if (!this.getMap()) {\n            throw new Error('The geometry is required to be added on a map to perform \"containsPoint\".');\n        }\n        if (containerPoint instanceof Coordinate) {\n            containerPoint = this.getMap().coordToContainerPoint(containerPoint);\n        }\n        return this._containsPoint(containerPoint, t);\n        // return this._containsPoint(this.getMap()._containerPointToPoint(new Point(containerPoint)), t);\n    }\n\n    _containsPoint(containerPoint, t) {\n        const painter = this._getPainter();\n        if (!painter) {\n            return false;\n        }\n        if (isNil(t) && this._hitTestTolerance) {\n            t = this._hitTestTolerance();\n        }\n        return painter.hitTest(containerPoint, t);\n    }\n\n    /**\n     * Show the geometry.\n     *\n     * @return {Geometry} this\n     * @fires Geometry#show\n     */\n    show() {\n        this.options['visible'] = true;\n        if (this.getMap()) {\n            const painter = this._getPainter();\n            if (painter) {\n                painter.show();\n            }\n            /**\n             * show event\n             *\n             * @event Geometry#show\n             * @type {Object}\n             * @property {String} type - show\n             * @property {Geometry} target - the geometry fires the event\n             */\n            this._fireEvent('show');\n        }\n        return this;\n    }\n\n    /**\n     * Hide the geometry\n     *\n     * @return {Geometry} this\n     * @fires Geometry#hide\n     */\n    hide() {\n        this.options['visible'] = false;\n        if (this.getMap()) {\n            this.onHide();\n            const painter = this._getPainter();\n            if (painter) {\n                painter.hide();\n            }\n            /**\n             * hide event\n             *\n             * @event Geometry#hide\n             * @type {Object}\n             * @property {String} type - hide\n             * @property {Geometry} target - the geometry fires the event\n             */\n            this._fireEvent('hide');\n        }\n        return this;\n    }\n\n    /**\n     * Whether the geometry is visible\n     *\n     * @returns {Boolean}\n     */\n    isVisible() {\n        if (!this.options['visible']) {\n            return false;\n        }\n        const symbol = this._getInternalSymbol();\n        if (!symbol) {\n            return true;\n        }\n        if (Array.isArray(symbol)) {\n            if (!symbol.length) {\n                return true;\n            }\n            for (let i = 0, l = symbol.length; i < l; i++) {\n                if (isNil(symbol[i]['opacity']) || symbol[i]['opacity'] > 0) {\n                    return true;\n                }\n            }\n            return false;\n        } else {\n            return (isNil(symbol['opacity']) || (isNumber(symbol['opacity']) && symbol['opacity'] > 0));\n        }\n    }\n\n    /**\n     * Get zIndex of the geometry, default is 0\n     * @return {Number} zIndex\n     */\n    getZIndex() {\n        return this.options['zIndex'] || 0;\n    }\n\n    /**\n     * Set a new zIndex to Geometry and fire zindexchange event (will cause layer to sort geometries and render)\n     * @param {Number} zIndex - new zIndex\n     * @return {Geometry} this\n     * @fires Geometry#zindexchange\n     */\n    setZIndex(zIndex) {\n        const old = this.options['zIndex'];\n        this.options['zIndex'] = zIndex;\n        /**\n         * zindexchange event, fired when geometry's zIndex is changed.\n         *\n         * @event Geometry#zindexchange\n         * @type {Object}\n         * @property {String} type - zindexchange\n         * @property {Geometry} target - the geometry fires the event\n         * @property {Number} old        - old zIndex\n         * @property {Number} new        - new zIndex\n         */\n        this._fireEvent('zindexchange', {\n            'old': old,\n            'new': zIndex\n        });\n\n        return this;\n    }\n\n    /**\n     * Only set a new zIndex to Geometry without firing zindexchange event. <br>\n     * Can be useful to improve perf when a lot of geometries' zIndex need to be updated. <br>\n     * When updated N geometries, You can use setZIndexSilently with (N-1) geometries and use setZIndex with the last geometry for layer to sort and render.\n     * @param {Number} zIndex - new zIndex\n     * @return {Geometry} this\n     */\n    setZIndexSilently(zIndex) {\n        this.options['zIndex'] = zIndex;\n        return this;\n    }\n\n    /**\n     * Bring the geometry on the top\n     * @return {Geometry} this\n     * @fires Geometry#zindexchange\n     */\n    bringToFront() {\n        const layer = this.getLayer();\n        if (!layer || !layer.getGeoMaxZIndex) {\n            return this;\n        }\n        const topZ = layer.getGeoMaxZIndex();\n        this.setZIndex(topZ + 1);\n        return this;\n    }\n\n    /**\n     * Bring the geometry to the back\n     * @return {Geometry} this\n     * @fires Geometry#zindexchange\n     */\n    bringToBack() {\n        const layer = this.getLayer();\n        if (!layer || !layer.getGeoMinZIndex) {\n            return this;\n        }\n        const bottomZ = layer.getGeoMinZIndex();\n        this.setZIndex(bottomZ - 1);\n        return this;\n    }\n\n    /**\n     * Translate or move the geometry by the given offset.\n     *\n     * @param  {Coordinate} offset - translate offset\n     * @return {Geometry} this\n     * @fires Geometry#positionchange\n     * @fires Geometry#shapechange\n     */\n    /**\n     * Translate or move the geometry by the given offset.\n     *\n     * @param  {Number} x - x offset\n     * @param  {Number} y - y offset\n     * @return {Geometry} this\n     * @fires Geometry#positionchange\n     * @fires Geometry#shapechange\n     */\n    translate(x, y) {\n        if (isNil(x)) {\n            return this;\n        }\n        const offset = new Coordinate(x, y);\n        if (offset.x === 0 && offset.y === 0) {\n            return this;\n        }\n        const coordinates = this.getCoordinates();\n        if (coordinates) {\n            if (Array.isArray(coordinates)) {\n                const translated = forEachCoord(coordinates, function (coord) {\n                    return coord.add(offset);\n                });\n                this.setCoordinates(translated);\n            } else {\n                this.setCoordinates(coordinates.add(offset));\n            }\n        }\n        return this;\n    }\n\n    /**\n     * Flash the geometry, show and hide by certain internal for times of count.\n     *\n     * @param {Number} [interval=100]     - interval of flash, in millisecond (ms)\n     * @param {Number} [count=4]          - flash times\n     * @param {Function} [cb=null]        - callback function when flash ended\n     * @param {*} [context=null]          - callback context\n     * @return {Geometry} this\n     */\n    flash(interval, count, cb, context) {\n        return flash.call(this, interval, count, cb, context);\n    }\n\n    /**\n     * Returns a copy of the geometry without the event listeners.\n     * @returns {Geometry} copy\n     */\n    copy() {\n        const json = this.toJSON();\n        const ret = Geometry.fromJSON(json);\n        //restore visibility\n        ret.options['visible'] = true;\n        return ret;\n    }\n\n\n    /**\n     * remove itself from the layer if any.\n     * @returns {Geometry} this\n     * @fires Geometry#removestart\n     * @fires Geometry#remove\n     */\n    remove() {\n        const layer = this.getLayer();\n        if (!layer) {\n            return this;\n        }\n        /**\n         * removestart event.\n         *\n         * @event Geometry#removestart\n         * @type {Object}\n         * @property {String} type - removestart\n         * @property {Geometry} target - the geometry fires the event\n         */\n        this._fireEvent('removestart');\n\n        this._unbind();\n        /**\n         * removeend event.\n         *\n         * @event Geometry#removeend\n         * @type {Object}\n         * @property {String} type - removeend\n         * @property {Geometry} target - the geometry fires the event\n         */\n        this._fireEvent('removeend');\n        /**\n         * remove event.\n         *\n         * @event Geometry#remove\n         * @type {Object}\n         * @property {String} type - remove\n         * @property {Geometry} target - the geometry fires the event\n         */\n        this._fireEvent('remove');\n        return this;\n    }\n\n    /**\n     * Exports [geometry]{@link http://geojson.org/geojson-spec.html#feature-objects} out of a GeoJSON feature.\n     * @return {Object} GeoJSON Geometry\n     */\n    toGeoJSONGeometry() {\n        const gJson = this._exportGeoJSONGeometry();\n        return gJson;\n    }\n\n    /**\n     * Exports a GeoJSON feature.\n     * @param {Object} [opts=null]              - export options\n     * @param {Boolean} [opts.geometry=true]    - whether export geometry\n     * @param {Boolean} [opts.properties=true]  - whether export properties\n     * @returns {Object} GeoJSON Feature\n     */\n    toGeoJSON(opts) {\n        if (!opts) {\n            opts = {};\n        }\n        const feature = {\n            'type': 'Feature',\n            'geometry': null\n        };\n        if (isNil(opts['geometry']) || opts['geometry']) {\n            const geoJSON = this._exportGeoJSONGeometry();\n            feature['geometry'] = geoJSON;\n        }\n        const id = this.getId();\n        if (!isNil(id)) {\n            feature['id'] = id;\n        }\n        let properties;\n        if (isNil(opts['properties']) || opts['properties']) {\n            properties = this._exportProperties();\n        }\n        feature['properties'] = properties;\n        return feature;\n    }\n\n    /**\n     * Export a profile json out of the geometry. <br>\n     * Besides exporting the feature object, a profile json also contains symbol, construct options and infowindow info.<br>\n     * The profile json can be stored somewhere else and be used to reproduce the geometry later.<br>\n     * Due to the problem of serialization for functions, event listeners and contextmenu are not included in profile json.\n     * @example\n     *     // an example of a profile json.\n     * var profile = {\n            \"feature\": {\n                  \"type\": \"Feature\",\n                  \"id\" : \"point1\",\n                  \"geometry\": {\"type\": \"Point\", \"coordinates\": [102.0, 0.5]},\n                  \"properties\": {\"prop0\": \"value0\"}\n            },\n            //construct options.\n            \"options\":{\n                \"draggable\" : true\n            },\n            //symbol\n            \"symbol\":{\n                \"markerFile\"  : \"http://foo.com/icon.png\",\n                \"markerWidth\" : 20,\n                \"markerHeight\": 20\n            },\n            //infowindow info\n            \"infowindow\" : {\n                \"options\" : {\n                    \"style\" : \"black\"\n                },\n                \"title\" : \"this is a infowindow title\",\n                \"content\" : \"this is a infowindow content\"\n            }\n        };\n     * @param {Object}  [options=null]          - export options\n     * @param {Boolean} [opts.geometry=true]    - whether export feature's geometry\n     * @param {Boolean} [opts.properties=true]  - whether export feature's properties\n     * @param {Boolean} [opts.options=true]     - whether export construct options\n     * @param {Boolean} [opts.symbol=true]      - whether export symbol\n     * @param {Boolean} [opts.infoWindow=true]  - whether export infowindow\n     * @return {Object} profile json object\n     */\n    toJSON(options) {\n        //一个Graphic的profile\n        /*\n            //因为响应函数无法被序列化, 所以menu, 事件listener等无法被包含在graphic中\n        }*/\n        if (!options) {\n            options = {};\n        }\n        const json = this._toJSON(options);\n        const other = this._exportGraphicOptions(options);\n        extend(json, other);\n        return json;\n    }\n\n    /**\n     * Get the geographic length of the geometry.\n     * @returns {Number} geographic length, unit is meter\n     */\n    getLength() {\n        return this._computeGeodesicLength(this._getMeasurer());\n    }\n\n    /**\n     * Get the geographic area of the geometry.\n     * @returns {Number} geographic area, unit is sq.meter\n     */\n    getArea() {\n        return this._computeGeodesicArea(this._getMeasurer());\n    }\n\n    /**\n     * Rotate the geometry of given angle around a pivot point\n     * @param {Number} angle - angle to rotate in degree\n     * @param {Coordinate} [pivot=null]  - optional, will be the geometry's center by default\n     * @returns {Geometry} this\n     */\n    rotate(angle, pivot) {\n        if (this.type === 'GeometryCollection') {\n            const geometries = this.getGeometries();\n            geometries.forEach(g => g.rotate(angle, pivot));\n            return this;\n        }\n        if (!pivot) {\n            pivot = this.getCenter();\n        } else {\n            pivot = new Coordinate(pivot);\n        }\n        const measurer = this._getMeasurer();\n        const coordinates = this.getCoordinates();\n        if (!Array.isArray(coordinates)) {\n            if (pivot.x !== coordinates.x || pivot.y !== coordinates.y) {\n                const c = measurer._rotate(coordinates, pivot, angle);\n                this.setCoordinates(c);\n            }\n            return this;\n        }\n        forEachCoord(coordinates, c => {\n            return measurer._rotate(c, pivot, angle);\n        });\n        this.setCoordinates(coordinates);\n        return this;\n    }\n\n    /**\n     * Get the connect points for [ConnectorLine]{@link ConnectorLine}\n     * @return {Coordinate[]} connect points\n     * @private\n     */\n    _getConnectPoints() {\n        return [this.getCenter()];\n    }\n\n    //options initializing\n    _initOptions(options) {\n        const opts = extend({}, options);\n        const symbol = opts['symbol'];\n        const properties = opts['properties'];\n        const id = opts['id'];\n        delete opts['symbol'];\n        delete opts['id'];\n        delete opts['properties'];\n        this.setOptions(opts);\n        if (symbol) {\n            this.setSymbol(symbol);\n        }\n        if (properties) {\n            this.setProperties(properties);\n        }\n        if (!isNil(id)) {\n            this.setId(id);\n        }\n    }\n\n    //bind the geometry to a layer\n    _bindLayer(layer) {\n        //check dupliaction\n        if (this.getLayer()) {\n            throw new Error('Geometry cannot be added to two or more layers at the same time.');\n        }\n        this._layer = layer;\n        this._clearCache();\n        this._clearProjection();\n        // this.callInitHooks();\n    }\n\n    _prepareSymbol(symbol) {\n        if (Array.isArray(symbol)) {\n            const cookedSymbols = [];\n            for (let i = 0; i < symbol.length; i++) {\n                cookedSymbols.push(convertResourceUrl(this._checkAndCopySymbol(symbol[i])));\n            }\n            return cookedSymbols;\n        } else if (symbol) {\n            symbol = this._checkAndCopySymbol(symbol);\n            return convertResourceUrl(symbol);\n        }\n        return null;\n    }\n\n    _checkAndCopySymbol(symbol) {\n        const s = {};\n        for (const i in symbol) {\n            if (NUMERICAL_PROPERTIES[i] && isString(symbol[i])) {\n                s[i] = +symbol[i];\n            } else {\n                s[i] = symbol[i];\n            }\n        }\n        return s;\n    }\n\n    _getSymbol() {\n        return this._symbol;\n    }\n\n    /**\n     * Sets a external symbol to the geometry, e.g. style from VectorLayer's setStyle\n     * @private\n     * @param {Object} symbol - external symbol\n     */\n    _setExternSymbol(symbol) {\n        this._externSymbol = this._prepareSymbol(symbol);\n        this.onSymbolChanged();\n        return this;\n    }\n\n    _getInternalSymbol() {\n        if (this._symbol) {\n            return this._symbol;\n        } else if (this._externSymbol) {\n            return this._externSymbol;\n        } else if (this.options['symbol']) {\n            return this.options['symbol'];\n        }\n        return null;\n    }\n\n    _getPrjExtent() {\n        const p = this._getProjection();\n        this._verifyProjection();\n        if (!this._extent && p) {\n            this._extent = this._computePrjExtent(p);\n        }\n        return this._extent;\n    }\n\n    _unbind() {\n        const layer = this.getLayer();\n        if (!layer) {\n            return;\n        }\n\n        if (this._animPlayer) {\n            this._animPlayer.finish();\n        }\n        this._clearHandlers();\n        //contextmenu\n        this._unbindMenu();\n        //infowindow\n        this._unbindInfoWindow();\n\n        if (this.isEditing()) {\n            this.endEdit();\n        }\n        this._removePainter();\n        if (this.onRemove) {\n            this.onRemove();\n        }\n        if (layer.onRemoveGeometry) {\n            layer.onRemoveGeometry(this);\n        }\n        delete this._layer;\n        delete this._internalId;\n        delete this._extent;\n    }\n\n    _getInternalId() {\n        return this._internalId;\n    }\n\n    //只能被图层调用\n    _setInternalId(id) {\n        this._internalId = id;\n    }\n\n    _getMeasurer() {\n        if (this._getProjection()) {\n            return this._getProjection();\n        }\n        return SpatialReference.getProjectionInstance(this.options['defaultProjection']);\n    }\n\n    _getProjection() {\n        const map = this.getMap();\n        if (map) {\n            return map.getProjection();\n        }\n        return null;\n    }\n\n    _verifyProjection() {\n        const projection = this._getProjection();\n        if (this._projCode && (!projection || this._projCode !== projection.code)) {\n            this._clearProjection();\n        }\n        this._projCode = projection ? projection.code : null;\n    }\n\n    //获取geometry样式中依赖的外部图片资源\n    _getExternalResources() {\n        const symbol = this._getInternalSymbol();\n        return getExternalResources(symbol);\n    }\n\n    _getPainter() {\n        if (!this._painter && this.getMap()) {\n            if (GEOMETRY_COLLECTION_TYPES.indexOf(this.type) !== -1) {\n                this._painter = new CollectionPainter(this);\n            } else {\n                this._painter = new Painter(this);\n            }\n        }\n        return this._painter;\n    }\n\n    _removePainter() {\n        if (this._painter) {\n            this._painter.remove();\n        }\n        delete this._painter;\n    }\n\n    _paint(extent) {\n        if (this._painter) {\n            this._painter.paint(extent);\n        }\n    }\n\n    _clearCache() {\n        delete this._extent;\n    }\n\n    _clearProjection() {\n        delete this._extent;\n    }\n\n    _repaint() {\n        if (this._painter) {\n            this._painter.repaint();\n        }\n    }\n\n    onHide() {\n        this.closeMenu();\n        this.closeInfoWindow();\n    }\n\n    onShapeChanged() {\n        this._clearCache();\n        this._repaint();\n        /**\n         * shapechange event.\n         *\n         * @event Geometry#shapechange\n         * @type {Object}\n         * @property {String} type - shapechange\n         * @property {Geometry} target - the geometry fires the event\n         */\n        this._fireEvent('shapechange');\n    }\n\n    onPositionChanged() {\n        this._clearCache();\n        this._repaint();\n        /**\n         * positionchange event.\n         *\n         * @event Geometry#positionchange\n         * @type {Object}\n         * @property {String} type - positionchange\n         * @property {Geometry} target - the geometry fires the event\n         */\n        this._fireEvent('positionchange');\n    }\n\n    onSymbolChanged() {\n        if (this._painter) {\n            this._painter.refreshSymbol();\n        }\n        /**\n         * symbolchange event.\n         *\n         * @event Geometry#symbolchange\n         * @type {Object}\n         * @property {String} type - symbolchange\n         * @property {Geometry} target - the geometry fires the event\n         */\n        this._fireEvent('symbolchange');\n    }\n\n    onConfig(conf) {\n        let properties;\n        if (conf['properties']) {\n            properties = conf['properties'];\n            delete conf['properties'];\n        }\n        let needRepaint = false;\n        for (const p in conf) {\n            if (conf.hasOwnProperty(p)) {\n                const prefix = p.slice(0, 5);\n                if (prefix === 'arrow' || prefix === 'smoot') {\n                    needRepaint = true;\n                    break;\n                }\n            }\n        }\n        if (properties) {\n            this.setProperties(properties);\n            this._repaint();\n        } else if (needRepaint) {\n            this._repaint();\n        }\n    }\n\n    /**\n     * Set a parent to the geometry, which is usually a MultiPolygon, GeometryCollection, etc\n     * @param {GeometryCollection} geometry - parent geometry\n     * @private\n     */\n    _setParent(geometry) {\n        if (geometry) {\n            this._parent = geometry;\n        }\n    }\n\n    _getParent() {\n        return this._parent;\n    }\n\n    _fireEvent(eventName, param) {\n        if (this.getLayer() && this.getLayer()._onGeometryEvent) {\n            if (!param) {\n                param = {};\n            }\n            param['type'] = eventName;\n            param['target'] = this;\n            this.getLayer()._onGeometryEvent(param);\n        }\n        this.fire(eventName, param);\n    }\n\n    _toJSON(options) {\n        return {\n            'feature': this.toGeoJSON(options)\n        };\n    }\n\n    _exportGraphicOptions(options) {\n        const json = {};\n        if (isNil(options['options']) || options['options']) {\n            json['options'] = this.config();\n        }\n        if (isNil(options['symbol']) || options['symbol']) {\n            json['symbol'] = this.getSymbol();\n        }\n        if (isNil(options['infoWindow']) || options['infoWindow']) {\n            if (this._infoWinOptions) {\n                json['infoWindow'] = this._infoWinOptions;\n            }\n        }\n        return json;\n    }\n\n    _exportGeoJSONGeometry() {\n        const points = this.getCoordinates();\n        const coordinates = Coordinate.toNumberArrays(points);\n        return {\n            'type': this.getType(),\n            'coordinates': coordinates\n        };\n    }\n\n    _exportProperties() {\n        let properties = null;\n        const geoProperties = this.getProperties();\n        if (!isNil(geoProperties)) {\n            if (isObject(geoProperties)) {\n                properties = extend({}, geoProperties);\n            } else {\n                properties = geoProperties;\n            }\n        }\n        return properties;\n    }\n\n}\n\nGeometry.mergeOptions(options);\n\nexport default Geometry;\n","import { now, requestAnimFrame, cancelAnimFrame } from '../../core/util';\nimport { on, off, getEventContainerPoint, preventDefault, stopPropagation } from '../../core/util/dom';\nimport Handler from '../../handler/Handler';\nimport Geometry from '../../geometry/Geometry';\nimport Map from '../Map';\n\nconst EVENTS =\n    /**\n     * mousedown event\n     * @event Geometry#mousedown\n     * @type {Object}\n     * @property {String} type                    - mousedown\n     * @property {Geometry} target            - the Geometry fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'mousedown ' +\n    /**\n     * mouseup event\n     * @event Geometry#mouseup\n     * @type {Object}\n     * @property {String} type                    - mouseup\n     * @property {Geometry} target            - the Geometry fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'mouseup ' +\n    /**\n     * mousemove event\n     * @event Geometry#mousemove\n     * @type {Object}\n     * @property {String} type                    - mousemove\n     * @property {Geometry} target            - the Geometry fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'mousemove ' +\n    /**\n     * click event\n     * @event Geometry#click\n     * @type {Object}\n     * @property {String} type                    - click\n     * @property {Geometry} target            - the Geometry fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'click ' +\n    /**\n     * dblclick event\n     * @event Geometry#dblclick\n     * @type {Object}\n     * @property {String} type                    - dblclick\n     * @property {Geometry} target            - the Geometry fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'dblclick ' +\n    /**\n     * contextmenu event\n     * @event Geometry#contextmenu\n     * @type {Object}\n     * @property {String} type                    - contextmenu\n     * @property {Geometry} target            - the Geometry fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'contextmenu ' +\n    /**\n     * touchstart event\n     * @event Geometry#touchstart\n     * @type {Object}\n     * @property {String} type                    - touchstart\n     * @property {Geometry} target            - the Geometry fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'touchstart ' +\n    /**\n     * touchmove event\n     * @event Geometry#touchmove\n     * @type {Object}\n     * @property {String} type                    - touchmove\n     * @property {Geometry} target            - the Geometry fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'touchmove ' +\n    /**\n     * touchend event\n     * @event Geometry#touchend\n     * @type {Object}\n     * @property {String} type                    - touchend\n     * @property {Geometry} target            - the Geometry fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'touchend';\n    /**\n     * mouseenter event for geometry\n     * @event Geometry#mouseenter\n     * @type {Object}\n     * @property {String} type                    - mouseenter\n     * @property {Geometry} target       - the geometry fires mouseenter\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    /**\n     * mouseover event for geometry\n     * @event Geometry#mouseover\n     * @type {Object}\n     * @property {String} type                    - mouseover\n     * @property {Geometry} target       - the geometry fires mouseover\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    /**\n     * mouseout event for geometry\n     * @event Geometry#mouseout\n     * @type {Object}\n     * @property {String} type                    - mouseout\n     * @property {Geometry} target       - the geometry fires mouseout\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n\nclass MapGeometryEventsHandler extends Handler {\n\n    addHooks() {\n        const map = this.target;\n        const dom = map._panels.allLayers || map._containerDOM;\n        on(dom, EVENTS, this._identifyGeometryEvents, this);\n    }\n\n    removeHooks() {\n        const map = this.target;\n        const dom = map._panels.allLayers || map._containerDOM;\n        off(dom, EVENTS, this._identifyGeometryEvents, this);\n    }\n\n    _identifyGeometryEvents(domEvent, type) {\n        const map = this.target;\n        if (map.isInteracting() || map._ignoreEvent(domEvent)) {\n            return;\n        }\n        const layers = map._getLayers(layer => {\n            if (layer.identify && layer.options['geometryEvents']) {\n                return true;\n            }\n            return false;\n        });\n        if (!layers.length) {\n            return;\n        }\n        let oneMoreEvent = null;\n        const eventType = type || domEvent.type;\n        // ignore click lasted for more than 300ms.\n        if (eventType === 'mousedown' || (eventType === 'touchstart' && domEvent.touches.length === 1)) {\n            this._mouseDownTime = now();\n        } else if ((eventType === 'click' || eventType === 'touchend') && this._mouseDownTime) {\n            const downTime = this._mouseDownTime;\n            delete this._mouseDownTime;\n            const time = now();\n            if (time - downTime > 300) {\n                if (eventType === 'click') {\n                    return;\n                }\n            } else if (eventType === 'touchend') {\n                oneMoreEvent = 'click';\n            }\n        }\n\n\n        const actual = domEvent.touches && domEvent.touches.length > 0 ?\n            domEvent.touches[0] : domEvent.changedTouches && domEvent.changedTouches.length > 0 ?\n                domEvent.changedTouches[0] : domEvent;\n        if (!actual) {\n            return;\n        }\n        const containerPoint = getEventContainerPoint(actual, map._containerDOM),\n            coordinate = map.containerPointToCoordinate(containerPoint);\n        if (eventType === 'touchstart') {\n            preventDefault(domEvent);\n        }\n        let geometryCursorStyle = null;\n        const identifyOptions = {\n            'includeInternals': true,\n            //return only one geometry on top,\n            'filter': geometry => {\n                if (!(geometry instanceof Geometry)) {\n                    return false;\n                }\n                const eventToFire = geometry._getEventTypeToFire(domEvent);\n                if (eventType === 'mousemove') {\n                    if (!geometryCursorStyle && geometry.options['cursor']) {\n                        geometryCursorStyle = geometry.options['cursor'];\n                    }\n                    if (!geometry.listens('mousemove') && !geometry.listens('mouseover') && !geometry.listens('mouseenter')) {\n                        return false;\n                    }\n                } else if (!geometry.listens(eventToFire) && !geometry.listens(oneMoreEvent)) {\n                    return false;\n                }\n\n                return true;\n            },\n            'count': 1,\n            'coordinate': coordinate,\n            'onlyVisible' : map.options['onlyVisibleGeometryEvents'],\n            'layers': layers\n        };\n        const callback = fireGeometryEvent.bind(this);\n\n        if (this._queryIdentifyTimeout) {\n            cancelAnimFrame(this._queryIdentifyTimeout);\n        }\n        if (eventType === 'mousemove' || eventType === 'touchmove') {\n            this._queryIdentifyTimeout = requestAnimFrame(() => {\n                if (map.isInteracting()) {\n                    return;\n                }\n                map.identify(identifyOptions, callback);\n            });\n        } else {\n            map.identify(identifyOptions, callback);\n        }\n\n        function fireGeometryEvent(geometries) {\n            let propagation = true;\n            if (eventType === 'mousemove') {\n                const geoMap = {};\n                if (geometries.length > 0) {\n                    for (let i = geometries.length - 1; i >= 0; i--) {\n                        const geo = geometries[i];\n                        if (!(geo instanceof Geometry)) {\n                            continue;\n                        }\n                        const iid = geo._getInternalId();\n                        geoMap[iid] = geo;\n                        geo._onEvent(domEvent);\n                        if (!this._prevOverGeos || !this._prevOverGeos.geomap[iid]) {\n                            geo._onEvent(domEvent, 'mouseenter');\n                        }\n                        propagation = geo._onEvent(domEvent, 'mouseover');\n                    }\n                }\n\n                map._setPriorityCursor(geometryCursorStyle);\n\n                const oldTargets = this._prevOverGeos && this._prevOverGeos.geos;\n                this._prevOverGeos = {\n                    'geos' : geometries,\n                    'geomap' : geoMap\n                };\n                if (oldTargets && oldTargets.length > 0) {\n                    for (let i = oldTargets.length - 1; i >= 0; i--) {\n                        const oldTarget = oldTargets[i];\n                        if (!(oldTarget instanceof Geometry)) {\n                            continue;\n                        }\n                        const oldTargetId = oldTargets[i]._getInternalId();\n                        /**\n                         * 鼠标经过的新位置中不包含老的目标geometry\n                         */\n                        if (!geoMap[oldTargetId]) {\n                            propagation = oldTarget._onEvent(domEvent, 'mouseout');\n                        }\n                    }\n                }\n\n            } else {\n                if (!geometries || !geometries.length) { return; }\n                for (let i = geometries.length - 1; i >= 0; i--) {\n                    if (!(geometries[i] instanceof Geometry)) {\n                        continue;\n                    }\n                    propagation = geometries[i]._onEvent(domEvent);\n                    if (oneMoreEvent) {\n                        geometries[i]._onEvent(domEvent, oneMoreEvent);\n                    }\n                    break;\n                }\n            }\n            if (propagation === false) {\n                stopPropagation(domEvent);\n            }\n        }\n\n    }\n}\n\nMap.mergeOptions({\n    'geometryEvents': true,\n    'onlyVisibleGeometryEvents' : true\n});\n\nMap.addOnLoadHook('addHandler', 'geometryEvents', MapGeometryEventsHandler);\n\nexport default MapGeometryEventsHandler;\n","import { isNil } from '../../core/util';\nimport { addDomEvent, removeDomEvent, getEventContainerPoint, preventDefault, stopPropagation } from '../../core/util/dom';\nimport Handler from '../../handler/Handler';\nimport Map from '../Map';\n\n/*!\n * Contains code from mapbox-gl-js\n * http://github.com/mapbox/mapbox-gl-js\n * License BSD-3-Clause\n */\n\nconst wheelZoomDelta = 4.000244140625;\n\nconst defaultZoomRate = 1 / 100;\nconst wheelZoomRate = 1 / 450;\n\nconst maxScalePerFrame = 2;\n\nclass MapScrollWheelZoomHandler extends Handler {\n    constructor(target) {\n        super(target);\n        this._thisScrollZoom = this._scrollZoom.bind(this);\n        this._wheelZoomRate = wheelZoomRate;\n        this._defaultZoomRate = defaultZoomRate;\n        this._delta = 0;\n    }\n\n    addHooks() {\n        addDomEvent(this.target._containerDOM, 'mousewheel', this._onWheelScroll, this);\n    }\n\n    removeHooks() {\n        removeDomEvent(this.target._containerDOM, 'mousewheel', this._onWheelScroll);\n    }\n\n    _onWheelScroll(evt) {\n        const map = this.target;\n        if (map._ignoreEvent(evt) || !map.options['zoomable']) {\n            return false;\n        }\n        preventDefault(evt);\n        stopPropagation(evt);\n        const container = map._containerDOM;\n        const origin = map._checkZoomOrigin(getEventContainerPoint(evt, container));\n        if (map.options['seamlessZoom']) {\n            if (!this._zooming) {\n                this._trackPadSuspect = 0;\n                this._ensureTrackpad = false;\n            }\n            return this._seamless(evt, origin);\n        } else {\n            return this._interval(evt, origin);\n        }\n    }\n\n    _seamless(evt, origin) {\n        let value = evt.deltaMode === window.WheelEvent.DOM_DELTA_LINE ? evt.deltaY * 60 : evt.deltaY;\n        if (value % wheelZoomDelta !== 0) {\n            //according to https://archive.fo/ZV8gz\n            //value % wheelDelta === 0 means it must be  mouse on Mac OS X\n            if (!this._ensureTrackpad) {\n                if (Math.abs(value) < 60) {\n                    this._trackPadSuspect++;\n                } else {\n                    this._trackPadSuspect = 0;\n                }\n                //repeated very small delta value ensure it's a trackpad\n                if (this._trackPadSuspect >= 2) {\n                    this._ensureTrackpad = true;\n                }\n            }\n            if (this._ensureTrackpad) {\n                value *= 14;\n            }\n        }\n\n        if (evt.shiftKey && value) value = value / 4;\n\n        this._lastWheelEvent = evt;\n        this._delta -= value;\n        if (!this._zooming && this._delta) {\n            const map = this.target;\n            this._zoomOrigin = origin;\n            map.onZoomStart(null, origin);\n        }\n        this._start();\n    }\n\n    _start() {\n        if (!this._delta) return;\n        this._zooming = true;\n        const map = this.target;\n        if (!this._active) {\n            map.getRenderer().callInNextFrame(this._thisScrollZoom);\n            this._active = true;\n        }\n    }\n\n    _scrollZoom() {\n        this._active = false;\n        if (!this._delta) {\n            return;\n        }\n        const zoomRate = (Math.abs(this._delta) > wheelZoomDelta) ? this._wheelZoomRate : this._defaultZoomRate;\n        let scale = maxScalePerFrame / (1 + Math.exp(-Math.abs(this._delta * zoomRate)));\n        if (this._delta < 0 && scale !== 0) {\n            scale = 1 / scale;\n        }\n        const map = this.target;\n        const zoom = map.getZoom();\n        const targetZoom = map.getZoomForScale(scale, zoom, true);\n        this._delta = 0;\n        map.onZooming(targetZoom, this._zoomOrigin);\n        if (this._timeout) {\n            clearTimeout(this._timeout);\n        }\n        this._timeout = setTimeout(() => {\n            this._zooming = false;\n            delete this._timeout;\n            map.onZoomEnd(map.getZoom(), this._zoomOrigin);\n        }, 320);\n    }\n\n    _interval(evt, origin) {\n        const map = this.target;\n        if (this._zooming) {\n            this._requesting++;\n            return false;\n        }\n        this._requesting = 0;\n        let levelValue = (evt.wheelDelta ? evt.wheelDelta : evt.detail) > 0 ? 1 : -1;\n        if (evt.detail) {\n            levelValue *= -1;\n        }\n        const zoom = map.getZoom();\n        let nextZoom = zoom + levelValue;\n        nextZoom = map._checkZoom(levelValue > 0 ? Math.ceil(nextZoom) : Math.floor(nextZoom));\n        if (nextZoom === zoom) {\n            return false;\n        }\n        this._zooming = true;\n        if (!this._delta) {\n            map.onZoomStart(null, origin);\n            this._origin = origin;\n            this._delta = levelValue;\n            this._startZoom = map.getZoom();\n        }\n        const duration = 90;\n        map.animateTo({\n            'zoom' : nextZoom - this._delta * 1 / 2,\n            'around' : this._origin\n        }, {\n            'continueOnViewChanged' : true,\n            'easing' : 'linear',\n            'duration' : duration,\n            'wheelZoom' : true\n        }, frame => {\n            if (frame.state.playState !== 'finished') {\n                return;\n            }\n            if (this._requesting < 1 || Math.abs(nextZoom - this._startZoom) > 2 ||\n                //finish zooming if target zoom hits min/max\n                nextZoom === map.getMaxZoom() || nextZoom === map.getMinZoom()) {\n\n                map.animateTo({\n                    'zoom' : nextZoom,\n                    'around' : this._origin\n                }, {\n                    'continueOnViewChanged' : true,\n                    'duration' : 100\n                }, frame => {\n                    if (frame.state.playState === 'finished') {\n                        setTimeout(() => {\n                            delete this._zooming;\n                            delete this._requesting;\n                        }, 200);\n                    }\n                });\n                delete this._startZoom;\n                delete this._origin;\n                delete this._delta;\n                this._requesting = 0;\n            } else if (!isNil(this._requesting)) {\n                delete this._zooming;\n                this._onWheelScroll(evt);\n            }\n        });\n        return false;\n    }\n}\n\nMap.mergeOptions({\n    'scrollWheelZoom': true,\n    'seamlessZoom': false\n});\n\nMap.addOnLoadHook('addHandler', 'scrollWheelZoom', MapScrollWheelZoomHandler);\n\nexport default MapScrollWheelZoomHandler;\n","import { off, addDomEvent, removeDomEvent, getEventContainerPoint, preventDefault } from '../../core/util/dom';\nimport Handler from '../../handler/Handler';\nimport Point from '../../geo/Point';\nimport Map from '../Map';\n\n//handler to zoom map by pinching\nclass MapTouchZoomHandler extends Handler {\n    addHooks() {\n        addDomEvent(this.target.getContainer(), 'touchstart', this._onTouchStart, this);\n    }\n\n    removeHooks() {\n        removeDomEvent(this.target.getContainer(), 'touchstart', this._onTouchStart);\n    }\n\n    _onTouchStart(event) {\n        const map = this.target;\n        if (!event.touches || event.touches.length !== 2 || map.isInteracting()) {\n            return;\n        }\n        const container = map.getContainer();\n        const p1 = getEventContainerPoint(event.touches[0], container),\n            p2 = getEventContainerPoint(event.touches[1], container);\n\n        this.preY = p1.y;\n        this._startP1 = p1;\n        this._startP2 = p2;\n        this._startDist = p1.distanceTo(p2);\n        this._startVector = p1.sub(p2);\n        this._startZoom = map.getZoom();\n        this._startBearing = map.getBearing();\n\n        addDomEvent(document, 'touchmove', this._onTouchMove, this);\n        addDomEvent(document, 'touchend', this._onTouchEnd, this);\n        preventDefault(event);\n\n        /**\n          * touchactstart event\n          * @event Map#touchactstart\n          * @type {Object}\n          * @property {String} type                    - touchactstart\n          * @property {Map} target                     - the map fires event\n          */\n        map._fireEvent('touchactstart');\n    }\n\n    _onTouchMove(event) {\n        const map = this.target;\n        if (!event.touches || event.touches.length !== 2) {\n            return;\n        }\n        const container = map.getContainer(),\n            p1 = getEventContainerPoint(event.touches[0], container),\n            p2 = getEventContainerPoint(event.touches[1], container),\n            d1 = p1.sub(this._startP1),\n            d2 = p2.sub(this._startP2),\n            vector = p1.sub(p2),\n            scale = p1.distanceTo(p2) / this._startDist,\n            bearing = vector.angleWith(this._startVector) * 180 / Math.PI,\n            preY = this.preY || p1.y,\n            pitch = (preY - p1.y) * 0.4;\n        // console.log(preY, p1.y);\n        this.preY = p1.y;\n        const param = {\n            'domEvent': event,\n            'mousePos': [p1, p2]\n        };\n        if (!this.mode) {\n            if (map.options['touchRotate'] && Math.abs(bearing) > 8) {\n                this.mode = map.options['touchZoomRotate'] ? 'rotate_zoom' : 'rotate';\n            } else if (map.options['touchPitch'] && d1.y * d2.y > 0 && Math.abs(d1.y) > 10 && Math.abs(d2.y) > 10) {\n                this.mode = 'pitch';\n            } else if (map.options['zoomable'] && map.options['touchZoom'] && Math.abs(1 - scale) > 0.15) {\n                this.mode = map.options['touchZoomRotate'] && map.options['touchRotate'] ? 'rotate_zoom' : 'zoom';\n            }\n            this._startTouching(param);\n        }\n        if (this.mode === 'zoom' || this.mode === 'rotate_zoom') {\n            this._scale = scale;\n            const res = map._getResolution(this._startZoom) / scale;\n            const zoom = map.getZoomFromRes(res);\n            map.onZooming(zoom, this._Origin);\n        }\n        if (this.mode === 'rotate' || this.mode === 'rotate_zoom') {\n            map.setBearing(this._startBearing + bearing);\n            map.onDragRotating(param);\n        } else if (this.mode === 'pitch') {\n            map.setPitch(map.getPitch() + pitch);\n            map.onDragRotating(param);\n        }\n        /**\n          * touchacting event\n          * @event Map#touchacting\n          * @type {Object}\n          * @property {String} type                    - touchacting\n          * @property {Map} target                     - the map fires event\n          */\n        map._fireEvent('touchactinging');\n    }\n\n    _startTouching(param) {\n        const map = this.target;\n        if (this.mode === 'zoom' || this.mode === 'rotate_zoom') {\n            const size = map.getSize();\n            this._Origin = new Point(size['width'] / 2, size['height'] / 2);\n            map.onZoomStart(null, this._Origin);\n        }\n        if (this.mode === 'rotate' || this.mode === 'pitch' || this.mode === 'rotate_zoom') {\n            map.onDragRotateStart(param);\n        }\n    }\n\n    _onTouchEnd(event) {\n        delete this.preY;\n        const map = this.target;\n\n        off(document, 'touchmove', this._onTouchMove, this);\n        off(document, 'touchend', this._onTouchEnd, this);\n\n        if (this.mode === 'zoom' || this.mode === 'rotate_zoom') {\n            const scale = this._scale;\n            const res = map._getResolution(this._startZoom) / scale;\n            const zoom = map.getZoomFromRes(res);\n            map.onZoomEnd(zoom, this._Origin);\n        }\n        if (this.mode === 'pitch' || this.mode === 'rotate' || this.mode === 'rotate_zoom') {\n            map.onDragRotateEnd({\n                'domEvent': event\n            });\n        }\n        delete this.mode;\n        /**\n          * touchactend event\n          * @event Map#touchactend\n          * @type {Object}\n          * @property {String} type                    - touchactend\n          * @property {Map} target                     - the map fires event\n          */\n        map._fireEvent('touchactend');\n    }\n}\n\nMap.mergeOptions({\n    'touchGesture' : true,\n    'touchZoom': true,\n    'touchPitch' : true,\n    'touchRotate' : true,\n    'touchZoomRotate' : false\n});\n\nMap.addOnLoadHook('addHandler', 'touchGesture', MapTouchZoomHandler);\n\nexport default MapTouchZoomHandler;\n","import {\n    isNil,\n    extend,\n    isNumber,\n    isString,\n    requestAnimFrame,\n    now\n} from './util';\nimport Point from '../geo/Point';\nimport Coordinate from '../geo/Coordinate';\n\n/**\n * @classdesc\n * Easing functions for anmation, from openlayers 3\n * @class\n * @category animation\n * @memberof animation\n * @protected\n */\nconst Easing = {\n    /**\n     * Start slow and speed up.\n     * @param {number} t Input between 0 and 1.\n     * @return {number} Output between 0 and 1.\n     */\n    in(t) {\n        return Math.pow(t, 2);\n    },\n\n    /**\n     * Start fast and slow down.\n     * @param {number} t Input between 0 and 1.\n     * @return {number} Output between 0 and 1.\n     */\n    out(t) {\n        return 1 - Easing.in(1 - t);\n    },\n\n    /**\n     * Start slow, speed up, and then slow down again.\n     * @param {number} t Input between 0 and 1.\n     * @return {number} Output between 0 and 1.\n     */\n    inAndOut(t) {\n        return 3 * t * t - 2 * t * t * t;\n    },\n\n    /**\n     * Maintain a constant speed over time.\n     * @param {number} t Input between 0 and 1.\n     * @return {number} Output between 0 and 1.\n     */\n    linear(t) {\n        return t;\n    },\n\n    /**\n     * Start slow, speed up, and at the very end slow down again.  This has the\n     * same general behavior as {@link inAndOut}, but the final slowdown\n     * is delayed.\n     * @param {number} t Input between 0 and 1.\n     * @return {number} Output between 0 and 1.\n     */\n    upAndDown(t) {\n        if (t < 0.5) {\n            return Easing.inAndOut(2 * t);\n        } else {\n            return 1 - Easing.inAndOut(2 * (t - 0.5));\n        }\n    }\n};\n\n/**\n * Animation Frame used internally in animation player.\n * @category animation\n * @memberof animation\n * @protected\n */\nclass Frame {\n    /**\n     * Create an animation frame.\n     * @param {Object} state  - animation state\n     * @param {Object} styles - styles to animate\n     */\n    constructor(state, styles) {\n        this.state = state;\n        this.styles = styles;\n    }\n}\n\n/**\n * An [Web Animation API]{@link https://developer.mozilla.org/zh-CN/docs/Web/API/Animation} style animation player\n * @category animation\n * @memberof animation\n */\nclass Player {\n\n    /**\n     * Create an animation player\n     * @param {Function} animation - animation [framing]{@link framing} function\n     * @param {Object} options     - animation options\n     * @param {Function} onFrame  - callback function for animation steps\n     */\n    constructor(animation, options, onFrame) {\n        this._animation = animation;\n        this.options = options;\n        this._onFrame = onFrame;\n        this.playState = 'idle';\n        this.ready = true;\n        this.finished = false;\n    }\n}\n\n/**\n * @classdesc\n * Utilities for animation\n * @class\n * @category animation\n * @memberof animation\n */\nconst Animation = {\n    /**\n     * @property {Object} speed         - predefined animation speed\n     * @property {Number} speed.slow    - 2000ms\n     * @property {Number} speed.normal  - 1000ms\n     * @property {Number} speed.fast    - 500ms\n     */\n    speed: {\n        'slow': 2000,\n        'normal': 1000,\n        'fast': 500\n    },\n\n    /**\n     * resolve styles for animation, get a style group of start style, styles to animate and end styles.\n     * @param  {Object} styles - styles to resolve\n     * @return {Object[]}  styles resolved\n     * @private\n     */\n    _resolveStyles(styles) {\n        if (!styles) {\n            return null;\n        }\n        //resolve a child styles.\n        function resolveChild(child) {\n            if (!Array.isArray(child)) {\n                return Animation._resolveStyles(child);\n            }\n            const start = [],\n                d = [],\n                dest = [];\n            for (let i = 0; i < child.length; i++) {\n                const styles = Animation._resolveStyles(child[i]);\n                if (styles) {\n                    start.push(styles[0]);\n                    d.push(styles[1]);\n                    dest.push(styles[2]);\n                }\n            }\n            if (!start.length) {\n                return null;\n            } else {\n                return [start, d, dest];\n            }\n        }\n        // resolve a style value.\n        function resolveVal(val) {\n            let values = val;\n            let clazz;\n            //val is just a destination value, so we set start value to 0 or a 0-point or a 0-coordinate.\n            if (!Array.isArray(val)) {\n                if (isNumber(val)) {\n                    values = [0, val];\n                } else if (val instanceof Point || val instanceof Coordinate) {\n                    clazz = val.constructor;\n                    values = [new clazz(0, 0), val];\n                } else {\n                    values = [val, val];\n                }\n            }\n            //val is an array and val[0] is the start value and val[1] is the destination value.\n            let v1 = values[0],\n                v2 = values[1];\n            if (isNumber(v1) && isNumber(v2)) {\n                if (v1 === v2) {\n                    return null;\n                }\n                return [v1, v2 - v1, v2];\n            } else if (Array.isArray(v1) || v1 instanceof Coordinate || v1 instanceof Point) {\n                // is a coordinate (array or a coordinate) or a point\n                if (Array.isArray(v1)) {\n                    v1 = new Coordinate(v1);\n                    v2 = new Coordinate(v2);\n                } else {\n                    clazz = v1.constructor;\n                    v1 = new clazz(v1);\n                    v2 = new clazz(v2);\n                }\n                if (v1.equals(v2)) {\n                    //a Coordinate or a Point to be eql with each other\n                    return null;\n                }\n                return [v1, v2.sub(v1), v2];\n            } else {\n                return [v1, 0, v2];\n            }\n        }\n\n        function isChild(val) {\n            if (!Array.isArray(val) && val.constructor === Object) {\n                return true;\n            } else if (Array.isArray(val) && val[0].constructor === Object) {\n                return true;\n            }\n            return false;\n        }\n\n        const d = {},\n            start = {},\n            dest = {};\n        for (const p in styles) {\n            if (styles.hasOwnProperty(p)) {\n                const values = styles[p];\n                // ignore null values\n                if (!values) {\n                    continue;\n                } else if (Array.isArray(values)) {\n                    if (isNil(values[0]) || isNil(values[1])) {\n                        continue;\n                    }\n                }\n                let childStyles;\n                if (isChild(values)) {\n                    childStyles = resolveChild(values);\n                } else {\n                    childStyles = resolveVal(values);\n                }\n                if (childStyles) {\n                    start[p] = childStyles[0];\n                    d[p] = childStyles[1];\n                    dest[p] = childStyles[2];\n                }\n            }\n        }\n        return [start, d, dest];\n    },\n\n    /**\n     * Generate a framing function\n     * @param  {Object[]} styles        - animation style group\n     * @param  {Object} [options=null]  - options\n     * @param  {Object} [options.easing=null]  - animation easing\n     * @return {Function} framing function helps to generate animation frames.\n     */\n    framing(styles, options) {\n        if (!options) {\n            options = {};\n        }\n        let easing = options['easing'] ? Easing[options['easing']] : Easing.linear;\n        if (!easing) {\n            easing = Easing.linear;\n        }\n        let dStyles, startStyles, destStyles;\n        styles = Animation._resolveStyles(styles);\n        if (styles) {\n            startStyles = styles[0];\n            dStyles = styles[1];\n            destStyles = styles[2];\n        }\n        const deltaStyles = function (delta, _startStyles, _dStyles) {\n            if (!_startStyles || !_dStyles) {\n                return null;\n            }\n            const result = {};\n            for (const p in _dStyles) {\n                if (_dStyles.hasOwnProperty(p)) {\n                    if (_startStyles[p] === destStyles[p]) {\n                        result[p] = _startStyles[p];\n                        continue;\n                    }\n                    const s = _startStyles[p],\n                        d = _dStyles[p];\n                    if (isNumber(d)) {\n                        //e.g. radius, width, height\n                        result[p] = s + delta * d;\n                    } else if (Array.isArray(d)) {\n                        //e.g. a composite symbol, element in array can only be a object.\n                        const children = [];\n                        for (let i = 0; i < d.length; i++) {\n                            children.push(deltaStyles(delta, s[i], d[i]));\n                        }\n                        result[p] = children;\n                    } else {\n                        //e.g. translate or a child\n                        const clazz = d.constructor;\n                        if (clazz === Object) {\n                            result[p] = deltaStyles(delta, s, d);\n                        } else if (s instanceof Point || s instanceof Coordinate) {\n                            result[p] = s.add(d.multi(delta));\n                        }\n                    }\n                }\n            }\n            return result;\n        };\n        return function (elapsed, duration) {\n            let state, d;\n            if (elapsed < 0) {\n                state = {\n                    'playState': 'idle',\n                    'delta': 0\n                };\n                d = startStyles;\n            } else if (elapsed < duration) {\n                const delta = easing(elapsed / duration);\n                state = {\n                    'playState': 'running',\n                    'delta': delta\n                };\n                d = deltaStyles(delta, startStyles, dStyles);\n            } else {\n                state = {\n                    'playState': 'finished',\n                    'delta': 1\n                };\n                d = destStyles;\n            }\n            state['startStyles'] = startStyles;\n            state['destStyles'] = destStyles;\n            state['progress'] = elapsed;\n            state['remainingMs'] = duration - elapsed;\n            return new Frame(state, d);\n        };\n\n    },\n\n    _requestAnimFrame(fn) {\n        if (!this._frameQueue) {\n            this._frameQueue = [];\n        }\n        this._frameQueue.push(fn);\n        this._a();\n    },\n\n    _a() {\n        if (!this._animationFrameId) {\n            this._animationFrameId = requestAnimFrame(Animation._frameFn);\n        }\n    },\n\n    _run() {\n        if (this._frameQueue.length) {\n            const running = this._frameQueue;\n            this._frameQueue = [];\n            for (let i = 0, len = running.length; i < len; i++) {\n                running[i]();\n            }\n            if (this._frameQueue.length) {\n                this._animationFrameId = requestAnimFrame(Animation._frameFn);\n            } else {\n                delete this._animationFrameId;\n            }\n        }\n    },\n\n    /**\n     * Create an animation player\n     * @param  {Object} styles  - styles to animate\n     * @param  {Object} options - animation options\n     * @param  {Function} step  - callback function for animation steps\n     * @return {Player} player\n     */\n    animate(styles, options, step) {\n        if (!options) {\n            options = {};\n        }\n        const animation = Animation.framing(styles, options);\n        return new Player(animation, options, step);\n    }\n};\n\nAnimation._frameFn = Animation._run.bind(Animation);\n\nextend(Player.prototype, /** @lends animation.Player.prototype */{\n    _prepare() {\n        const options = this.options;\n        let duration = options['speed'] || options['duration'];\n        if (isString(duration)) {\n            duration = Animation.speed[duration];\n            if (!duration) {\n                duration = +duration;\n            }\n        }\n        if (!duration) {\n            duration = Animation.speed['normal'];\n        }\n        this.duration = duration;\n        this._framer = options['framer'] || Animation._requestAnimFrame.bind(Animation);\n    },\n\n    /**\n     * Start or resume the animation\n     * @return {Player} this\n     */\n    play() {\n        if (this.playState !== 'idle' && this.playState !== 'paused') {\n            return this;\n        }\n        if (this.playState === 'idle') {\n            this.currentTime = 0;\n            this._prepare();\n        }\n        const t = now();\n        if (!this.startTime) {\n            const options = this.options;\n            this.startTime = options['startTime'] ? options['startTime'] : t;\n        }\n        this._playStartTime = Math.max(t, this.startTime);\n        if (this.playState === 'paused') {\n            this._playStartTime -= this.currentTime;\n        }\n        this.playState = 'running';\n        this._run();\n        return this;\n    },\n\n    /**\n     * Pause the animation\n     * @return {Player} this\n     */\n    pause() {\n        if (this.playState === 'paused') {\n            return this;\n        }\n        this.playState = 'paused';\n        this._run();\n        //this.duration = this.duration - this.currentTime;\n        return this;\n    },\n\n    /**\n     * Cancel the animation play and ready to play again\n     * @return {Player} this\n     */\n    cancel() {\n        if (this.playState === 'idle') {\n            return this;\n        }\n        this.playState = 'idle';\n        this.finished = false;\n        this._run();\n        return this;\n    },\n\n    /**\n     * Finish the animation play, and can't be played any more.\n     * @return {Player} this\n     */\n    finish() {\n        if (this.playState === 'finished') {\n            return this;\n        }\n        this.playState = 'finished';\n        this.finished = true;\n        this._run();\n        return this;\n    },\n\n    reverse() {\n    },\n\n    _run() {\n        const onFrame = this._onFrame;\n        const t = now();\n        let elapsed = t - this._playStartTime;\n        if (this.options['repeat'] && elapsed >= this.duration) {\n            this._playStartTime = t;\n            elapsed = 0;\n        }\n        if (this.playState !== 'running') {\n            if (onFrame) {\n                if (this.playState === 'finished') {\n                    elapsed = this.duration;\n                } else if (this.playState === 'idle') {\n                    elapsed = 0;\n                }\n                const frame = this._animation(elapsed, this.duration);\n                frame.state.playState = this.playState;\n                onFrame(frame);\n            }\n            return;\n        }\n        //elapsed, duration\n        const frame = this._animation(elapsed, this.duration);\n        this.playState = frame.state['playState'];\n\n        if (this.playState === 'idle') {\n            if (this.startTime > t) {\n                setTimeout(this._run.bind(this), this.startTime - t);\n            }\n        } else if (this.playState === 'running') {\n            this._framer(() => {\n                if (this.playState !== 'running') {\n                    // this._run();\n                    return;\n                }\n                this.currentTime = elapsed;\n                if (onFrame) {\n                    onFrame(frame);\n                }\n                this._run();\n            });\n        } else if (this.playState === 'finished') {\n            this.finished = true;\n            //finished\n            if (onFrame) {\n                onFrame(frame);\n            }\n        }\n\n    }\n});\n\nexport { Animation, Easing, Player, Frame };\n","/*\n (c) 2017, Vladimir Agafonkin\n Simplify.js, a high-performance JS polyline simplification library\n mourner.github.io/simplify-js\n*/\n\n(function () { 'use strict';\n\n// to suit your point format, run search/replace for '.x' and '.y';\n// for 3D version, see 3d branch (configurability would draw significant performance overhead)\n\n// square distance between 2 points\nfunction getSqDist(p1, p2) {\n\n    var dx = p1.x - p2.x,\n        dy = p1.y - p2.y;\n\n    return dx * dx + dy * dy;\n}\n\n// square distance from a point to a segment\nfunction getSqSegDist(p, p1, p2) {\n\n    var x = p1.x,\n        y = p1.y,\n        dx = p2.x - x,\n        dy = p2.y - y;\n\n    if (dx !== 0 || dy !== 0) {\n\n        var t = ((p.x - x) * dx + (p.y - y) * dy) / (dx * dx + dy * dy);\n\n        if (t > 1) {\n            x = p2.x;\n            y = p2.y;\n\n        } else if (t > 0) {\n            x += dx * t;\n            y += dy * t;\n        }\n    }\n\n    dx = p.x - x;\n    dy = p.y - y;\n\n    return dx * dx + dy * dy;\n}\n// rest of the code doesn't care about point format\n\n// basic distance-based simplification\nfunction simplifyRadialDist(points, sqTolerance) {\n\n    var prevPoint = points[0],\n        newPoints = [prevPoint],\n        point;\n\n    for (var i = 1, len = points.length; i < len; i++) {\n        point = points[i];\n\n        if (getSqDist(point, prevPoint) > sqTolerance) {\n            newPoints.push(point);\n            prevPoint = point;\n        }\n    }\n\n    if (prevPoint !== point) newPoints.push(point);\n\n    return newPoints;\n}\n\nfunction simplifyDPStep(points, first, last, sqTolerance, simplified) {\n    var maxSqDist = sqTolerance,\n        index;\n\n    for (var i = first + 1; i < last; i++) {\n        var sqDist = getSqSegDist(points[i], points[first], points[last]);\n\n        if (sqDist > maxSqDist) {\n            index = i;\n            maxSqDist = sqDist;\n        }\n    }\n\n    if (maxSqDist > sqTolerance) {\n        if (index - first > 1) simplifyDPStep(points, first, index, sqTolerance, simplified);\n        simplified.push(points[index]);\n        if (last - index > 1) simplifyDPStep(points, index, last, sqTolerance, simplified);\n    }\n}\n\n// simplification using Ramer-Douglas-Peucker algorithm\nfunction simplifyDouglasPeucker(points, sqTolerance) {\n    var last = points.length - 1;\n\n    var simplified = [points[0]];\n    simplifyDPStep(points, 0, last, sqTolerance, simplified);\n    simplified.push(points[last]);\n\n    return simplified;\n}\n\n// both algorithms combined for awesome performance\nfunction simplify(points, tolerance, highestQuality) {\n\n    if (points.length <= 2) return points;\n\n    var sqTolerance = tolerance !== undefined ? tolerance * tolerance : 1;\n\n    points = highestQuality ? points : simplifyRadialDist(points, sqTolerance);\n    points = simplifyDouglasPeucker(points, sqTolerance);\n\n    return points;\n}\n\n// export as AMD module / Node module / browser or worker variable\nif (typeof define === 'function' && define.amd) define(function() { return simplify; });\nelse if (typeof module !== 'undefined') {\n    module.exports = simplify;\n    module.exports.default = simplify;\n} else if (typeof self !== 'undefined') self.simplify = simplify;\nelse window.simplify = simplify;\n\n})();\n","import { isNil, isNumber, isArrayHasData, isFunction, forEachCoord } from '../core/util';\nimport { Animation } from '../core/Animation';\nimport Coordinate from '../geo/Coordinate';\nimport Extent from '../geo/Extent';\nimport Geometry from './Geometry';\nimport Polygon from './Polygon';\nimport simplify from 'simplify-js';\n\n/**\n * @property {Object} options - configuration options\n * @property {Number} [options.smoothness=0]      - line smoothing by quad bezier interporating, 0 by default\n * @property {Boolean} [options.enableSimplify=true] - whether to simplify path before rendering\n * @property {Number}  [options.simplifyTolerance=2] - tolerance to simplify path, the higher the simplify is more intense\n * @property {Boolean} [options.enableClip=true] - whether to clip path with map's current extent\n * @property {Object} options.symbol - Path's default symbol\n * @memberOf Path\n * @instance\n */\nconst options = {\n    'smoothness' : 0,\n    'enableClip' : true,\n    'enableSimplify' : true,\n    'simplifyTolerance' : 2,\n    'symbol': {\n        'lineColor': '#000',\n        'lineWidth': 2,\n        'lineOpacity': 1,\n\n        'polygonFill': '#fff', //default color in cartoCSS\n        'polygonOpacity': 1,\n        'opacity': 1\n    }\n};\n\n/**\n * An abstract class Path containing common methods for Path geometry classes, e.g. LineString, Polygon\n * @abstract\n * @category geometry\n * @extends Geometry\n */\nclass Path extends Geometry {\n\n    getOutline() {\n        const painter = this._getPainter();\n        if (!painter) {\n            return null;\n        }\n        const map = this.getMap();\n        const extent = painter.getContainerExtent().convertTo(c => map.containerPointToCoord(c));\n        return new Polygon(extent.toArray(), {\n            symbol : {\n                'lineWidth': 1,\n                'lineColor': '6b707b'\n            }\n        });\n    }\n\n    /**\n     * Show the linestring with animation\n     * @param  {Object} [options=null] animation options\n     * @param  {Number} [options.duration=1000] duration\n     * @param  {String} [options.easing=out] animation easing\n     * @param  {Function} [cb=null] callback function in animation, function parameters: frame, currentCoord\n     * @example\n     *  line.animateShow({\n     *    duration : 2000,\n     *    easing : 'linear'\n     *  }, function (frame, currentCoord) {\n     *    //frame is the animation frame\n     *    //currentCoord is current coordinate of animation\n     *  });\n     * @return {LineString}         this\n     */\n    animateShow(options = {}, cb) {\n        if (this._showPlayer) {\n            this._showPlayer.finish();\n        }\n        if (isFunction(options)) {\n            options = {};\n            cb = options;\n        }\n        const coordinates = this.getCoordinates();\n        if (coordinates.length === 0) {\n            return this;\n        }\n        this._animIdx = 0;\n        this._animLenSoFar = 0;\n        this.show();\n        const isPolygon = !!this.getShell;\n        const animCoords = isPolygon ? this.getShell().concat(this.getShell()[0]) : this.getCoordinates();\n        const projection = this._getProjection();\n        this._aniShowCenter = projection.unproject(this._getPrjExtent().getCenter());\n        const duration = options['duration'] || 1000,\n            length = this.getLength(),\n            easing = options['easing'] || 'out';\n        this.setCoordinates([]);\n        const player = this._showPlayer = Animation.animate({\n            't': duration\n        }, {\n            'duration': duration,\n            'easing': easing\n        }, frame => {\n            if (!this.getMap()) {\n                if (player.playState !== 'finished') {\n                    player.finish();\n                    if (cb) {\n                        const coordinates = this.getCoordinates();\n                        cb(frame, coordinates[coordinates.length - 1]);\n                    }\n                }\n                return;\n            }\n            const currentCoord = this._drawAnimShowFrame(frame.styles.t, duration, length, animCoords);\n            if (frame.state.playState === 'finished') {\n                delete this._showPlayer;\n                delete this._aniShowCenter;\n                delete this._animIdx;\n                delete this._animLenSoFar;\n                delete this._animTailRatio;\n                this.setCoordinates(coordinates);\n            }\n            if (cb) {\n                cb(frame, currentCoord);\n            }\n        });\n        player.play();\n        return player;\n    }\n\n    _drawAnimShowFrame(t, duration, length, coordinates) {\n        if (t === 0) {\n            return coordinates[0];\n        }\n        const map = this.getMap();\n        const targetLength = t / duration * length;\n        let segLen = 0;\n        let i, l;\n        for (i = this._animIdx, l = coordinates.length; i < l - 1; i++) {\n            segLen = map.computeLength(coordinates[i], coordinates[i + 1]);\n            if (this._animLenSoFar + segLen > targetLength) {\n                break;\n            }\n            this._animLenSoFar += segLen;\n        }\n        this._animIdx = i;\n        if (this._animIdx >= l - 1) {\n            this.setCoordinates(coordinates);\n            return coordinates[coordinates.length - 1];\n        }\n        const idx = this._animIdx;\n        const p1 = coordinates[idx],\n            p2 = coordinates[idx + 1],\n            span = targetLength - this._animLenSoFar,\n            r = span / segLen;\n        this._animTailRatio = r;\n        const x = p1.x + (p2.x - p1.x) * r,\n            y = p1.y + (p2.y - p1.y) * r,\n            targetCoord = new Coordinate(x, y);\n        const isPolygon = !!this.getShell;\n        if (!isPolygon && this.options['smoothness'] > 0) {\n            //smooth line needs to set current coordinates plus 2 more to caculate correct control points\n            const animCoords = coordinates.slice(0, this._animIdx + 3);\n            this.setCoordinates(animCoords);\n        } else {\n            const animCoords = coordinates.slice(0, this._animIdx + 1);\n            animCoords.push(targetCoord);\n            if (isPolygon) {\n                this.setCoordinates([this._aniShowCenter].concat(animCoords));\n            } else {\n                this.setCoordinates(animCoords);\n            }\n        }\n        return targetCoord;\n    }\n\n    _getCenterInExtent(extent, coordinates, clipFn) {\n        const meExtent = this.getExtent();\n        if (!extent.intersects(meExtent)) {\n            return null;\n        }\n        const clipped = clipFn(coordinates, extent);\n        if (clipped.length === 0) {\n            return null;\n        }\n        let [sumx, sumy, counter] = [0, 0, 0];\n        clipped.forEach(part => {\n            if (Array.isArray(part)) {\n                part.forEach(c => {\n                    if (c.point) {\n                        c = c.point;\n                    }\n                    sumx += c.x;\n                    sumy += c.y;\n                    counter++;\n                });\n            } else {\n                if (part.point) {\n                    part = part.point;\n                }\n                sumx += part.x;\n                sumy += part.y;\n                counter++;\n            }\n        });\n        const c = new Coordinate(sumx, sumy)._multi(1 / counter);\n        c.count = counter;\n        return c;\n    }\n\n    /**\n     * Transform projected coordinates to view points\n     * @param  {Coordinate[]} prjCoords           - projected coordinates\n     * @param  {Boolean} disableSimplify          - whether to disable simplify\\\n     * @param  {Number} zoom                      - 2d points' zoom level\n     * @returns {Point[]}\n     * @private\n     */\n    _getPath2DPoints(prjCoords, disableSimplify, zoom) {\n        if (!isArrayHasData(prjCoords)) {\n            return [];\n        }\n        const map = this.getMap(),\n            isSimplify = !disableSimplify && this._shouldSimplify(),\n            tolerance = this.options['simplifyTolerance'] * map._getResolution(),\n            isMulti = Array.isArray(prjCoords[0]);\n        delete this._simplified;\n        if (isSimplify && !isMulti) {\n            const count = prjCoords.length;\n            prjCoords = simplify(prjCoords, tolerance, false);\n            this._simplified = prjCoords.length < count;\n        }\n        if (isNil(zoom)) {\n            zoom = map.getZoom();\n        }\n        return forEachCoord(prjCoords, c => map._prjToPoint(c, zoom));\n    }\n\n    _shouldSimplify() {\n        const layer = this.getLayer(),\n            properties = this.getProperties();\n        const hasAltitude = properties && layer.options['enableAltitude'] && !isNil(properties[layer.options['altitudeProperty']]);\n        return layer && layer.options['enableSimplify'] && !hasAltitude && this.options['enableSimplify'] && !this._showPlayer/* && !this.options['smoothness'] */;\n    }\n\n    _setPrjCoordinates(prjPoints) {\n        this._prjCoords = prjPoints;\n        this.onShapeChanged();\n    }\n\n    _getPrjCoordinates() {\n        const projection = this._getProjection();\n        if (!projection) {\n            return null;\n        }\n        this._verifyProjection();\n        if (!this._prjCoords) {\n            this._prjCoords = this._projectCoords(this._coordinates);\n        }\n        return this._prjCoords;\n    }\n\n    //update cached variables if geometry is updated.\n    _updateCache() {\n        this._clearCache();\n        const projection = this._getProjection();\n        if (!projection) {\n            return;\n        }\n        if (this._prjCoords) {\n            this._coordinates = this._unprojectCoords(this._getPrjCoordinates());\n        }\n    }\n\n    _clearProjection() {\n        this._prjCoords = null;\n        super._clearProjection();\n    }\n\n    _projectCoords(points) {\n        const projection = this._getProjection();\n        if (projection) {\n            return projection.projectCoords(points);\n        }\n        return [];\n    }\n\n    _unprojectCoords(prjPoints) {\n        const projection = this._getProjection();\n        if (projection) {\n            return projection.unprojectCoords(prjPoints);\n        }\n        return [];\n    }\n\n    _computeCenter() {\n        const ring = this._coordinates;\n        if (!isArrayHasData(ring)) {\n            return null;\n        }\n        let sumx = 0,\n            sumy = 0,\n            counter = 0;\n        const size = ring.length;\n        for (let i = 0; i < size; i++) {\n            if (ring[i]) {\n                if (isNumber(ring[i].x) && isNumber(ring[i].y)) {\n                    sumx += ring[i].x;\n                    sumy += ring[i].y;\n                    counter++;\n                }\n            }\n        }\n        return new Coordinate(sumx / counter, sumy / counter);\n    }\n\n    _computeExtent() {\n        const shell = this._coordinates;\n        if (!isArrayHasData(shell)) {\n            return null;\n        }\n        const rings = [shell];\n        if (this.hasHoles && this.hasHoles()) {\n            rings.push.apply(rings, this.getHoles());\n        }\n        return this._coords2Extent(rings, this._getProjection());\n    }\n\n    _computePrjExtent() {\n        const coords = [this._getPrjCoordinates()];\n        if (this.hasHoles && this.hasHoles()) {\n            coords.push.apply(coords, this._getPrjHoles());\n        }\n        return this._coords2Extent(coords);\n    }\n\n    _get2DLength() {\n        const vertexes = this._getPath2DPoints(this._getPrjCoordinates(), true);\n        let len = 0;\n        for (let i = 1, l = vertexes.length; i < l; i++) {\n            len += vertexes[i].distanceTo(vertexes[i - 1]);\n        }\n        return len;\n    }\n\n    _hitTestTolerance() {\n        const symbol = this._getInternalSymbol();\n        let w;\n        if (Array.isArray(symbol)) {\n            w = 0;\n            for (let i = 0; i < symbol.length; i++) {\n                if (isNumber(symbol[i]['lineWidth'])) {\n                    if (symbol[i]['lineWidth'] > w) {\n                        w = symbol[i]['lineWidth'];\n                    }\n                }\n            }\n        } else {\n            w = symbol['lineWidth'];\n        }\n        return isNumber(w) ? w / 2 : 1.5;\n    }\n\n    _coords2Extent(coords, proj) {\n        const result = new Extent(proj);\n        for (let i = 0, l = coords.length; i < l; i++) {\n            for (let j = 0, ll = coords[i].length; j < ll; j++) {\n                result._combine(coords[i][j]);\n            }\n        }\n        return result;\n    }\n}\n\nPath.mergeOptions(options);\n\nexport default Path;\n","import { isArrayHasData } from '../core/util';\nimport Coordinate from '../geo/Coordinate';\nimport { clipPolygon } from '../core/util/path';\nimport Path from './Path';\n\nconst JSON_TYPE = 'Polygon';\n\n/**\n * @classdesc\n * Geometry class for polygon type\n * @category geometry\n * @extends Path\n * @example\n * var polygon = new Polygon(\n *      [\n *          [\n *              [121.48053653961283, 31.24244899384889],\n *              [121.48049362426856, 31.238559229494186],\n *              [121.49032123809872, 31.236210614999653],\n *              [121.49366863494917, 31.242926029397037],\n *              [121.48577221160967, 31.243880093267567],\n *              [121.48053653961283, 31.24244899384889]\n *          ]\n *      ]\n *  ).addTo(layer);\n */\nclass Polygon extends Path {\n\n    /**\n     * @param {Number[][]|Number[][][]|Coordinate[]|Coordinate[][]} coordinates - coordinates, shell coordinates or all the rings.\n     * @param {Object} [options=null] - construct options defined in [Polygon]{@link Polygon#options}\n     */\n    constructor(coordinates, opts) {\n        super(opts);\n        this.type = 'Polygon';\n        if (coordinates) {\n            this.setCoordinates(coordinates);\n        }\n    }\n\n    /**\n     * Set coordinates to the polygon\n     *\n     * @param {Number[][]|Number[][][]|Coordinate[]|Coordinate[][]} coordinates - new coordinates\n     * @return {Polygon} this\n     * @fires Polygon#shapechange\n     */\n    setCoordinates(coordinates) {\n        if (!coordinates) {\n            this._coordinates = null;\n            this._holes = null;\n            this._projectRings();\n            return this;\n        }\n        const rings = Coordinate.toCoordinates(coordinates);\n        const len = rings.length;\n        if (!Array.isArray(rings[0])) {\n            this._coordinates = this._trimRing(rings);\n        } else {\n            this._coordinates = this._trimRing(rings[0]);\n            if (len > 1) {\n                const holes = [];\n                for (let i = 1; i < len; i++) {\n                    if (!rings[i]) {\n                        continue;\n                    }\n                    holes.push(this._trimRing(rings[i]));\n                }\n                this._holes = holes;\n            }\n        }\n\n        this._projectRings();\n        return this;\n    }\n\n    /**\n     * Gets polygons's coordinates\n     *\n     * @returns {Coordinate[][]}\n     */\n    getCoordinates() {\n        if (!this._coordinates) {\n            return [];\n        }\n        const holes = this.getHoles();\n        const rings = [this._copyAndCloseRing(this._coordinates)];\n        for (let i = 0, l = holes.length; i < l; i++) {\n            rings.push(this._copyAndCloseRing(holes[i]));\n        }\n        return rings;\n    }\n\n    /**\n     * Get center of linestring's intersection with give extent\n     * @example\n     *  const extent = map.getExtent();\n     *  const center = line.getCenterInExtent(extent);\n     * @param {Extent} extent\n     * @return {Coordinate} center, null if line doesn't intersect with extent\n     */\n    getCenterInExtent(extent) {\n        return this._getCenterInExtent(extent, this.getShell(), clipPolygon);\n    }\n\n    /**\n     * Gets shell's coordinates of the polygon\n     *\n     * @returns {Coordinate[]}\n     */\n    getShell() {\n        return this._coordinates || [];\n    }\n\n\n    /**\n     * Gets holes' coordinates of the polygon if it has.\n     * @returns {Coordinate[][]}\n     */\n    getHoles() {\n        return this._holes || [];\n    }\n\n    /**\n     * Whether the polygon has any holes inside.\n     *\n     * @returns {Boolean}\n     */\n    hasHoles() {\n        return this.getHoles().length > 0;\n    }\n\n    _projectRings() {\n        if (!this.getMap()) {\n            this.onShapeChanged();\n            return;\n        }\n        this._prjCoords = this._projectCoords(this._coordinates);\n        this._prjHoles = this._projectCoords(this._holes);\n        this.onShapeChanged();\n    }\n\n    _cleanRing(ring) {\n        for (let i = ring.length - 1; i >= 0; i--) {\n            if (!ring[i]) {\n                ring.splice(i, 1);\n            }\n        }\n    }\n\n    /**\n     * Check if ring is valid\n     * @param  {*} ring ring to check\n     * @return {Boolean} is ring a closed one\n     * @private\n     */\n    _checkRing(ring) {\n        this._cleanRing(ring);\n        if (!ring || !isArrayHasData(ring)) {\n            return false;\n        }\n        const lastPoint = ring[ring.length - 1];\n        let isClose = true;\n        if (ring[0].x !== lastPoint.x || ring[0].y !== lastPoint.y) {\n            isClose = false;\n        }\n        return isClose;\n    }\n\n    /**\n     * If the first coordinate is equal with the last one, then remove the last coordinates.\n     * @private\n     */\n    _trimRing(ring) {\n        const isClose = this._checkRing(ring);\n        if (isArrayHasData(ring) && isClose) {\n            ring.splice(ring.length - 1, 1);\n        }\n        return ring;\n    }\n\n    /**\n     * If the first coordinate is different with the last one, then copy the first coordinates and add to the ring.\n     * @private\n     */\n    _copyAndCloseRing(ring) {\n        ring = ring.slice(0);\n        const isClose = this._checkRing(ring);\n        if (isArrayHasData(ring) && !isClose) {\n            ring.push(ring[0].copy());\n            return ring;\n        } else {\n            return ring;\n        }\n    }\n\n    _getPrjShell() {\n        if (this.getJSONType() === JSON_TYPE) {\n            return this._getPrjCoordinates();\n        }\n        const projection = this._getProjection();\n        if (!projection) {\n            return null;\n        }\n        this._verifyProjection();\n        if (!this._prjShell) {\n            this._prjShell = this._projectCoords(this.getShell());\n        }\n        return this._prjShell;\n    }\n\n    _getPrjHoles() {\n        const projection = this._getProjection();\n        if (!projection) {\n            return null;\n        }\n        this._verifyProjection();\n        if (!this._prjHoles) {\n            this._prjHoles = this._projectCoords(this.getHoles());\n        }\n        return this._prjHoles;\n    }\n\n    _computeGeodesicLength(measurer) {\n        const rings = this.getCoordinates();\n        if (!isArrayHasData(rings)) {\n            return 0;\n        }\n        let result = 0;\n        for (let i = 0, len = rings.length; i < len; i++) {\n            result += measurer.measureLength(rings[i]);\n        }\n        return result;\n    }\n\n    _computeGeodesicArea(measurer) {\n        const rings = this.getCoordinates();\n        if (!isArrayHasData(rings)) {\n            return 0;\n        }\n        let result = measurer.measureArea(rings[0]);\n        //holes\n        for (let i = 1, len = rings.length; i < len; i++) {\n            result -= measurer.measureArea(rings[i]);\n\n        }\n        return result;\n    }\n\n    _updateCache() {\n        super._updateCache();\n        if (this._prjHoles) {\n            this._holes = this._unprojectCoords(this._getPrjHoles());\n        }\n    }\n\n    _clearCache() {\n        delete this._prjShell;\n        return super._clearCache();\n    }\n\n    _clearProjection() {\n        if (this._prjHoles) {\n            this._prjHoles = null;\n        }\n        if (this._prjShell) {\n            this._prjShell = null;\n        }\n        super._clearProjection();\n    }\n}\n\nPolygon.registerJSONType(JSON_TYPE);\n\nexport default Polygon;\n","import { isNil } from '../core/util';\nimport Coordinate from '../geo/Coordinate';\n\n/**\n * Common methods for geometry classes that base on a center, e.g. Marker, Circle, Ellipse , etc\n * @mixin CenterMixin\n */\nexport default function (Base) {\n    return class extends Base {\n\n        /**\n         * Get geometry's center\n         * @return {Coordinate} - center of the geometry\n         * @function CenterMixin.getCoordinates\n         */\n        getCoordinates() {\n            return this._coordinates;\n        }\n\n        /**\n         * Set a new center to the geometry\n         * @param {Coordinate|Number[]} coordinates - new center\n         * @return {Geometry} this\n         * @fires Geometry#positionchange\n         * @function CenterMixin.setCoordinates\n         */\n        setCoordinates(coordinates) {\n            const center = (coordinates instanceof Coordinate) ? coordinates : new Coordinate(coordinates);\n            if (center.equals(this._coordinates)) {\n                return this;\n            }\n            this._coordinates = center;\n            if (!this.getMap()) {\n                this.onPositionChanged();\n                return this;\n            }\n            const projection = this._getProjection();\n            this._setPrjCoordinates(projection.project(this._coordinates));\n            return this;\n        }\n\n        //Gets view point of the geometry's center\n        _getCenter2DPoint(zoom) {\n            const map = this.getMap();\n            if (!map) {\n                return null;\n            }\n            const z = isNil(zoom) ? map.getZoom() : map.getGLZoom();\n            const pcenter = this._getPrjCoordinates();\n            if (!pcenter) { return null; }\n\n            return map._prjToPoint(pcenter, z);\n        }\n\n        _getPrjCoordinates() {\n            const projection = this._getProjection();\n            if (!projection) {\n                return null;\n            }\n            this._verifyProjection();\n            if (!this._pcenter) {\n                if (this._coordinates) {\n                    this._pcenter = projection.project(this._coordinates);\n                }\n            }\n            return this._pcenter;\n        }\n\n        //Set center by projected coordinates\n        _setPrjCoordinates(pcenter) {\n            this._pcenter = pcenter;\n            this.onPositionChanged();\n        }\n\n        //update cached const iables if geometry is updated.\n        _updateCache() {\n            this._clearCache();\n            const projection = this._getProjection();\n            if (this._pcenter && projection) {\n                this._coordinates = projection.unproject(this._pcenter);\n            }\n        }\n\n        _clearProjection() {\n            this._pcenter = null;\n            super._clearProjection();\n        }\n\n        _computeCenter() {\n            return this._coordinates ? this._coordinates.copy() : null;\n        }\n    };\n}\n","import Extent from '../geo/Extent';\nimport CenterMixin from './CenterMixin';\nimport Geometry from './Geometry';\nimport Painter from '../renderer/geometry/Painter';\nimport * as Symbolizers from '../renderer/geometry/symbolizers';\n\n/**\n * @property {String} [options.hitTestForEvent=false] - use hit testing for events, be careful, it may fail due to tainted canvas.\n * @memberOf Marker\n * @instance\n */\nconst options = {\n    'symbol': {\n        'markerType': 'path',\n        'markerPath': [{\n            'path': 'M8 23l0 0 0 0 0 0 0 0 0 0c-4,-5 -8,-10 -8,-14 0,-5 4,-9 8,-9l0 0 0 0c4,0 8,4 8,9 0,4 -4,9 -8,14z M3,9 a5,5 0,1,0,0,-0.9Z',\n            'fill': '#DE3333'\n        }],\n        'markerPathWidth': 16,\n        'markerPathHeight': 23,\n        'markerWidth': 24,\n        'markerHeight': 34\n    },\n    'hitTestForEvent' : false\n};\n\n/**\n * @classdesc\n * Represents a Point type Geometry.\n * @category geometry\n * @extends Geometry\n * @mixes CenterMixin\n * @example\n * var marker = new Marker([100, 0], {\n *     'id' : 'marker0',\n *     'symbol' : {\n *         'markerFile'  : 'foo.png',\n *         'markerWidth' : 20,\n *         'markerHeight': 20,\n *     },\n *     'properties' : {\n *         'foo' : 'value'\n *     }\n * });\n */\nclass Marker extends CenterMixin(Geometry) {\n\n    /**\n     * @param {Coordinate} coordinates      - coordinates of the marker\n     * @param {Object} [options=null]       - construct options defined in [Marker]{@link Marker#options}\n     */\n    constructor(coordinates, opts) {\n        super(opts);\n        this.type = 'Point';\n        if (coordinates) {\n            this.setCoordinates(coordinates);\n        }\n    }\n\n    getOutline() {\n        const painter = this._getPainter();\n        if (!painter) {\n            return null;\n        }\n        const coord = this.getCoordinates();\n        const extent = painter.getContainerExtent();\n        const anchor = this.getMap().coordToContainerPoint(coord);\n        return new Marker(coord, {\n            'symbol': {\n                'markerType' : 'square',\n                'markerWidth' : extent.getWidth(),\n                'markerHeight' : extent.getHeight(),\n                'markerLineWidth': 1,\n                'markerLineColor': '6b707b',\n                'markerFill' : 'rgba(0, 0, 0, 0)',\n                'markerDx' : extent.xmin - (anchor.x - extent.getWidth() / 2),\n                'markerDy' : extent.ymin - (anchor.y - extent.getHeight() / 2)\n            }\n        });\n    }\n\n    _isVectorMarker() {\n        const symbol = this._getInternalSymbol();\n        if (Array.isArray(symbol)) {\n            return false;\n        }\n        return Symbolizers.VectorMarkerSymbolizer.test(symbol);\n    }\n\n    /**\n     * Can be edited, only marker with a vector symbol, vector path symbol or a image symbol can be edited.\n     * @return {Boolean}\n     * @private\n     */\n    _canEdit() {\n        const symbol = this._getInternalSymbol();\n        if (Array.isArray(symbol)) {\n            return false;\n        }\n        return Symbolizers.VectorMarkerSymbolizer.test(symbol) || Symbolizers.VectorPathMarkerSymbolizer.test(symbol) ||\n            Symbolizers.ImageMarkerSymbolizer.test(symbol);\n    }\n\n    _containsPoint(point, t) {\n        let extent = this.getContainerExtent();\n        if (t) {\n            extent = extent.expand(t);\n        }\n        if (extent.contains(point)) {\n            if (this.options['hitTestForEvent']) {\n                return super._containsPoint(point, t);\n            } else {\n                return true;\n            }\n        } else {\n            return false;\n        }\n    }\n\n    _computeExtent() {\n        return computeExtent.call(this, 'getCenter');\n    }\n\n    _computePrjExtent() {\n        return computeExtent.call(this, '_getPrjCoordinates');\n    }\n\n    _computeGeodesicLength() {\n        return 0;\n    }\n\n    _computeGeodesicArea() {\n        return 0;\n    }\n\n    _getSprite(resources, canvasClass) {\n        if (this._getPainter()) {\n            return this._getPainter().getSprite(resources, canvasClass);\n        }\n        return new Painter(this).getSprite(resources, canvasClass);\n    }\n}\n\nMarker.mergeOptions(options);\n\nMarker.registerJSONType('Marker');\n\nexport default Marker;\n\nfunction computeExtent(fn) {\n    const coordinates = this[fn]();\n    if (!coordinates) {\n        return null;\n    }\n    return new Extent(coordinates, coordinates, this._getProjection());\n}\n","import Coordinate from '../geo/Coordinate';\nimport { clipLine } from '../core/util/path';\nimport Path from './Path';\n\n/**\n * @property {Object} [options=null]\n * @property {String|Number[]} [options.arrowStyle=null]        - style of arrow, can be a pre-defined value or an array [arrow-width, arrow-height] (value in the array is times of linewidth), possible predefined values: classic ([3, 4])\n * @property {String} [options.arrowPlacement=vertex-last]      - arrow's placement: vertex-first, vertex-last, vertex-firstlast, point\n * @memberOf LineString\n * @instance\n */\nconst options = {\n    'arrowStyle': null,\n    'arrowPlacement': 'vertex-last' //vertex-first, vertex-last, vertex-firstlast, point\n};\n\n/**\n * Represents a LineString type Geometry.\n * @category geometry\n * @extends Path\n * @example\n * var line = new LineString(\n *     [\n *         [121.45942, 31.24123],\n *         [121.46371, 31.24226],\n *         [121.46727, 31.23870],\n *         [121.47019, 31.24145]\n *     ]\n * ).addTo(layer);\n */\nclass LineString extends Path {\n\n    /**\n     * @param {Coordinate[]|Number[][]} coordinates - coordinates of the line string\n     * @param {Object} [options=null] - construct options defined in [LineString]{@link LineString#options}\n     */\n    constructor(coordinates, options) {\n        super(options);\n        this.type = 'LineString';\n        if (coordinates) {\n            this.setCoordinates(coordinates);\n        }\n    }\n\n    /**\n     * Set new coordinates to the line string\n     * @param {Coordinate[]|Number[][]} coordinates - new coordinates\n     * @fires LineString#shapechange\n     * @return {LineString} this\n     */\n    setCoordinates(coordinates) {\n        if (!coordinates) {\n            this._coordinates = null;\n            this._setPrjCoordinates(null);\n            return this;\n        }\n        this._coordinates = Coordinate.toCoordinates(coordinates);\n        if (this.getMap()) {\n            this._setPrjCoordinates(this._projectCoords(this._coordinates));\n        } else {\n            this.onShapeChanged();\n        }\n        return this;\n    }\n\n    /**\n     * Get coordinates of the line string\n     * @return {Coordinate[]|Number[][]} coordinates\n     */\n    getCoordinates() {\n        return this._coordinates || [];\n    }\n\n    /**\n     * Get center of linestring's intersection with give extent\n     * @example\n     *  const extent = map.getExtent();\n     *  const center = line.getCenterInExtent(extent);\n     * @param {Extent} extent\n     * @return {Coordinate} center, null if line doesn't intersect with extent\n     */\n    getCenterInExtent(extent) {\n        return this._getCenterInExtent(extent, this.getCoordinates(), clipLine);\n    }\n\n    _computeGeodesicLength(measurer) {\n        return measurer.measureLength(this.getCoordinates());\n    }\n\n    _computeGeodesicArea() {\n        return 0;\n    }\n}\n\nLineString.mergeOptions(options);\n\nLineString.registerJSONType('LineString');\n\nexport default LineString;\n","import { isFunction, isArrayHasData } from '../core/util';\nimport { createFilter, getFilterFeature } from '@maptalks/feature-filter';\nimport { getExternalResources } from '../core/util/resource';\nimport Coordinate from '../geo/Coordinate';\nimport Geometry from './Geometry';\n\n/**\n * @classdesc\n * Represents a GeometryCollection.\n * @category geometry\n * @extends Geometry\n * @example\n * var marker = new Marker([0, 0]),\n *     line = new LineString([[0, 0], [0, 1]]),\n *     polygon = new Polygon([[0, 0], [0, 1], [1, 3]]);\n * var collection = new GeometryCollection([marker, line, polygon])\n *     .addTo(layer);\n */\nclass GeometryCollection extends Geometry {\n\n    /**\n     * @param {Geometry[]} geometries - GeometryCollection's geometries\n     * @param {Object} [options=null] - options defined in [nGeometryCollection]{@link GeometryCollection#options}\n     */\n    constructor(geometries, opts) {\n        super(opts);\n        this.type = 'GeometryCollection';\n        this.setGeometries(geometries);\n    }\n\n    /**\n     * Set new geometries to the geometry collection\n     * @param {Geometry[]} geometries\n     * @return {GeometryCollection} this\n     * @fires GeometryCollection#shapechange\n     */\n    setGeometries(_geometries) {\n        const geometries = this._checkGeometries(_geometries || []);\n        const symbol = this._getSymbol();\n        const options = this.config();\n        //Set the collection as child geometries' parent.\n        for (let i = geometries.length - 1; i >= 0; i--) {\n            geometries[i]._initOptions(options);\n            geometries[i]._setParent(this);\n            geometries[i]._setEventParent(this);\n            if (symbol) {\n                geometries[i].setSymbol(symbol);\n            }\n        }\n        this._geometries = geometries;\n        if (this.getLayer()) {\n            this._bindGeometriesToLayer();\n            this.onShapeChanged();\n        }\n        return this;\n    }\n\n    /**\n     * Get geometries of the geometry collection\n     * @return {Geometry[]} geometries\n     */\n    getGeometries() {\n        return this._geometries || [];\n    }\n\n    /**\n     * Executes the provided callback once for each geometry present in the collection in order.\n     * @param  {Function} fn             - a callback function\n     * @param  {*} [context=undefined]   - callback's context\n     * @return {GeometryCollection} this\n     */\n    forEach(fn, context) {\n        const geometries = this.getGeometries();\n        for (let i = 0, l = geometries.length; i < l; i++) {\n            if (!geometries[i]) {\n                continue;\n            }\n            if (!context) {\n                fn(geometries[i], i);\n            } else {\n                fn.call(context, geometries[i], i);\n            }\n        }\n        return this;\n    }\n\n    /**\n     * Creates a GeometryCollection with all elements that pass the test implemented by the provided function.\n     * @param  {Function} fn      - Function to test each geometry\n     * @param  {*} [context=undefined]    - Function's context\n     * @return {GeometryCollection} A GeometryCollection with all elements that pass the test\n     * @example\n     * var filtered = collection.filter(['==', 'foo', 'bar]);\n     * @example\n     * var filtered = collection.filter(geometry => geometry.getProperties().foo === 'bar');\n     */\n    filter(fn, context) {\n        if (!fn) {\n            return new GeometryCollection();\n        }\n        const selected = [];\n        const isFn = isFunction(fn);\n        const filter = isFn ? fn : createFilter(fn);\n\n        this.forEach(geometry => {\n            const g = isFn ? geometry : getFilterFeature(geometry);\n            if (context ? filter.call(context, g) : filter(g)) {\n                selected.push(geometry);\n            }\n        }, this);\n\n        return new GeometryCollection(selected);\n    }\n\n    /**\n     * Translate or move the geometry collection by the given offset.\n     * @param  {Coordinate} offset - translate offset\n     * @return {GeometryCollection} this\n     */\n    translate(offset) {\n        if (!offset) {\n            return this;\n        }\n        if (this.isEmpty()) {\n            return this;\n        }\n        const args = arguments;\n        this.forEach(function (geometry) {\n            if (geometry && geometry.translate) {\n                geometry.translate.apply(geometry, args);\n            }\n        });\n        return this;\n    }\n\n    /**\n     * Whether the geometry collection is empty\n     * @return {Boolean}\n     */\n    isEmpty() {\n        return !isArrayHasData(this.getGeometries());\n    }\n\n    /**\n     * remove itself from the layer if any.\n     * @returns {Geometry} this\n     * @fires GeometryCollection#removestart\n     * @fires GeometryCollection#remove\n     * @fires GeometryCollection#removeend\n     */\n    remove() {\n        this.forEach(function (geometry) {\n            geometry._unbind();\n        });\n        return Geometry.prototype.remove.apply(this, arguments);\n    }\n\n    /**\n     * Show the geometry collection.\n     * @return {GeometryCollection} this\n     * @fires GeometryCollection#show\n     */\n    show() {\n        this.options['visible'] = true;\n        this.forEach(function (geometry) {\n            geometry.show();\n        });\n        return this;\n    }\n\n    /**\n     * Hide the geometry collection.\n     * @return {GeometryCollection} this\n     * @fires GeometryCollection#hide\n     */\n    hide() {\n        this.options['visible'] = false;\n        this.forEach(function (geometry) {\n            geometry.hide();\n        });\n        return this;\n    }\n\n    onConfig(config) {\n        this.forEach(function (geometry) {\n            geometry.config(config);\n        });\n    }\n\n    getSymbol() {\n        let s = super.getSymbol();\n        if (!s) {\n            const symbols = [];\n            let is = false;\n            this.forEach(g => {\n                const symbol = g.getSymbol();\n                if (symbol && !is) {\n                    is = true;\n                }\n                symbols.push(g.getSymbol());\n            });\n            if (is) {\n                s =  {\n                    'children' : symbols\n                };\n            }\n        }\n        return s;\n    }\n\n    setSymbol(s) {\n        if (s && s['children']) {\n            this._symbol = null;\n            this.forEach((g, i) => {\n                g.setSymbol(s['children'][i]);\n            });\n        } else {\n            const symbol = this._prepareSymbol(s);\n            this._symbol = symbol;\n            this.forEach(g => {\n                g.setSymbol(symbol);\n            });\n        }\n        this.onSymbolChanged();\n        return this;\n    }\n\n    _setExternSymbol(symbol) {\n        symbol = this._prepareSymbol(symbol);\n        this._externSymbol = symbol;\n        this.forEach(function (geometry) {\n            geometry._setExternSymbol(symbol);\n        });\n        this.onSymbolChanged();\n        return this;\n    }\n\n    /**\n     * bind this geometry collection to a layer\n     * @param  {Layer} layer\n     * @private\n     */\n    _bindLayer() {\n        super._bindLayer.apply(this, arguments);\n        this._bindGeometriesToLayer();\n    }\n\n    _bindGeometriesToLayer() {\n        const layer = this.getLayer();\n        this.forEach(function (geometry) {\n            geometry._bindLayer(layer);\n        });\n    }\n\n    /**\n     * Check whether the type of geometries is valid\n     * @param  {Geometry[]} geometries - geometries to check\n     * @private\n     */\n    _checkGeometries(geometries) {\n        const invalidGeoError = 'The geometry added to collection is invalid.';\n        if (geometries && !Array.isArray(geometries)) {\n            if (geometries instanceof Geometry) {\n                return [geometries];\n            } else {\n                throw new Error(invalidGeoError);\n            }\n        } else {\n            for (let i = 0, l = geometries.length; i < l; i++) {\n                if (!this._checkGeo(geometries[i])) {\n                    throw new Error(invalidGeoError + ' Index: ' + i);\n                }\n            }\n            return geometries;\n        }\n    }\n\n    _checkGeo(geo) {\n        return (geo instanceof Geometry);\n    }\n\n    _updateCache() {\n        this._clearCache();\n        if (this.isEmpty()) {\n            return;\n        }\n        this.forEach(function (geometry) {\n            if (geometry && geometry._updateCache) {\n                geometry._updateCache();\n            }\n        });\n    }\n\n    _removePainter() {\n        if (this._painter) {\n            this._painter.remove();\n        }\n        delete this._painter;\n        this.forEach(function (geometry) {\n            geometry._removePainter();\n        });\n    }\n\n    _computeCenter(projection) {\n        if (!projection || this.isEmpty()) {\n            return null;\n        }\n        let sumX = 0,\n            sumY = 0,\n            counter = 0;\n        const geometries = this.getGeometries();\n        for (let i = 0, l = geometries.length; i < l; i++) {\n            if (!geometries[i]) {\n                continue;\n            }\n            const center = geometries[i]._computeCenter(projection);\n            if (center) {\n                sumX += center.x;\n                sumY += center.y;\n                counter++;\n            }\n        }\n        if (counter === 0) {\n            return null;\n        }\n        return new Coordinate(sumX / counter, sumY / counter);\n    }\n\n    _containsPoint(point, t) {\n        if (this.isEmpty()) {\n            return false;\n        }\n        const geometries = this.getGeometries();\n        for (let i = 0, l = geometries.length; i < l; i++) {\n            if (geometries[i]._containsPoint(point, t)) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    _computeExtent(projection) {\n        return computeExtent.call(this, projection, '_computeExtent');\n    }\n\n    _computePrjExtent(projection) {\n        return computeExtent.call(this, projection, '_computePrjExtent');\n    }\n\n    _computeGeodesicLength(projection) {\n        if (!projection || this.isEmpty()) {\n            return 0;\n        }\n        const geometries = this.getGeometries();\n        let result = 0;\n        for (let i = 0, l = geometries.length; i < l; i++) {\n            if (!geometries[i]) {\n                continue;\n            }\n            result += geometries[i]._computeGeodesicLength(projection);\n        }\n        return result;\n    }\n\n    _computeGeodesicArea(projection) {\n        if (!projection || this.isEmpty()) {\n            return 0;\n        }\n        const geometries = this.getGeometries();\n        let result = 0;\n        for (let i = 0, l = geometries.length; i < l; i++) {\n            if (!geometries[i]) {\n                continue;\n            }\n            result += geometries[i]._computeGeodesicArea(projection);\n        }\n        return result;\n    }\n\n    _exportGeoJSONGeometry() {\n        const children = [];\n        if (!this.isEmpty()) {\n            const geometries = this.getGeometries();\n            for (let i = 0, l = geometries.length; i < l; i++) {\n                if (!geometries[i]) {\n                    continue;\n                }\n                children.push(geometries[i]._exportGeoJSONGeometry());\n            }\n        }\n        return {\n            'type': 'GeometryCollection',\n            'geometries': children\n        };\n    }\n\n    _clearProjection() {\n        if (this.isEmpty()) {\n            return;\n        }\n        const geometries = this.getGeometries();\n        for (let i = 0, l = geometries.length; i < l; i++) {\n            if (!geometries[i]) {\n                continue;\n            }\n            geometries[i]._clearProjection();\n        }\n\n    }\n\n    /**\n     * Get connect points if being connected by [ConnectorLine]{@link ConnectorLine}\n     * @private\n     * @return {Coordinate[]}\n     */\n    _getConnectPoints() {\n        const extent = this.getExtent();\n        const anchors = [\n            new Coordinate(extent.xmin, extent.ymax),\n            new Coordinate(extent.xmax, extent.ymin),\n            new Coordinate(extent.xmin, extent.ymin),\n            new Coordinate(extent.xmax, extent.ymax)\n        ];\n        return anchors;\n    }\n\n    _getExternalResources() {\n        if (this.isEmpty()) {\n            return [];\n        }\n        const geometries = this.getGeometries(),\n            resources = [];\n        const cache = {};\n        let symbol, res, key;\n        for (let i = 0, l = geometries.length; i < l; i++) {\n            if (!geometries[i]) {\n                continue;\n            }\n            symbol = geometries[i]._getInternalSymbol();\n            res = getExternalResources(symbol);\n            for (let ii = 0, ll = res.length; ii < ll; ii++) {\n                key = res[ii].join();\n                if (!cache[key]) {\n                    resources.push(res[ii]);\n                    cache[key] = 1;\n                }\n            }\n        }\n        return resources;\n    }\n\n    //----------Overrides editor methods in Geometry-----------------\n\n    startEdit(opts) {\n        if (this.isEmpty()) {\n            return this;\n        }\n        if (!opts) {\n            opts = {};\n        }\n        if (opts['symbol']) {\n            this._originalSymbol = this.getSymbol();\n            this.setSymbol(opts['symbol']);\n        }\n        this._draggbleBeforeEdit = this.options['draggable'];\n        this.config('draggable', false);\n        const geometries = this.getGeometries();\n        for (let i = 0, l = geometries.length; i < l; i++) {\n            geometries[i].startEdit(opts);\n        }\n        this._editing = true;\n        this.hide();\n        setTimeout(() => {\n            this.fire('editstart');\n        }, 1);\n        return this;\n    }\n\n    endEdit() {\n        if (this.isEmpty()) {\n            return this;\n        }\n        const geometries = this.getGeometries();\n        for (let i = 0, l = geometries.length; i < l; i++) {\n            geometries[i].endEdit();\n        }\n        if (this._originalSymbol) {\n            this.setSymbol(this._originalSymbol);\n            delete this._originalSymbol;\n        }\n        this._editing = false;\n        this.show();\n        this.config('draggable', this._draggbleBeforeEdit);\n        this.fire('editend');\n        return this;\n    }\n\n    isEditing() {\n        if (!this._editing) {\n            return false;\n        }\n        return true;\n    }\n}\n\nGeometryCollection.registerJSONType('GeometryCollection');\n\nexport default GeometryCollection;\n\nfunction computeExtent(projection, fn) {\n    if (this.isEmpty()) {\n        return null;\n    }\n    const geometries = this.getGeometries();\n    let result = null;\n    for (let i = 0, l = geometries.length; i < l; i++) {\n        const geo = geometries[i];\n        if (!geo) {\n            continue;\n        }\n        const geoExtent = geo[fn](projection);\n        if (geoExtent) {\n            result = geoExtent.combine(result);\n        }\n    }\n    return result;\n}\n","import GeometryCollection from './GeometryCollection';\nimport Coordinate from '../geo/Coordinate';\n\n/**\n * The parent class for MultiPoint, MultiLineString and MultiPolygon\n * @category geometry\n * @abstract\n * @extends {GeometryCollection}\n */\nclass MultiGeometry extends GeometryCollection {\n\n    /**\n     * @param  {Class} geoType      Type of the geometry\n     * @param  {String} type        type in String, e.g. \"MultiPoint\", \"MultiLineString\"\n     * @param  {Geometry[]} data    data\n     * @param  {Object} [options=null] configuration options\n     */\n    constructor(geoType, type, data, options) {\n        super(null, options);\n        this.GeometryType = geoType;\n        this.type = type;\n        this._initData(data);\n    }\n\n    /**\n     * Get coordinates of the collection\n     * @return {Coordinate[]|Coordinate[][]|Coordinate[][][]} coordinates\n     */\n    getCoordinates() {\n        const coordinates = [];\n        const geometries = this.getGeometries();\n        for (let i = 0, l = geometries.length; i < l; i++) {\n            const child = geometries[i];\n            coordinates.push(child.getShell && child.getJSONType() !== 'Polygon' ? [child.getShell()] : child.getCoordinates());\n        }\n        return coordinates;\n    }\n\n    /**\n     * Set new coordinates to the collection\n     * @param {Coordinate[]|Coordinate[][]|Coordinate[][][]} coordinates\n     * @returns {Geometry} this\n     * @fires maptalk.Geometry#shapechange\n     */\n    setCoordinates(coordinates) {\n        coordinates = coordinates || [];\n        const geometries = [];\n        for (let i = 0, l = coordinates.length; i < l; i++) {\n            const g = new this.GeometryType(coordinates[i], this.config());\n            geometries.push(g);\n        }\n        this.setGeometries(geometries);\n        return this;\n    }\n\n    _initData(data) {\n        data = data || [];\n        if (data.length) {\n            if (data[0] instanceof this.GeometryType) {\n                this.setGeometries(data);\n            } else {\n                this.setCoordinates(data);\n            }\n        }\n    }\n\n    _checkGeo(geo) {\n        return (geo instanceof this.GeometryType);\n    }\n\n    //override _exportGeoJSONGeometry in GeometryCollection\n    _exportGeoJSONGeometry() {\n        const points = this.getCoordinates();\n        const coordinates = Coordinate.toNumberArrays(points);\n        return {\n            'type': this.getType(),\n            'coordinates': coordinates\n        };\n    }\n}\n\nexport default MultiGeometry;\n","import MultiGeometry from './MultiGeometry';\nimport Marker from './Marker';\n\n/**\n * @classdesc\n * Represents a Geometry type of MultiPoint.\n * @category geometry\n * @extends MultiGeometry\n * @example\n * var multiPoint = new MultiPoint(\n *     [\n *         [121.5080881906138, 31.241128104458117],\n *         [121.50804527526954, 31.237238340103413],\n *         [121.5103728890997, 31.23888972560888]\n *     ]\n * ).addTo(layer);\n */\nclass MultiPoint extends MultiGeometry {\n\n    /**\n     * @param {Number[][]|Coordinate[]|Marker[]} data - construct data, coordinates or an array of markers\n     * @param {Object} [options=null] - options defined in [nMultiPoint]{@link MultiPoint#options}\n     */\n    constructor(data, opts) {\n        super(Marker, 'MultiPoint', data, opts);\n    }\n\n    /**\n     * Find the closet point to the give coordinate\n     * @param {Coordinate} coordinate coordinate\n     * @returns {Coordinate} coordinate\n     */\n    findClosest(coordinate) {\n        if (!coordinate) {\n            return null;\n        }\n        const coords = this.getCoordinates();\n        let hit = null;\n        let max = Infinity;\n        coords.forEach(c => {\n            const dist = distanceTo(c, coordinate);\n            if (dist < max) {\n                hit = c;\n                max = dist;\n            }\n        });\n        return hit;\n    }\n}\n\nMultiPoint.registerJSONType('MultiPoint');\n\nexport default MultiPoint;\n\nfunction distanceTo(p0, p1) {\n    const x = p1.x - p0.x,\n        y = p1.y - p0.y;\n    return Math.sqrt(x * x + y * y);\n}\n","import MultiGeometry from './MultiGeometry';\nimport Coordinate from '../geo/Coordinate';\n\n/**\n * @classdesc\n * An abstract class for MultiPolygon and MultiLineString\n * @category geometry\n * @extends MultiGeometry\n */\nclass MultiPath extends MultiGeometry {\n\n    /**\n     * Get center of (MultiLineString or MultiPolygon)'s intersection with give extent\n     * @example\n     *  const extent = map.getExtent();\n     *  const center = geometry.getCenterInExtent(extent);\n     * @param {Extent} extent\n     * @return {Coordinate} center, null if line doesn't intersect with extent\n     */\n    getCenterInExtent(extent) {\n        const children = this.getGeometries();\n        let [sumx, sumy, counter] = [0, 0, 0];\n        children.forEach(l => {\n            const c = l.getCenterInExtent(extent);\n            if (c) {\n                sumx += c.x * c.count;\n                sumy += c.y * c.count;\n                counter += c.count;\n            }\n        });\n        if (counter === 0) {\n            return null;\n        }\n        return new Coordinate(sumx, sumy)._multi(1 / counter);\n    }\n}\n\n\nexport default MultiPath;\n","import MultiPath from './MultiPath';\nimport LineString from './LineString';\n\n/**\n * @classdesc\n * Represents a Geometry type of MultiLineString\n * @category geometry\n * @extends MultiGeometry\n * @example\n * var multiLineString = new MultiLineString(\n *      [\n *          [\n *              [121.5289450479131, 31.2420083925986],\n *              [121.52860172515919, 31.238926401171824]\n *          ],\n *          [\n *              [121.53091915374796, 31.241898323208233],\n *              [121.53104789978069, 31.23859618183896]\n *          ],\n *          [\n *               [121.5324641061405, 31.241898323208233],\n *               [121.53242119079626, 31.239146546752256]\n *           ]\n *       ],\n *       {\n *           symbol:{\n *               'lineColor' : '#000000',\n *               'lineWidth' : 5,\n *               'lineOpacity' : 1\n *           },\n *          draggable:true\n *      }\n * ).addTo(layer);\n */\nclass MultiLineString extends MultiPath {\n\n    /**\n     * @param {Number[][][]|Coordinate[][]|LineString[]} data - construct data, coordinates or an array of linestrings\n     * @param {Object} [options=null]           - options defined in [MultiLineString]{@link MultiLineString#options}\n     */\n    constructor(data, options) {\n        super(LineString, 'MultiLineString', data, options);\n    }\n}\n\nMultiLineString.registerJSONType('MultiLineString');\n\nexport default MultiLineString;\n","import MultiPath from './MultiPath';\nimport Polygon from './Polygon';\n\n/**\n * @classdesc\n * Represents a Geometry type of MultiPolygon\n * @category geometry\n * @extends MultiGeometry\n * @example\n * var multiPolygon = new MultiPolygon(\n *       [\n *           [\n *               [\n *                   [121.55074604278596, 31.242008515751614],\n *                   [121.55074604278596, 31.23914637638951],\n *                   [121.55349262481711, 31.23914637638951],\n *                   [121.55349262481711, 31.24134802974913],\n *                   [121.5518618417361, 31.241384723537074],\n *                   [121.55074604278596, 31.242008515751614]\n *               ]\n *           ],\n *           [\n *               [\n *                   [121.5543080163576, 31.241054478932387],\n *                   [121.5543938470461, 31.240100432478293],\n *                   [121.55555256134048, 31.240173821009137],\n *                   [121.55542381530773, 31.240981091085693],\n *                   [121.5543080163576, 31.241054478932387]\n *               ]\n *           ]\n *\n *       ],\n *       {\n *           symbol:{\n *               'lineColor' : '#000000',\n *               'lineWidth' : 2,\n *               'lineDasharray' : null,//线形\n *               'lineOpacity' : 1,\n *               'polygonFill' : 'rgb(255, 0, 0)',\n *               'polygonOpacity' : 0.8\n *           },\n *           draggable:true\n * }).addTo(layer);\n */\nclass MultiPolygon extends MultiPath {\n\n    /**\n     * @param {Number[][][][]|Coordinate[][][]|Polygon[]} data - construct data, coordinates or an array of polygons\n     * @param {Object} [options=null]           - options defined in [MultiPolygon]{@link MultiPolygon#options}\n     */\n    constructor(data, opts) {\n        super(Polygon, 'MultiPolygon', data, opts);\n    }\n}\n\nMultiPolygon.registerJSONType('MultiPolygon');\n\nexport default MultiPolygon;\n","import {\n    isNil,\n    isString,\n    parseJSON,\n    isArrayHasData,\n    pushIn\n} from '../core/util';\nimport Marker from './Marker';\nimport LineString from './LineString';\nimport Polygon from './Polygon';\nimport MultiPoint from './MultiPoint';\nimport MultiLineString from './MultiLineString';\nimport MultiPolygon from './MultiPolygon';\nimport GeometryCollection from './GeometryCollection';\n\nconst types = {\n    'Marker': Marker,\n    'LineString': LineString,\n    'Polygon': Polygon,\n    'MultiPoint': MultiPoint,\n    'MultiLineString': MultiLineString,\n    'MultiPolygon': MultiPolygon\n};\n\n/**\n * GeoJSON utilities\n * @class\n * @category geometry\n * @name GeoJSON\n */\nconst GeoJSON = {\n\n    /**\n     * Convert one or more GeoJSON objects to geometry\n     * @param  {String|Object|Object[]} geoJSON - GeoJSON objects or GeoJSON string\n     * @return {Geometry|Geometry[]} a geometry array when input is a FeatureCollection\n     * @example\n     * var collection = {\n     *      \"type\": \"FeatureCollection\",\n     *      \"features\": [\n     *          { \"type\": \"Feature\",\n     *            \"geometry\": {\"type\": \"Point\", \"coordinates\": [102.0, 0.5]},\n     *            \"properties\": {\"prop0\": \"value0\"}\n     *           },\n     *           { \"type\": \"Feature\",\n     *             \"geometry\": {\n     *                 \"type\": \"LineString\",\n     *                 \"coordinates\": [\n     *                     [102.0, 0.0], [103.0, 1.0], [104.0, 0.0], [105.0, 1.0]\n     *                 ]\n     *             },\n     *             \"properties\": {\n     *                 \"prop0\": \"value0\",\n     *                 \"prop1\": 0.0\n     *             }\n     *           },\n     *           { \"type\": \"Feature\",\n     *             \"geometry\": {\n     *                 \"type\": \"Polygon\",\n     *                 \"coordinates\": [\n     *                     [ [100.0, 0.0], [101.0, 0.0], [101.0, 1.0],\n     *                       [100.0, 1.0], [100.0, 0.0] ]\n     *                 ]\n     *             },\n     *             \"properties\": {\n     *                 \"prop0\": \"value0\",\n     *                 \"prop1\": {\"this\": \"that\"}\n     *             }\n     *          }\n     *      ]\n     *  }\n     *  // A geometry array.\n     *  const geometries = GeoJSON.toGeometry(collection);\n     */\n    toGeometry: function (geoJSON) {\n        if (isString(geoJSON)) {\n            geoJSON = parseJSON(geoJSON);\n        }\n        if (Array.isArray(geoJSON)) {\n            const resultGeos = [];\n            for (let i = 0, len = geoJSON.length; i < len; i++) {\n                const geo = GeoJSON._convert(geoJSON[i]);\n                if (Array.isArray(geo)) {\n                    pushIn(resultGeos, geo);\n                } else {\n                    resultGeos.push(geo);\n                }\n            }\n            return resultGeos;\n        } else {\n            const resultGeo = GeoJSON._convert(geoJSON);\n            return resultGeo;\n        }\n\n    },\n\n    /**\n     * Convert single GeoJSON object\n     * @param  {Object} geoJSONObj - a GeoJSON object\n     * @return {Geometry}\n     * @private\n     */\n    _convert: function (json) {\n        if (!json || isNil(json['type'])) {\n            return null;\n        }\n\n        const type = json['type'];\n        if (type === 'Feature') {\n            const g = json['geometry'];\n            const geometry = GeoJSON._convert(g);\n            if (!geometry) {\n                return null;\n            }\n            geometry.setId(json['id']);\n            geometry.setProperties(json['properties']);\n            return geometry;\n        } else if (type === 'FeatureCollection') {\n            const features = json['features'];\n            if (!features) {\n                return null;\n            }\n            const result = GeoJSON.toGeometry(features);\n            return result;\n        } else if (['Point', 'LineString', 'Polygon', 'MultiPoint', 'MultiLineString', 'MultiPolygon'].indexOf(type) >= 0) {\n            const clazz = (type === 'Point' ? 'Marker' : type);\n            return new types[clazz](json['coordinates']);\n        } else if (type === 'GeometryCollection') {\n            const geometries = json['geometries'];\n            if (!isArrayHasData(geometries)) {\n                return new GeometryCollection();\n            }\n            const mGeos = [];\n            const size = geometries.length;\n            for (let i = 0; i < size; i++) {\n                mGeos.push(GeoJSON._convert(geometries[i]));\n            }\n            return new GeometryCollection(mGeos);\n        }\n        return null;\n    }\n};\n\nexport default GeoJSON;\n","import { extend, isNil } from '../core/util';\nimport { withInEllipse } from '../core/util/path';\nimport Coordinate from '../geo/Coordinate';\nimport Extent from '../geo/Extent';\nimport CenterMixin from './CenterMixin';\nimport Polygon from './Polygon';\n\n/**\n * @property {Object} options\n * @property {Number} [options.numberOfShellPoints=60]   - number of shell points when converting the circle to a polygon.\n * @memberOf Circle\n * @instance\n */\nconst options = {\n    'numberOfShellPoints': 60\n};\n\n/**\n * @classdesc\n * Represents a Circle Geometry. <br>\n * @category geometry\n * @extends Polygon\n * @mixes Geometry.Center\n * @example\n * var circle = new Circle([100, 0], 1000, {\n *     id : 'circle0',\n *     properties : {\n *         foo : 'bar'\n *     }\n * });\n * @mixes CenterMixin\n */\nclass Circle extends CenterMixin(Polygon) {\n\n    static fromJSON(json) {\n        const feature = json['feature'];\n        const circle = new Circle(json['coordinates'], json['radius'], json['options']);\n        circle.setProperties(feature['properties']);\n        return circle;\n    }\n\n    /**\n     * @param {Coordinate} center - center of the circle\n     * @param {Number} radius           - radius of the circle, in meter\n     * @param {Object} [options=null]   - construct options defined in [Circle]{@link Circle#options}\n     */\n    constructor(coordinates, radius, opts) {\n        super(null, opts);\n        if (coordinates) {\n            this.setCoordinates(coordinates);\n        }\n        this._radius = radius;\n    }\n\n    /**\n     * Get radius of the circle\n     * @return {Number}\n     */\n    getRadius() {\n        return this._radius;\n    }\n\n    /**\n     * Set a new radius to the circle\n     * @param {Number} radius - new radius\n     * @return {Circle} this\n     * @fires Circle#shapechange\n     */\n    setRadius(radius) {\n        this._radius = radius;\n        this.onShapeChanged();\n        return this;\n    }\n\n    /**\n     * Gets the shell of the circle as a polygon, number of the shell points is decided by [options.numberOfShellPoints]{@link Circle#options}\n     * @return {Coordinate[]} - shell coordinates\n     */\n    getShell() {\n        const measurer = this._getMeasurer(),\n            center = this.getCoordinates(),\n            numberOfPoints = this.options['numberOfShellPoints'],\n            radius = this.getRadius();\n        const shell = [];\n        let rad, dx, dy;\n        for (let i = 0, len = numberOfPoints - 1; i < len; i++) {\n            rad = (360 * i / len) * Math.PI / 180;\n            dx = radius * Math.cos(rad);\n            dy = radius * Math.sin(rad);\n            const vertex = measurer.locate(center, dx, dy);\n            shell.push(vertex);\n        }\n        shell.push(shell[0]);\n        return shell;\n    }\n\n    /**\n     * Circle won't have any holes, always returns null\n     * @return {Object[]} an empty array\n     */\n    getHoles() {\n        return [];\n    }\n\n    animateShow() {\n        return this.show();\n    }\n\n    _containsPoint(point, tolerance) {\n        const map = this.getMap();\n        if (map.getPitch()) {\n            return super._containsPoint(point, tolerance);\n        }\n        const center = map._pointToContainerPoint(this._getCenter2DPoint()),\n            size = this.getSize(),\n            t = isNil(tolerance) ? this._hitTestTolerance() : tolerance,\n            se = center.add(size.width / 2, size.height / 2);\n        return withInEllipse(point, center, se, t);\n    }\n\n    _computePrjExtent(projection) {\n        const minmax = this._getMinMax(projection);\n        if (!minmax) {\n            return null;\n        }\n        const pcenter = this._getPrjCoordinates();\n        const pminmax = minmax.map(c => projection.project(c));\n        const dx = Math.min(Math.abs(pminmax[0].x - pcenter.x), Math.abs(pminmax[1].x - pcenter.x)),\n            dy = Math.min(Math.abs(pminmax[2].y - pcenter.y), Math.abs(pminmax[3].y - pcenter.y));\n        return new Extent(pcenter.sub(dx, dy), pcenter.add(dx, dy));\n    }\n\n    _computeExtent(measurer) {\n        const minmax = this._getMinMax(measurer);\n        if (!minmax) {\n            return null;\n        }\n        return new Extent(minmax[0].x, minmax[2].y, minmax[1].x, minmax[3].y, this._getProjection());\n    }\n\n    _getMinMax(measurer) {\n        if (!measurer || !this._coordinates || isNil(this._radius)) {\n            return null;\n        }\n        const radius = this._radius;\n        const p1 = measurer.locate(this._coordinates, -radius, 0),\n            p2 = measurer.locate(this._coordinates, radius, 0),\n            p3 = measurer.locate(this._coordinates, 0, radius),\n            p4 = measurer.locate(this._coordinates, 0, -radius);\n        return [p1, p2, p3, p4];\n    }\n\n    _computeGeodesicLength() {\n        if (isNil(this._radius)) {\n            return 0;\n        }\n        return Math.PI * 2 * this._radius;\n    }\n\n    _computeGeodesicArea() {\n        if (isNil(this._radius)) {\n            return 0;\n        }\n        return Math.PI * Math.pow(this._radius, 2);\n    }\n\n    _exportGeoJSONGeometry() {\n        const coordinates = Coordinate.toNumberArrays([this.getShell()]);\n        return {\n            'type': 'Polygon',\n            'coordinates': coordinates\n        };\n    }\n\n    _toJSON(options) {\n        const center = this.getCenter();\n        const opts = extend({}, options);\n        opts.geometry = false;\n        const feature = this.toGeoJSON(opts);\n        feature['geometry'] = {\n            'type': 'Polygon'\n        };\n        return {\n            'feature': feature,\n            'subType': 'Circle',\n            'coordinates': [center.x, center.y],\n            'radius': this.getRadius()\n        };\n    }\n\n}\n\nCircle.mergeOptions(options);\n\nCircle.registerJSONType('Circle');\n\nexport default Circle;\n","import { extend, isNil } from '../core/util';\nimport { withInEllipse } from '../core/util/path';\nimport Coordinate from '../geo/Coordinate';\nimport CenterMixin from './CenterMixin';\nimport Polygon from './Polygon';\nimport Circle from './Circle';\n\n/**\n * @property {Object} [options=null]\n * @property {Number} [options.numberOfShellPoints=60]   - number of shell points when exporting the ellipse's shell coordinates as a polygon.\n * @memberOf Ellipse\n * @instance\n */\nconst options = {\n    'numberOfShellPoints': 80\n};\n\n/**\n * Represents a Ellipse Geometry. <br>\n * @category geometry\n * @extends Polygon\n * @mixes CenterMixin\n * @example\n * var ellipse = new Ellipse([100, 0], 1000, 500, {\n *     id : 'ellipse0'\n * });\n */\nclass Ellipse extends CenterMixin(Polygon) {\n\n    static fromJSON(json) {\n        const feature = json['feature'];\n        const ellipse = new Ellipse(json['coordinates'], json['width'], json['height'], json['options']);\n        ellipse.setProperties(feature['properties']);\n        return ellipse;\n    }\n\n    /**\n     * @param {Coordinate} center  - center of the ellipse\n     * @param {Number} width  - width of the ellipse, in meter\n     * @param {Number} height - height of the ellipse, in meter\n     * @param {Object}  [options=null] - construct options defined in [Ellipse]{@link Ellipse#options}\n     */\n    constructor(coordinates, width, height, opts) {\n        super(null, opts);\n        if (coordinates) {\n            this.setCoordinates(coordinates);\n        }\n        this.width = width;\n        this.height = height;\n    }\n\n    /**\n     * Get ellipse's width\n     * @return {Number}\n     */\n    getWidth() {\n        return this.width;\n    }\n\n    /**\n     * Set new width to ellipse\n     * @param {Number} width - new width\n     * @fires Ellipse#shapechange\n     * @return {Ellipse} this\n     */\n    setWidth(width) {\n        this.width = width;\n        this.onShapeChanged();\n        return this;\n    }\n\n    /**\n     * Get ellipse's height\n     * @return {Number}\n     */\n    getHeight() {\n        return this.height;\n    }\n\n    /**\n     * Set new height to ellipse\n     * @param {Number} height - new height\n     * @fires Ellipse#shapechange\n     * @return {Ellipse} this\n     */\n    setHeight(height) {\n        this.height = height;\n        this.onShapeChanged();\n        return this;\n    }\n\n    /**\n     * Gets the shell of the ellipse as a polygon, number of the shell points is decided by [options.numberOfShellPoints]{@link Circle#options}\n     * @return {Coordinate[]} - shell coordinates\n     */\n    getShell() {\n        const measurer = this._getMeasurer(),\n            center = this.getCoordinates(),\n            numberOfPoints = this.options['numberOfShellPoints'],\n            width = this.getWidth(),\n            height = this.getHeight();\n        const shell = [];\n        const s = Math.pow(width / 2, 2) * Math.pow(height / 2, 2),\n            sx = Math.pow(width / 2, 2),\n            sy = Math.pow(height / 2, 2);\n        let deg, rad, dx, dy;\n        for (let i = 0; i < numberOfPoints; i++) {\n            deg = 360 * i / numberOfPoints;\n            rad = deg * Math.PI / 180;\n            dx = Math.sqrt(s / (sx * Math.pow(Math.tan(rad), 2) + sy));\n            dy = Math.sqrt(s / (sy * Math.pow(1 / Math.tan(rad), 2) + sx));\n            if (deg > 90 && deg < 270) {\n                dx *= -1;\n            }\n            if (deg > 180 && deg < 360) {\n                dy *= -1;\n            }\n            const vertex = measurer.locate(center, dx, dy);\n            shell.push(vertex);\n        }\n        return shell;\n    }\n\n    /**\n     * Ellipse won't have any holes, always returns null\n     * @return {Object[]} an empty array\n     */\n    getHoles() {\n        return [];\n    }\n\n    animateShow() {\n        return this.show();\n    }\n\n    _containsPoint(point, tolerance) {\n        const map = this.getMap();\n        if (map.isTransforming()) {\n            return super._containsPoint(point, tolerance);\n        }\n        const projection = map.getProjection();\n        const t = isNil(tolerance) ? this._hitTestTolerance() : tolerance,\n            pps = projection.projectCoords([this._coordinates, map.locate(this._coordinates, this.getWidth() / 2, this.getHeight() / 2)]),\n            p0 = map._prjToContainerPoint(pps[0]),\n            p1 = map._prjToContainerPoint(pps[1]);\n        return withInEllipse(point, p0, p1, t);\n    }\n\n    _computePrjExtent() {\n        return Circle.prototype._computePrjExtent.apply(this, arguments);\n    }\n\n    _computeExtent() {\n        return Circle.prototype._computeExtent.apply(this, arguments);\n    }\n\n    _getMinMax(measurer) {\n        if (!measurer || !this._coordinates || isNil(this.width) || isNil(this.height)) {\n            return null;\n        }\n        const width = this.getWidth(),\n            height = this.getHeight();\n        const p1 = measurer.locate(this._coordinates, -width / 2, 0),\n            p2 = measurer.locate(this._coordinates, width / 2, 0),\n            p3 = measurer.locate(this._coordinates, 0, -height / 2),\n            p4 = measurer.locate(this._coordinates, 0, height / 2);\n        return [p1, p2, p3, p4];\n    }\n\n    _computeGeodesicLength() {\n        if (isNil(this.width) || isNil(this.height)) {\n            return 0;\n        }\n        //L=2πb+4(a-b)\n        //近似值\n        const longer = (this.width > this.height ? this.width : this.height);\n        return 2 * Math.PI * longer / 2 - 4 * Math.abs(this.width - this.height);\n    }\n\n    _computeGeodesicArea() {\n        if (isNil(this.width) || isNil(this.height)) {\n            return 0;\n        }\n        return Math.PI * this.width * this.height / 4;\n    }\n\n    _exportGeoJSONGeometry() {\n        const coordinates = Coordinate.toNumberArrays([this.getShell()]);\n        return {\n            'type': 'Polygon',\n            'coordinates': coordinates\n        };\n    }\n\n    _toJSON(options) {\n        const opts = extend({}, options);\n        const center = this.getCenter();\n        opts.geometry = false;\n        const feature = this.toGeoJSON(opts);\n        feature['geometry'] = {\n            'type': 'Polygon'\n        };\n        return {\n            'feature': feature,\n            'subType': 'Ellipse',\n            'coordinates': [center.x, center.y],\n            'width': this.getWidth(),\n            'height': this.getHeight()\n        };\n    }\n\n}\n\nEllipse.mergeOptions(options);\n\nEllipse.registerJSONType('Ellipse');\n\nexport default Ellipse;\n","import { extend, isNil } from '../core/util';\nimport Coordinate from '../geo/Coordinate';\nimport Extent from '../geo/Extent';\nimport Polygon from './Polygon';\n\n/**\n * @classdesc\n * Represents a Rectangle geometry.\n * @category geometry\n * @extends Polygon\n * @example\n * var rectangle = new Rectangle([100, 0], 1000, 500, {\n *     id : 'rectangle0'\n * });\n */\nclass Rectangle extends Polygon {\n\n    static fromJSON(json) {\n        const feature = json['feature'];\n        const rect = new Rectangle(json['coordinates'], json['width'], json['height'], json['options']);\n        rect.setProperties(feature['properties']);\n        return rect;\n    }\n\n    /**\n     * @param {Coordinate} coordinates  - northwest of the rectangle\n     * @param {Number} width                     - width of the rectangle, in meter\n     * @param {Number} height                    - height of the rectangle, in meter\n     * @param {Object} [options=null]            - options defined in [Rectangle]{@link Rectangle#options}\n     */\n    constructor(coordinates, width, height, opts) {\n        super(null, opts);\n        if (coordinates) {\n            this.setCoordinates(coordinates);\n        }\n        this._width = width;\n        this._height = height;\n    }\n\n    /**\n     * Get coordinates of rectangle's northwest\n     * @return {Coordinate}\n     */\n    getCoordinates() {\n        return this._coordinates;\n    }\n\n    /**\n     * Set a new coordinate for northwest of the rectangle\n     * @param {Coordinate} nw - coordinates of new northwest\n     * @return {Rectangle} this\n     * @fires Rectangle#positionchange\n     */\n    setCoordinates(nw) {\n        this._coordinates = (nw instanceof Coordinate) ? nw : new Coordinate(nw);\n        if (!this._coordinates || !this.getMap()) {\n            this.onPositionChanged();\n            return this;\n        }\n        const projection = this._getProjection();\n        this._setPrjCoordinates(projection.project(this._coordinates));\n        return this;\n    }\n\n    /**\n     * Get rectangle's width\n     * @return {Number}\n     */\n    getWidth() {\n        return this._width;\n    }\n\n    /**\n     * Set new width to the rectangle\n     * @param {Number} width - new width\n     * @fires Rectangle#shapechange\n     * @return {Rectangle} this\n     */\n    setWidth(width) {\n        this._width = width;\n        this.onShapeChanged();\n        return this;\n    }\n\n    /**\n     * Get rectangle's height\n     * @return {Number}\n     */\n    getHeight() {\n        return this._height;\n    }\n\n    /**\n     * Set new height to rectangle\n     * @param {Number} height - new height\n     * @fires Rectangle#shapechange\n     * @return {Rectangle} this\n     */\n    setHeight(height) {\n        this._height = height;\n        this.onShapeChanged();\n        return this;\n    }\n\n    /**\n     * Gets the shell of the rectangle as a polygon\n     * @return {Coordinate[]} - shell coordinates\n     */\n    getShell() {\n        const measurer = this._getMeasurer();\n        const nw = this._coordinates;\n        const map = this.getMap();\n        let sx = 1,\n            sy = -1;\n        if (map) {\n            const fExt = map.getFullExtent();\n            if (fExt['left'] > fExt['right']) {\n                sx = -1;\n            }\n            if (fExt['bottom'] > fExt['top']) {\n                sy = 1;\n            }\n        }\n        const points = [];\n        points.push(nw);\n        points.push(measurer.locate(nw, sx * this._width, 0));\n        points.push(measurer.locate(nw, sx * this._width, sy * this._height));\n        points.push(measurer.locate(nw, 0, sy * this._height));\n        points.push(nw);\n        return points;\n\n    }\n\n    /**\n     * Rectangle won't have any holes, always returns null\n     * @return {Object[]} an empty array\n     */\n    getHoles() {\n        return [];\n    }\n\n    animateShow() {\n        return this.show();\n    }\n\n    _getPrjCoordinates() {\n        const projection = this._getProjection();\n        if (!projection) {\n            return null;\n        }\n        this._verifyProjection();\n        if (!this._pnw) {\n            if (this._coordinates) {\n                this._pnw = projection.project(this._coordinates);\n            }\n        }\n        return this._pnw;\n    }\n\n    _setPrjCoordinates(pnw) {\n        this._pnw = pnw;\n        this.onPositionChanged();\n    }\n\n    _getPrjShell() {\n        const shell = super._getPrjShell();\n        const projection = this._getProjection();\n        if (!projection.isSphere()) {\n            return shell;\n        }\n        const sphereExtent = projection.getSphereExtent(),\n            sx = sphereExtent.sx,\n            sy = sphereExtent.sy;\n        const circum = this._getProjection().getCircum();\n        const nw = shell[0];\n        for (let i = 1, l = shell.length; i < l; i++) {\n            const p = shell[i];\n            let dx = 0, dy = 0;\n            if (sx * (nw.x - p.x) > 0) {\n                dx = circum.x * sx;\n            }\n            if (sy * (nw.y - p.y) < 0) {\n                dy = circum.y * sy;\n            }\n            shell[i]._add(dx, dy);\n        }\n        return shell;\n    }\n\n    //update cached variables if geometry is updated.\n    _updateCache() {\n        this._clearCache();\n        const projection = this._getProjection();\n        if (this._pnw && projection) {\n            this._coordinates = projection.unproject(this._pnw);\n        }\n    }\n\n    _clearProjection() {\n        this._pnw = null;\n        super._clearProjection();\n    }\n\n    _computeCenter(measurer) {\n        return measurer.locate(this._coordinates, this._width / 2, -this._height / 2);\n    }\n\n    _containsPoint(point, tolerance) {\n        const map = this.getMap();\n        if (map.isTransforming()) {\n            return super._containsPoint(point, tolerance);\n        }\n        const t = isNil(tolerance) ? this._hitTestTolerance() : tolerance,\n            r = map._getResolution() * t;\n        const extent = this._getPrjExtent().expand(r);\n        const p = map._containerPointToPrj(point);\n        return extent.contains(p);\n    }\n\n    _computePrjExtent(projection) {\n        const se = this._getSouthEast(projection);\n        if (!se) {\n            return null;\n        }\n        const prjs = projection.projectCoords([\n            new Coordinate(this._coordinates.x, se.y),\n            new Coordinate(se.x, this._coordinates.y)\n        ]);\n        return new Extent(prjs[0], prjs[1]);\n    }\n\n    _computeExtent(measurer) {\n        const se = this._getSouthEast(measurer);\n        if (!se) {\n            return null;\n        }\n        return new Extent(this._coordinates, se, this._getProjection());\n    }\n\n    _getSouthEast(measurer) {\n        if (!measurer || !this._coordinates || isNil(this._width) || isNil(this._height)) {\n            return null;\n        }\n        const width = this.getWidth(),\n            height = this.getHeight();\n        let w = width, h = -height;\n        if (measurer.fullExtent) {\n            const fullExtent = measurer.fullExtent,\n                sx = fullExtent.right > fullExtent.left ? 1 : -1,\n                sy = fullExtent.top > fullExtent.bottom ? 1 : -1;\n            w *= sx;\n            h *= sy;\n        }\n        const se = measurer.locate(this._coordinates, w, h);\n        return se;\n    }\n\n    _computeGeodesicLength() {\n        if (isNil(this._width) || isNil(this._height)) {\n            return 0;\n        }\n        return 2 * (this._width + this._height);\n    }\n\n    _computeGeodesicArea() {\n        if (isNil(this._width) || isNil(this._height)) {\n            return 0;\n        }\n        return this._width * this._height;\n    }\n\n    _exportGeoJSONGeometry() {\n        const coordinates = Coordinate.toNumberArrays([this.getShell()]);\n        return {\n            'type': 'Polygon',\n            'coordinates': coordinates\n        };\n    }\n\n    _toJSON(options) {\n        const opts = extend({}, options);\n        const nw = this.getCoordinates();\n        opts.geometry = false;\n        const feature = this.toGeoJSON(opts);\n        feature['geometry'] = {\n            'type': 'Polygon'\n        };\n        return {\n            'feature': feature,\n            'subType': 'Rectangle',\n            'coordinates': [nw.x, nw.y],\n            'width': this.getWidth(),\n            'height': this.getHeight()\n        };\n    }\n\n}\n\nRectangle.registerJSONType('Rectangle');\n\nexport default Rectangle;\n","import { extend, isNil } from '../core/util';\nimport Circle from './Circle';\n\n/**\n * @property {Object} options -\n * @property {Number} [options.numberOfShellPoints=60]   - number of shell points when converting the sector to a polygon.\n * @memberOf Sector\n * @instance\n */\nconst options = {\n    'numberOfShellPoints': 60\n};\n\n/**\n * @classdesc\n * Represents a sector Geometry.\n * @category geometry\n * @extends Circle\n * @example\n * var sector = new Sector([100, 0], 1000, 30, 120, {\n *     id : 'sector0'\n * });\n */\nclass Sector extends Circle {\n\n    static fromJSON(json) {\n        const feature = json['feature'];\n        const sector = new Sector(json['coordinates'], json['radius'], json['startAngle'], json['endAngle'], json['options']);\n        sector.setProperties(feature['properties']);\n        return sector;\n    }\n\n    /**\n     * @param {Coordinate} center - center of the sector\n     * @param {Number} radius           - radius of the sector, in meter\n     * @param {Number} startAngle       - start angle of the sector, in degree\n     * @param {Number} endAngle         - end angle of the sector, in degree\n     * @param {Object} [options=null]   - construct options defined in [Sector]{@link Sector#options}\n     */\n    constructor(coordinates, radius, startAngle, endAngle, opts) {\n        super(coordinates, radius, opts);\n        this.startAngle = startAngle;\n        this.endAngle = endAngle;\n    }\n\n    /**\n     * Get the sector's start angle\n     * @return {Number}\n     */\n    getStartAngle() {\n        return this.startAngle;\n    }\n\n    /**\n     * Set a new start angle to the sector\n     * @param {Number} startAngle\n     * @return {Sector} this\n     * @fires Sector#shapechange\n     */\n    setStartAngle(startAngle) {\n        this.startAngle = startAngle;\n        this.onShapeChanged();\n        return this;\n    }\n\n    /**\n     * Get the sector's end angle\n     * @return {Number}\n     */\n    getEndAngle() {\n        return this.endAngle;\n    }\n\n    /**\n     * Set a new end angle to the sector\n     * @param {Number} endAngle\n     * @return {Sector} this\n     * @fires Sector#shapechange\n     */\n    setEndAngle(endAngle) {\n        this.endAngle = endAngle;\n        this.onShapeChanged();\n        return this;\n    }\n\n    /**\n     * Gets the shell of the sector as a polygon, number of the shell points is decided by [options.numberOfShellPoints]{@link Sector#options}\n     * @return {Coordinate[]} - shell coordinates\n     */\n    getShell() {\n        const measurer = this._getMeasurer(),\n            center = this.getCoordinates(),\n            numberOfPoints = this.options['numberOfShellPoints'] - 2,\n            radius = this.getRadius(),\n            shell = [center.copy()],\n            startAngle = this.getStartAngle(),\n            angle = this.getEndAngle() - startAngle;\n        let rad, dx, dy;\n        for (let i = 0; i < numberOfPoints; i++) {\n            rad = (angle * i / (numberOfPoints - 1) + startAngle) * Math.PI / 180;\n            dx = radius * Math.cos(rad);\n            dy = radius * Math.sin(rad);\n            const vertex = measurer.locate(center, dx, dy);\n            shell.push(vertex);\n        }\n        shell.push(center.copy());\n        return shell;\n    }\n\n    _containsPoint(point, tolerance) {\n        const map = this.getMap();\n        if (map.isTransforming()) {\n            return super._containsPoint(point, tolerance);\n        }\n        const center = map._pointToContainerPoint(this._getCenter2DPoint()),\n            t = isNil(tolerance) ? this._hitTestTolerance() : tolerance,\n            size = this.getSize(),\n            pc = center,\n            pp = point,\n            x = pp.x - pc.x,\n            y = pc.y - pp.y,\n            atan2 = Math.atan2(y, x),\n            // [0.0, 360.0)\n            angle = atan2 < 0 ? (atan2 + 2 * Math.PI) * 360 / (2 * Math.PI) :\n                atan2 * 360 / (2 * Math.PI);\n        const sAngle = this.startAngle % 360,\n            eAngle = this.endAngle % 360;\n        let between = false;\n        if (sAngle > eAngle) {\n            between = !(angle > eAngle && angle < sAngle);\n        } else {\n            between = (angle >= sAngle && angle <= eAngle);\n        }\n        return pp.distanceTo(pc) <= (size.width / 2 + t) && between;\n    }\n\n    _computeGeodesicLength() {\n        if (isNil(this._radius)) {\n            return 0;\n        }\n        return Math.PI * 2 * this._radius * Math.abs(this.startAngle - this.endAngle) / 360 + 2 * this._radius;\n    }\n\n    _computeGeodesicArea() {\n        if (isNil(this._radius)) {\n            return 0;\n        }\n        return Math.PI * Math.pow(this._radius, 2) * Math.abs(this.startAngle - this.endAngle) / 360;\n    }\n\n    _toJSON(options) {\n        const opts = extend({}, options);\n        const center = this.getCenter();\n        opts.geometry = false;\n        const feature = this.toGeoJSON(opts);\n        feature['geometry'] = {\n            'type': 'Polygon'\n        };\n        return {\n            'feature': feature,\n            'subType': 'Sector',\n            'coordinates': [center.x, center.y],\n            'radius': this.getRadius(),\n            'startAngle': this.getStartAngle(),\n            'endAngle': this.getEndAngle()\n        };\n    }\n\n}\n\nSector.mergeOptions(options);\n\nSector.registerJSONType('Sector');\n\nexport default Sector;\n","import LineString from './LineString';\nimport Canvas2d from '../core/Canvas';\n\nconst options = {\n    'enableSimplify' : false,\n    'enableClip' : false\n};\n\n/**\n * Curve style LineString, an abstract parent class for all the curves.\n * @category geometry\n * @abstract\n * @extends LineString\n * @param {Coordinate[]|Number[][]} coordinates - coordinates of the line string\n * @param {Object} [options=null] - construct options defined in [LineString]{@link LineString#options}\n * @property {Boolean} [options.enableSimplify=false] - whether to simplify path before rendering\n * @property {Boolean} [options.enableClip=false] - whether to clip curve with map's current extent\n */\nclass Curve extends LineString {\n\n    _arc(ctx, points, lineOpacity) {\n        const degree = this.options['arcDegree'] * Math.PI / 180;\n        for (let i = 1, l = points.length; i < l; i++) {\n            const c = Canvas2d._arcBetween(ctx, points[i - 1], points[i], degree);\n            //add control points to caculate normal of arrow\n            const ctrlPoint = [(points[i - 1].x + points[i].x) - c[0], (points[i - 1].y + points[i].y) - c[1]];\n            points[i - 1].nextCtrlPoint = ctrlPoint;\n            points[i].prevCtrlPoint = ctrlPoint;\n            Canvas2d._stroke(ctx, lineOpacity);\n        }\n    }\n\n    _quadraticCurve(ctx, points) {\n        if (points.length <= 2) {\n            Canvas2d._path(ctx, points);\n            return;\n        }\n        let i, l;\n        for (i = 2, l = points.length; i < l; i += 2) {\n            ctx.quadraticCurveTo(points[i - 1].x, points[i - 1].y, points[i].x, points[i].y);\n        }\n        i -= 1;\n        if (i < l) {\n            for (;i < l; i++) {\n                ctx.lineTo(points[i].x, points[i].y);\n            }\n        }\n    }\n\n    _bezierCurve(ctx, points) {\n        if (points.length <= 3) {\n            Canvas2d._path(ctx, points);\n            return;\n        }\n        let i, l;\n        for (i = 1, l = points.length; i + 2 < l; i += 3) {\n            ctx.bezierCurveTo(points[i].x, points[i].y, points[i + 1].x, points[i + 1].y, points[i + 2].x, points[i + 2].y);\n        }\n        if (i < l) {\n            for (; i < l; i++) {\n                ctx.lineTo(points[i].x, points[i].y);\n            }\n        }\n    }\n\n    _getCurveArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance, step) {\n        const l = segments.length;\n        let i;\n        for (i = step; i < l; i += step) {\n            arrows.push(this._getArrowShape(segments[i - 1], segments[i], lineWidth, arrowStyle, tolerance));\n        }\n        i -= step;\n        if (i < l - 1) {\n            for (i += 1; i < l; i++) {\n                arrows.push(this._getArrowShape(segments[i - 1], segments[i], lineWidth, arrowStyle, tolerance));\n            }\n        }\n    }\n}\n\nCurve.mergeOptions(options);\n\nexport default Curve;\n","import Curve from './Curve';\nimport Canvas from '../core/Canvas';\n\n/**\n * @property {Object} options\n * @property {Number} [options.arcDegree=90]           - circle arc's degree.\n * @memberOf ArcCurve\n * @instance\n */\nconst options = {\n    'arcDegree': 90\n};\n\n/**\n * @classdesc\n * Circle Arc Curve\n * @category geometry\n * @extends Curve\n * @param {Coordinate[]|Number[][]} coordinates - coordinates of the curve\n * @param {Object} [options=null]   - construct options defined in [ArcCurve]{@link ArcCurve#options}\n * @example\n * var curve = new ArcCurve(\n *     [\n *         [121.47083767181408,31.214448123476995],\n *         [121.4751292062378,31.215475523000404],\n *         [121.47869117980943,31.211916269810335]\n *     ],\n *     {\n *         arcDegree : 120,\n *         symbol : {\n *             'lineWidth' : 5\n *         }\n *     }\n * ).addTo(layer);\n */\nclass ArcCurve extends Curve {\n\n\n\n    _toJSON(options) {\n        return {\n            'feature': this.toGeoJSON(options),\n            'subType': 'ArcCurve'\n        };\n    }\n\n    // paint method on canvas\n    _paintOn(ctx, points, lineOpacity) {\n        ctx.beginPath();\n        this._arc(ctx, points, lineOpacity);\n        Canvas._stroke(ctx, lineOpacity);\n        this._paintArrow(ctx, points, lineOpacity);\n    }\n\n    static fromJSON(json) {\n        const feature = json['feature'];\n        const arc = new ArcCurve(feature['geometry']['coordinates'], json['options']);\n        arc.setProperties(feature['properties']);\n        return arc;\n    }\n}\n\nArcCurve.registerJSONType('ArcCurve');\n\nArcCurve.mergeOptions(options);\n\nexport default ArcCurve;\n","import Curve from './Curve';\nimport Canvas from '../core/Canvas';\n\n/**\n * Cubic Bezier Curve\n * @category geometry\n * @extends Curve\n * @param {Coordinate[]|Number[][]} coordinates - coordinates of the curve\n * @param {Object} [options=null]   - construct options defined in [CubicBezierCurve]{@link CubicBezierCurve#options}\n * @example\n * var curve = new CubicBezierCurve(\n *     [\n *         [121.47083767181408,31.214448123476995],\n *         [121.4751292062378,31.215475523000404],\n *         [121.47869117980943,31.211916269810335]\n *     ],\n *     {\n *         symbol : {\n *             'lineWidth' : 5\n *         }\n *     }\n * ).addTo(layer);\n */\nclass CubicBezierCurve extends Curve {\n\n    static fromJSON(json) {\n        const feature = json['feature'];\n        const curve = new CubicBezierCurve(feature['geometry']['coordinates'], json['options']);\n        curve.setProperties(feature['properties']);\n        return curve;\n    }\n\n    _toJSON(options) {\n        return {\n            'feature': this.toGeoJSON(options),\n            'subType': 'CubicBezierCurve'\n        };\n    }\n\n    // paint method on canvas\n    _paintOn(ctx, points, lineOpacity) {\n        ctx.beginPath();\n        ctx.moveTo(points[0].x, points[0].y);\n        this._bezierCurve(ctx, points);\n        Canvas._stroke(ctx, lineOpacity);\n        this._paintArrow(ctx, points, lineOpacity);\n    }\n\n    _getArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance) {\n        return this._getCurveArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance, 3);\n    }\n}\n\nCubicBezierCurve.registerJSONType('CubicBezierCurve');\n\nexport default CubicBezierCurve;\n","import Curve from './Curve';\nimport Canvas from '../core/Canvas';\n\n/**\n * @classdesc\n * Quadratic Bezier Curve\n * @category geometry\n * @extends Curve\n * @param {Coordinate[]|Number[][]} coordinates - coordinates of the curve\n * @example\n * var curve = new QuadBezierCurve(\n *     [\n *         [121.47083767181408,31.214448123476995],\n *         [121.4751292062378,31.215475523000404],\n *         [121.47869117980943,31.211916269810335]\n *     ],\n *     {\n *         symbol : {\n *             'lineWidth' : 5\n *         }\n *     }\n * ).addTo(layer);\n */\nclass QuadBezierCurve extends Curve {\n\n    static fromJSON(json) {\n        const feature = json['feature'];\n        const curve = new QuadBezierCurve(feature['geometry']['coordinates'], json['options']);\n        curve.setProperties(feature['properties']);\n        return curve;\n    }\n\n    _toJSON(options) {\n        return {\n            'feature': this.toGeoJSON(options),\n            'subType': 'QuadBezierCurve'\n        };\n    }\n\n    // paint method on canvas\n    _paintOn(ctx, points, lineOpacity) {\n        ctx.beginPath();\n        ctx.moveTo(points[0].x, points[0].y);\n        this._quadraticCurve(ctx, points, lineOpacity);\n        Canvas._stroke(ctx, lineOpacity);\n        this._paintArrow(ctx, points, lineOpacity);\n    }\n\n    _getArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance) {\n        return this._getCurveArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance, 2);\n    }\n}\n\nQuadBezierCurve.registerJSONType('QuadBezierCurve');\n\nexport default QuadBezierCurve;\n","import { extend, hasOwn } from '../core/util';\nimport { splitTextToRow, escapeSpecialChars } from '../core/util/strings';\nimport Marker from './Marker';\n\nconst defaultSymbol = {\n    'textFaceName': 'monospace',\n    'textSize': 12,\n    'textLineSpacing': 8,\n    'textWrapCharacter' : '\\n',\n    'textHorizontalAlignment': 'middle', //left middle right\n    'textVerticalAlignment': 'middle' //top middle bottom\n};\n\nconst defaultBoxSymbol = {\n    'markerType': 'square',\n    'markerLineColor': '#000',\n    'markerLineWidth': 2,\n    'markerLineOpacity': 1,\n    'markerFill': '#fff',\n    'markerOpacity': 1\n};\n\n/**\n * @classdesc\n * Base class for  the Text marker classes, a marker which has text and background box. <br>\n * It is abstract and not intended to be instantiated.\n * @category geometry\n * @abstract\n * @extends Marker\n */\nclass TextMarker extends Marker {\n\n    /**\n     * Get text content of the label\n     * @returns {String}\n     */\n    getContent() {\n        return this._content;\n    }\n\n    /**\n     * Set a new text content to the label\n     * @return {Label} this\n     * @fires Label#contentchange\n     */\n    setContent(content) {\n        const old = this._content;\n        this._content = escapeSpecialChars(content);\n        this._refresh();\n        /**\n         * an event when changing label's text content\n         * @event Label#contentchange\n         * @type {Object}\n         * @property {String} type - contentchange\n         * @property {Label} target - label fires the event\n         * @property {String} old - old content\n         * @property {String} new - new content\n         */\n        this._fireEvent('contentchange', {\n            'old': old,\n            'new': content\n        });\n        return this;\n    }\n\n    onAdd() {\n        this._refresh();\n    }\n\n    toJSON() {\n        const json = super.toJSON();\n        delete json['symbol'];\n        return json;\n    }\n\n    setSymbol(symbol) {\n        if (this._refreshing || !symbol) {\n            return super.setSymbol(symbol);\n        }\n        const s = this._parseSymbol(symbol);\n        if (this.setTextStyle) {\n            const style = this.getTextStyle() || {};\n            style.symbol = s[0];\n            this.setTextStyle(style);\n        } else if (this.setTextSymbol) {\n            this.setTextSymbol(s[0]);\n        }\n        if (this.setBoxStyle) {\n            const style = this.getBoxStyle() || {};\n            style.symbol = s[1];\n            this.setBoxStyle(style);\n        } else if (this.setBoxSymbol) {\n            this.setBoxSymbol(s[1]);\n        }\n        return this;\n    }\n\n    _parseSymbol(symbol) {\n        const t = {};\n        const b = {};\n        for (const p in symbol) {\n            if (hasOwn(symbol, p)) {\n                if (p.indexOf('text') === 0) {\n                    t[p] = symbol[p];\n                } else {\n                    b[p] = symbol[p];\n                }\n            }\n        }\n        return [t, b];\n    }\n\n    _getTextSize(symbol) {\n        return splitTextToRow(this._content, symbol)['size'];\n    }\n\n    _getInternalSymbol() {\n        return this._symbol;\n    }\n\n    _getDefaultTextSymbol() {\n        return extend({}, defaultSymbol);\n    }\n\n    _getDefaultBoxSymbol() {\n        return extend({}, defaultBoxSymbol);\n    }\n\n    _getDefaultPadding() {\n        return [12, 8];\n    }\n}\n\nexport default TextMarker;\n","import { extend, isNil } from '../core/util';\nimport { escapeSpecialChars } from '../core/util/strings';\nimport TextMarker from './TextMarker';\n\n/**\n * @property {Object} [options=null]                   - textbox's options, also including options of [Marker]{@link Marker#options}\n * @property {Boolean} [options.textStyle]             - the default text style of text\n * @property {Boolean} [options.textStyle.wrap=true]             - whether to autowrap text in the textbox\n * @property {Boolean} [options.textStyle.padding=[12, 8]]       - text padding in the box\n * @property {Boolean} [options.textStyle.verticalAlignment=middle]  - text's vertical alignment\n * @property {Boolean} [options.textStyle.horizontalAlignment=true]  - text's horizontal alignment\n * @property {Boolean} [options.boxSymbol=null]        - box symbol of textbox\n * @memberOf TextBox\n * @instance\n */\nconst options = {\n    'textStyle' :  {\n        'wrap' : true,\n        'padding' : [12, 8],\n        'verticalAlignment' : 'middle',\n        'horizontalAlignment' : 'middle'\n    },\n    'boxSymbol' : null\n};\n\n/**\n * @classdesc\n * Represents point type geometry for text boxes.<br>\n * A TextBox is used to draw a box with text inside on a particular coordinate.\n * @category geometry\n * @extends TextMarker\n * @mixes TextEditable\n * @example\n * var textbox = new maptalks.TextBox('This is a textbox',\n    [0, 0], 200, 90,\n    {\n      'draggable' : true,\n      'textStyle' : {\n        'wrap' : true,\n        'padding' : [12, 8],\n        'verticalAlignment' : 'top',\n        'horizontalAlignment' : 'right',\n        'symbol' : {\n          'textFaceName' : 'monospace',\n          'textFill' : '#34495e',\n          'textHaloFill' : '#fff',\n          'textHaloRadius' : 4,\n          'textSize' : 18,\n          'textWeight' : 'bold'\n        }\n      },\n      'boxSymbol': {\n        // box's symbol\n        'markerType' : 'square',\n        'markerFill' : 'rgb(135,196,240)',\n        'markerFillOpacity' : 0.9,\n        'markerLineColor' : '#34495e',\n        'markerLineWidth' : 1\n      }\n    });\n */\nclass TextBox extends TextMarker {\n    /**\n     * @param {String} content                 - TextBox's text content\n     * @param {Coordinate} coordinates         - coordinates\n     * @param {Number} width                   - width in pixel\n     * @param {Number} height                  - height in pixel\n     * @param {Object} [options=null]          - construct options defined in [TextBox]{@link TextBox#options}\n     */\n    constructor(content, coordinates, width, height, options = {}) {\n        super(coordinates, options);\n        this._content = escapeSpecialChars(content);\n        this._width = isNil(width) ? 100 : width;\n        this._height = isNil(height) ? 40 : height;\n        if (options.boxSymbol) {\n            this.setBoxSymbol(options.boxSymbol);\n        }\n        if (options.textStyle) {\n            this.setTextStyle(options.textStyle);\n        }\n        this._refresh();\n    }\n\n    /**\n     * Get textbox's width\n     * @return {Number}\n     */\n    getWidth() {\n        return this._width;\n    }\n\n    /**\n     * Set new width to textbox\n     * @param {Number} width\n     * returns {TextBox} this\n     */\n    setWidth(width) {\n        this._width = width;\n        this._refresh();\n        return this;\n    }\n\n    /**\n     * Get textbox's height\n     * @return {Number}\n     */\n    getHeight() {\n        return this._height;\n    }\n\n    /**\n     * Set new height to textbox\n     * @param {Number} height\n     * returns {TextBox} this\n     */\n    setHeight(height) {\n        this._height = height;\n        this._refresh();\n        return this;\n    }\n\n    /**\n     * Get textbox's boxSymbol\n     * @return {Object} boxsymbol\n     */\n    getBoxSymbol() {\n        return extend({}, this.options.boxSymbol);\n    }\n\n    /**\n     * Set a new box symbol to textbox\n     * @param {Object} symbol\n     * returns {TextBox} this\n     */\n    setBoxSymbol(symbol) {\n        this.options.boxSymbol = symbol ? extend({}, symbol) : symbol;\n        if (this.getSymbol()) {\n            this._refresh();\n        }\n        return this;\n    }\n\n    /**\n     * Get textbox's text style\n     * @return {Object}\n     */\n    getTextStyle() {\n        if (!this.options.textStyle) {\n            return null;\n        }\n        return extend({}, this.options.textStyle);\n    }\n\n    /**\n     * Set a new text style to the textbox\n     * @param {Object} style new text style\n     * returns {TextBox} this\n     */\n    setTextStyle(style) {\n        this.options.textStyle = style ? extend({}, style) : style;\n        if (this.getSymbol()) {\n            this._refresh();\n        }\n        return this;\n    }\n\n    static fromJSON(json) {\n        const feature = json['feature'];\n        const textBox = new TextBox(json['content'], feature['geometry']['coordinates'], json['width'], json['height'], json['options']);\n        textBox.setProperties(feature['properties']);\n        textBox.setId(feature['id']);\n        if (json['symbol']) {\n            textBox.setSymbol(json['symbol']);\n        }\n        return textBox;\n    }\n\n    _toJSON(options) {\n        return {\n            'feature': this.toGeoJSON(options),\n            'width' : this.getWidth(),\n            'height' : this.getHeight(),\n            'subType': 'TextBox',\n            'content': this._content\n        };\n    }\n\n    _refresh() {\n        const textStyle = this.getTextStyle() || {},\n            padding = textStyle['padding'] || [12, 8],\n            maxWidth = this._width - 2 * padding[0],\n            maxHeight = this._height - 2 * padding[1];\n        const symbol = extend({},\n            textStyle.symbol || this._getDefaultTextSymbol(),\n            this.options.boxSymbol || this._getDefaultBoxSymbol(),\n            {\n                'textName' : this._content,\n                'markerWidth' : this._width,\n                'markerHeight' : this._height,\n                'textHorizontalAlignment' : 'middle',\n                'textVerticalAlignment' : 'middle',\n                'textMaxWidth' : maxWidth,\n                'textMaxHeight' : maxHeight\n            });\n\n        if (textStyle['wrap'] && !symbol['textWrapWidth']) {\n            symbol['textWrapWidth'] = maxWidth;\n        }\n\n        const hAlign = textStyle['horizontalAlignment'];\n        symbol['textDx'] = symbol['markerDx'] || 0;\n        const offsetX = symbol['markerWidth'] / 2 - padding[0];\n        if (hAlign === 'left') {\n            symbol['textHorizontalAlignment'] = 'right';\n            symbol['textDx'] = symbol['textDx'] - offsetX;\n        } else if (hAlign === 'right') {\n            symbol['textHorizontalAlignment'] = 'left';\n            symbol['textDx'] = symbol['textDx'] + offsetX;\n        }\n\n        const vAlign = textStyle['verticalAlignment'];\n        symbol['textDy'] = symbol['markerDy'] || 0;\n        const offsetY = symbol['markerHeight'] / 2 - padding[1];\n        if (vAlign === 'top') {\n            symbol['textVerticalAlignment'] = 'bottom';\n            symbol['textDy'] -= offsetY;\n        } else if (vAlign === 'bottom') {\n            symbol['textVerticalAlignment'] = 'top';\n            symbol['textDy'] += offsetY;\n        }\n        this._refreshing = true;\n        this.updateSymbol(symbol);\n        delete this._refreshing;\n    }\n}\n\nTextBox.mergeOptions(options);\n\nTextBox.registerJSONType('TextBox');\n\nexport default TextBox;\n","import { extend } from '../core/util';\nimport { getAlignPoint, escapeSpecialChars } from '../core/util/strings';\nimport Size from '../geo/Size';\nimport TextMarker from './TextMarker';\n\n/**\n * @property {Object} [options=null]                   - textbox's options, also including options of [Marker]{@link Marker#options}\n * @property {Boolean} [options.boxStyle=null]             - the default box style of text\n * @property {Boolean} [options.boxStyle.padding=[12, 8]]           - text padding in the box\n * @property {Boolean} [options.boxStyle.verticalAlignment=middle]  - text's vertical alignment\n * @property {Boolean} [options.boxStyle.horizontalAlignment=true]  - text's horizontal alignment\n * @property {Number} [options.boxStyle.minWidth=0]                 - label box's minWidth\n * @property {Number} [options.boxStyle.minHeight=0]                - label box's minHeight\n * @property {Boolean} [options.textSymbol=null]        - text symbol of label\n * @memberOf Label\n * @instance\n */\nconst options = {\n    'boxStyle' : null, /*{\n        'padding' : [12, 8],\n        'verticalAlignment' : 'middle',\n        'horizontalAlignment' : 'middle',\n        'minWidth' : 0,\n        'minHeight' : 0,\n        'symbol' : null\n    }*/\n    textSymbol : null\n};\n\n/**\n * @classdesc\n * Represents point type geometry for text labels.<br>\n * A label is used to draw text (with a box background if specified) on a particular coordinate.\n * @category geometry\n * @extends TextMarker\n * @mixes TextEditable\n * @example\n * var label = new maptalks.Label('label with a box',\n    [0, 0],\n    {\n      'draggable' : true,\n      'boxStyle' : {\n        'padding' : [12, 8],\n        'verticalAlignment' : 'top',\n        'horizontalAlignment' : 'right',\n        'minWidth' : 300,\n        'minHeight' : 200,\n        'symbol' : {\n          'markerType' : 'square',\n          'markerFill' : 'rgb(135,196,240)',\n          'markerFillOpacity' : 0.9,\n          'markerLineColor' : '#34495e',\n          'markerLineWidth' : 1\n        }\n      },\n      'textSymbol': {\n        'textFaceName' : 'monospace',\n        'textFill' : '#34495e',\n        'textHaloFill' : '#fff',\n        'textHaloRadius' : 4,\n        'textSize' : 18,\n        'textWeight' : 'bold',\n        'textVerticalAlignment' : 'top'\n      }\n    });\n */\nclass Label extends TextMarker {\n\n    /**\n     * @param {String} content                 - Label's text content\n     * @param {Coordinate} coordinates         - coordinates\n     * @param {Object} [options=null]          - construct options defined in [Label]{@link Label#options}\n     */\n    constructor(content, coordinates, options = {}) {\n        super(coordinates, options);\n        if (options.textSymbol) {\n            this.setTextSymbol(options.textSymbol);\n        }\n        if (options.boxStyle) {\n            this.setBoxStyle(options.boxStyle);\n        }\n        this._content = escapeSpecialChars(content);\n        this._refresh();\n    }\n\n    /**\n     * Get label's box style\n     * @return {Object}\n     */\n    getBoxStyle() {\n        if (!this.options.boxStyle) {\n            return null;\n        }\n        return extend({}, this.options.boxStyle);\n    }\n\n    /**\n     * Set a new box style to the label\n     * @param {Object}\n     * @returns {Label} this\n     */\n    setBoxStyle(style) {\n        this.options.boxStyle = style ? extend({}, style) : style;\n        this._refresh();\n        return this;\n    }\n\n    /**\n     * Get label's text symbol\n     * @return {Object}\n     */\n    getTextSymbol() {\n        return extend({}, this._getDefaultTextSymbol(), this.options.textSymbol);\n    }\n\n    /**\n     * Set a new text symbol to the label\n     * @param {Object} symbol\n     * @returns {Label} this\n     */\n    setTextSymbol(symbol) {\n        this.options.textSymbol = symbol ? extend({}, symbol) : symbol;\n        this._refresh();\n        return this;\n    }\n\n    static fromJSON(json) {\n        const feature = json['feature'];\n        const label = new Label(json['content'], feature['geometry']['coordinates'], json['options']);\n        label.setProperties(feature['properties']);\n        label.setId(feature['id']);\n        if (json['symbol']) {\n            label.setSymbol(json['symbol']);\n        }\n        return label;\n    }\n\n    _canEdit() {\n        return false;\n    }\n\n    _toJSON(options) {\n        return {\n            'feature': this.toGeoJSON(options),\n            'subType': 'Label',\n            'content': this._content\n        };\n    }\n\n    _refresh() {\n        const symbol = extend({},\n            this.getTextSymbol(),\n            {\n                'textName' : this._content\n            });\n\n        const boxStyle = this.getBoxStyle();\n        if (boxStyle) {\n            extend(symbol, boxStyle.symbol);\n            const sizes = this._getBoxSize(symbol),\n                textSize = sizes[1],\n                padding = boxStyle['padding'] || this._getDefaultPadding();\n            const boxSize = sizes[0];\n            //if no boxSize then use text's size in default\n            symbol['markerWidth'] = boxSize['width'];\n            symbol['markerHeight'] = boxSize['height'];\n\n            const dx = symbol['textDx'] || 0,\n                dy = symbol['textDy'] || 0,\n                textAlignPoint = getAlignPoint(textSize, symbol['textHorizontalAlignment'], symbol['textVerticalAlignment'])\n                    ._add(dx, dy);\n\n            const hAlign = boxStyle['horizontalAlignment'] || 'middle';\n            symbol['markerDx'] = textAlignPoint.x;\n            if (hAlign === 'left') {\n                symbol['markerDx'] += symbol['markerWidth'] / 2 - padding[0];\n            } else if (hAlign === 'right') {\n                symbol['markerDx'] -= symbol['markerWidth'] / 2 - textSize['width'] - padding[0];\n            } else {\n                symbol['markerDx'] += textSize['width'] / 2;\n            }\n\n            const vAlign = boxStyle['verticalAlignment'] || 'middle';\n            symbol['markerDy'] = textAlignPoint.y;\n            if (vAlign === 'top') {\n                symbol['markerDy'] += symbol['markerHeight'] / 2 - padding[1];\n            } else if (vAlign === 'bottom') {\n                symbol['markerDy'] -= symbol['markerHeight'] / 2 - textSize['height'] - padding[1];\n            } else {\n                symbol['markerDy'] += textSize['height'] / 2;\n            }\n        }\n        this._refreshing = true;\n        this.updateSymbol(symbol);\n        delete this._refreshing;\n    }\n\n    _getBoxSize(symbol) {\n        if (!symbol['markerType']) {\n            symbol['markerType'] = 'square';\n        }\n        const boxStyle = this.getBoxStyle();\n        const size = this._getTextSize(symbol);\n        let width, height;\n        const padding = boxStyle['padding'] || this._getDefaultPadding();\n        width = size['width'] + padding[0] * 2;\n        height = size['height'] + padding[1] * 2;\n        if (boxStyle['minWidth']) {\n            if (!width || width < boxStyle['minWidth']) {\n                width = boxStyle['minWidth'];\n            }\n        }\n        if (boxStyle['minHeight']) {\n            if (!height || height < boxStyle['minHeight']) {\n                height = boxStyle['minHeight'];\n            }\n        }\n        return [new Size(width, height), size];\n    }\n\n}\n\nLabel.mergeOptions(options);\n\nLabel.registerJSONType('Label');\n\nexport default Label;\n","import { isNil, isArrayHasData, removeFromArray } from '../core/util';\nimport LineString from './LineString';\nimport Geometry from './Geometry';\nimport ArcCurve from './ArcCurve';\n\n/**\n * Mixin of connector line methods.\n * @mixin Connectable\n * @private\n */\nconst Connectable = Base =>\n    class extends Base {\n\n        static _hasConnectors(geometry) {\n            return (!isNil(geometry.__connectors) && geometry.__connectors.length > 0);\n        }\n\n        static _getConnectors(geometry) {\n            return geometry.__connectors;\n        }\n\n        /**\n         * Gets the source of the connector line.\n         * @return {Geometry|control.Control|UIComponent}\n         * @function Connectable.getConnectSource\n         */\n        getConnectSource() {\n            return this._connSource;\n        }\n\n        /**\n         * Sets the source to the connector line.\n         * @param {Geometry|control.Control|UIComponent} src\n         * @return {ConnectorLine} this\n         * @function Connectable.setConnectSource\n         */\n        setConnectSource(src) {\n            const target = this._connTarget;\n            this.onRemove();\n            this._connSource = src;\n            this._connTarget = target;\n            this.onAdd();\n            return this;\n        }\n\n        /**\n         * Gets the target of the connector line.\n         * @return {Geometry|control.Control|UIComponent}\n         * @function Connectable.getConnectTarget\n         */\n        getConnectTarget() {\n            return this._connTarget;\n        }\n\n        /**\n         * Sets the target to the connector line.\n         * @param {Geometry|control.Control|UIComponent} target\n         * @return {ConnectorLine} this\n         * @function Connectable.setConnectTarget\n         */\n        setConnectTarget(target) {\n            const src = this._connSource;\n            this.onRemove();\n            this._connSource = src;\n            this._connTarget = target;\n            this._updateCoordinates();\n            this._registerEvents();\n            return this;\n        }\n\n        _updateCoordinates() {\n            let map = this.getMap();\n            if (!map && this._connSource) {\n                map = this._connSource.getMap();\n            }\n            if (!map && this._connTarget) {\n                map = this._connTarget.getMap();\n            }\n            if (!map) {\n                return;\n            }\n            if (!this._connSource || !this._connTarget) {\n                return;\n            }\n            const srcPoints = this._connSource._getConnectPoints();\n            const targetPoints = this._connTarget._getConnectPoints();\n            let minDist = 0;\n            const oldCoordinates = this.getCoordinates();\n            let c1, c2;\n            for (let i = 0, len = srcPoints.length; i < len; i++) {\n                const p1 = srcPoints[i];\n                for (let j = 0, length = targetPoints.length; j < length; j++) {\n                    const p2 = targetPoints[j];\n                    const dist = map.computeLength(p1, p2);\n                    if (i === 0 && j === 0) {\n                        c1 = p1;\n                        c2 = p2;\n                        minDist = dist;\n                    } else if (dist < minDist) {\n                        c1 = p1;\n                        c2 = p2;\n                    }\n                }\n            }\n            if (!isArrayHasData(oldCoordinates) || (!oldCoordinates[0].equals(c1) || !oldCoordinates[1].equals(c2))) {\n                this.setCoordinates([c1, c2]);\n            }\n        }\n\n        onAdd() {\n            this._registerEvents();\n            this._updateCoordinates();\n        }\n\n        onRemove() {\n            if (this._connSource) {\n                if (this._connSource.__connectors) {\n                    removeFromArray(this, this._connSource.__connectors);\n                }\n                this._connSource.off('dragging positionchange', this._updateCoordinates, this)\n                    .off('remove', this.onRemove, this);\n                this._connSource.off('dragstart mousedown mouseover', this._showConnect, this);\n                this._connSource.off('dragend mouseup mouseout', this.hide, this);\n                this._connSource.off('show', this._showConnect, this).off('hide', this.hide, this);\n                delete this._connSource;\n            }\n            if (this._connTarget) {\n                removeFromArray(this, this._connTarget.__connectors);\n                this._connTarget.off('dragging positionchange', this._updateCoordinates, this)\n                    .off('remove', this.onRemove, this);\n                this._connTarget.off('show', this._showConnect, this).off('hide', this.hide, this);\n                delete this._connTarget;\n            }\n\n            //not a geometry\n            if (!(this._connSource instanceof Geometry) || !(this._connTarget instanceof Geometry)) {\n                const map = this.getMap();\n                if (map) {\n                    map.off('movestart moving moveend zoomstart zooming zoomend rotate pitch fovchange spatialreferencechange', this._updateCoordinates, this);\n                }\n            }\n        }\n\n        _showConnect() {\n            if (!this._connSource || !this._connTarget) {\n                return;\n            }\n            if (this._connSource.isVisible() && this._connTarget.isVisible()) {\n                this._updateCoordinates();\n                this.show();\n            }\n        }\n\n        _registerEvents() {\n            if (!this._connSource || !this._connTarget) {\n                return;\n            }\n            if (!this._connSource.__connectors) {\n                this._connSource.__connectors = [];\n            }\n            if (!this._connTarget.__connectors) {\n                this._connTarget.__connectors = [];\n            }\n            this._connSource.__connectors.push(this);\n            this._connTarget.__connectors.push(this);\n            this._connSource.on('dragging positionchange', this._updateCoordinates, this)\n                .on('remove', this.remove, this);\n            this._connTarget.on('dragging positionchange', this._updateCoordinates, this)\n                .on('remove', this.remove, this);\n            this._connSource.on('show', this._showConnect, this).on('hide', this.hide, this);\n            this._connTarget.on('show', this._showConnect, this).on('hide', this.hide, this);\n            const trigger = this.options['showOn'];\n            this.hide();\n            if (trigger === 'moving') {\n                this._connSource.on('dragstart', this._showConnect, this).on('dragend', this.hide, this);\n                this._connTarget.on('dragstart', this._showConnect, this).on('dragend', this.hide, this);\n            } else if (trigger === 'click') {\n                this._connSource.on('mousedown', this._showConnect, this).on('mouseup', this.hide, this);\n                this._connTarget.on('mousedown', this._showConnect, this).on('mouseup', this.hide, this);\n            } else if (trigger === 'mouseover') {\n                this._connSource.on('mouseover', this._showConnect, this).on('mouseout', this.hide, this);\n                this._connTarget.on('mouseover', this._showConnect, this).on('mouseout', this.hide, this);\n            } else {\n                this._showConnect();\n            }\n\n            //not a geometry\n            if (!(this._connSource instanceof Geometry) || !(this._connTarget instanceof Geometry)) {\n                const map = this.getMap();\n                if (map) {\n                    map.on('movestart moving moveend zoomstart zooming zoomend rotate pitch fovchange spatialreferencechange', this._updateCoordinates, this);\n                }\n            }\n        }\n    };\n\n/**\n * @property {Object} options - ConnectorLine's options\n * @property {String} [options.showOn=always]  - when to show the connector line, possible values: 'moving', 'click', 'mouseover', 'always'\n * @memberOf ConnectorLine\n * @instance\n */\n/**\n * @property {Object} options - ConnectorLine's options\n * @property {String} [options.showOn=always]  - when to show the connector line, possible values: 'moving', 'click', 'mouseover', 'always'\n * @memberOf ArcConnectorLine\n * @instance\n */\nconst options = {\n    showOn: 'always'\n};\n\n/**\n * A straight connector line geometry can connect geometries or ui components with each other. <br>\n *\n * @category geometry\n * @extends LineString\n * @example\n * var src = new Marker([0,0]).addTo(layer),\n *     dst = new Marker([1,0]).addTo(layer),\n *     line = new ConnectorLine(src, dst, {\n *         showOn : 'always', //'moving', 'click', 'mouseover', 'always'\n *         arrowStyle : 'classic',\n *         arrowPlacement : 'vertex-last', //vertex-first, vertex-last, vertex-firstlast, point\n *         symbol: {\n *           lineColor: '#34495e',\n *           lineWidth: 2\n *        }\n *     }).addTo(layer);\n * @mixes connectorLineMixin\n */\nclass ConnectorLine extends Connectable(LineString) {\n    /**\n     * @param {Geometry|control.Control|UIComponent} src     - source to connect\n     * @param {Geometry|control.Control|UIComponent} target  - target to connect\n     * @param {Object} [options=null]  - construct options defined in [ConnectorLine]{@link ConnectorLine#options}\n     */\n    constructor(src, target, options) {\n        super(null, options);\n        if (arguments.length === 1) {\n            options = src;\n            src = null;\n            target = null;\n        }\n        this._connSource = src;\n        this._connTarget = target;\n    }\n}\n\nConnectorLine.mergeOptions(options);\n\nConnectorLine.registerJSONType('ConnectorLine');\n\n/**\n * An arc curve connector line geometry can connect geometries or ui components with each other. <br>\n *\n * @category geometry\n * @extends ArcCurve\n * @example\n * var src = new Marker([0,0]).addTo(layer),\n *     dst = new Marker([1,0]).addTo(layer),\n *     line = new ArcConnectorLine(src, dst, {\n *         arcDegree : 120,\n *         showOn : 'always', //'moving', 'click', 'mouseover', 'always'\n *         arrowStyle : 'classic',\n *         arrowPlacement : 'vertex-last', //vertex-first, vertex-last, vertex-firstlast, point\n *         symbol: {\n *           lineColor: '#34495e',\n *           lineWidth: 2\n *        }\n *     }).addTo(layer);\n * @mixes connectorLineMixin\n */\nclass ArcConnectorLine extends Connectable(ArcCurve) {\n    /**\n     * @param {Geometry|control.Control|UIComponent} src     - source to connect\n     * @param {Geometry|control.Control|UIComponent} target  - target to connect\n     * @param {Object} [options=null]  - construct options defined in [ConnectorLine]{@link ConnectorLine#options}\n     */\n    constructor(src, target, options) {\n        super(null, options);\n        if (arguments.length === 1) {\n            options = src;\n            src = null;\n            target = null;\n        }\n        this._connSource = src;\n        this._connTarget = target;\n    }\n}\n\nArcConnectorLine.mergeOptions(options);\n\nArcConnectorLine.registerJSONType('ArcConnectorLine');\n\nexport { ConnectorLine, ArcConnectorLine };\n","import { GEOJSON_TYPES } from '../core/Constants';\nimport { isNil, UID, isObject } from '../core/util';\nimport Extent from '../geo/Extent';\nimport PointExtent from '../geo/PointExtent';\nimport { Geometry, LineString, Curve } from '../geometry';\nimport { isFunction } from '../core/util';\nimport { createFilter, getFilterFeature } from '@maptalks/feature-filter';\nimport Layer from './Layer';\nimport GeoJSON from '../geometry/GeoJSON';\n\n/**\n * @property {Boolean}  [options.drawImmediate=false] - (Only for layer rendered with [CanvasRenderer]{@link renderer.CanvasRenderer}) <br>\n *                                                    In default, for performance reason, layer will be drawn in a frame requested by RAF(RequestAnimationFrame).<br>\n *                                                    Set drawImmediate to true to draw immediately.<br>\n *                                                    This is necessary when layer's drawing is wrapped with another frame requested by RAF.\n * @memberOf OverlayLayer\n * @instance\n */\nconst options = {\n    'drawImmediate' : false\n};\n\nconst TEMP_EXTENT = new PointExtent();\n\n/**\n * @classdesc\n * Base class of all the layers that can add/remove geometries. <br>\n * It is abstract and not intended to be instantiated.\n * @category layer\n * @abstract\n * @extends Layer\n */\nclass OverlayLayer extends Layer {\n\n    constructor(id, geometries, options) {\n        if (geometries && (!(geometries instanceof Geometry) && !Array.isArray(geometries) && GEOJSON_TYPES.indexOf(geometries.type) < 0)) {\n            options = geometries;\n            geometries = null;\n        }\n        super(id, options);\n        this._maxZIndex = 0;\n        this._minZIndex = 0;\n        this._initCache();\n        if (geometries) {\n            this.addGeometry(geometries);\n        }\n    }\n\n    /**\n     * Get a geometry by its id\n     * @param  {String|Number} id   - id of the geometry\n     * @return {Geometry}\n     */\n    getGeometryById(id) {\n        if (isNil(id) || id === '') {\n            return null;\n        }\n        if (!this._geoMap[id]) {\n            return null;\n        }\n        return this._geoMap[id];\n    }\n\n    /**\n     * Get all the geometries or the ones filtered if a filter function is provided.\n     * @param {Function} [filter=undefined]  - a function to filter the geometries\n     * @param {Object} [context=undefined]   - context of the filter function, value to use as this when executing filter.\n     * @return {Geometry[]}\n     */\n    getGeometries(filter, context) {\n        if (!filter) {\n            return this._geoList.slice(0);\n        }\n        const result = [];\n        let geometry, filtered;\n        for (let i = 0, l = this._geoList.length; i < l; i++) {\n            geometry = this._geoList[i];\n            if (context) {\n                filtered = filter.call(context, geometry);\n            } else {\n                filtered = filter(geometry);\n            }\n            if (filtered) {\n                result.push(geometry);\n            }\n        }\n        return result;\n    }\n\n    /**\n     * Get the first geometry, the geometry at the bottom.\n     * @return {Geometry} first geometry\n     */\n    getFirstGeometry() {\n        if (!this._geoList.length) {\n            return null;\n        }\n        return this._geoList[0];\n    }\n\n    /**\n     * Get the last geometry, the geometry on the top\n     * @return {Geometry} last geometry\n     */\n    getLastGeometry() {\n        const len = this._geoList.length;\n        if (len === 0) {\n            return null;\n        }\n        return this._geoList[len - 1];\n    }\n\n    /**\n     * Get count of the geometries\n     * @return {Number} count\n     */\n    getCount() {\n        return this._geoList.length;\n    }\n\n    /**\n     * Get extent of all the geometries in the layer, return null if the layer is empty.\n     * @return {Extent} - extent of the layer\n     */\n    getExtent() {\n        if (this.getCount() === 0) {\n            return null;\n        }\n        const extent = new Extent(this.getProjection());\n        this.forEach(g => {\n            extent._combine(g.getExtent());\n        });\n        return extent;\n    }\n\n    /**\n     * Executes the provided callback once for each geometry present in the layer in order.\n     * @param  {Function} fn - a callback function\n     * @param  {*} [context=undefined]   - callback's context, value to use as this when executing callback.\n     * @return {OverlayLayer} this\n     */\n    forEach(fn, context) {\n        const copyOnWrite = this._geoList.slice(0);\n        for (let i = 0, l = copyOnWrite.length; i < l; i++) {\n            if (!context) {\n                fn(copyOnWrite[i], i);\n            } else {\n                fn.call(context, copyOnWrite[i], i);\n            }\n        }\n        return this;\n    }\n\n    /**\n     * Creates a GeometryCollection with all the geometries that pass the test implemented by the provided function.\n     * @param  {Function} fn      - Function to test each geometry\n     * @param  {*} [context=undefined]  - Function's context, value to use as this when executing function.\n     * @return {GeometryCollection} A GeometryCollection with all the geometries that pass the test\n     */\n    filter(fn, context) {\n        const selected = [];\n        const isFn = isFunction(fn);\n        const filter = isFn ? fn : createFilter(fn);\n\n        this.forEach(geometry => {\n            const g = isFn ? geometry : getFilterFeature(geometry);\n            if (context ? filter.call(context, g) : filter(g)) {\n                selected.push(geometry);\n            }\n        }, this);\n        return selected;\n    }\n\n    /**\n     * Whether the layer is empty.\n     * @return {Boolean}\n     */\n    isEmpty() {\n        return !this._geoList.length;\n    }\n\n    /**\n     * Adds one or more geometries to the layer\n     * @param {Geometry|Geometry[]} geometries - one or more geometries\n     * @param {Boolean} [fitView=false]  - automatically set the map to a fit center and zoom for the geometries\n     * @return {OverlayLayer} this\n     */\n    addGeometry(geometries, fitView) {\n        if (!geometries) {\n            return this;\n        }\n        if (geometries.type === 'FeatureCollection') {\n            return this.addGeometry(GeoJSON.toGeometry(geometries), fitView);\n        } else if (!Array.isArray(geometries)) {\n            const count = arguments.length;\n            const last = arguments[count - 1];\n            geometries = Array.prototype.slice.call(arguments, 0, count - 1);\n            fitView = last;\n            if (isObject(last)) {\n                geometries.push(last);\n                fitView = false;\n            }\n            return this.addGeometry(geometries, fitView);\n        } else if (geometries.length === 0) {\n            return this;\n        }\n        this._initCache();\n        let extent;\n        if (fitView === true) {\n            extent = new Extent();\n        }\n        this._toSort = this._maxZIndex > 0;\n        const geos = [];\n        for (let i = 0, l = geometries.length; i < l; i++) {\n            let geo = geometries[i];\n            if (!geo) {\n                throw new Error('Invalid geometry to add to layer(' + this.getId() + ') at index:' + i);\n            }\n            if (!(geo instanceof Geometry)) {\n                geo = Geometry.fromJSON(geo);\n                if (Array.isArray(geo)) {\n                    for (let ii = 0, ll = geo.length; ii < ll; ii++) {\n                        this._add(geo[ii], extent, i);\n                        geos.push(geo[ii]);\n                    }\n                }\n            }\n            if (!Array.isArray(geo)) {\n                this._add(geo, extent, i);\n                geos.push(geo);\n            }\n        }\n        const map = this.getMap();\n        if (map) {\n            this._getRenderer().onGeometryAdd(geos);\n            if (fitView === true && !isNil(extent.xmin)) {\n                const z = map.getFitZoom(extent);\n                map.setCenterAndZoom(extent.getCenter(), z);\n            }\n        }\n        /**\n         * addgeo event.\n         *\n         * @event OverlayLayer#addgeo\n         * @type {Object}\n         * @property {String} type - addgeo\n         * @property {OverlayLayer} target - layer\n         * @property {Geometry[]} geometries - the geometries to add\n         */\n        this.fire('addgeo', {\n            'geometries': geometries\n        });\n        return this;\n    }\n\n    /**\n     * Get minimum zindex of geometries\n     */\n    getGeoMinZIndex() {\n        return this._minZIndex;\n    }\n\n    /**\n     * Get maximum zindex of geometries\n     */\n    getGeoMaxZIndex() {\n        return this._maxZIndex;\n    }\n\n    _add(geo, extent, i) {\n        if (!this._toSort) {\n            this._toSort = geo.getZIndex() !== 0;\n        }\n        this._updateZIndex(geo.getZIndex());\n        const geoId = geo.getId();\n        if (!isNil(geoId)) {\n            if (!isNil(this._geoMap[geoId])) {\n                throw new Error('Duplicate geometry id in layer(' + this.getId() + '):' + geoId + ', at index:' + i);\n            }\n            this._geoMap[geoId] = geo;\n        }\n        const internalId = UID();\n        geo._setInternalId(internalId);\n        this._geoList.push(geo);\n        if (this.onAddGeometry) {\n            this.onAddGeometry(geo);\n        }\n        geo._bindLayer(this);\n        if (geo.onAdd) {\n            geo.onAdd();\n        }\n        if (extent) {\n            extent._combine(geo.getExtent());\n        }\n        /**\n         * add event.\n         *\n         * @event Geometry#add\n         * @type {Object}\n         * @property {String} type - add\n         * @property {Geometry} target - geometry\n         * @property {Layer} layer - the layer added to.\n         */\n        geo._fireEvent('add', {\n            'layer': this\n        });\n    }\n\n    /**\n     * Removes one or more geometries from the layer\n     * @param  {String|String[]|Geometry|Geometry[]} geometries - geometry ids or geometries to remove\n     * @returns {OverlayLayer} this\n     */\n    removeGeometry(geometries) {\n        if (!Array.isArray(geometries)) {\n            return this.removeGeometry([geometries]);\n        }\n        for (let i = geometries.length - 1; i >= 0; i--) {\n            if (!(geometries[i] instanceof Geometry)) {\n                geometries[i] = this.getGeometryById(geometries[i]);\n            }\n            if (!geometries[i] || this !== geometries[i].getLayer()) continue;\n            geometries[i].remove();\n        }\n        /**\n         * removegeo event.\n         *\n         * @event OverlayLayer#removegeo\n         * @type {Object}\n         * @property {String} type - removegeo\n         * @property {OverlayLayer} target - layer\n         * @property {Geometry[]} geometries - the geometries to remove\n         */\n        this.fire('removegeo', {\n            'geometries': geometries\n        });\n        return this;\n    }\n\n    /**\n     * Clear all geometries in this layer\n     * @returns {OverlayLayer} this\n     */\n    clear() {\n        this._clearing = true;\n        this.forEach(geo => {\n            geo.remove();\n        });\n        this._geoMap = {};\n        const old = this._geoList;\n        this._geoList = [];\n        if (this._getRenderer()) {\n            this._getRenderer().onGeometryRemove(old);\n        }\n        this._clearing = false;\n        /**\n         * clear event.\n         *\n         * @event OverlayLayer#clear\n         * @type {Object}\n         * @property {String} type - clear\n         * @property {OverlayLayer} target - layer\n         */\n        this.fire('clear');\n        return this;\n    }\n\n    /**\n     * Called when geometry is being removed to clear the context concerned.\n     * @param  {Geometry} geometry - the geometry instance to remove\n     * @protected\n     */\n    onRemoveGeometry(geometry) {\n        if (!geometry || this._clearing) { return; }\n        //考察geometry是否属于该图层\n        if (this !== geometry.getLayer()) {\n            return;\n        }\n        const internalId = geometry._getInternalId();\n        if (isNil(internalId)) {\n            return;\n        }\n        const geoId = geometry.getId();\n        if (!isNil(geoId)) {\n            delete this._geoMap[geoId];\n        }\n        const idx = this._findInList(geometry);\n        if (idx >= 0) {\n            this._geoList.splice(idx, 1);\n        }\n        if (this._getRenderer()) {\n            this._getRenderer().onGeometryRemove([geometry]);\n        }\n    }\n\n    hide() {\n        for (let i = 0, l = this._geoList.length; i < l; i++) {\n            this._geoList[i].onHide();\n        }\n        return Layer.prototype.hide.call(this);\n    }\n\n    /**\n     * Identify the geometries on the given coordinate\n     * @param  {maptalks.Coordinate} coordinate   - coordinate to identify\n     * @param  {Object} [options=null]  - options\n     * @param  {Object} [options.tolerance=0] - identify tolerance in pixel\n     * @param  {Object} [options.count=null]  - result count\n     * @return {Geometry[]} geometries identified\n     */\n    identify(coordinate, options = {}) {\n        return this._hitGeos(this._geoList, coordinate, options);\n    }\n\n    _hitGeos(geometries, coordinate, options = {}) {\n        const filter = options['filter'],\n            tolerance = options['tolerance'],\n            hits = [];\n        const map = this.getMap();\n        const point = map.coordToPoint(coordinate);\n        const cp = map._pointToContainerPoint(point);\n        for (let i = geometries.length - 1; i >= 0; i--) {\n            const geo = geometries[i];\n            if (!geo || !geo.isVisible() || !geo._getPainter() || !geo.options['interactive']) {\n                continue;\n            }\n            if (!(geo instanceof LineString) || (!geo._getArrowStyle() && !(geo instanceof Curve))) {\n                // Except for LineString with arrows or curves\n                let extent = geo.getContainerExtent(TEMP_EXTENT);\n                if (tolerance) {\n                    extent = extent._expand(tolerance);\n                }\n                if (!extent || !extent.contains(cp)) {\n                    continue;\n                }\n            }\n            if (geo._containsPoint(cp, tolerance) && (!filter || filter(geo))) {\n                hits.push(geo);\n                if (options['count']) {\n                    if (hits.length >= options['count']) {\n                        break;\n                    }\n                }\n            }\n        }\n        return hits;\n    }\n\n    _initCache() {\n        if (!this._geoList) {\n            this._geoList = [];\n            this._geoMap = {};\n        }\n    }\n\n    _updateZIndex(...zIndex) {\n        this._maxZIndex = Math.max(this._maxZIndex, Math.max.apply(Math, zIndex));\n        this._minZIndex = Math.min(this._minZIndex, Math.min.apply(Math, zIndex));\n    }\n\n    _sortGeometries() {\n        if (!this._toSort) {\n            return;\n        }\n        this._maxZIndex = 0;\n        this._minZIndex = 0;\n        this._geoList.sort((a, b) => {\n            this._updateZIndex(a.getZIndex(), b.getZIndex());\n            return this._compare(a, b);\n        });\n        this._toSort = false;\n    }\n\n    _compare(a, b) {\n        if (a.getZIndex() === b.getZIndex()) {\n            return a._getInternalId() - b._getInternalId();\n        }\n        return a.getZIndex() - b.getZIndex();\n    }\n\n    //binarySearch\n    _findInList(geo) {\n        const len = this._geoList.length;\n        if (len === 0) {\n            return -1;\n        }\n        let low = 0,\n            high = len - 1,\n            middle;\n        while (low <= high) {\n            middle = Math.floor((low + high) / 2);\n            if (this._geoList[middle] === geo) {\n                return middle;\n            } else if (this._compare(this._geoList[middle], geo) > 0) {\n                high = middle - 1;\n            } else {\n                low = middle + 1;\n            }\n        }\n        return -1;\n    }\n\n    _onGeometryEvent(param) {\n        if (!param || !param['target']) {\n            return;\n        }\n        const type = param['type'];\n        if (type === 'idchange') {\n            this._onGeometryIdChange(param);\n        } else if (type === 'zindexchange') {\n            this._onGeometryZIndexChange(param);\n        } else if (type === 'positionchange') {\n            this._onGeometryPositionChange(param);\n        } else if (type === 'shapechange') {\n            this._onGeometryShapeChange(param);\n        } else if (type === 'symbolchange') {\n            this._onGeometrySymbolChange(param);\n        } else if (type === 'show') {\n            this._onGeometryShow(param);\n        } else if (type === 'hide') {\n            this._onGeometryHide(param);\n        } else if (type === 'propertieschange') {\n            this._onGeometryPropertiesChange(param);\n        }\n    }\n\n    _onGeometryIdChange(param) {\n        if (param['new'] === param['old']) {\n            if (this._geoMap[param['old']] && this._geoMap[param['old']] === param['target']) {\n                return;\n            }\n        }\n        if (!isNil(param['new'])) {\n            if (this._geoMap[param['new']]) {\n                throw new Error('Duplicate geometry id in layer(' + this.getId() + '):' + param['new']);\n            }\n            this._geoMap[param['new']] = param['target'];\n        }\n        if (!isNil(param['old']) && param['new'] !== param['old']) {\n            delete this._geoMap[param['old']];\n        }\n\n    }\n\n    _onGeometryZIndexChange(param) {\n        if (param['old'] !== param['new']) {\n            this._updateZIndex(param['new']);\n            this._toSort = true;\n            if (this._getRenderer()) {\n                this._getRenderer().onGeometryZIndexChange(param);\n            }\n        }\n    }\n\n    _onGeometryPositionChange(param) {\n        if (this._getRenderer()) {\n            this._getRenderer().onGeometryPositionChange(param);\n        }\n    }\n\n    _onGeometryShapeChange(param) {\n        if (this._getRenderer()) {\n            this._getRenderer().onGeometryShapeChange(param);\n        }\n    }\n\n    _onGeometrySymbolChange(param) {\n        if (this._getRenderer()) {\n            this._getRenderer().onGeometrySymbolChange(param);\n        }\n    }\n\n    _onGeometryShow(param) {\n        if (this._getRenderer()) {\n            this._getRenderer().onGeometryShow(param);\n        }\n    }\n\n    _onGeometryHide(param) {\n        if (this._getRenderer()) {\n            this._getRenderer().onGeometryHide(param);\n        }\n    }\n\n    _onGeometryPropertiesChange(param) {\n        if (this._getRenderer()) {\n            this._getRenderer().onGeometryPropertiesChange(param);\n        }\n    }\n}\n\nOverlayLayer.mergeOptions(options);\n\nexport default OverlayLayer;\n","import Browser from '../core/Browser';\nimport { isNil } from '../core/util';\nimport { getFilterFeature, compileStyle } from '@maptalks/feature-filter';\nimport Extent from '../geo/Extent';\nimport Geometry from '../geometry/Geometry';\nimport OverlayLayer from './OverlayLayer';\n\n/**\n * @property {Object}  options - VectorLayer's options\n * @property {Boolean} options.debug=false           - whether the geometries on the layer is in debug mode.\n * @property {Boolean} options.enableSimplify=true   - whether to simplify geometries before rendering.\n * @property {String}  options.cursor=default        - the cursor style of the layer\n * @property {Boolean} options.geometryEvents=true   - enable/disable firing geometry events, disable it to improve performance.\n * @property {Boolean} options.defaultIconSize=[20,20] - default size of a marker's icon\n * @property {Boolean} [options.enableAltitude=false]  - whether to enable render geometry with altitude, false by default\n * @property {Boolean} [options.altitudeProperty=altitude] - geometry's altitude property name, if enableAltitude is true, \"altitude\" by default\n * @property {Boolean} [options.drawAltitude=false]  - whether to draw altitude: a vertical line for marker, a vertical polygon for line\n * @property {Boolean} [options.debug=false]         - whether the geometries on the layer is in debug mode.\n * @memberOf VectorLayer\n * @instance\n */\nconst options = {\n    'debug': false,\n    'enableSimplify': true,\n    'geometryEvents': true,\n    'defaultIconSize': [20, 20],\n    'cacheVectorOnCanvas': true,\n    'cacheSvgOnCanvas': Browser.gecko,\n    'enableAltitude' : false,\n    'altitudeProperty' : 'altitude',\n    'drawAltitude' : false\n};\n\n/**\n * @classdesc\n * A layer for managing and rendering geometries.\n * @category layer\n * @extends OverlayLayer\n */\nclass VectorLayer extends OverlayLayer {\n\n    /**\n     * @param {String|Number} id - layer's id\n     * @param {Geometry|Geometry[]} [geometries=null] - geometries to add\n     * @param {Object}  [options=null]          - construct options\n     * @param {Object}  [options.style=null]    - vectorlayer's style\n     * @param {*}  [options.*=null]             - options defined in [VectorLayer]{@link VectorLayer#options}\n     */\n    constructor(id, geometries, options) {\n        super(id, geometries, options);\n        const style = this.options['style'];\n        delete this.options['style'];\n        if (style) {\n            this.setStyle(style);\n        }\n    }\n\n    /**\n     * Gets layer's style.\n     * @return {Object|Object[]} layer's style\n     */\n    getStyle() {\n        if (!this._style) {\n            return null;\n        }\n        return this._style;\n    }\n\n    /**\n     * Sets style to the layer, styling the geometries satisfying the condition with style's symbol. <br>\n     * Based on filter type in [mapbox-gl-js's style specification]{https://www.mapbox.com/mapbox-gl-js/style-spec/#types-filter}.\n     * @param {Object|Object[]} style - layer's style\n     * @returns {VectorLayer} this\n     * @fires VectorLayer#setstyle\n     * @example\n     * layer.setStyle([\n        {\n          'filter': ['==', 'count', 100],\n          'symbol': {'markerFile' : 'foo1.png'}\n        },\n        {\n          'filter': ['==', 'count', 200],\n          'symbol': {'markerFile' : 'foo2.png'}\n        }\n      ]);\n     */\n    setStyle(style) {\n        this._style = style;\n        this._cookedStyles = compileStyle(style);\n        this.forEach(function (geometry) {\n            this._styleGeometry(geometry);\n        }, this);\n        /**\n         * setstyle event.\n         *\n         * @event VectorLayer#setstyle\n         * @type {Object}\n         * @property {String} type - setstyle\n         * @property {VectorLayer} target - layer\n         * @property {Object|Object[]}       style - style to set\n         */\n        this.fire('setstyle', {\n            'style': style\n        });\n        return this;\n    }\n\n    /**\n     * Removes layers' style\n     * @returns {VectorLayer} this\n     * @fires VectorLayer#removestyle\n     */\n    removeStyle() {\n        if (!this._style) {\n            return this;\n        }\n        delete this._style;\n        delete this._cookedStyles;\n        this.forEach(function (geometry) {\n            geometry._setExternSymbol(null);\n        }, this);\n        /**\n         * removestyle event.\n         *\n         * @event VectorLayer#removestyle\n         * @type {Object}\n         * @property {String} type - removestyle\n         * @property {VectorLayer} target - layer\n         */\n        this.fire('removestyle');\n        return this;\n    }\n\n    onAddGeometry(geo) {\n        const style = this.getStyle();\n        if (style) {\n            this._styleGeometry(geo);\n        }\n    }\n\n    onConfig(conf) {\n        super.onConfig(conf);\n        if (conf['enableAltitude'] || conf['drawAltitude'] || conf['altitudeProperty']) {\n            const renderer = this.getRenderer();\n            if (renderer && renderer.setToRedraw) {\n                renderer.setToRedraw();\n            }\n        }\n    }\n\n    _styleGeometry(geometry) {\n        if (!this._cookedStyles) {\n            return false;\n        }\n        const g = getFilterFeature(geometry);\n        for (let i = 0, len = this._cookedStyles.length; i < len; i++) {\n            if (this._cookedStyles[i]['filter'](g) === true) {\n                geometry._setExternSymbol(this._cookedStyles[i]['symbol']);\n                return true;\n            }\n        }\n        return false;\n    }\n\n    identify(coordinate, options = {}) {\n        const renderer = this.getRenderer();\n        // only iterate drawn geometries when onlyVisible is true.\n        if (options['onlyVisible'] && renderer && renderer.identify) {\n            return renderer.identify(coordinate, options);\n        }\n        return super.identify(coordinate, options);\n    }\n\n    /**\n     * Export the VectorLayer's JSON. <br>\n     * @param  {Object} [options=null] - export options\n     * @param  {Object} [options.geometries=null] - If not null and the layer is a [OverlayerLayer]{@link OverlayLayer},\n     *                                            the layer's geometries will be exported with the given \"options.geometries\" as a parameter of geometry's toJSON.\n     * @param  {Extent} [options.clipExtent=null] - if set, only the geometries intersectes with the extent will be exported.\n     * @return {Object} layer's JSON\n     */\n    toJSON(options) {\n        if (!options) {\n            options = {};\n        }\n        const profile = {\n            'type': this.getJSONType(),\n            'id': this.getId(),\n            'options': this.config()\n        };\n        if ((isNil(options['style']) || options['style']) && this.getStyle()) {\n            profile['style'] = this.getStyle();\n        }\n        if (isNil(options['geometries']) || options['geometries']) {\n            let clipExtent;\n            if (options['clipExtent']) {\n                const map = this.getMap();\n                const projection = map ? map.getProjection() : null;\n                clipExtent = new Extent(options['clipExtent'], projection);\n            }\n            const geoJSONs = [];\n            const geometries = this.getGeometries();\n            for (let i = 0, len = geometries.length; i < len; i++) {\n                const geo = geometries[i];\n                const geoExt = geo.getExtent();\n                if (!geoExt || (clipExtent && !clipExtent.intersects(geoExt))) {\n                    continue;\n                }\n                const json = geo.toJSON(options['geometries']);\n                geoJSONs.push(json);\n            }\n            profile['geometries'] = geoJSONs;\n        }\n        return profile;\n    }\n\n    /**\n     * Reproduce a VectorLayer from layer's JSON.\n     * @param  {Object} layerJSON - layer's JSON\n     * @return {VectorLayer}\n     * @static\n     * @private\n     * @function\n     */\n    static fromJSON(json) {\n        if (!json || json['type'] !== 'VectorLayer') {\n            return null;\n        }\n        const layer = new VectorLayer(json['id'], json['options']);\n        const geoJSONs = json['geometries'];\n        const geometries = [];\n        for (let i = 0; i < geoJSONs.length; i++) {\n            const geo = Geometry.fromJSON(geoJSONs[i]);\n            if (geo) {\n                geometries.push(geo);\n            }\n        }\n        layer.addGeometry(geometries);\n        if (json['style']) {\n            layer.setStyle(json['style']);\n        }\n        return layer;\n    }\n}\n\nVectorLayer.mergeOptions(options);\n\nVectorLayer.registerJSONType('VectorLayer');\n\nexport default VectorLayer;\n","import Class from '../../core/Class';\nimport Eventable from '../../core/Eventable';\n\nconst key = '_map_tool';\n\n/**\n * @classdesc\n * <pre>\n * The parent class for all the map tools.\n * It is abstract and not intended to be instantiated.\n * Some interface methods to implement:\n * 1. onAdd: optional, a callback method to do some prepares before enabled when the map tool is added to a map\n * 2. onEnable: optional, called when the map tool is enabled, used to setup the context such as adding more event listeners other than the map, disabling map's default handlers (draggable, scrollWheelZoom, etc) and creating temporary layers.\n * 3. getEvents: required, provide an event map to register event listeners on the map.\n * 4. onDisable: optional, called when the map tool is disabled, used to cleanup such as unregistering event listeners, enable map's original handlers and remove temporary layers.\n * </pre>\n * @abstract\n * @category maptool\n * @extends Class\n * @mixes Eventable\n */\nclass MapTool extends Eventable(Class) {\n\n    /**\n     * Adds the map tool to a map.\n     * @param {Map} map\n     * @return {MapTool} this\n     * @fires MapTool#add\n     */\n    addTo(map) {\n        if (!map) {\n            return this;\n        }\n        this._map = map;\n        // map tool is unique on one map\n        if (map[key]) {\n            map[key].disable();\n        }\n        if (this.onAdd) {\n            this.onAdd();\n        }\n        this.enable();\n        map[key] = this;\n\n        /**\n         * add event.\n         *\n         * @event MapTool#add\n         * @type {Object}\n         * @property {String} type - add\n         * @property {MapTool} target - map tool\n         */\n        this._fireEvent('add');\n        return this;\n    }\n\n    /**\n     * Gets the map it added to.\n     * @return {Map} map\n     */\n    getMap() {\n        return this._map;\n    }\n\n    /**\n     * Enable the map tool.\n     * @return {MapTool} this\n     * @fires MapTool#enable\n     */\n    enable() {\n        const map = this._map;\n        if (!map || this._enabled) {\n            return this;\n        }\n        this._enabled = true;\n        this._switchEvents('off');\n\n        this._registerEvents();\n        if (this.onEnable) {\n            this.onEnable();\n        }\n        /**\n         * enable event.\n         *\n         * @event MapTool#enable\n         * @type {Object}\n         * @property {String} type - enable\n         * @property {MapTool} target - map tool\n         */\n        this._fireEvent('enable');\n        return this;\n    }\n\n    /**\n     * Disable the map tool\n     * @return {MapTool} this\n     * @fires MapTool#disable\n     */\n    disable() {\n        if (!this._enabled || !this._map) {\n            return this;\n        }\n        this._enabled = false;\n        this._switchEvents('off');\n        if (this.onDisable) {\n            this.onDisable();\n        }\n        /**\n         * disable event.\n         *\n         * @event MapTool#disable\n         * @type {Object}\n         * @property {String} type - disable\n         * @property {MapTool} target - map tool\n         */\n        this._fireEvent('disable');\n        return this;\n    }\n\n    /**\n     * Returns whether the tool is enabled\n     * @return {Boolean} true | false\n     */\n    isEnabled() {\n        if (!this._enabled) {\n            return false;\n        }\n        return true;\n    }\n\n    remove() {\n        if (!this._map) {\n            return this;\n        }\n        this.disable();\n        if (this._map) {\n            delete this._map[key];\n            delete this._map;\n        }\n        /**\n         * remove event.\n         *\n         * @event MapTool#remove\n         * @type {Object}\n         * @property {String} type - remove\n         * @property {MapTool} target - map tool\n         */\n        this._fireEvent('remove');\n        return this;\n    }\n\n    _registerEvents() {\n        this._switchEvents('on');\n    }\n\n    _switchEvents(to) {\n        const events = this.getEvents();\n        if (events) {\n            this._map[to](events, this);\n        }\n    }\n\n    _fireEvent(eventName, param) {\n        if (!param) {\n            param = {};\n        }\n        this.fire(eventName, param);\n    }\n}\n\nexport default MapTool;\n","import { INTERNAL_LAYER_PREFIX } from '../../core/Constants';\nimport { isNil } from '../../core/util';\nimport { extendSymbol } from '../../core/util/style';\nimport { getExternalResources } from '../../core/util/resource';\nimport { stopPropagation } from '../../core/util/dom';\nimport Polygon from '../../geometry/Polygon';\nimport VectorLayer from '../../layer/VectorLayer';\nimport MapTool from './MapTool';\n\n/**\n * @property {Object} [options=null] - construct options\n * @property {String} [options.mode=null]   - mode of the draw tool\n * @property {Object} [options.symbol=null] - symbol of the geometries drawn\n * @property {Boolean} [options.once=null]  - whether disable immediately once drawn a geometry.\n * @property {Boolean} [options.autoPanAtEdge=false]  - Whether to make edge judgement or not.\n * @memberOf DrawTool\n * @instance\n */\nconst options = {\n    'symbol': {\n        'lineColor': '#000',\n        'lineWidth': 2,\n        'lineOpacity': 1,\n        'polygonFill': '#fff',\n        'polygonOpacity': 0.3\n    },\n    'doubleClickZoom': false,\n    'mode': null,\n    'once': false,\n    'autoPanAtEdge': false,\n    'ignoreMouseleave': true\n};\n\nconst registeredMode = {};\n\n/**\n * A map tool to help draw geometries.\n * @category maptool\n * @extends MapTool\n * @example\n * var drawTool = new DrawTool({\n *     mode : 'Polygon',\n *     symbol : {\n *         'lineColor' : '#000',\n *         'lineWidth' : 5\n *     },\n *     once : true\n * }).addTo(map);\n */\nclass DrawTool extends MapTool {\n\n    /**\n     * Register a new mode for DrawTool\n     * @param  {String} name       mode name\n     * @param  {Object} modeAction modeActions\n     * @param  {Object} modeAction.action the action of DrawTool: click, mousedown, clickDblclick\n     * @param  {Object} modeAction.create the create method of drawn geometry\n     * @param  {Object} modeAction.update the update method of drawn geometry\n     * @param  {Object} modeAction.generate the method to generate geometry at the end of drawing.\n     * @example\n     * //Register \"CubicBezierCurve\" mode to draw Cubic Bezier Curves.\n     * DrawTool.registerMode('CubicBezierCurve', {\n        'action': 'clickDblclick',\n        'create': path => new CubicBezierCurve(path),\n        'update': (path, geometry) => {\n            geometry.setCoordinates(path);\n        },\n        'generate': geometry => geometry\n       }\n     });\n     */\n    static registerMode(name, modeAction) {\n        registeredMode[name.toLowerCase()] = modeAction;\n    }\n\n    /**\n     * Get mode actions by mode name\n     * @param  {String} name DrawTool mode name\n     * @return {Object}      mode actions\n     */\n    static getRegisterMode(name) {\n        return registeredMode[name.toLowerCase()];\n    }\n\n    /**\n     * In default, DrawTool supports the following modes: <br>\n     * [Point, LineString, Polygon, Circle, Ellipse, Rectangle, ArcCurve, QuadBezierCurve, CubicBezierCurve] <br>\n     * You can easily add new mode to DrawTool by calling [registerMode]{@link DrawTool.registerMode}\n     * @param {Object} [options=null] - construct options\n     * @param {String} [options.mode=null]   - mode of the draw tool\n     * @param {Object} [options.symbol=null] - symbol of the geometries drawn\n     * @param {Boolean} [options.once=null]  - whether disable immediately once drawn a geometry.\n     * @param {Boolean} [options.autoPanAtEdge=false]  - Whether to make edge judgement or not.\n     */\n    constructor(options) {\n        super(options);\n        this._checkMode();\n        /**\n         * events\n         * @type {{click: DrawTool._firstClickHandler, mousemove: DrawTool._mouseMoveHandler, dblclick: DrawTool._doubleClickHandler, mousedown: DrawTool._mouseDownHandler, mouseup: DrawTool._mouseUpHandler}}\n         * @private\n         */\n        this._events = {\n            'click': this._firstClickHandler,\n            'mousemove': this._mouseMoveHandler,\n            'dblclick': this._doubleClickHandler,\n            'mousedown': this._mouseDownHandler,\n            'mouseup': this._mouseUpHandler\n        };\n    }\n\n    /**\n     * Get current mode of draw tool\n     * @return {String} mode\n     */\n    getMode() {\n        if (this.options['mode']) {\n            return this.options['mode'].toLowerCase();\n        }\n        return null;\n    }\n\n    /**\n     * Set mode of the draw tool\n     * @param {String} mode - mode of the draw tool\n     * @expose\n     */\n    setMode(mode) {\n        if (this._geometry) {\n            this._geometry.remove();\n            delete this._geometry;\n        }\n        this._clearStage();\n        this._switchEvents('off');\n        this.options['mode'] = mode;\n        this._checkMode();\n        if (this.isEnabled()) {\n            this._switchEvents('on');\n            this._restoreMapCfg();\n            this._saveMapCfg();\n        }\n        return this;\n    }\n\n    /**\n     * Get symbol of the draw tool\n     * @return {Object} symbol\n     */\n    getSymbol() {\n        const symbol = this.options['symbol'];\n        if (symbol) {\n            return extendSymbol(symbol);\n        } else {\n            return extendSymbol(this.options['symbol']);\n        }\n    }\n\n    /**\n     * Set draw tool's symbol\n     * @param {Object} symbol - symbol set\n     * @returns {DrawTool} this\n     */\n    setSymbol(symbol) {\n        if (!symbol) {\n            return this;\n        }\n        this.options['symbol'] = symbol;\n        if (this._geometry) {\n            this._geometry.setSymbol(symbol);\n        }\n        return this;\n    }\n\n    /**\n     * Get geometry is currently drawing\n     * @return {Geometry} geometry currently drawing\n     */\n    getCurrentGeometry() {\n        return this._geometry;\n    }\n\n    onAdd() {\n        this._checkMode();\n    }\n\n    onEnable() {\n        this._saveMapCfg();\n        this._drawToolLayer = this._getDrawLayer();\n        this._clearStage();\n        this._loadResources();\n        if (this.options['autoPanAtEdge']) {\n            const map = this.getMap();\n            this._mapAutoPanAtEdge = map.options['autoPanAtEdge'];\n            if (!this._mapAutoPanAtEdge) {\n                map.config({ autoPanAtEdge: true });\n            }\n        }\n        return this;\n    }\n\n    onDisable() {\n        const map = this.getMap();\n        this._restoreMapCfg();\n        this.endDraw();\n        if (this._map) {\n            map.removeLayer(this._getDrawLayer());\n            if (this.options['autoPanAtEdge']) {\n                if (!this._mapAutoPanAtEdge) {\n                    map.config({ autoPanAtEdge: false });\n                }\n            }\n        }\n        return this;\n    }\n\n    /**\n     * Undo drawing, only applicable for click/dblclick mode\n     * @return {DrawTool} this\n     */\n    undo() {\n        const registerMode = this._getRegisterMode();\n        const action = registerMode.action;\n        if (!this._shouldRecordHistory(action) || !this._historyPointer) {\n            return this;\n        }\n        const coords = this._clickCoords.slice(0, --this._historyPointer);\n        registerMode.update(coords, this._geometry);\n        return this;\n    }\n\n    /**\n     * Redo drawing, only applicable for click/dblclick mode\n     * @return {DrawTool} this\n     */\n    redo() {\n        const registerMode = this._getRegisterMode();\n        const action = registerMode.action;\n        if (!this._shouldRecordHistory(action) || isNil(this._historyPointer) || this._historyPointer === this._clickCoords.length) {\n            return this;\n        }\n        const coords = this._clickCoords.slice(0, ++this._historyPointer);\n        registerMode.update(coords, this._geometry);\n        return this;\n    }\n\n    /**\n     * check should recor history\n     * @param actions\n     * @returns {boolean}\n     * @private\n     */\n    _shouldRecordHistory(actions) {\n        return Array.isArray(actions) && actions[0] === 'click' && actions[1] === 'mousemove' && actions[2] === 'dblclick';\n    }\n\n    _checkMode() {\n        this._getRegisterMode();\n    }\n\n    _saveMapCfg() {\n        const map = this.getMap();\n        this._mapDoubleClickZoom = map.options['doubleClickZoom'];\n        map.config({\n            'doubleClickZoom': this.options['doubleClickZoom']\n        });\n        const actions = this._getRegisterMode()['action'];\n        if (actions.indexOf('mousedown') > -1) {\n            const map = this.getMap();\n            this._mapDraggable = map.options['draggable'];\n            map.config({\n                'draggable': false\n            });\n        }\n    }\n\n    _restoreMapCfg() {\n        const map = this.getMap();\n        map.config({\n            'doubleClickZoom': this._mapDoubleClickZoom\n        });\n        if (!isNil(this._mapDraggable)) {\n            map.config('draggable', this._mapDraggable);\n        }\n        delete this._mapDraggable;\n        delete this._mapDoubleClickZoom;\n    }\n\n    _loadResources() {\n        const symbol = this.getSymbol();\n        const resources = getExternalResources(symbol);\n        if (resources.length > 0) {\n            //load external resources at first\n            this._drawToolLayer._getRenderer().loadResources(resources);\n        }\n    }\n\n    _getProjection() {\n        return this._map.getProjection();\n    }\n\n    _getRegisterMode() {\n        const mode = this.getMode();\n        const registerMode = DrawTool.getRegisterMode(mode);\n        if (!registerMode) {\n            throw new Error(mode + ' is not a valid mode of DrawTool.');\n        }\n        return registerMode;\n    }\n\n    getEvents() {\n        const action = this._getRegisterMode()['action'];\n        const _events = {};\n        if (Array.isArray(action)) {\n            for (let i = 0; i < action.length; i++) {\n                _events[action[i]] = this._events[action[i]];\n            }\n            return _events;\n        }\n        return null;\n    }\n\n    /**\n     * mouse down start draw\n     * @param event\n     * @private\n     */\n    _mouseDownHandler(event) {\n        this._createGeometry(event);\n    }\n\n    /**\n     * handle mouse up event\n     * @param event\n     * @private\n     */\n    _mouseUpHandler(event) {\n        this.endDraw(event);\n    }\n\n    /**\n     * handle mouse first click handle\n     * @param event\n     * @private\n     */\n    _firstClickHandler(event) {\n        const registerMode = this._getRegisterMode();\n        const coordinate = event['coordinate'];\n        if (!this._geometry) {\n            this._createGeometry(event);\n        } else {\n            if (!isNil(this._historyPointer)) {\n                this._clickCoords = this._clickCoords.slice(0, this._historyPointer);\n            }\n            this._clickCoords.push(coordinate);\n            this._historyPointer = this._clickCoords.length;\n            event.drawTool = this;\n            if (registerMode['clickLimit'] && registerMode['clickLimit'] === this._historyPointer) {\n                registerMode['update']([coordinate], this._geometry, event);\n                this.endDraw(event);\n            } else {\n                registerMode['update'](this._clickCoords, this._geometry, event);\n            }\n            /**\n             * drawvertex event.\n             *\n             * @event DrawTool#drawvertex\n             * @type {Object}\n             * @property {String} type - drawvertex\n             * @property {DrawTool} target - draw tool\n             * @property {Geometry} geometry - geometry drawn\n             * @property {Coordinate} coordinate - coordinate of the event\n             * @property {Point} containerPoint  - container point of the event\n             * @property {Point} viewPoint       - view point of the event\n             * @property {Event} domEvent                 - dom event\n             */\n            this._fireEvent('drawvertex', event);\n        }\n    }\n\n    /**\n     * 第一次事件创建相关geometry\n     * @param event\n     * @private\n     */\n    _createGeometry(event) {\n        const mode = this.getMode();\n        const registerMode = this._getRegisterMode();\n        const coordinate = event['coordinate'];\n        const symbol = this.getSymbol();\n        if (!this._geometry) {\n            this._clickCoords = [coordinate];\n            event.drawTool = this;\n            this._geometry = registerMode['create'](this._clickCoords, event);\n            if (symbol && mode !== 'point') {\n                this._geometry.setSymbol(symbol);\n            } else if (this.options.hasOwnProperty('symbol')) {\n                this._geometry.setSymbol(this.options['symbol']);\n            }\n            this._addGeometryToStage(this._geometry);\n            /**\n             * drawstart event.\n             *\n             * @event DrawTool#drawstart\n             * @type {Object}\n             * @property {String} type - drawstart\n             * @property {DrawTool} target - draw tool\n             * @property {Coordinate} coordinate - coordinate of the event\n             * @property {Point} containerPoint  - container point of the event\n             * @property {Point} viewPoint       - view point of the event\n             * @property {Event} domEvent                 - dom event\n             */\n            this._fireEvent('drawstart', event);\n        }\n        if (mode === 'point') {\n            this.endDraw(event);\n        }\n    }\n\n\n    /**\n     * handle mouse move event\n     * @param event\n     * @private\n     */\n    _mouseMoveHandler(event) {\n        const map = this.getMap();\n        const coordinate = event['coordinate'];\n        if (!this._geometry || !map || map.isInteracting()) {\n            return;\n        }\n        const containerPoint = this._getMouseContainerPoint(event);\n        if (!this._isValidContainerPoint(containerPoint)) {\n            return;\n        }\n        event.drawTool = this;\n        const registerMode = this._getRegisterMode();\n        if (this._shouldRecordHistory(registerMode.action)) {\n            const path = this._clickCoords.slice(0, this._historyPointer);\n            if (path && path.length > 0 && coordinate.equals(path[path.length - 1])) {\n                return;\n            }\n            registerMode['update'](path.concat([coordinate]), this._geometry, event);\n        } else {\n            registerMode['update']([coordinate], this._geometry, event);\n        }\n        /**\n         * mousemove event.\n         *\n         * @event DrawTool#mousemove\n         * @type {Object}\n         * @property {String} type - mousemove\n         * @property {DrawTool} target - draw tool\n         * @property {Geometry} geometry - geometry drawn\n         * @property {Coordinate} coordinate - coordinate of the event\n         * @property {Point} containerPoint  - container point of the event\n         * @property {Point} viewPoint       - view point of the event\n         * @property {Event} domEvent                 - dom event\n         */\n        this._fireEvent('mousemove', event);\n    }\n\n    /**\n     * handle mouse double click event\n     * @param event\n     * @private\n     */\n    _doubleClickHandler(event) {\n        if (!this._geometry) {\n            return;\n        }\n        const containerPoint = this._getMouseContainerPoint(event);\n        if (!this._isValidContainerPoint(containerPoint)) {\n            return;\n        }\n        const registerMode = this._getRegisterMode();\n        const clickCoords = this._clickCoords;\n        if (clickCoords.length < 2) {\n            return;\n        }\n        //remove duplicate vertexes\n        const path = [clickCoords[0]];\n        for (let i = 1, len = clickCoords.length; i < len; i++) {\n            if (clickCoords[i].x !== clickCoords[i - 1].x || clickCoords[i].y !== clickCoords[i - 1].y) {\n                path.push(clickCoords[i]);\n            }\n        }\n        if (path.length < 2 || (this._geometry && (this._geometry instanceof Polygon) && path.length < 3)) {\n            return;\n        }\n        event.drawTool = this;\n        registerMode['update'](path, this._geometry, event);\n        this.endDraw(event);\n    }\n\n    _addGeometryToStage(geometry) {\n        const drawLayer = this._getDrawLayer();\n        drawLayer.addGeometry(geometry);\n    }\n\n    /**\n     * End current draw\n     * @param {Object} [param=null] params of drawend event\n     * @returns {DrawTool} this\n     */\n    endDraw(param) {\n        if (!this._geometry || this._ending) {\n            return this;\n        }\n        this._ending = true;\n        const geometry = this._geometry;\n        this._clearStage();\n        param = param || {};\n        this._geometry = geometry;\n        /**\n         * drawend event.\n         *\n         * @event DrawTool#drawend\n         * @type {Object}\n         * @property {String} type - drawend\n         * @property {DrawTool} target - draw tool\n         * @property {Geometry} geometry - geometry drawn\n         * @property {Coordinate} coordinate - coordinate of the event\n         * @property {Point} containerPoint  - container point of the event\n         * @property {Point} viewPoint       - view point of the event\n         * @property {Event} domEvent                 - dom event\n         */\n        this._fireEvent('drawend', param);\n        delete this._geometry;\n        if (this.options['once']) {\n            this.disable();\n        }\n        delete this._ending;\n        return this;\n    }\n\n    _clearStage() {\n        this._getDrawLayer().clear();\n        delete this._geometry;\n        delete this._clickCoords;\n    }\n\n    /**\n     * Get container point of the mouse event\n     * @param  {Event} event -  mouse event\n     * @return {Point}\n     * @private\n     */\n    _getMouseContainerPoint(event) {\n        const action = this._getRegisterMode()['action'];\n        if (action === 'mousedown') {\n            stopPropagation(event['domEvent']);\n        }\n        return event['containerPoint'];\n    }\n\n    _isValidContainerPoint(containerPoint) {\n        const mapSize = this._map.getSize();\n        const w = mapSize['width'],\n            h = mapSize['height'];\n        if (containerPoint.x < 0 || containerPoint.y < 0) {\n            return false;\n        } else if (containerPoint.x > w || containerPoint.y > h) {\n            return false;\n        }\n        return true;\n    }\n\n    _getDrawLayer() {\n        const drawLayerId = INTERNAL_LAYER_PREFIX + 'drawtool';\n        let drawToolLayer = this._map.getLayer(drawLayerId);\n        if (!drawToolLayer) {\n            drawToolLayer = new VectorLayer(drawLayerId, {\n                'enableSimplify': false\n            });\n            this._map.addLayer(drawToolLayer);\n        }\n        return drawToolLayer;\n    }\n\n    _fireEvent(eventName, param) {\n        if (!param) {\n            param = {};\n        }\n        if (this._geometry) {\n            param['geometry'] = this._getRegisterMode()['generate'](this._geometry, { drawTool: this }).copy();\n        }\n        MapTool.prototype._fireEvent.call(this, eventName, param);\n    }\n\n}\n\nDrawTool.mergeOptions(options);\n\nexport default DrawTool;\n","import Handler from '../../handler/Handler';\nimport Map from '../Map';\nimport DrawTool from '../tool/DrawTool';\nimport Extent from '../../geo/Extent';\n\nclass MapBoxZoomHander extends Handler {\n    constructor(target) {\n        super(target);\n        this.drawTool = new DrawTool({\n            'mode'   : 'boxZoom',\n            'ignoreMouseleave' : false\n        });\n    }\n\n    addHooks() {\n        this.target.on('_mousedown', this._onMouseDown, this);\n    }\n\n    removeHooks() {\n        this.target.off('_mousedown', this._onMouseDown, this);\n        if (this.drawTool.isEnabled()) {\n            this.drawTool.remove();\n        }\n    }\n\n    _onMouseDown(param) {\n        if (!this.target.options['boxZoom']) {\n            return;\n        }\n        if (param.domEvent.shiftKey) {\n            this.drawTool.setSymbol(this.target.options['boxZoomSymbol'])\n                .on('drawend', this._boxZoom, this)\n                .addTo(this.target);\n        }\n    }\n\n    _boxZoom(param) {\n        const map = this.target;\n        this.drawTool.remove();\n        const geometry = param.geometry,\n            center = geometry.getCenter(),\n            symbol = geometry.getSymbol(),\n            w = symbol.markerWidth,\n            h = symbol.markerHeight;\n\n        const extent = new Extent(center, map.locateByPoint(center, w, h), map.getProjection());\n        const zoom = map.getFitZoom(extent);\n        map.animateTo({\n            center : extent.getCenter(),\n            zoom : zoom\n        });\n    }\n}\n\nMap.mergeOptions({\n    'boxZoom' : true,\n    'boxZoomSymbol': {\n        'markerType' : 'rectangle',\n        'markerLineWidth' : 3,\n        'markerLineColor' : '#1bbc9b',\n        'markerLineDasharray' : [10, 5],\n        'markerFillOpacity' : 0.1,\n        'markerFill' : '#1bbc9b',\n        'markerWidth' : 1,\n        'markerHeight' : 1\n    }\n});\n\nMap.addOnLoadHook('addHandler', 'boxZoom', MapBoxZoomHander);\n\nexport default MapBoxZoomHander;\n","import Handler from '../../handler/Handler';\nimport Map from '../Map';\n\n// Edge Detection Distance(Units are pixels).\nconst PANOFFSET = 30;\n\nclass MapAutoPanAtEdgeHandler extends Handler {\n    addHooks() {\n        if (!this.target) {\n            return;\n        }\n        this.target.on('_mousemove', this._onMouseMove, this);\n    }\n\n    removeHooks() {\n        if (!this.target) {\n            return;\n        }\n        this.target.off('_mousemove', this._onMouseMove, this);\n    }\n\n    _onMouseMove(event) {\n        const map = this.target;\n        if (map.options['autoPanAtEdge']) {\n            const { containerPoint } = event;\n            const containerExtent = map.getContainerExtent();\n            if (containerExtent) {\n                const { x, y } = containerPoint;\n                const { xmax, ymax } = containerExtent;\n                let p;\n                if (x < PANOFFSET) {\n                    p = [Math.abs(x - PANOFFSET), 0];\n                }\n                if (y < PANOFFSET) {\n                    p = [0, Math.abs(y - PANOFFSET)];\n                }\n                if ((x + PANOFFSET) > xmax) {\n                    p = [-Math.abs((x + PANOFFSET) - xmax), 0];\n                }\n                if ((y + PANOFFSET) > ymax) {\n                    p = [0, -Math.abs((y + PANOFFSET) - ymax)];\n                }\n                if (p) {\n                    map.panBy(p, { duration: 1 });\n                }\n            }\n        }\n    }\n}\n\nMap.mergeOptions({\n    'autoPanAtEdge': false\n});\n\nMap.addOnLoadHook('addHandler', 'autoPanAtEdge', MapAutoPanAtEdgeHandler);\n\nexport default MapAutoPanAtEdgeHandler;\n","import { Animation } from '../core/Animation';\nimport Coordinate from '../geo/Coordinate';\nimport Point from '../geo/Point';\nimport Map from './Map';\nimport { isNil, isFunction, hasOwn } from '../core/util';\n\nfunction equalView(view1, view2) {\n    for (const p in view1) {\n        if (hasOwn(view1, p)) {\n            if (p === 'center') {\n                if (view1[p][0] !== view2[p][0] || view1[p][1] !== view2[p][1]) {\n                    return false;\n                }\n            } else if (view1[p] !== view2[p]) {\n                return false;\n            }\n        }\n    }\n    return true;\n}\n\nMap.include(/** @lends Map.prototype */{\n\n    /**\n     * Update map's view with animation.\n     * @example\n     * map.animateTo({\n     *     zoom : 13,\n     *     center : [0, 0],\n     *     pitch : 30,\n     *     bearing : 60\n     * }, {\n     *     duration : 6000,\n     *     easing : 'out'\n     * }, function(frame) {\n     *     if (frame.state.playState === 'finished') {\n     *         console.log('animation finished');\n     *     }\n     * });\n     * @param  {Object} view    view object\n     * @param  {Object} [options=null]\n     * @param  {String} [options.easing=out]\n     * @param  {Number} [options.duration=map.options.zoomAnimationDuration]\n     * @param  {Function} [step=null]  - step function during animation, animation frame as the parameter\n     * @return {Map}         this\n     */\n    animateTo(view, options = {}, step) {\n        this._stopAnim(this._animPlayer);\n        if (isFunction(options)) {\n            step = options;\n            options = {};\n        }\n        const projection = this.getProjection(),\n            currView = this.getView(),\n            props = {};\n        let empty = true;\n        for (const p in view) {\n            if (hasOwn(view, p) && !isNil(currView[p])) {\n                empty = false;\n                if (p === 'center') {\n                    const from = new Coordinate(currView[p]).toFixed(7),\n                        to = new Coordinate(view[p]).toFixed(7);\n                    if (!from.equals(to)) {\n                        props['center'] = [from, to];\n                    }\n                } else if (currView[p] !== view[p] && p !== 'around') {\n                    props[p] = [currView[p], view[p]];\n                }\n            }\n        }\n        if (empty) {\n            return null;\n        }\n        const zoomOrigin = view['around'] || new Point(this.width / 2, this.height / 2);\n        let preView = this.getView();\n        const renderer = this._getRenderer(),\n            framer = function (fn) {\n                renderer.callInNextFrame(fn);\n            };\n\n        const player = this._animPlayer = Animation.animate(props, {\n            'easing': options['easing'] || 'out',\n            'duration': options['duration'] || this.options['zoomAnimationDuration'],\n            'framer' : framer\n        }, frame => {\n            if (this.isRemoved()) {\n                player.finish();\n                return;\n            }\n            if (player.playState === 'running') {\n                const view = this.getView();\n                if (!options['continueOnViewChanged'] && !equalView(view, preView)) {\n                    // map's view is updated by another operation, animation should stop\n                    this._stopAnim(player);\n                    return;\n                }\n                if (frame.styles['center']) {\n                    const center = frame.styles['center'];\n                    this._setPrjCenter(projection.project(center));\n                    this.onMoving(this._parseEventFromCoord(this.getCenter()));\n                }\n                if (!isNil(frame.styles['zoom'])) {\n                    this.onZooming(frame.styles['zoom'], zoomOrigin);\n                }\n                if (!isNil(frame.styles['pitch'])) {\n                    this.setPitch(frame.styles['pitch']);\n                }\n                if (!isNil(frame.styles['bearing'])) {\n                    this.setBearing(frame.styles['bearing']);\n                }\n                preView = this.getView();\n                /**\n                 * fired when map is animating.  (panning, zooming, rotating)\n                 *\n                 * @event Map#animating\n                 * @type {Object}\n                 * @property {String} type - animating\n                 * @property {Map} target - the map fires the event\n                 */\n                this._fireEvent('animating');\n            } else if (player.playState === 'finished') {\n                if (!player._interupted) {\n                    if (props['center']) {\n                        this._setPrjCenter(projection.project(props['center'][1]));\n                    }\n                    if (!isNil(props['pitch'])) {\n                        this.setPitch(props['pitch'][1]);\n                    }\n                    if (!isNil(props['bearing'])) {\n                        this.setBearing(props['bearing'][1]);\n                    }\n                }\n                this._endAnim(player, props, zoomOrigin, options);\n                preView = this.getView();\n            }\n            if (step) {\n                step(frame);\n            }\n        });\n\n        this._startAnim(props, zoomOrigin);\n\n        return player;\n    },\n\n    /**\n     * Whether the map is animating with .animateTo\n     * @return {Boolean}\n     */\n    isAnimating() {\n        return !!(this._animPlayer);\n    },\n\n    isRotating() {\n        return this.isDragRotating() || !!this._animRotating;\n    },\n\n    _endAnim(player, props, zoomOrigin, options) {\n        delete this._animRotating;\n        /**\n         * fired when map's animation is interrupted by mouse event or else.\n         *\n         * @event Map#animateinterrupted\n         * @type {Object}\n         * @property {String} type - animateinterrupted\n         * @property {Map} target - the map fires the event\n         */\n        /**\n         * fired when map's animation ended (panning, zooming, rotating).\n         *\n         * @event Map#animateend\n         * @type {Object}\n         * @property {String} type - animateend\n         * @property {Map} target - the map fires the event\n         */\n        const evtType = player._interupted ? 'animateinterrupted' : 'animateend';\n        if (player === this._animPlayer) {\n            delete this._animPlayer;\n        }\n        if (props['center']) {\n            let endCoord;\n            if (player._interupted) {\n                endCoord = this.getCenter();\n            } else {\n                endCoord = props['center'][1];\n            }\n            this.onMoveEnd(this._parseEventFromCoord(endCoord));\n        }\n        if (!isNil(props['zoom'])) {\n            if (player._interupted) {\n                this.onZoomEnd(this.getZoom(), zoomOrigin);\n            } else if (!options['wheelZoom']) {\n                this.onZoomEnd(props['zoom'][1], zoomOrigin);\n            } else {\n                this.onZooming(props['zoom'][1], zoomOrigin);\n            }\n        }\n        if (evtType) {\n            this._fireEvent(evtType);\n        }\n        if (!isNil(props['pitch']) && !this.getPitch()) {\n            //https://github.com/maptalks/maptalks.js/issues/732\n            //fix blank map when pitch changes to 0\n            this.getRenderer().setToRedraw();\n        }\n    },\n\n    _startAnim(props, zoomOrigin) {\n        if (!this._animPlayer) {\n            return;\n        }\n        if (props['center']) {\n            this.onMoveStart();\n        }\n        if (props['zoom'] && !this.isZooming()) {\n            this.onZoomStart(props['zoom'][1], zoomOrigin);\n        }\n        if (props['pitch'] || props['bearing']) {\n            this._animRotating = true;\n        }\n        /**\n         * fired when map starts to animate (panning, zooming, rotating).\n         *\n         * @event Map#animatestart\n         * @type {Object}\n         * @property {String} type - animatestart\n         * @property {Map} target - the map fires the event\n         */\n        this._fireEvent('animatestart');\n        this._animPlayer.play();\n    },\n\n    _stopAnim(player) {\n        if (player && player.playState !== 'finished') {\n            player._interupted = true;\n            player.finish();\n        }\n    }\n});\n","import { now, extend } from '../core/util';\nimport {\n    addDomEvent,\n    removeDomEvent,\n    preventDefault,\n    getEventContainerPoint\n} from '../core/util/dom';\nimport Map from './Map';\n\nconst events =\n    /**\n     * mousedown event\n     * @event Map#mousedown\n     * @type {Object}\n     * @property {String} type                    - mousedown\n     * @property {Map} target            - the map fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'mousedown ' +\n    /**\n     * mouseup event\n     * @event Map#mouseup\n     * @type {Object}\n     * @property {String} type                    - mouseup\n     * @property {Map} target            - the map fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'mouseup ' +\n    /**\n     * mouseover event\n     * @event Map#mouseover\n     * @type {Object}\n     * @property {String} type                    - mouseover\n     * @property {Map} target            - the map fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'mouseover ' +\n    /**\n     * mouseout event\n     * @event Map#mouseout\n     * @type {Object}\n     * @property {String} type                    - mouseout\n     * @property {Map} target            - the map fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'mouseout ' +\n    /**\n     * mouseenter event\n     * @event Map#mouseenter\n     * @type {Object}\n     * @property {String} type                    - mouseenter\n     * @property {Map} target            - the map fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'mouseenter ' +\n    /**\n     * mouseleave event\n     * @event Map#mouseleave\n     * @type {Object}\n     * @property {String} type                    - mouseleave\n     * @property {Map} target            - the map fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'mouseleave ' +\n    /**\n     * mousemove event\n     * @event Map#mousemove\n     * @type {Object}\n     * @property {String} type                    - mousemove\n     * @property {Map} target            - the map fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'mousemove ' +\n    /**\n     * click event\n     * @event Map#click\n     * @type {Object}\n     * @property {String} type                    - click\n     * @property {Map} target            - the map fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'click ' +\n    /**\n     * dblclick event\n     * @event Map#dblclick\n     * @type {Object}\n     * @property {String} type                    - dblclick\n     * @property {Map} target            - the map fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'dblclick ' +\n    /**\n     * contextmenu event\n     * @event Map#contextmenu\n     * @type {Object}\n     * @property {String} type                    - contextmenu\n     * @property {Map} target            - the map fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'contextmenu ' +\n    /**\n     * keypress event\n     * @event Map#keypress\n     * @type {Object}\n     * @property {String} type                    - keypress\n     * @property {Map} target            - the map fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'keypress ' +\n    /**\n     * touchstart event\n     * @event Map#touchstart\n     * @type {Object}\n     * @property {String} type                    - touchstart\n     * @property {Map} target            - the map fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'touchstart ' +\n    /**\n     * touchmove event\n     * @event Map#touchmove\n     * @type {Object}\n     * @property {String} type                    - touchmove\n     * @property {Map} target            - the map fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'touchmove ' +\n    /**\n     * touchend event\n     * @event Map#touchend\n     * @type {Object}\n     * @property {String} type                    - touchend\n     * @property {Map} target            - the map fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'touchend ';\n\nMap.include(/** @lends Map.prototype */ {\n    _registerDomEvents() {\n        const dom = this._panels.mapWrapper || this._containerDOM;\n        addDomEvent(dom, events, this._handleDOMEvent, this);\n    },\n\n    _removeDomEvents() {\n        const dom = this._panels.mapWrapper || this._containerDOM;\n        removeDomEvent(dom, events, this._handleDOMEvent, this);\n    },\n\n    _handleDOMEvent(e) {\n        const type = e.type;\n        // prevent default contextmenu\n        if (type === 'contextmenu') {\n            preventDefault(e);\n        }\n        if (this._ignoreEvent(e)) {\n            return;\n        }\n        let mimicClick = false;\n        // ignore click lasted for more than 300ms.\n        if (type === 'mousedown' || (type === 'touchstart' && e.touches.length === 1)) {\n            this._mouseDownTime = now();\n        } else if ((type === 'click' || type === 'touchend' || type === 'contextmenu')) {\n            if (!this._mouseDownTime) {\n                //mousedown | touchstart propogation is stopped\n                //ignore the click/touchend/contextmenu\n                return;\n            } else {\n                const downTime = this._mouseDownTime;\n                delete this._mouseDownTime;\n                const time = now();\n                if (time - downTime > 300) {\n                    if (type === 'click' || type === 'contextmenu') {\n                        return;\n                    }\n                } else if (type === 'touchend') {\n                    mimicClick = true;\n                }\n            }\n        }\n        this._fireDOMEvent(this, e, type);\n        if (mimicClick) {\n            if (this._clickTime && (now() - this._clickTime <= 300)) {\n                delete this._clickTime;\n                this._fireDOMEvent(this, e, 'dblclick');\n            } else {\n                this._clickTime = now();\n                this._fireDOMEvent(this, e, 'click');\n            }\n        }\n    },\n\n    _ignoreEvent(domEvent) {\n        //ignore events originated from control and ui doms.\n        if (!domEvent || !this._panels.control) {\n            return false;\n        }\n        if (this._isEventOutMap(domEvent)) {\n            return true;\n        }\n        let target = domEvent.srcElement || domEvent.target;\n        let preTarget;\n        if (target) {\n            while (target && target !== this._containerDOM) {\n                if (target.className && target.className.indexOf &&\n                    (target.className.indexOf('maptalks-control') >= 0  || (target.className.indexOf('maptalks-ui') >= 0 && !preTarget['eventsPropagation']))) {\n                    return true;\n                }\n                preTarget = target;\n                target = target.parentNode;\n            }\n\n        }\n        return false;\n    },\n\n    _isEventOutMap(domEvent) {\n        if (this.getPitch() > this.options['maxVisualPitch']) {\n            const actualEvent = this._getActualEvent(domEvent);\n            const eventPos = getEventContainerPoint(actualEvent, this._containerDOM);\n            if (!this.getContainerExtent().contains(eventPos)) {\n                return true;\n            }\n        }\n        return false;\n    },\n\n    _parseEvent(e, type) {\n        if (!e) {\n            return null;\n        }\n        let eventParam = {\n            'domEvent': e\n        };\n        if (type !== 'keypress') {\n            const actual = this._getActualEvent(e);\n            if (actual) {\n                const containerPoint = getEventContainerPoint(actual, this._containerDOM);\n                eventParam = extend(eventParam, {\n                    'coordinate' : this.containerPointToCoord(containerPoint),\n                    'containerPoint' : containerPoint,\n                    'viewPoint' : this.containerPointToViewPoint(containerPoint),\n                    'point2d' : this._containerPointToPoint(containerPoint),\n                });\n            }\n        }\n        return eventParam;\n    },\n\n    _parseEventFromCoord(coord) {\n        const containerPoint = this.coordToContainerPoint(coord),\n            viewPoint = this.containerPointToViewPoint(containerPoint);\n        const e = {\n            'coordinate' : coord,\n            'containerPoint' : containerPoint,\n            'viewPoint' : viewPoint,\n            'point2d' : this.coordToPoint(coord)\n        };\n        return e;\n    },\n\n    _getActualEvent(e) {\n        return e.touches && e.touches.length > 0 ?\n            e.touches[0] : e.changedTouches && e.changedTouches.length > 0 ?\n                e.changedTouches[0] : e;\n    },\n\n    _fireDOMEvent(target, e, type) {\n        if (this.isRemoved()) {\n            return;\n        }\n        const eventParam = this._parseEvent(e, type);\n        this._fireEvent(type, eventParam);\n    }\n\n    // _onKeyPress(e) {\n    //     if (!this.isRemoved() && e.keyCode === 48 && e.ctrlKey) {\n    //         this.setBearing(0);\n    //     }\n    // }\n});\n\nMap.addOnLoadHook('_registerDomEvents');\n","import Map from './Map';\n\nMap.include(/** @lends Map.prototype */ {\n    /**\n     * @return {Boolean} Element is currently in fullscreen.\n     */\n    isFullScreen() {\n        return !!(\n            document.webkitIsFullScreen || document.mozFullScreen ||\n            document.msFullscreenElement || document.fullscreenElement\n        );\n    },\n\n    /**\n     * Request for the full screen\n     * @property {Object} dom -containerDOM to requestFullScreen\n     * @return {Map} this\n     * @fires Map#fullscreenstart\n     * @fires Map#fullscreenend\n     */\n    requestFullScreen(dom) {\n        /**\n         * fullscreenstart event\n         * @event Map#fullscreenstart\n         * @type {Object}\n         * @property {String} type                    - fullscreenstart\n         * @property {Map} target            - the map fires event\n         */\n        this._fireEvent('fullscreenstart');\n        this._requestFullScreen(dom || this._containerDOM);\n        /**\n         * fullscreenend event\n         * @event Map#fullscreenend\n         * @type {Object}\n         * @property {String} type                    - fullscreenend\n         * @property {Map} target            - the map fires event\n         */\n        this._fireEvent('fullscreenend');\n        return this;\n    },\n\n    /**\n     * Cancel full screen\n     * @return {Map} this\n     * @fires Map#cancelfullscreen\n     */\n    cancelFullScreen() {\n        this._cancelFullScreen();\n        /**\n         * cancelfullscreen event\n         * @event Map#cancelfullscreen\n         * @type {Object}\n         * @property {String} type                    - cancelfullscreen\n         * @property {Map} target            - the map fires event\n         */\n        this._fireEvent('cancelfullscreen');\n        return this;\n    },\n\n    _requestFullScreen(dom) {\n        if (dom.requestFullScreen) {\n            dom.requestFullScreen();\n        } else if (dom.mozRequestFullScreen) {\n            dom.mozRequestFullScreen();\n        } else if (dom.webkitRequestFullScreen) {\n            dom.webkitRequestFullScreen();\n        } else if (dom.msRequestFullScreen) {\n            dom.msRequestFullScreen();\n        } else {\n            const features = 'fullscreen=1,status=no,resizable=yes,top=0,left=0,scrollbars=no,' +\n                'titlebar=no,menubar=no,location=no,toolbar=no,z-look=yes,' +\n                'width=' + (screen.availWidth - 8) + ',height=' + (screen.availHeight - 45);\n            const newWin = window.open(location.href, '_blank', features);\n            if (newWin !== null) {\n                window.opener = null;\n                //close parent window\n                window.close();\n            }\n        }\n    },\n\n    _cancelFullScreen() {\n        if (document.cancelFullScreen) {\n            document.cancelFullScreen();\n        } else if (document.mozCancelFullScreen) {\n            document.mozCancelFullScreen();\n        } else if (document.webkitCancelFullScreen) {\n            document.webkitCancelFullScreen();\n        } else {\n            const features = 'fullscreen=no,status=yes,resizable=yes,scrollbars=no,' +\n                'titlebar=no,menubar=yes,location=yes,toolbar=yes,z-look=yes';\n            const newWin = window.open(location.href, '_blank', features);\n            if (newWin !== null) {\n                window.opener = null;\n                //close parent window\n                window.close();\n            }\n        }\n    }\n});\n","import Coordinate from '../geo/Coordinate';\nimport Point from '../geo/Point';\nimport Map from './Map';\nimport { isFunction } from '../core/util';\n\nMap.include(/** @lends Map.prototype */ {\n\n    /**\n     * Pan to the given coordinate\n     * @param {Coordinate} coordinate - coordinate to pan to\n     * @param {Object} [options=null] - pan options\n     * @param {Boolean} [options.animation=null] - whether pan with animation\n     * @param {Boolean} [options.duration=600] - pan animation duration\n     * @return {Map} this\n     */\n    panTo: function (coordinate, options = {}, step) {\n        if (!coordinate) {\n            return this;\n        }\n        if (isFunction(options)) {\n            step = options;\n            options = {};\n        }\n        coordinate = new Coordinate(coordinate);\n        if (typeof (options['animation']) === 'undefined' || options['animation']) {\n            return this._panAnimation(coordinate, options['duration'], step);\n        } else {\n            this.setCenter(coordinate);\n            return this;\n        }\n    },\n\n    /**\n     * Pan the map by the give point\n     * @param  {Point} point - distance to pan, in pixel\n     * @param {Object} [options=null] - pan options\n     * @param {Boolean} [options.animation=null] - whether pan with animation\n     * @param {Boolean} [options.duration=600] - pan animation duration\n     * @return {Map} this\n     */\n    panBy: function (offset, options = {}, step) {\n        if (!offset) {\n            return this;\n        }\n        if (isFunction(options)) {\n            step = options;\n            options = {};\n        }\n        offset = new Point(offset);\n        this.onMoveStart();\n        if (typeof (options['animation']) === 'undefined' || options['animation']) {\n            offset = offset.multi(-1);\n            const target = this.locateByPoint(this.getCenter(), offset.x, offset.y);\n            this._panAnimation(target, options['duration'], step);\n        } else {\n            this._offsetCenterByPixel(offset);\n            this.onMoveEnd(this._parseEventFromCoord(this.getCenter()));\n        }\n        return this;\n    },\n\n    _panAnimation: function (target, t, cb) {\n        return this.animateTo({\n            'center': target\n        }, {\n            'duration': t || this.options['panAnimationDuration'],\n        }, cb);\n    }\n});\n","/** Profile **/\nimport {\n    extend,\n    isNil,\n    isObject,\n    isArrayHasData\n} from '../core/util';\nimport Layer from '../layer/Layer';\nimport Map from './Map';\nimport Geometry from '../geometry/Geometry';\nimport GeoJSON from '../geometry/GeoJSON';\n\n/**\n * Produce a geometry from one or more [JSON]{@link Geometry#toJSON} or GeoJSON.\n * @param  {Object} json - a geometry's JSON or a geojson\n * @return {Geometry} geometry\n * @example\n * var profile = {\n        \"feature\": {\n              \"type\": \"Feature\",\n              \"id\" : \"point1\",\n              \"geometry\": {\"type\": \"Point\", \"coordinates\": [102.0, 0.5]},\n              \"properties\": {\"prop0\": \"value0\"}\n        },\n        //construct options.\n        \"options\":{\n            \"draggable\" : true\n        },\n        //symbol\n        \"symbol\":{\n            \"markerFile\"  : \"http://foo.com/icon.png\",\n            \"markerWidth\" : 20,\n            \"markerHeight\": 20\n        }\n    };\n    const marker = Geometry.fromJSON(profile);\n */\nGeometry.fromJSON = function (json) {\n    if (Array.isArray(json)) {\n        let result = [];\n        for (let i = 0, len = json.length; i < len; i++) {\n            const c = Geometry.fromJSON(json[i]);\n            if (Array.isArray(json)) {\n                result = result.concat(c);\n            } else {\n                result.push(c);\n            }\n        }\n        return result;\n    }\n\n    if (json && !json['feature']) {\n        return GeoJSON.toGeometry(json);\n    }\n    let geometry;\n    if (json['subType']) {\n        geometry = Geometry.getJSONClass(json['subType']).fromJSON(json);\n        if (!isNil(json['feature']['id'])) {\n            geometry.setId(json['feature']['id']);\n        }\n    } else {\n        geometry = GeoJSON.toGeometry(json['feature']);\n        if (json['options']) {\n            geometry.config(json['options']);\n        }\n    }\n    if (json['symbol']) {\n        geometry.setSymbol(json['symbol']);\n    }\n    if (json['infoWindow']) {\n        geometry.setInfoWindow(json['infoWindow']);\n    }\n    return geometry;\n};\n\n/**\n * Reproduce a Layer from layer's JSON.\n * @param  {Object} layerJSON - layer's JSON\n * @return {Layer}\n */\nLayer.fromJSON = function (layerJSON) {\n    if (!layerJSON) {\n        return null;\n    }\n    const layerType = layerJSON['type'];\n    const clazz = Layer.getJSONClass(layerType);\n    if (!clazz || !clazz.fromJSON) {\n        throw new Error('unsupported layer type:' + layerType);\n    }\n    return clazz.fromJSON(layerJSON);\n};\n\nMap.include(/** @lends Map.prototype */ {\n    /**\n     * @property {String}  - Version of the [JSON]{@link Map#toJSON} schema.\n     * @constant\n     * @static\n     */\n    'JSON_VERSION': '1.0',\n    /**\n     * Export the map's json, a snapshot of the map in JSON format.<br>\n     * It can be used to reproduce the instance by [fromJSON]{@link Map#fromJSON} method\n     * @param  {Object} [options=null] - export options\n     * @param  {Boolean|Object} [options.baseLayer=null] - whether to export base layer's JSON, if yes, it will be used as layer's toJSON options.\n     * @param  {Boolean|Extent} [options.clipExtent=null] - if set with an extent instance, only the geometries intersectes with the extent will be exported.\n     *                                                             If set to true, map's current extent will be used.\n     * @param  {Boolean|Object|Object[]} [options.layers=null] - whether to export other layers' JSON, if yes, it will be used as layer's toJSON options.\n     *                                                        It can also be an array of layer export options with a \"id\" attribute to filter the layers to export.\n     * @return {Object} layer's JSON\n     */\n    toJSON: function (options) {\n        if (!options) {\n            options = {};\n        }\n        const json = {\n            'jsonVersion': this['JSON_VERSION'],\n            'version': this.VERSION,\n            'extent': this.getExtent().toJSON()\n        };\n        json['options'] = this.config();\n        json['options']['center'] = this.getCenter();\n        json['options']['zoom'] = this.getZoom();\n\n        const baseLayer = this.getBaseLayer();\n        if ((isNil(options['baseLayer']) || options['baseLayer']) && baseLayer) {\n            json['baseLayer'] = baseLayer.toJSON(options['baseLayer']);\n        }\n        const extraLayerOptions = {};\n        if (options['clipExtent']) {\n            //if clipExtent is set, only geometries intersecting with extent will be exported.\n            //clipExtent's value can be an extent or true (map's current extent)\n            if (options['clipExtent'] === true) {\n                extraLayerOptions['clipExtent'] = this.getExtent();\n            } else {\n                extraLayerOptions['clipExtent'] = options['clipExtent'];\n            }\n        }\n        const layersJSON = [];\n        if (isNil(options['layers']) || (options['layers'] && !Array.isArray(options['layers']))) {\n            const layers = this.getLayers();\n            for (let i = 0, len = layers.length; i < len; i++) {\n                if (!layers[i].toJSON) {\n                    continue;\n                }\n                const opts = extend({}, isObject(options['layers']) ? options['layers'] : {}, extraLayerOptions);\n                layersJSON.push(layers[i].toJSON(opts));\n            }\n            json['layers'] = layersJSON;\n        } else if (isArrayHasData(options['layers'])) {\n            const layers = options['layers'];\n            for (let i = 0; i < layers.length; i++) {\n                const exportOption = layers[i];\n                const layer = this.getLayer(exportOption['id']);\n                if (!layer.toJSON) {\n                    continue;\n                }\n                const opts = extend({}, exportOption['options'], extraLayerOptions);\n                layersJSON.push(layer.toJSON(opts));\n            }\n            json['layers'] = layersJSON;\n        } else {\n            json['layers'] = [];\n        }\n        return json;\n    }\n});\n\n/**\n * Reproduce a map from map's profile JSON.\n * @param {(string|HTMLElement|object)} container - The container to create the map on, can be:<br>\n *                                          1. A HTMLElement container.<br/>\n *                                          2. ID of a HTMLElement container.<br/>\n *                                          3. A canvas compatible container in node,\n *                                          e.g. [node-canvas]{@link https://github.com/Automattic/node-canvas},\n *                                              [canvas2svg]{@link https://github.com/gliffy/canvas2svg}\n * @param  {Object} mapJSON - map's profile JSON\n * @param  {Object} [options=null] - options\n * @param  {Object} [options.baseLayer=null] - whether to import the baseLayer\n * @param  {Object} [options.layers=null]    - whether to import the layers\n * @return {Map}\n * @static\n * @function\n * @example\n * var map = Map.fromJSON('map', mapProfile);\n */\nMap.fromJSON = function (container, profile, options) {\n    if (!container || !profile) {\n        return null;\n    }\n    if (!options) {\n        options = {};\n    }\n    const map = new Map(container, profile['options']);\n    if (isNil(options['baseLayer']) || options['baseLayer']) {\n        const baseLayer = Layer.fromJSON(profile['baseLayer']);\n        if (baseLayer) {\n            map.setBaseLayer(baseLayer);\n        }\n    }\n    if (isNil(options['layers']) || options['layers']) {\n        const layers = [];\n        const layerJSONs = profile['layers'];\n        for (let i = 0; i < layerJSONs.length; i++) {\n            const layer = Layer.fromJSON(layerJSONs[i]);\n            layers.push(layer);\n        }\n        map.addLayer(layers);\n    }\n\n    return map;\n};\n","import { INTERNAL_LAYER_PREFIX } from '../core/Constants';\nimport { extend, isString, isArrayHasData, pushIn } from '../core/util';\nimport Coordinate from '../geo/Coordinate';\nimport Map from './Map';\n\n/**\n * Methods of topo computations\n */\nMap.include(/** @lends Map.prototype */ {\n    /**\n     * Caculate distance of two coordinates.\n     * @param {Number[]|Coordinate} coord1 - coordinate 1\n     * @param {Number[]|Coordinate} coord2 - coordinate 2\n     * @return {Number} distance, unit is meter\n     * @example\n     * var distance = map.computeLength([0, 0], [0, 20]);\n     */\n    computeLength: function (coord1, coord2) {\n        if (!this.getProjection()) {\n            return null;\n        }\n        const p1 = new Coordinate(coord1),\n            p2 = new Coordinate(coord2);\n        if (p1.equals(p2)) {\n            return 0;\n        }\n        return this.getProjection().measureLength(p1, p2);\n    },\n\n    /**\n     * Caculate a geometry's length.\n     * @param {Geometry} geometry - geometry to caculate\n     * @return {Number} length, unit is meter\n     */\n    computeGeometryLength: function (geometry) {\n        return geometry._computeGeodesicLength(this.getProjection());\n    },\n\n    /**\n     * Caculate a geometry's area.\n     * @param  {Geometry} geometry - geometry to caculate\n     * @return {Number} area, unit is sq.meter\n     */\n    computeGeometryArea: function (geometry) {\n        return geometry._computeGeodesicArea(this.getProjection());\n    },\n\n    /**\n     * Identify the geometries on the given coordinate.\n     * @param {Object} opts - the identify options\n     * @param {Coordinate} opts.coordinate - coordinate to identify\n     * @param {Object}   opts.layers        - the layers to perform identify on.\n     * @param {Function} [opts.filter=null] - filter function of the result geometries, return false to exclude.\n     * @param {Number}   [opts.count=null]  - limit of the result count.\n     * @param {Number}   [opts.tolerance=0] - identify tolerance in pixel.\n     * @param {Boolean}  [opts.includeInternals=false] - whether to identify internal layers.\n     * @param {Boolean}  [opts.includeInvisible=false] - whether to identify invisible layers.\n     * @param {Function} callback           - the callback function using the result geometries as the parameter.\n     * @return {Map} this\n     * @example\n     * map.identify({\n     *      coordinate: [0, 0],\n     *      layers: [layer]\n     *  },\n     *  geos => {\n     *      console.log(geos);\n     *  });\n     */\n    identify: function (opts, callback) {\n        if (!opts) {\n            return this;\n        }\n        const reqLayers = opts['layers'];\n        if (!isArrayHasData(reqLayers)) {\n            return this;\n        }\n        const layers = [];\n        for (let i = 0, len = reqLayers.length; i < len; i++) {\n            if (isString(reqLayers[i])) {\n                layers.push(this.getLayer(reqLayers[i]));\n            } else {\n                layers.push(reqLayers[i]);\n            }\n        }\n        const coordinate = new Coordinate(opts['coordinate']);\n        const options = extend({}, opts);\n        const hits = [];\n        for (let i = layers.length - 1; i >= 0; i--) {\n            if (opts['count'] && hits.length >= opts['count']) {\n                break;\n            }\n            const layer = layers[i];\n            if (!layer || !layer.getMap() || (!opts['includeInvisible'] && !layer.isVisible()) || (!opts['includeInternals'] && layer.getId().indexOf(INTERNAL_LAYER_PREFIX) >= 0)) {\n                continue;\n            }\n            const layerHits = layer.identify(coordinate, options);\n            if (layerHits) {\n                if (Array.isArray(layerHits)) {\n                    pushIn(hits, layerHits);\n                } else {\n                    hits.push(layerHits);\n                }\n            }\n        }\n        callback.call(this, hits);\n        return this;\n    }\n\n});\n","import { isNil } from '../core/util';\nimport Point from '../geo/Point';\nimport Map from './Map';\n\nMap.include(/** @lends Map.prototype */{\n\n    _zoom(nextZoom, origin) {\n        if (!this.options['zoomable'] || this.isZooming()) { return; }\n        origin = this._checkZoomOrigin(origin);\n        nextZoom = this._checkZoom(nextZoom);\n        this.onZoomStart(nextZoom, origin);\n        this._frameZoom = this.getZoom();\n        this.onZoomEnd(nextZoom, origin);\n    },\n\n    _zoomAnimation(nextZoom, origin, startScale) {\n        if (!this.options['zoomable'] || this.isZooming()) { return; }\n\n        nextZoom = this._checkZoom(nextZoom);\n        if (this.getZoom() === nextZoom) {\n            return;\n        }\n        origin = this._checkZoomOrigin(origin);\n        this._startZoomAnim(nextZoom, origin, startScale);\n    },\n\n    _checkZoomOrigin(origin) {\n        if (!origin || this.options['zoomInCenter']) {\n            origin = new Point(this.width / 2, this.height / 2);\n        }\n        return origin;\n    },\n\n    _startZoomAnim(nextZoom, origin, startScale) {\n        if (isNil(startScale)) {\n            startScale = 1;\n        }\n        const endScale = this._getResolution(this._startZoomVal) / this._getResolution(nextZoom);\n        const duration = this.options['zoomAnimationDuration'] * Math.abs(endScale - startScale) / Math.abs(endScale - 1);\n        this._frameZoom = this._startZoomVal;\n        this.animateTo({\n            'zoom' : nextZoom,\n            'around' : origin\n        }, {\n            'continueOnViewChanged' : true,\n            'duration' : duration\n        });\n    },\n\n    onZoomStart(nextZoom, origin) {\n        if (!this.options['zoomable'] || this.isZooming()) { return; }\n        this._zooming = true;\n        this._startZoomVal = this.getZoom();\n        this._startZoomCoord = this._containerPointToPrj(origin);\n        /**\n          * zoomstart event\n          * @event Map#zoomstart\n          * @type {Object}\n          * @property {String} type                    - zoomstart\n          * @property {Map} target                     - the map fires event\n          * @property {Number} from                    - zoom level zooming from\n          * @property {Number} to                      - zoom level zooming to\n          */\n        this._fireEvent('zoomstart', { 'from' : this._startZoomVal, 'to': nextZoom });\n    },\n\n    onZooming(nextZoom, origin, startScale) {\n        if (!this.options['zoomable']) { return; }\n        const frameZoom = this._frameZoom;\n        if (frameZoom === nextZoom) {\n            return;\n        }\n        if (isNil(startScale)) {\n            startScale = 1;\n        }\n        this._zoomTo(nextZoom, origin);\n        const res = this.getResolution(nextZoom),\n            fromRes = this.getResolution(this._startZoomVal),\n            scale = fromRes / res / startScale,\n            startPoint = this._prjToContainerPoint(this._startZoomCoord, this._startZoomVal);\n        const offset = this.getViewPoint();\n        if (!this.isRotating() && !startPoint.equals(origin) && scale !== 1) {\n            const pitch = this.getPitch();\n            // coordinate at origin changed, usually by map.setCenter\n            // add origin offset\n            const originOffset = startPoint._sub(origin)._multi(1 / (1 - scale));\n            if (pitch) {\n                //FIXME Math.cos(pitch * Math.PI / 180) is just a magic num, works when tilting but may have problem when rotating\n                originOffset.y /= Math.cos(pitch * Math.PI / 180);\n            }\n            origin = origin.add(originOffset);\n        }\n        const matrix = {\n            'view' : [scale, 0, 0, scale, (origin.x - offset.x) *  (1 - scale), (origin.y - offset.y) *  (1 - scale)]\n        };\n        const dpr = this.getDevicePixelRatio();\n        if (dpr !== 1) {\n            origin = origin.multi(dpr);\n        }\n        matrix['container'] = [scale, 0, 0, scale, origin.x * (1 - scale), origin.y *  (1 - scale)];\n        /**\n          * zooming event\n          * @event Map#zooming\n          * @type {Object}\n          * @property {String} type                    - zooming\n          * @property {Map} target                     - the map fires event\n          * @property {Number} from                    - zoom level zooming from\n          * @property {Number} to                      - zoom level zooming to\n          */\n        this._fireEvent('zooming', { 'from' : this._startZoomVal, 'to': nextZoom, 'origin' : origin, 'matrix' : matrix });\n        this._frameZoom = nextZoom;\n    },\n\n    onZoomEnd(nextZoom, origin) {\n        if (!this.options['zoomable']) { return; }\n        const startZoomVal = this._startZoomVal;\n        this._zoomTo(nextZoom, origin);\n        this._zooming = false;\n        this._getRenderer().onZoomEnd();\n\n        /**\n          * zoomend event\n          * @event Map#zoomend\n          * @type {Object}\n          * @property {String} type                    - zoomend\n          * @property {Map} target                     - the map fires event\n          * @property {Number} from                    - zoom level zooming from\n          * @property {Number} to                      - zoom level zooming to\n          */\n        this._fireEvent('zoomend', { 'from' : startZoomVal, 'to': nextZoom });\n        if (!this._verifyExtent(this.getCenter())) {\n            this.panTo(this.getMaxExtent().getCenter());\n        }\n    },\n\n    _zoomTo(nextZoom, origin) {\n        this._zoomLevel = nextZoom;\n        this._calcMatrices();\n        if (origin) {\n            this._setPrjCoordAtContainerPoint(this._startZoomCoord, origin);\n        }\n    },\n\n    _checkZoom(nextZoom) {\n        const maxZoom = this.getMaxZoom(),\n            minZoom = this.getMinZoom();\n        if (nextZoom < minZoom) {\n            nextZoom = minZoom;\n        }\n        if (nextZoom > maxZoom) {\n            nextZoom = maxZoom;\n        }\n        return nextZoom;\n    }\n});\n","/*eslint-disable no-var*/\n// Contains code from glmatrix.js\n\nexport function perspective(out, fovy, aspect, near, far) {\n    var f = 1.0 / Math.tan(fovy / 2),\n        nf = 1 / (near - far);\n    out[0] = f / aspect;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[5] = f;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[10] = (far + near) * nf;\n    out[11] = -1;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 2 * far * near * nf;\n    out[15] = 0;\n    return out;\n}\n\nexport function translate(out, a, v) {\n    var x = v[0],\n        y = v[1],\n        z = v[2],\n        a00,\n        a01,\n        a02,\n        a03,\n        a10,\n        a11,\n        a12,\n        a13,\n        a20,\n        a21,\n        a22,\n        a23;\n\n    if (a === out) {\n        out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n        out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n        out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n        out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n    } else {\n        a00 = a[0]; a01 = a[1]; a02 = a[2]; a03 = a[3];\n        a10 = a[4]; a11 = a[5]; a12 = a[6]; a13 = a[7];\n        a20 = a[8]; a21 = a[9]; a22 = a[10]; a23 = a[11];\n\n        out[0] = a00; out[1] = a01; out[2] = a02; out[3] = a03;\n        out[4] = a10; out[5] = a11; out[6] = a12; out[7] = a13;\n        out[8] = a20; out[9] = a21; out[10] = a22; out[11] = a23;\n\n        out[12] = a00 * x + a10 * y + a20 * z + a[12];\n        out[13] = a01 * x + a11 * y + a21 * z + a[13];\n        out[14] = a02 * x + a12 * y + a22 * z + a[14];\n        out[15] = a03 * x + a13 * y + a23 * z + a[15];\n    }\n\n    return out;\n}\n\nexport function scale(out, a, v) {\n    var x = v[0],\n        y = v[1],\n        z = v[2];\n\n    out[0] = a[0] * x;\n    out[1] = a[1] * x;\n    out[2] = a[2] * x;\n    out[3] = a[3] * x;\n    out[4] = a[4] * y;\n    out[5] = a[5] * y;\n    out[6] = a[6] * y;\n    out[7] = a[7] * y;\n    out[8] = a[8] * z;\n    out[9] = a[9] * z;\n    out[10] = a[10] * z;\n    out[11] = a[11] * z;\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n    return out;\n}\n\nexport function rotateX(out, a, rad) {\n    var s = Math.sin(rad),\n        c = Math.cos(rad),\n        a10 = a[4],\n        a11 = a[5],\n        a12 = a[6],\n        a13 = a[7],\n        a20 = a[8],\n        a21 = a[9],\n        a22 = a[10],\n        a23 = a[11];\n\n    if (a !== out) {\n        out[0] = a[0];\n        out[1] = a[1];\n        out[2] = a[2];\n        out[3] = a[3];\n        out[12] = a[12];\n        out[13] = a[13];\n        out[14] = a[14];\n        out[15] = a[15];\n    }\n\n    out[4] = a10 * c + a20 * s;\n    out[5] = a11 * c + a21 * s;\n    out[6] = a12 * c + a22 * s;\n    out[7] = a13 * c + a23 * s;\n    out[8] = a20 * c - a10 * s;\n    out[9] = a21 * c - a11 * s;\n    out[10] = a22 * c - a12 * s;\n    out[11] = a23 * c - a13 * s;\n    return out;\n}\n\nexport function rotateZ(out, a, rad) {\n    var s = Math.sin(rad),\n        c = Math.cos(rad),\n        a00 = a[0],\n        a01 = a[1],\n        a02 = a[2],\n        a03 = a[3],\n        a10 = a[4],\n        a11 = a[5],\n        a12 = a[6],\n        a13 = a[7];\n\n    if (a !== out) {\n        out[8] = a[8];\n        out[9] = a[9];\n        out[10] = a[10];\n        out[11] = a[11];\n        out[12] = a[12];\n        out[13] = a[13];\n        out[14] = a[14];\n        out[15] = a[15];\n    }\n\n    out[0] = a00 * c + a10 * s;\n    out[1] = a01 * c + a11 * s;\n    out[2] = a02 * c + a12 * s;\n    out[3] = a03 * c + a13 * s;\n    out[4] = a10 * c - a00 * s;\n    out[5] = a11 * c - a01 * s;\n    out[6] = a12 * c - a02 * s;\n    out[7] = a13 * c - a03 * s;\n    return out;\n}\n\n/* export function copy(out, a) {\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n    return out;\n} */\n\nexport function multiply(out, a, b) {\n    var a00 = a[0],\n        a01 = a[1],\n        a02 = a[2],\n        a03 = a[3],\n        a10 = a[4],\n        a11 = a[5],\n        a12 = a[6],\n        a13 = a[7],\n        a20 = a[8],\n        a21 = a[9],\n        a22 = a[10],\n        a23 = a[11],\n        a30 = a[12],\n        a31 = a[13],\n        a32 = a[14],\n        a33 = a[15];\n\n    // Cache only the current line of the second matrix\n    var b0 = b[0],\n        b1 = b[1],\n        b2 = b[2],\n        b3 = b[3];\n    out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n    out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n    out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n    out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n\n    b0 = b[4]; b1 = b[5]; b2 = b[6]; b3 = b[7];\n    out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n    out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n    out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n    out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n\n    b0 = b[8]; b1 = b[9]; b2 = b[10]; b3 = b[11];\n    out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n    out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n    out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n    out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n\n    b0 = b[12]; b1 = b[13]; b2 = b[14]; b3 = b[15];\n    out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n    out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n    out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n    out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n    return out;\n}\n\nexport function invert(out, a) {\n    var a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3],\n        a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7],\n        a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11],\n        a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15],\n\n        b00 = a00 * a11 - a01 * a10,\n        b01 = a00 * a12 - a02 * a10,\n        b02 = a00 * a13 - a03 * a10,\n        b03 = a01 * a12 - a02 * a11,\n        b04 = a01 * a13 - a03 * a11,\n        b05 = a02 * a13 - a03 * a12,\n        b06 = a20 * a31 - a21 * a30,\n        b07 = a20 * a32 - a22 * a30,\n        b08 = a20 * a33 - a23 * a30,\n        b09 = a21 * a32 - a22 * a31,\n        b10 = a21 * a33 - a23 * a31,\n        b11 = a22 * a33 - a23 * a32,\n\n        // Calculate the determinant\n        det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n    if (!det) {\n        return null;\n    }\n    det = 1.0 / det;\n\n    out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n    out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n    out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n    out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n    out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n    out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n    out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n    out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n    out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n    out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n    out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n    out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n    out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n    out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n    out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n    out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n\n    return out;\n}\n\n/**\n * Set a mat4 to the identity matrix\n *\n * @param {mat4} out the receiving matrix\n * @returns {mat4} out\n */\nexport function identity(out) {\n    out[0] = 1;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[5] = 1;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[10] = 1;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n    out[15] = 1;\n    return out;\n}\n/*eslint-enable no-var*/\n","/**\n * Set the components of a vec3 to the given values\n *\n * @param {vec3} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} out\n */\nexport function set(out, x, y, z) {\n    out[0] = x;\n    out[1] = y;\n    out[2] = z;\n    return out;\n}\n\n/**\n * Adds two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nexport function add(out, a, b) {\n    out[0] = a[0] + b[0];\n    out[1] = a[1] + b[1];\n    out[2] = a[2] + b[2];\n    return out;\n}\n\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nexport function subtract(out, a, b) {\n    out[0] = a[0] - b[0];\n    out[1] = a[1] - b[1];\n    out[2] = a[2] - b[2];\n    return out;\n}\n\n/**\n * Calculates the length of a vec3\n *\n * @param {vec3} a vector to calculate length of\n * @returns {Number} length of a\n */\nexport function length(a) {\n    const x = a[0],\n        y = a[1],\n        z = a[2];\n    return Math.sqrt(x * x + y * y + z * z);\n}\n\n/**\n * Normalize a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to normalize\n * @returns {vec3} out\n */\nexport function normalize(out, a) {\n    const x = a[0],\n        y = a[1],\n        z = a[2];\n    let len = x * x + y * y + z * z;\n    if (len > 0) {\n        //TODO: evaluate use of glm_invsqrt here?\n        len = 1 / Math.sqrt(len);\n        out[0] = a[0] * len;\n        out[1] = a[1] * len;\n        out[2] = a[2] * len;\n    }\n    return out;\n}\n\n/**\n * Calculates the dot product of two vec3's\n *\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {Number} dot product of a and b\n */\nexport function dot(a, b) {\n    return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n\n/**\n * Scales a vec3 by a scalar number\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec3} out\n */\nexport function scale(out, a, b) {\n    out[0] = a[0] * b;\n    out[1] = a[1] * b;\n    out[2] = a[2] * b;\n    return out;\n}\n\n/**\n * Computes the cross product of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nexport function cross(out, a, b) {\n    const ax = a[0], ay = a[1], az = a[2],\n        bx = b[0], by = b[1], bz = b[2];\n\n    out[0] = ay * bz - az * by;\n    out[1] = az * bx - ax * bz;\n    out[2] = ax * by - ay * bx;\n    return out;\n}\n","import { subtract, length, normalize, cross } from './vec3';\n//contains code from THREE.js\n\nexport function applyMatrix(out, v, e) {\n    const x = v[0], y = v[1], z = v[2];\n    // const e = in;\n\n    const w = 1 / (e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ]);\n\n    out[0] = (e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z + e[ 12 ]) * w;\n    out[1] = (e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z + e[ 13 ]) * w;\n    out[2] = (e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ]) * w;\n\n    return out;\n}\n\nexport function applyMatrix4(out, v, e) {\n    const x = v[0], y = v[1], z = v[2], w = v[3];\n\n    out[0] = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z + e[ 12 ] * w;\n    out[1] = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z + e[ 13 ] * w;\n    out[2] = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ] * w;\n    out[3] = e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ] * w;\n\n    return this;\n\n}\n\nexport function matrixToQuaternion(out, te) {\n    // http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToQuaternion/index.htm\n\n    // assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\n    const m11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ],\n        m21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ],\n        m31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ],\n\n        trace = m11 + m22 + m33;\n    let s;\n\n    if (trace > 0) {\n\n        s = 0.5 / Math.sqrt(trace + 1.0);\n\n        out.w = 0.25 / s;\n        out.x = (m32 - m23) * s;\n        out.y = (m13 - m31) * s;\n        out.z = (m21 - m12) * s;\n\n    } else if (m11 > m22 && m11 > m33) {\n\n        s = 2.0 * Math.sqrt(1.0 + m11 - m22 - m33);\n\n        out.w = (m32 - m23) / s;\n        out.x = 0.25 * s;\n        out.y = (m12 + m21) / s;\n        out.z = (m13 + m31) / s;\n\n    } else if (m22 > m33) {\n\n        s = 2.0 * Math.sqrt(1.0 + m22 - m11 - m33);\n\n        out.w = (m13 - m31) / s;\n        out.x = (m12 + m21) / s;\n        out.y = 0.25 * s;\n        out.z = (m23 + m32) / s;\n\n    } else {\n\n        s = 2.0 * Math.sqrt(1.0 + m33 - m11 - m22);\n\n        out.w = (m21 - m12) / s;\n        out.x = (m13 + m31) / s;\n        out.y = (m23 + m32) / s;\n        out.z = 0.25 * s;\n\n    }\n\n    return this;\n}\n\nexport function quaternionToMatrix(out, q) {\n    const te = out;\n\n    const x = q.x, y = q.y, z = q.z, w = q.w;\n    const x2 = x + x, y2 = y + y, z2 = z + z;\n    const xx = x * x2, xy = x * y2, xz = x * z2;\n    const yy = y * y2, yz = y * z2, zz = z * z2;\n    const wx = w * x2, wy = w * y2, wz = w * z2;\n\n    te[ 0 ] = 1 - (yy + zz);\n    te[ 4 ] = xy - wz;\n    te[ 8 ] = xz + wy;\n\n    te[ 1 ] = xy + wz;\n    te[ 5 ] = 1 - (xx + zz);\n    te[ 9 ] = yz - wx;\n\n    te[ 2 ] = xz - wy;\n    te[ 6 ] = yz + wx;\n    te[ 10 ] = 1 - (xx + yy);\n\n    // last column\n    te[ 3 ] = 0;\n    te[ 7 ] = 0;\n    te[ 11 ] = 0;\n\n    // bottom row\n    te[ 12 ] = 0;\n    te[ 13 ] = 0;\n    te[ 14 ] = 0;\n    te[ 15 ] = 1;\n\n    return te;\n}\n\nexport function setPosition(out, v) {\n    const te = out;\n\n    te[ 12 ] = v[0];\n    te[ 13 ] = v[1];\n    te[ 14 ] = v[2];\n\n    return out;\n}\n\nexport function lookAt(te, eye, target, up) {\n    const x = [0, 0, 0];\n    const y = [0, 0, 0];\n    const z = [0, 0, 0];\n    subtract(z, eye, target);\n\n    if (length(z) === 0) {\n\n        // eye and target are in the same position\n\n        z[2] = 1;\n\n    }\n\n    normalize(z, z);\n    cross(x, up, z);\n\n    if (length(z) === 0) {\n\n        // up and z are parallel\n\n        if (Math.abs(up[2]) === 1) {\n\n            z[0] += 0.0001;\n\n        } else {\n\n            z[2] += 0.0001;\n\n        }\n\n        normalize(z, z);\n        cross(x, up, z);\n\n    }\n\n    normalize(x, x);\n    cross(y, z, x);\n\n    te[ 0 ] = x[0]; te[ 4 ] = y[0]; te[ 8 ] = z[0];\n    te[ 1 ] = x[1]; te[ 5 ] = y[1]; te[ 9 ] = z[1];\n    te[ 2 ] = x[2]; te[ 6 ] = y[2]; te[ 10 ] = z[2];\n\n    return te;\n}\n","import Map from './Map';\nimport Point from '../geo/Point';\nimport Coordinate from '../geo/Coordinate';\nimport * as mat4 from '../core/util/mat4';\nimport { subtract, add, scale, normalize, dot, set } from '../core/util/vec3';\nimport { clamp, interpolate, wrap } from '../core/util';\nimport { applyMatrix, matrixToQuaternion, quaternionToMatrix, lookAt, setPosition } from '../core/util/math';\nimport Browser from '../core/Browser';\n\nconst RADIAN = Math.PI / 180;\nconst DEFAULT_FOV = 0.6435011087932844;\nconst TEMP_COORD = new Coordinate(0, 0);\n\n/*!\n * contains code from mapbox-gl-js\n * https://github.com/mapbox/mapbox-gl-js\n * LICENSE : MIT\n * (c) mapbox\n *\n */\n\nMap.include(/** @lends Map.prototype */{\n    /**\n     * Get map's fov (field of view);\n     * @return {Number} fov in degree\n     */\n    getFov() {\n        if (!this._fov) {\n            this._fov = DEFAULT_FOV;\n        }\n        return this._fov / RADIAN;\n    },\n\n    /**\n     * Set a new fov to map\n     * @param {Number} fov new fov in degree\n     * @return {Map} this\n     */\n    setFov(fov) {\n        if (this.isZooming()) {\n            return this;\n        }\n        fov = Math.max(0.01, Math.min(60, fov));\n        if (this._fov === fov) return this;\n        const from = this.getFov();\n        this._fov = fov * RADIAN;\n        this._calcMatrices();\n        this._renderLayers();\n        /*\n          * fovchange event\n          * @event Map#fovchange\n          * @type {Object}\n          * @property {String} type                    - fovchange\n          * @property {Map} target                     - the map fires event\n          * @property {Number} from                    - fovchange from\n          * @property {Number} to                      - fovchange to\n        */\n        this._fireEvent('fovchange', { 'from' : from, 'to': this.getFov() });\n        return this;\n    },\n\n    /**\n     * Get map's bearing\n     * @return {Number} bearing in degree\n     */\n    getBearing() {\n        if (!this._angle) {\n            return 0;\n        }\n        return -this._angle / RADIAN;\n    },\n\n    /**\n     * Set a new bearing to map\n     * @param {Number} bearing new bearing in degree\n     * @return {Map} this\n     */\n    setBearing(bearing) {\n        if (Browser.ie9) {\n            throw new Error('map can\\'t rotate in IE9.');\n        }\n        const b = -wrap(bearing, -180, 180) * RADIAN;\n        if (this._angle === b) return this;\n        const from = this.getBearing();\n        /*\n          * rotate event\n          * @event Map#rotatestart\n          * @type {Object}\n          * @property {String} type                    - rotatestart\n          * @property {Map} target                     - the map fires event\n          * @property {Number} from                    - bearing rotate from\n          * @property {Number} to                      - bearing rotate to\n        */\n        this._fireEvent('rotatestart', { 'from' : from, 'to': b });\n        this._angle = b;\n        this._calcMatrices();\n        this._renderLayers();\n        /*\n          * rotate event, alias of rotateend, deprecated\n          *\n          * @event Map#rotate\n          * @type {Object}\n          * @property {String} type                    - rotate\n          * @property {Map} target                     - the map fires event\n          * @property {Number} from                    - bearing rotate from\n          * @property {Number} to                      - bearing rotate to\n        */\n        this._fireEvent('rotate', { 'from' : from, 'to': b });\n        /*\n          * rotateend event\n          * @event Map#rotateend\n          * @type {Object}\n          * @property {String} type                    - rotateend\n          * @property {Map} target                     - the map fires event\n          * @property {Number} from                    - bearing rotate from\n          * @property {Number} to                      - bearing rotate to\n        */\n        this._fireEvent('rotateend', { 'from' : from, 'to': b });\n        return this;\n    },\n\n    /**\n     * Get map's pitch\n     * @return {Number} pitch in degree\n     */\n    getPitch() {\n        if (!this._pitch) {\n            return 0;\n        }\n        return this._pitch / Math.PI * 180;\n    },\n\n    /**\n     * Set a new pitch to map\n     * @param {Number} pitch new pitch in degree\n     * @return {Map} this\n     */\n    setPitch(pitch) {\n        if (Browser.ie9) {\n            throw new Error('map can\\'t tilt in IE9.');\n        }\n        const p = clamp(pitch, 0, this.options['maxPitch']) * RADIAN;\n        if (this._pitch === p) return this;\n        const from = this.getPitch();\n        /*\n          * rotate event\n          * @event Map#pitchstart\n          * @type {Object}\n          * @property {String} type                    - pitchstart\n          * @property {Map} target                     - the map fires event\n          * @property {Number} from                    - pitch from\n          * @property {Number} to                      - pitch to\n        */\n        this._fireEvent('pitchstart', { 'from' : from, 'to': p });\n        this._pitch = p;\n        this._calcMatrices();\n        this._renderLayers();\n        /**\n          * pitch event, alias of pitchend, deprecated\n          * @event Map#pitch\n          * @type {Object}\n          * @property {String} type                    - pitch\n          * @property {Map} target                     - the map fires event\n          * @property {Number} from                    - pitch from\n          * @property {Number} to                      - pitch to\n          */\n        this._fireEvent('pitch', { 'from' : from, 'to': p });\n        /**\n          * pitchend event\n          * @event Map#pitchend\n          * @type {Object}\n          * @property {String} type                    - pitchend\n          * @property {Map} target                     - the map fires event\n          * @property {Number} from                    - pitchend from\n          * @property {Number} to                      - pitchend to\n          */\n        this._fireEvent('pitchend', { 'from' : from, 'to': p });\n        return this;\n    },\n\n    /**\n     * Whether the map is rotating or tilting.\n     * @return {Boolean}\n     * @private\n     */\n    isTransforming() {\n        return !!(this._pitch || this._angle);\n    },\n\n    getFrustumAltitude() {\n        return this._frustumAltitude;\n    },\n\n    _calcFrustumAltitude() {\n        const pitch = 90 - this.getPitch();\n        let fov = this.getFov() / 2;\n        const cameraAlt = this.cameraPosition ? this.cameraPosition[2] : 0;\n        if (fov <= pitch) {\n            return cameraAlt;\n        }\n        fov = Math.PI * fov / 180;\n        const d1 = new Point(this.cameraPosition).distanceTo(new Point(this.cameraLookAt)),\n            d2 = cameraAlt * Math.tan(fov * 2);\n        const d = Math.tan(fov) * (d1 + d2);\n        return cameraAlt + d;\n    },\n\n    /**\n     * Convert 2d point at target zoom to containerPoint at current zoom\n     * @param  {Point} point 2d point at target zoom\n     * @param  {Number} zoom  point's zoom\n     * @param  {Number} [altitude=0]  target's altitude in 2d point system at target zoom\n     * @return {Point}       containerPoint at current zoom\n     * @private\n     */\n    _pointToContainerPoint: function () {\n        const a = [0, 0, 0];\n        return function (point, zoom, altitude = 0, out) {\n            point = this._pointToPoint(point, zoom, out);\n            if (this.isTransforming() || altitude) {\n                //convert altitude at zoom to current zoom\n                altitude *= this._getResolution(zoom) / this._getResolution();\n                const scale = this._glScale;\n                set(a, point.x * scale, point.y * scale, altitude * scale);\n\n                const t = this._projIfBehindCamera(a, this.cameraPosition, this.cameraForward);\n                applyMatrix(t, t, this.projViewMatrix);\n\n                const w2 = this.width / 2, h2 = this.height / 2;\n                t[0] = (t[0] * w2) + w2;\n                t[1] = -(t[1] * h2) + h2;\n                if (out) {\n                    out.x = t[0];\n                    out.y = t[1];\n                    return out;\n                }\n                return new Point(t[0], t[1]);\n            } else {\n                const centerPoint = this._prjToPoint(this._getPrjCenter(), undefined, TEMP_COORD);\n                if (out) {\n                    out.x = point.x;\n                    out.y = point.y;\n                } else {\n                    out = point;\n                }\n                return out._sub(centerPoint)._add(this.width / 2, this.height / 2);\n            }\n        };\n    }(),\n\n    // https://forum.unity.com/threads/camera-worldtoscreenpoint-bug.85311/#post-2121212\n    _projIfBehindCamera: function () {\n        const vectorFromCam = new Array(3);\n        const proj = new Array(3);\n        const sub = new Array(3);\n        return function (position, cameraPos, camForward) {\n            subtract(vectorFromCam, position, cameraPos);\n            const camNormDot = dot(camForward, vectorFromCam);\n            if (camNormDot <= 0) {\n                scale(proj, camForward, camNormDot * 1.01);\n                add(position, cameraPos, subtract(sub, vectorFromCam, proj));\n            }\n            return position;\n        };\n    }(),\n\n    /**\n     * Convert containerPoint at current zoom to 2d point at target zoom\n     * from mapbox-gl-js\n     * @param  {Point} p    container point at current zoom\n     * @param  {Number} zoom target zoom, current zoom in default\n     * @return {Point}      2d point at target zoom\n     * @private\n     */\n    _containerPointToPoint: function () {\n        const cp = [0, 0, 0],\n            coord0 = [0, 0, 0, 1],\n            coord1 = [0, 0, 0, 1];\n        return function (p, zoom, out) {\n            if (this.isTransforming()) {\n                const w2 = this.width / 2 || 1, h2 = this.height / 2 || 1;\n                set(cp, (p.x - w2) / w2, (h2 - p.y) / h2, 0);\n\n                set(coord0, cp[0], cp[1], 0);\n                set(coord1, cp[0], cp[1], 1);\n                coord0[3] = coord1[3] = 1;\n\n                applyMatrix(coord0, coord0, this.projViewMatrixInverse);\n                applyMatrix(coord1, coord1, this.projViewMatrixInverse);\n                const x0 = coord0[0];\n                const x1 = coord1[0];\n                const y0 = coord0[1];\n                const y1 = coord1[1];\n                const z0 = coord0[2];\n                const z1 = coord1[2];\n\n                const t = z0 === z1 ? 0 : (0 - z0) / (z1 - z0);\n                const x = interpolate(x0, x1, t);\n                const y = interpolate(y0, y1, t);\n                if (out) {\n                    out.x = x;\n                    out.y = y;\n                } else {\n                    out = new Point(x, y);\n                }\n                out._multi(1 / this._glScale);\n                return ((zoom === undefined || this.getZoom() === zoom) ? out : this._pointToPointAtZoom(out, zoom, out));\n            }\n            const centerPoint = this._prjToPoint(this._getPrjCenter(), zoom, out),\n                scale = (zoom !== undefined ? this._getResolution() / this._getResolution(zoom) : 1);\n            const x = scale * (p.x - this.width / 2),\n                y = scale * (p.y - this.height / 2);\n            return centerPoint._add(x, y);\n        };\n    }(),\n\n    /**\n     * GL Matrices in maptalks (based on THREE):\n     * //based on point at map's gl world zoom, by map.coordToPoint(coord, map.getGLZoom())\n     * map.cameraPosition\n     * map.cameraLookAt\n     * map.cameraUp       //camera's up vector\n     * map.cameraForward  //camera's forward vector\n     * map.cameraWorldMatrix\n     * map.projMatrix\n     * map.viewMatrix = cameraWorldMatrix.inverse()\n     * map.projViewMatrix = projMatrix * viewMatrix\n     * map.projViewMatrixInverse = projViewMatrix.inverse()\n     *  @private\n     */\n    _calcMatrices: function () {\n        // closure matrixes to reuse\n        const m0 = Browser.ie9 ? null : createMat4(),\n            m1 = Browser.ie9 ? null : createMat4();\n        return function () {\n            // get pixel size of map\n            if (Browser.ie9) {\n                return;\n            }\n            //必须先删除缓存的常用值，否则后面计算常用值时，会循环引用造成错误\n            delete this._mapRes;\n            delete this._mapGlRes;\n            delete this._mapExtent2D;\n            delete this._mapGlExtent2D;\n            const size = this.getSize();\n            const w = size.width || 1,\n                h = size.height || 1;\n\n            this._glScale = this.getGLScale();\n            // get field of view\n            const fov = this.getFov() * Math.PI / 180;\n            const maxScale = this.getScale(this.getMinZoom()) / this.getScale(this.getMaxNativeZoom());\n            const farZ = maxScale * h / 2 / this._getFovRatio() * 1.4;\n            // camera projection matrix\n            const projMatrix = this.projMatrix || createMat4();\n            mat4.perspective(projMatrix, fov, w / h, 0.1, farZ);\n            this.projMatrix = projMatrix;\n            // camera world matrix\n            const worldMatrix = this._getCameraWorldMatrix();\n            // view matrix\n            this.viewMatrix = mat4.invert(m0, worldMatrix);\n            // matrix for world point => screen point\n            this.projViewMatrix = mat4.multiply(this.projViewMatrix || createMat4(), projMatrix, this.viewMatrix);\n            // matrix for screen point => world point\n            this.projViewMatrixInverse = mat4.multiply(this.projViewMatrixInverse || createMat4(), worldMatrix, mat4.invert(m1, projMatrix));\n            this.domCssMatrix = this._calcDomMatrix();\n            this._frustumAltitude = this._calcFrustumAltitude();\n            //缓存常用的值\n            this._mapRes = this._getResolution();\n            this._mapGlRes = this._getResolution(this.getGLZoom());\n            this._mapExtent2D = this._get2DExtent();\n            this._mapGlExtent2D = this._get2DExtent(this.getGLZoom());\n        };\n    }(),\n\n    _calcDomMatrix: function () {\n        const m = Browser.ie9 ? null : createMat4(),\n            minusY = [1, -1, 1],\n            arr = [0, 0, 0];\n        return function () {\n            const cameraToCenterDistance = 0.5 / Math.tan(this._fov / 2) * this.height;\n            mat4.scale(m, this.projMatrix, minusY);\n            mat4.translate(m, m, set(arr, 0, 0, -cameraToCenterDistance));//[0, 0, cameraToCenterDistance]\n            if (this._pitch) {\n                mat4.rotateX(m, m, this._pitch);\n            }\n            if (this._angle) {\n                mat4.rotateZ(m, m, this._angle);\n            }\n            const m1 = createMat4();\n            mat4.scale(m1, m1, set(arr, this.width / 2, -this.height / 2, 1)); //[this.width / 2, -this.height / 2, 1]\n            return mat4.multiply(this.domCssMatrix || createMat4(), m1, m);\n        };\n    }(),\n\n    _getCameraWorldMatrix: function () {\n        const q = {},\n            minusY = [1, -1, 1];\n        return function () {\n            const targetZ = this.getGLZoom();\n\n            const size = this.getSize(),\n                scale = this.getGLScale();\n            const center2D = this._prjToPoint(this._prjCenter, targetZ);\n            this.cameraLookAt = set(this.cameraLookAt || [0, 0, 0], center2D.x, center2D.y, 0);\n\n            const pitch = this.getPitch() * RADIAN;\n            const bearing = -this.getBearing() * RADIAN;\n\n            const ratio = this._getFovRatio();\n            const z = scale * (size.height || 1) / 2 / ratio;\n            const cz = z * Math.cos(pitch);\n            // and [dist] away from map's center on XY plane to tilt the scene.\n            const dist = Math.sin(pitch) * z;\n            // when map rotates, the camera's xy position is rotating with the given bearing and still keeps [dist] away from map's center\n            const cx = center2D.x + dist * Math.sin(bearing);\n            const cy = center2D.y + dist * Math.cos(bearing);\n            this.cameraPosition = set(this.cameraPosition || [0, 0, 0], cx, cy, cz);\n            // when map rotates, camera's up axis is pointing to bearing from south direction of map\n            // default [0,1,0] is the Y axis while the angle of inclination always equal 0\n            // if you want to rotate the map after up an incline,please rotateZ like this:\n            // let up = new vec3(0,1,0);\n            // up.rotateZ(target,radians);\n            const d = dist || 1;\n            const up = this.cameraUp = set(this.cameraUp || [0, 0, 0], Math.sin(bearing) * d, Math.cos(bearing) * d, 0);\n            const m = this.cameraWorldMatrix = this.cameraWorldMatrix || createMat4();\n            lookAt(m, this.cameraPosition, this.cameraLookAt, up);\n\n            const cameraForward = this.cameraForward || [0, 0, 0];\n            subtract(cameraForward, this.cameraLookAt, this.cameraPosition);\n            // similar with unity's camera.transform.forward\n            this.cameraForward = normalize(cameraForward, cameraForward);\n            // math from THREE.js\n            matrixToQuaternion(q, m);\n            quaternionToMatrix(m, q);\n            setPosition(m, this.cameraPosition);\n            mat4.scale(m, m, minusY);\n            return m;\n        };\n    }(),\n\n    _getFovRatio() {\n        const fov = this.getFov();\n        return Math.tan(fov / 2 * RADIAN);\n    },\n\n    _renderLayers() {\n        if (this.isInteracting()) {\n            return;\n        }\n        const layers = this._getLayers();\n        // clear canvas layers to prevent unsync painting with tile layers.\n        layers.forEach(layer => {\n            if (!layer) {\n                return;\n            }\n            const renderer = layer._getRenderer();\n            if (renderer && renderer.setToRedraw) {\n                renderer.setToRedraw();\n            }\n        });\n    }\n});\n\nfunction createMat4() {\n    return mat4.identity(new Array(16));\n}\n","import { equalMapView } from '../core/util';\nimport Map from './Map';\n\nMap.include(/** @lends Map.prototype */ {\n    _onViewChange(view) {\n        if (!this._viewHistory) {\n            this._viewHistory = [];\n            this._viewHistoryPointer = 0;\n        }\n        const old = this._getCurrentView();\n        for (let i = this._viewHistory.length - 1; i >= 0; i--) {\n            if (equalMapView(view, this._viewHistory[i])) {\n                this._viewHistoryPointer = i;\n                this._fireViewChange(old, view);\n                return;\n            }\n        }\n\n        if (this._viewHistoryPointer < this._viewHistory.length - 1) {\n            // remove old 'next views'\n            this._viewHistory.splice(this._viewHistoryPointer + 1);\n        }\n        this._viewHistory.push(view);\n        const count = this.options['viewHistoryCount'];\n        if (count > 0 && this._viewHistory.length > count) {\n            // remove redundant view\n            this._viewHistory.splice(0, this._viewHistory.length - count);\n        }\n        this._viewHistoryPointer = this._viewHistory.length - 1;\n        /**\n         * viewchange event\n         * @event Map#viewchange\n         * @type {Object}\n         * @property {String} type - viewchange\n         * @property {Map} target - map fires the event\n         * @property {Object} old - old view\n         * @property {Point} new  - new view\n         */\n        this._fireViewChange(old, view);\n    },\n\n    /**\n     * Zoom to the previous map view in view history\n     * @return {Object} map view\n     */\n    zoomToPreviousView(options = {}) {\n        if (!this.hasPreviousView()) {\n            return null;\n        }\n        const view = this._viewHistory[--this._viewHistoryPointer];\n        this._zoomToView(view, options);\n        return view;\n    },\n\n    /**\n     * Whether has more previous view\n     * @return {Boolean}\n     */\n    hasPreviousView() {\n        if (!this._viewHistory || this._viewHistoryPointer === 0) {\n            return false;\n        }\n        return true;\n    },\n\n    /**\n     * Zoom to the next view in view history\n     * @return {Object} map view\n     */\n    zoomToNextView(options = {}) {\n        if (!this.hasNextView()) {\n            return null;\n        }\n        const view = this._viewHistory[++this._viewHistoryPointer];\n        this._zoomToView(view, options);\n        return view;\n    },\n\n    /**\n     * Whether has more next view\n     * @return {Boolean}\n     */\n    hasNextView() {\n        if (!this._viewHistory || this._viewHistoryPointer === this._viewHistory.length - 1) {\n            return false;\n        }\n        return true;\n    },\n\n    _zoomToView(view, options) {\n        const old = this.getView();\n        if (options['animation']) {\n            this.animateTo(view, {\n                'duration' : options['duration']\n            }, frame => {\n                if (frame.state.playState === 'finished') {\n                    this._fireViewChange(old, view);\n                }\n            });\n        } else {\n            this.setView(view);\n            this._fireViewChange(old, view);\n        }\n    },\n\n    /**\n     * Get map view history\n     * @return {Object[]}\n     */\n    getViewHistory() {\n        return this._viewHistory;\n    },\n\n    _fireViewChange(old, view) {\n        this._fireEvent('viewchange', {\n            'old' : old,\n            'new' : view\n        });\n    },\n\n    _getCurrentView() {\n        if (!this._viewHistory) {\n            return null;\n        }\n        return this._viewHistory[this._viewHistoryPointer];\n    }\n});\n\nMap.mergeOptions({\n    'viewHistory' : true,\n    'viewHistoryCount' : 10\n});\n","import { isArrayHasData, UID } from '../../core/util';\nimport { extendSymbol } from '../../core/util/style';\nimport Size from '../../geo/Size';\nimport Geometry from '../../geometry/Geometry';\nimport Marker from '../../geometry/Marker';\nimport Label from '../../geometry/Label';\nimport VectorLayer from '../../layer/VectorLayer';\nimport DrawTool from './DrawTool';\n\n/**\n * @property {options} options\n * @property {String}  options.language         - language of the distance tool, zh-CN or en-US\n * @property {Boolean} options.metric           - display result in metric system\n * @property {Boolean} options.imperial         - display result in imperial system.\n * @property {Object}  options.symbol           - symbol of the line\n * @property {Object}  options.vertexSymbol     - symbol of the vertice\n * @property {Object}  options.labelOptions     - construct options of the vertice labels.\n * @memberOf DistanceTool\n * @instance\n */\nconst options = {\n    'mode': 'LineString',\n    'language': 'zh-CN', //'en-US'\n    'metric': true,\n    'imperial': false,\n    'symbol': {\n        'lineColor': '#000',\n        'lineWidth': 3,\n        'lineOpacity': 1\n    },\n    'vertexSymbol': {\n        'markerType': 'ellipse',\n        'markerFill': '#fff',\n        'markerLineColor': '#000',\n        'markerLineWidth': 3,\n        'markerWidth': 11,\n        'markerHeight': 11\n    },\n    'labelOptions': {\n        'textSymbol': {\n            'textFaceName': 'monospace',\n            'textLineSpacing': 1,\n            'textHorizontalAlignment': 'right',\n            'textDx': 15\n        },\n        'boxStyle' : {\n            'padding' : [6, 2],\n            'symbol' : {\n                'markerType' : 'square',\n                'markerFill' : '#fff',\n                'markerFillOpacity' : 0.9,\n                'markerLineColor' : '#b4b3b3',\n            }\n        }\n    },\n    'clearButtonSymbol' :[{\n        'markerType': 'square',\n        'markerFill': '#fff',\n        'markerLineColor': '#b4b3b3',\n        'markerLineWidth': 2,\n        'markerWidth': 15,\n        'markerHeight': 15,\n        'markerDx': 20\n    }, {\n        'markerType': 'x',\n        'markerWidth': 10,\n        'markerHeight': 10,\n        'markerDx': 20\n    }]\n};\n\n\n/**\n * A map tool to help measure distance on the map\n * @category maptool\n * @extends DrawTool\n * @example\n * var distanceTool = new DistanceTool({\n *     'once' : true,\n *     'symbol': {\n *       'lineColor' : '#34495e',\n *       'lineWidth' : 2\n *     },\n *     'vertexSymbol' : {\n *       'markerType'        : 'ellipse',\n *       'markerFill'        : '#1bbc9b',\n *       'markerLineColor'   : '#000',\n *       'markerLineWidth'   : 3,\n *       'markerWidth'       : 10,\n *      'markerHeight'      : 10\n *    },\n *    'language' : 'en-US'\n *  }).addTo(map);\n *\n */\nclass DistanceTool extends DrawTool {\n\n    /**\n     * @param {options} [options=null] - construct options\n     * @param {String} [options.language=zh-CN]         - language of the distance tool, zh-CN or en-US\n     * @param {Boolean} [options.metric=true]           - display result in metric system\n     * @param {Boolean} [options.imperial=false]        - display result in imperial system.\n     * @param {Object}  [options.symbol=null]           - symbol of the line\n     * @param {Object}  [options.vertexSymbol=null]     - symbol of the vertice\n     * @param {Object}  [options.labelOptions=null]     - construct options of the vertice labels.\n     */\n    constructor(options) {\n        super(options);\n        this.on('enable', this._afterEnable, this)\n            .on('disable', this._afterDisable, this);\n        this._measureLayers = [];\n    }\n\n    /**\n     * Clear the measurements\n     * @return {DistanceTool} this\n     */\n    clear() {\n        if (isArrayHasData(this._measureLayers)) {\n            for (let i = 0; i < this._measureLayers.length; i++) {\n                this._measureLayers[i].remove();\n            }\n        }\n        delete this._lastMeasure;\n        delete this._lastVertex;\n        this._measureLayers = [];\n        return this;\n    }\n\n    /**\n     * Get the VectorLayers with the geometries drawn on the map during measuring.\n     * @return {Layer[]}\n     */\n    getMeasureLayers() {\n        return this._measureLayers;\n    }\n\n    /**\n     * Get last measuring result\n     * @return {Number}\n     */\n    getLastMeasure() {\n        if (!this._lastMeasure) {\n            return 0;\n        }\n        return this._lastMeasure;\n    }\n\n    _measure(toMeasure) {\n        const map = this.getMap();\n        let length;\n        if (toMeasure instanceof Geometry) {\n            length = map.computeGeometryLength(toMeasure);\n        } else if (Array.isArray(toMeasure)) {\n            length = map.getProjection().measureLength(toMeasure);\n        }\n        this._lastMeasure = length;\n        let units;\n        if (this.options['language'] === 'zh-CN') {\n            units = [' 米', ' 公里', ' 英尺', ' 英里'];\n        } else {\n            units = [' m', ' km', ' feet', ' mile'];\n        }\n        let content = '';\n        if (this.options['metric']) {\n            content += length < 1000 ? length.toFixed(0) + units[0] : (length / 1000).toFixed(2) + units[1];\n        }\n        if (this.options['imperial']) {\n            length *= 3.2808399;\n            if (content.length > 0) {\n                content += '\\n';\n            }\n            content += length < 5280 ? length.toFixed(0) + units[2] : (length / 5280).toFixed(2) + units[3];\n        }\n        return content;\n    }\n\n    _registerMeasureEvents() {\n        this.on('drawstart', this._msOnDrawStart, this)\n            .on('drawvertex', this._msOnDrawVertex, this)\n            .on('mousemove', this._msOnMouseMove, this)\n            .on('drawend', this._msOnDrawEnd, this);\n    }\n\n    _afterEnable() {\n        this._registerMeasureEvents();\n    }\n\n    _afterDisable() {\n        this.off('drawstart', this._msOnDrawStart, this)\n            .off('drawvertex', this._msOnDrawVertex, this)\n            .off('mousemove', this._msOnMouseMove, this)\n            .off('drawend', this._msOnDrawEnd, this);\n    }\n\n    _msOnDrawStart(param) {\n        const map = this.getMap();\n        const uid = UID();\n        const layerId = 'distancetool_' + uid;\n        const markerLayerId = 'distancetool_markers_' + uid;\n        if (!map.getLayer(layerId)) {\n            this._measureLineLayer = new VectorLayer(layerId).addTo(map);\n            this._measureMarkerLayer = new VectorLayer(markerLayerId).addTo(map);\n        } else {\n            this._measureLineLayer = map.getLayer(layerId);\n            this._measureMarkerLayer = map.getLayer(markerLayerId);\n        }\n        this._measureLayers.push(this._measureLineLayer);\n        this._measureLayers.push(this._measureMarkerLayer);\n        //start marker\n        new Marker(param['coordinate'], {\n            'symbol': this.options['vertexSymbol']\n        }).addTo(this._measureMarkerLayer);\n        const content = (this.options['language'] === 'zh-CN' ? '起点' : 'start');\n        const startLabel = new Label(content, param['coordinate'], this.options['labelOptions']);\n        this._lastVertex = startLabel;\n        this._measureMarkerLayer.addGeometry(startLabel);\n    }\n\n    _msOnMouseMove(param) {\n        const ms = this._measure(this._msGetCoordsToMeasure(param));\n        if (!this._tailMarker) {\n            const symbol = extendSymbol(this.options['vertexSymbol']);\n            symbol['markerWidth'] /= 2;\n            symbol['markerHeight'] /= 2;\n            this._tailMarker = new Marker(param['coordinate'], {\n                'symbol': symbol\n            }).addTo(this._measureMarkerLayer);\n            this._tailLabel = new Label(ms, param['coordinate'], this.options['labelOptions'])\n                .addTo(this._measureMarkerLayer);\n        }\n        this._tailMarker.setCoordinates(param['coordinate']);\n        this._tailLabel.setContent(ms);\n        this._tailLabel.setCoordinates(param['coordinate']);\n    }\n\n    _msGetCoordsToMeasure(param) {\n        return param['geometry'].getCoordinates().concat([param['coordinate']]);\n    }\n\n    _msOnDrawVertex(param) {\n        const geometry = param['geometry'];\n        //vertex marker\n        new Marker(param['coordinate'], {\n            'symbol': this.options['vertexSymbol']\n        }).addTo(this._measureMarkerLayer);\n        const length = this._measure(geometry);\n        const vertexLabel = new Label(length, param['coordinate'], this.options['labelOptions']);\n        this._measureMarkerLayer.addGeometry(vertexLabel);\n        this._lastVertex = vertexLabel;\n    }\n\n    _msOnDrawEnd(param) {\n        this._clearTailMarker();\n        let size = this._lastVertex.getSize();\n        if (!size) {\n            size = new Size(10, 10);\n        }\n        this._addClearMarker(this._lastVertex.getCoordinates(), size['width']);\n        const geo = param['geometry'].copy();\n        geo.addTo(this._measureLineLayer);\n        this._lastMeasure = geo.getLength();\n    }\n\n    _addClearMarker(coordinates, dx) {\n        let symbol = this.options['clearButtonSymbol'];\n        let dxSymbol = {\n            'markerDx' : (symbol['markerDx'] || 0) + dx,\n            'textDx' : (symbol['textDx'] || 0) + dx\n        };\n        if (Array.isArray(symbol)) {\n            dxSymbol = symbol.map(s => {\n                if (s) {\n                    return {\n                        'markerDx' : (s['markerDx'] || 0) + dx,\n                        'textDx' : (s['textDx'] || 0) + dx\n                    };\n                }\n                return null;\n            });\n        }\n        symbol = extendSymbol(symbol, dxSymbol);\n        const endMarker = new Marker(coordinates, {\n            'symbol': symbol\n        });\n        const measureLineLayer = this._measureLineLayer,\n            measureMarkerLayer = this._measureMarkerLayer;\n        endMarker.on('click', function () {\n            measureLineLayer.remove();\n            measureMarkerLayer.remove();\n            //return false to stop propagation of event.\n            return false;\n        }, this);\n        endMarker.addTo(this._measureMarkerLayer);\n    }\n\n    _clearTailMarker() {\n        if (this._tailMarker) {\n            this._tailMarker.remove();\n            delete this._tailMarker;\n        }\n        if (this._tailLabel) {\n            this._tailLabel.remove();\n            delete this._tailLabel;\n        }\n    }\n\n}\n\nDistanceTool.mergeOptions(options);\n\nexport default DistanceTool;\n","import Size from '../../geo/Size';\nimport { Geometry, Marker, Label } from '../../geometry';\nimport DistanceTool from './DistanceTool';\n\n/**\n * @property {options} options\n * @property {String}  options.language         - language of the distance tool, zh-CN or en-US\n * @property {Boolean} options.metric           - display result in metric system\n * @property {Boolean} options.imperial         - display result in imperial system.\n * @property {Object}  options.symbol           - symbol of the line\n * @property {Object}  options.vertexSymbol     - symbol of the vertice\n * @property {Object}  options.labelOptions     - construct options of the vertice labels.\n * @memberOf AreaTool\n * @instance\n */\nconst options = {\n    'mode': 'Polygon',\n    'symbol': {\n        'lineColor': '#000000',\n        'lineWidth': 2,\n        'lineOpacity': 1,\n        'lineDasharray': '',\n        'polygonFill': '#ffffff',\n        'polygonOpacity': 0.5\n    }\n};\n\n/**\n * A map tool to help measure area on the map\n * @category maptool\n * @extends DistanceTool\n * @example\n * var areaTool = new AreaTool({\n *     'once' : true,\n *     'symbol': {\n *       'lineColor' : '#34495e',\n *       'lineWidth' : 2\n *     },\n *     'vertexSymbol' : {\n *       'markerType'        : 'ellipse',\n *       'markerFill'        : '#1bbc9b',\n *       'markerLineColor'   : '#000',\n *       'markerLineWidth'   : 3,\n *       'markerWidth'       : 10,\n *      'markerHeight'      : 10\n *    },\n *    'language' : 'en-US'\n *  }).addTo(map);\n */\nclass AreaTool extends DistanceTool {\n\n    /**\n     * @param {options} [options=null] - construct options\n     * @param {String} [options.language=zh-CN]         - language of the distance tool, zh-CN or en-US\n     * @param {Boolean} [options.metric=true]           - display result in metric system\n     * @param {Boolean} [options.imperial=false]        - display result in imperial system.\n     * @param {Object}  [options.symbol=null]           - symbol of the line\n     * @param {Object}  [options.vertexSymbol=null]     - symbol of the vertice\n     * @param {Object}  [options.labelOptions=null]     - construct options of the vertice labels.\n     */\n    constructor(options) {\n        super(options);\n        this.on('enable', this._afterEnable, this)\n            .on('disable', this._afterDisable, this);\n        this._measureLayers = [];\n    }\n\n    _measure(toMeasure) {\n        const map = this.getMap();\n        let area;\n        if (toMeasure instanceof Geometry) {\n            area = map.computeGeometryArea(toMeasure);\n        } else if (Array.isArray(toMeasure)) {\n            area = map.getProjection().measureArea(toMeasure);\n        }\n        this._lastMeasure = area;\n        let units;\n        if (this.options['language'] === 'zh-CN') {\n            units = [' 平方米', ' 平方公里', ' 平方英尺', ' 平方英里'];\n        } else {\n            units = [' sq.m', ' sq.km', ' sq.ft', ' sq.mi'];\n        }\n        let content = '';\n        if (this.options['metric']) {\n            content += area < 1E6 ? area.toFixed(0) + units[0] : (area / 1E6).toFixed(2) + units[1];\n        }\n        if (this.options['imperial']) {\n            area *= 3.2808399;\n            if (content.length > 0) {\n                content += '\\n';\n            }\n            const sqmi = 5280 * 5280;\n            content += area < sqmi ? area.toFixed(0) + units[2] : (area / sqmi).toFixed(2) + units[3];\n        }\n        return content;\n    }\n\n    _msGetCoordsToMeasure(param) {\n        return param['geometry'].getShell().concat([param['coordinate']]);\n    }\n\n    _msOnDrawVertex(param) {\n        const vertexMarker = new Marker(param['coordinate'], {\n            'symbol': this.options['vertexSymbol']\n        }).addTo(this._measureMarkerLayer);\n        this._measure(param['geometry']);\n        this._lastVertex = vertexMarker;\n    }\n\n    _msOnDrawEnd(param) {\n        this._clearTailMarker();\n\n        const ms = this._measure(param['geometry']);\n        const endLabel = new Label(ms, param['coordinate'], this.options['labelOptions'])\n            .addTo(this._measureMarkerLayer);\n        let size = endLabel.getSize();\n        if (!size) {\n            size = new Size(10, 10);\n        }\n        this._addClearMarker(param['coordinate'], size['width']);\n        const geo = param['geometry'].copy();\n        geo.addTo(this._measureLineLayer);\n        this._lastMeasure = geo.getArea();\n    }\n}\n\nAreaTool.mergeOptions(options);\n\nexport default AreaTool;\n","import Ellipse from '../../geometry/Ellipse';\nimport ArcCurve from '../../geometry/ArcCurve';\nimport LineString from '../../geometry/LineString';\nimport { extendSymbol } from '../../core/util/style';\nimport QuadBezierCurve from '../../geometry/QuadBezierCurve';\nimport Coordinate from '../../geo/Coordinate';\nimport Point from '../../geo/Point';\nimport Marker from '../../geometry/Marker';\nimport CubicBezierCurve from '../../geometry/CubicBezierCurve';\nimport Circle from '../../geometry/Circle';\nimport Polygon from '../../geometry/Polygon';\nimport DrawTool from './DrawTool';\n\nDrawTool.registerMode('circle', {\n    'clickLimit': 2,\n    'action': ['click', 'mousemove', 'click'],\n    'create': function (coordinate) {\n        return new Circle(coordinate[0], 0);\n    },\n    'update': function (path, geometry) {\n        const map = geometry.getMap();\n        const radius = map.computeLength(geometry.getCenter(), path[path.length - 1]);\n        geometry.setRadius(radius);\n    },\n    'generate': function (geometry) {\n        return geometry;\n    }\n});\n\nDrawTool.registerMode('freeHandCircle', {\n    'action': ['mousedown', 'mousemove', 'mouseup'],\n    'create': function (coordinate) {\n        return new Circle(coordinate[0], 0);\n    },\n    'update': function (path, geometry) {\n        const map = geometry.getMap();\n        const radius = map.computeLength(geometry.getCenter(), path[path.length - 1]);\n        geometry.setRadius(radius);\n    },\n    'generate': function (geometry) {\n        return geometry;\n    }\n});\n\nDrawTool.registerMode('ellipse', {\n    'clickLimit': 2,\n    'action': ['click', 'mousemove', 'click'],\n    'create': function (coordinates) {\n        return new Ellipse(coordinates[0], 0, 0);\n    },\n    'update': function (path, geometry) {\n        const map = geometry.getMap();\n        const center = geometry.getCenter();\n        const rx = map.computeLength(center, new Coordinate({\n            x: path[path.length - 1].x,\n            y: center.y\n        }));\n        const ry = map.computeLength(center, new Coordinate({\n            x: center.x,\n            y: path[path.length - 1].y\n        }));\n        geometry.setWidth(rx * 2);\n        geometry.setHeight(ry * 2);\n    },\n    'generate': function (geometry) {\n        return geometry;\n    }\n});\n\nDrawTool.registerMode('freeHandEllipse', {\n    'action': ['mousedown', 'mousemove', 'mouseup'],\n    'create': function (coordinates) {\n        return new Ellipse(coordinates[0], 0, 0);\n    },\n    'update': function (path, geometry) {\n        const map = geometry.getMap();\n        const center = geometry.getCenter();\n        const rx = map.computeLength(center, new Coordinate({\n            x: path[path.length - 1].x,\n            y: center.y\n        }));\n        const ry = map.computeLength(center, new Coordinate({\n            x: center.x,\n            y: path[path.length - 1].y\n        }));\n        geometry.setWidth(rx * 2);\n        geometry.setHeight(ry * 2);\n    },\n    'generate': function (geometry) {\n        return geometry;\n    }\n});\n\nDrawTool.registerMode('rectangle', {\n    'clickLimit': 2,\n    'action': ['click', 'mousemove', 'click'],\n    'create': function (coordinates) {\n        const rect = new Polygon([]);\n        rect._firstClick = coordinates[0];\n        return rect;\n    },\n    'update': function (coordinates, geometry, param) {\n        const map = geometry.getMap();\n        const containerPoint = param['containerPoint'];\n        const firstClick = map.coordToContainerPoint(geometry._firstClick);\n        const ring = [\n            [firstClick.x, firstClick.y],\n            [containerPoint.x, firstClick.y],\n            [containerPoint.x, containerPoint.y],\n            [firstClick.x, containerPoint.y],\n        ];\n        geometry.setCoordinates(ring.map(c => map.containerPointToCoord(new Point(c))));\n    },\n    'generate': function (geometry) {\n        return geometry;\n    }\n});\n\nDrawTool.registerMode('freeHandRectangle', {\n    'action': ['mousedown', 'mousemove', 'mouseup'],\n    'create': function (coordinates) {\n        const rect = new Polygon([]);\n        rect._firstClick = coordinates[0];\n        return rect;\n    },\n    'update': function (coordinates, geometry) {\n        const firstClick = geometry._firstClick;\n        const ring = [\n            [firstClick.x, firstClick.y],\n            [coordinates[0].x, firstClick.y],\n            [coordinates[0].x, coordinates[0].y],\n            [firstClick.x, coordinates[0].y],\n        ];\n        geometry.setCoordinates(ring);\n    },\n    'generate': function (geometry) {\n        return geometry;\n    }\n});\n\nDrawTool.registerMode('point', {\n    'clickLimit': 1,\n    'action': ['click'],\n    'create': function (coordinate) {\n        return new Marker(coordinate[0]);\n    },\n    'generate': function (geometry) {\n        return geometry;\n    }\n});\n\nDrawTool.registerMode('polygon', {\n    'action': ['click', 'mousemove', 'dblclick'],\n    'create': function (path) {\n        return new LineString(path);\n    },\n    'update': function (path, geometry) {\n        const symbol = geometry.getSymbol();\n        geometry.setCoordinates(path);\n\n        const layer = geometry.getLayer();\n        if (layer) {\n            let polygon = layer.getGeometryById('polygon');\n            if (!polygon && path.length >= 3) {\n                polygon = new Polygon([path], {\n                    'id': 'polygon'\n                });\n                if (symbol) {\n                    const pSymbol = extendSymbol(symbol, {\n                        'lineOpacity': 0\n                    });\n                    polygon.setSymbol(pSymbol);\n                }\n                polygon.addTo(layer);\n            }\n            if (polygon) {\n                polygon.setCoordinates(path);\n            }\n        }\n    },\n    'generate': function (geometry) {\n        return new Polygon(geometry.getCoordinates(), {\n            'symbol': geometry.getSymbol()\n        });\n    }\n});\n\nDrawTool.registerMode('freeHandPolygon', {\n    'action': ['mousedown', 'mousemove', 'mouseup'],\n    'create': function (path) {\n        return new LineString(path);\n    },\n    'update': function (path, geometry) {\n        const coordinates = geometry.getCoordinates();\n        const symbol = geometry.getSymbol();\n        geometry.setCoordinates(coordinates.concat(path));\n\n        const layer = geometry.getLayer();\n        if (layer) {\n            let polygon = layer.getGeometryById('polygon');\n            if (!polygon && path.length >= 3) {\n                polygon = new Polygon([path], {\n                    'id': 'polygon'\n                });\n                if (symbol) {\n                    const pSymbol = extendSymbol(symbol, {\n                        'lineOpacity': 0\n                    });\n                    polygon.setSymbol(pSymbol);\n                }\n                polygon.addTo(layer);\n            }\n            if (polygon) {\n                polygon.setCoordinates(path);\n            }\n        }\n    },\n    'generate': function (geometry) {\n        return new Polygon(geometry.getCoordinates(), {\n            'symbol': geometry.getSymbol()\n        });\n    }\n});\n\nDrawTool.registerMode('linestring', {\n    'action': ['click', 'mousemove', 'dblclick'],\n    'create': function (path) {\n        return new LineString(path);\n    },\n    'update': function (path, geometry) {\n        geometry.setCoordinates(path);\n    },\n    'generate': function (geometry) {\n        return geometry;\n    }\n});\n\nDrawTool.registerMode('freeHandLinestring', {\n    'action': ['mousedown', 'mousemove', 'mouseup'],\n    'create': function (path) {\n        return new LineString(path);\n    },\n    'update': function (path, geometry) {\n        const coordinates = geometry.getCoordinates();\n        geometry.setCoordinates(coordinates.concat(path));\n    },\n    'generate': function (geometry) {\n        return geometry;\n    }\n});\n\nDrawTool.registerMode('arccurve', {\n    'action': ['click', 'mousemove', 'dblclick'],\n    'create': function (path) {\n        return new ArcCurve(path);\n    },\n    'update': function (path, geometry) {\n        geometry.setCoordinates(path);\n    },\n    'generate': function (geometry) {\n        return geometry;\n    }\n});\n\nDrawTool.registerMode('quadbeziercurve', {\n    'action': ['click', 'mousemove', 'dblclick'],\n    'create': function (path) {\n        return new QuadBezierCurve(path);\n    },\n    'update': function (path, geometry) {\n        geometry.setCoordinates(path);\n    },\n    'generate': function (geometry) {\n        return geometry;\n    }\n});\n\nDrawTool.registerMode('cubicbeziercurve', {\n    'action': ['click', 'mousemove', 'dblclick'],\n    'create': function (path) {\n        return new CubicBezierCurve(path);\n    },\n    'update': function (path, geometry) {\n        geometry.setCoordinates(path);\n    },\n    'generate': function (geometry) {\n        return geometry;\n    }\n});\n\n// TODO When action contains 'mousedown', It is in drag mode.\nDrawTool.registerMode('boxZoom', {\n    'action': ['mousedown', 'mousemove', 'mouseup'],\n    'create': function (coordinates) {\n        const marker = new Marker(coordinates[0]);\n        marker._firstClick = coordinates[0];\n        return marker;\n    },\n    'update': function (path, geometry, param) {\n        const map = geometry.getMap();\n        const p1 = map.coordToContainerPoint(geometry._firstClick),\n            p2 = param['containerPoint'];\n        const coords = map.containerPointToCoordinate(new Coordinate(Math.min(p1.x, p2.x), Math.min(p1.y, p2.y)));\n        geometry.setCoordinates(coords)\n            .updateSymbol({\n                markerWidth: Math.abs(p1.x - p2.x),\n                markerHeight: Math.abs(p1.y - p2.y)\n            });\n    },\n    'generate': function (geometry) {\n        return geometry;\n    }\n});\n","import { isString, parseJSON } from '../../core/util';\nimport Ajax from '../../core/Ajax';\nimport SpatialReference from './SpatialReference';\n\nfunction parse(arcConf) {\n    const tileInfo = arcConf['tileInfo'],\n        tileSize = [tileInfo['cols'], tileInfo['rows']],\n        resolutions = [],\n        lods = tileInfo['lods'];\n    for (let i = 0, len = lods.length; i < len; i++) {\n        resolutions.push(lods[i]['resolution']);\n    }\n    const fullExtent = arcConf['fullExtent'],\n        origin = tileInfo['origin'],\n        tileSystem = [1, -1, origin['x'], origin['y']];\n    delete fullExtent['spatialReference'];\n    return {\n        'spatialReference': {\n            'resolutions': resolutions,\n            'fullExtent': fullExtent\n        },\n        'tileSystem': tileSystem,\n        'tileSize': tileSize\n    };\n}\n\nSpatialReference.loadArcgis = function (url, cb, options = { 'jsonp' : true }) {\n    if (isString(url) && url.substring(0, 1) !== '{') {\n        Ajax.getJSON(url, function (err, json) {\n            if (err) {\n                cb(err);\n                return;\n            }\n            const spatialRef = parse(json);\n            cb(null, spatialRef);\n        }, options);\n    } else {\n        if (isString(url)) {\n            url = parseJSON(url);\n        }\n        const spatialRef = parse(url);\n        cb(null, spatialRef);\n\n    }\n    return this;\n};\n","import { extend } from '../core/util';\nimport { trim } from '../core/util/strings';\nimport {\n    on,\n    off,\n    removeDomNode,\n    stopPropagation,\n    TRANSFORM,\n    TRANSFORMORIGIN,\n    TRANSITION\n} from '../core/util/dom';\nimport Browser from '../core/Browser';\nimport Class from '../core/Class';\nimport Eventable from '../core/Eventable';\nimport Point from '../geo/Point';\nimport Size from '../geo/Size';\nimport Geometry from '../geometry/Geometry';\n\n/**\n * @property {Object} options\n * @property {Boolean} [options.eventsPropagation=false]  - whether stop ALL events' propagation.\n * @property {Boolean} [options.eventsToStop=null]  - UI's dom events to stop propagation if eventsPropagation is true.\n * @property {Number}  [options.dx=0]     - pixel offset on x axis\n * @property {Number}  [options.dy=0]     - pixel offset on y axis\n * @property {Boolean} [options.autoPan=false]  - set it to false if you don't want the map to do panning animation to fit the opened UI.\n * @property {Boolean} [options.autoPanDuration=600]    - duration for auto panning animation.\n * @property {Boolean} [options.single=true]    - whether the UI is a global single one, only one UI will be shown at the same time if set to true.\n * @property {Boolean} [options.animation=null]         - fade | scale | fade,scale, add animation effect when showing and hiding.\n * @property {Number}  [options.animationDuration=300]  - animation duration, in milliseconds.\n * @property {Boolean}  [options.pitchWithMap=false]    - whether tilt with map\n * @property {Boolean}  [options.rotateWithMap=false]  - whether rotate with map\n * @memberOf ui.UIComponent\n * @instance\n */\nconst options = {\n    'eventsPropagation': false,\n    'eventsToStop': null,\n    'dx': 0,\n    'dy': 0,\n    'autoPan': false,\n    'autoPanDuration': 600,\n    'single': true,\n    'animation': 'scale',\n    'animationOnHide': true,\n    'animationDuration': 500,\n    'pitchWithMap': false,\n    'rotateWithMap': false,\n};\n\n/**\n * @classdesc\n * Base class for all the UI component classes, a UI component is a HTMLElement positioned with geographic coordinate. <br>\n * It is abstract and not intended to be instantiated.\n *\n * @category ui\n * @abstract\n * @mixes Eventable\n * @memberOf ui\n * @extends Class\n */\nclass UIComponent extends Eventable(Class) {\n\n    /**\n     *  Some instance methods subclasses needs to implement:  <br>\n     *  <br>\n     * 1. Optional, returns the Dom element's position offset  <br>\n     * function getOffset : Point  <br>\n     *  <br>\n     * 2. Method to create UI's Dom element  <br>\n     * function buildOn : HTMLElement  <br>\n     *  <br>\n     * 3 Optional, to provide an event map to register event listeners.  <br>\n     * function getEvents : void  <br>\n     * 4 Optional, a callback when dom is removed.  <br>\n     * function onDomRemove : void  <br>\n     * 5 Optional, a callback when UI Component is removed.  <br>\n     * function onRemove : void  <br>\n     * @param  {Object} options configuration options\n     */\n    constructor(options) {\n        super(options);\n    }\n\n    /**\n     * Adds the UI Component to a geometry or a map\n     * @param {Geometry|Map} owner - geometry or map to addto.\n     * @returns {ui.UIComponent} this\n     * @fires ui.UIComponent#add\n     */\n    addTo(owner) {\n        this._owner = owner;\n        // first time\n        this._switchEvents('on');\n        if (this.onAdd) {\n            this.onAdd();\n        }\n        /**\n         * add event.\n         *\n         * @event ui.UIComponent#add\n         * @type {Object}\n         * @property {String} type - add\n         * @property {ui.UIComponent} target - UIComponent\n         */\n        this.fire('add');\n        return this;\n    }\n\n    /**\n     * Get the map it added to\n     * @return {Map} map instance\n     * @override\n     */\n    getMap() {\n        if (!this._owner) {\n            return null;\n        }\n        // is a map\n        if (this._owner.getBaseLayer) {\n            return this._owner;\n        }\n        return this._owner.getMap();\n    }\n\n    /**\n     * Show the UI Component, if it is a global single one, it will close previous one.\n     * @param {Coordinate} [coordinate=null] - coordinate to show, default is owner's center\n     * @return {ui.UIComponent} this\n     * @fires ui.UIComponent#showstart\n     * @fires ui.UIComponent#showend\n     */\n    show(coordinate) {\n        const map = this.getMap();\n        if (!map) {\n            return this;\n        }\n\n        if (!this._mapEventsOn) {\n            this._switchMapEvents('on');\n        }\n\n        coordinate = coordinate || this._coordinate || this._owner.getCenter();\n\n        const visible = this.isVisible();\n\n        /**\n         * showstart event.\n         *\n         * @event ui.UIComponent#showstart\n         * @type {Object}\n         * @property {String} type - showstart\n         * @property {ui.UIComponent} target - UIComponent\n         */\n        this.fire('showstart');\n        const container = this._getUIContainer();\n        this._coordinate = coordinate;\n        this._removePrevDOM();\n        const dom = this.__uiDOM = this.buildOn(map);\n        dom['eventsPropagation'] = this.options['eventsPropagation'];\n\n        if (!dom) {\n            /**\n             * showend event.\n             *\n             * @event ui.UIComponent#showend\n             * @type {Object}\n             * @property {String} type - showend\n             * @property {ui.UIComponent} target - UIComponent\n             */\n            this.fire('showend');\n            return this;\n        }\n\n        this._measureSize(dom);\n\n        if (this._singleton()) {\n            map[this._uiDomKey()] = dom;\n        }\n\n        this._setPosition();\n\n        dom.style[TRANSITION] = null;\n\n        container.appendChild(dom);\n\n\n        const anim = this._getAnimation();\n\n        if (visible) {\n            anim.ok = false;\n        }\n\n        if (anim.ok) {\n            if (anim.fade) {\n                dom.style.opacity = 0;\n            }\n            if (anim.scale) {\n                if (this.getTransformOrigin) {\n                    const origin = this.getTransformOrigin();\n                    dom.style[TRANSFORMORIGIN] = origin;\n                }\n                dom.style[TRANSFORM] = this._toCSSTranslate(this._pos) + ' scale(0)';\n            }\n        }\n\n        dom.style.display = '';\n\n        if (this.options['eventsToStop']) {\n            on(dom, this.options['eventsToStop'], stopPropagation);\n        }\n\n        //autoPan\n        if (this.options['autoPan']) {\n            this._autoPan();\n        }\n\n        const transition = anim.transition;\n        if (anim.ok && transition) {\n            /* eslint-disable no-unused-expressions */\n            // trigger transition\n            dom.offsetHeight;\n            /* eslint-enable no-unused-expressions */\n            if (transition) {\n                dom.style[TRANSITION] = transition;\n            }\n            if (anim.fade) {\n                dom.style.opacity = 1;\n            }\n            if (anim.scale) {\n                dom.style[TRANSFORM] = this._toCSSTranslate(this._pos) + ' scale(1)';\n            }\n        }\n\n        this.fire('showend');\n        return this;\n    }\n\n    /**\n     * Hide the UI Component.\n     * @return {ui.UIComponent} this\n     * @fires ui.UIComponent#hide\n     */\n    hide() {\n        if (!this.getDOM() || !this.getMap()) {\n            return this;\n        }\n\n        const anim = this._getAnimation(),\n            dom = this.getDOM();\n        if (!this.options['animationOnHide']) {\n            anim.ok = false;\n        }\n        if (!anim.ok) {\n            dom.style.display = 'none';\n            /**\n           * hide event.\n           *\n           * @event ui.UIComponent#hide\n           * @type {Object}\n           * @property {String} type - hide\n           * @property {ui.UIComponent} target - UIComponent\n           */\n            this.fire('hide');\n        } else {\n            /* eslint-disable no-unused-expressions */\n            dom.offsetHeight;\n            /* eslint-enable no-unused-expressions */\n            dom.style[TRANSITION] = anim.transition;\n            setTimeout(() => {\n                dom.style.display = 'none';\n                this.fire('hide');\n            }, this.options['animationDuration']);\n        }\n        if (anim.fade) {\n            dom.style.opacity = 0;\n        }\n        if (anim.scale) {\n            dom.style[TRANSFORM] = this._toCSSTranslate(this._pos) + ' scale(0)';\n        }\n        return this;\n    }\n\n    /**\n     * Decide whether the ui component is open\n     * @returns {Boolean} true|false\n     */\n    isVisible() {\n        const dom = this.getDOM();\n        return this.getMap() && dom && dom.parentNode && dom.style.display !== 'none';\n    }\n\n    /**\n     * Remove the UI Component\n     * @return {ui.UIComponent} this\n     * @fires ui.UIComponent#hide\n     * @fires ui.UIComponent#remove\n     */\n    remove() {\n        delete this._mapEventsOn;\n        if (!this._owner) {\n            return this;\n        }\n        this.hide();\n        this._switchEvents('off');\n        if (this.onRemove) {\n            this.onRemove();\n        }\n        if (!this._singleton() && this.__uiDOM) {\n            this._removePrevDOM();\n        }\n        delete this._owner;\n        /**\n         * remove event.\n         *\n         * @event ui.UIComponent#remove\n         * @type {Object}\n         * @property {String} type - remove\n         * @property {ui.UIComponent} target - UIComponent\n         */\n        this.fire('remove');\n        return this;\n    }\n\n    /**\n     * Get pixel size of the UI Component.\n     * @return {Size} size\n     */\n    getSize() {\n        if (this._size) {\n            return this._size.copy();\n        } else {\n            return null;\n        }\n    }\n\n    getOwner() {\n        return this._owner;\n    }\n\n    getDOM() {\n        return this.__uiDOM;\n    }\n\n    getPosition() {\n        if (!this.getMap()) {\n            return null;\n        }\n        const p = this._getViewPoint()._round();\n        if (this.getOffset) {\n            const o = this.getOffset()._round();\n            if (o) {\n                p._add(o);\n            }\n        }\n        return p;\n    }\n\n    _getAnimation() {\n        const anim = {\n            'fade': false,\n            'scale': false\n        };\n        const animations = this.options['animation'] ? this.options['animation'].split(',') : [];\n        for (let i = 0; i < animations.length; i++) {\n            const trimed = trim(animations[i]);\n            if (trimed === 'fade') {\n                anim.fade = true;\n            } else if (trimed === 'scale') {\n                anim.scale = true;\n            }\n        }\n        let transition = null;\n        if (anim.fade) {\n            transition = 'opacity ' + this.options['animationDuration'] + 'ms';\n        }\n        if (anim.scale) {\n            transition = transition ? transition + ',' : '';\n            transition += TRANSFORM + ' ' + this.options['animationDuration'] + 'ms';\n        }\n        anim.transition = transition;\n        anim.ok = (transition !== null);\n        return anim;\n    }\n\n    _getViewPoint() {\n        return this.getMap().coordToViewPoint(this._coordinate)\n            ._add(this.options['dx'], this.options['dy']);\n    }\n\n    _autoPan() {\n        const map = this.getMap(),\n            dom = this.getDOM();\n        if (map.isMoving()) {\n            return;\n        }\n        const point = this._pos;\n        const mapSize = map.getSize(),\n            mapWidth = mapSize['width'],\n            mapHeight = mapSize['height'];\n\n        const containerPoint = map.viewPointToContainerPoint(point);\n        const clientWidth = parseInt(dom.clientWidth),\n            clientHeight = parseInt(dom.clientHeight);\n        let left = 0,\n            top = 0;\n        if ((containerPoint.x) < 0) {\n            left = -(containerPoint.x - clientWidth / 2);\n        } else if ((containerPoint.x + clientWidth - 35) > mapWidth) {\n            left = (mapWidth - (containerPoint.x + clientWidth * 3 / 2));\n        }\n        if (containerPoint.y - clientHeight < 0) {\n            top = -(containerPoint.y - clientHeight) + 50;\n        } else if (containerPoint.y > mapHeight) {\n            top = (mapHeight - containerPoint.y - clientHeight) - 30;\n        }\n        if (top !== 0 || left !== 0) {\n            map.panBy(new Point(left, top), { 'duration': this.options['autoPanDuration'] });\n        }\n    }\n\n    /**\n     * Measure dom's size\n     * @param  {HTMLElement} dom - element to measure\n     * @return {Size} size\n     * @private\n     */\n    _measureSize(dom) {\n        const container = this._getUIContainer();\n        dom.style.position = 'absolute';\n        dom.style.left = -99999 + 'px';\n        const anchor = dom.style.bottom ? 'bottom' : 'top';\n        dom.style[anchor] = -99999 + 'px';\n        dom.style.display = '';\n        container.appendChild(dom);\n        this._size = new Size(dom.clientWidth, dom.clientHeight);\n        dom.style.display = 'none';\n        dom.style.left = '0px';\n        dom.style[anchor] = '0px';\n        return this._size;\n    }\n\n    /**\n     * Remove previous UI DOM if it has.\n     *\n     * @private\n     */\n    _removePrevDOM() {\n        if (this.onDomRemove) {\n            this.onDomRemove();\n        }\n        const eventsToStop = this.options['eventsToStop'];\n        if (this._singleton()) {\n            const map = this.getMap(),\n                key = this._uiDomKey();\n            if (map[key]) {\n                if (eventsToStop) {\n                    off(map[key], eventsToStop, stopPropagation);\n                }\n                removeDomNode(map[key]);\n                delete map[key];\n            }\n            delete this.__uiDOM;\n        } else if (this.__uiDOM) {\n            if (eventsToStop) {\n                off(this.__uiDOM, eventsToStop, stopPropagation);\n            }\n            removeDomNode(this.__uiDOM);\n            delete this.__uiDOM;\n        }\n    }\n\n    /**\n     * generate the cache key to store the singletong UI DOM\n     * @private\n     * @return {String} cache key\n     */\n    _uiDomKey() {\n        return '__ui_' + this._getClassName();\n    }\n\n    _singleton() {\n        return this.options['single'];\n    }\n\n    _getUIContainer() {\n        return this.getMap()._panels['ui'];\n    }\n\n    _getClassName() {\n        return 'UIComponent';\n    }\n\n    _switchMapEvents(to) {\n        const map = this.getMap();\n        if (!map) {\n            return;\n        }\n        this._mapEventsOn = (to === 'on');\n        const events = this._getDefaultEvents();\n        if (this.getEvents) {\n            extend(events, this.getEvents());\n        }\n        if (events) {\n            for (const p in events) {\n                if (events.hasOwnProperty(p)) {\n                    map[to](p, events[p], this);\n                }\n            }\n        }\n    }\n\n    _switchEvents(to) {\n        this._switchMapEvents(to);\n        const ownerEvents = this._getOwnerEvents();\n        if (this._owner) {\n            for (const p in ownerEvents) {\n                if (ownerEvents.hasOwnProperty(p)) {\n                    this._owner[to](p, ownerEvents[p], this);\n                }\n            }\n        }\n    }\n\n    _getDefaultEvents() {\n        return {\n            'zooming rotate pitch': this.onEvent,\n            'zoomend': this.onZoomEnd,\n            'moving': this.onMoving\n        };\n    }\n\n    _getOwnerEvents() {\n        const events = {};\n        if (this._owner && (this._owner instanceof Geometry)) {\n            events.positionchange = this.onGeometryPositionChange;\n        }\n        if (this.getOwnerEvents) {\n            extend(events, this.getOwnerEvents());\n        }\n        return events;\n    }\n\n    onGeometryPositionChange(param) {\n        if (this._owner && this.isVisible()) {\n            this.show(param['target'].getCenter());\n        }\n    }\n\n    onMoving() {\n        if (this.isVisible() && this.getMap().isTransforming()) {\n            this._updatePosition();\n        }\n    }\n\n    onEvent() {\n        if (this.isVisible()) {\n            this._updatePosition();\n        }\n    }\n\n    onZoomEnd() {\n        if (this.isVisible()) {\n            // when zoomend, map container is reset, position should be updated in current frame\n            this._setPosition();\n        }\n    }\n\n    _updatePosition() {\n        // update position in the next frame to sync with layers\n        const renderer = this.getMap()._getRenderer();\n        renderer.callInNextFrame(this._setPosition.bind(this));\n    }\n\n    _setPosition() {\n        const dom = this.getDOM();\n        if (!dom) return;\n        dom.style[TRANSITION] = null;\n        const p = this.getPosition();\n        this._pos = p;\n        dom.style[TRANSFORM] = this._toCSSTranslate(p) + ' scale(1)';\n    }\n\n    _toCSSTranslate(p) {\n        if (!p) {\n            return '';\n        }\n        if (Browser.any3d) {\n            const map = this.getMap(),\n                bearing = map ? map.getBearing() : 0,\n                pitch = map ? map.getPitch() : 0;\n            let r = '';\n            if (this.options['pitchWithMap'] && pitch) {\n                r += ` rotateX(${Math.round(pitch)}deg)`;\n            }\n            if (this.options['rotateWithMap'] && bearing) {\n                r += ` rotateZ(${Math.round(-bearing)}deg)`;\n            }\n            return 'translate3d(' + p.x + 'px,' + p.y + 'px, 0px)' + r;\n        } else {\n            return 'translate(' + p.x + 'px,' + p.y + 'px)';\n        }\n    }\n}\n\nUIComponent.mergeOptions(options);\n\nexport default UIComponent;\n","import { isString, flash } from '../core/util';\nimport { on, off, createEl, stopPropagation } from '../core/util/dom';\nimport Browser from '../core/Browser';\nimport Handler from '../handler/Handler';\nimport Handlerable from '../handler/Handlerable';\nimport DragHandler from '../handler/Drag';\nimport Coordinate from '../geo/Coordinate';\nimport Point from '../geo/Point';\nimport UIComponent from './UIComponent';\n\n/**\n * @property {Object} options - construct options\n * @property {Boolean} [options.draggable=false]  - if the marker can be dragged.\n * @property {Number}  [options.single=false]     - if the marker is a global single one.\n * @property {String|HTMLElement}  options.content - content of the marker, can be a string type HTML code or a HTMLElement.\n * @memberOf ui.UIMarker\n * @instance\n */\nconst options = {\n    'eventsPropagation' : true,\n    'draggable': false,\n    'single': false,\n    'content': null\n};\n\nconst domEvents =\n    /**\n     * mousedown event\n     * @event ui.UIMarker#mousedown\n     * @type {Object}\n     * @property {String} type                    - mousedown\n     * @property {UIMarker} target    - the uimarker fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'mousedown ' +\n    /**\n     * mouseup event\n     * @event ui.UIMarker#mouseup\n     * @type {Object}\n     * @property {String} type                    - mouseup\n     * @property {UIMarker} target    - the uimarker fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'mouseup ' +\n    /**\n     * mouseenter event\n     * @event ui.UIMarker#mouseenter\n     * @type {Object}\n     * @property {String} type                    - mouseenter\n     * @property {UIMarker} target    - the uimarker fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'mouseenter ' +\n    /**\n     * mouseover event\n     * @event ui.UIMarker#mouseover\n     * @type {Object}\n     * @property {String} type                    - mouseover\n     * @property {UIMarker} target    - the uimarker fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'mouseover ' +\n    /**\n     * mouseout event\n     * @event ui.UIMarker#mouseout\n     * @type {Object}\n     * @property {String} type                    - mouseout\n     * @property {UIMarker} target    - the uimarker fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'mouseout ' +\n    /**\n     * mousemove event\n     * @event ui.UIMarker#mousemove\n     * @type {Object}\n     * @property {String} type                    - mousemove\n     * @property {UIMarker} target    - the uimarker fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'mousemove ' +\n    /**\n     * click event\n     * @event ui.UIMarker#click\n     * @type {Object}\n     * @property {String} type                    - click\n     * @property {UIMarker} target    - the uimarker fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'click ' +\n    /**\n     * dblclick event\n     * @event ui.UIMarker#dblclick\n     * @type {Object}\n     * @property {String} type                    - dblclick\n     * @property {UIMarker} target    - the uimarker fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'dblclick ' +\n    /**\n     * contextmenu event\n     * @event ui.UIMarker#contextmenu\n     * @type {Object}\n     * @property {String} type                    - contextmenu\n     * @property {UIMarker} target    - the uimarker fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'contextmenu ' +\n    /**\n     * keypress event\n     * @event ui.UIMarker#keypress\n     * @type {Object}\n     * @property {String} type                    - keypress\n     * @property {UIMarker} target    - the uimarker fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'keypress ' +\n    /**\n     * touchstart event\n     * @event ui.UIMarker#touchstart\n     * @type {Object}\n     * @property {String} type                    - touchstart\n     * @property {UIMarker} target    - the uimarker fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'touchstart ' +\n    /**\n     * touchmove event\n     * @event ui.UIMarker#touchmove\n     * @type {Object}\n     * @property {String} type                    - touchmove\n     * @property {UIMarker} target    - the uimarker fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'touchmove ' +\n    /**\n     * touchend event\n     * @event ui.UIMarker#touchend\n     * @type {Object}\n     * @property {String} type                    - touchend\n     * @property {UIMarker} target    - the uimarker fires event\n     * @property {Coordinate} coordinate - coordinate of the event\n     * @property {Point} containerPoint  - container point of the event\n     * @property {Point} viewPoint       - view point of the event\n     * @property {Event} domEvent                 - dom event\n     */\n    'touchend';\n\n/**\n *\n * @classdesc\n * Class for UI Marker, a html based marker positioned by geographic coordinate. <br>\n *\n * @category ui\n * @extends ui.UIComponent\n * @mixes Handlerable\n * @memberOf ui\n * @example\n * var dom = document.createElement('div');\n * dom.innerHTML = 'hello ui marker';\n * var marker = new maptalks.ui.UIMarker([0, 0], {\n *      draggable : true,\n *      content : dom\n *  }).addTo(map);\n */\nclass UIMarker extends Handlerable(UIComponent) {\n\n    /**\n     * As it's renderered by HTMLElement such as a DIV, it: <br>\n     * 1. always on the top of all the map layers <br>\n     * 2. can't be snapped as it's not drawn on the canvas. <br>\n     * @param  {Coordinate} coordinate - UIMarker's coordinates\n     * @param {Object} options - options defined in [UIMarker]{@link UIMarker#options}\n     */\n    constructor(coordinate, options) {\n        super(options);\n        this._markerCoord = new Coordinate(coordinate);\n    }\n\n    // TODO: obtain class in super\n    _getClassName() {\n        return 'UIMarker';\n    }\n\n    /**\n     * Sets the coordinates\n     * @param {Coordinate} coordinates - UIMarker's coordinate\n     * @returns {UIMarker} this\n     * @fires UIMarker#positionchange\n     */\n    setCoordinates(coordinates) {\n        this._markerCoord = coordinates;\n        /**\n         * positionchange event.\n         *\n         * @event ui.UIMarker#positionchange\n         * @type {Object}\n         * @property {String} type - positionchange\n         * @property {UIMarker} target - ui marker\n         */\n        this.fire('positionchange');\n        if (this.isVisible()) {\n            this._coordinate = this._markerCoord;\n            this._setPosition();\n        }\n        return this;\n    }\n\n    /**\n     * Gets the coordinates\n     * @return {Coordinate} coordinates\n     */\n    getCoordinates() {\n        return this._markerCoord;\n    }\n\n    /**\n     * Sets the content of the UIMarker\n     * @param {String|HTMLElement} content - UIMarker's content\n     * @returns {UIMarker} this\n     * @fires UIMarker#contentchange\n     */\n    setContent(content) {\n        const old = this.options['content'];\n        this.options['content'] = content;\n        /**\n         * contentchange event.\n         *\n         * @event ui.UIMarker#contentchange\n         * @type {Object}\n         * @property {String} type - contentchange\n         * @property {UIMarker} target - ui marker\n         * @property {String|HTMLElement} old      - old content\n         * @property {String|HTMLElement} new      - new content\n         */\n        this.fire('contentchange', {\n            'old': old,\n            'new': content\n        });\n        if (this.isVisible()) {\n            this.show();\n        }\n        return this;\n    }\n\n    /**\n     * Gets the content of the UIMarker\n     * @return {String|HTMLElement} content\n     */\n    getContent() {\n        return this.options['content'];\n    }\n\n    onAdd() {\n        this.show();\n    }\n\n    /**\n     * Show the UIMarker\n     * @returns {UIMarker} this\n     * @fires UIMarker#showstart\n     * @fires UIMarker#showend\n     */\n    show() {\n        return super.show(this._markerCoord);\n    }\n\n    /**\n     * Flash the UIMarker, show and hide by certain internal for times of count.\n     *\n     * @param {Number} [interval=100]     - interval of flash, in millisecond (ms)\n     * @param {Number} [count=4]          - flash times\n     * @param {Function} [cb=null]        - callback function when flash ended\n     * @param {*} [context=null]          - callback context\n     * @return {UIMarker} this\n     */\n    flash(interval, count, cb, context) {\n        return flash.call(this, interval, count, cb, context);\n    }\n\n    /**\n     * A callback method to build UIMarker's HTMLElement\n     * @protected\n     * @param {Map} map - map to be built on\n     * @return {HTMLElement} UIMarker's HTMLElement\n     */\n    buildOn() {\n        let dom;\n        if (isString(this.options['content'])) {\n            dom = createEl('div');\n            dom.innerHTML = this.options['content'];\n        } else {\n            dom = this.options['content'];\n        }\n        this._registerDOMEvents(dom);\n        return dom;\n    }\n\n    /**\n     * Gets UIMarker's HTMLElement's position offset, it's caculated dynamically accordiing to its actual size.\n     * @protected\n     * @return {Point} offset\n     */\n    getOffset() {\n        const size = this.getSize();\n        return new Point(-size.width / 2, -size.height / 2);\n    }\n\n    /**\n     * Gets UIMarker's transform origin for animation transform\n     * @protected\n     * @return {Point} transform origin\n     */\n    getTransformOrigin() {\n        return 'center center';\n    }\n\n    onDomRemove() {\n        const dom = this.getDOM();\n        this._removeDOMEvents(dom);\n    }\n\n    /**\n     * Whether the uimarker is being dragged.\n     * @returns {Boolean}\n     */\n    isDragging() {\n        if (this['draggable']) {\n            return this['draggable'].isDragging();\n        }\n        return false;\n    }\n\n    _registerDOMEvents(dom) {\n        on(dom, domEvents, this._onDomEvents, this);\n    }\n\n    _onDomEvents(e) {\n        const event = this.getMap()._parseEvent(e, e.type);\n        this.fire(e.type, event);\n    }\n\n    _removeDOMEvents(dom) {\n        off(dom, domEvents, this._onDomEvents, this);\n    }\n\n    /**\n     * Get the connect points of panel for connector lines.\n     * @private\n     */\n    _getConnectPoints() {\n        const map = this.getMap();\n        const containerPoint = map.coordToContainerPoint(this.getCoordinates());\n        const size = this.getSize(),\n            width = size.width,\n            height = size.height;\n        const anchors = [\n            //top center\n            map.containerPointToCoordinate(\n                containerPoint.add(-width / 2, 0)\n            ),\n            //middle right\n            map.containerPointToCoordinate(\n                containerPoint.add(width / 2, 0)\n            ),\n            //bottom center\n            map.containerPointToCoordinate(\n                containerPoint.add(0, height / 2)\n            ),\n            //middle left\n            map.containerPointToCoordinate(\n                containerPoint.add(0, -height / 2)\n            )\n\n        ];\n        return anchors;\n    }\n}\n\nUIMarker.mergeOptions(options);\n\nconst EVENTS = Browser.touch ? 'touchstart mousedown' : 'mousedown';\n\nclass UIMarkerDragHandler extends Handler {\n\n    constructor(target) {\n        super(target);\n    }\n\n    addHooks() {\n        this.target.on(EVENTS, this._startDrag, this);\n    }\n\n    removeHooks() {\n        this.target.off(EVENTS, this._startDrag, this);\n    }\n\n    _startDrag(param) {\n        const domEvent = param['domEvent'];\n        if (domEvent.touches && domEvent.touches.length > 1 || domEvent.button === 2) {\n            return;\n        }\n        if (this.isDragging()) {\n            return;\n        }\n        this.target.on('click', this._endDrag, this);\n        this._lastCoord = param['coordinate'];\n        this._lastPoint = param['containerPoint'];\n\n        this._prepareDragHandler();\n        this._dragHandler.onMouseDown(param['domEvent']);\n        /**\n         * drag start event\n         * @event ui.UIMarker#dragstart\n         * @type {Object}\n         * @property {String} type                    - dragstart\n         * @property {UIMarker} target    - the uimarker fires event\n         * @property {Coordinate} coordinate - coordinate of the event\n         * @property {Point} containerPoint  - container point of the event\n         * @property {Point} viewPoint       - view point of the event\n         * @property {Event} domEvent                 - dom event\n         */\n        this.target.fire('dragstart', param);\n    }\n\n    _prepareDragHandler() {\n        this._dragHandler = new DragHandler(this.target.getDOM(), {\n            'cancelOn': this._cancelOn.bind(this),\n            'ignoreMouseleave' : true\n        });\n        this._dragHandler.on('mousedown', this._onMouseDown, this);\n        this._dragHandler.on('dragging', this._dragging, this);\n        this._dragHandler.on('mouseup', this._endDrag, this);\n        this._dragHandler.enable();\n    }\n\n    _cancelOn(domEvent) {\n        const target = domEvent.srcElement || domEvent.target,\n            tagName = target.tagName.toLowerCase();\n        if (tagName === 'button' ||\n            tagName === 'input' ||\n            tagName === 'select' ||\n            tagName === 'option' ||\n            tagName === 'textarea') {\n            return true;\n        }\n        return false;\n    }\n\n    _onMouseDown(param) {\n        stopPropagation(param['domEvent']);\n    }\n\n    _dragging(param) {\n        const target = this.target,\n            map = target.getMap(),\n            eventParam = map._parseEvent(param['domEvent']),\n            domEvent = eventParam['domEvent'];\n        if (domEvent.touches && domEvent.touches.length > 1) {\n            return;\n        }\n        if (!this._isDragging) {\n            this._isDragging = true;\n            return;\n        }\n\n        const coord = eventParam['coordinate'],\n            point = eventParam['containerPoint'];\n        if (!this._lastCoord) {\n            this._lastCoord = coord;\n        }\n        if (!this._lastPoint) {\n            this._lastPoint = point;\n        }\n        const coordOffset = coord.sub(this._lastCoord),\n            pointOffset = point.sub(this._lastPoint);\n        this._lastCoord = coord;\n        this._lastPoint = point;\n        this.target.setCoordinates(this.target.getCoordinates().add(coordOffset));\n        eventParam['coordOffset'] = coordOffset;\n        eventParam['pointOffset'] = pointOffset;\n\n        /**\n         * dragging event\n         * @event ui.UIMarker#dragging\n         * @type {Object}\n         * @property {String} type                    - dragging\n         * @property {UIMarker} target    - the uimarker fires event\n         * @property {Coordinate} coordinate - coordinate of the event\n         * @property {Point} containerPoint  - container point of the event\n         * @property {Point} viewPoint       - view point of the event\n         * @property {Event} domEvent                 - dom event\n         */\n        target.fire('dragging', eventParam);\n\n    }\n\n    _endDrag(param) {\n        const target = this.target,\n            map = target.getMap();\n        if (this._dragHandler) {\n            target.off('click', this._endDrag, this);\n            this._dragHandler.disable();\n            delete this._dragHandler;\n        }\n        delete this._lastCoord;\n        delete this._lastPoint;\n        this._isDragging = false;\n        if (!map) {\n            return;\n        }\n        const eventParam = map._parseEvent(param['domEvent']);\n        /**\n         * dragend event\n         * @event ui.UIMarker#dragend\n         * @type {Object}\n         * @property {String} type                    - dragend\n         * @property {UIMarker} target    - the uimarker fires event\n         * @property {Coordinate} coordinate - coordinate of the event\n         * @property {Point} containerPoint  - container point of the event\n         * @property {Point} viewPoint       - view point of the event\n         * @property {Event} domEvent                 - dom event\n         */\n        target.fire('dragend', eventParam);\n\n    }\n\n    isDragging() {\n        if (!this._isDragging) {\n            return false;\n        }\n        return true;\n    }\n}\n\nUIMarker.addInitHook('addHandler', 'draggable', UIMarkerDragHandler);\n\nexport default UIMarker;\n","import { isString } from '../core/util';\nimport { createEl, addDomEvent, removeDomEvent } from '../core/util/dom';\nimport Point from '../geo/Point';\nimport { Geometry, Marker, MultiPoint } from '../geometry';\nimport UIComponent from './UIComponent';\n\n\n/**\n * @property {Object} options\n * @property {Boolean} [options.autoPan=true]  - set it to false if you don't want the map to do panning animation to fit the opened window.\n * @property {Boolean} [options.autoCloseOn=null] - Auto close infowindow on map's events, e.g. \"click contextmenu\" will close infowindow with click or right click on map.\n * @property {Boolean} [options.autoOpenOn=null]  - Auto open infowindow on owner's events, e.g. \"click\" will open infowindow with click or right click on window's owner.\n * @property {Number}  [options.width=300]     - default width\n * @property {Number}  [options.minHeight=120] - minimun height\n * @property {Boolean} [options.custom=false]  - set it to true if you want a customized infowindow, customized html codes or a HTMLElement is set to content.\n * @property {String}  [options.title=null]    - title of the infowindow.\n * @property {String|HTMLElement}  options.content - content of the infowindow.\n * @memberOf ui.InfoWindow\n * @instance\n */\nconst options = {\n    'autoPan': true,\n    'autoCloseOn' : null,\n    'autoOpenOn' : 'click',\n    'width': 300,\n    'minHeight': 120,\n    'custom': false,\n    'title': null,\n    'content': null\n};\n\n/**\n * @classdesc\n * Class for info window, a popup on the map to display any useful infomation you wanted.\n * @category ui\n * @extends ui.UIComponent\n * @param {Object} options - options defined in [InfoWindow]{@link InfoWindow#options}\n * @memberOf ui\n */\nclass InfoWindow extends UIComponent {\n\n    // TODO: obtain class in super\n    _getClassName() {\n        return 'InfoWindow';\n    }\n\n    /**\n     * Adds the UI Component to a geometry or a map\n     * @param {Geometry|Map} owner - geometry or map to addto.\n     * @returns {UIComponent} this\n     * @fires UIComponent#add\n     */\n    addTo(owner) {\n        if (owner instanceof Geometry) {\n            if (owner.getInfoWindow() && owner.getInfoWindow() !== this) {\n                owner.removeInfoWindow();\n            }\n            owner._infoWindow = this;\n        }\n        return super.addTo(owner);\n    }\n\n    /**\n     * Set the content of the infowindow.\n     * @param {String|HTMLElement} content - content of the infowindow.\n     * return {InfoWindow} this\n     * @fires InfoWindow#contentchange\n     */\n    setContent(content) {\n        const old = this.options['content'];\n        this.options['content'] = content;\n        /**\n         * contentchange event.\n         *\n         * @event InfoWindow#contentchange\n         * @type {Object}\n         * @property {String} type - contentchange\n         * @property {InfoWindow} target - InfoWindow\n         * @property {String|HTMLElement} old      - old content\n         * @property {String|HTMLElement} new      - new content\n         */\n        this.fire('contentchange', {\n            'old': old,\n            'new': content\n        });\n        if (this.isVisible()) {\n            this.show(this._coordinate);\n        }\n        return this;\n    }\n\n    /**\n     * Get content of  the infowindow.\n     * @return {String|HTMLElement} - content of the infowindow\n     */\n    getContent() {\n        return this.options['content'];\n    }\n\n    /**\n     * Set the title of the infowindow.\n     * @param {String|HTMLElement} title - title of the infowindow.\n     * return {InfoWindow} this\n     * @fires InfoWindow#titlechange\n     */\n    setTitle(title) {\n        const old = title;\n        this.options['title'] = title;\n        /**\n         * titlechange event.\n         *\n         * @event InfoWindow#titlechange\n         * @type {Object}\n         * @property {String} type - titlechange\n         * @property {InfoWindow} target - InfoWindow\n         * @property {String} old      - old content\n         * @property {String} new      - new content\n         */\n        this.fire('contentchange', {\n            'old': old,\n            'new': title\n        });\n        if (this.isVisible()) {\n            this.show(this._coordinate);\n        }\n        return this;\n    }\n\n    /**\n     * Get title of  the infowindow.\n     * @return {String|HTMLElement} - content of the infowindow\n     */\n    getTitle() {\n        return this.options['title'];\n    }\n\n    buildOn() {\n        if (this.options['custom']) {\n            if (isString(this.options['content'])) {\n                const dom = createEl('div');\n                dom.innerHTML = this.options['content'];\n                return dom;\n            } else {\n                return this.options['content'];\n            }\n        }\n        const dom = createEl('div');\n        dom.className = 'maptalks-msgBox';\n        dom.style.width = this._getWindowWidth() + 'px';\n        dom.style.bottom = '0px'; // fix #657\n        let content = '<em class=\"maptalks-ico\"></em>';\n        if (this.options['title']) {\n            content += '<h2>' + this.options['title'] + '</h2>';\n        }\n        content += '<a href=\"javascript:void(0);\" class=\"maptalks-close\"></a><div class=\"maptalks-msgContent\"></div>';\n        dom.innerHTML = content;\n        const msgContent = dom.querySelector('.maptalks-msgContent');\n        if (isString(this.options['content'])) {\n            msgContent.innerHTML = this.options['content'];\n        } else {\n            msgContent.appendChild(this.options['content']);\n        }\n        this._onCloseBtnClick = this.hide.bind(this);\n        const closeBtn = dom.querySelector('.maptalks-close');\n        addDomEvent(closeBtn, 'click touchend', this._onCloseBtnClick);\n\n        return dom;\n    }\n\n    /**\n     * Gets InfoWindow's transform origin for animation transform\n     * @protected\n     * @return {Point} transform origin\n     */\n    getTransformOrigin() {\n        const size = this.getSize();\n        return size.width / 2 + 'px bottom';\n    }\n\n    getOffset() {\n        const size = this.getSize();\n        const o = new Point(-size['width'] / 2, 0);\n        if (!this.options['custom']) {\n            o._sub(4, 12);\n        } else {\n            o._sub(0, size['height']);\n        }\n        const owner = this.getOwner();\n        if (owner instanceof Marker || owner instanceof MultiPoint) {\n            let painter, markerSize;\n            if (owner instanceof Marker) {\n                painter = owner._getPainter();\n                markerSize = owner.getSize();\n            } else {\n                const children = owner.getGeometries();\n                if (!children || !children.length) {\n                    return o;\n                }\n                painter = children[0]._getPainter();\n                markerSize = children[0].getSize();\n            }\n            if (painter) {\n                const fixExtent = painter.getFixedExtent();\n                o._add(fixExtent.xmax - markerSize.width / 2, fixExtent.ymin);\n            }\n        }\n        return o;\n    }\n\n    show(coordinate) {\n        if (!this.getMap()) {\n            return this;\n        }\n        if (!this.getMap().options['enableInfoWindow']) {\n            return this;\n        }\n        return super.show(coordinate);\n    }\n\n    getEvents() {\n        if (!this.options['autoCloseOn']) {\n            return null;\n        }\n        const events = {};\n        events[this.options['autoCloseOn']] = this.hide;\n        return events;\n    }\n\n    getOwnerEvents() {\n        const owner = this.getOwner();\n        if (!this.options['autoOpenOn'] || !owner) {\n            return null;\n        }\n        const events = {};\n        events[this.options['autoOpenOn']] = this._onAutoOpen;\n        return events;\n    }\n\n    onRemove() {\n        this.onDomRemove();\n    }\n\n    onDomRemove() {\n        if (this._onCloseBtnClick) {\n            const dom = this.getDOM();\n            const closeBtn = dom.childNodes[2];\n            removeDomEvent(closeBtn, 'click touchend', this._onCloseBtnClick);\n            delete this._onCloseBtnClick;\n        }\n    }\n\n    _onAutoOpen(e) {\n        const owner = this.getOwner();\n        setTimeout(() => {\n            if (owner instanceof Marker) {\n                this.show(owner.getCoordinates());\n            } else if (owner instanceof MultiPoint) {\n                this.show(owner.findClosest(e.coordinate));\n            } else {\n                this.show(e.coordinate);\n            }\n        }, 1);\n    }\n\n    _getWindowWidth() {\n        const defaultWidth = 300;\n        let width = this.options['width'];\n        if (!width) {\n            width = defaultWidth;\n        }\n        return width;\n    }\n}\n\nInfoWindow.mergeOptions(options);\n\nexport default InfoWindow;\n","import { createEl } from '../core/util/dom';\nimport { Geometry } from '../geometry';\nimport UIComponent from './UIComponent';\nimport UIMarker from './UIMarker';\n\n\n/**\n * @property {Object} options\n * @property {Number}  [options.width=0]     - default width\n * @property {Number}  [options.height=0]     - default height\n * @property {String}  [options.animation='fade']     - default fade, scale | fade,scale are an alternative to set\n * @property {String}  [options.cssName=maptalks-tooltip]    - tooltip's css class name\n * @property {Number}  [options.showTimeout=400]      - timeout to show tooltip\n * @memberOf ui.ToolTip\n * @instance\n */\nconst options = {\n    'width': 0,\n    'height': 0,\n    'animation': 'fade',\n    'cssName': 'maptalks-tooltip',\n    'showTimeout' : 400\n};\n/**\n * @classdesc\n * Class for tooltip, a tooltip used for showing some useful infomation attached to geometries on the map.\n * @category ui\n * @extends ui.UIComponent\n * @memberOf ui\n */\nclass ToolTip extends UIComponent {\n    // TODO:obtain class in super\n    _getClassName() {\n        return 'ToolTip';\n    }\n\n    /**\n     * @param {String} content         - content of tooltip\n     * @param {Object} [options=null]  - options defined in [ToolTip]{@link ToolTip#options}\n     */\n    constructor(content, options = {}) {\n        super(options);\n        this._content = content;\n    }\n\n    /**\n     * Adds the UI Component to a geometry\n     * @param {Geometry} owner - geometry to add.\n     * @returns {UIComponent} this\n     * @fires UIComponent#add\n     */\n    addTo(owner) {\n        if (owner instanceof Geometry || owner instanceof UIMarker) {\n            owner.on('mousemove', this.onMouseMove, this);\n            owner.on('mouseout', this.onMouseOut, this);\n            return super.addTo(owner);\n        } else {\n            throw new Error('Invalid geometry or UIMarker the tooltip is added to.');\n        }\n    }\n\n    /**\n     * set ToolTip's content's css class name.\n     * @param {String} css class name - set for ToolTip's content.\n     */\n    setStyle(cssName) {\n        this.options.cssName = cssName;\n        return this;\n    }\n\n    /**\n     * get ToolTip's  content's css class name\n     * @returns {String} css class name - set for ToolTip's content.\n     */\n    getStyle() {\n        return this.options.cssName;\n    }\n\n    /**\n     * get the UI Component's content\n     * @returns {String} tooltip's content\n     */\n    getContent() {\n        return this._content;\n    }\n\n    buildOn() {\n        const dom = createEl('div');\n        const options = this.options || {};\n        if (options.height) {\n            dom.style.height = options.height + 'px';\n        }\n        if (options.width) {\n            dom.style.width = options.width + 'px';\n        }\n        const cssName = options.cssName;\n        if (!cssName && options.height) {\n            dom.style.lineHeight = options.height + 'px';\n        }\n        dom.innerHTML = `<div class=\"${cssName}\">${this._content}</div>`;\n        return dom;\n    }\n\n    onMouseOut() {\n        clearTimeout(this._timeout);\n        if (this.isVisible()) {\n            this._removePrevDOM();\n        }\n    }\n\n    onMouseMove(e) {\n        clearTimeout(this._timeout);\n        const map = this.getMap();\n        if (!map) {\n            return;\n        }\n        const coord = map.locateByPoint(e.coordinate, -5, 25);\n        if (this.options['showTimeout'] === 0) {\n            this.show(coord);\n        } else {\n            this._timeout = setTimeout(() => {\n                if (map) {\n                    this.show(coord);\n                }\n            }, this.options['showTimeout']);\n        }\n    }\n\n    /**\n     * remove the tooltip, this method will be called by 'this.remove()'\n     */\n    onRemove() {\n        clearTimeout(this._timeout);\n        if (this._owner) {\n            this._owner.off('mouseover', this.onMouseOver, this);\n            this._owner.off('mouseout', this.onMouseOut, this);\n        }\n    }\n}\n\nToolTip.mergeOptions(options);\n\nexport default ToolTip;\n","import { isString, isFunction } from '../core/util';\nimport { on, createEl, addClass, setStyle, preventDefault } from '../core/util/dom';\nimport Point from '../geo/Point';\nimport UIComponent from './UIComponent';\n\n/**\n * @property {Object} options\n * @property {Boolean} [options.autoPan=false]  - set it to false if you don't want the map to do panning animation to fit the opened menu.\n * @property {Number}  [options.width=160]      - default width\n * @property {Number}  [options.maxHeight=0]    - default max-height\n * @property {String|HTMLElement} [options.custom=false]  - set it to true if you want a customized menu, customized html codes or a HTMLElement is set to items.\n * @property {Object[]|String|HTMLElement}  options.items   - html code or a html element is options.custom is true. Or a menu items array, containing: item objects, \"-\" as a splitor line\n * @memberOf ui.Menu\n * @instance\n */\nconst defaultOptions = {\n    'animation': null,\n    'animationDelay': 10,\n    'animationOnHide': false,\n    'autoPan': false,\n    'width': 160,\n    'maxHeight' : 0,\n    'custom': false,\n    'items': []\n};\n\n/**\n * @classdesc\n * Class for context menu, useful for interactions with right clicks on the map.\n * @category ui\n * @extends ui.UIComponent\n * @memberOf ui\n */\nclass Menu extends UIComponent {\n\n    /**\n     * Menu items is set to options.items or by setItems method. <br>\n     * <br>\n     * Normally items is a object array, containing: <br>\n     * 1. item object: {'item': 'This is a menu text', 'click': function() {alert('oops! You clicked!');)}} <br>\n     * 2. minus string \"-\", which will draw a splitor line on the menu. <br>\n     * <br>\n     * If options.custom is set to true, the menu is considered as a customized one. Then items is the customized html codes or HTMLElement. <br>\n     * @param {Object} options - options defined in [ui.Menu]{@link ui.Menu#options}\n     */\n    constructor(options) {\n        super(options);\n    }\n\n    // TODO: obtain class in super\n    _getClassName() {\n        return 'Menu';\n    }\n\n    addTo(owner) {\n        if (owner._menu && owner._menu !== this) {\n            owner.removeMenu();\n        }\n        owner._menu = this;\n        return UIComponent.prototype.addTo.apply(this, arguments);\n    }\n\n    /**\n     * Set the items of the menu.\n     * @param {Object[]|String|HTMLElement} items - items of the menu\n     * return {ui.Menu} this\n     * @example\n     * menu.setItems([\n     *      //return false to prevent event propagation\n     *     {'item': 'Query', 'click': function() {alert('Query Clicked!'); return false;}},\n     *     '-',\n     *     {'item': 'Edit', 'click': function() {alert('Edit Clicked!')}},\n     *     {'item': 'About', 'click': function() {alert('About Clicked!')}}\n     * ]);\n     */\n    setItems(items) {\n        this.options['items'] = items;\n        return this;\n    }\n\n    /**\n     * Get items of  the menu.\n     * @return {Object[]|String|HTMLElement} - items of the menu\n     */\n    getItems() {\n        return this.options['items'] || [];\n    }\n\n    /**\n     * Create the menu DOM.\n     * @protected\n     * @return {HTMLElement} menu's DOM\n     */\n    buildOn() {\n        if (this.options['custom']) {\n            if (isString(this.options['items'])) {\n                const container = createEl('div');\n                container.innerHTML = this.options['items'];\n                return container;\n            } else {\n                return this.options['items'];\n            }\n        } else {\n            const dom = createEl('div');\n            addClass(dom, 'maptalks-menu');\n            dom.style.width = this._getMenuWidth() + 'px';\n            /*const arrow = createEl('em');\n            addClass(arrow, 'maptalks-ico');*/\n            const menuItems = this._createMenuItemDom();\n            // dom.appendChild(arrow);\n            dom.appendChild(menuItems);\n            on(dom, 'contextmenu', preventDefault);\n            return dom;\n        }\n    }\n\n    /**\n     * Offset of the menu DOM to fit the click position.\n     * @return {Point} offset\n     * @private\n     */\n    getOffset() {\n        if (!this.getMap()) {\n            return null;\n        }\n        const mapSize = this.getMap().getSize(),\n            p = this.getMap().viewPointToContainerPoint(this._getViewPoint()),\n            size = this.getSize();\n        let dx = 0,\n            dy = 0;\n        if (p.x + size['width'] > mapSize['width']) {\n            dx = -size['width'];\n        }\n        if (p.y + size['height'] > mapSize['height']) {\n            dy = -size['height'];\n        }\n        return new Point(dx, dy);\n    }\n\n    getTransformOrigin() {\n        const p = this.getOffset()._multi(-1);\n        return p.x + 'px ' + p.y + 'px';\n    }\n\n    getEvents() {\n        return {\n            '_zoomstart _zoomend _movestart _dblclick _click': this. _removePrevDOM\n        };\n    }\n\n    _createMenuItemDom() {\n        const me = this;\n        const map = this.getMap();\n        const ul = createEl('ul');\n        addClass(ul, 'maptalks-menu-items');\n        const items = this.getItems();\n\n        function onMenuClick(index) {\n            return function (e) {\n                const param = map._parseEvent(e, 'click');\n                param['target'] = me;\n                param['owner'] = me._owner;\n                param['index'] = index;\n                const result = this._callback(param);\n                if (result === false) {\n                    return;\n                }\n                me.hide();\n            };\n        }\n        let item, itemDOM;\n        for (let i = 0, len = items.length; i < len; i++) {\n            item = items[i];\n            if (item === '-' || item === '_') {\n                itemDOM = createEl('li');\n                addClass(itemDOM, 'maptalks-menu-splitter');\n            } else {\n                itemDOM = createEl('li');\n                let itemTitle = item['item'];\n                if (isFunction(itemTitle)) {\n                    itemTitle = itemTitle({\n                        'owner': this._owner,\n                        'index': i\n                    });\n                }\n                itemDOM.innerHTML = itemTitle;\n                itemDOM._callback = item['click'];\n                on(itemDOM, 'click', (onMenuClick)(i));\n            }\n            ul.appendChild(itemDOM);\n        }\n        const maxHeight = this.options['maxHeight'] || 0;\n        if (maxHeight > 0) {\n            setStyle(ul, 'max-height: ' + maxHeight + 'px; overflow-y: auto;');\n        }\n        return ul;\n    }\n\n    _getMenuWidth() {\n        const defaultWidth = 160;\n        const width = this.options['width'] || defaultWidth;\n        return width;\n    }\n}\n\nMenu.mergeOptions(defaultOptions);\n\nexport default Menu;\n","import Map from '../map/Map';\nimport Geometry from '../geometry/Geometry';\nimport Menu from './Menu';\n\n/**\n * Mixin of the context menu methods.\n * @mixin ui.Menuable\n */\nconst Menuable = {\n    /**\n     * Set a context menu\n     * @param {Object} options - menu options\n     * @return {*} this\n     * @example\n     * foo.setMenu({\n     *  'width'  : 160,\n     *  'custom' : false,\n     *  'items' : [\n     *      //return false to prevent event propagation\n     *     {'item': 'Query', 'click': function() {alert('Query Clicked!'); return false;}},\n     *     '-',\n     *     {'item': 'Edit', 'click': function() {alert('Edit Clicked!')}},\n     *     {'item': 'About', 'click': function() {alert('About Clicked!')}}\n     *    ]\n     * });\n     * @function ui.Menuable.setMenu\n     */\n    setMenu(options) {\n        this._menuOptions = options;\n\n        if (this._menu) {\n            this._menu.setOptions(options);\n        } else {\n            this.on('contextmenu', this._defaultOpenMenu, this);\n        }\n        return this;\n    },\n\n    /**\n     * Open the context menu, default on the center of the geometry or map.\n     * @param {Coordinate} [coordinate=null] - coordinate to open the context menu\n     * @return {*} this\n     * @function ui.Menuable.openMenu\n     */\n    openMenu(coordinate) {\n        const map = (this instanceof Map) ? this : this.getMap();\n        if (!coordinate) {\n            coordinate = this.getCenter();\n        }\n        if (!this._menu) {\n            if (this._menuOptions && map) {\n                this._bindMenu(this._menuOptions);\n                this._menu.show(coordinate);\n            }\n        } else {\n            this._menu.show(coordinate);\n        }\n        return this;\n    },\n\n    /**\n     * Set menu items to the context menu\n     * @param {Object[]} items - menu items\n     * @return {*} this\n     * @function ui.Menuable.setMenuItems\n     */\n    setMenuItems(items) {\n        if (!this._menuOptions) {\n            this._menuOptions = {};\n        }\n        if (Array.isArray(items)) {\n            this._menuOptions['custom'] = false;\n        }\n        this._menuOptions['items'] = items;\n        this.setMenu(this._menuOptions);\n        return this;\n    },\n\n    /**\n     * Get the context menu items\n     * @return {Object[]}\n     * @function ui.Menuable.getMenuItems\n     */\n    getMenuItems() {\n        if (this._menu) {\n            return this._menu.getItems();\n        } else if (this._menuOptions) {\n            return this._menuOptions['items'] || [];\n        }\n        return [];\n    },\n\n    /**\n     * Close the contexnt menu\n     * @return {*} this\n     * @function ui.Menuable.closeMenu\n     */\n    closeMenu() {\n        if (this._menu) {\n            this._menu.hide();\n        }\n        return this;\n    },\n\n    /**\n     * Remove the context menu\n     * @return {*} this\n     * @function ui.Menuable.removeMenu\n     */\n    removeMenu() {\n        this.off('contextmenu', this._defaultOpenMenu, this);\n        this._unbindMenu();\n        delete this._menuOptions;\n        return this;\n    },\n\n    _bindMenu(options) {\n        this._menu = new Menu(options);\n        this._menu.addTo(this);\n\n        return this;\n    },\n\n    _unbindMenu() {\n        if (this._menu) {\n            this.closeMenu();\n            this._menu.remove();\n            delete this._menu;\n        }\n        return this;\n    },\n\n    /**\n     * If contextmenu is not listened, open the menu in default.<br>\n     * Otherwise, do nothing here.\n     * @param  {Object} param - event parameter\n     * @return {Boolean} true | false to stop event propagation\n     * @private\n     */\n    _defaultOpenMenu(param) {\n        if (this.listens('contextmenu') > 1) {\n            return true;\n        } else {\n            this.openMenu(param['coordinate']);\n            return false;\n        }\n    }\n};\n\nMap.include(Menuable);\nGeometry.include(Menuable);\n\nexport default Menuable;\n","import { extend, isNil, isString } from '../core/util';\nimport { createEl, setStyle, removeDomNode } from '../core/util/dom';\nimport Eventable from '../core/Eventable';\nimport Class from '../core/Class';\nimport Point from '../geo/Point';\nimport Map from '../map/Map';\n\n/**\n * Base class for all the map controls, you can extend it to build your own customized Control.\n * It is abstract and not intended to be instantiated.\n * @category control\n * @memberOf control\n * @abstract\n * @extends Class\n * @mixes Eventable\n */\nclass Control extends Eventable(Class) {\n\n    /**\n     * Methods needs to implement:  <br>\n     *  <br>\n     * 1. Method to create UI's Dom element  <br>\n     * function buildOn : HTMLElement  <br>\n     *  <br>\n     * 2. Optional, a callback when the control is added.  <br>\n     * function onAdd : void  <br>\n     * 3. Optional, a callback when the control is removed.  <br>\n     * function onRemove : void  <br>\n     *  <br>\n     * @param  {Object} [options=null] configuration options\n     */\n    constructor(options) {\n        if (options && options['position'] && !isString(options['position'])) {\n            options['position'] = extend({}, options['position']);\n        }\n        super(options);\n    }\n\n    /**\n     * Adds the control to a map.\n     * @param {Map} map\n     * @returns {control.Control} this\n     * @fires control.Control#add\n     */\n    addTo(map) {\n        this.remove();\n        if (!map.options['control']) {\n            return this;\n        }\n        this._map = map;\n        const controlContainer = map._panels.control;\n        this.__ctrlContainer = createEl('div');\n        setStyle(this.__ctrlContainer, 'position:absolute;overflow:visible;');\n        // on(this.__ctrlContainer, 'mousedown mousemove click dblclick contextmenu', stopPropagation)\n        this.update();\n        controlContainer.appendChild(this.__ctrlContainer);\n        if (this.onAdd) {\n            this.onAdd();\n        }\n        /**\n         * add event.\n         *\n         * @event control.Control#add\n         * @type {Object}\n         * @property {String} type - add\n         * @property {control.Control} target - the control instance\n         */\n        this.fire('add', {\n            'dom': controlContainer\n        });\n        return this;\n    }\n\n    /**\n     * update control container\n     * @return {control.Control} this\n     */\n    update() {\n        this.__ctrlContainer.innerHTML = '';\n        this._controlDom = this.buildOn(this.getMap());\n        if (this._controlDom) {\n            this._updatePosition();\n            this.__ctrlContainer.appendChild(this._controlDom);\n        }\n        return this;\n    }\n\n    /**\n     * Get the map that the control is added to.\n     * @return {Map}\n     */\n    getMap() {\n        return this._map;\n    }\n\n    /**\n     * Get the position of the control\n     * @return {Object}\n     */\n    getPosition() {\n        return extend({}, this._parse(this.options['position']));\n    }\n\n    /**\n     * update the control's position\n     * @param {String|Object} position - can be one of 'top-left', 'top-right', 'bottom-left', 'bottom-right' or a position object like {'top': 40,'left': 60}\n     * @return {control.Control} this\n     * @fires control.Control#positionchange\n     */\n    setPosition(position) {\n        if (isString(position)) {\n            this.options['position'] = position;\n        } else {\n            this.options['position'] = extend({}, position);\n        }\n        this._updatePosition();\n        return this;\n    }\n\n    /**\n     * Get the container point of the control.\n     * @return {Point}\n     */\n    getContainerPoint() {\n        const position = this.getPosition();\n\n        const size = this.getMap().getSize();\n        let x, y;\n        if (!isNil(position['left'])) {\n            x = parseInt(position['left']);\n        } else if (!isNil(position['right'])) {\n            x = size['width'] - parseInt(position['right']);\n        }\n        if (!isNil(position['top'])) {\n            y = parseInt(position['top']);\n        } else if (!isNil(position['bottom'])) {\n            y = size['height'] - parseInt(position['bottom']);\n        }\n        return new Point(x, y);\n    }\n\n    /**\n     * Get the control's container.\n     * Container is a div element wrapping the control's dom and decides the control's position and display.\n     * @return {HTMLElement}\n     */\n    getContainer() {\n        return this.__ctrlContainer;\n    }\n\n    /**\n     * Get html dom element of the control\n     * @return {HTMLElement}\n     */\n    getDOM() {\n        return this._controlDom;\n    }\n\n    /**\n     * Show\n     * @return {control.Control} this\n     */\n    show() {\n        this.__ctrlContainer.style.display = '';\n        return this;\n    }\n\n    /**\n     * Hide\n     * @return {control.Control} this\n     */\n    hide() {\n        this.__ctrlContainer.style.display = 'none';\n        return this;\n    }\n\n    /**\n     * Whether the control is visible\n     * @return {Boolean}\n     */\n    isVisible() {\n        return (this.__ctrlContainer && this.__ctrlContainer.style.display === '');\n    }\n\n    /**\n     * Remove itself from the map\n     * @return {control.Control} this\n     * @fires control.Control#remove\n     */\n    remove() {\n        if (!this._map) {\n            return this;\n        }\n        removeDomNode(this.__ctrlContainer);\n        if (this.onRemove) {\n            this.onRemove();\n        }\n        delete this._map;\n        delete this.__ctrlContainer;\n        delete this._controlDom;\n        /**\n         * remove event.\n         *\n         * @event control.Control#remove\n         * @type {Object}\n         * @property {String} type - remove\n         * @property {control.Control} target - the control instance\n         */\n        this.fire('remove');\n        return this;\n    }\n\n    _parse(position) {\n        let p = position;\n        if (isString(position)) {\n            p = Control['positions'][p];\n        }\n        return p;\n    }\n\n    _updatePosition() {\n        let position = this.getPosition();\n        if (!position) {\n            //default one\n            position = {\n                'top': 20,\n                'left': 20\n            };\n        }\n        for (const p in position) {\n            if (position.hasOwnProperty(p)) {\n                position[p] = parseInt(position[p]);\n                this.__ctrlContainer.style[p] = position[p] + 'px';\n            }\n        }\n        /**\n         * Control's position update event.\n         *\n         * @event control.Control#positionchange\n         * @type {Object}\n         * @property {String} type - positionchange\n         * @property {control.Control} target - the control instance\n         * @property {Object} position - Position of the control, eg:{\"top\" : 100, \"left\" : 50}\n         */\n        this.fire('positionchange', {\n            'position': extend({}, position)\n        });\n    }\n\n}\n\nControl.positions = {\n    'top-left': {\n        'top'   : 20,\n        'left'  : 20\n    },\n    'top-right': {\n        'top'   : 20,\n        'right' : 20\n    },\n    'bottom-left': {\n        'bottom': 20,\n        'left'  : 20\n    },\n    'bottom-right': {\n        'bottom': 20,\n        'right' : 20\n    }\n};\n\nMap.mergeOptions({\n    'control': true\n});\n\nMap.include(/** @lends Map.prototype */ {\n    /**\n     * Add a control on the map.\n     * @param {control.Control} control - contorl to add\n     * @return {Map} this\n     */\n    addControl: function (control) {\n        // if map container is a canvas, can't add control on it.\n        if (this._containerDOM.getContext) {\n            return this;\n        }\n        control.addTo(this);\n        return this;\n    },\n\n    /**\n     * Remove a control from the map.\n     * @param {control.Control} control - control to remove\n     * @return {Map} this\n     */\n    removeControl: function (control) {\n        if (!control || control.getMap() !== this) {\n            return this;\n        }\n        control.remove();\n        return this;\n    }\n\n});\n\nexport default Control;\n","import { createEl } from '../core/util/dom';\nimport Control from './Control';\nimport Map from '../map/Map';\n\n/**\n * @property {Object} options - options\n * @property {Object} [options.position='bottom-left'] - position of the control, this option defined in [Control.position]{@link Control#positions}.\n * @property {String} [options.content='Powered by <a href=\"http://maptalks.org\" target=\"_blank\">maptalks</a>']  - content of the attribution control, HTML format\n * @memberOf control.Attribution\n * @instance\n */\nconst options = {\n    'position': {\n        'bottom': 0,\n        'left': 0\n    },\n    'content': '<a href=\"http://maptalks.org\" target=\"_blank\">maptalks</a>'\n};\n\nconst layerEvents = 'addlayer removelayer setbaselayer baselayerremove';\n\n/**\n * @classdesc\n * A control to allows to display attribution content in a small text box on the map.\n * @category control\n * @extends control.Control\n * @memberOf control\n * @example\n * var map = new maptalks.Map('map', {\n *    center: [-0.113049, 51.498568],\n *    zoom: 14,\n *    attribution: {\n *       content : 'my attribution',\n *       position : 'bottom-left'\n *    },\n *    baseLayer: new maptalks.TileLayer('base', {\n *        urlTemplate: 'http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png',\n *        subdomains: ['a','b','c','d'],\n *        attribution: '&copy; <a href=\"http://osm.org\">OpenStreetMap</a> contributors, &copy; <a href=\"https://carto.com/\">CARTO</a>'\n *    })\n * });\n * map.addLayer(new maptalks.TileLayer('base', {\n *      urlTemplate: 'http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png',\n *      subdomains: ['a','b','c','d'],\n *      attribution: '&copy; <a href=\"http://osm.org\">OpenStreetMap</a> contributors, &copy; <a href=\"https://carto.com/\">CARTO</a>'\n * }));\n */\nclass Attribution extends Control {\n\n    buildOn() {\n        this._attributionContainer = createEl('div');\n        this._attributionContainer.className = 'maptalks-attribution';\n        this._update();\n        return this._attributionContainer;\n    }\n\n    onAdd() {\n        this.getMap().on(layerEvents, this._update, this);\n    }\n\n    onRemove() {\n        this.getMap().off(layerEvents, this._update, this);\n    }\n\n    _update() {\n        const map = this.getMap();\n        if (!map) {\n            return;\n        }\n\n        const attributions = map\n            ._getLayers(layer => layer.options['attribution'])\n            .reverse()\n            .map(layer => layer.options['attribution']);\n        const content = this.options['content'] + (attributions.length > 0 ? ' - ' + attributions.join(', ') : '');\n        this._attributionContainer.innerHTML = '<span style=\"padding:0px 4px\">' + content + '</span>';\n    }\n}\n\nAttribution.mergeOptions(options);\n\nMap.mergeOptions({\n    'attribution': true\n});\n\nMap.addOnLoadHook(function () {\n    const a = this.options['attribution'] || this.options['attributionControl'];\n    if (a) {\n        this.attributionControl = new Attribution(a);\n        this.addControl(this.attributionControl);\n    }\n});\n\nexport default Attribution;\n","import { on, off, createEl, removeDomNode, addClass, hasClass, setClass } from '../core/util/dom';\nimport Map from '../map/Map';\nimport Control from './Control';\n\n/**\n * @property {Object} options - options\n * @property {Object} [options.position='top-right'] - position of the control\n * @property {Object} [options.baseTitle='Base Layers'] - title of the base layers\n * @property {Object} [options.overlayTitle='Layers'] - title of the overlay layers\n * @property {Object} [options.excludeLayers=[]] - ids of layers that don't display in layerswitcher\n * @property {Object} [options.containerClass=maptalks-layer-switcher] - layerswitcher's container div's CSS class\n *\n * @memberOf control.LayerSwitcher\n * @instance\n */\nconst options = {\n    'position' : 'top-right',\n    'baseTitle' : 'Base Layers',\n    'overlayTitle' : 'Layers',\n    'excludeLayers' : [],\n    'containerClass' : 'maptalks-layer-switcher'\n};\n\n/**\n * @classdesc\n * A LayerSwitcher control for the map.\n * @category control\n * @extends control.Control\n * @memberOf control\n * @example\n * var LayerSwitcher = new LayerSwitcher({\n *     position : {'top': '0', 'right': '0'}\n * }).addTo(map);\n*/\nclass LayerSwitcher extends Control {\n    /**\n     * method to build DOM of the control\n     * @return {HTMLDOMElement}\n     */\n    buildOn() {\n        const container = this.container = createEl('div', this.options['containerClass']),\n            panel = this.panel = createEl('div', 'panel'),\n            button = this.button = createEl('button');\n        container.appendChild(button);\n        container.appendChild(panel);\n        return container;\n    }\n\n    onAdd() {\n        on(this.button, 'mouseover', this._show, this);\n        on(this.panel, 'mouseleave', this._hide, this);\n        on(this.getMap(), 'click', this._hide, this);\n    }\n\n    onRemove() {\n        if (this.panel) {\n            off(this.button, 'mouseover', this._show, this);\n            off(this.panel, 'mouseleave', this._hide, this);\n            off(this.getMap(), 'click', this._hide, this);\n            removeDomNode(this.panel);\n            removeDomNode(this.button);\n            delete this.panel;\n            delete this.button;\n            delete this.container;\n        }\n    }\n\n    _show() {\n        if (!hasClass(this.container, 'shown')) {\n            addClass(this.container, 'shown');\n            this._createPanel();\n        }\n    }\n\n    _hide(e) {\n        if (!this.panel.contains(e.toElement || e.relatedTarget)) {\n            setClass(this.container, this.options['containerClass']);\n        }\n    }\n\n    _createPanel() {\n        this.panel.innerHTML = '';\n        const ul = createEl('ul');\n        this.panel.appendChild(ul);\n        this._renderLayers(this.getMap(), ul);\n    }\n\n    _renderLayers(map, elm) {\n        const base = map.getBaseLayer(),\n            layers = map.getLayers(),\n            len = layers.length;\n        if (base) {\n            const baseLayers = base.layers || [base],\n                li = createEl('li', 'group'),\n                ul =  createEl('ul'),\n                label = createEl('label');\n            label.innerHTML = this.options['baseTitle'];\n            li.appendChild(label);\n            for (let i = 0, len = baseLayers.length; i < len; i++) {\n                const layer = baseLayers[i];\n                if (this._isExcluded(layer)) {\n                    ul.appendChild(this._renderLayer(baseLayers[i], true));\n                    li.appendChild(ul);\n                    elm.appendChild(li);\n                }\n            }\n        }\n\n        if (len) {\n            const li = createEl('li', 'group'),\n                ul = createEl('ul'),\n                label = createEl('label');\n            label.innerHTML = this.options['overlayTitle'];\n            li.appendChild(label);\n            for (let i = 0; i < len; i++) {\n                const layer = layers[i];\n                if (this._isExcluded(layer)) {\n                    ul.appendChild(this._renderLayer(layer));\n                }\n            }\n            li.appendChild(ul);\n            elm.appendChild(li);\n        }\n    }\n\n    _isExcluded(layer) {\n        const id = layer.getId(),\n            excludeLayers = this.options['excludeLayers'];\n        return !(excludeLayers.length && excludeLayers.indexOf(id) >= 0);\n    }\n\n    _renderLayer(layer, isBase) {\n        const li = createEl('li', 'layer'),\n            label =  createEl('label'),\n            input = createEl('input'),\n            map = this.getMap();\n        const visible = layer.options['visible'];\n        layer.options['visible'] = true;\n        const enabled = layer.isVisible();\n        layer.options['visible'] = visible;\n        li.className = 'layer';\n        if (isBase) {\n            input.type = 'radio';\n            input.name = 'base';\n        } else {\n            input.type = 'checkbox';\n        }\n\n        input.checked = visible && enabled;\n        if (!enabled) {\n            input.setAttribute('disabled', 'disabled');\n        }\n\n        input.onchange = e => {\n            if (e.target.type === 'radio') {\n                const baseLayer = map.getBaseLayer(),\n                    baseLayers = baseLayer.layers;\n                if (baseLayers) {\n                    for (let i = 0, len = baseLayers.length; i < len; i++) {\n                        const _baseLayer = baseLayers[i];\n                        _baseLayer[_baseLayer === layer ? 'show' : 'hide']();\n                    }\n                } else if (!baseLayer.isVisible()) {\n                    baseLayer.show();\n                }\n                map._fireEvent('setbaselayer');\n            } else {\n                layer[e.target.checked ? 'show' : 'hide']();\n            }\n            this.fire('layerchange', { target : layer });\n        };\n        li.appendChild(input);\n        label.innerHTML = layer.getId();\n        li.appendChild(label);\n        return li;\n    }\n}\n\nLayerSwitcher.mergeOptions(options);\n\nMap.mergeOptions({\n    'layerSwitcherControl': false\n});\n\nMap.addOnLoadHook(function () {\n    if (this.options['layerSwitcherControl']) {\n        this.layerSwitcherControl = new LayerSwitcher(this.options['layerSwitcherControl']);\n        this.addControl(this.layerSwitcherControl);\n    }\n});\n\nexport default LayerSwitcher;\n","import { extend, isFunction } from '../core/util';\nimport { on, off, createEl, computeDomPosition } from '../core/util/dom';\nimport Polygon from '../geometry/Polygon';\nimport Layer from '../layer/Layer';\nimport VectorLayer from '../layer/VectorLayer';\nimport Map from '../map/Map';\nimport Control from './Control';\n\n/**\n * @property {Object} options - options\n * @property {Object} [options.position='bottom-right'] - position of the control\n * @property {Number} [options.level=4]  - the zoom level of the overview\n * @property {Object} [options.maximize=true]  - whether to maximize overview when added\n * @property {Object} [options.size=[300, 200]  - size of the Control\n * @property {Object} [options.symbol={}] - symbol of the overview rectangle\n * @property {Object} [options.containerClass=maptalks-overview] - overview's container div's CSS class\n * @property {Object} [options.buttonClass=maptalks-overview-button] - overview's minimize/maximize button's CSS class\n *\n * @memberOf control.Overview\n * @instance\n */\nconst options = {\n    'level': 4,\n    'position': {\n        'right' : 1,\n        'bottom' : 1\n    },\n    'size': [300, 200],\n    'maximize' : true,\n    'symbol': {\n        'lineWidth': 3,\n        'lineColor': '#1bbc9b',\n        'polygonFill': '#1bbc9b',\n        'polygonOpacity': 0.4\n    },\n    'containerClass' : 'maptalks-overview',\n    'buttonClass' : 'maptalks-overview-button'\n};\n\n/**\n * @classdesc\n * An overview control for the map.\n * @category control\n * @extends control.Control\n * @memberOf control\n * @example\n * var overview = new Overview({\n *     position : {'bottom': '0', 'right': '0'},\n *     size : {'width' : 300,'height' : 200}\n * }).addTo(map);\n */\nclass Overview extends Control {\n\n    /**\n     * method to build DOM of the control\n     * @param  {Map} map map to build on\n     * @return {HTMLDOMElement}\n     */\n    buildOn() {\n        let size = this.options['size'];\n        if (!this.options['maximize']) {\n            size = [0, 0];\n        }\n        const container = createEl('div');\n\n        const mapContainer = this.mapContainer = createEl('div');\n        mapContainer.style.width = size[0] + 'px';\n        mapContainer.style.height = size[1] + 'px';\n        mapContainer.className = this.options['containerClass'];\n        const button = this.button = createEl('div');\n        button.className = this.options['buttonClass'];\n        container.appendChild(mapContainer);\n        container.appendChild(button);\n        return container;\n    }\n\n    onAdd() {\n        if (this.options['maximize']) {\n            this._createOverview();\n        }\n        this.getMap().on('resize moving zooming rotate dragrotating viewchange', this._update, this)\n            .on('setbaselayer', this._updateBaseLayer, this)\n            .on('spatialreferencechange', this._updateSpatialReference, this);\n        on(this.button, 'click', this._onButtonClick, this);\n        this._updateButtonText();\n    }\n\n    onRemove() {\n        this.getMap()\n            .off('resize moving zooming rotate dragrotating viewchange', this._update, this)\n            .off('setbaselayer', this._updateBaseLayer, this)\n            .off('spatialreferencechange', this._updateSpatialReference, this);\n        if (this._overview) {\n            this._overview.remove();\n            delete this._overview;\n            delete this._perspective;\n        }\n        off(this.button, 'click', this._onButtonClick, this);\n    }\n\n    /**\n     * Maximize overview control\n     * @returns {control.Overview}\n     */\n    maxmize() {\n        const size = this.options['size'];\n        const dom = this.mapContainer;\n        dom.style.width = size[0] + 'px';\n        dom.style.height = size[1] + 'px';\n        this._createOverview();\n        return this;\n    }\n\n    /**\n     * Minimize overview control\n     * @returns {control.Overview}\n     */\n    minimize() {\n        if (this._overview) {\n            this._overview.remove();\n        }\n        delete this._overview;\n        delete this._perspective;\n        const dom = this.mapContainer;\n        dom.style.width = 0 + 'px';\n        dom.style.height = 0 + 'px';\n        return this;\n    }\n\n    /**\n     * Return overview's map object\n     * @returns {Map}\n     */\n    getOverviewMap() {\n        return this._overview;\n    }\n\n    _onButtonClick() {\n        if (!this._overview) {\n            this.maxmize();\n        } else {\n            this.minimize();\n        }\n        this._updateButtonText();\n    }\n\n    _updateButtonText() {\n        if (this._overview) {\n            this.button.innerHTML = '-';\n        } else {\n            this.button.innerHTML = '+';\n        }\n    }\n\n    _createOverview() {\n        const map = this.getMap(),\n            dom = this.mapContainer;\n        const options = map.config();\n        extend(options, {\n            'center': map.getCenter(),\n            'zoom': this._getOverviewZoom(),\n            'zoomAnimationDuration'  : 150,\n            'pitch' : 0,\n            'bearing' : 0,\n            'scrollWheelZoom': false,\n            'checkSize': false,\n            'doubleClickZoom': false,\n            'touchZoom': false,\n            'control': false,\n            'draggable' : false,\n            'maxExtent' : null\n        });\n        this._overview = new Map(dom, options);\n        this._updateBaseLayer();\n        this._perspective = new Polygon(this._getPerspectiveCoords(), {\n            'draggable': true,\n            'cursor': 'move',\n            'symbol': this.options['symbol']\n        })\n            .on('dragend', this._onDragEnd, this);\n        new VectorLayer('perspective_layer', this._perspective).addTo(this._overview);\n        this.fire('load');\n    }\n\n    _getOverviewZoom() {\n        const map = this.getMap(),\n            zoom = map.getZoom(),\n            minZoom = map.getMinZoom(),\n            level = this.options['level'];\n        if (level > 0) {\n            for (let i = level; i > 0; i--) {\n                if (zoom - i >= minZoom) {\n                    return zoom - i;\n                }\n            }\n        } else {\n            for (let i = level; i < 0; i++) {\n                if (zoom - i >= minZoom) {\n                    return zoom - i;\n                }\n            }\n        }\n\n        return zoom;\n    }\n\n\n    _onDragEnd() {\n        const center = this._perspective.getCenter();\n        this._overview.setCenter(center);\n        this.getMap().panTo(center);\n    }\n\n    _getPerspectiveCoords() {\n        const map = this.getMap();\n        return map.getContainerExtent().toArray().map(c => map.containerPointToCoordinate(c));\n    }\n\n    _update() {\n        if (!this._overview) {\n            return;\n        }\n        // refresh map's dom position\n        computeDomPosition(this._overview._containerDOM);\n        const coords = this._getPerspectiveCoords();\n        this._perspective.setCoordinates(coords);\n        this._overview.setCenterAndZoom(this.getMap().getCenter(), this._getOverviewZoom());\n    }\n\n    _updateSpatialReference() {\n        if (!this._overview) {\n            return;\n        }\n        const map = this.getMap();\n        const spatialRef = map.options['spatialReference'];\n        this._overview.setSpatialReference(spatialRef);\n    }\n\n    _updateBaseLayer() {\n        if (!this._overview) {\n            return;\n        }\n        const map = this.getMap(),\n            baseLayer = map.getBaseLayer();\n        if (!baseLayer) {\n            this._overview.setBaseLayer(null);\n            return;\n        }\n        const layers = baseLayer.layers;\n        let showIndex = 0;\n        if (layers) {\n            for (let i = 0, l = layers.length; i < l; i++) {\n                const layer = layers[i];\n                if (layer.isVisible()) {\n                    showIndex = i;\n                    break;\n                }\n            }\n        }\n\n        const json = baseLayer.toJSON();\n        let options = null;\n        if (layers) {\n            options = json.layers[showIndex].options;\n            options.visible = true;\n        } else {\n            options = json.options;\n        }\n        this._overview.setMinZoom(options.minZoom || null)\n            .setMaxZoom(options.maxZoom || null);\n        delete options.minZoom;\n        delete options.maxZoom;\n        delete json.options.canvas;\n        json.options.visible = true;\n        json.options.renderer = 'canvas';\n        const layer = Layer.fromJSON(json);\n        for (const p in baseLayer) {\n            if (isFunction(baseLayer[p]) && baseLayer.hasOwnProperty(p) && baseLayer[p] !== baseLayer.constructor.prototype[p]) {\n                layer[p] = baseLayer[p];\n            }\n        }\n        this._overview.setBaseLayer(layer);\n    }\n}\n\nOverview.mergeOptions(options);\n\nMap.mergeOptions({\n    'overviewControl': false\n});\n\nMap.addOnLoadHook(function () {\n    if (this.options['overviewControl']) {\n        this.overviewControl = new Overview(this.options['overviewControl']);\n        this.addControl(this.overviewControl);\n    }\n});\n\nexport default Overview;\n","import { extend, isNil, isString } from '../core/util';\nimport { createEl } from '../core/util/dom';\nimport DragHandler from '../handler/Drag';\nimport Control from './Control';\n\n/**\n * @property {Object} options - options\n * @property {Object} [options.position='top-right']       - position of the control\n * @property {Boolean} [options.draggable=true]            - whether the panel can be dragged\n * @property {Boolean} [options.custom=false]              - whether the panel's content is customized .\n * @property {String|HTMLElement} options.content          - panel's content, can be a dom element or a string.\n * @property {Boolean} [options.closeButton=true]          - whether to display the close button on the panel.\n * @memberOf control.Panel\n * @instance\n */\nconst options = {\n    'position': 'top-right',\n    'draggable': true,\n    'custom': false,\n    'content': '',\n    'closeButton': true\n};\n\n\n\n/**\n * @classdesc\n * Class for panel controls.\n * @category control\n * @extends control.Control\n * @memberOf control\n * @example\n * var panel = new Panel({\n *     position : {'bottom': '0', 'right': '0'},\n *     draggable : true,\n *     custom : false,\n *     content : '<div class=\"map-panel\">hello </div>',\n *     closeButton : true\n * }).addTo(map);\n */\nclass Panel extends Control {\n\n    /**\n     * method to build DOM of the control\n     * @param  {Map} map map to build on\n     * @return {HTMLDOMElement}\n     */\n    buildOn() {\n        let dom;\n        if (this.options['custom']) {\n            if (isString(this.options['content'])) {\n                dom = createEl('div');\n                dom.innerHTML = this.options['content'];\n            } else {\n                dom = this.options['content'];\n            }\n        } else {\n            dom = createEl('div', 'maptalks-panel');\n            if (this.options['closeButton']) {\n                const closeButton = createEl('a', 'maptalks-close');\n                closeButton.href = 'javascript:;';\n                closeButton.onclick = function () {\n                    dom.style.display = 'none';\n                };\n                dom.appendChild(closeButton);\n            }\n\n            const panelContent = createEl('div', 'maptalks-panel-content');\n            panelContent.innerHTML = this.options['content'];\n            dom.appendChild(panelContent);\n        }\n\n        this.draggable = new DragHandler(dom, {\n            'cancelOn': this._cancelOn.bind(this),\n            'ignoreMouseleave' : true\n        });\n\n        this.draggable.on('dragstart', this._onDragStart, this)\n            .on('dragging', this._onDragging, this)\n            .on('dragend', this._onDragEnd, this);\n\n        if (this.options['draggable']) {\n            this.draggable.enable();\n        }\n\n        return dom;\n    }\n\n    /**\n     * update control container\n     * @return {control.Panel} this\n     */\n    update() {\n        if (this.draggable) {\n            this.draggable.disable();\n            delete this.draggable;\n        }\n        return Control.prototype.update.call(this);\n    }\n\n    /**\n     * Set the content of the Panel.\n     * @param {String|HTMLElement} content - content of the infowindow.\n     * return {control.Panel} this\n     * @fires Panel#contentchange\n     */\n    setContent(content) {\n        const old = this.options['content'];\n        this.options['content'] = content;\n        /**\n         * contentchange event.\n         *\n         * @event Panel#contentchange\n         * @type {Object}\n         * @property {String} type - contentchange\n         * @property {control.Panel} target - Panel\n         * @property {String|HTMLElement} old      - old content\n         * @property {String|HTMLElement} new      - new content\n         */\n        this.fire('contentchange', {\n            'old': old,\n            'new': content\n        });\n        if (this.isVisible()) {\n            this.update();\n        }\n        return this;\n    }\n\n    /**\n     * Get content of  the infowindow.\n     * @return {String|HTMLElement} - content of the infowindow\n     */\n    getContent() {\n        return this.options['content'];\n    }\n\n    _cancelOn(domEvent) {\n        const target = domEvent.srcElement || domEvent.target,\n            tagName = target.tagName.toLowerCase();\n        if (tagName === 'button' ||\n            tagName === 'input' ||\n            tagName === 'select' ||\n            tagName === 'option' ||\n            tagName === 'textarea') {\n            return true;\n        }\n        return false;\n    }\n\n    _onDragStart(param) {\n        this._startPos = param['mousePos'];\n        this._startPosition = extend({}, this.getPosition());\n        /**\n         * drag start event\n         * @event control.Panel#dragstart\n         * @type {Object}\n         * @property {String} type        - dragstart\n         * @property {UIMarker} target    - the panel control fires event\n         * @property {Point} mousePos     - mouse position\n         * @property {Event} domEvent     - dom event\n         */\n        this.fire('dragstart', param);\n    }\n\n    _onDragging(param) {\n        const pos = param['mousePos'];\n        const offset = pos.sub(this._startPos);\n\n        const startPosition = this._startPosition;\n        const position = this.getPosition();\n        if (!isNil(position['top'])) {\n            position['top'] = parseInt(startPosition['top']) + offset.y;\n        }\n        if (!isNil(position['bottom'])) {\n            position['bottom'] = parseInt(startPosition['bottom']) - offset.y;\n        }\n        if (!isNil(position['left'])) {\n            position['left'] = parseInt(startPosition['left']) + offset.x;\n        }\n        if (!isNil(position['right'])) {\n            position['right'] = parseInt(startPosition['right']) - offset.x;\n        }\n        this.setPosition(position);\n        /**\n         * dragging event\n         * @event control.Panel#dragging\n         * @type {Object}\n         * @property {String} type        - dragging\n         * @property {UIMarker} target    - the panel control fires event\n         * @property {Point} mousePos     - mouse position\n         * @property {Event} domEvent     - dom event\n         */\n        this.fire('dragging', param);\n    }\n\n    _onDragEnd(param) {\n        delete this._startPos;\n        delete this._startPosition;\n        /**\n         * drag end event\n         * @event control.Panel#dragend\n         * @type {Object}\n         * @property {String} type        - dragend\n         * @property {UIMarker} target    - the panel control fires event\n         * @property {Point} mousePos     - mouse position\n         * @property {Event} domEvent     - dom event\n         */\n        this.fire('dragend', param);\n    }\n\n    /**\n     * Get the connect points of panel for connector lines.\n     * @private\n     */\n    _getConnectPoints() {\n        const map = this.getMap();\n        const containerPoint = this.getContainerPoint();\n        const dom = this.getDOM(),\n            width = parseInt(dom.clientWidth),\n            height = parseInt(dom.clientHeight);\n        const anchors = [\n            //top center\n            map.containerPointToCoordinate(\n                containerPoint.add(width / 2, 0)\n            ),\n            //middle right\n            map.containerPointToCoordinate(\n                containerPoint.add(width, height / 2)\n            ),\n            //bottom center\n            map.containerPointToCoordinate(\n                containerPoint.add(width / 2, height)\n            ),\n            //middle left\n            map.containerPointToCoordinate(\n                containerPoint.add(0, height / 2)\n            )\n\n        ];\n        return anchors;\n    }\n\n}\n\nPanel.mergeOptions(options);\n\nexport default Panel;\n","import { createEl, createElOn } from '../core/util/dom';\nimport Map from '../map/Map';\nimport Control from './Control';\n\n/**\n * @property {Object} [options=null] - options\n * @property {String|Object}   [options.position=\"bottom-left\"]  - position of the scale control.\n * @property {Number} [options.maxWidth=100]               - max width of the scale control.\n * @property {Boolean} [options.metric=true]               - Whether to show the metric scale line (m/km).\n * @property {Boolean} [options.imperial=false]            - Whether to show the imperial scale line (mi/ft).\n * @property {String|Object} [options.containerClass=null]           - scalControl's container div's CSS class\n * @instance\n * @memberOf control.Scale\n */\nconst options = {\n    'position': 'bottom-left',\n    'maxWidth': 100,\n    'metric': true,\n    'imperial': false,\n    'containerClass': null\n};\n\n/**\n * @classdesc\n * Based on scale control of Leaflet, a simple scale control that shows the scale of the current center of screen in metric (m/km) and imperial (mi/ft) systems.\n * @category control\n * @extends control.Control\n * @memberOf control\n * @example\n * var scale = new Scale({\n *     position : 'bottom-left',\n *     maxWidth : 160,\n *     metric : true,\n *     imperial : true,\n *     containerClass : null\n * }).addTo(map);\n */\nclass Scale extends Control {\n\n    /**\n     * method to build DOM of the control\n     * @param  {Map} map map to build on\n     * @return {HTMLDOMElement}\n     */\n    buildOn(map) {\n        this._map = map;\n        this._scaleContainer = createEl('div', this.options['containerClass']);\n        this._addScales();\n        map.on('zoomend', this._update, this);\n        if (this._map._loaded) {\n            this._update();\n        }\n        return this._scaleContainer;\n    }\n\n    onRemove() {\n        this.getMap().off('zoomend', this._update, this);\n    }\n\n    _addScales() {\n        const css = 'border: 2px solid #000000;border-top: none;line-height: 1.1;padding: 0px;' +\n            'color: #000000;font-size: 11px;text-align:center;white-space: nowrap;overflow: hidden' +\n            ';-moz-box-sizing: content-box;box-sizing: content-box;background: #fff; background: rgba(255, 255, 255, 0);';\n        if (this.options['metric']) {\n            this._mScale = createElOn('div', this.options['containerClass'] ? null : css, this._scaleContainer);\n        }\n        if (this.options['imperial']) {\n            this._iScale = createElOn('div', this.options['containerClass'] ? null : css, this._scaleContainer);\n        }\n    }\n\n    _update() {\n        const map = this._map;\n        const maxMeters = map.pixelToDistance(this.options['maxWidth'], 0);\n        this._updateScales(maxMeters);\n    }\n\n    _updateScales(maxMeters) {\n        if (this.options['metric'] && maxMeters) {\n            this._updateMetric(maxMeters);\n        }\n        if (this.options['imperial'] && maxMeters) {\n            this._updateImperial(maxMeters);\n        }\n    }\n\n    _updateMetric(maxMeters) {\n        const meters = this._getRoundNum(maxMeters),\n            label = meters < 1000 ? meters + ' m' : (meters / 1000) + ' km';\n\n        this._updateScale(this._mScale, label, meters / maxMeters);\n    }\n\n    _updateImperial(maxMeters) {\n        const maxFeet = maxMeters * 3.2808399;\n        let maxMiles, miles, feet;\n\n        if (maxFeet > 5280) {\n            maxMiles = maxFeet / 5280;\n            miles = this._getRoundNum(maxMiles);\n            this._updateScale(this._iScale, miles + ' mile', miles / maxMiles);\n\n        } else {\n            feet = this._getRoundNum(maxFeet);\n            this._updateScale(this._iScale, feet + ' feet', feet / maxFeet);\n        }\n    }\n\n    _updateScale(scale, text, ratio) {\n        scale['style']['width'] = Math.round(this.options['maxWidth'] * ratio) + 'px';\n        scale['innerHTML'] = text;\n    }\n\n    _getRoundNum(num) {\n        const pow10 = Math.pow(10, (Math.floor(num) + '').length - 1);\n        let d = num / pow10;\n\n        d = d >= 10 ? 10 :\n            d >= 5 ? 5 :\n                d >= 3 ? 3 :\n                    d >= 2 ? 2 : 1;\n\n        return pow10 * d;\n    }\n}\n\nScale.mergeOptions(options);\n\nMap.mergeOptions({\n    'scaleControl': false\n});\n\nMap.addOnLoadHook(function () {\n    if (this.options['scaleControl']) {\n        this.scaleControl = new Scale(this.options['scaleControl']);\n        this.addControl(this.scaleControl);\n    }\n});\n\nexport default Scale;\n","import { isArrayHasData } from '../core/util';\nimport { stringLength } from '../core/util/strings';\nimport { on, createEl, addClass, stopPropagation, measureDom, isHTML } from '../core/util/dom';\nimport Control from './Control';\n\n/**\n * @property {Object}   options - options\n * @property {String|Object}   [options.position=\"top-right\"]          - position of the toolbar control.\n * @property {Boolean}  [options.vertical=true]                        - Whether the toolbar is a vertical one.\n * @property {Boolean}  [options.reverseMenu=false]                    - Whether to reverse direction of drop menu.\n * @property {Object[]} options.items                                  - items on the toolbar\n * @memberOf control.Toolbar\n * @instance\n */\nconst options = {\n    'height': 28,\n    'vertical': false,\n    'position': 'top-right',\n    'reverseMenu' : false,\n    'items': {\n        //default buttons\n    }\n};\n\n/**\n * @classdesc\n * A toolbar control of the map.\n * @category control\n * @extends control.Control\n * @memberOf control\n * @example\n * var toolbar = new Toolbar({\n *     position : 'top-right',\n *     items: [\n *          {\n *            item: 'item1',\n *            click: function () {\n *              alert('item1 clicked');\n *            }\n *          },\n *          {\n *            item: 'item2',\n *            click: function () {\n *              alert('item2 clicked');\n *            }\n *          }\n *      ]\n * }).addTo(map);\n */\nclass Toolbar extends Control {\n    /**\n     * method to build DOM of the control\n     * @param  {Map} map map to build on\n     * @return {HTMLDOMElement}\n     */\n    buildOn(map) {\n        this._map = map;\n        const dom = createEl('div');\n        const ul = createEl('ul', 'maptalks-toolbar-hx');\n        dom.appendChild(ul);\n\n        if (this.options['vertical']) {\n            addClass(dom, 'maptalks-toolbar-vertical');\n        } else {\n            addClass(dom, 'maptalks-toolbar-horizonal');\n        }\n        const me = this;\n\n        function onButtonClick(fn, index, childIndex, targetDom) {\n            const item = me._getItems()[index];\n            return function (e) {\n                stopPropagation(e);\n                return fn({\n                    'target': item,\n                    'index': index,\n                    'childIndex': childIndex,\n                    'dom': targetDom\n                });\n            };\n        }\n\n        const items = this.options['items'];\n        if (isArrayHasData(items)) {\n            for (let i = 0, len = items.length; i < len; i++) {\n                const item = items[i];\n                const li = createEl('li');\n                if (this.options['height'] !== 28) {\n                    li.style.lineHeight = this.options['height'] + 'px';\n                }\n                li.style.height = this.options['height'] + 'px';\n                li.style.cursor = 'pointer';\n                if (isHTML(item['item'])) {\n                    li.style.textAlign = 'center';\n                    const itemSize = measureDom('div', item['item']);\n                    //vertical-middle\n                    li.innerHTML = '<div style=\"margin-top:' + (this.options['height'] - itemSize['height']) / 2 + 'px;\">' + item['item'] + '</div>';\n                } else {\n                    li.innerHTML = item['item'];\n                }\n                if (item['click']) {\n                    on(li, 'click', (onButtonClick)(item['click'], i, null, li));\n                }\n                if (isArrayHasData(item['children'])) {\n                    const dropMenu = this._createDropMenu(i);\n                    li.appendChild(dropMenu);\n                    li._menu = dropMenu;\n                    on(li, 'mouseover', function () {\n                        this._menu.style.display = '';\n                    });\n                    on(li, 'mouseout', function () {\n                        this._menu.style.display = 'none';\n                    });\n                }\n                ul.appendChild(li);\n            }\n        }\n        return dom;\n    }\n\n    _createDropMenu(index) {\n        const me = this;\n\n        function onButtonClick(fn, index, childIndex) {\n            const item = me._getItems()[index]['children'][childIndex];\n            return function (e) {\n                stopPropagation(e);\n                return fn({\n                    'target': item,\n                    'index': index,\n                    'childIndex': childIndex\n                });\n            };\n        }\n        const menuDom = createEl('div', 'maptalks-dropMenu'),\n            items = this._getItems(),\n            len = items.length,\n            menuUL = createEl('ul'),\n            children = items[index]['children'];\n        if (index === len - 1 && children) {\n            menuDom.style.cssText = 'right: 0px;';\n            menuUL.style.cssText = 'right: 0px;position: absolute;';\n            if (this.options['reverseMenu']) {\n                menuUL.style.bottom = 0;\n            }\n        }\n        menuDom.appendChild(createEl('em', 'maptalks-ico'));\n\n        let liWidth = 0;\n        for (let i = 0, l = children.length; i < l; i++) {\n            const size = stringLength(children[i]['item'], '12px');\n            if (size.width > liWidth) {\n                liWidth = size.width;\n            }\n        }\n        for (let i = 0, l = children.length; i < l; i++) {\n            const child = children[i];\n            const li = createEl('li');\n            li.innerHTML = '<a href=\"javascript:;\">' + child['item'] + '</a>';\n            li.style.cursor = 'pointer';\n            li.style.width = (liWidth + 24) + 'px'; // 20 for text-intent\n            on(li.childNodes[0], 'click', (onButtonClick)(child['click'], index, i));\n            menuUL.appendChild(li);\n        }\n        if (this.options['vertical']) {\n            const width = liWidth < 95 ? 95 : liWidth;\n            if (this.options['reverseMenu']) {\n                menuDom.style.right = -(width + 10 * 2) + 'px';\n            } else {\n                menuDom.style.left = -(width + 10 * 2) + 'px'; // 10: padding in .maptalks-toolbar-vertical li\n            }\n        } else if (this.options['reverseMenu']) {\n            menuDom.style.bottom = '28px';\n        } else {\n            menuDom.style.top = '28px';\n        }\n        menuDom.appendChild(menuUL);\n        menuDom.style.display = 'none';\n        return menuDom;\n    }\n\n    _getItems() {\n        return this.options['items'] || [];\n    }\n}\n\nToolbar.mergeOptions(options);\n\nexport default Toolbar;\n","import { isInteger } from '../core/util';\nimport { on, off, createEl, preventDefault, getEventContainerPoint } from '../core/util/dom';\nimport Map from '../map/Map';\nimport Control from './Control';\nimport DragHandler from '../handler/Drag';\n\n/**\n * @property {Object}   options - options\n * @property {String|Object}   [options.position=\"top-left\"]  - position of the zoom control.\n * @property {Boolean}  [options.slider=true]                         - Whether to display the slider\n * @property {Boolean}  [options.zoomLevel=true]                      - Whether to display the text box of zoom level\n * @memberOf control.Zoom\n * @instance\n */\nconst options = {\n    'position': 'top-left',\n    'slider': true,\n    'zoomLevel': true,\n    'seamless' : false\n};\n\nconst UNIT = 10;\n\n/**\n * @classdesc\n * A zoom control with buttons to zoomin/zoomout and a slider indicator for the zoom level.\n * @category control\n * @extends control.Control\n * @memberOf control\n * @example\n * var zoomControl = new Zoom({\n *     position : 'top-left',\n *     slider : true,\n *     zoomLevel : false\n * }).addTo(map);\n */\nclass Zoom extends Control {\n    /**\n     * method to build DOM of the control\n     * @param  {Map} map map to build on\n     * @return {HTMLDOMElement}\n     */\n    buildOn(map) {\n        const options = this.options;\n\n        const dom = createEl('div', 'maptalks-zoom');\n\n        if (options['zoomLevel']) {\n            const levelDOM = createEl('span', 'maptalks-zoom-zoomlevel');\n            dom.appendChild(levelDOM);\n            this._levelDOM = levelDOM;\n        }\n\n        const zoomDOM = createEl('div', 'maptalks-zoom-slider');\n\n        const zoomInButton = createEl('a', 'maptalks-zoom-zoomin');\n        zoomInButton.href = 'javascript:;';\n        zoomInButton.innerHTML = '+';\n        zoomDOM.appendChild(zoomInButton);\n        this._zoomInButton = zoomInButton;\n\n        if (options['slider']) {\n            const box = createEl('div', 'maptalks-zoom-slider-box');\n            const ruler = createEl('div', 'maptalks-zoom-slider-ruler');\n            const reading = createEl('span', 'maptalks-zoom-slider-reading');\n            const dot = createEl('span', 'maptalks-zoom-slider-dot');\n            ruler.appendChild(reading);\n            box.appendChild(ruler);\n            box.appendChild(dot);\n            zoomDOM.appendChild(box);\n            this._sliderBox = box;\n            this._sliderRuler = ruler;\n            this._sliderReading = reading;\n            this._sliderDot = dot;\n        }\n\n        const zoomOutButton = createEl('a', 'maptalks-zoom-zoomout');\n        zoomOutButton.href = 'javascript:;';\n        zoomOutButton.innerHTML = '-';\n        zoomDOM.appendChild(zoomOutButton);\n        this._zoomOutButton = zoomOutButton;\n\n        dom.appendChild(zoomDOM);\n\n        map.on('_zoomend _zooming _zoomstart _spatialreferencechange', this._update, this);\n\n        this._update();\n        this._registerDomEvents();\n\n        return dom;\n    }\n\n    onRemove() {\n        this.getMap().off('_zoomend _zooming _zoomstart _spatialreferencechange', this._update, this);\n        if (this._zoomInButton) {\n            off(this._zoomInButton, 'click', this._onZoomInClick, this);\n        }\n        if (this._zoomOutButton) {\n            off(this._zoomOutButton, 'click', this._onZoomOutClick, this);\n        }\n        if (this._sliderRuler) {\n            off(this._sliderRuler, 'click', this._onClickRuler, this);\n            this.dotDragger.disable();\n            delete this.dotDragger;\n        }\n    }\n\n    _update() {\n        const map = this.getMap();\n        if (this._sliderBox) {\n            const totalRange = (map.getMaxZoom() - map.getMinZoom()) * UNIT;\n            this._sliderBox.style.height = totalRange + 16 + 'px';\n            this._sliderRuler.style.height = totalRange + 8 + 'px';\n            this._sliderRuler.style.cursor = 'pointer';\n            const zoomRange = (map.getMaxZoom() - map.getZoom()) * UNIT;\n            //this._sliderReading.style.height = (map.getZoom() - map.getMinZoom()) * UNIT + 'px';\n            this._sliderReading.style.height = (map.getZoom() - map.getMinZoom() + 1) * UNIT + 'px';\n            this._sliderDot.style.top = zoomRange + 'px';\n        }\n        this._updateText();\n    }\n\n    _updateText() {\n        if (this._levelDOM) {\n            const map = this.getMap();\n            let zoom = map.getZoom();\n            if (!isInteger(zoom)) {\n                zoom = Math.round(zoom * 10) / 10;\n            }\n            this._levelDOM.innerHTML = zoom;\n        }\n    }\n\n    _registerDomEvents() {\n        if (this._zoomInButton) {\n            on(this._zoomInButton, 'click', this._onZoomInClick, this);\n        }\n        if (this._zoomOutButton) {\n            on(this._zoomOutButton, 'click', this._onZoomOutClick, this);\n        }\n        if (this._sliderRuler) {\n            on(this._sliderRuler, 'click', this._onClickRuler, this);\n            this.dotDragger = new DragHandler(this._sliderDot, {\n                'ignoreMouseleave' : true\n            });\n            this.dotDragger.on('dragstart', this._onDotDragstart, this)\n                .on('dragging dragend', this._onDotDrag, this)\n                .enable();\n        }\n    }\n\n    _onZoomInClick(e) {\n        preventDefault(e);\n        this.getMap().zoomIn();\n    }\n\n    _onZoomOutClick(e) {\n        preventDefault(e);\n        this.getMap().zoomOut();\n    }\n\n    _onClickRuler(e) {\n        preventDefault(e);\n        const map = this.getMap(),\n            point = getEventContainerPoint(e, this._sliderRuler),\n            h = point.y;\n        const maxZoom = map.getMaxZoom(),\n            zoom = Math.floor(maxZoom - h / UNIT);\n        map.setZoom(zoom);\n    }\n\n    _onDotDragstart(e) {\n        preventDefault(e.domEvent);\n        const map = this.getMap(),\n            origin = map.getSize().toPoint()._multi(1 / 2);\n        map.onZoomStart(map.getZoom(), origin);\n    }\n\n    _onDotDrag(e) {\n        preventDefault(e.domEvent);\n        const map = this.getMap(),\n            origin = map.getSize().toPoint()._multi(1 / 2),\n            point = getEventContainerPoint(e.domEvent, this._sliderRuler),\n            maxZoom = map.getMaxZoom(),\n            minZoom = map.getMinZoom();\n        let top = point.y,\n            z = maxZoom - top / UNIT;\n\n        if (maxZoom < z) {\n            z = maxZoom;\n            top = 0;\n        } else if (minZoom > z) {\n            z = minZoom;\n            top = (maxZoom - minZoom) * UNIT;\n        }\n\n        if (e.type === 'dragging') {\n            map.onZooming(z, origin, 1);\n        } else if (e.type === 'dragend') {\n            if (this.options['seamless']) {\n                map.onZoomEnd(z, origin);\n            } else {\n                map.onZoomEnd(Math.round(z), origin);\n            }\n        }\n        this._sliderDot.style.top = top + 'px';\n        //this._sliderReading.style.height = (map.getZoom() - minZoom) * UNIT + 'px';\n        this._sliderReading.style.height = (map.getZoom() - minZoom + 1) * UNIT + 'px';\n        this._updateText();\n    }\n}\n\nZoom.mergeOptions(options);\n\nMap.mergeOptions({\n    'zoomControl': false\n});\n\nMap.addOnLoadHook(function () {\n    if (this.options['zoomControl']) {\n        this.zoomControl = new Zoom(this.options['zoomControl']);\n        this.addControl(this.zoomControl);\n    }\n});\n\nexport default Zoom;\n","import { extend } from '../../../core/util';\n\n/**\n * @classdesc\n * A class internally used by tile layer helps to descibe tile system used by different tile services.<br>\n *\n * @class\n * @category layer\n * @example\n * var ts = new TileSystem([1, -1, -20037508.34, 20037508.34]);\n */\nclass TileSystem {\n\n    /**\n     * Similar with [transformation]{@link Transformation}, it contains 4 numbers: sx, sy, ox, oy.<br>\n     * @see {@link http://wiki.osgeo.org/wiki/Tile_Map_Service_Specification}\n     * @param  {Number} sx the order of X-axis tile index, 1 means right is larger and -1 means the reverse, left is larger;\n     * @param  {Number} sy the order of Y-axis tile index, 1 means top is larger and -1 means the reverse, bottom is larger;\n     * @param  {Number} ox x of the origin point of the world's projected coordinate system\n     * @param  {Number} oy y of the origin point of the world's projected coordinate system\n     */\n    constructor(sx, sy, ox, oy) {\n        if (Array.isArray(sx)) {\n            this.scale = {\n                x: sx[0],\n                y: sx[1]\n            };\n            this.origin = {\n                x: sx[2],\n                y: sx[3]\n            };\n        } else {\n            this.scale = {\n                x: sx,\n                y: sy\n            };\n            this.origin = {\n                x: ox,\n                y: oy\n            };\n        }\n    }\n\n    /**\n     * Get the default tile system's code for the projection.\n     * @param  {Object} projection      - a projection object\n     * @return {String} tile system code\n     */\n    static getDefault(projection) {\n        if (projection['code'].toLowerCase() === 'baidu') {\n            return 'baidu';\n        } else if (projection['code'].toLowerCase() === 'EPSG:4326'.toLowerCase()) {\n            return 'tms-global-geodetic';\n        } else if (projection['code'].toLowerCase() === 'identity') {\n            return [1, -1, 0, 0];\n        } else {\n            return 'web-mercator';\n        }\n    }\n}\n\nconst semiCircum = 6378137 * Math.PI;\n\nextend(TileSystem, /** @lends TileSystem */ {\n    /**\n     * The most common used tile system, used by google maps, bing maps and amap, soso maps in China.\n     * @see {@link https://en.wikipedia.org/wiki/Web_Mercator}\n     * @constant\n     * @static\n     */\n    'web-mercator': new TileSystem([1, -1, -semiCircum, semiCircum]),\n\n    /**\n     * Predefined tile system for TMS tile system, A tile system published by [OSGEO]{@link http://www.osgeo.org/}. <br>\n     * Also used by mapbox's [mbtiles]{@link https://github.com/mapbox/mbtiles-spec} specification.\n     * @see {@link http://wiki.osgeo.org/wiki/Tile_Map_Service_Specification}\n     * @constant\n     * @static\n     */\n    'tms-global-mercator': new TileSystem([1, 1, -semiCircum, -semiCircum]),\n\n    /**\n     * Another tile system published by [OSGEO]{@link http://www.osgeo.org/}, based on EPSG:4326 SRS.\n     * @see {@link http://wiki.osgeo.org/wiki/Tile_Map_Service_Specification#global-geodetic}\n     * @constant\n     * @static\n     */\n    'tms-global-geodetic': new TileSystem([1, 1, -180, -90]),\n\n    /**\n     * Tile system used by [baidu]{@link http://map.baidu.com}\n     * @constant\n     * @static\n     */\n    'baidu': new TileSystem([1, 1, 0, 0])\n});\n\nexport default TileSystem;\n","import { isString } from '../../../core/util';\nimport Coordinate from '../../../geo/Coordinate';\nimport Extent from '../../../geo/Extent';\nimport Transformation from '../../../geo/transformation/Transformation';\nimport TileSystem from './TileSystem';\n\n/**\n * Tile config for tile layers, an utilities class for tile layers to render tiles\n * @class\n * @category layer\n * @private\n */\nclass TileConfig {\n\n    /**\n     * @param {TileSystem} tileSystem  - tileSystem\n     * @param {Extent} fullExtent      - fullExtent of the tile layer\n     * @param {Size} tileSize          - tile size\n     */\n    constructor(tileSystem, fullExtent, tileSize) {\n        this.tileSize = tileSize;\n        this.fullExtent = fullExtent;\n        this.prepareTileInfo(tileSystem, fullExtent);\n        this._xScale = fullExtent['right'] >= fullExtent['left'] ? 1 : -1;\n        this._yScale = fullExtent['top'] >= fullExtent['bottom'] ? 1 : -1;\n    }\n\n    prepareTileInfo(tileSystem, fullExtent) {\n        if (isString(tileSystem)) {\n            tileSystem = TileSystem[tileSystem.toLowerCase()];\n        } else if (Array.isArray(tileSystem)) {\n            tileSystem = new TileSystem(tileSystem);\n        }\n\n        if (!tileSystem) {\n            throw new Error('Invalid TileSystem');\n        }\n        this.tileSystem = tileSystem;\n\n        //自动计算transformation\n        const a = fullExtent['right'] > fullExtent['left'] ? 1 : -1,\n            b = fullExtent['top'] > fullExtent['bottom'] ? -1 : 1,\n            c = tileSystem['origin']['x'],\n            d = tileSystem['origin']['y'];\n        this.transformation = new Transformation([a, b, c, d]);\n    }\n\n    /**\n     * Get index of point's tile\n     * @param  {Point} point - transformed point, this.transformation.transform(pCoord)\n     * @param  {Number} res  - current resolution\n     * @return {Object}       tile index\n     */\n    _getTileNum(point, res) {\n        const tileSystem = this.tileSystem,\n            tileSize = this['tileSize'],\n            delta = 1E-7;\n        const tileX = Math.floor(delta + point.x / (tileSize['width'] * res));\n        const tileY = -Math.floor(delta + point.y / (tileSize['height'] * res));\n\n        return {\n            'x': tileSystem['scale']['x'] * tileX,\n            'y': tileSystem['scale']['y'] * tileY\n        };\n    }\n\n    /**\n     * Get tile index and offset from tile's northwest\n     * @param  {Coordinate} pCoord   - projected coordinate\n     * @param  {Number} res - current resolution\n     * @return {Object}   tile index and offset\n     */\n    getTileIndex(pCoord, res) {\n        const tileSystem = this.tileSystem;\n        // tileSize = this['tileSize'];\n        const point = this.transformation.transform(pCoord, 1);\n        const tileIndex = this._getTileNum(point, res);\n\n        // const tileLeft = tileIndex['x'] * tileSize['width'];\n        // const tileTop = tileIndex['y'] * tileSize['height'];\n\n        // const offsetLeft = point.x / res - tileSystem['scale']['x'] * tileLeft;\n        // const offsetTop = point.y / res + tileSystem['scale']['y'] * tileTop;\n\n        //如果x方向为左大右小\n        if (tileSystem['scale']['x'] < 0) {\n            tileIndex['x'] -= 1;\n        }\n        //如果y方向上大下小\n        if (tileSystem['scale']['y'] > 0) {\n            tileIndex['y'] -= 1;\n        }\n\n        //有可能tileIndex超出世界范围\n        return this.getNeighorTileIndex(tileIndex['x'], tileIndex['y'], 0, 0, res);\n    }\n\n    /**\n     * Get neibor's tile index\n     * @param  {Number} tileX\n     * @param  {Number} tileY\n     * @param  {Number} offsetX\n     * @param  {Number} offsetY\n     * @param  {Number} zoomLevel\n     * @return {Object}  tile's neighbor index\n     */\n    getNeighorTileIndex(tileX, tileY, offsetX, offsetY, res, repeatWorld) {\n        const tileSystem = this.tileSystem;\n        let x = (tileX + tileSystem['scale']['x'] * offsetX);\n        let y = (tileY - tileSystem['scale']['y'] * offsetY);\n        let out = false;\n        const idx = x;\n        const idy = y;\n\n        const ext = this._getTileFullIndex(res);\n        if (repeatWorld) {\n            if (repeatWorld === true || repeatWorld === 'x') {\n                //caculate tile index to request in url in repeated world.\n                if (ext['xmax'] === ext['xmin']) {\n                    x = ext['xmin'];\n                } else if (x < ext['xmin']) {\n                    x = ext['xmax'] - (ext['xmin'] - x) % (ext['xmax'] - ext['xmin']);\n                    if (x === ext['xmax']) {\n                        x = ext['xmin'];\n                    }\n                } else if (x >= ext['xmax']) {\n                    x = ext['xmin'] + (x - ext['xmin']) % (ext['xmax'] - ext['xmin']);\n                }\n            }\n\n            if (repeatWorld === true || repeatWorld === 'y') {\n                if (ext['ymax'] === ext['ymin']) {\n                    y = ext['ymin'];\n                } else if (y >= ext['ymax']) {\n                    y = ext['ymin'] + (y - ext['ymin']) % (ext['ymax'] - ext['ymin']);\n                } else if (y < ext['ymin']) {\n                    y = ext['ymax'] - (ext['ymin'] - y) % (ext['ymax'] - ext['ymin']);\n                    if (y === ext['ymax']) {\n                        y = ext['ymin'];\n                    }\n                }\n            }\n        }\n        if (x < ext['xmin'] || x > ext['xmax'] || y > ext['ymax'] || y < ext['ymin']) {\n            out = true;\n        }\n        return {\n            // tile index to request in url\n            'x': x,\n            'y': y,\n            // real tile index\n            'idx' : idx,\n            'idy' : idy,\n            out\n        };\n    }\n\n    _getTileFullIndex(res) {\n        const ext = this.fullExtent;\n        const transformation = this.transformation;\n        const nwIndex = this._getTileNum(transformation.transform(new Coordinate(ext['left'], ext['top']), 1), res);\n        const seIndex = this._getTileNum(transformation.transform(new Coordinate(ext['right'], ext['bottom']), 1), res);\n\n        const tileSystem = this.tileSystem;\n        //如果x方向为左大右小\n        if (tileSystem['scale']['x'] < 0) {\n            nwIndex.x -= 1;\n            seIndex.x -= 1;\n        }\n        //如果y方向上大下小\n        if (tileSystem['scale']['y'] > 0) {\n            nwIndex.y -= 1;\n            seIndex.y -= 1;\n        }\n        return new Extent(nwIndex, seIndex);\n    }\n\n    /**\n     * Get tile's north west's projected coordinate\n     * @param  {Number} tileX\n     * @param  {Number} tileY\n     * @param  {Number} res\n     * @return {Number[]}\n     */\n    getTilePrjNW(tileX, tileY, res) {\n        const tileSystem = this.tileSystem;\n        const tileSize = this['tileSize'];\n        const y = tileSystem['origin']['y'] + this._yScale * tileSystem['scale']['y'] * (tileY + (tileSystem['scale']['y'] === 1 ? 1 : 0)) * res * tileSize['height'];\n        const x = tileSystem['origin']['x'] + this._xScale * tileSystem['scale']['x'] * (tileX + (tileSystem['scale']['x'] === 1 ? 0 : 1)) * res * tileSize['width'];\n        return new Coordinate(x, y);\n    }\n\n    /**\n     * Get tile's south east's projected coordinate\n     * @param  {Number} tileX\n     * @param  {Number} tileY\n     * @param  {Number} res\n     * @return {Number[]}\n     */\n    getTilePrjSE(tileX, tileY, res) {\n        const tileSystem = this.tileSystem;\n        const tileSize = this['tileSize'];\n        const y = tileSystem['origin']['y'] + this._yScale * tileSystem['scale']['y'] * (tileY + (tileSystem['scale']['y'] === 1 ? 0 : 1)) * res * tileSize['height'];\n        const x = tileSystem['origin']['x'] + this._xScale * tileSystem['scale']['x'] * (tileX + (tileSystem['scale']['x'] === 1 ? 1 : 0)) * res * tileSize['width'];\n        return new Coordinate(x, y);\n    }\n\n    /**\n     * Get tile's projected extent\n     * @param  {Number} tileX\n     * @param  {Number} tileY\n     * @param  {Number} res\n     * @return {Extent}\n     */\n    getTilePrjExtent(tileX, tileY, res) {\n        const nw = this.getTilePrjNW(tileX, tileY, res),\n            se = this.getTilePrjSE(tileX, tileY, res);\n        return new Extent(nw, se);\n    }\n}\n\nexport default TileConfig;\n","import { IS_NODE, isNil, isNumber, isArrayHasData, isFunction, isInteger } from '../../core/util';\nimport Browser from '../../core/Browser';\nimport Size from '../../geo/Size';\nimport Point from '../../geo/Point';\nimport PointExtent from '../../geo/PointExtent';\nimport TileConfig from './tileinfo/TileConfig';\nimport TileSystem from './tileinfo/TileSystem';\nimport Layer from '../Layer';\nimport SpatialReference from '../../map/spatial-reference/SpatialReference';\n\n/**\n * @property {Object}              options                     - TileLayer's options\n * @property {String|Function}     options.urlTemplate         - url templates\n * @property {String[]|Number[]}   [options.subdomains=null]   - subdomains to replace '{s}' in urlTemplate\n * @property {Object}              [options.spatialReference=null] - TileLayer's spatial reference\n * @property {Number[]}            [options.tileSize=[256, 256]] - size of the tile image, [width, height]\n * @property {Number[]|Function}   [options.offset=[0, 0]]       - overall tile offset, [dx, dy], useful for tile sources from difference coordinate systems, e.g. (wgs84 and gcj02)\n * @property {Number[]}            [options.tileSystem=null]     - tile system number arrays\n * @property {Number}              [options.maxAvailableZoom=null] - Maximum zoom level for which tiles are available. Data from tiles at the maxAvailableZoom are used when displaying the map at higher zoom levels.\n * @property {Boolean}             [options.repeatWorld=true]  - tiles will be loaded repeatedly outside the world.\n * @property {Boolean}             [options.background=true]   - whether to draw a background during or after interacting, true by default\n * @property {Number}              [options.backgroundZoomDiff=6] - the zoom diff to find parent tile as background\n * @property {Boolean|Function}    [options.placeholder=false]    - a placeholder image to replace loading tile, can be a function with a parameter of the tile canvas\n * @property {String}              [options.fragmentShader=null]  - custom fragment shader, replace <a href=\"https://github.com/maptalks/maptalks.js/blob/master/src/renderer/layer/tilelayer/TileLayerGLRenderer.js#L8\">the default fragment shader</a>\n * @property {String}              [options.crossOrigin=null]    - tile image's corssOrigin\n * @property {Boolean}             [options.fadeAnimation=true]  - fade animation when loading tiles\n * @property {Boolean}             [options.debug=false]         - if set to true, tiles will have borders and a title of its coordinates.\n * @property {String}              [options.renderer=gl]         - TileLayer's renderer, canvas or gl. gl tiles requires image CORS that canvas doesn't. canvas tiles can't pitch.\n * @property {Number}              [options.maxCacheSize=256]    - maximum number of tiles to cache\n * @property {Boolean}             [options.cascadeTiles=true]      - draw cascaded tiles of different zooms to reduce tiles\n * @property {Number}              [options.minPitchToCascade=35]   - minimum pitch degree to begin tile cascade\n * @property {Number}              [options.zoomOffset=0]           - offset from map's zoom to tile's zoom\n * @property {Number}              [options.tileRetryCount=0]       - retry count of tiles\n * @memberOf TileLayer\n * @instance\n */\nconst options = {\n\n    'urlTemplate': null,\n    'subdomains': null,\n\n    'repeatWorld': true,\n\n    'background' : true,\n    'backgroundZoomDiff' : 6,\n\n    'loadingLimitOnInteracting' : 3,\n\n    'tileRetryCount' : 0,\n\n    'placeholder' : false,\n\n    'crossOrigin': null,\n\n    'tileSize': [256, 256],\n\n    'offset' : [0, 0],\n\n    'tileSystem': null,\n\n    'fadeAnimation' : !IS_NODE,\n\n    'debug': false,\n\n    'spatialReference' : null,\n\n    'maxCacheSize' : 256,\n\n    'renderer' : (() => {\n        return Browser.webgl ? 'gl' : 'canvas';\n    })(),\n\n    'clipByPitch' : true,\n\n    'maxAvailableZoom' : null,\n\n    'cascadeTiles' : true,\n    'minPitchToCascade' : 35,\n\n    'zoomOffset' : 0\n};\n\nconst URL_PATTERN = /\\{ *([\\w_]+) *\\}/g;\n\n// const MAX_VISIBLE_SIZE = 5;\n\nconst TEMP_POINT = new Point(0, 0);\nconst TEMP_POINT0 = new Point(0, 0);\nconst TEMP_POINT1 = new Point(0, 0);\nconst TEMP_POINT2 = new Point(0, 0);\nconst TEMP_POINT3 = new Point(0, 0);\nconst TEMP_POINT_EXTENT = new PointExtent();\n\n/**\n * @classdesc\n * A layer used to display tiled map services, such as [google maps]{@link http://maps.google.com}, [open street maps]{@link http://www.osm.org}\n * @category layer\n * @extends Layer\n * @param {String|Number} id - tile layer's id\n * @param {Object} [options=null] - options defined in [TileLayer]{@link TileLayer#options}\n * @example\n * new TileLayer(\"tile\",{\n        urlTemplate : 'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n        subdomains:['a','b','c']\n    })\n */\nclass TileLayer extends Layer {\n\n    /**\n     * Reproduce a TileLayer from layer's profile JSON.\n     * @param  {Object} layerJSON - layer's profile JSON\n     * @return {TileLayer}\n     * @static\n     * @private\n     * @function\n     */\n    static fromJSON(layerJSON) {\n        if (!layerJSON || layerJSON['type'] !== 'TileLayer') {\n            return null;\n        }\n        return new TileLayer(layerJSON['id'], layerJSON['options']);\n    }\n\n\n    /**\n     * Get tile size of the tile layer\n     * @return {Size}\n     */\n    getTileSize() {\n        let size = this.options['tileSize'];\n        if (isNumber(size)) {\n            size = [size, size];\n        }\n        return new Size(size);\n    }\n\n    /**\n     * Get tiles at zoom z (or current zoom)\n     * @param {Number} z - zoom\n     * @return {Object[]} tile descriptors\n     */\n    getTiles(z, parentLayer) {\n        const map = this.getMap();\n        const parentRenderer = parentLayer && parentLayer.getRenderer();\n        const mapExtent = map.getContainerExtent();\n        const tileGrids = [];\n        let count = 0;\n        const minZoom = this.getMinZoom();\n        const minPitchToCascade = this.options['minPitchToCascade'];\n        const tileZoom = isNil(z) ? this._getTileZoom(map.getZoom()) : z;\n        if (\n            !isNil(z) ||\n            !this.options['cascadeTiles'] ||\n            map.getPitch() <= minPitchToCascade ||\n            !isNil(minZoom) && tileZoom <= minZoom\n        ) {\n            const currentTiles = this._getTiles(tileZoom, mapExtent, undefined, parentRenderer);\n            if (currentTiles) {\n                count += currentTiles.tiles.length;\n                tileGrids.push(currentTiles);\n            }\n            return {\n                tileGrids, count\n            };\n        }\n\n        const visualHeight = Math.floor(map._getVisualHeight(minPitchToCascade));\n        const extent0 = new PointExtent(0, map.height - visualHeight, map.width, map.height);\n        const currentTiles = this._getTiles(tileZoom, extent0, 0, parentRenderer);\n        count += currentTiles ? currentTiles.tiles.length : 0;\n\n        const extent1 = new PointExtent(0, mapExtent.ymin, map.width, extent0.ymin);\n        const d = map.getSpatialReference().getZoomDirection();\n        const parentTiles = this._getTiles(tileZoom - d, extent1, 1, parentRenderer);\n        count += parentTiles ? parentTiles.tiles.length : 0;\n\n        tileGrids.push(currentTiles, parentTiles);\n        return {\n            tileGrids, count\n        };\n    }\n\n    /**\n     * Get tile's url\n     * @param {Number} x\n     * @param {Number} y\n     * @param {Number} z\n     * @returns {String} url\n     */\n    getTileUrl(x, y, z) {\n        const urlTemplate = this.options['urlTemplate'];\n        let domain = '';\n        if (this.options['subdomains']) {\n            const subdomains = this.options['subdomains'];\n            if (isArrayHasData(subdomains)) {\n                const length = subdomains.length;\n                let s = (x + y) % length;\n                if (s < 0) {\n                    s = 0;\n                }\n                domain = subdomains[s];\n            }\n        }\n        if (isFunction(urlTemplate)) {\n            return urlTemplate(x, y, z, domain);\n        }\n        const data = {\n            'x': x,\n            'y': y,\n            'z': z,\n            's': domain\n        };\n        return urlTemplate.replace(URL_PATTERN, function (str, key) {\n            let value = data[key];\n\n            if (value === undefined) {\n                throw new Error('No value provided for variable ' + str);\n\n            } else if (typeof value === 'function') {\n                value = value(data);\n            }\n            return value;\n        });\n    }\n\n    /**\n     * Clear the layer\n     * @return {TileLayer} this\n     */\n    clear() {\n        if (this._renderer) {\n            this._renderer.clear();\n        }\n        /**\n         * clear event, fired when tile layer is cleared.\n         *\n         * @event TileLayer#clear\n         * @type {Object}\n         * @property {String} type - clear\n         * @property {TileLayer} target - tile layer\n         */\n        this.fire('clear');\n        return this;\n    }\n\n    /**\n     * Export the tile layer's profile json. <br>\n     * Layer's profile is a snapshot of the layer in JSON format. <br>\n     * It can be used to reproduce the instance by [fromJSON]{@link Layer#fromJSON} method\n     * @return {Object} layer's profile JSON\n     */\n    toJSON() {\n        const profile = {\n            'type': this.getJSONType(),\n            'id': this.getId(),\n            'options': this.config()\n        };\n        return profile;\n    }\n\n    /**\n     * Get tilelayer's spatial reference.\n     * @returns {SpatialReference} spatial reference\n     */\n    getSpatialReference() {\n        const map = this.getMap();\n        if  (map && (!this.options['spatialReference'] || SpatialReference.equals(this.options['spatialReference'], map.options['spatialReference']))) {\n            return map.getSpatialReference();\n        }\n        this._sr = this._sr || new SpatialReference(this.options['spatialReference']);\n        return this._sr;\n    }\n\n    _getTileZoom(zoom) {\n        if (!isInteger(zoom)) {\n            zoom = Math.round(zoom);\n        }\n        const maxZoom = this.options['maxAvailableZoom'];\n        if (!isNil(maxZoom) && zoom > maxZoom) {\n            zoom = maxZoom;\n        }\n        return zoom;\n    }\n\n    _getTiles(z, containerExtent, maskID, parentRenderer) {\n        // rendWhenReady = false;\n        const map = this.getMap();\n        const zoom = z + this.options['zoomOffset'];\n        const offset = this._getTileOffset(zoom),\n            hasOffset = offset[0] || offset[1];\n        const emptyGrid = {\n            'zoom' : z,\n            'extent' : null,\n            'offset' : offset,\n            'tiles' : []\n        };\n        if (zoom < 0) {\n            return emptyGrid;\n        }\n        const minZoom = this.getMinZoom(),\n            maxZoom = this.getMaxZoom();\n        if (!map || !this.isVisible() || !map.width || !map.height) {\n            return emptyGrid;\n        }\n        if (!isNil(minZoom) && z < minZoom ||\n            !isNil(maxZoom) && z > maxZoom) {\n            return emptyGrid;\n        }\n        const tileConfig = this._getTileConfig();\n        if (!tileConfig) {\n            return emptyGrid;\n        }\n\n        const sr = this.getSpatialReference(),\n            mapSR = map.getSpatialReference(),\n            res = sr.getResolution(zoom);\n\n        const extent2d = containerExtent.convertTo(c => map._containerPointToPoint(c, undefined, TEMP_POINT));\n        const innerExtent2D = this._getInnerExtent(z, containerExtent, extent2d)._add(offset);\n        extent2d._add(offset);\n        const offsetExtent2D = extent2d.sub(offset);\n\n        const maskExtent = this._getMask2DExtent();\n        if (maskExtent) {\n            const intersection = maskExtent.intersection(extent2d);\n            if (!intersection) {\n                return emptyGrid;\n            }\n            containerExtent = intersection.convertTo(c => map._pointToContainerPoint(c, undefined, 0, TEMP_POINT));\n        }\n\n        //Get description of center tile including left and top offset\n        const prjCenter = map._containerPointToPrj(containerExtent.getCenter(), TEMP_POINT0);\n        let c;\n        if (hasOffset) {\n            c = this._project(map._pointToPrj(map._prjToPoint(prjCenter, undefined, TEMP_POINT1)._add(offset), undefined, TEMP_POINT1), TEMP_POINT1);\n        } else {\n            c = this._project(prjCenter, TEMP_POINT1);\n        }\n\n        TEMP_POINT2.x = extent2d.xmin;\n        TEMP_POINT2.y = extent2d.ymin;\n        TEMP_POINT3.x = extent2d.xmax;\n        TEMP_POINT3.y = extent2d.ymax;\n        const pmin = this._project(map._pointToPrj(TEMP_POINT2, undefined, TEMP_POINT2), TEMP_POINT2);\n        const pmax = this._project(map._pointToPrj(TEMP_POINT3, undefined, TEMP_POINT3), TEMP_POINT3);\n\n        const centerTile = tileConfig.getTileIndex(c, res);\n        const ltTile = tileConfig.getTileIndex(pmin, res);\n        const rbTile = tileConfig.getTileIndex(pmax, res);\n\n        // Number of tiles around the center tile\n        const top = Math.ceil(Math.abs(centerTile.y - ltTile.y)),\n            left = Math.ceil(Math.abs(centerTile.x - ltTile.x)),\n            bottom = Math.ceil(Math.abs(centerTile.y - rbTile.y)),\n            right = Math.ceil(Math.abs(centerTile.x - rbTile.x));\n        const tileSize = this.getTileSize();\n        const layerId = this.getId(),\n            renderer = this.getRenderer() || parentRenderer,\n            scale = this._getTileConfig().tileSystem.scale;\n        const tiles = [], extent = new PointExtent();\n        for (let i = -top; i <= bottom; i++) {\n            let j = -left;\n            let leftVisitEnd = -Infinity;\n            let rightVisitEnd = false;\n            while (j >= leftVisitEnd && j <= right) {\n                const idx = tileConfig.getNeighorTileIndex(centerTile['x'], centerTile['y'], j, i, res, sr === mapSR && this.options['repeatWorld']);\n                if (leftVisitEnd === -Infinity) {\n                    //从左往右遍历中\n                    j++;\n                } else {\n                    //从右往左遍历中\n                    j--;\n                }\n                if (idx.out) {\n                    continue;\n                }\n                let hasCachedInfo = false;\n                const tileId = this._getTileId(idx, zoom); //unique id of the tile\n                let tileInfo = renderer && renderer.isTileCachedOrLoading(tileId);\n                if (tileInfo) {\n                    tileInfo = tileInfo.info;\n                    hasCachedInfo = true;\n                }\n                let p;\n                if (tileInfo) {\n                    p = tileInfo.point0;\n                } else {\n                    const pnw = tileConfig.getTilePrjNW(idx.x, idx.y, res);\n                    p = map._prjToPoint(this._unproject(pnw, TEMP_POINT3), z);\n                }\n                let width, height;\n                if (sr === mapSR) {\n                    width = tileSize.width;\n                    height = tileSize.height;\n                } else {\n                    const pse = tileConfig.getTilePrjSE(idx.x, idx.y, res),\n                        pp = map._prjToPoint(this._unproject(pse, TEMP_POINT3), z, TEMP_POINT3);\n                    width = Math.abs(Math.round(pp.x - p.x));\n                    height = Math.abs(Math.round(pp.y - p.y));\n                }\n                const dx = scale.x * (idx.idx - idx.x) * width,\n                    dy = -scale.y * (idx.idy - idx.y) * height;\n                if (dx || dy) {\n                    p._add(dx, dy);\n                }\n                if (sr !== mapSR) {\n                    width++; //plus 1 to prevent white gaps\n                    height++;\n                }\n                if (hasOffset) {\n                    p._sub(offset);\n                }\n                if (!tileInfo) {\n                    const tileExtent = new PointExtent(p.x, p.y, p.x + width, p.y + height);\n                    tileInfo = {\n                        //reserve point caculated by tileConfig\n                        //so add offset because we have p._sub(offset) and p._add(dx, dy) if hasOffset\n                        'point0': p.add(offset)._sub(dx, dy),\n                        'point': p,\n                        'z': z,\n                        'x' : idx.x,\n                        'y' : idx.y,\n                        'extent2d' : tileExtent,\n                        'mask' : maskID\n                    };\n                }\n\n                const tileExtent = tileInfo.extent2d;\n                if (rightVisitEnd || innerExtent2D.intersects(tileExtent) ||\n                    !innerExtent2D.equals(offsetExtent2D) && this._isTileInExtent(tileInfo, containerExtent)) {\n                    if (hasOffset) {\n                        tileInfo.point = p._add(offset);\n                        tileInfo.extent2d.set(p.x, p.y, p.x + width, p.y + height);\n                        tileInfo.extent2d = tileExtent._add(offset);\n                    }\n                    if (!hasCachedInfo) {\n                        tileInfo['size'] = [width, height];\n                        const point0 = tileInfo.point0;\n                        tileInfo['dupKey'] = z + ',' + Math.round(point0.x) + ',' + Math.round(point0.y) + ',' + width + ',' + height + ',' + layerId; //duplicate key of the tile\n                        tileInfo['id'] = this._getTileId(idx, zoom); //unique id of the tile\n                        tileInfo['layer'] = layerId;\n                        tileInfo['url'] = this.getTileUrl(idx.x, idx.y, zoom);\n                    }\n                    tiles.push(tileInfo);\n                    extent._combine(tileExtent);\n                    if (leftVisitEnd === -Infinity) {\n                        //从左往右第一次遇到可视的瓦片，改为从右往左遍历\n                        leftVisitEnd = j;\n                        j = right;\n                    } else if (!rightVisitEnd) {\n                        //从右往左第一次遇到可视瓦片，之后的瓦片全部可视\n                        rightVisitEnd = true;\n                    }\n                }\n            }\n        }\n\n        //sort tiles according to tile's distance to center\n        const center = map._containerPointToPoint(containerExtent.getCenter(), z, TEMP_POINT)._add(offset);\n        tiles.sort(function (a, b) {\n            return a.point.distanceTo(center) - b.point.distanceTo(center);\n        });\n\n        return {\n            'offset' : offset,\n            'zoom' : z,\n            'extent' : extent,\n            'tiles': tiles\n        };\n    }\n\n    _getInnerExtent(zoom, containerExtent, extent2d) {\n        const map = this.getMap(),\n            res = map.getResolution(zoom),\n            scale = map.getResolution() / res,\n            center = extent2d.getCenter()._multi(scale),\n            bearing = map.getBearing() * Math.PI / 180,\n            ch = containerExtent.getHeight() / 2 * scale,\n            cw  = containerExtent.getWidth() / 2 * scale,\n            h = Math.abs(Math.cos(bearing) * ch) || ch,\n            w  = Math.abs(Math.sin(bearing) * ch) || cw;\n        return new PointExtent(center.x - w, center.y - h, center.x + w, center.y + h);\n    }\n\n    _getTileOffset(z) {\n        const map = this.getMap();\n        const scale = map._getResolution() / map._getResolution(z);\n        let offset = this.options['offset'];\n        if (isFunction(offset)) {\n            offset = offset(this);\n        }\n        offset[0] *= scale;\n        offset[1] *= scale;\n        return offset;\n    }\n\n    _getTileId(idx, zoom, id) {\n        //id is to mark GroupTileLayer's child layers\n        return `${id || this.getId()}-${idx.idy}-${idx.idx}-${zoom}`;\n    }\n\n\n    _project(pcoord, out) {\n        const map = this.getMap();\n        const sr = this.getSpatialReference();\n        const mapSR = map.getSpatialReference();\n        if (sr !== mapSR) {\n            const mapProjection = map.getProjection();\n            const projection = sr.getProjection();\n            return projection.project(mapProjection.unproject(pcoord, out), out);\n        } else {\n            return pcoord;\n        }\n    }\n\n    _unproject(pcoord, out) {\n        const map = this.getMap();\n        const sr = this.getSpatialReference();\n        const mapSR = map.getSpatialReference();\n        if (sr !== mapSR) {\n            const mapProjection = map.getProjection();\n            const projection = sr.getProjection();\n            return mapProjection.project(projection.unproject(pcoord, out), out);\n        } else {\n            return pcoord;\n        }\n    }\n\n    /**\n     * initialize [tileConfig]{@link TileConfig} for the tilelayer\n     * @private\n     */\n    _initTileConfig() {\n        const map = this.getMap(),\n            tileSize = this.getTileSize();\n        const sr = this.getSpatialReference();\n        const projection = sr.getProjection(),\n            fullExtent = sr.getFullExtent();\n        this._defaultTileConfig = new TileConfig(TileSystem.getDefault(projection), fullExtent, tileSize);\n        if (this.options['tileSystem']) {\n            this._tileConfig = new TileConfig(this.options['tileSystem'], fullExtent, tileSize);\n        }\n        //inherit baselayer's tileconfig\n        if (map && !this._tileConfig &&\n            map.getSpatialReference() === sr &&\n            map.getBaseLayer() &&\n            map.getBaseLayer() !== this &&\n            map.getBaseLayer()._getTileConfig) {\n            const base = map.getBaseLayer()._getTileConfig();\n            this._tileConfig = new TileConfig(base.tileSystem, base.fullExtent, tileSize);\n        }\n    }\n\n    _getTileConfig() {\n        if (!this._defaultTileConfig) {\n            this._initTileConfig();\n        }\n        return this._tileConfig || this._defaultTileConfig;\n    }\n\n    _bindMap(map) {\n        const baseLayer = map.getBaseLayer();\n        if (baseLayer === this) {\n            if (!baseLayer.options.hasOwnProperty('forceRenderOnMoving')) {\n                this.config({\n                    'forceRenderOnMoving': true\n                });\n            }\n        }\n        return super._bindMap.apply(this, arguments);\n    }\n\n    _isTileInExtent(tileInfo, extent) {\n        if (!this._convertPointCallback) {\n            this._convertPointCallback = convertPoint.bind(this);\n        }\n        const tileZoom = tileInfo.z;\n        this._coordTileZoom = tileZoom;\n        const tileExtent = tileInfo.extent2d.convertTo(this._convertPointCallback, TEMP_POINT_EXTENT);\n        // if (tileExtent.getWidth() < MAX_VISIBLE_SIZE || tileExtent.getHeight() < MAX_VISIBLE_SIZE) {\n        //     return false;\n        // }\n        return extent.intersects(tileExtent);\n    }\n\n    getEvents() {\n        return {\n            'spatialreferencechange' : this._onSpatialReferenceChange\n        };\n    }\n\n    _onSpatialReferenceChange() {\n        delete this._tileConfig;\n        delete this._defaultTileConfig;\n        delete this._sr;\n        const renderer = this.getRenderer();\n        if (renderer) {\n            renderer.clear();\n        }\n    }\n}\n\nTileLayer.registerJSONType('TileLayer');\n\nTileLayer.mergeOptions(options);\n\nexport default TileLayer;\n\nfunction convertPoint(c) {\n    return this.getMap()._pointToContainerPoint(c, this._coordTileZoom, 0, TEMP_POINT);\n}\n","import { pushIn } from '../../core/util';\nimport Layer from '../Layer';\nimport TileLayer from './TileLayer';\n\n/**\n * @classdesc\n * A layer used to display a group of tile layers. <br>\n * Its performance is better than add TileLayers seperately and it can help prevent limits of active webgl contexts: <br>\n * \"WARNING: Too many active WebGL contexts. Oldest context will be lost\"\n * @category layer\n * @extends TileLayer\n * @param {String|Number} id - tile layer's id\n * @param {TileLayer[]} layers  - TileLayers to add\n * @param {Object} [options=null] - options defined in [TileLayer]{@link TileLayer#options}\n * @example\n * new GroupTileLayer(\"group-tiles\",[\n    new maptalks.WMSTileLayer('wms', {\n      'urlTemplate' : 'https://demo.boundlessgeo.com/geoserver/ows',\n      'crs' : 'EPSG:3857',\n      'layers' : 'ne:ne',\n      'styles' : '',\n      'version' : '1.3.0',\n      'format': 'image/png',\n      'transparent' : true,\n      'uppercase' : true\n    }),\n    new maptalks.TileLayer('tile2',{\n      urlTemplate: 'http://korona.geog.uni-heidelberg.de/tiles/adminb/x={x}&y={y}&z={z}'\n    })\n  ])\n */\nclass GroupTileLayer extends TileLayer {\n    /**\n     * Reproduce a GroupTileLayer from layer's profile JSON.\n     * @param  {Object} layerJSON - layer's profile JSON\n     * @return {GroupTileLayer}\n     * @static\n     * @private\n     * @function\n     */\n    static fromJSON(layerJSON) {\n        if (!layerJSON || layerJSON['type'] !== 'GroupTileLayer') {\n            return null;\n        }\n        const layers = layerJSON['layers'].map(json => Layer.fromJSON(json));\n        return new GroupTileLayer(layerJSON['id'], layers, layerJSON['options']);\n    }\n\n    /**\n     * @param {String|Number} id    - layer's id\n     * @param {TileLayer[]} layers  - TileLayers to add\n     * @param {Object}  [options=null]          - construct options\n     * @param {*}  [options.*=null]             - options defined in [TileLayer]{@link TileLayer#options}\n     */\n    constructor(id, layers, options) {\n        super(id, options);\n        this.layers = layers || [];\n        this._checkChildren();\n        this.layerMap = {};\n        this._groupChildren = [];\n    }\n\n    /**\n     * Get children TileLayer\n     * @returns {TileLayer[]}\n     */\n    getLayers() {\n        return this.layers;\n    }\n\n    /**\n     * Export the GroupTileLayer's profile json. <br>\n     * Layer's profile is a snapshot of the layer in JSON format. <br>\n     * It can be used to reproduce the instance by [fromJSON]{@link Layer#fromJSON} method\n     * @return {Object} layer's profile JSON\n     */\n    toJSON() {\n        const profile = {\n            'type': this.getJSONType(),\n            'id': this.getId(),\n            'layers' : this.layers.map(layer => layer.toJSON()),\n            'options': this.config()\n        };\n        return profile;\n    }\n\n    /**\n     * Get tiles at zoom (or current zoom)\n     * @param {Number} z\n     * @returns {Object} tiles\n     */\n    getTiles(z) {\n        const layers = this.layers;\n        const tiles = [];\n        let count = 0;\n        for (let i = 0, l = layers.length; i < l; i++) {\n            const layer = layers[i];\n            if (!layer.options['visible']) {\n                continue;\n            }\n            const childGrid = layer.getTiles(z, this);\n            if (!childGrid || childGrid.count === 0) {\n                continue;\n            }\n            count += childGrid.count;\n            pushIn(tiles, childGrid.tileGrids);\n        }\n\n        return {\n            count : count,\n            tileGrids : tiles\n        };\n    }\n\n    onAdd() {\n        const map = this.getMap();\n        this.layers.forEach(layer => {\n            this.layerMap[layer.getId()] = layer;\n            if (layer.getChildLayer) {\n                this._groupChildren.push(layer);\n            }\n            layer._bindMap(map);\n            layer.on('show hide', this._onLayerShowHide, this);\n        });\n        super.onAdd();\n    }\n\n    onRemove() {\n        this.layers.forEach(layer => {\n            layer._doRemove();\n            layer.off('show hide', this._onLayerShowHide, this);\n        });\n        this.layerMap = {};\n        this._groupChildren = [];\n        super.onRemove();\n    }\n\n    getChildLayer(id) {\n        const layer = this.layerMap[id];\n        if (layer) {\n            return layer;\n        }\n        for (let i = 0; i < this._groupChildren.length; i++) {\n            const child = this._groupChildren[i].getChildLayer(id);\n            if (child) {\n                return child;\n            }\n        }\n        return null;\n    }\n\n    _onLayerShowHide() {\n        const renderer = this.getRenderer();\n        if (renderer) {\n            renderer.setToRedraw();\n        }\n    }\n\n    isVisible() {\n        if (!super.isVisible()) {\n            return false;\n        }\n        const children = this.layers;\n        for (let i = 0, l = children.length; i < l; i++) {\n            if (children[i].isVisible()) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    _checkChildren() {\n        const ids = {};\n        this.layers.forEach(layer => {\n            const layerId = layer.getId();\n            if (ids[layerId]) {\n                throw new Error(`Duplicate child layer id (${layerId}) in the GroupTileLayer (${this.getId()})`);\n            } else {\n                ids[layerId] = 1;\n            }\n        });\n    }\n}\n\nGroupTileLayer.registerJSONType('GroupTileLayer');\n\nexport default GroupTileLayer;\n","import { extend } from '../../core/util';\nimport TileLayer from './TileLayer';\n\n/**\n * @property {Object}              options                     - TileLayer's options\n * @property {String}              [options.service=WMS]       - WMS Service\n * @property {String}              options.layers              - Comma-separated list of WMS layers to show.\n * @property {String}              [options.styles='']         - Comma-separated list of WMS styles.\n * @property {String}              [options.format=image/jpeg] - WMS image format (use `'image/png'` for layers with transparency).\n * @property {String}              [options.transparent=false] - Version of the WMS service to use\n * @property {String}              [options.version=1.1.1]     - size of the tile image\n * @property {String}              [options.crs=null]          - Coordinate Reference System to use for the WMS requests, defaults to map CRS. Don't change this if you're not sure what it means.\n * @property {Boolean}             [options.uppercase=false]   - If `true`, WMS request parameter keys will be uppercase.\n * @property {Boolean}             [options.detectRetina=false]   - If `true` and user is on a retina display, it will request four tiles of half the specified size and a bigger zoom level in place of one to utilize the high resolution.\n * @memberOf WMSTileLayer\n * @instance\n */\nconst options = {\n    crs: null,\n    uppercase: false,\n    detectRetina : false\n};\n\nconst defaultWmsParams = {\n    service: 'WMS',\n    request: 'GetMap',\n    layers: '',\n    styles: '',\n    format: 'image/jpeg',\n    transparent: false,\n    version: '1.1.1'\n};\n\n/**\n * @classdesc\n * Used to display [WMS]{https://en.wikipedia.org/wiki/Web_Map_Service} services as tile layers on the map. Extends [TileLayer]{@link TileLayer}.\n * Implemented based on Leaflet's TileLayer.WMS.\n * @category layer\n * @extends TileLayer\n * @param {String|Number} id - tile layer's id\n * @param {Object} [options=null] - options defined in [WMSTileLayer]{@link TileLayer#options}\n * @example\n * var layer = new maptalks.WMSTileLayer('wms', {\n *     'urlTemplate' : 'https://demo.boundlessgeo.com/geoserver/ows',\n *     'crs' : 'EPSG:3857',\n *     'layers' : 'ne:ne',\n *     'styles' : '',\n *     'version' : '1.3.0',\n *     'format': 'image/png',\n *     'transparent' : true,\n *     'uppercase' : true\n * });\n */\nclass WMSTileLayer extends TileLayer {\n\n    constructor(id, options) {\n        super(id);\n        const wmsParams = extend({}, defaultWmsParams);\n        for (const p in options) {\n            if (!(p in this.options)) {\n                wmsParams[p] = options[p];\n            }\n        }\n        this.setOptions(options);\n        this.setZIndex(options.zIndex);\n        const tileSize = this.getTileSize();\n        wmsParams.width = tileSize.width;\n        wmsParams.height = tileSize.height;\n        this.wmsParams = wmsParams;\n        this._wmsVersion = parseFloat(wmsParams.version);\n    }\n\n    onAdd() {\n        const dpr = this.getMap().getDevicePixelRatio();\n        const r = options.detectRetina ? dpr : 1;\n        this.wmsParams.width *= r;\n        this.wmsParams.height *= r;\n        const crs = this.options.crs || this.getMap().getProjection().code;\n        const projectionKey = this._wmsVersion >= 1.3 ? 'crs' : 'srs';\n        this.wmsParams[projectionKey] = crs;\n        super.onAdd();\n    }\n\n    getTileUrl(x, y, z) {\n        const res = this.getSpatialReference().getResolution(z),\n            tileConfig = this._getTileConfig(),\n            tileExtent = tileConfig.getTilePrjExtent(x, y, res);\n        const max = tileExtent.getMax(),\n            min = tileExtent.getMin();\n\n        const bbox = (this._wmsVersion >= 1.3  && this.wmsParams.crs === 'EPSG:4326' ?\n            [min.y, min.x, max.y, max.x] :\n            [min.x, min.y, max.x, max.y]).join(',');\n\n        const url = super.getTileUrl(x, y, z);\n\n        return url +\n            getParamString(this.wmsParams, url, this.options.uppercase) +\n            (this.options.uppercase ? '&BBOX=' : '&bbox=') + bbox;\n    }\n\n    /**\n     * Export the WMSTileLayer's json. <br>\n     * It can be used to reproduce the instance by [fromJSON]{@link Layer#fromJSON} method\n     * @return {Object} layer's JSON\n     */\n    toJSON() {\n        return {\n            'type': 'WMSTileLayer',\n            'id': this.getId(),\n            'options': this.config()\n        };\n    }\n\n    /**\n     * Reproduce a WMSTileLayer from layer's JSON.\n     * @param  {Object} layerJSON - layer's JSON\n     * @return {WMSTileLayer}\n     * @static\n     * @private\n     * @function\n     */\n    static fromJSON(layerJSON) {\n        if (!layerJSON || layerJSON['type'] !== 'WMSTileLayer') {\n            return null;\n        }\n        return new WMSTileLayer(layerJSON['id'], layerJSON['options']);\n    }\n}\n\nWMSTileLayer.registerJSONType('WMSTileLayer');\n\nWMSTileLayer.mergeOptions(options);\n\nexport default WMSTileLayer;\n\n// From Leaflet\n// Converts an object into a parameter URL string, e.g. `{a: \"foo\", b: \"bar\"}`\n// translates to `'?a=foo&b=bar'`. If `existingUrl` is set, the parameters will\n// be appended at the end. If `uppercase` is `true`, the parameter names will\n// be uppercased (e.g. `'?A=foo&B=bar'`)\nexport function getParamString(obj, existingUrl, uppercase) {\n    const params = [];\n    for (const i in obj) {\n        params.push(encodeURIComponent(uppercase ? i.toUpperCase() : i) + '=' + encodeURIComponent(obj[i]));\n    }\n    return ((!existingUrl || existingUrl.indexOf('?') === -1) ? '?' : '&') + params.join('&');\n}\n","import TileLayer from './TileLayer';\n\n/**\n * @classdesc\n * @ignore\n * @category layer\n * @extends TileLayer\n * @param {String|Number} id - tile layer's id\n * @param {Object} [options=null] - options defined in [CanvasTileLayer]{@link TileLayer#options}\n * @example\n * var layer = new CanvasTileLayer(\"tile\");\n * layer.drawTile = ()\n */\nclass CanvasTileLayer extends TileLayer {\n\n    constructor(id, options) {\n        super(id, options);\n        if (!this.options.hasOwnProperty('forceRenderOnMoving')) {\n            // force not to forceRenderOnMoving\n            this.options['forceRenderOnMoving'] = false;\n        }\n    }\n\n    /**\n     * The interface method to draw on canvsa tile\n     * @param  {HTMLCanvasElement} canvas  canvas to draw on\n     * @param  {Object} options current options\n     * @param  {Object} options current options\n     */\n    drawTile(/*canvas, options*/) {\n\n    }\n\n    /**\n     * Export the CanvasTileLayer's json. <br>\n     * It can be used to reproduce the instance by [fromJSON]{@link Layer#fromJSON} method\n     * @return {Object} layer's JSON\n     */\n    toJSON() {\n        return {\n            'type': 'CanvasTileLayer',\n            'id': this.getId(),\n            'options': this.config()\n        };\n    }\n\n    /**\n     * Reproduce a CanvasTileLayer from layer's JSON.\n     * @param  {Object} layerJSON - layer's JSON\n     * @return {CanvasTileLayer}\n     * @static\n     * @private\n     * @function\n     */\n    static fromJSON(layerJSON) {\n        if (!layerJSON || layerJSON['type'] !== 'CanvasTileLayer') {\n            return null;\n        }\n        return new CanvasTileLayer(layerJSON['id'], layerJSON['options']);\n    }\n}\n\nCanvasTileLayer.registerJSONType('CanvasTileLayer');\n\nexport default CanvasTileLayer;\n","\nexport function createGLContext(canvas, options) {\n    const attributes = {\n        'alpha': true,\n        'stencil' : true,\n        'preserveDrawingBuffer' : true,\n        'antialias' : false\n    };\n    const names = ['webgl', 'experimental-webgl'];\n    let context = null;\n    /* eslint-disable no-empty */\n    for (let i = 0; i < names.length; ++i) {\n        try {\n            context = canvas.getContext(names[i], options || attributes);\n        } catch (e) {}\n        if (context) {\n            break;\n        }\n    }\n    return context;\n    /* eslint-enable no-empty */\n}\n\n/**\n* Create a shader object\n* @param gl GL context\n* @param type the type of the shader object to be created\n* @param source shader program (string)\n* @return created shader object, or null if the creation has failed.\n* @private\n*/\nexport function compileShader(gl, type, source) {\n    const shader = gl.createShader(type);\n\n    gl.shaderSource(shader, source);\n    gl.compileShader(shader);\n\n    const compiled = gl.getShaderParameter(shader, gl.COMPILE_STATUS);\n    if (!compiled) {\n        const error = gl.getShaderInfoLog(shader);\n        gl.deleteShader(shader);\n        throw new Error('Failed to compile shader: ' + error);\n    }\n    return shader;\n}\n\n/**\n * Create the linked program object\n * @param {String} vert a vertex shader program (string)\n * @param {String} frag a fragment shader program (string)\n * @return {WebGLProgram} created program object, or null if the creation has failed\n * @private\n */\nexport function createProgram(gl, vert, frag) {\n    const vertexShader = compileShader(gl, gl.VERTEX_SHADER, vert);\n    const fragmentShader = compileShader(gl, gl.FRAGMENT_SHADER, frag);\n    if (!vertexShader || !fragmentShader) {\n        return null;\n    }\n\n    const program = gl.createProgram();\n    if (!program) {\n        return null;\n    }\n\n    gl.attachShader(program, vertexShader);\n    gl.attachShader(program, fragmentShader);\n\n    gl.linkProgram(program);\n    return { program, vertexShader, fragmentShader };\n}\n\n/**\n * Enable vertex attributes\n * @param {Array} attributes [[name, stride, type], [name, stride, type]...]\n * @example\n * rendererr.enableVertexAttrib([\n *  ['a_position', 3, 'FLOAT'],\n *  ['a_normal', 3, 'FLOAT']\n * ]);\n * @private\n */\nexport function enableVertexAttrib(gl, program, attributes) {\n    if (Array.isArray(attributes[0])) {\n        const FSIZE = Float32Array.BYTES_PER_ELEMENT;\n        let STRIDE = 0;\n        for (let i = 0; i < attributes.length; i++) {\n            STRIDE += (attributes[i][1] || 0);\n        }\n        let offset = 0;\n        for (let i = 0; i < attributes.length; i++) {\n            const attr = gl.getAttribLocation(program, attributes[i][0]);\n            if (attr < 0) {\n                throw new Error('Failed to get the storage location of ' + attributes[i][0]);\n            }\n            gl.vertexAttribPointer(attr, attributes[i][1], gl[attributes[i][2] || 'FLOAT'], false, FSIZE * STRIDE, FSIZE * offset);\n            offset += (attributes[i][1] || 0);\n            gl.enableVertexAttribArray(attr);\n        }\n    } else {\n        const attr = gl.getAttribLocation(program, attributes[0]);\n        gl.vertexAttribPointer(attr, attributes[1], gl[attributes[2] || 'FLOAT'], false, 0, 0);\n        gl.enableVertexAttribArray(attr);\n    }\n}\n","import { IS_NODE, extend, isInteger, log2 } from '../../core/util';\nimport { createGLContext, createProgram, enableVertexAttrib } from '../../core/util/gl';\nimport Browser from '../../core/Browser';\nimport * as mat4 from '../../core/util/mat4';\nimport Canvas from '../../core/Canvas';\n\nconst shaders = {\n    'vertexShader': `\n        attribute vec3 a_position;\n\n        attribute vec2 a_texCoord;\n\n        uniform mat4 u_matrix;\n\n        varying vec2 v_texCoord;\n\n        void main() {\n            gl_Position = u_matrix * vec4(a_position, 1.0);\n\n            v_texCoord = a_texCoord;\n        }\n    `,\n    // fragment shader, can be replaced by layer.options.fragmentShader\n    'fragmentShader': `\n        precision mediump float;\n\n        uniform sampler2D u_image;\n\n        uniform float u_opacity;\n\n        varying vec2 v_texCoord;\n\n        void main() {\n\n            gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;\n\n        }\n    `\n};\n\n//reusable temporary variables\nconst v2 = [0, 0],\n    v3 = [0, 0, 0],\n    arr16 = new Array(16);\n\n/**\n * A mixin providing image support in WebGL env\n * @mixin ImageGLRenderable\n * @protected\n */\nconst ImageGLRenderable = Base => {\n    const renderable = class extends Base {\n\n        /**\n         * Draw an image at x, y at map's gl zoom\n         * @param {Image|Canvas} image\n         * @param {Number} x - x at map's gl zoom\n         * @param {Number} y - y at map's gl zoom\n         * @param {Number} w - width at map's gl zoom\n         * @param {Number} h - height at map's gl zoom\n         * @param {Number} opacity\n         */\n        drawGLImage(image, x, y, w, h, opacity) {\n            const gl = this.gl;\n            this.loadTexture(image);\n\n            v3[0] = x || 0;\n            v3[1] = y || 0;\n            const uMatrix = mat4.identity(arr16);\n            mat4.translate(uMatrix, uMatrix, v3);\n            mat4.multiply(uMatrix, this.getMap().projViewMatrix, uMatrix);\n            gl.uniformMatrix4fv(this.program['u_matrix'], false, uMatrix);\n            gl.uniform1f(this.program['u_opacity'], opacity);\n\n            const { glBuffer } = image;\n            if (glBuffer && (glBuffer.width !== w || glBuffer.height !== h)) {\n                this.saveImageBuffer(glBuffer);\n                delete image.glBuffer;\n            }\n            if (!image.glBuffer) {\n                image.glBuffer = this.bufferTileData(0, 0, w, h);\n            } else {\n                gl.bindBuffer(gl.ARRAY_BUFFER, glBuffer);\n            }\n\n            v2[0] = 'a_position';\n            v2[1] = 3;\n            this.enableVertexAttrib(v2); // ['a_position', 3]\n            gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n        }\n\n        bufferTileData(x, y, w, h, buffer) {\n            const x1 = x;\n            const x2 = x + w;\n            const y1 = y;\n            const y2 = y + h;\n            const glBuffer = this.loadImageBuffer(this.set12(\n                x1, y1, 0,\n                x1, y2, 0,\n                x2, y1, 0,\n                x2, y2, 0), buffer);\n            glBuffer.width = w;\n            glBuffer.height = h;\n            return glBuffer;\n        }\n\n        /**\n         * Draw the tile image as tins\n         * @param {HtmlElement} image\n         * @param {Array} vertices  - tin vertices\n         * @param {Array} texCoords - texture coords\n         * @param {Array} indices   - element indexes\n         * @param {number} opacity\n         */\n        drawTinImage(image, vertices, texCoords, indices, opacity) {\n            const gl = this.gl;\n            this.loadTexture(image);\n            gl.uniformMatrix4fv(this.program['u_matrix'], false, this.getMap().projViewMatrix);\n            gl.uniform1f(this.program['u_opacity'], opacity);\n\n            //bufferdata vertices\n            gl.bindBuffer(gl.ARRAY_BUFFER, this.posBuffer);\n            this.enableVertexAttrib(['a_position', 3]);\n            //TODO save buffer to avoid repeatedly bufferData\n            gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertices), gl.DYNAMIC_DRAW);\n\n            //bufferdata tex coords\n            gl.bindBuffer(gl.ARRAY_BUFFER, this.texBuffer);\n            this.enableVertexAttrib(['a_texCoord', 2]);\n            gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(texCoords), gl.DYNAMIC_DRAW);\n\n            //bufferdata indices\n            gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(indices), gl.DYNAMIC_DRAW);\n            //draw\n            gl.drawElements(gl.TRIANGLES, indices.length, gl.UNSIGNED_SHORT, 0);\n        }\n\n        /**\n         * Create another GL canvas to draw gl images\n         * For layer renderer that needs 2 seperate canvases for 2d and gl\n         */\n        createCanvas2() {\n            this.canvas2 = Canvas.createCanvas(this.canvas.width, this.canvas.height);\n        }\n\n        /**\n         * Get webgl context(this.gl). It prefers canvas2, and will change to this.canvas if canvas2 is not created\n         */\n        createGLContext() {\n            if (this.canvas.gl && this.canvas.gl.wrap) {\n                this.gl = this.canvas.gl.wrap();\n            } else {\n                this.gl = createGLContext(this.canvas2 || this.canvas, this.layer.options['glOptions']);\n            }\n            const gl = this.gl;\n            gl.clearColor(0.0, 0.0, 0.0, 0.0);\n\n            gl.disable(gl.DEPTH_TEST);\n            gl.enable(gl.STENCIL_TEST);\n\n            gl.enable(gl.BLEND);\n            gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\n\n            this.program = this.createProgram(shaders['vertexShader'], this.layer.options['fragmentShader'] || shaders['fragmentShader'], ['u_matrix', 'u_image', 'u_opacity']);\n            this.useProgram(this.program);\n\n            // input texture vec data\n            this.texBuffer = this.createBuffer();\n            gl.bindBuffer(gl.ARRAY_BUFFER, this.texBuffer);\n            this.enableVertexAttrib(['a_texCoord', 2]);\n            gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([\n                0.0, 0.0,\n                0.0, 1.0,\n                1.0, 0.0,\n                1.0, 1.0\n            ]), gl.STATIC_DRAW);\n\n            this.enableSampler('u_image');\n\n            // Enable texture unit 0\n            gl.activeTexture(gl['TEXTURE0']);\n\n            gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, true);\n\n            this.posBuffer = this.createBuffer();\n            gl.bindBuffer(gl.ARRAY_BUFFER, this.posBuffer);\n            this.enableVertexAttrib(['a_position', 3]);\n\n            // Enable indices buffer\n            this.indicesBuffer = this.createBuffer();\n            gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.indicesBuffer);\n        }\n\n        /**\n         * Resize GL canvas with renderer's 2D canvas\n         */\n        resizeGLCanvas() {\n            if (this.gl) {\n                this.gl.viewport(0, 0, this.canvas.width, this.canvas.height);\n            }\n            if (!this.canvas2) {\n                return;\n            }\n            if (this.canvas2.width !== this.canvas.width || this.canvas2.height !== this.canvas.height) {\n                this.canvas2.width = this.canvas.width;\n                this.canvas2.height = this.canvas.height;\n            }\n        }\n\n        /**\n         * Clear gl canvas\n         */\n        clearGLCanvas() {\n            if (this.gl) {\n                this.gl.clear(this.gl.COLOR_BUFFER_BIT | this.gl.STENCIL_BUFFER_BIT);\n            }\n        }\n\n        disposeImage(image) {\n            if (!image) {\n                return;\n            }\n            if (image.texture) {\n                this.saveTexture(image.texture);\n            }\n            if (image.glBuffer) {\n                this.saveImageBuffer(image.glBuffer);\n            }\n            delete image.texture;\n            delete image.glBuffer;\n        }\n\n        _createTexture(image) {\n            const gl = this.gl;\n            const texture = this.getTexture() || gl.createTexture();   // Create a texture object\n            // Bind the texture object to the target\n            gl.bindTexture(gl.TEXTURE_2D, texture);\n            // from mapbox-gl-js\n            // gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_NEAREST);\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\n            gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, image);\n\n            if (isInteger(log2(image.width)) && isInteger(log2(image.width))) {\n                gl.generateMipmap(gl.TEXTURE_2D);\n            }\n\n            return texture;\n        }\n\n        /**\n         * Get a texture from cache or create one if cache is empty\n         * @returns {WebGLTexture}\n         */\n        getTexture() {\n            if (!this._textures) {\n                this._textures = [];\n            }\n            const textures = this._textures;\n            return textures && textures.length > 0 ? textures.pop() : null;\n        }\n\n        /**\n         * Save a texture to the cache\n         * @param {WebGLTexture} texture\n         */\n        saveTexture(texture) {\n            this._textures.push(texture);\n        }\n\n        /**\n         * Load image into a text and bind it with WebGLContext\n         * @param {Image|Canvas} image\n         * @returns {WebGLTexture}\n         */\n        loadTexture(image) {\n            const gl = this.gl;\n            let texture = image.texture;   // Create a texture object\n            if (!texture) {\n                texture = this._createTexture(image);\n                image.texture = texture;\n            }\n            gl.bindTexture(gl.TEXTURE_2D, texture);\n            return texture;\n        }\n\n        /**\n         * Get a texture from cache or create one if cache is empty\n         * @returns {WebGLTexture}\n         */\n        getImageBuffer() {\n            if (!this._imageBuffers) {\n                this._imageBuffers = [];\n            }\n            const imageBuffers = this._imageBuffers;\n            return imageBuffers && imageBuffers.length > 0 ? imageBuffers.pop() : null;\n        }\n\n        /**\n         * Save a texture to the cache\n         * @param {WebGLTexture} texture\n         */\n        saveImageBuffer(buffer) {\n            this._imageBuffers.push(buffer);\n        }\n\n        /**\n         * Load image into a text and bind it with WebGLContext\n         * @returns {WebGLTexture}\n         */\n        loadImageBuffer(data, glBuffer) {\n            const gl = this.gl;\n            // Create a buffer object\n            const buffer = glBuffer || this.createImageBuffer();\n            gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n            gl.bufferData(gl.ARRAY_BUFFER, data, gl.STATIC_DRAW);\n            return buffer;\n        }\n\n        createImageBuffer() {\n            return this.getImageBuffer() || this.createBuffer();\n        }\n\n        /**\n         * remove all the resources and remove gl canvas\n         */\n        removeGLCanvas() {\n            // release resources\n            const gl = this.gl;\n            if (!gl) {\n                return;\n            }\n            if (this._buffers) {\n                this._buffers.forEach(function (b) {\n                    gl.deleteBuffer(b);\n                });\n                delete this._buffers;\n            }\n            if (this._textures) {\n                this._textures.forEach(t => gl.deleteTexture(t));\n                delete this._textures;\n            }\n            delete this.posBuffer;\n            const program = gl.program;\n            gl.deleteShader(program.fragmentShader);\n            gl.deleteShader(program.vertexShader);\n            gl.deleteProgram(program);\n            delete this.gl;\n            delete this.canvas2;\n        }\n\n        //----------------------- webgl utils unlike to change ---------------------------------\n\n        /**\n         * Create a WebGL buffer\n         * @returns {WebGLBuffer}\n         */\n        createBuffer() {\n            const gl = this.gl;\n            // Create the buffer object\n            const buffer = gl.createBuffer();\n            if (!buffer) {\n                throw new Error('Failed to create the buffer object');\n            }\n            if (!this._buffers) {\n                this._buffers = [];\n            }\n            this._buffers.push(buffer);\n            return buffer;\n        }\n\n        /**\n         * Enable vertex attributes\n         * @param {Array} attributes [[name, stride, type], [name, stride, type]...]\n         * @example\n         * rendererr.enableVertexAttrib([\n         *  ['a_position', 3, 'FLOAT'],\n         *  ['a_normal', 3, 'FLOAT']\n         * ]);\n         */\n        enableVertexAttrib(attributes) {\n            enableVertexAttrib(this.gl, this.gl.program, attributes);\n        }\n\n        /**\n         * Create the linked program object\n         * @param {String} vert a vertex shader program (string)\n         * @param {String} frag a fragment shader program (string)\n         * @return {WebGLProgram} created program object, or null if the creation has failed\n         */\n        createProgram(vert, frag, uniforms) {\n            const gl = this.gl;\n            const { program, vertexShader, fragmentShader } = createProgram(gl, vert, frag);\n            program.vertexShader = vertexShader;\n            program.fragmentShader = fragmentShader;\n\n            this._initUniforms(program, uniforms);\n            return program;\n        }\n\n        /**\n         * use the given program\n         * @param {WebGLProgram} program\n         */\n        useProgram(program) {\n            const gl = this.gl;\n            gl.useProgram(program);\n            gl.program = program;\n            return this;\n        }\n\n        /**\n         * Enable a sampler, and set texture\n         * @param {WebGLSampler} sampler\n         * @param {ptr} texture id\n         */\n        enableSampler(sampler, texIdx) {\n            const gl = this.gl;\n            const uSampler = this._getUniform(gl.program, sampler);\n            if (!texIdx) {\n                texIdx = 0;\n            }\n            // Set the texture unit to the sampler\n            gl.uniform1i(uSampler, texIdx);\n            return uSampler;\n        }\n\n        _initUniforms(program, uniforms) {\n            for (let i = 0; i < uniforms.length; i++) {\n                let name = uniforms[i];\n                let uniform = uniforms[i];\n                const b = name.indexOf('[');\n                if (b >= 0) {\n                    name = name.substring(0, b);\n                    if (!IS_NODE) {\n                        // In browser, remove [0] from uniforma declaration\n                        uniform = uniform.substring(0, b);\n                    }\n                }\n                program[name] = this._getUniform(program, uniform);\n            }\n        }\n\n        _getUniform(program, uniformName) {\n            const gl = this.gl;\n            const uniform = gl.getUniformLocation(program, uniformName);\n            if (!uniform) {\n                throw new Error('Failed to get the storage location of ' + uniformName);\n            }\n            return uniform;\n        }\n    };\n\n    extend(renderable.prototype, {\n        set12: function () {\n            const out = Browser.ie9 ? null : new Float32Array(12);\n            return function (a0, a1, a2, a3, a4, a5, a6, a7, a8, a9, a10, a11) {\n                out[0] = a0;\n                out[1] = a1;\n                out[2] = a2;\n                out[3] = a3;\n                out[4] = a4;\n                out[5] = a5;\n                out[6] = a6;\n                out[7] = a7;\n                out[8] = a8;\n                out[9] = a9;\n                out[10] = a10;\n                out[11] = a11;\n                return out;\n            };\n        }()\n    });\n\n    return renderable;\n};\n\nexport default ImageGLRenderable;\n","import { extend } from '../core/util';\nimport Browser from '../core/Browser';\nimport ImageGLRenderable from '../renderer/layer/ImageGLRenderable';\nimport CanvasRenderer from '../renderer/layer/CanvasRenderer';\nimport { ResourceCache } from '../renderer/layer/CanvasRenderer';\nimport Extent from '../geo/Extent';\nimport Layer from './Layer';\n\n/**\n * @property {Object}              options                     - ImageLayer's options\n * @property {String}              [options.crossOrigin=null]    - image's corssOrigin\n * @property {String}              [options.renderer=gl]         - ImageLayer's renderer, canvas or gl. gl tiles requires image CORS that canvas doesn't. canvas tiles can't pitch.\n * @memberOf ImageLayer\n * @instance\n */\nconst options = {\n    renderer: Browser.webgl ? 'gl' : 'canvas',\n    crossOrigin: null\n};\n\n/**\n * @classdesc\n * A layer used to display images, you can specify each image's geographic extent and opacity\n * @category layer\n * @extends Layer\n * @param {String|Number} id - tile layer's id\n * @param {Object[]} [images=null] - images\n * @param {Object} [options=null] - options defined in [ImageLayer]{@link ImageLayer#options}\n * @example\n * new ImageLayer(\"images\", [{\n        url : 'http://example.com/foo.png',\n        extent: [xmin, ymin, xmax, ymax],\n        opacity : 1\n    }])\n */\nclass ImageLayer extends Layer {\n\n    constructor(id, images, options) {\n        if (images && !Array.isArray(images) && !images.url) {\n            options = images;\n            images = null;\n        }\n        super(id, options);\n        this._images = images;\n    }\n\n    onAdd() {\n        this._prepareImages(this._images);\n    }\n\n    /**\n     * Set images and redraw\n     * @param {Object[]} images - new images\n     * @return {ImageLayer} this\n     */\n    setImages(images) {\n        this._images = images;\n        this._prepareImages(images);\n        return this;\n    }\n\n    /**\n     * Get images\n     * @return {Object[]}\n     */\n    getImages() {\n        return this._images;\n    }\n\n    _prepareImages(images) {\n        images = images || [];\n        if (!Array.isArray(images)) {\n            images = [images];\n        }\n        const map = this.getMap();\n        this._imageData = images.map(img => {\n            const extent = new Extent(img.extent);\n            return extend({}, img, {\n                extent: extent,\n                extent2d: extent.convertTo(c => map.coordToPoint(c, map.getGLZoom()))\n            });\n        });\n        this._images = images;\n        const renderer = this.getRenderer();\n        if (renderer) {\n            renderer.refreshImages();\n        }\n    }\n}\n\nImageLayer.mergeOptions(options);\n\nconst EMPTY_ARRAY = [];\n\nexport class ImageLayerCanvasRenderer extends CanvasRenderer {\n    isDrawable() {\n        if (this.getMap().getPitch()) {\n            if (console) {\n                console.warn('ImageLayer with canvas renderer can\\'t be pitched, use gl renderer (\\'renderer\\' : \\'gl\\') instead.');\n            }\n            return false;\n        }\n        return true;\n    }\n\n    checkResources() {\n        if (this._imageLoaded) {\n            return EMPTY_ARRAY;\n        }\n        const layer = this.layer;\n        let urls = layer._imageData.map(img => [img.url, null, null]);\n        if (this.resources) {\n            const unloaded = [];\n            const resources = new ResourceCache();\n            urls.forEach(url => {\n                if (this.resources.isResourceLoaded(url)) {\n                    const img = this.resources.getImage(url);\n                    resources.addResource(url, img);\n                } else {\n                    unloaded.push(url);\n                }\n            });\n            this.resources.forEach((url, res) => {\n                if (!resources.isResourceLoaded(url)) {\n                    this.retireImage(res.image);\n                }\n            });\n            this.resources = resources;\n            urls = unloaded;\n        }\n        this._imageLoaded = true;\n        return urls;\n    }\n\n    retireImage(/* image */) {\n\n    }\n\n    refreshImages() {\n        this._imageLoaded = false;\n        this.setToRedraw();\n    }\n\n    needToRedraw() {\n        const map = this.getMap();\n        // don't redraw when map is zooming without pitch and layer doesn't have any point symbolizer.\n        if (map.isZooming() && !map.getPitch()) {\n            return false;\n        }\n        return super.needToRedraw();\n    }\n\n    draw() {\n        if (!this.isDrawable()) {\n            return;\n        }\n        this.prepareCanvas();\n        this._painted = false;\n        this._drawImages();\n        this.completeRender();\n    }\n\n    _drawImages() {\n        const imgData = this.layer._imageData;\n        const map = this.getMap();\n        const mapExtent = map._get2DExtent(map.getGLZoom());\n        if (imgData && imgData.length) {\n            for (let i = 0; i < imgData.length; i++) {\n                const extent = imgData[i].extent2d;\n                const image = this.resources && this.resources.getImage(imgData[i].url);\n                if (image && mapExtent.intersects(extent)) {\n                    this._painted = true;\n                    this._drawImage(image, extent, imgData[i].opacity || 1);\n                }\n            }\n        }\n    }\n\n    _drawImage(image, extent, opacity) {\n        let globalAlpha = 0;\n        const ctx = this.context;\n        if (opacity < 1) {\n            globalAlpha = ctx.globalAlpha;\n            ctx.globalAlpha = opacity;\n        }\n        const map = this.getMap();\n        const min = extent.getMin(),\n            max = extent.getMax();\n        const point = map._pointToContainerPoint(min, map.getGLZoom());\n        let x = point.x, y = point.y;\n        const bearing = map.getBearing();\n        if (bearing) {\n            ctx.save();\n            ctx.translate(x, y);\n            if (bearing) {\n                ctx.rotate(-bearing * Math.PI / 180);\n            }\n            x = y = 0;\n        }\n        const scale = map.getGLScale();\n        ctx.drawImage(image, x, y, (max.x - min.x) / scale, (max.y - min.y) / scale);\n        if (bearing) {\n            ctx.restore();\n        }\n        if (globalAlpha) {\n            ctx.globalAlpha = globalAlpha;\n        }\n    }\n\n    drawOnInteracting() {\n        this.draw();\n    }\n}\n\nexport class ImageLayerGLRenderer extends ImageGLRenderable(ImageLayerCanvasRenderer) {\n\n    //override to set to always drawable\n    isDrawable() {\n        return true;\n    }\n\n    _drawImage(image, extent, opacity) {\n        this.drawGLImage(image, extent.xmin, extent.ymin, extent.getWidth(), extent.getHeight(), opacity);\n    }\n\n    createContext() {\n        this.createGLContext();\n    }\n\n    resizeCanvas(canvasSize) {\n        if (!this.canvas) {\n            return;\n        }\n        super.resizeCanvas(canvasSize);\n        this.resizeGLCanvas();\n    }\n\n    clearCanvas() {\n        if (!this.canvas) {\n            return;\n        }\n        super.clearCanvas();\n        this.clearGLCanvas();\n    }\n\n    retireImage(image) {\n        this.disposeImage(image);\n    }\n\n    onRemove() {\n        this.removeGLCanvas();\n        super.onRemove();\n    }\n}\n\nImageLayer.registerRenderer('canvas', ImageLayerCanvasRenderer);\nImageLayer.registerRenderer('gl', ImageLayerGLRenderer);\n\nexport default ImageLayer;\n","import Canvas from '../../../core/Canvas';\nimport CanvasRenderer from '../../../renderer/layer/CanvasRenderer';\n\nexport default class CanvasLayerRenderer extends CanvasRenderer {\n\n    getPrepareParams() {\n        return [];\n    }\n\n    getDrawParams() {\n        return [];\n    }\n\n    onCanvasCreate() {\n        if (this.canvas && this.layer.options['doubleBuffer']) {\n            this.buffer = Canvas.createCanvas(this.canvas.width, this.canvas.height, this.getMap().CanvasClass);\n        }\n    }\n\n    needToRedraw() {\n        if (this.layer.options['animation']) {\n            return true;\n        }\n        const map = this.getMap();\n        if (map.isInteracting() && !this.layer.drawOnInteracting) {\n            return false;\n        }\n        return super.needToRedraw();\n    }\n\n    draw() {\n        this.prepareCanvas();\n        this.prepareDrawContext();\n        this._drawLayer();\n    }\n\n    drawOnInteracting() {\n        this._drawLayerOnInteracting();\n    }\n\n    getCanvasImage() {\n        const canvasImg = super.getCanvasImage();\n        if (canvasImg && canvasImg.image && this.layer.options['doubleBuffer']) {\n            const canvas = canvasImg.image;\n            if (this.buffer.width !== canvas.width || this.buffer.height !== canvas.height) {\n                this.buffer.width = canvas.width;\n                this.buffer.height = canvas.height;\n            }\n            const bufferContext = this.buffer.getContext('2d');\n            const prevent = this.layer.doubleBuffer(bufferContext, this.context);\n            if (prevent === undefined || prevent) {\n                Canvas.image(bufferContext, canvas, 0, 0);\n                canvasImg.image = this.buffer;\n            }\n        }\n        return canvasImg;\n    }\n\n    remove() {\n        delete this._drawContext;\n        return super.remove();\n    }\n\n\n    onZoomStart(param) {\n        this.layer.onZoomStart(param);\n        super.onZoomStart(param);\n    }\n\n    onZooming(param) {\n        this.layer.onZooming(param);\n        super.onZooming(param);\n    }\n\n    onZoomEnd(param) {\n        this.layer.onZoomEnd(param);\n        super.onZoomEnd(param);\n    }\n\n    onMoveStart(param) {\n        this.layer.onMoveStart(param);\n        super.onMoveStart(param);\n    }\n\n    onMoving(param) {\n        this.layer.onMoving(param);\n        super.onMoving(param);\n    }\n\n    onMoveEnd(param) {\n        this.layer.onMoveEnd(param);\n        super.onMoveEnd(param);\n    }\n\n    onResize(param) {\n        this.layer.onResize(param);\n        super.onResize(param);\n    }\n\n    prepareDrawContext() {\n        if (!this._predrawed) {\n            const params = ensureParams(this.getPrepareParams());\n            this._drawContext = this.layer.prepareToDraw.apply(this.layer, [this.context].concat(params));\n            if (!this._drawContext) {\n                this._drawContext = [];\n            }\n            if (!Array.isArray(this._drawContext)) {\n                this._drawContext = [this._drawContext];\n            }\n            this._predrawed = true;\n        }\n    }\n\n    _prepareDrawParams() {\n        if (!this.getMap()) {\n            return null;\n        }\n        const view = this.getViewExtent();\n        if (view['maskExtent'] && !view['extent'].intersects(view['maskExtent'])) {\n            this.completeRender();\n            return null;\n        }\n        const args = [this.context, view];\n        const params = ensureParams(this.getDrawParams());\n        args.push.apply(args, params);\n        args.push.apply(args, this._drawContext);\n        return args;\n    }\n\n    _drawLayer() {\n        const args = this._prepareDrawParams();\n        if (!args) {\n            return;\n        }\n        this.layer.draw.apply(this.layer, args);\n        this.completeRender();\n    }\n\n    _drawLayerOnInteracting() {\n        if (!this.layer.drawOnInteracting) {\n            return;\n        }\n        const args = this._prepareDrawParams();\n        if (!args) {\n            return;\n        }\n        this.layer.drawOnInteracting.apply(this.layer, args);\n        this.completeRender();\n    }\n}\n\nfunction ensureParams(params) {\n    if (!params) {\n        params = [];\n    }\n    if (!Array.isArray(params)) {\n        params = [params];\n    }\n    return params;\n}\n","import CanvasLayerRenderer from '../renderer/layer/canvaslayer/CanvasLayerRenderer';\nimport Layer from './Layer';\n\n/**\n * @property {Object} options                  - configuration options\n * @property {Boolean} [options.doubleBuffer=false]    - layer is rendered with doubleBuffer\n * @property {Boolean} [options.animation=false]       - if the layer is an animated layer\n * @property {Boolean} [fps=1000 / 16]                 - animation fps\n * @memberOf CanvasLayer\n * @instance\n */\nconst options = {\n    'doubleBuffer'  : false,\n    'animation'     : false\n};\n\n/**\n * A layer with a HTML5 2D canvas context.<br>\n * CanvasLayer provides some interface methods for canvas context operations. <br>\n * You can use it directly, but can't serialize/deserialize a CanvasLayer with JSON in this way. <br>\n * It is more recommended to extend it with a subclass and implement canvas paintings inside the subclass.\n * @example\n *  var layer = new CanvasLayer('canvas');\n *\n *  layer.prepareToDraw = function (context) {\n *      var size = map.getSize();\n *      return [size.width, size.height]\n *  };\n *\n *  layer.draw = function (context, width, height) {\n *      context.fillStyle = \"#f00\";\n *      context.fillRect(0, 0, w, h);\n *  };\n *  layer.addTo(map);\n * @category layer\n * @extends Layer\n * @param {String|Number} id - layer's id\n * @param {Object} options - options defined in [options]{@link CanvasLayer#options}\n */\nclass CanvasLayer extends Layer {\n\n    isCanvasRender() {\n        return true;\n    }\n\n    /**\n     * An optional interface function called only once before the first draw, useful for preparing your canvas operations.\n     * @param  {CanvasRenderingContext2D } context - CanvasRenderingContext2D of the layer canvas.\n     * @return {Object[]} objects that will be passed to function draw(context, ..) as parameters.\n     */\n    prepareToDraw() {}\n\n    /**\n     * The required interface function to draw things on the layer canvas.\n     * @param  {CanvasRenderingContext2D} context - CanvasRenderingContext2D of the layer canvas.\n     * @param  {*} params.. - parameters returned by function prepareToDraw(context).\n     */\n    draw() {}\n\n    /**\n     * An optional interface function to draw while map is interacting.\n     * By default, it will call draw method instead.\n     * You can override this method if you are clear with what to draw when interacting to improve performance.\n     * @param  {CanvasRenderingContext2D} context - CanvasRenderingContext2D of the layer canvas.\n     * @param  {*} params.. - parameters returned by function prepareToDraw(context).\n     */\n    // drawOnInteracting() {\n    //     return this.draw.apply(this, arguments);\n    // }\n\n    /**\n     * Redraw the layer\n     * @return {CanvasLayer} this\n     */\n    redraw() {\n        if (this._getRenderer()) {\n            this._getRenderer().setToRedraw();\n        }\n        return this;\n    }\n\n    /**\n     * Start animation\n     * @return {CanvasLayer} this\n     */\n    play() {\n        this.config('animation', true);\n        return this;\n    }\n\n    /**\n     * Pause the animation\n     * @return {CanvasLayer} this\n     */\n    pause() {\n        this.config('animation', false);\n        return this;\n    }\n\n    /**\n     * If the animation is playing\n     * @return {Boolean}\n     */\n    isPlaying() {\n        return this.options['animation'];\n    }\n\n    /**\n     * Clear layer's canvas\n     * @return {CanvasLayer} this\n     */\n    clearCanvas() {\n        if (this._getRenderer()) {\n            this._getRenderer().clearCanvas();\n        }\n        return this;\n    }\n\n    /**\n     * Ask the map to redraw the layer canvas without firing any event.\n     * @return {CanvasLayer} this\n     */\n    requestMapToRender() {\n        if (this._getRenderer()) {\n            this._getRenderer().requestMapToRender();\n        }\n        return this;\n    }\n\n    /**\n     * Ask the map to redraw the layer canvas and fire layerload event\n     * @return {CanvasLayer} this\n     */\n    completeRender() {\n        if (this._getRenderer()) {\n            this._getRenderer().completeRender();\n        }\n        return this;\n    }\n\n    /**\n     * Callback function when layer's canvas is created. <br>\n     * Override it to do anything needed.\n     */\n    onCanvasCreate() {\n        return this;\n    }\n\n    /**\n     * The event callback for map's zoomstart event.\n     * @param  {Object} param - event parameter\n     */\n    onZoomStart() {}\n\n    /**\n     * The event callback for map's zooming event.\n     * @param  {Object} param - event parameter\n     */\n    onZooming() {}\n\n    /**\n     * The event callback for map's zoomend event.\n     * @param  {Object} param - event parameter\n     */\n    onZoomEnd() {}\n\n    /**\n     * The event callback for map's movestart event.\n     * @param  {Object} param - event parameter\n     */\n    onMoveStart() {}\n\n    /**\n     * The event callback for map's moving event.\n     * @param  {Object} param - event parameter\n     */\n    onMoving() {}\n\n    /**\n     * The event callback for map's moveend event.\n     * @param  {Object} param - event parameter\n     */\n    onMoveEnd() {}\n\n    /**\n     * The event callback for map's resize event.\n     * @param  {Object} param - event parameter\n     */\n    onResize() {}\n\n    /**\n     * The callback function to double buffer. <br>\n     * In default, it just draws and return, and you can override it if you need to process the canvas image before drawn.\n     * @param  {CanvasRenderingContext2D} bufferContext CanvasRenderingContext2D of double buffer of the layer canvas.\n     * @param  {CanvasRenderingContext2D} context CanvasRenderingContext2D of the layer canvas.\n     */\n    doubleBuffer(bufferContext/*, context*/) {\n        bufferContext.clearRect(0, 0, bufferContext.canvas.width, bufferContext.canvas.height);\n        return this;\n    }\n}\n\nCanvasLayer.mergeOptions(options);\n\nCanvasLayer.registerRenderer('canvas', CanvasLayerRenderer);\n\nexport default CanvasLayer;\n","import { now } from '../core/util';\nimport CanvasLayer from './CanvasLayer';\nimport CanvasLayerRenderer from '../renderer/layer/canvaslayer/CanvasLayerRenderer';\n/**\n * @property {Object} options                  - configuration options\n * @property {Boolean} [options.animation=true]       - if the layer is an animated layer\n * @memberOf ParticleLayer\n * @instance\n */\nconst options = {\n    'animation': true\n};\n\n/**\n * @classdesc\n * A layer to draw particles. <br>\n * ParticleLayer provides some interface methods to render particles. <br>\n * You can use it directly, but can't serialize/deserialize a ParticleLayer with JSON in this way. <br>\n * It is more recommended to extend it with a subclass.\n * @example\n * import { ParticleLayer } from 'maptalks';\n * var layer = new ParticleLayer('particle');\n *\n * layer.getParticles = function (t) {\n *     return particles[t];\n * };\n * layer.addTo(map);\n * @category layer\n * @extends CanvasLayer\n * @param {String} id - layer's id\n * @param {Object} [options=null] - options defined in [options]{@link ParticleLayer#options}\n */\nclass ParticleLayer extends CanvasLayer {\n\n    /**\n     * Interface method to get particles's position at time t.\n     * @param  {Number} t - current time in milliseconds\n     */\n    getParticles() {\n    }\n\n    draw(context, view) {\n        const points = this.getParticles(now());\n        if (!points || points.length === 0) {\n            const renderer = this._getRenderer();\n            if (renderer) {\n                this._getRenderer()._shouldClear = true;\n            }\n            return;\n        }\n        const map = this.getMap();\n        let extent = view.extent;\n        if (view.maskExtent) {\n            extent = view.extent.intersection(view.maskExtent);\n        }\n        extent = extent.convertTo(c => map._pointToContainerPoint(c));\n        const e = 2 * Math.PI;\n        for (let i = 0, l = points.length; i < l; i++) {\n            const pos = points[i].point;\n            if (extent.contains(pos)) {\n                const color = points[i].color || this.options['lineColor'] || '#fff',\n                    r = points[i].r;\n                if (context.fillStyle !== color) {\n                    context.fillStyle = color;\n                }\n                if (r <= 2) {\n                    context.fillRect(pos.x - r / 2, pos.y - r / 2, r, r);\n                } else {\n                    context.beginPath();\n                    context.arc(pos.x, pos.y, r / 2, 0, e);\n                    context.fill();\n                }\n            }\n        }\n        this._fillCanvas(context);\n    }\n\n    _fillCanvas(context) {\n        const g = context.globalCompositeOperation;\n        context.globalCompositeOperation = 'destination-out';\n        const trail = this.options['trail'] || 30;\n        context.fillStyle = 'rgba(0, 0, 0, ' + (1 / trail) + ')';\n        context.fillRect(0, 0, context.canvas.width, context.canvas.height);\n        context.globalCompositeOperation = g;\n    }\n}\n\nParticleLayer.mergeOptions(options);\n\nParticleLayer.registerRenderer('canvas', class extends CanvasLayerRenderer {\n    draw() {\n        if (!this.canvas || !this.layer.options['animation'] || this._shouldClear) {\n            this.prepareCanvas();\n            this._shouldClear = false;\n        }\n        this.prepareDrawContext();\n        this._drawLayer();\n    }\n\n    drawOnInteracting() {\n        this.draw();\n        this._shouldClear = false;\n    }\n\n    onSkipDrawOnInteracting() {\n        this._shouldClear = true;\n    }\n});\n\nexport default ParticleLayer;\n","import { INTERNAL_LAYER_PREFIX } from '../../core/Constants';\nimport { isNil, isNumber, sign, removeFromArray, UID } from '../../core/util';\nimport { lowerSymbolOpacity } from '../../core/util/style';\nimport Class from '../../core/Class';\nimport Eventable from '../../core/Eventable';\nimport Point from '../../geo/Point';\nimport Coordinate from '../../geo/Coordinate';\nimport { Marker, TextBox, LineString, Polygon, Circle, Ellipse, Sector, Rectangle } from '../';\nimport VectorLayer from '../../layer/VectorLayer';\nimport * as Symbolizers from '../../renderer/geometry/symbolizers';\n\nconst EDIT_STAGE_LAYER_PREFIX = INTERNAL_LAYER_PREFIX + '_edit_stage_';\n\nfunction createHandleSymbol(markerType, opacity) {\n    return {\n        'markerType': markerType,\n        'markerFill': '#fff',\n        'markerLineColor': '#000',\n        'markerLineWidth': 2,\n        'markerWidth': 10,\n        'markerHeight': 10,\n        'opacity' : opacity\n    };\n}\n\nconst options = {\n    //fix outline's aspect ratio when resizing\n    'fixAspectRatio' : false,\n    // geometry's symbol when editing\n    'symbol' : null,\n    'removeVertexOn' : 'contextmenu',\n    //symbols of edit handles\n    'centerHandleSymbol' : createHandleSymbol('ellipse', 1),\n    'vertexHandleSymbol' : createHandleSymbol('square', 1),\n    'newVertexHandleSymbol' : createHandleSymbol('square', 0.4)\n};\n\n/**\n * Geometry editor used internally for geometry editing.\n * @category geometry\n * @protected\n * @extends Class\n * @mixes Eventable\n */\nclass GeometryEditor extends Eventable(Class) {\n\n    /**\n     * @param {Geometry} geometry geometry to edit\n     * @param {Object} [opts=null] options\n     * @param {Object} [opts.symbol=null] symbol of being edited.\n     */\n    constructor(geometry, opts) {\n        super(opts);\n        this._geometry = geometry;\n        if (!this._geometry) {\n            return;\n        }\n    }\n\n    /**\n     * Get map\n     * @return {Map} map\n     */\n    getMap() {\n        return this._geometry.getMap();\n    }\n\n    /**\n     * Prepare to edit\n     */\n    prepare() {\n        const map = this.getMap();\n        if (!map) {\n            return;\n        }\n        /**\n         * reserve the original symbol\n         */\n        if (this.options['symbol']) {\n            this._originalSymbol = this._geometry.getSymbol();\n            this._geometry.setSymbol(this.options['symbol']);\n        }\n\n        this._prepareEditStageLayer();\n    }\n\n    _prepareEditStageLayer() {\n        const map = this.getMap();\n        const uid = UID();\n        const stageId = EDIT_STAGE_LAYER_PREFIX + uid,\n            shadowId = EDIT_STAGE_LAYER_PREFIX + uid + '_shadow';\n        this._editStageLayer = map.getLayer(stageId);\n        this._shadowLayer = map.getLayer(shadowId);\n        if (!this._editStageLayer) {\n            this._editStageLayer = new VectorLayer(stageId);\n            map.addLayer(this._editStageLayer);\n        }\n        if (!this._shadowLayer) {\n            this._shadowLayer = new VectorLayer(shadowId);\n            map.addLayer(this._shadowLayer);\n        }\n    }\n\n    /**\n     * Start to edit\n     */\n    start() {\n        if (!this._geometry || !this._geometry.getMap() || this._geometry.editing) {\n            return;\n        }\n        const map = this.getMap();\n        this.editing = true;\n        const geometry = this._geometry;\n        this._geometryDraggble = geometry.options['draggable'];\n        geometry.config('draggable', false);\n        this.prepare();\n        //edits are applied to a shadow of geometry to improve performance.\n        const shadow = geometry.copy();\n        shadow.setSymbol(geometry._getInternalSymbol());\n        //geometry copy没有将event复制到新建的geometry,对于编辑这个功能会存在一些问题\n        //原geometry上可能绑定了其它监听其click/dragging的事件,在编辑时就无法响应了.\n        shadow.copyEventListeners(geometry);\n        if (geometry._getParent()) {\n            shadow.copyEventListeners(geometry._getParent());\n        }\n        //drag shadow by center handle instead.\n        shadow.setId(null).config({\n            'draggable': false\n        });\n\n        this._shadow = shadow;\n\n        this._switchGeometryEvents('on');\n\n        geometry.hide();\n        if (geometry instanceof Marker ||\n            geometry instanceof Circle ||\n            geometry instanceof Rectangle ||\n            geometry instanceof Ellipse) {\n            //ouline has to be added before shadow to let shadow on top of it, otherwise shadow's events will be overrided by outline\n            this._createOrRefreshOutline();\n        }\n        this._shadowLayer.bringToFront().addGeometry(shadow);\n        this._editStageLayer.bringToFront();\n        this._addListener([map, 'zoomstart', () => { this._editStageLayer.hide(); }]);\n        this._addListener([map, 'zoomend', () => {\n            this._editStageLayer.show();\n        }]);\n        if (!(geometry instanceof Marker)) {\n            this._createCenterHandle();\n        } else {\n            shadow.config('draggable', true);\n            shadow.on('dragend', this._onMarkerDragEnd, this);\n        }\n        if (geometry instanceof Marker) {\n            this.createMarkerEditor();\n        } else if (geometry instanceof Circle) {\n            this.createCircleEditor();\n        } else if (geometry instanceof Rectangle) {\n            this.createEllipseOrRectEditor();\n        } else if (geometry instanceof Ellipse) {\n            this.createEllipseOrRectEditor();\n        } else if (geometry instanceof Sector) {\n            // TODO: createSectorEditor\n        } else if ((geometry instanceof Polygon) ||\n            (geometry instanceof LineString)) {\n            this.createPolygonEditor();\n        }\n    }\n\n    /**\n     * Stop editing\n     */\n    stop() {\n        delete this._history;\n        delete this._historyPointer;\n        delete this._editOutline;\n        this._switchGeometryEvents('off');\n        const map = this.getMap();\n        if (!map) {\n            return;\n        }\n        delete this._shadow;\n        this._geometry.config('draggable', this._geometryDraggble);\n        delete this._geometryDraggble;\n        this._geometry.show();\n\n        this._editStageLayer.remove();\n        this._shadowLayer.remove();\n        this._clearAllListeners();\n        this._refreshHooks = [];\n        if (this.options['symbol']) {\n            this._geometry.setSymbol(this._originalSymbol);\n            delete this._originalSymbol;\n        }\n        this.editing = false;\n    }\n\n    /**\n     * Whether the editor is editing\n     * @return {Boolean}\n     */\n    isEditing() {\n        if (isNil(this.editing)) {\n            return false;\n        }\n        return this.editing;\n    }\n\n    _getGeometryEvents() {\n        return {\n            'symbolchange': this._onGeoSymbolChange,\n            'positionchange shapechange' : this._exeAndReset\n        };\n    }\n\n    _switchGeometryEvents(oper) {\n        if (this._geometry) {\n            const events = this._getGeometryEvents();\n            for (const p in events) {\n                this._geometry[oper](p, events[p], this);\n            }\n        }\n    }\n\n    _onGeoSymbolChange(param) {\n        if (this._shadow) {\n            this._shadow.setSymbol(param.target._getInternalSymbol());\n        }\n    }\n\n    _onMarkerDragEnd() {\n        this._update('setCoordinates', this._shadow.getCoordinates().toArray());\n        this._refresh();\n    }\n\n    /**\n     * create rectangle outline of the geometry\n     * @private\n     */\n    _createOrRefreshOutline() {\n        const geometry = this._geometry;\n        let outline = this._editOutline;\n        if (!outline) {\n            outline = geometry.getOutline();\n            this._editStageLayer.addGeometry(outline);\n            this._editOutline = outline;\n            this._addRefreshHook(this._createOrRefreshOutline);\n        } else {\n            outline.remove();\n            this._editOutline = outline = geometry.getOutline();\n            this._editStageLayer.addGeometry(outline);\n        }\n\n        return outline;\n    }\n\n\n    _createCenterHandle() {\n        const center = this._shadow.getCenter();\n        const symbol = this.options['centerHandleSymbol'];\n        let shadow;\n        const handle = this.createHandle(center, {\n            'symbol': symbol,\n            'cursor': 'move',\n            onDown: () => {\n                shadow = this._shadow.copy();\n                const symbol = lowerSymbolOpacity(shadow._getInternalSymbol(), 0.5);\n                shadow.setSymbol(symbol).addTo(this._editStageLayer);\n            },\n            onMove: (v, param) => {\n                const offset = param['coordOffset'];\n                shadow.translate(offset);\n            },\n            onUp: () => {\n                this._update('setCoordinates', Coordinate.toNumberArrays(shadow.getCoordinates()));\n                shadow.remove();\n                this._refresh();\n            }\n        });\n        this._addRefreshHook(() => {\n            const center = this._shadow.getCenter();\n            handle.setCoordinates(center);\n        });\n    }\n\n    _createHandleInstance(coordinate, opts) {\n        const symbol = opts['symbol'];\n        const handle = new Marker(coordinate, {\n            'draggable': true,\n            'dragShadow': false,\n            'dragOnAxis': opts['axis'],\n            'cursor': opts['cursor'],\n            'symbol': symbol\n        });\n        return handle;\n    }\n\n    createHandle(coordinate, opts) {\n        if (!opts) {\n            opts = {};\n        }\n        const map = this.getMap();\n        const handle = this._createHandleInstance(coordinate, opts);\n        const me = this;\n\n        function onHandleDragstart(param) {\n            if (opts.onDown) {\n                /**\n                 * change geometry shape start event, fired when drag to change geometry shape.\n                 *\n                 * @event Geometry#handledragstart\n                 * @type {Object}\n                 * @property {String} type - handledragstart\n                 * @property {Geometry} target - the geometry fires the event\n                 */\n                this._geometry.fire('handledragstart');\n                opts.onDown.call(me, param['viewPoint'], param);\n            }\n            return false;\n        }\n\n        function onHandleDragging(param) {\n            me._hideContext();\n            const viewPoint = map._prjToViewPoint(handle._getPrjCoordinates());\n            if (opts.onMove) {\n                /**\n                 * changing geometry shape event, fired when dragging to change geometry shape.\n                 *\n                 * @event Geometry#handledragging\n                 * @type {Object}\n                 * @property {String} type - handledragging\n                 * @property {Geometry} target - the geometry fires the event\n                 */\n                this._geometry.fire('handledragging');\n                opts.onMove.call(me, viewPoint, param);\n            }\n            return false;\n        }\n\n        function onHandleDragEnd(ev) {\n            if (opts.onUp) {\n                /**\n                 * changed geometry shape event, fired when drag end to change geometry shape.\n                 *\n                 * @event Geometry#handledragend\n                 * @type {Object}\n                 * @property {String} type - handledragend\n                 * @property {Geometry} target - the geometry fires the event\n                 */\n                this._geometry.fire('handledragend');\n                opts.onUp.call(me, ev);\n            }\n            return false;\n        }\n\n        function onHandleRemove() {\n            handle.config('draggable', false);\n            handle.off('dragstart', onHandleDragstart, me);\n            handle.off('dragging', onHandleDragging, me);\n            handle.off('dragend', onHandleDragEnd, me);\n            handle.off('removestart', onHandleRemove, me);\n            delete handle['maptalks--editor-refresh-fn'];\n        }\n\n        handle.on('dragstart', onHandleDragstart, this);\n        handle.on('dragging', onHandleDragging, this);\n        handle.on('dragend', onHandleDragEnd, this);\n        handle.on('removestart', onHandleRemove, this);\n        //拖动移图\n        if (opts.onRefresh) {\n            handle['maptalks--editor-refresh-fn'] = opts.onRefresh;\n        }\n        this._editStageLayer.addGeometry(handle);\n        return handle;\n    }\n\n    /**\n     * create resize handles for geometry that can resize.\n     * @param {Array} blackList handle indexes that doesn't display, to prevent change a geometry's coordinates\n     * @param {fn} onHandleMove callback\n     * @private\n     */\n    _createResizeHandles(blackList, onHandleMove, onHandleUp) {\n        //cursor styles.\n        const cursors = [\n            'nw-resize', 'n-resize', 'ne-resize',\n            'w-resize', 'e-resize',\n            'sw-resize', 's-resize', 'se-resize'\n        ];\n        //defines dragOnAxis of resize handle\n        const axis = [\n            null, 'y', null,\n            'x', 'x',\n            null, 'y', null\n        ];\n        const geometry = this._geometry;\n\n        function getResizeAnchors(ext) {\n            return [\n                ext.getMin(),\n                new Point((ext['xmax'] + ext['xmin']) / 2, ext['ymin']),\n                new Point(ext['xmax'], ext['ymin']),\n                new Point(ext['xmin'], (ext['ymax'] + ext['ymin']) / 2),\n                new Point(ext['xmax'], (ext['ymax'] + ext['ymin']) / 2),\n                new Point(ext['xmin'], ext['ymax']),\n                new Point((ext['xmax'] + ext['xmin']) / 2, ext['ymax']),\n                ext.getMax()\n            ];\n        }\n        if (!blackList) {\n            blackList = [];\n        }\n        const me = this;\n        const resizeHandles = [],\n            anchorIndexes = {},\n            map = this.getMap(),\n            handleSymbol = this.options['vertexHandleSymbol'];\n        const fnLocateHandles = () => {\n            const pExt = geometry._getPainter().get2DExtent(),\n                anchors = getResizeAnchors(pExt);\n            for (let i = 0; i < anchors.length; i++) {\n                //ignore anchors in blacklist\n                if (Array.isArray(blackList)) {\n                    const isBlack = blackList.some(ele => ele === i);\n                    if (isBlack) {\n                        continue;\n                    }\n                }\n                const anchor = anchors[i],\n                    coordinate = map.pointToCoordinate(anchor);\n                if (resizeHandles.length < (anchors.length - blackList.length)) {\n                    const handle = this.createHandle(coordinate, {\n                        'symbol' : handleSymbol,\n                        'cursor': cursors[i],\n                        'axis': axis[i],\n                        onMove: (function (_index) {\n                            return function (handleViewPoint) {\n                                me._updating = true;\n                                onHandleMove(handleViewPoint, _index);\n                                geometry.fire('resizing');\n                            };\n                        })(i),\n                        onUp: () => {\n                            me._updating = false;\n                            onHandleUp();\n                            this._refresh();\n                        }\n                    });\n                    handle.setId(i);\n                    anchorIndexes[i] = resizeHandles.length;\n                    resizeHandles.push(handle);\n                } else {\n                    resizeHandles[anchorIndexes[i]].setCoordinates(coordinate);\n                }\n            }\n\n        };\n\n        fnLocateHandles();\n        //refresh hooks to refresh handles' coordinates\n        this._addRefreshHook(fnLocateHandles);\n        return resizeHandles;\n    }\n\n    /**\n     * Create marker editor\n     * @private\n     */\n    createMarkerEditor() {\n        const geometryToEdit = this._geometry,\n            shadow = this._shadow,\n            map = this.getMap();\n        if (!shadow._canEdit()) {\n            if (console) {\n                console.warn('A marker can\\'t be resized with symbol:', shadow.getSymbol());\n            }\n            return;\n        }\n\n        if (!this._history) {\n            this._recordHistory(getUpdates());\n        }\n        //only image marker and vector marker can be edited now.\n\n        const symbol = shadow._getInternalSymbol();\n        const dxdy = new Point(0, 0);\n        if (isNumber(symbol['markerDx'])) {\n            dxdy.x = symbol['markerDx'];\n        }\n        if (isNumber(symbol['markerDy'])) {\n            dxdy.y = symbol['markerDy'];\n        }\n\n        let blackList = null;\n\n        if (Symbolizers.VectorMarkerSymbolizer.test(symbol)) {\n            if (symbol['markerType'] === 'pin' || symbol['markerType'] === 'pie' || symbol['markerType'] === 'bar') {\n                //as these types of markers' anchor stands on its bottom\n                blackList = [5, 6, 7];\n            }\n        } else if (Symbolizers.ImageMarkerSymbolizer.test(symbol) ||\n            Symbolizers.VectorPathMarkerSymbolizer.test(symbol)) {\n            blackList = [5, 6, 7];\n        }\n\n        //defines what can be resized by the handle\n        //0: resize width; 1: resize height; 2: resize both width and height.\n        const resizeAbilities = [\n            2, 1, 2,\n            0,    0,\n            2, 1, 2\n        ];\n\n        let aspectRatio;\n        if (this.options['fixAspectRatio']) {\n            const size = shadow.getSize();\n            aspectRatio = size.width / size.height;\n        }\n\n        const resizeHandles = this._createResizeHandles(null, (handleViewPoint, i) => {\n            if (blackList && blackList.indexOf(i) >= 0) {\n                //need to change marker's coordinates\n                const newCoordinates = map.viewPointToCoordinate(handleViewPoint.sub(dxdy));\n                const coordinates = shadow.getCoordinates();\n                newCoordinates.x = coordinates.x;\n                shadow.setCoordinates(newCoordinates);\n                this._updateCoordFromShadow(true);\n                // geometryToEdit.setCoordinates(newCoordinates);\n                //coordinates changed, and use mirror handle instead to caculate width and height\n                const mirrorHandle = resizeHandles[resizeHandles.length - 1 - i];\n                const mirrorViewPoint = map.coordToViewPoint(mirrorHandle.getCoordinates());\n                handleViewPoint = mirrorViewPoint;\n            }\n\n            //caculate width and height\n            const viewCenter = map._pointToViewPoint(shadow._getCenter2DPoint()).add(dxdy),\n                symbol = shadow._getInternalSymbol();\n            const wh = handleViewPoint.sub(viewCenter);\n            if (blackList && handleViewPoint.y > viewCenter.y) {\n                wh.y = 0;\n            }\n\n            //if this marker's anchor is on its bottom, height doesn't need to multiply by 2.\n            const r = blackList ? 1 : 2;\n            let width = Math.abs(wh.x) * 2,\n                height = Math.abs(wh.y) * r;\n            if (aspectRatio) {\n                width = Math.max(width, height * aspectRatio);\n                height = width / aspectRatio;\n            }\n            const ability = resizeAbilities[i];\n            if (!(shadow instanceof TextBox)) {\n                if (aspectRatio || ability === 0 || ability === 2) {\n                    symbol['markerWidth'] = width;\n                }\n                if (aspectRatio || ability === 1 || ability === 2) {\n                    symbol['markerHeight'] = height;\n                }\n                shadow.setSymbol(symbol);\n                geometryToEdit.setSymbol(symbol);\n            } else {\n                if (aspectRatio || ability === 0 || ability === 2) {\n                    shadow.setWidth(width);\n                    geometryToEdit.setWidth(width);\n                }\n                if (aspectRatio || ability === 1 || ability === 2) {\n                    shadow.setHeight(height);\n                    geometryToEdit.setHeight(height);\n                }\n            }\n        }, () => {\n            this._update(getUpdates());\n        });\n\n        function getUpdates() {\n            const updates = [\n                ['setCoordinates', shadow.getCoordinates().toArray()]\n            ];\n            if (shadow instanceof TextBox) {\n                updates.push(['setWidth', shadow.getWidth()]);\n                updates.push(['setHeight', shadow.getHeight()]);\n            } else {\n                updates.push(['setSymbol', shadow.getSymbol()]);\n            }\n            return updates;\n        }\n\n        function onZoomEnd() {\n            this._refresh();\n        }\n\n        this._addListener([map, 'zoomend', onZoomEnd]);\n\n    }\n\n    /**\n     * Create circle editor\n     * @private\n     */\n    createCircleEditor() {\n        const circle = this._geometry,\n            shadow = this._shadow;\n        const map = this.getMap();\n\n        if (!this._history) {\n            this._recordHistory([\n                ['setCoordinates', shadow.getCoordinates().toArray()],\n                ['setRadius', shadow.getRadius()]\n            ]);\n        }\n\n        this._createResizeHandles(null, handleViewPoint => {\n            const viewCenter = map._pointToViewPoint(shadow._getCenter2DPoint());\n            const wh = handleViewPoint.sub(viewCenter);\n            const w = Math.abs(wh.x),\n                h = Math.abs(wh.y);\n            let r;\n            if (w > h) {\n                r = map.pixelToDistance(w, 0);\n            } else {\n                r = map.pixelToDistance(0, h);\n            }\n            shadow.setRadius(r);\n            circle.setRadius(r);\n        }, () => {\n            this._update('setRadius', shadow.getRadius());\n        });\n    }\n\n    /**\n     * editor of ellipse or rectangle\n     * @private\n     */\n    createEllipseOrRectEditor() {\n        //defines what can be resized by the handle\n        //0: resize width; 1: resize height; 2: resize both width and height.\n        const resizeAbilities = [\n            2, 1, 2,\n            0, 0,\n            2, 1, 2\n        ];\n        const geometryToEdit = this._geometry,\n            shadow = this._shadow;\n\n        if (!this._history) {\n            this._recordHistory(getUpdates());\n        }\n\n        const map = this.getMap();\n        const isRect = this._geometry instanceof Rectangle;\n        let aspectRatio;\n        if (this.options['fixAspectRatio']) {\n            aspectRatio = geometryToEdit.getWidth() / geometryToEdit.getHeight();\n        }\n        const resizeHandles = this._createResizeHandles(null, (mouseViewPoint, i) => {\n            //ratio of width and height\n            const r = isRect ? 1 : 2;\n            let pointSub, w, h;\n            const targetPoint = mouseViewPoint;\n            const ability = resizeAbilities[i];\n            if (isRect) {\n                const mirror = resizeHandles[7 - i];\n                const mirrorViewPoint = map.coordToViewPoint(mirror.getCoordinates());\n                pointSub = targetPoint.sub(mirrorViewPoint);\n                const absSub = pointSub.abs();\n                w = map.pixelToDistance(absSub.x, 0);\n                h = map.pixelToDistance(0, absSub.y);\n                const size = geometryToEdit.getSize();\n                if (ability === 0) {\n                    // changing width\n                    // -  -  -\n                    // 0     0\n                    // -  -  -\n                    // Rectangle's northwest's y is (y - height / 2)\n                    if (aspectRatio) {\n                        // update rectangle's height with aspect ratio\n                        absSub.y = absSub.x / aspectRatio;\n                        size.height = Math.abs(absSub.y);\n                        h = w / aspectRatio;\n                    }\n                    targetPoint.y = mirrorViewPoint.y - size.height / 2;\n                } else if (ability === 1) {\n                    // changing height\n                    // -  1  -\n                    // |     |\n                    // -  1  -\n                    // Rectangle's northwest's x is (x - width / 2)\n                    if (aspectRatio) {\n                        // update rectangle's width with aspect ratio\n                        absSub.x = absSub.y * aspectRatio;\n                        size.width = Math.abs(absSub.x);\n                        w = h * aspectRatio;\n                    }\n                    targetPoint.x = mirrorViewPoint.x - size.width / 2;\n                } else if (aspectRatio) {\n                    // corner handles, relocate the target point according to aspect ratio.\n                    if (w > h * aspectRatio) {\n                        h = w / aspectRatio;\n                        targetPoint.y = mirrorViewPoint.y + absSub.x * sign(pointSub.y) / aspectRatio;\n                    } else {\n                        w = h * aspectRatio;\n                        targetPoint.x = mirrorViewPoint.x + absSub.y  * sign(pointSub.x) * aspectRatio;\n                    }\n                }\n                //change rectangle's coordinates\n                const newCoordinates = map.viewPointToCoordinate(new Point(Math.min(targetPoint.x, mirrorViewPoint.x), Math.min(targetPoint.y, mirrorViewPoint.y)));\n                shadow.setCoordinates(newCoordinates);\n                this._updateCoordFromShadow(true);\n                // geometryToEdit.setCoordinates(newCoordinates);\n\n            } else {\n                const viewCenter = map.coordToViewPoint(geometryToEdit.getCenter());\n                pointSub = viewCenter.sub(targetPoint)._abs();\n                w = map.pixelToDistance(pointSub.x, 0);\n                h = map.pixelToDistance(0, pointSub.y);\n                if (aspectRatio) {\n                    w = Math.max(w, h * aspectRatio);\n                    h = w / aspectRatio;\n                }\n            }\n\n            if (aspectRatio || ability === 0 || ability === 2) {\n                shadow.setWidth(w * r);\n                geometryToEdit.setWidth(w * r);\n            }\n            if (aspectRatio || ability === 1 || ability === 2) {\n                shadow.setHeight(h * r);\n                geometryToEdit.setHeight(h * r);\n            }\n        }, () => {\n            this._update(getUpdates());\n        });\n\n        function getUpdates() {\n            return [\n                ['setCoordinates', shadow.getCoordinates().toArray()],\n                ['setWidth', shadow.getWidth()],\n                ['setHeight', shadow.getHeight()]\n            ];\n        }\n    }\n\n    /**\n     * Editor for polygon\n     * @private\n     */\n    createPolygonEditor() {\n\n        const map = this.getMap(),\n            shadow = this._shadow,\n            me = this,\n            projection = map.getProjection();\n        if (!this._history) {\n            this._recordHistory('setCoordinates', Coordinate.toNumberArrays(shadow.getCoordinates()));\n        }\n\n        const verticeLimit = shadow instanceof Polygon ? 3 : 2;\n        const propertyOfVertexRefreshFn = 'maptalks--editor-refresh-fn',\n            propertyOfVertexIndex = 'maptalks--editor-vertex-index';\n        const vertexHandles = [],\n            newVertexHandles = [];\n\n        function getVertexCoordinates() {\n            if (shadow instanceof Polygon) {\n                const coordinates = shadow.getCoordinates()[0];\n                return coordinates.slice(0, coordinates.length - 1);\n            } else {\n                return shadow.getCoordinates();\n            }\n\n        }\n\n        function getVertexPrjCoordinates() {\n            return shadow._getPrjCoordinates();\n        }\n\n        function onVertexAddOrRemove() {\n            //restore index property of each handles.\n            for (let i = vertexHandles.length - 1; i >= 0; i--) {\n                vertexHandles[i][propertyOfVertexIndex] = i;\n            }\n            for (let i = newVertexHandles.length - 1; i >= 0; i--) {\n                newVertexHandles[i][propertyOfVertexIndex] = i;\n            }\n            me._updateCoordFromShadow();\n        }\n\n        function removeVertex(param) {\n            const handle = param['target'],\n                index = handle[propertyOfVertexIndex];\n            const prjCoordinates = getVertexPrjCoordinates();\n            if (prjCoordinates.length <= verticeLimit) {\n                return;\n            }\n            prjCoordinates.splice(index, 1);\n            shadow._setPrjCoordinates(prjCoordinates);\n            shadow._updateCache();\n            //remove vertex handle\n            vertexHandles.splice(index, 1)[0].remove();\n            //remove two neighbor \"new vertex\" handles\n            if (index < newVertexHandles.length) {\n                newVertexHandles.splice(index, 1)[0].remove();\n            }\n            let nextIndex;\n            if (index === 0) {\n                nextIndex = newVertexHandles.length - 1;\n            } else {\n                nextIndex = index - 1;\n            }\n            newVertexHandles.splice(nextIndex, 1)[0].remove();\n            //add a new \"new vertex\" handle.\n            newVertexHandles.splice(nextIndex, 0, createNewVertexHandle.call(me, nextIndex));\n            onVertexAddOrRemove();\n            me._refresh();\n        }\n\n        function moveVertexHandle(handleViewPoint, index) {\n            const vertice = getVertexPrjCoordinates();\n            const nVertex = map._viewPointToPrj(handleViewPoint);\n            const pVertex = vertice[index];\n            pVertex.x = nVertex.x;\n            pVertex.y = nVertex.y;\n            shadow._updateCache();\n            shadow.onShapeChanged();\n            me._updateCoordFromShadow(true);\n            let nextIndex;\n            if (index === 0) {\n                nextIndex = newVertexHandles.length - 1;\n            } else {\n                nextIndex = index - 1;\n            }\n            //refresh two neighbor \"new vertex\" handles.\n            if (newVertexHandles[index]) {\n                newVertexHandles[index][propertyOfVertexRefreshFn]();\n            }\n            if (newVertexHandles[nextIndex]) {\n                newVertexHandles[nextIndex][propertyOfVertexRefreshFn]();\n            }\n        }\n\n        function createVertexHandle(index) {\n            let vertex = getVertexCoordinates()[index];\n            const handle = me.createHandle(vertex, {\n                'symbol': me.options['vertexHandleSymbol'],\n                'cursor': 'pointer',\n                'axis': null,\n                onMove: function (handleViewPoint) {\n                    moveVertexHandle(handleViewPoint, handle[propertyOfVertexIndex]);\n                },\n                onRefresh: function () {\n                    vertex = getVertexCoordinates()[handle[propertyOfVertexIndex]];\n                    handle.setCoordinates(vertex);\n                },\n                onUp: function () {\n                    me._refresh();\n                    me._updateCoordFromShadow();\n                },\n                onDown: function (param, e) {\n                    if (e && e.domEvent && e.domEvent.button === 2) {\n                        return;\n                    }\n                }\n            });\n            handle[propertyOfVertexIndex] = index;\n            handle.on(me.options['removeVertexOn'], removeVertex);\n            return handle;\n        }\n\n        function createNewVertexHandle(index) {\n            let vertexCoordinates = getVertexCoordinates();\n            let nextVertex;\n            if (index + 1 >= vertexCoordinates.length) {\n                nextVertex = vertexCoordinates[0];\n            } else {\n                nextVertex = vertexCoordinates[index + 1];\n            }\n            const vertex = vertexCoordinates[index].add(nextVertex).multi(1 / 2);\n            const handle = me.createHandle(vertex, {\n                'symbol': me.options['newVertexHandleSymbol'],\n                'cursor': 'pointer',\n                'axis': null,\n                onDown: function (param, e) {\n                    if (e && e.domEvent && e.domEvent.button === 2) {\n                        return;\n                    }\n                    const prjCoordinates = getVertexPrjCoordinates();\n                    const vertexIndex = handle[propertyOfVertexIndex];\n                    //add a new vertex\n                    const pVertex = projection.project(handle.getCoordinates());\n                    //update shadow's vertice\n                    prjCoordinates.splice(vertexIndex + 1, 0, pVertex);\n                    shadow._setPrjCoordinates(prjCoordinates);\n                    shadow._updateCache();\n\n                    const symbol = handle.getSymbol();\n                    delete symbol['opacity'];\n                    handle.setSymbol(symbol);\n\n                    //add two \"new vertex\" handles\n                    newVertexHandles.splice(vertexIndex, 0, createNewVertexHandle.call(me, vertexIndex), createNewVertexHandle.call(me, vertexIndex + 1));\n\n                },\n                onMove: function (handleViewPoint) {\n                    moveVertexHandle(handleViewPoint, handle[propertyOfVertexIndex] + 1);\n                },\n                onUp: function (e) {\n                    if (e && e.domEvent && e.domEvent.button === 2) {\n                        return;\n                    }\n                    const vertexIndex = handle[propertyOfVertexIndex];\n                    //remove this handle\n                    removeFromArray(handle, newVertexHandles);\n                    handle.remove();\n                    //add a new vertex handle\n                    vertexHandles.splice(vertexIndex + 1, 0, createVertexHandle.call(me, vertexIndex + 1));\n                    onVertexAddOrRemove();\n                    me._updateCoordFromShadow();\n                    me._refresh();\n                },\n                onRefresh: function () {\n                    vertexCoordinates = getVertexCoordinates();\n                    const vertexIndex = handle[propertyOfVertexIndex];\n                    let nextIndex;\n                    if (vertexIndex === vertexCoordinates.length - 1) {\n                        nextIndex = 0;\n                    } else {\n                        nextIndex = vertexIndex + 1;\n                    }\n                    const refreshVertex = vertexCoordinates[vertexIndex].add(vertexCoordinates[nextIndex]).multi(1 / 2);\n                    handle.setCoordinates(refreshVertex);\n                }\n            });\n            handle[propertyOfVertexIndex] = index;\n            return handle;\n        }\n        const vertexCoordinates = getVertexCoordinates();\n        for (let i = 0, len = vertexCoordinates.length; i < len; i++) {\n            vertexHandles.push(createVertexHandle.call(this, i));\n            if (i < len - 1) {\n                newVertexHandles.push(createNewVertexHandle.call(this, i));\n            }\n        }\n        if (shadow instanceof Polygon) {\n            //1 more vertex handle for polygon\n            newVertexHandles.push(createNewVertexHandle.call(this, vertexCoordinates.length - 1));\n        }\n        this._addRefreshHook(() => {\n            for (let i = newVertexHandles.length - 1; i >= 0; i--) {\n                newVertexHandles[i][propertyOfVertexRefreshFn]();\n            }\n            for (let i = vertexHandles.length - 1; i >= 0; i--) {\n                vertexHandles[i][propertyOfVertexRefreshFn]();\n            }\n        });\n    }\n\n    _refresh() {\n        if (this._refreshHooks) {\n            for (let i = this._refreshHooks.length - 1; i >= 0; i--) {\n                this._refreshHooks[i].call(this);\n            }\n        }\n    }\n\n    _hideContext() {\n        if (this._geometry) {\n            this._geometry.closeMenu();\n            this._geometry.closeInfoWindow();\n        }\n    }\n\n    _addListener(listener) {\n        if (!this._eventListeners) {\n            this._eventListeners = [];\n        }\n        this._eventListeners.push(listener);\n        listener[0].on(listener[1], listener[2], this);\n    }\n\n    _clearAllListeners() {\n        if (this._eventListeners && this._eventListeners.length > 0) {\n            for (let i = this._eventListeners.length - 1; i >= 0; i--) {\n                const listener = this._eventListeners[i];\n                listener[0].off(listener[1], listener[2], this);\n            }\n            this._eventListeners = [];\n        }\n    }\n\n    _addRefreshHook(fn) {\n        if (!fn) {\n            return;\n        }\n        if (!this._refreshHooks) {\n            this._refreshHooks = [];\n        }\n        this._refreshHooks.push(fn);\n    }\n\n    _update(method, ...args) {\n        this._exeHistory([method, args]);\n        this._recordHistory(method, ...args);\n    }\n\n    _updateCoordFromShadow(ignoreRecord) {\n        if (!this._shadow) {\n            return;\n        }\n\n        const coords = this._shadow.getCoordinates();\n        const geo = this._geometry;\n        const updating = this._updating;\n        this._updating = true;\n        geo.setCoordinates(coords);\n        if (!ignoreRecord) {\n            this._recordHistory('setCoordinates', Coordinate.toNumberArrays(geo.getCoordinates()));\n        }\n        this._updating = updating;\n    }\n\n    _recordHistory(method, ...args) {\n        if (!this._history) {\n            this._history = [];\n            this._historyPointer = 0;\n        }\n\n        if (this._historyPointer < this._history.length - 1) {\n            // remove old 'next views'\n            this._history.splice(this._historyPointer + 1);\n        }\n        this._history.push([method, args]);\n        this._historyPointer = this._history.length - 1;\n        /**\n         * edit record event, fired when an edit happend and being recorded\n         *\n         * @event Geometry#editrecord\n         * @type {Object}\n         * @property {String} type - editrecord\n         * @property {Geometry} target - the geometry fires the event\n         */\n        this._geometry.fire('editrecord');\n    }\n\n    /**\n     * Get previous map view in view history\n     * @return {Object} map view\n     */\n    undo() {\n        if (!this._history || this._historyPointer === 0) {\n            return this;\n        }\n        const record = this._history[--this._historyPointer];\n        this._exeAndReset(record);\n        return this;\n    }\n\n    /**\n     * Get next view in view history\n     * @return {Object} map view\n     */\n    redo() {\n        if (!this._history || this._historyPointer === this._history.length - 1) {\n            return null;\n        }\n        const record = this._history[++this._historyPointer];\n        this._exeAndReset(record);\n        return this;\n    }\n\n    _exeAndReset(record) {\n        if (this._updating) {\n            return;\n        }\n        this._exeHistory(record);\n        const history = this._history,\n            pointer = this._historyPointer;\n        this.stop();\n        this._history = history;\n        this._historyPointer = pointer;\n        this.start();\n    }\n\n    _exeHistory(record) {\n        if (!Array.isArray(record)) {\n            return;\n        }\n        const updating = this._updating;\n        this._updating = true;\n        const geo = this._geometry;\n        if (Array.isArray(record[0])) {\n            record[0].forEach(o => {\n                const m = o[0],\n                    args = o.slice(1);\n                this._shadow[m].apply(this._shadow, args);\n                geo[m].apply(geo, args);\n            });\n        } else {\n            this._shadow[record[0]].apply(this._shadow, record[1]);\n            geo[record[0]].apply(geo, record[1]);\n        }\n        this._updating = updating;\n    }\n\n}\n\nGeometryEditor.mergeOptions(options);\n\nexport default GeometryEditor;\n","import { on, off, createEl, stopPropagation } from '../../core/util/dom';\nimport { isNil } from '../../core/util';\nimport TextMarker from '../../geometry/TextMarker';\nimport UIMarker from '../../ui/UIMarker';\n\n/**\n * Mixin methods for text editing.\n * @mixin TextEditable\n */\nconst TextEditable = {\n    /**\n     * Start to edit the text, editing will be ended automatically whenever map is clicked.\n     *\n     * @return {TextMarker} this\n     * @fires TextMarker#edittextstart\n     */\n    startEditText() {\n        if (!this.getMap()) {\n            return this;\n        }\n        this.hide();\n        this.endEditText();\n        this._prepareEditor();\n        /**\n         * edittextstart when starting to edit text content\n         * @event TextMarker#edittextstart\n         * @type {Object}\n         * @property {String} type - edittextstart\n         * @property {TextMarker} target - fires the event\n         */\n        this._fireEvent('edittextstart');\n        return this;\n    },\n\n    /**\n     * End text edit.\n     *\n     * @return {TextMarker} this\n     * @fires TextMarker#edittextend\n     */\n    endEditText() {\n        if (this._textEditor) {\n            let html = this._textEditor.innerHTML;\n            html = html.replace(/<p>/ig, '').replace(/<\\/p>/ig, '<br/>');\n            this._textEditor.innerHTML = html;\n            // trim enter chars in the end of text for IE\n            const content = this._textEditor.innerText.replace(/[\\r\\n]+$/gi, '');\n            this.setContent(content);\n            off(this._textEditor, 'mousedown dblclick', stopPropagation);\n            this.getMap().off('mousedown', this.endEditText, this);\n            this._editUIMarker.remove();\n            delete this._editUIMarker;\n            this._textEditor.onkeyup = null;\n            delete this._textEditor;\n            this.show();\n            /**\n             * edittextend when ended editing text content\n             * @event TextMarker#edittextend\n             * @type {Object}\n             * @property {String} type - edittextend\n             * @property {TextMarker} target - textMarker fires the event\n             */\n            this._fireEvent('edittextend');\n        }\n        return this;\n    },\n\n    /**\n     * Whether the text is being edited.\n     *\n     * @return {Boolean}\n     */\n    isEditingText() {\n        if (this._textEditor) {\n            return true;\n        }\n        return false;\n    },\n\n    /**\n     * Get the text editor which is an [ui.UIMarker]{@link ui.UIMarker}\n     * @return {ui.UIMarker} text editor\n     */\n    getTextEditor() {\n        return this._editUIMarker;\n    },\n\n    _prepareEditor() {\n        const map = this.getMap();\n        const editContainer = this._createEditor();\n        this._textEditor = editContainer;\n        map.on('mousedown', this.endEditText, this);\n        const offset = this._getEditorOffset();\n        this._editUIMarker = new UIMarker(this.getCoordinates(), {\n            'animation' : null,\n            'content': editContainer,\n            'dx': offset.dx,\n            'dy': offset.dy\n        }).addTo(map);\n        this._setCursorToLast(this._textEditor);\n    },\n\n    _getEditorOffset() {\n        const symbol = this._getInternalSymbol() || {};\n        let dx = 0,\n            dy = 0;\n        const textAlign = symbol['textHorizontalAlignment'];\n        if (textAlign === 'middle' || isNil(textAlign)) {\n            dx = (symbol['textDx'] || 0) - 2;\n            dy = (symbol['textDy'] || 0) - 2;\n        } else {\n            dx = (symbol['markerDx'] || 0) - 2;\n            dy = (symbol['markerDy'] || 0) - 2;\n        }\n        return {\n            'dx': dx,\n            'dy': dy\n        };\n    },\n\n    _createEditor() {\n        const content = this.getContent();\n        const labelSize = this.getSize(),\n            symbol = this._getInternalSymbol() || {},\n            width = labelSize.width,\n            textColor = symbol['textFill'] || '#000000',\n            textSize = symbol['textSize'] || 12,\n            height = labelSize.height,\n            lineColor = symbol['markerLineColor'] || '#000',\n            fill = symbol['markerFill'] || '#3398CC',\n            spacing = symbol['textLineSpacing'] || 0;\n        const editor = createEl('div');\n        editor.contentEditable = true;\n        editor.style.cssText = `background:${fill}; border:1px solid ${lineColor};\n            color:${textColor};font-size:${textSize}px;width:${width - 2}px;height:${height - 2}px;margin: auto;\n            line-height:${textSize + spacing}px;outline: 0; padding:0; margin:0;word-wrap: break-word;\n            overflow: hidden;-webkit-user-modify: read-write-plaintext-only;`;\n\n        editor.innerText = content;\n        on(editor, 'mousedown dblclick', stopPropagation);\n        editor.onkeyup = function (event) {\n            const h = editor.style.height || 0;\n            if (event.keyCode === 13) {\n                editor.style.height = (parseInt(h) + textSize / 2) + 'px';\n            }\n        };\n        return editor;\n    },\n\n    _setCursorToLast(obj) {\n        let range;\n        if (window.getSelection) {\n            obj.focus();\n            range = window.getSelection();\n            range.selectAllChildren(obj);\n            range.collapseToEnd();\n        } else if (document.selection) {\n            range = document.selection.createRange();\n            range.moveToElementText(obj);\n            range.collapse(false);\n            range.select();\n        }\n    }\n};\n\nTextMarker.include(TextEditable);\n\nexport default TextEditable;\n","import { isFunction } from '../../core/util';\nimport { extendSymbol } from '../../core/util/style';\nimport { Animation } from '../../core/Animation';\nimport Coordinate from '../../geo/Coordinate';\nimport Geometry from '../Geometry';\n\nGeometry.include(/** @lends Geometry.prototype */ {\n    /**\n     * Animate the geometry\n     *\n     * @param  {Object}   styles          - styles to animate\n     * @param  {Object}   [options=null]  - animation options\n     * @param  {NUmber}   [options.duration=1000]      - duration\n     * @param  {Number}   [options.startTime=null]  - time to start animation in ms\n     * @param  {String}   [options.easing=linear]   - animation easing: in, out, inAndOut, linear, upAndDown\n     * @param  {Boolean}  [options.repeat=false]      - repeat animation\n     * @param  {Function} [step=null]  - step function during animation, animation frame as the parameter\n     * @return {animation.Player} animation player\n     * @example\n     * var player = marker.animate({\n     *     'symbol': {\n     *         'markerHeight': 82\n     *      }\n     * }, {\n     *     'duration': 2000\n     * }, function (frame) {\n     *     if (frame.state.playState === 'finished') {\n     *         console.log('animation finished');\n     *     }\n     * });\n     * player.pause();\n     */\n    animate: function (styles, options, step) {\n        if (this._animPlayer) {\n            this._animPlayer.finish();\n        }\n        if (isFunction(options)) {\n            step = options;\n        }\n        if (!options) {\n            options = {};\n        }\n        const map = this.getMap(),\n            projection = this._getProjection(),\n            symbol = this.getSymbol() || {},\n            stylesToAnimate = this._prepareAnimationStyles(styles);\n        let preTranslate;\n\n        const isFocusing = options['focus'];\n        delete this._animationStarted;\n        // geometry.animate can be called without map\n        if (map) {\n            // merge geometry animation framing into map's frame loop\n            const renderer = map._getRenderer();\n            const framer = function (fn) {\n                renderer.callInNextFrame(fn);\n            };\n            options['framer'] = framer;\n        }\n\n        const player = Animation.animate(stylesToAnimate, options, frame => {\n            if (map && map.isRemoved()) {\n                player.finish();\n                return;\n            }\n            if (map && !this._animationStarted && isFocusing) {\n                map.onMoveStart();\n            }\n            const styles = frame.styles;\n            for (const p in styles) {\n                if (p !== 'symbol' && p !== 'translate' && styles.hasOwnProperty(p)) {\n                    const fnName = 'set' + p[0].toUpperCase() + p.slice(1);\n                    this[fnName](styles[p]);\n                }\n            }\n            const translate = styles['translate'];\n            if (translate) {\n                let toTranslate = translate;\n                if (preTranslate) {\n                    toTranslate = translate.sub(preTranslate);\n                }\n                preTranslate = translate;\n                this.translate(toTranslate);\n            }\n            const dSymbol = styles['symbol'];\n            if (dSymbol) {\n                this.setSymbol(extendSymbol(symbol, dSymbol));\n            }\n            if (map && isFocusing) {\n                const pcenter = projection.project(this.getCenter());\n                map._setPrjCenter(pcenter);\n                const e = map._parseEventFromCoord(projection.unproject(pcenter));\n                if (player.playState !== 'running') {\n                    map.onMoveEnd(e);\n                } else {\n                    map.onMoving(e);\n                }\n            }\n            this._fireAnimateEvent(player.playState);\n            if (step) {\n                step(frame);\n            }\n        });\n        this._animPlayer = player;\n        return this._animPlayer.play();\n    },\n    /**\n     * Prepare styles for animation\n     * @return {Object} styles\n     * @private\n     */\n    _prepareAnimationStyles: function (styles) {\n        const symbol = this._getInternalSymbol();\n        const stylesToAnimate = {};\n        for (const p in styles) {\n            if (styles.hasOwnProperty(p)) {\n                const v = styles[p];\n                if (p !== 'translate' && p !== 'symbol') {\n                    //this.getRadius() / this.getWidth(), etc.\n                    const fnName = 'get' + p[0].toUpperCase() + p.substring(1);\n                    const current = this[fnName]();\n                    stylesToAnimate[p] = [current, v];\n                } else if (p === 'symbol') {\n                    let symbolToAnimate;\n                    if (Array.isArray(styles['symbol'])) {\n                        if (!Array.isArray(symbol)) {\n                            throw new Error('geometry\\'symbol isn\\'t a composite symbol, while the symbol in styles is.');\n                        }\n                        symbolToAnimate = [];\n                        const symbolInStyles = styles['symbol'];\n                        for (let i = 0; i < symbolInStyles.length; i++) {\n                            if (!symbolInStyles[i]) {\n                                symbolToAnimate.push(null);\n                                continue;\n                            }\n                            const a = {};\n                            for (const sp in symbolInStyles[i]) {\n                                if (symbolInStyles[i].hasOwnProperty(sp)) {\n                                    a[sp] = [symbol[i][sp], symbolInStyles[i][sp]];\n                                }\n                            }\n                            symbolToAnimate.push(a);\n                        }\n                    } else {\n                        if (Array.isArray(symbol)) {\n                            throw new Error('geometry\\'symbol is a composite symbol, while the symbol in styles isn\\'t.');\n                        }\n                        symbolToAnimate = {};\n                        for (const sp in v) {\n                            if (v.hasOwnProperty(sp)) {\n                                symbolToAnimate[sp] = [symbol[sp], v[sp]];\n                            }\n                        }\n                    }\n                    stylesToAnimate['symbol'] = symbolToAnimate;\n                } else if (p === 'translate') {\n                    stylesToAnimate['translate'] = new Coordinate(v);\n                }\n            }\n        }\n        return stylesToAnimate;\n    },\n\n    _fireAnimateEvent: function (playState) {\n        if (playState === 'finished') {\n            delete this._animationStarted;\n            /**\n             * fired when geometry's animation ended.\n             *\n             * @event Geometry#animateend\n             * @type {Object}\n             * @property {String} type - animateend\n             * @property {Geometry} target - the geometry fires the event\n             */\n            this._fireEvent('animateend');\n        } else if (playState === 'running') {\n            if (this._animationStarted) {\n                /**\n                 * fired when geometry is animating.\n                 *\n                 * @event Geometry#animating\n                 * @type {Object}\n                 * @property {String} type - animating\n                 * @property {Geometry} target - the geometry fires the event\n                 */\n                this._fireEvent('animating');\n            } else {\n                /**\n                 * fired when geometry's animation start.\n                 *\n                 * @event Geometry#animatestart\n                 * @type {Object}\n                 * @property {String} type - animatestart\n                 * @property {Geometry} target - the geometry fires the event\n                 */\n                this._fireEvent('animatestart');\n                this._animationStarted = true;\n            }\n        }\n    }\n});\n","import { INTERNAL_LAYER_PREFIX } from '../../core/Constants';\nimport { lowerSymbolOpacity } from '../../core/util/style';\nimport { on, off } from '../../core/util/dom';\nimport Browser from '../../core/Browser';\nimport Handler from '../../handler/Handler';\nimport Geometry from '../Geometry';\nimport DragHandler from '../../handler/Drag';\nimport VectorLayer from '../../layer/VectorLayer';\nimport { ConnectorLine } from '../ConnectorLine';\nimport { ResourceCache } from '../../renderer/layer/CanvasRenderer';\n\nconst DRAG_STAGE_LAYER_ID = INTERNAL_LAYER_PREFIX + '_drag_stage';\n\nconst EVENTS = Browser.touch ? 'touchstart mousedown' : 'mousedown';\n\n/**\n * Drag handler for geometries.\n * @category handler\n * @extends Handler\n * @ignore\n */\nclass GeometryDragHandler extends Handler  {\n\n    /**\n     * @param  {Geometry} target geometry target to drag\n     */\n    constructor(target) {\n        super(target);\n    }\n\n    addHooks() {\n        this.target.on(EVENTS, this._startDrag, this);\n    }\n\n    removeHooks() {\n        this._endDrag();\n        this.target.off(EVENTS, this._startDrag, this);\n        delete this.container;\n    }\n\n    _prepareDragHandler() {\n        this._dragHandler = new DragHandler(this.container);\n        this._dragHandler.on('dragging', this._dragging, this)\n            .on('mouseup', this._endDrag, this)\n            .enable();\n    }\n\n    _prepareShadow() {\n        const target = this.target;\n        this._prepareDragStageLayer();\n        if (this._shadow) {\n            this._shadow.remove();\n        }\n\n        const shadow = this._shadow = target.copy();\n        this._shadow.setSymbol(target._getInternalSymbol());\n        if (target.options['dragShadow']) {\n            const symbol = lowerSymbolOpacity(shadow._getInternalSymbol(), 0.5);\n            shadow.setSymbol(symbol);\n        }\n        shadow.setId(null);\n        this._prepareShadowConnectors();\n    }\n\n    _prepareShadowConnectors() {\n        //copy connectors\n        const target = this.target;\n        const shadow = this._shadow;\n        const resources = this._dragStageLayer._getRenderer().resources;\n\n        const shadowConnectors = [];\n        if (ConnectorLine._hasConnectors(target)) {\n            const connectors = ConnectorLine._getConnectors(target);\n\n            for (let i = 0, l = connectors.length; i < l; i++) {\n                const targetConn = connectors[i];\n                const connOptions = targetConn.config(),\n                    connSymbol = targetConn._getInternalSymbol();\n                connOptions['symbol'] = lowerSymbolOpacity(connSymbol, 0.5);\n                let conn;\n                if (targetConn.getConnectSource() === target) {\n                    conn = new targetConn.constructor(shadow, targetConn.getConnectTarget(), connOptions);\n                } else {\n                    conn = new targetConn.constructor(targetConn.getConnectSource(), shadow, connOptions);\n                }\n                shadowConnectors.push(conn);\n                if (targetConn.getLayer() && targetConn.getLayer()._getRenderer()) {\n                    resources.merge(targetConn.getLayer()._getRenderer().resources);\n                }\n\n            }\n        }\n        this._shadowConnectors = shadowConnectors;\n        shadowConnectors.push(shadow);\n        this._dragStageLayer.bringToFront().addGeometry(shadowConnectors);\n    }\n\n    _onTargetUpdated() {\n        if (this._shadow) {\n            this._shadow.setSymbol(this.target._getSymbol());\n        }\n    }\n\n    _prepareDragStageLayer() {\n        const map = this.target.getMap(),\n            layer = this.target.getLayer();\n        this._dragStageLayer = map.getLayer(DRAG_STAGE_LAYER_ID);\n        if (!this._dragStageLayer) {\n            this._dragStageLayer = new VectorLayer(DRAG_STAGE_LAYER_ID, {\n                enableAltitude : layer.options['enableAltitude'],\n                altitudeProperty : layer.options['altitudeProperty']\n            });\n            map.addLayer(this._dragStageLayer);\n        }\n        //copy resources to avoid repeat resource loading.\n        const resources = new ResourceCache();\n        resources.merge(layer._getRenderer().resources);\n        this._dragStageLayer._getRenderer().resources = resources;\n    }\n\n    _startDrag(param) {\n        const map = this.target.getMap();\n        if (!map) {\n            return;\n        }\n        const parent = this.target._getParent();\n        if (parent) {\n            return;\n        }\n        if (this.isDragging()) {\n            return;\n        }\n        const domEvent = param['domEvent'];\n        if (domEvent.touches && domEvent.touches.length > 1 || domEvent.button === 2) {\n            return;\n        }\n        this.container = map._panels.mapWrapper || map._containerDOM;\n        this.target.on('click', this._endDrag, this);\n        this._lastCoord = this._correctCoord(param['coordinate']);\n        this._lastPoint = param['containerPoint'];\n        this._prepareDragHandler();\n        this._dragHandler.onMouseDown(param['domEvent']);\n\n        on(this.container, 'mouseleave', this._endDrag, this);\n        this._startParam = param;\n        this._moved = false;\n\n        return;\n    }\n\n    _dragging(param) {\n        const target = this.target;\n        const map = target.getMap(),\n            e = map._parseEvent(param['domEvent']);\n\n        const domEvent = e['domEvent'];\n        if (domEvent.touches && domEvent.touches.length > 1) {\n            return;\n        }\n\n        if (!this._moved) {\n            this._moved = true;\n            target.on('symbolchange', this._onTargetUpdated, this);\n            this._isDragging = true;\n            this._prepareShadow();\n            if (!target.options['dragShadow']) {\n                target.hide();\n            }\n            this._shadow._fireEvent('dragstart', e);\n            /**\n             * drag start event\n             * @event Geometry#dragstart\n             * @type {Object}\n             * @property {String} type           - dragstart\n             * @property {Geometry} target       - the geometry fires event\n             * @property {Coordinate} coordinate - coordinate of the event\n             * @property {Point} containerPoint  - container point of the event\n             * @property {Point} viewPoint       - view point of the event\n             * @property {Event} domEvent                 - dom event\n             */\n            this.target._fireEvent('dragstart', this._startParam || e);\n            delete this._startParam;\n            return;\n        }\n        if (!this._shadow) {\n            return;\n        }\n        const axis = this._shadow.options['dragOnAxis'],\n            coord = this._correctCoord(e['coordinate']),\n            point = e['containerPoint'];\n        this._lastPoint = this._lastPoint || point;\n        this._lastCoord = this._lastCoord || coord;\n        const pointOffset = point.sub(this._lastPoint);\n        const coordOffset = coord.sub(this._lastCoord);\n        if (axis === 'x') {\n            pointOffset.y = coordOffset.y = 0;\n        } else if (axis === 'y') {\n            pointOffset.x = coordOffset.x = 0;\n        }\n        this._lastPoint = point;\n        this._lastCoord = coord;\n        this._shadow.translate(coordOffset);\n        if (!target.options['dragShadow']) {\n            target.translate(coordOffset);\n        }\n        e['coordOffset'] = coordOffset;\n        e['pointOffset'] = pointOffset;\n        this._shadow._fireEvent('dragging', e);\n\n        /**\n         * dragging event\n         * @event Geometry#dragging\n         * @type {Object}\n         * @property {String} type                    - dragging\n         * @property {Geometry} target       - the geometry fires event\n         * @property {Coordinate} coordinate - coordinate of the event\n         * @property {Point} containerPoint  - container point of the event\n         * @property {Point} viewPoint       - view point of the event\n         * @property {Event} domEvent                 - dom event\n         */\n        target._fireEvent('dragging', e);\n\n    }\n\n    _endDrag(param) {\n        if (this._dragHandler) {\n            this._dragHandler.disable();\n            delete this._dragHandler;\n        }\n        if (this.container) {\n            off(this.container, 'mouseleave', this._endDrag, this);\n        }\n        if (!this.target) {\n            return;\n        }\n        const target = this.target;\n        target.off('click', this._endDrag, this);\n\n        target.off('symbolchange', this._onTargetUpdated, this);\n\n        delete this._lastCoord;\n        delete this._lastPoint;\n\n        this._isDragging = false;\n\n        const map = target.getMap();\n        if (this.enabled() && map) {\n            const e = map._parseEvent(param ? param['domEvent'] : null);\n            this._updateTargetAndRemoveShadow(e);\n            if (this._moved) {\n                /**\n                 * dragend event\n                 * @event Geometry#dragend\n                 * @type {Object}\n                 * @property {String} type                    - dragend\n                 * @property {Geometry} target       - the geometry fires event\n                 * @property {Coordinate} coordinate - coordinate of the event\n                 * @property {Point} containerPoint  - container point of the event\n                 * @property {Point} viewPoint       - view point of the event\n                 * @property {Event} domEvent                 - dom event\n                 */\n                target._fireEvent('dragend', e);\n            }\n        }\n\n\n    }\n\n    isDragging() {\n        if (!this._isDragging) {\n            return false;\n        }\n        return true;\n    }\n\n    _updateTargetAndRemoveShadow(eventParam) {\n        const target = this.target,\n            map = target.getMap();\n        if (!target.options['dragShadow']) {\n            target.show();\n        }\n        const shadow = this._shadow;\n        if (shadow) {\n            if (target.options['dragShadow']) {\n                target.setCoordinates(shadow.getCoordinates());\n            }\n            shadow._fireEvent('dragend', eventParam);\n            shadow.remove();\n            delete this._shadow;\n        }\n        if (this._shadowConnectors) {\n            map.getLayer(DRAG_STAGE_LAYER_ID).removeGeometry(this._shadowConnectors);\n            delete this._shadowConnectors;\n        }\n        if (this._dragStageLayer) {\n            this._dragStageLayer.remove();\n        }\n    }\n\n    //find correct coordinate for coordOffset if geometry has altitude\n    _correctCoord(coord) {\n        const map = this.target.getMap();\n        if (!map.getPitch()) {\n            return coord;\n        }\n        const painter = this.target._getPainter();\n        if (!painter.getMinAltitude()) {\n            return coord;\n        }\n        const alt = (painter.getMinAltitude() + painter.getMaxAltitude()) / 2;\n        return map.locateByPoint(coord, 0, -alt);\n    }\n}\n\nGeometry.mergeOptions({\n    'draggable': false,\n    'dragShadow': true,\n    'dragOnAxis': null\n});\n\nGeometry.addInitHook('addHandler', 'draggable', GeometryDragHandler);\n\nGeometry.include(/** @lends Geometry.prototype */ {\n    /**\n     * Whether the geometry is being dragged.\n     * @reutrn {Boolean}\n     */\n    isDragging() {\n        if (this._getParent()) {\n            return this._getParent().isDragging();\n        }\n        if (this['draggable']) {\n            return this['draggable'].isDragging();\n        }\n        return false;\n    }\n});\n\nexport default GeometryDragHandler;\n","import Geometry from '../Geometry';\nimport GeometryEditor from '../editor/GeometryEditor';\n\nGeometry.include(/** @lends Geometry.prototype */ {\n    /**\n     * Start to edit\n     * @param {Object} [options=null]        - edit options\n     * @param {Object} [options.symbol=null] - symbol for the geometry during editing\n     * @param {Object} [options.fixAspectRatio=false]    - fix outline's aspect ratio when resizing\n     * @param {Object} [options.centerHandleSymbol=null] - symbol of center handle\n     * @param {Object} [options.vertexHandleSymbol=null] - symbol of vertex handle\n     * @param {Object} [options.newVertexHandleSymbol=null] - symbol of new vertex handle\n     * @param {Object} [options.removeVertexOn=contextmenu] - event to remove a vertex from line or polygon, contextmenu by default\n     * @return {Geometry} this\n     */\n    startEdit(opts) {\n        if (!this.getMap() || !this.options['editable']) {\n            return this;\n        }\n        this.endEdit();\n        this._editor = new GeometryEditor(this, opts);\n        this._editor.start();\n        /**\n         * start edit event\n         *\n         * @event Geometry#editstart\n         * @type {Object}\n         * @property {String} type - editstart\n         * @property {Geometry} target - the geometry fires the event\n         */\n        this.fire('editstart');\n        return this;\n    },\n\n    /**\n     * End editing.\n     * @return {Geometry} this\n     */\n    endEdit() {\n        if (this._editor) {\n            this._editor.stop();\n            delete this._editor;\n            /**\n             * end edit event\n             *\n             * @event Geometry#editend\n             * @type {Object}\n             * @property {String} type - editend\n             * @property {Geometry} target - the geometry fires the event\n             */\n            this.fire('editend');\n        }\n        return this;\n    },\n\n    /**\n     * Redo the edit\n     * @return {Geometry} this\n     */\n    redoEdit() {\n        if (!this.isEditing()) {\n            return this;\n        }\n        this._editor.redo();\n        /**\n         * redo edit event\n         *\n         * @event Geometry#redoedit\n         * @type {Object}\n         * @property {String} type - redoedit\n         * @property {Geometry} target - the geometry fires the event\n         */\n        this.fire('redoedit');\n        return this;\n    },\n\n    /**\n     * Undo the edit\n     * @return {Geometry} this\n     */\n    undoEdit() {\n        if (!this.isEditing()) {\n            return this;\n        }\n        this._editor.undo();\n        /**\n         * undo edit event\n         *\n         * @event Geometry#undoedit\n         * @type {Object}\n         * @property {String} type - undoedit\n         * @property {Geometry} target - the geometry fires the event\n         */\n        this.fire('undoedit');\n        return this;\n    },\n\n    /**\n     * Whether the geometry is being edited.\n     * @return {Boolean}\n     */\n    isEditing() {\n        if (this._editor) {\n            return this._editor.isEditing();\n        }\n        return false;\n    }\n});\n","import { preventDefault, stopPropagation, getEventContainerPoint } from '../../core/util/dom';\nimport Geometry from '../Geometry';\n\nGeometry.include(/** @lends Geometry.prototype */ {\n    /**\n     * The event handler for all the events.\n     * @param  {Event} event - dom event\n     * @private\n     */\n    _onEvent: function (event, type) {\n        if (!this.getMap()) {\n            return;\n        }\n        const eventType = type || this._getEventTypeToFire(event);\n        if (eventType === 'contextmenu' && this.listens('contextmenu')) {\n            stopPropagation(event);\n            preventDefault(event);\n        }\n        const params = this._getEventParams(event);\n        this._fireEvent(eventType, params);\n    },\n\n    _getEventTypeToFire: function (domEvent) {\n        // let eventType = domEvent.type;\n        // //change event type to contextmenu\n        // if (eventType === 'click' || eventType === 'mousedown') {\n        //     if (domEvent.button === 2) {\n        //         eventType = 'contextmenu';\n        //     }\n        // }\n        return domEvent.type;\n    },\n\n    /**\n     * Generate event parameters\n     * @param  {Event} event - dom event\n     * @return {Object}\n     * @private\n     */\n    _getEventParams: function (e) {\n        const map = this.getMap();\n        const eventParam = {\n            'domEvent': e\n        };\n        const actual = e.touches && e.touches.length > 0 ? e.touches[0] : e.changedTouches  && e.changedTouches.length > 0 ? e.changedTouches[0] : e;\n        if (actual) {\n            const containerPoint = getEventContainerPoint(actual, map._containerDOM);\n            eventParam['coordinate'] = map.containerPointToCoordinate(containerPoint);\n            eventParam['containerPoint'] = containerPoint;\n            eventParam['viewPoint'] = map.containerPointToViewPoint(containerPoint);\n            eventParam['pont2d'] = map._containerPointToPoint(containerPoint);\n        }\n        return eventParam;\n    }\n});\n","import { extend } from '../../core/util';\nimport Geometry from '../Geometry';\nimport InfoWindow from '../../ui/InfoWindow';\n\nGeometry.include(/** @lends Geometry.prototype */ {\n    /**\n     * Set an InfoWindow to the geometry\n     * @param {Object} options - construct [options]{@link ui.InfoWindow#options} for the InfoWindow\n     * @return {Geometry} this\n     * @example\n     * geometry.setInfoWindow({\n     *     title    : 'This is a title',\n     *     content  : '<div style=\"color:#f00\">This is content of the InfoWindow</div>'\n     * });\n     */\n    setInfoWindow(options) {\n        this.removeInfoWindow();\n        if (options instanceof InfoWindow) {\n            this._infoWindow = options;\n            this._infoWinOptions = extend({}, this._infoWindow.options);\n            this._infoWindow.addTo(this);\n            return this;\n        }\n        this._infoWinOptions = extend({}, options);\n        if (this._infoWindow) {\n            this._infoWindow.setOptions(options);\n        } else if (this.getMap()) {\n            this._bindInfoWindow(this._infoWinOptions);\n        }\n\n        return this;\n    },\n\n    /**\n     * Get the InfoWindow instance.\n     * @return {ui.InfoWindow}\n     */\n    getInfoWindow() {\n        if (!this._infoWindow) {\n            return null;\n        }\n        return this._infoWindow;\n    },\n\n    /**\n     * Open the InfoWindow, default on the center of the geometry.\n     * @param  {Coordinate} [coordinate=null] - coordinate to open the InfoWindow\n     * @return {Geometry} this\n     */\n    openInfoWindow(coordinate) {\n        if (!this.getMap()) {\n            return this;\n        }\n        if (!coordinate) {\n            coordinate = this.getCenter();\n        }\n        if (!this._infoWindow) {\n            if (this._infoWinOptions && this.getMap()) {\n                this._bindInfoWindow(this._infoWinOptions);\n                this._infoWindow.show(coordinate);\n            }\n        } else {\n            this._infoWindow.show(coordinate);\n        }\n        return this;\n    },\n\n    /**\n     * Close the InfoWindow\n     * @return {Geometry} this\n     */\n    closeInfoWindow() {\n        if (this._infoWindow) {\n            this._infoWindow.hide();\n        }\n        return this;\n    },\n\n    /**\n     * Remove the InfoWindow\n     * @return {Geometry} this\n     */\n    removeInfoWindow() {\n        this._unbindInfoWindow();\n        delete this._infoWinOptions;\n        delete this._infoWindow;\n        return this;\n    },\n\n    _bindInfoWindow(options) {\n        this._infoWindow = new InfoWindow(options);\n        this._infoWindow.addTo(this);\n\n        return this;\n    },\n\n    _unbindInfoWindow() {\n        if (this._infoWindow) {\n            this.closeInfoWindow();\n            this._infoWindow.remove();\n            delete this._infoWindow;\n        }\n        return this;\n    }\n});\n","/**\n * from mapbox-gl-js\n * A [least-recently-used cache](http://en.wikipedia.org/wiki/Cache_algorithms)\n * with hash lookup made possible by keeping a list of keys in parallel to\n * an array of dictionary of values\n *\n * @private\n */\nclass LRUCache {\n    /**\n     * @param {number} max number of permitted values\n     * @param {Function} onRemove callback called with items when they expire\n     */\n    constructor(max, onRemove) {\n        this.max = max;\n        this.onRemove = onRemove;\n        this.reset();\n    }\n\n    /**\n     * Clear the cache\n     *\n     * @returns {LRUCache} this cache\n     * @private\n     */\n    reset() {\n        for (const key in this.data) {\n            this.onRemove(this.data[key]);\n        }\n\n        this.data = {};\n        this.order = [];\n\n        return this;\n    }\n\n    clear() {\n        this.reset();\n        delete this.onRemove;\n    }\n\n    /**\n     * Add a key, value combination to the cache, trimming its size if this pushes\n     * it over max length.\n     *\n     * @param {string} key lookup key for the item\n     * @param {*} data any value\n     *\n     * @returns {LRUCache} this cache\n     * @private\n     */\n    add(key, data) {\n\n        if (this.has(key)) {\n            this.order.splice(this.order.indexOf(key), 1);\n            this.data[key] = data;\n            this.order.push(key);\n\n        } else {\n            this.data[key] = data;\n            this.order.push(key);\n\n            if (this.order.length > this.max) {\n                const removedData = this.getAndRemove(this.order[0]);\n                if (removedData) this.onRemove(removedData);\n            }\n        }\n\n        return this;\n    }\n\n    /**\n     * Determine whether the value attached to `key` is present\n     *\n     * @param {String} key the key to be looked-up\n     * @returns {Boolean} whether the cache has this value\n     * @private\n     */\n    has(key) {\n        return key in this.data;\n    }\n\n    /**\n     * List all keys in the cache\n     *\n     * @returns {Array<string>} an array of keys in this cache.\n     * @private\n     */\n    keys() {\n        return this.order;\n    }\n\n    /**\n     * Get the value attached to a specific key and remove data from cache.\n     * If the key is not found, returns `null`\n     *\n     * @param {string} key the key to look up\n     * @returns {*} the data, or null if it isn't found\n     * @private\n     */\n    getAndRemove(key) {\n        if (!this.has(key)) { return null; }\n\n        const data = this.data[key];\n\n        delete this.data[key];\n        this.order.splice(this.order.indexOf(key), 1);\n\n        return data;\n    }\n\n    /**\n     * Get the value attached to a specific key without removing data\n     * from the cache. If the key is not found, returns `null`\n     *\n     * @param {string} key the key to look up\n     * @returns {*} the data, or null if it isn't found\n     * @private\n     */\n    get(key) {\n        if (!this.has(key)) { return null; }\n\n        const data = this.data[key];\n        return data;\n    }\n\n    /**\n     * Remove a key/value combination from the cache.\n     *\n     * @param {string} key the key for the pair to delete\n     * @returns {LRUCache} this cache\n     * @private\n     */\n    remove(key) {\n        if (!this.has(key)) { return this; }\n\n        const data = this.data[key];\n        delete this.data[key];\n        this.onRemove(data);\n        this.order.splice(this.order.indexOf(key), 1);\n\n        return this;\n    }\n\n    /**\n     * Change the max size of the cache.\n     *\n     * @param {number} max the max size of the cache\n     * @returns {LRUCache} this cache\n     * @private\n     */\n    setMaxSize(max) {\n        this.max = max;\n\n        while (this.order.length > this.max) {\n            const removedData = this.getAndRemove(this.order[0]);\n            if (removedData) this.onRemove(removedData);\n        }\n\n        return this;\n    }\n}\n\nexport default LRUCache;\n","import {\n    isNil,\n    loadImage,\n    emptyImageUrl,\n    now,\n    isFunction\n} from '../../../core/util';\nimport Canvas2D from '../../../core/Canvas';\nimport TileLayer from '../../../layer/tile/TileLayer';\nimport CanvasRenderer from '../CanvasRenderer';\nimport Point from '../../../geo/Point';\nimport LruCache from '../../../core/util/LruCache';\nimport Canvas from '../../../core/Canvas';\n\nconst TEMP_POINT = new Point(0, 0);\nconst TEMP_POINT1 = new Point(0, 0);\nconst TEMP_POINT2 = new Point(0, 0);\n\n/**\n * @classdesc\n * Renderer class based on HTML5 Canvas2D for TileLayers\n * @class\n * @protected\n * @memberOf renderer\n * @extends {renderer.CanvasRenderer}\n */\nclass TileLayerCanvasRenderer extends CanvasRenderer {\n\n    /**\n     *\n     * @param {TileLayer} layer - TileLayer to render\n     */\n    constructor(layer) {\n        super(layer);\n        this.tilesInView = {};\n        this.tilesLoading = {};\n        this._parentTiles = [];\n        this._childTiles = [];\n        this.tileCache = new LruCache(layer.options['maxCacheSize'], this.deleteTile.bind(this));\n    }\n\n    getCurrentTileZoom() {\n        return this._tileZoom;\n    }\n\n    draw() {\n        const map = this.getMap();\n        if (!this.isDrawable()) {\n            return;\n        }\n        const mask2DExtent = this.prepareCanvas();\n        if (mask2DExtent) {\n            if (!mask2DExtent.intersects(this.canvasExtent2D)) {\n                this.completeRender();\n                return;\n            }\n        }\n        const layer = this.layer;\n        const tileGrids = layer.getTiles().tileGrids;\n        if (!tileGrids || !tileGrids.length) {\n            this.completeRender();\n            return;\n        }\n\n        let loadingCount = 0;\n        let loading = false;\n        const checkedTiles = {};\n        const tiles = [],\n            parentTiles = [], parentKeys = {},\n            childTiles = [], childKeys = {},\n            placeholders = [], placeholderKeys = {};\n        //visit all the tiles\n        const tileQueue = {};\n        const preLoadingCount = this._markTiles(),\n            loadingLimit = this._getLoadLimit();\n\n        const l = tileGrids.length;\n\n        // main tile grid is the last one (draws on top)\n        this._tileZoom = tileGrids[0]['zoom'];\n        this._tileOffset = tileGrids[0]['offset'];\n\n        for (let i = 0; i < l; i++) {\n            const tileGrid = tileGrids[i];\n            const allTiles = tileGrid['tiles'];\n\n            const placeholder = this._generatePlaceHolder(tileGrid.zoom);\n\n            for (let i = 0, l = allTiles.length; i < l; i++) {\n                const tile = allTiles[i],\n                    tileId = tile['id'];\n                //load tile in cache at first if it has.\n                const cached = this._getCachedTile(tileId);\n                let tileLoading = false;\n                if (this._isLoadingTile(tileId)) {\n                    tileLoading = loading = true;\n                    this.tilesLoading[tileId].current = true;\n                } else if (cached) {\n                    if (this.getTileOpacity(cached.image) < 1) {\n                        tileLoading = loading = true;\n                    }\n                    tiles.push(cached);\n                } else {\n                    tileLoading = loading = true;\n                    const hitLimit = loadingLimit && (loadingCount + preLoadingCount[0]) > loadingLimit;\n                    if (!hitLimit && (!map.isInteracting() || (map.isMoving() || map.isRotating()))) {\n                        loadingCount++;\n                        tileQueue[tileId + '@' + tile['point'].toArray().join()] = tile;\n                    }\n                }\n                if (!tileLoading) continue;\n                if (checkedTiles[tile.dupKey]) {\n                    continue;\n                }\n\n                checkedTiles[tile.dupKey] = 1;\n                if (placeholder && !placeholderKeys[tile.dupKey]) {\n                    //tell gl renderer not to bind gl buffer with image\n                    tile.cache = false;\n                    placeholders.push({\n                        image : placeholder,\n                        info : tile\n                    });\n\n                    placeholderKeys[tile.dupKey] = 1;\n                }\n\n                const parentTile = this._findParentTile(tile);\n                if (parentTile) {\n                    const dupKey = parentTile.info.dupKey;\n                    if (parentKeys[dupKey] === undefined) {\n                        parentKeys[dupKey] = parentTiles.length;\n                        parentTiles.push(parentTile);\n                    }/* else {\n                        //replace with parentTile of above tiles\n                        parentTiles[parentKeys[dupKey]] = parentTile;\n                    } */\n                } else {\n                    const children = this._findChildTiles(tile);\n                    if (children.length) {\n                        children.forEach(c => {\n                            if (!childKeys[c.info.dupKey]) {\n                                childTiles.push(c);\n                                childKeys[c.info.dupKey] = 1;\n                            }\n                        });\n                    }\n                }\n            }\n        }\n\n        this._drawTiles(tiles, parentTiles, childTiles, placeholders);\n        if (!loadingCount) {\n            if (!loading) {\n                //redraw to remove parent tiles if any left in last paint\n                if (!map.isAnimating() && (this._parentTiles.length || this._childTiles.length)) {\n                    this._parentTiles = [];\n                    this._childTiles = [];\n                    this.setToRedraw();\n                }\n                this.completeRender();\n            }\n        } else {\n            this.loadTileQueue(tileQueue);\n        }\n        this._retireTiles();\n    }\n\n    isTileCachedOrLoading(tileId) {\n        return this.tilesLoading[tileId] || this.tilesInView[tileId] || this.tileCache.get(tileId);\n    }\n\n    _drawTiles(tiles, parentTiles, childTiles, placeholders) {\n        if (parentTiles.length) {\n            //closer the latter (to draw on top)\n            parentTiles.sort((t1, t2) => Math.abs(t2.info.z - this._tileZoom) - Math.abs(t1.info.z - this._tileZoom));\n            this._parentTiles = parentTiles;\n        }\n        if (childTiles.length) {\n            this._childTiles = childTiles;\n        }\n\n        const context = { tiles, parentTiles, childTiles };\n        this.onDrawTileStart(context);\n\n        this._parentTiles.forEach(t => this._drawTileAndCache(t));\n        this._childTiles.forEach(t => this._drawTileOffset(t.info, t.image));\n\n        placeholders.forEach(t => this._drawTileOffset(t.info, t.image));\n\n        const layer = this.layer,\n            map = this.getMap();\n        if (!layer.options['cascadeTiles'] || map.getPitch() <= layer.options['minPitchToCascade']) {\n            tiles.forEach(t => this._drawTileAndCache(t));\n        } else {\n            //write current tiles and update stencil buffer to clip parent|child tiles with current tiles\n            this.writeZoomStencil();\n            let started = false;\n            for (let i = 0, l = tiles.length; i < l; i++) {\n                if (tiles[i].info.z !== this._tileZoom) {\n                    if (!started) {\n                        this.startZoomStencilTest();\n                        started = true;\n                    } else {\n                        this.resumeZoomStencilTest();\n                    }\n                } else if (started) {\n                    this.pauseZoomStencilTest();\n                }\n                this._drawTileAndCache(tiles[i]);\n            }\n            this.endZoomStencilTest();\n        }\n\n        this.onDrawTileEnd(context);\n\n    }\n\n    writeZoomStencil() {}\n    startZoomStencilTest() {}\n    endZoomStencilTest() {}\n    pauseZoomStencilTest() {}\n    resumeZoomStencilTest() {}\n\n    onDrawTileStart() {}\n    onDrawTileEnd() {}\n\n    _drawTileOffset(info, image) {\n        const offset = this._tileOffset;\n        if (!offset[0] && !offset[1]) {\n            this.drawTile(info, image);\n            return;\n        }\n        const map = this.getMap();\n        //tempararily add offset to tile info\n        const scale = map._getResolution(this._tileZoom) / map._getResolution(info.z);\n        offset[0] *= scale;\n        offset[1] *= scale;\n        info.point._sub(offset);\n        info.extent2d._sub(offset);\n        this.drawTile(info, image);\n        //restore\n        info.point._add(offset);\n        info.extent2d._add(offset);\n        offset[0] /= scale;\n        offset[1] /= scale;\n    }\n\n    _drawTileAndCache(tile) {\n        tile.current = true;\n        this.tilesInView[tile.info.id] = tile;\n        this._drawTileOffset(tile.info, tile.image);\n        this.tileCache.add(tile.info.id, tile);\n    }\n\n    drawOnInteracting() {\n        this.draw();\n    }\n\n    needToRedraw() {\n        const map = this.getMap();\n        if (map.getPitch()) {\n            return super.needToRedraw();\n        }\n        if (map.isRotating() || map.isZooming()) {\n            return true;\n        }\n        if (map.isMoving()) {\n            return !!this.layer.options['forceRenderOnMoving'];\n        }\n        return super.needToRedraw();\n    }\n\n    hitDetect() {\n        return false;\n    }\n\n    // limit tile number to load when map is interacting\n    _getLoadLimit() {\n        if (this.getMap().isInteracting()) {\n            return this.layer.options['loadingLimitOnInteracting'];\n        }\n        return 0;\n    }\n\n    isDrawable() {\n        if (this.getMap().getPitch()) {\n            if (console) {\n                console.warn('TileLayer with canvas renderer can\\'t be pitched, use gl renderer (\\'renderer\\' : \\'gl\\') instead.');\n            }\n            this.clear();\n            return false;\n        }\n        return true;\n    }\n\n    clear() {\n        this._retireTiles(true);\n        this.tileCache.reset();\n        this.tilesInView = {};\n        this.tilesLoading = {};\n        this._parentTiles = [];\n        this._childTiles = [];\n        super.clear();\n    }\n\n    _isLoadingTile(tileId) {\n        return !!this.tilesLoading[tileId];\n    }\n\n    clipCanvas(context) {\n        const mask = this.layer.getMask();\n        if (!mask) {\n            return this._clipByPitch(context);\n        }\n        return super.clipCanvas(context);\n    }\n\n    // clip canvas to avoid rough edge of tiles\n    _clipByPitch(ctx) {\n        const map = this.getMap();\n        if (map.getPitch() <= map.options['maxVisualPitch']) {\n            return false;\n        }\n        if (!this.layer.options['clipByPitch']) {\n            return false;\n        }\n        const clipExtent = map.getContainerExtent();\n        const r = map.getDevicePixelRatio();\n        ctx.save();\n        ctx.strokeStyle = 'rgba(0, 0, 0, 0)';\n        ctx.beginPath();\n        ctx.rect(0, Math.ceil(clipExtent.ymin) * r, Math.ceil(clipExtent.getWidth()) * r, Math.ceil(clipExtent.getHeight()) * r);\n        ctx.stroke();\n        ctx.clip();\n        return true;\n    }\n\n    loadTileQueue(tileQueue) {\n        for (const p in tileQueue) {\n            if (tileQueue.hasOwnProperty(p)) {\n                const tile = tileQueue[p];\n                const tileImage = this.loadTile(tile);\n                if (tileImage.loadTime === undefined) {\n                    // tile image's loading may not be async\n                    this.tilesLoading[tile['id']] = {\n                        image : tileImage,\n                        current : true,\n                        info : tile\n                    };\n                }\n            }\n        }\n    }\n\n    loadTile(tile) {\n        const tileSize = this.layer.getTileSize();\n        const tileImage = new Image();\n\n        tileImage.width = tileSize['width'];\n        tileImage.height = tileSize['height'];\n\n        tileImage.onload = this.onTileLoad.bind(this, tileImage, tile);\n        tileImage.onerror = this.onTileError.bind(this, tileImage, tile);\n\n        this.loadTileImage(tileImage, tile['url']);\n        return tileImage;\n    }\n\n    loadTileImage(tileImage, url) {\n        const crossOrigin = this.layer.options['crossOrigin'];\n        if (!isNil(crossOrigin)) {\n            tileImage.crossOrigin = crossOrigin;\n        }\n        return loadImage(tileImage, [url]);\n    }\n\n    abortTileLoading(tileImage) {\n        if (!tileImage) return;\n        tileImage.onload = falseFn;\n        tileImage.onerror = falseFn;\n        tileImage.src = emptyImageUrl;\n    }\n\n    onTileLoad(tileImage, tileInfo) {\n        if (!this.layer) {\n            return;\n        }\n        const id = tileInfo['id'];\n        if (!this.tilesInView) {\n            // removed\n            return;\n        }\n        tileImage.loadTime = now();\n        delete this.tilesLoading[id];\n        this._addTileToCache(tileInfo, tileImage);\n        this.setToRedraw();\n        /**\n         * tileload event, fired when tile is loaded.\n         *\n         * @event TileLayer#tileload\n         * @type {Object}\n         * @property {String} type - tileload\n         * @property {TileLayer} target - tile layer\n         * @property {Object} tileInfo - tile info\n         * @property {Image} tileImage - tile image\n         */\n        this.layer.fire('tileload', { tile : tileInfo, tileImage: tileImage });\n    }\n\n    onTileError(tileImage, tileInfo) {\n        if (!this.layer) {\n            return;\n        }\n        tileImage.onerrorTick = tileImage.onerrorTick || 0;\n        const tileRetryCount = this.layer.options['tileRetryCount'];\n        if (tileRetryCount > tileImage.onerrorTick) {\n            tileImage.onerrorTick++;\n            tileImage.src = tileInfo.url;\n            return;\n        }\n        if (tileImage instanceof Image) {\n            this.abortTileLoading(tileImage, tileInfo);\n        }\n        tileImage.loadTime = 0;\n        delete this.tilesLoading[tileInfo['id']];\n        this._addTileToCache(tileInfo, tileImage);\n        this.setToRedraw();\n        /**\n         * tileerror event, fired when tile loading has error.\n         *\n         * @event TileLayer#tileerror\n         * @type {Object}\n         * @property {String} type - tileerror\n         * @property {TileLayer} target - tile layer\n         * @property {Object} tileInfo - tile info\n         */\n        this.layer.fire('tileerror', { tile : tileInfo });\n    }\n\n    drawTile(tileInfo, tileImage) {\n        if (!tileImage || !this.getMap()) {\n            return;\n        }\n        const point = tileInfo.point,\n            tileZoom = tileInfo.z,\n            tileId = tileInfo.id;\n        const map = this.getMap(),\n            tileSize = tileInfo.size,\n            zoom = map.getZoom(),\n            ctx = this.context,\n            cp = map._pointToContainerPoint(point, tileZoom, 0, TEMP_POINT),\n            bearing = map.getBearing(),\n            transformed = bearing || zoom !== tileZoom;\n        const opacity = this.getTileOpacity(tileImage);\n        const alpha = ctx.globalAlpha;\n        if (opacity < 1) {\n            ctx.globalAlpha = opacity;\n            this.setToRedraw();\n        }\n        if (!transformed) {\n            cp._round();\n        }\n        let x = cp.x,\n            y = cp.y;\n        let w = tileSize[0], h = tileSize[1];\n        if (transformed) {\n            w += 0.5;\n            h += 0.5;\n            ctx.save();\n            ctx.translate(x, y);\n            if (bearing) {\n                ctx.rotate(-bearing * Math.PI / 180);\n            }\n            if (zoom !== tileZoom) {\n                const scale = map._getResolution(tileZoom) / map._getResolution();\n                ctx.scale(scale, scale);\n            }\n            x = y = 0;\n        }\n        Canvas2D.image(ctx, tileImage, x, y, w, h);\n        if (this.layer.options['debug']) {\n            const color = this.layer.options['debugOutline'],\n                xyz = tileId.split('-');\n            ctx.save();\n            ctx.strokeStyle = color;\n            ctx.fillStyle = color;\n            ctx.strokeWidth = 10;\n            ctx.font = '15px monospace';\n            Canvas2D.rectangle(ctx, x, y, { width: w, height: h }, 1, 0);\n            Canvas2D.fillText(ctx, 'x:' + xyz[2] + ', y:' + xyz[1] + ', z:' + xyz[3], x + 10, y + 20, color);\n            Canvas2D.drawCross(ctx, x + w / 2, y + h / 2, 2, color);\n            ctx.restore();\n        }\n        if (transformed) {\n            ctx.restore();\n        }\n        if (ctx.globalAlpha !== alpha) {\n            ctx.globalAlpha = alpha;\n        }\n        this.setCanvasUpdated();\n    }\n\n    _findChildTiles(info) {\n        const layer = this._getLayerOfTile(info.layer);\n        if (!layer.options['background']) {\n            return [];\n        }\n        const map = this.getMap();\n        const children = [];\n        const min = info.extent2d.getMin(),\n            max = info.extent2d.getMax(),\n            pmin = layer._project(map._pointToPrj(min, info.z, TEMP_POINT1), TEMP_POINT1),\n            pmax = layer._project(map._pointToPrj(max, info.z, TEMP_POINT2), TEMP_POINT2);\n        const zoomDiff = 2;\n        for (let i = 1; i < zoomDiff; i++) {\n            this._findChildTilesAt(children, pmin, pmax, layer, info.z + i);\n        }\n\n        return children;\n    }\n\n    _findChildTilesAt(children, pmin, pmax, layer, childZoom) {\n        const zoomOffset = layer.options['zoomOffset'];\n        const layerId = layer.getId(),\n            res = layer.getSpatialReference().getResolution(childZoom + zoomOffset);\n        if (!res) {\n            return;\n        }\n        const dmin = layer._getTileConfig().getTileIndex(pmin, res),\n            dmax = layer._getTileConfig().getTileIndex(pmax, res);\n        const sx = Math.min(dmin.idx, dmax.idx), ex = Math.max(dmin.idx, dmax.idx);\n        const sy = Math.min(dmin.idy, dmax.idy), ey = Math.max(dmin.idy, dmax.idy);\n        let id, tile;\n        for (let i = sx; i < ex; i++) {\n            for (let ii = sy; ii < ey; ii++) {\n                id = layer._getTileId({ idx : i, idy : ii }, childZoom + zoomOffset, layerId);\n                if (this.tileCache.has(id)) {\n                    tile = this.tileCache.getAndRemove(id);\n                    children.push(tile);\n                    this.tileCache.add(id, tile);\n                }\n            }\n        }\n    }\n\n    _findParentTile(info) {\n        const map = this.getMap(),\n            layer = this._getLayerOfTile(info.layer);\n        if (!layer.options['background']) {\n            return null;\n        }\n        const sr = layer.getSpatialReference();\n        const d = sr.getZoomDirection(),\n            zoomOffset = layer.options['zoomOffset'],\n            zoomDiff = layer.options['backgroundZoomDiff'];\n        const center = info.extent2d.getCenter(),\n            prj = layer._project(map._pointToPrj(center, info.z));\n        for (let diff = 1; diff <= zoomDiff; diff++) {\n            const z = info.z - d * diff;\n            const res = sr.getResolution(z + zoomOffset);\n            if (!res) continue;\n            const tileIndex = layer._getTileConfig().getTileIndex(prj, res);\n            const id = layer._getTileId(tileIndex, z + zoomOffset, info.layer);\n            if (this.tileCache.has(id)) {\n                const tile = this.tileCache.getAndRemove(id);\n                this.tileCache.add(id, tile);\n                return tile;\n            }\n        }\n        return null;\n    }\n\n    _getLayerOfTile(layerId) {\n        return this.layer.getChildLayer ? this.layer.getChildLayer(layerId) : this.layer;\n    }\n\n    _getCachedTile(tileId) {\n        const tilesInView = this.tilesInView;\n        let cached = this.tileCache.getAndRemove(tileId);\n        if (cached) {\n            tilesInView[tileId] = cached;\n            const tilesLoading = this.tilesLoading;\n            if (tilesLoading && tilesLoading[tileId]) {\n                tilesLoading[tileId].current = false;\n                const { image, info } = tilesLoading[tileId];\n                this.abortTileLoading(image, info);\n                delete tilesLoading[tileId];\n            }\n        } else {\n            cached = tilesInView[tileId];\n        }\n        return cached;\n    }\n\n    _addTileToCache(tileInfo, tileImage) {\n        this.tilesInView[tileInfo.id] = {\n            image : tileImage,\n            current : true,\n            info : tileInfo\n        };\n    }\n\n    getTileOpacity(tileImage) {\n        if (!this.layer.options['fadeAnimation'] || !tileImage.loadTime) {\n            return 1;\n        }\n        return Math.min(1, (now() - tileImage.loadTime) / (1000 / 60 * 10));\n    }\n\n    onRemove() {\n        this.clear();\n        delete this.tileCache;\n        delete this._tilePlaceHolder;\n        super.onRemove();\n    }\n\n\n    _markTiles() {\n        let a = 0, b = 0;\n        if (this.tilesLoading) {\n            for (const p in this.tilesLoading) {\n                this.tilesLoading[p].current = false;\n                a++;\n            }\n        }\n        if (this.tilesInView) {\n            for (const p in this.tilesInView) {\n                this.tilesInView[p].current = false;\n                b++;\n            }\n        }\n        return [a, b];\n    }\n\n    _retireTiles(force) {\n        for (const i in this.tilesLoading) {\n            const tile = this.tilesLoading[i];\n            if (force || !tile.current) {\n                // abort loading tiles\n                if (tile.image) {\n                    this.abortTileLoading(tile.image, tile.info);\n                }\n                this.deleteTile(tile);\n                delete this.tilesLoading[i];\n            }\n        }\n        for (const i in this.tilesInView) {\n            const tile = this.tilesInView[i];\n            if (!tile.current) {\n                delete this.tilesInView[i];\n                if (!this.tileCache.has(i)) {\n                    this.deleteTile(tile);\n                }\n            }\n        }\n    }\n\n    deleteTile(tile) {\n        if (!tile || !tile.image) {\n            return;\n        }\n        tile.image.onload = null;\n        tile.image.onerror = null;\n    }\n\n    _generatePlaceHolder(z) {\n        const map = this.getMap();\n        const placeholder = this.layer.options['placeholder'];\n        if (!placeholder || map.getPitch()) {\n            return null;\n        }\n        const tileSize = this.layer.getTileSize(),\n            scale = map._getResolution(z) / map._getResolution(),\n            canvas = this._tilePlaceHolder = this._tilePlaceHolder || Canvas.createCanvas(1, 1);\n        canvas.width = tileSize.width * scale;\n        canvas.height = tileSize.height * scale;\n        if (isFunction(placeholder)) {\n            placeholder(canvas);\n        } else {\n            defaultPlaceholder(canvas);\n        }\n        return canvas;\n    }\n}\n\nTileLayer.registerRenderer('canvas', TileLayerCanvasRenderer);\n\nfunction falseFn() { return false; }\n\nfunction defaultPlaceholder(canvas) {\n    const ctx = canvas.getContext('2d'),\n        cw = canvas.width, ch = canvas.height,\n        w = cw / 16, h = ch / 16;\n    ctx.beginPath();\n    for (let i = 0; i < 16; i++) {\n        ctx.moveTo(0, i * h);\n        ctx.lineTo(cw, i * h);\n        ctx.moveTo(i * w, 0);\n        ctx.lineTo(i * w, ch);\n    }\n    ctx.strokeStyle = 'rgba(180, 180, 180, 0.1)';\n    ctx.lineWidth = 1;\n    ctx.stroke();\n    ctx.beginPath();\n    const path = [\n        [0, 0], [cw, 0], [0, ch], [cw, ch], [0, 0], [0, ch], [cw, 0], [cw, ch], [0, ch / 2], [cw, ch / 2], [cw / 2, 0], [cw / 2, ch]\n    ];\n    for (let i = 1; i < path.length; i += 2) {\n        ctx.moveTo(path[i - 1][0], path[i - 1][1]);\n        ctx.lineTo(path[i][0], path[i][1]);\n    }\n    ctx.lineWidth = 1 * 4;\n    ctx.stroke();\n}\n\nexport default TileLayerCanvasRenderer;\n","import TileLayer from '../../../layer/tile/TileLayer';\nimport TileLayerCanvasRenderer from './TileLayerCanvasRenderer';\nimport ImageGLRenderable from '../ImageGLRenderable';\n\n/**\n * @classdesc\n * Renderer class based on HTML5 WebGL for TileLayers\n * @class\n * @protected\n * @memberOf renderer\n * @extends {renderer.TileLayerCanvasRenderer}\n * @param {TileLayer} layer - TileLayer to render\n */\nclass TileLayerGLRenderer extends ImageGLRenderable(TileLayerCanvasRenderer) {\n\n    //override to set to always drawable\n    isDrawable() {\n        return true;\n    }\n\n    needToRedraw() {\n        const map = this.getMap();\n        if (this._gl() && !map.getPitch() && map.isZooming() && !map.isMoving() && !map.isRotating()) {\n            return true;\n        }\n        return super.needToRedraw();\n    }\n\n    drawTile(tileInfo, tileImage) {\n        const map = this.getMap();\n        if (!tileInfo || !map || !tileImage) {\n            return;\n        }\n\n        const scale = tileInfo._glScale = tileInfo._glScale || map.getGLScale(tileInfo.z),\n            w = tileInfo.size[0] * scale,\n            h = tileInfo.size[1] * scale;\n        if (tileInfo.cache !== false) {\n            this._bindGLBuffer(tileImage, w, h);\n        }\n        if (!this._gl()) {\n            // fall back to canvas 2D, which is faster\n            super.drawTile(tileInfo, tileImage);\n            return;\n        }\n        const point = tileInfo.point;\n        const x = point.x * scale,\n            y = point.y * scale;\n        const opacity = this.getTileOpacity(tileImage);\n        this.drawGLImage(tileImage, x, y, w, h, opacity);\n\n        if (opacity < 1) {\n            this.setToRedraw();\n        } else {\n            this.setCanvasUpdated();\n        }\n    }\n\n    writeZoomStencil() {\n        const gl = this.gl;\n        gl.stencilFunc(gl.ALWAYS, 1, 0xFF);\n        gl.stencilOp(gl.KEEP, gl.KEEP, gl.REPLACE);\n    }\n\n    startZoomStencilTest() {\n        const gl = this.gl;\n        gl.stencilOp(gl.KEEP, gl.KEEP, gl.KEEP);\n        gl.stencilFunc(gl.EQUAL, 0, 0xFF);\n    }\n\n    endZoomStencilTest() {\n        this.pauseZoomStencilTest();\n    }\n\n    pauseZoomStencilTest() {\n        const gl = this.gl;\n        gl.stencilFunc(gl.ALWAYS, 1, 0xFF);\n    }\n\n    resumeZoomStencilTest() {\n        const gl = this.gl;\n        gl.stencilFunc(gl.EQUAL, 0, 0xFF);\n    }\n\n    _bindGLBuffer(image, w, h) {\n        if (!image.glBuffer) {\n            image.glBuffer = this.bufferTileData(0, 0, w, h);\n        }\n    }\n\n    loadTileImage(tileImage, url) {\n        //image must set cors in webgl\n        const crossOrigin = this.layer.options['crossOrigin'];\n        tileImage.crossOrigin = crossOrigin !== null ? crossOrigin : '';\n        tileImage.src = url;\n        return;\n    }\n\n    // prepare gl, create program, create buffers and fill unchanged data: image samplers, texture coordinates\n    onCanvasCreate() {\n        //not in a GroupGLLayer\n        if (!this.canvas.gl || !this.canvas.gl.wrap) {\n            this.createCanvas2();\n        }\n    }\n\n    createContext() {\n        super.createContext();\n        this.createGLContext();\n    }\n\n    resizeCanvas(canvasSize) {\n        if (!this.canvas) {\n            return;\n        }\n        super.resizeCanvas(canvasSize);\n        this.resizeGLCanvas();\n    }\n\n    clearCanvas() {\n        if (!this.canvas) {\n            return;\n        }\n        super.clearCanvas();\n        this.clearGLCanvas();\n    }\n\n    getCanvasImage() {\n        if (!this._gl() || !this.canvas2) {\n            return super.getCanvasImage();\n        }\n        const img = super.getCanvasImage();\n        if (img) {\n            img.image = this.canvas2;\n        }\n        return img;\n    }\n\n    // decide whether the layer is renderer with gl.\n    // when map is pitching, or fragmentShader is set in options\n    _gl() {\n        if (this.canvas.gl && this.canvas.gl.wrap) {\n            //in GroupGLLayer\n            return true;\n        }\n        const map = this.getMap();\n        return map && (map.getPitch() || map.getBearing()) || this.layer && !!this.layer.options['fragmentShader'];\n    }\n\n    deleteTile(tile) {\n        super.deleteTile(tile);\n        if (tile && tile.image) {\n            this.disposeImage(tile.image);\n        }\n    }\n\n    onRemove() {\n        super.onRemove();\n        this.removeGLCanvas();\n    }\n}\n\nTileLayer.registerRenderer('gl', TileLayerGLRenderer);\n\nexport default TileLayerGLRenderer;\n\n\n","import CanvasTileLayer from '../../../layer/tile/CanvasTileLayer';\nimport Canvas2D from '../../../core/Canvas';\nimport TileLayerCanvasRenderer from './TileLayerCanvasRenderer';\nimport TileLayerGLRenderer from './TileLayerGLRenderer';\nimport Extent from '../../../geo/Extent';\n\nfunction loadTile(tile) {\n    const tileSize = this.layer.getTileSize(),\n        canvasClass = this.canvas.constructor,\n        map = this.getMap();\n    const r = map.getDevicePixelRatio();\n    const tileCanvas = Canvas2D.createCanvas(tileSize['width'] * r, tileSize['height'] * r, canvasClass);\n    tileCanvas['layer'] = this.layer;\n    const me = this;\n    const extent = new Extent(map.pointToCoordinate(tile['point']), map.pointToCoordinate(tile['point'].add(tileSize.toPoint())), map.getProjection());\n    this.layer.drawTile(tileCanvas, {\n        'url': tile['url'],\n        'point': tile['point'],\n        'center' : map.pointToCoordinate(tile['point'].add(tileSize['width'] / 2, tileSize['height'] / 2)),\n        'extent' : extent,\n        'z': tile['z'],\n        'x' : tile['x'],\n        'y' : tile['y']\n    }, error => {\n        if (error) {\n            me.onTileError(tileCanvas, tile);\n            return;\n        }\n        me.onTileLoad(tileCanvas, tile);\n    });\n    return tileCanvas;\n}\n\nclass CanvasRenderer extends TileLayerCanvasRenderer {\n    loadTile() {\n        return loadTile.apply(this, arguments);\n    }\n}\n\nclass GLRenderer extends TileLayerGLRenderer {\n    loadTile() {\n        return loadTile.apply(this, arguments);\n    }\n}\n\nCanvasTileLayer.registerRenderer('canvas', CanvasRenderer);\nCanvasTileLayer.registerRenderer('gl', GLRenderer);\n\nexport {\n    CanvasRenderer as CanvasTileLayerCanvasRenderer,\n    GLRenderer as CanvasTileLayerGLRenderer\n};\n","import { isArrayHasData, pushIn } from '../../../core/util';\nimport CanvasRenderer from '../CanvasRenderer';\n\n/**\n * @classdesc\n * A parent renderer class for OverlayLayer to inherit by OverlayLayer's subclasses.\n * @protected\n * @memberOf renderer\n * @name OverlayLayerCanvasRenderer\n * @extends renderer.CanvasRenderer\n */\nclass OverlayLayerRenderer extends CanvasRenderer {\n\n    // possible memory leaks:\n    // 1. if geometries' symbols with external resources change frequently,\n    // resources of old symbols will still be stored.\n    // 2. removed geometries' resources won't be removed.\n    checkResources() {\n        let geometries = this._geosToCheck;\n        if (!this._resourceChecked && !geometries) {\n            geometries = this.layer._geoList;\n        }\n        if (!isArrayHasData(geometries)) {\n            return [];\n        }\n        const resources = [];\n        const cache = {};\n\n        for (let i = geometries.length - 1; i >= 0; i--) {\n            const geo = geometries[i];\n            const res = geo._getExternalResources();\n            if (!res.length) {\n                continue;\n            }\n            if (!this.resources) {\n                resources.push.apply(resources, res);\n            } else {\n                for (let i = 0; i < res.length; i++) {\n                    const url = res[i][0];\n                    if (!this.resources.isResourceLoaded(res[i]) && !cache[url]) {\n                        resources.push(res[i]);\n                        cache[url] = 1;\n                    }\n                }\n            }\n        }\n        this._resourceChecked = true;\n        delete this._geosToCheck;\n        return resources;\n    }\n\n    render() {\n        this.layer._sortGeometries();\n        return super.render.apply(this, arguments);\n    }\n\n    _addGeoToCheckRes(res) {\n        if (!res) {\n            return;\n        }\n        if (!Array.isArray(res)) {\n            res = [res];\n        }\n        if (!this._geosToCheck) {\n            this._geosToCheck = [];\n        }\n        pushIn(this._geosToCheck, res);\n    }\n\n    onGeometryAdd(geometries) {\n        this._addGeoToCheckRes(geometries);\n        redraw(this);\n    }\n\n    onGeometryRemove() {\n        redraw(this);\n    }\n\n    onGeometrySymbolChange(e) {\n        this._addGeoToCheckRes(e.target);\n        redraw(this);\n    }\n\n    onGeometryShapeChange() {\n        redraw(this);\n    }\n\n    onGeometryPositionChange() {\n        redraw(this);\n    }\n\n    onGeometryZIndexChange() {\n        redraw(this);\n    }\n\n    onGeometryShow() {\n        redraw(this);\n    }\n\n    onGeometryHide() {\n        redraw(this);\n    }\n\n    onGeometryPropertiesChange() {\n        redraw(this);\n    }\n}\n\nfunction redraw(renderer) {\n    if (renderer.layer.options['drawImmediate']) {\n        renderer.render();\n    }\n    renderer.setToRedraw();\n}\n\nexport default OverlayLayerRenderer;\n","import { getExternalResources } from '../../../core/util/resource';\nimport VectorLayer from '../../../layer/VectorLayer';\nimport OverlayLayerCanvasRenderer from './OverlayLayerCanvasRenderer';\nimport PointExtent from '../../../geo/PointExtent';\n\nconst TEMP_EXTENT = new PointExtent();\n\n/**\n * @classdesc\n * Renderer class based on HTML5 Canvas2D for VectorLayers\n * @protected\n * @memberOf renderer\n * @name VectorLayerCanvasRenderer\n * @extends renderer.OverlaylayerCanvasRenderer\n * @param {VectorLayer} layer - layer to render\n */\nclass VectorLayerRenderer extends OverlayLayerCanvasRenderer {\n\n    checkResources() {\n        const resources = super.checkResources.apply(this, arguments);\n        let style = this.layer.getStyle();\n        if (style) {\n            if (!Array.isArray(style)) {\n                style = [style];\n            }\n            style.forEach(s => {\n                const res = getExternalResources(s['symbol'], true);\n                for (let i = 0, l = res.length; i < l; i++) {\n                    if (!this.resources.isResourceLoaded(res[i])) {\n                        resources.push(res[i]);\n                    }\n                }\n            });\n        }\n        return resources;\n    }\n\n    needToRedraw() {\n        const map = this.getMap();\n        if (map.isInteracting() && this.layer.options['enableAltitude']) {\n            return true;\n        }\n        // don't redraw when map is zooming without pitch and layer doesn't have any point symbolizer.\n        if (map.isZooming() && !map.isRotating() && !map.getPitch() && !this._hasPoint && this.layer.constructor === VectorLayer) {\n            return false;\n        }\n        return super.needToRedraw();\n    }\n\n    /**\n     * render layer\n     * @param  {Geometry[]} geometries   geometries to render\n     * @param  {Boolean} ignorePromise   whether escape step of promise\n     */\n    draw() {\n        if (!this.getMap()) {\n            return;\n        }\n        if (!this.layer.isVisible() || this.layer.isEmpty()) {\n            this.clearCanvas();\n            this.completeRender();\n            return;\n        }\n\n        this.prepareCanvas();\n\n        this.drawGeos();\n\n        this.completeRender();\n    }\n\n    isBlank() {\n        if (!this.context) {\n            return false;\n        }\n        return !this.context.canvas._drawn;\n    }\n\n    drawOnInteracting() {\n        if (!this._geosToDraw) {\n            return;\n        }\n        this._updateDisplayExtent();\n        for (let i = 0, l = this._geosToDraw.length; i < l; i++) {\n            if (!this._geosToDraw[i].isVisible()) {\n                continue;\n            }\n            this._geosToDraw[i]._paint(this._displayExtent);\n        }\n    }\n\n    /**\n     * Show and render\n     * @override\n     */\n    show() {\n        this.layer.forEach(function (geo) {\n            geo._repaint();\n        });\n        super.show.apply(this, arguments);\n    }\n\n    forEachGeo(fn, context) {\n        this.layer.forEach(fn, context);\n    }\n\n    drawGeos() {\n        this._updateDisplayExtent();\n        this.prepareToDraw();\n\n        this.forEachGeo(this.checkGeo, this);\n        for (let i = 0, len = this._geosToDraw.length; i < len; i++) {\n            this._geosToDraw[i]._paint();\n        }\n    }\n\n    prepareToDraw() {\n        this._hasPoint = false;\n        this._geosToDraw = [];\n    }\n\n    checkGeo(geo) {\n        if (!geo || !geo.isVisible() || !geo.getMap() ||\n            !geo.getLayer() || (!geo.getLayer().isCanvasRender())) {\n            return;\n        }\n\n        const painter = geo._getPainter();\n        const extent2D = painter.get2DExtent(this.resources, TEMP_EXTENT);\n        if (!extent2D || !extent2D.intersects(this._displayExtent)) {\n            return;\n        }\n        if (painter.hasPoint()) {\n            this._hasPoint = true;\n        }\n        this._geosToDraw.push(geo);\n    }\n\n    onZoomEnd() {\n        delete this.canvasExtent2D;\n        super.onZoomEnd.apply(this, arguments);\n    }\n\n    onRemove() {\n        this.forEachGeo(function (g) {\n            g.onHide();\n        });\n        delete this._geosToDraw;\n    }\n\n    onGeometryPropertiesChange(param) {\n        if (param) {\n            this.layer._styleGeometry(param['target']);\n        }\n        super.onGeometryPropertiesChange(param);\n    }\n\n    _updateDisplayExtent() {\n        let extent2D = this.canvasExtent2D;\n        if (this._maskExtent) {\n            if (!this._maskExtent.intersects(extent2D)) {\n                this.completeRender();\n                return;\n            }\n            extent2D = extent2D.intersection(this._maskExtent);\n        }\n        this._displayExtent = extent2D;\n    }\n\n    identify(coordinate, options = {}) {\n        const geometries = this._geosToDraw;\n        if (!geometries) {\n            return [];\n        }\n        return this.layer._hitGeos(geometries, coordinate, options);\n    }\n}\n\nVectorLayer.registerRenderer('canvas', VectorLayerRenderer);\n\nexport default VectorLayerRenderer;\n","import { offsetDom } from '../../core/util/dom';\nimport Class from '../../core/Class';\nimport Point from '../../geo/Point';\n\n/**\n * @classdesc\n * Base class for all the map renderers.\n * @class\n * @abstract\n * @protected\n * @memberOf renderer\n * @extends {Class}\n */\nclass MapRenderer extends Class {\n\n    constructor(map) {\n        super();\n        this.map = map;\n        this._handlerQueue = {};\n    }\n\n    callInNextFrame(fn) {\n        this._handlerQueue.push(fn);\n    }\n\n    executeFrameCallbacks() {\n        const running = this._handlerQueue;\n        this._handlerQueue = [];\n        for (let i = 0, l = running.length; i < l; i++) {\n            running[i]();\n        }\n    }\n\n    /**\n     * Move map platform with offset\n     * @param  {Point} offset\n     * @return {this}\n     */\n    offsetPlatform(offset) {\n        if (!this.map._panels.front) {\n            return this;\n        }\n        if (offset.x === 0 && offset.y === 0) {\n            return this;\n        }\n        const pos = this.map.offsetPlatform().add(offset)._round();\n        const panels = this.map._panels;\n        offsetDom(panels.back, pos);\n        offsetDom(panels.front, pos);\n        return this;\n    }\n\n    resetContainer() {\n        if (!this.map) {\n            return;\n        }\n        this.map._resetMapViewPoint();\n        if (this.map._panels.front) {\n            const pos = new Point(0, 0);\n            offsetDom(this.map._panels.back, pos);\n            offsetDom(this.map._panels.front, pos);\n        }\n    }\n\n    onZoomEnd() {\n        this.resetContainer();\n    }\n\n    onLoad() {\n        this._frameLoop();\n    }\n}\n\nexport default MapRenderer;\n","import { IS_NODE, isNumber, isFunction, requestAnimFrame, cancelAnimFrame, equalMapView } from '../../core/util';\nimport { createEl, preventSelection, computeDomPosition, addDomEvent, removeDomEvent } from '../../core/util/dom';\nimport Browser from '../../core/Browser';\nimport Point from '../../geo/Point';\nimport Canvas2D from '../../core/Canvas';\nimport MapRenderer from './MapRenderer';\nimport Map from '../../map/Map';\n\n/**\n * @classdesc\n * Renderer class based on HTML5 Canvas for maps.\n * @class\n * @protected\n * @extends {renderer.MapRenderer}\n * @memberOf renderer\n */\nclass MapCanvasRenderer extends MapRenderer {\n    /**\n     * @param {Map} map - map for the renderer\n     */\n    constructor(map) {\n        super(map);\n        //container is a <canvas> element\n        this._containerIsCanvas = !!map._containerDOM.getContext;\n        this._registerEvents();\n        this._loopTime = 0;\n    }\n\n    load() {\n        this.initContainer();\n    }\n\n    /**\n     * render layers in current frame\n     * @return {Boolean} return false to cease frame loop\n     */\n    renderFrame(framestamp) {\n        if (!this.map) {\n            return false;\n        }\n        const map = this.map;\n        map._fireEvent('framestart');\n        this.updateMapDOM();\n        const layers = this._getAllLayerToRender();\n        this.drawLayers(layers, framestamp);\n        this.drawLayerCanvas(layers);\n        // CAUTION: the order to fire frameend and layerload events\n        // fire frameend before layerload, reason:\n        // 1. frameend is often used internally by maptalks and plugins\n        // 2. layerload is often used externally by tests or user apps\n        map._fireEvent('frameend');\n        this._recordView();\n        // refresh map's state\n        // It must be before events and frame callback, because map state may be changed in callbacks.\n        this._mapview = this._getMapView();\n        delete this._spatialRefChanged;\n        this._fireLayerLoadEvents();\n        this.executeFrameCallbacks();\n        this._canvasUpdated = false;\n        return true;\n    }\n\n    updateMapDOM() {\n        const map = this.map;\n        // when map is zooming, container is being transformed with matrix, panel doesn't need to be moved.\n        if (map.isZooming()) {\n            return;\n        }\n        const offset = map._getViewPointFrameOffset();\n        if (offset) {\n            map.offsetPlatform(offset);\n        }\n    }\n\n    drawLayers(layers, framestamp) {\n        const map = this.map,\n            isInteracting = map.isInteracting(),\n            // all the visible canvas layers' ids.\n            canvasIds = [],\n            // all the updated canvas layers's ids.\n            updatedIds = [],\n            fps = map.options['fpsOnInteracting'] || 0,\n            timeLimit = fps === 0 ? 0 : 1000 / fps,\n            // time of layer drawing\n            layerLimit = this.map.options['layerCanvasLimitOnInteracting'],\n            l = layers.length;\n        const baseLayer = map.getBaseLayer();\n        let t = 0;\n        for (let i = 0; i < l; i++) {\n            const layer = layers[i];\n            if (!layer.isVisible()) {\n                continue;\n            }\n            const isCanvas = layer.isCanvasRender();\n            if (isCanvas) {\n                canvasIds.push(layer.getId());\n            }\n            const renderer = layer._getRenderer();\n            if (!renderer) {\n                continue;\n            }\n            // if need to call layer's draw/drawInteracting\n            const needsRedraw = this._checkLayerRedraw(layer);\n            if (isCanvas && renderer.isCanvasUpdated()) {\n                // don't need to call layer's draw/drawOnInteracting but need to redraw layer's updated canvas\n                if (!needsRedraw) {\n                    updatedIds.push(layer.getId());\n                }\n                this.setLayerCanvasUpdated();\n            }\n            const transformMatrix = renderer.__zoomTransformMatrix;\n            delete renderer.__zoomTransformMatrix;\n            if (!needsRedraw) {\n                if (isCanvas && isInteracting) {\n                    if (map.isZooming() && !map.getPitch()) {\n                        // transform layer's current canvas when zooming\n                        renderer.prepareRender();\n                        renderer.__zoomTransformMatrix = this._zoomMatrix;\n                    } else if (map.getPitch() || map.isRotating()) {\n                        // when map is pitching or rotating, clear the layer canvas\n                        // otherwise, leave layer's canvas unchanged\n                        renderer.clearCanvas();\n                    }\n                }\n                continue;\n            }\n\n            if (isInteracting && isCanvas) {\n                if (layerLimit > 0 && l - 1 - i > layerLimit && layer !== baseLayer) {\n                    layer._getRenderer().clearCanvas();\n                    continue;\n                }\n                t += this._drawCanvasLayerOnInteracting(layer, t, timeLimit, framestamp);\n            } else if (isInteracting && renderer.drawOnInteracting) {\n                // dom layers\n                if (renderer.prepareRender) {\n                    renderer.prepareRender();\n                }\n                renderer.drawOnInteracting(this._eventParam, framestamp);\n            } else {\n                // map is not interacting, call layer's render\n                renderer.render(framestamp);\n                //地图缩放完以后，如果下一次render需要载入资源，仍需要设置transformMatrix\n                //防止在资源载入完成之前，缺少transformMatrix导致的绘制错误\n                if (isCanvas && transformMatrix && renderer.isLoadingResource()) {\n                    renderer.__zoomTransformMatrix = transformMatrix;\n                }\n            }\n\n            if (isCanvas) {\n                updatedIds.push(layer.getId());\n                this.setLayerCanvasUpdated();\n            }\n        }\n        // compare:\n        // 1. previous drawn layers and current drawn layers\n        // 2. previous canvas layers and current canvas layers\n        // set map to redraw if either changed\n        const preCanvasIds = this._canvasIds || [];\n        const preUpdatedIds = this._updatedIds || [];\n        this._canvasIds = canvasIds;\n        this._updatedIds = updatedIds;\n        if (!this.isLayerCanvasUpdated()) {\n            const sep = '---';\n            if (preCanvasIds.join(sep) !== canvasIds.join(sep) || preUpdatedIds.join(sep) !== updatedIds.join(sep)) {\n                this.setLayerCanvasUpdated();\n            }\n        }\n    }\n\n    /**\n     * check if need to call layer's draw/drawInteracting\n     * @param  {Layer} layer\n     * @return {Boolean}\n     */\n    _checkLayerRedraw(layer) {\n        if (this.isSpatialReferenceChanged()) {\n            return true;\n        }\n        const map = this.map;\n        const renderer = layer._getRenderer();\n        if (layer.isCanvasRender()) {\n            return renderer.testIfNeedRedraw();\n        } else {\n            if (renderer.needToRedraw && renderer.needToRedraw()) {\n                return true;\n            }\n            // dom layers, redraw it if map is interacting or state is changed\n            return map.isInteracting() || this.isViewChanged();\n        }\n    }\n\n    /**\n     * Draw canvas rendered layer when map is interacting\n     * @param  {Layer} layer\n     * @param  {Number} t     current consumed time of layer drawing\n     * @param  {Number} timeLimit time limit for layer drawing\n     * @return {Number}       time to draw this layer\n     * @private\n     */\n    _drawCanvasLayerOnInteracting(layer, t, timeLimit, framestamp) {\n        const map = this.map,\n            renderer = layer._getRenderer(),\n            drawTime = renderer.getDrawTime(),\n            inTime = timeLimit === 0 || timeLimit > 0 && t + drawTime <= timeLimit;\n        if (renderer.mustRenderOnInteracting && renderer.mustRenderOnInteracting()) {\n            renderer.render(framestamp);\n        } else if (renderer.drawOnInteracting &&\n            (layer === map.getBaseLayer() || inTime ||\n            map.isZooming() && layer.options['forceRenderOnZooming'] ||\n            map.isMoving() && layer.options['forceRenderOnMoving'] ||\n            map.isRotating() && layer.options['forceRenderOnRotating'])\n        ) {\n            // call drawOnInteracting to redraw the layer\n            renderer.prepareRender();\n            renderer.prepareCanvas();\n            renderer.drawOnInteracting(this._eventParam, framestamp);\n            return drawTime;\n        } else if (map.isZooming() && !map.getPitch() && !map.isRotating()) {\n            // when:\n            // 1. layer's renderer doesn't have drawOnInteracting\n            // 2. timeLimit is exceeded\n            // then:\n            // transform layer's current canvas when zooming\n            renderer.prepareRender();\n            renderer.__zoomTransformMatrix = this._zoomMatrix;\n        } else if (map.getPitch() || map.isRotating()) {\n            // when map is pitching or rotating, clear the layer canvas\n            // otherwise, leave layer's canvas unchanged\n            renderer.clearCanvas();\n        }\n        if (renderer.drawOnInteracting && !inTime) {\n            renderer.onSkipDrawOnInteracting(this._eventParam, framestamp);\n        }\n        return 0;\n    }\n\n    /**\n     * Fire layerload events.\n     * Make sure layer are drawn on map when firing the events\n     * @private\n     */\n    _fireLayerLoadEvents() {\n        if (this._updatedIds && this._updatedIds.length > 0) {\n            const map = this.map;\n            //firing order as FIFO, painting as FILO, so the order needs to be reversed\n            this._updatedIds.reverse().forEach(id => {\n                const layer = map.getLayer(id);\n                if (!layer) {\n                    return;\n                }\n                const renderer = layer._getRenderer();\n                if (!renderer || !renderer.isRenderComplete()) {\n                    return;\n                }\n                /**\n                 * layerload event, fired when layer is loaded.\n                 *\n                 * @event Layer#layerload\n                 * @type {Object}\n                 * @property {String} type - layerload\n                 * @property {Layer} target - layer\n                 */\n                layer.fire('layerload');\n            });\n        }\n\n    }\n\n    isLayerCanvasUpdated() {\n        return this._canvasUpdated;\n    }\n\n    setLayerCanvasUpdated() {\n        this._canvasUpdated = true;\n    }\n\n    /**\n     * Renders the layers\n     */\n    drawLayerCanvas(layers) {\n        const map = this.map;\n        if (!map) {\n            return;\n        }\n        if (!this.isLayerCanvasUpdated() && !this.isViewChanged()) {\n            return;\n        }\n        if (!this.canvas) {\n            this.createCanvas();\n        }\n\n        /**\n         * renderstart event, an event fired when map starts to render.\n         * @event Map#renderstart\n         * @type {Object}\n         * @property {String} type           - renderstart\n         * @property {Map} target            - the map fires event\n         * @property {CanvasRenderingContext2D} context  - canvas context\n         */\n        map._fireEvent('renderstart', {\n            'context': this.context\n        });\n\n        if (!this._updateCanvasSize()) {\n            this.clearCanvas();\n        }\n\n        const interacting = map.isInteracting(),\n            limit = map.options['layerCanvasLimitOnInteracting'];\n        let len = layers.length;\n\n        let baseLayerImage;\n        const images = [];\n        for (let i = 0; i < len; i++) {\n            if (!layers[i].isVisible() || !layers[i].isCanvasRender()) {\n                continue;\n            }\n            const renderer = layers[i]._getRenderer();\n            if (!renderer) {\n                continue;\n            }\n            const layerImage = this._getLayerImage(layers[i]);\n            if (layerImage && layerImage['image']) {\n                if (layers[i] === map.getBaseLayer()) {\n                    baseLayerImage = [layers[i], layerImage];\n                } else {\n                    images.push([layers[i], layerImage]);\n                }\n            }\n        }\n\n        if (baseLayerImage) {\n            this._drawLayerCanvasImage(baseLayerImage[0], baseLayerImage[1]);\n            this._drawFog();\n        }\n\n        len = images.length;\n        const start = interacting && limit >= 0 && len > limit ? len - limit : 0;\n        for (let i = start; i < len; i++) {\n            this._drawLayerCanvasImage(images[i][0], images[i][1]);\n        }\n\n\n        this._drawCenterCross();\n        /**\n         * renderend event, an event fired when map ends rendering.\n         * @event Map#renderend\n         * @type {Object}\n         * @property {String} type                      - renderend\n         * @property {Map} target              - the map fires event\n         * @property {CanvasRenderingContext2D} context - canvas context\n         */\n        map._fireEvent('renderend', {\n            'context': this.context\n        });\n    }\n\n    setToRedraw() {\n        const layers = this._getAllLayerToRender();\n        for (let i = 0, l = layers.length; i < l; i++) {\n            const renderer = layers[i].getRenderer();\n            if (renderer && renderer.canvas && renderer.setToRedraw) {\n                //to fix lost webgl context\n                renderer.setToRedraw();\n            }\n        }\n    }\n\n    updateMapSize(size) {\n        if (!size || this._containerIsCanvas) {\n            return;\n        }\n        const width = size['width'] + 'px',\n            height = size['height'] + 'px';\n        const panels = this.map._panels;\n        panels.mapWrapper.style.width = width;\n        panels.mapWrapper.style.height = height;\n        this._updateCanvasSize();\n    }\n\n    getMainPanel() {\n        if (!this.map) {\n            return null;\n        }\n        if (this._containerIsCanvas) {\n            return this.map._containerDOM;\n        }\n        if (this.map._panels) {\n            return this.map._panels.mapWrapper;\n        }\n        return null;\n    }\n\n    toDataURL(mimeType) {\n        if (!this.canvas) {\n            return null;\n        }\n        return this.canvas.toDataURL(mimeType);\n    }\n\n    remove() {\n        if (Browser.webgl && typeof document !== 'undefined') {\n            removeDomEvent(document, 'visibilitychange', this._onVisibilitychange, this);\n        }\n        if (this._resizeInterval) {\n            clearInterval(this._resizeInterval);\n        }\n        delete this.context;\n        delete this.canvas;\n        delete this.map;\n        delete this._spatialRefChanged;\n        this._cancelFrameLoop();\n    }\n\n    hitDetect(point) {\n        const map = this.map;\n        if (!map || !map.options['hitDetect'] || map.isInteracting()) {\n            return;\n        }\n        const layers = map._getLayers();\n        let cursor = 'default';\n        const limit = map.options['hitDetectLimit'] || 0;\n        let counter = 0;\n        for (let i = layers.length - 1; i >= 0; i--) {\n            const layer = layers[i];\n            if (layer.isEmpty && layer.isEmpty()) {\n                continue;\n            }\n            const renderer = layer._getRenderer();\n            if (!renderer || !renderer.hitDetect) {\n                continue;\n            }\n            if (renderer.isBlank && renderer.isBlank()) {\n                continue;\n            }\n            if (layer.options['cursor'] !== 'default' && renderer.hitDetect(point)) {\n                cursor = layer.options['cursor'] || 'pointer';\n                break;\n            }\n            counter++;\n            if (limit > 0 && counter > limit) {\n                break;\n            }\n        }\n\n        map._trySetCursor(cursor);\n    }\n\n    _getLayerImage(layer) {\n        const renderer = layer._getRenderer();\n        if (renderer.getCanvasImage) {\n            return renderer.getCanvasImage();\n        }\n        return null;\n    }\n\n    /**\n     * initialize container DOM of panels\n     */\n    initContainer() {\n        const panels = this.map._panels;\n\n        function createContainer(name, className, cssText, enableSelect) {\n            const c = createEl('div', className);\n            if (cssText) {\n                c.style.cssText = cssText;\n            }\n            panels[name] = c;\n            if (!enableSelect) {\n                preventSelection(c);\n            }\n            return c;\n        }\n        const containerDOM = this.map._containerDOM;\n\n        if (this._containerIsCanvas) {\n            //container is a <canvas> element.\n            return;\n        }\n\n        containerDOM.innerHTML = '';\n\n        const POSITION0 = 'position:absolute;top:0px;left:0px;';\n\n        const mapWrapper = createContainer('mapWrapper', 'maptalks-wrapper', 'position:absolute;overflow:hidden;', true),\n            mapAllLayers = createContainer('allLayers', 'maptalks-all-layers', POSITION0 + 'padding:0px;margin:0px;z-index:0;overflow:visible;', true),\n            backStatic = createContainer('backStatic', 'maptalks-back-static', POSITION0 + 'z-index:0;', true),\n            back = createContainer('back', 'maptalks-back', POSITION0 + 'z-index:1;'),\n            backLayer = createContainer('backLayer', 'maptalks-back-layer', POSITION0),\n            canvasContainer = createContainer('canvasContainer', 'maptalks-canvas-layer', POSITION0 + 'border:none;z-index:2;'),\n            frontStatic = createContainer('frontStatic', 'maptalks-front-static', POSITION0 + 'z-index:3;', true),\n            front = createContainer('front', 'maptalks-front', POSITION0 + 'z-index:4;', true),\n            frontLayer = createContainer('frontLayer', 'maptalks-front-layer', POSITION0 + 'z-index:0;'),\n            // children's zIndex in frontLayer will be set by map.addLayer, ui container's z-index is set to 10000 to make sure it's always on the top.\n            ui = createContainer('ui', 'maptalks-ui', POSITION0 + 'border:none;z-index:1;', true),\n            control = createContainer('control', 'maptalks-control', 'z-index:1', true);\n\n        containerDOM.appendChild(mapWrapper);\n\n        mapAllLayers.appendChild(backStatic);\n        back.appendChild(backLayer);\n        mapAllLayers.appendChild(back);\n        mapAllLayers.appendChild(canvasContainer);\n        front.appendChild(frontLayer);\n        mapAllLayers.appendChild(frontStatic);\n        mapAllLayers.appendChild(front);\n        front.appendChild(ui);\n\n        mapWrapper.appendChild(mapAllLayers);\n        mapWrapper.appendChild(control);\n\n        this.createCanvas();\n\n        this.resetContainer();\n        const mapSize = this.map._getContainerDomSize();\n        this.updateMapSize(mapSize);\n    }\n\n    /**\n     * Is current map's state changed?\n     * @return {Boolean}\n     */\n    isViewChanged() {\n        const previous = this._mapview;\n        const view = this._getMapView();\n        if (!previous || !equalMapView(previous, view)) {\n            return true;\n        }\n        return false;\n    }\n\n    _recordView() {\n        const map = this.map;\n        if (!map._onViewChange || map.isInteracting() || map.isAnimating()) {\n            return;\n        }\n        if (!equalMapView(map.getView(), map._getCurrentView())) {\n            map._onViewChange(map.getView());\n        }\n    }\n\n    isSpatialReferenceChanged() {\n        return this._spatialRefChanged;\n    }\n\n    _getMapView() {\n        const map = this.map;\n        const center = map._getPrjCenter();\n        return {\n            x       : center.x,\n            y       : center.y,\n            zoom    : map.getZoom(),\n            pitch   : map.getPitch(),\n            bearing : map.getBearing(),\n            width   : map.width,\n            height  : map.height\n        };\n    }\n\n    /**\n    * Main frame loop\n    */\n    _frameLoop(framestamp) {\n        if (!this.map) {\n            this._cancelFrameLoop();\n            return;\n        }\n        this.renderFrame(framestamp);\n        // Keep registering ourselves for the next animation frame\n        this._animationFrame = requestAnimFrame((framestamp) => { this._frameLoop(framestamp); });\n    }\n\n    _cancelFrameLoop() {\n        if (this._animationFrame) {\n            cancelAnimFrame(this._animationFrame);\n        }\n    }\n\n    _drawLayerCanvasImage(layer, layerImage) {\n        const ctx = this.context;\n        const point = layerImage['point'].round();\n        const dpr = this.map.getDevicePixelRatio();\n        if (dpr !== 1) {\n            point._multi(dpr);\n        }\n        const canvasImage = layerImage['image'];\n        const width = canvasImage.width, height = canvasImage.height;\n        if (point.x + width <= 0 || point.y + height <= 0) {\n            return;\n        }\n        //opacity of the layer image\n        let op = layer.options['opacity'];\n        if (!isNumber(op)) {\n            op = 1;\n        }\n        if (op <= 0) {\n            return;\n        }\n        let imgOp = layerImage['opacity'];\n        if (!isNumber(imgOp)) {\n            imgOp = 1;\n        }\n        if (imgOp <= 0) {\n            return;\n        }\n        const alpha = ctx.globalAlpha;\n\n        if (op < 1) {\n            ctx.globalAlpha *= op;\n        }\n        if (imgOp < 1) {\n            ctx.globalAlpha *= imgOp;\n        }\n        if (layer.options['cssFilter']) {\n            ctx.filter = layer.options['cssFilter'];\n        }\n        const renderer = layer.getRenderer();\n        const matrix = renderer.__zoomTransformMatrix;\n        const clipped = renderer.clipCanvas(this.context);\n        if (matrix) {\n            ctx.save();\n            ctx.setTransform.apply(ctx, matrix);\n        }\n\n        /*let outlineColor = layer.options['debugOutline'];\n        if (outlineColor) {\n            if (outlineColor === true) {\n                outlineColor = '#0f0';\n            }\n            this.context.strokeStyle = outlineColor;\n            this.context.fillStyle = outlineColor;\n            this.context.lineWidth = 10;\n            Canvas2D.rectangle(ctx, point.x, point.y, layerImage.size, 1, 0);\n            ctx.fillText([layer.getId(), point.toArray().join(), layerImage.size.toArray().join(), canvasImage.width + ',' + canvasImage.height].join(' '),\n                point.x + 18, point.y + 18);\n        }*/\n\n        ctx.drawImage(canvasImage, 0, 0, width, height, point.x, point.y, width, height);\n        if (matrix) {\n            ctx.restore();\n        }\n        if (clipped) {\n            ctx.restore();\n        }\n        if (ctx.filter !== 'none') {\n            ctx.filter = 'none';\n        }\n        ctx.globalAlpha = alpha;\n    }\n\n    _drawCenterCross() {\n        const cross = this.map.options['centerCross'];\n        if (cross) {\n            const ctx = this.context;\n            const p = new Point(this.canvas.width / 2, this.canvas.height / 2);\n            if (isFunction(cross)) {\n                cross(ctx, p);\n            } else {\n                Canvas2D.drawCross(this.context, p.x, p.y, 2, '#f00');\n            }\n        }\n    }\n\n    _drawFog() {\n        const map = this.map;\n        if (map.getPitch() <= map.options['maxVisualPitch'] || !map.options['fog']) {\n            return;\n        }\n        const fogThickness = 30;\n        const r = map.getDevicePixelRatio();\n        const ctx = this.context,\n            clipExtent = map.getContainerExtent();\n        let top = (map.height - map._getVisualHeight(75)) * r;\n        if (top < 0) top = 0;\n        const bottom = clipExtent.ymin * r,\n            h = Math.ceil(bottom - top),\n            color = map.options['fogColor'].join();\n        const gradient = ctx.createLinearGradient(0, top, 0, bottom + fogThickness);\n        const landscape = 1 - fogThickness / (h + fogThickness);\n        gradient.addColorStop(0, `rgba(${color}, 0)`);\n        gradient.addColorStop(0.3, `rgba(${color}, 0.3)`);\n        gradient.addColorStop(landscape, `rgba(${color}, 1)`);\n        gradient.addColorStop(1, `rgba(${color}, 0)`);\n        ctx.beginPath();\n        ctx.fillStyle = gradient;\n        ctx.fillRect(0, top, Math.ceil(clipExtent.getWidth()) * r, Math.ceil(h + fogThickness));\n    }\n\n    _getAllLayerToRender() {\n        return this.map._getLayers();\n    }\n\n    clearCanvas() {\n        if (!this.canvas) {\n            return;\n        }\n        Canvas2D.clearRect(this.context, 0, 0, this.canvas.width, this.canvas.height);\n    }\n\n    _updateCanvasSize() {\n        if (!this.canvas || this._containerIsCanvas) {\n            return false;\n        }\n        const map = this.map,\n            mapSize = map.getSize(),\n            canvas = this.canvas,\n            r = map.getDevicePixelRatio();\n        if (mapSize['width'] * r === canvas.width && mapSize['height'] * r === canvas.height) {\n            return false;\n        }\n        //retina屏支持\n\n        canvas.height = r * mapSize['height'];\n        canvas.width = r * mapSize['width'];\n        if (canvas.style) {\n            canvas.style.width = mapSize['width'] + 'px';\n            canvas.style.height = mapSize['height'] + 'px';\n        }\n\n        return true;\n    }\n\n    createCanvas() {\n        if (this._containerIsCanvas) {\n            this.canvas = this.map._containerDOM;\n        } else {\n            this.canvas = createEl('canvas');\n            this._updateCanvasSize();\n            this.map._panels.canvasContainer.appendChild(this.canvas);\n        }\n        this.context = this.canvas.getContext('2d');\n    }\n\n    _checkSize() {\n        if (!this.map || this.map.isInteracting()) {\n            return;\n        }\n        // refresh map's dom position\n        computeDomPosition(this.map._containerDOM);\n        this.map.checkSize();\n    }\n\n    _setCheckSizeInterval(interval) {\n        clearInterval(this._resizeInterval);\n        this._checkSizeInterval = interval;\n        this._resizeInterval = setInterval(() => {\n            if (!this.map || this.map.isRemoved()) {\n                //is deleted\n                clearInterval(this._resizeInterval);\n            } else {\n                this._checkSize();\n            }\n        }, this._checkSizeInterval);\n    }\n\n    _registerEvents() {\n        const map = this.map;\n\n        if (map.options['checkSize'] && !IS_NODE && (typeof window !== 'undefined')) {\n            this._setCheckSizeInterval(map.options['checkSizeInterval']);\n        }\n        if (!Browser.mobile) {\n            map.on('_mousemove', this._onMapMouseMove, this);\n        }\n\n        map.on('_dragrotatestart _dragrotating _dragrotateend _movestart _moving _moveend _zoomstart', (param) => {\n            this._eventParam = param;\n        });\n\n        map.on('_zooming', (param) => {\n            if (!map.getPitch()) {\n                this._zoomMatrix = param['matrix']['container'];\n            }\n            this._eventParam = param;\n        });\n\n        map.on('_zoomend', (param) => {\n            this._eventParam = param;\n            delete this._zoomMatrix;\n        });\n\n        map.on('_spatialreferencechange', () => {\n            this._spatialRefChanged = true;\n        });\n\n        if (Browser.webgl && typeof document !== 'undefined') {\n            addDomEvent(document, 'visibilitychange', this._onVisibilitychange, this);\n        }\n    }\n\n    _onMapMouseMove(param) {\n        const map = this.map;\n        if (map.isInteracting() || !map.options['hitDetect']) {\n            return;\n        }\n        if (this._hitDetectFrame) {\n            cancelAnimFrame(this._hitDetectFrame);\n        }\n        this._hitDetectFrame = requestAnimFrame(() => {\n            this.hitDetect(param['containerPoint']);\n        });\n    }\n\n    _getCanvasLayers() {\n        return this.map._getLayers(layer => layer.isCanvasRender());\n    }\n\n    _onVisibilitychange() {\n        if (document.visibilityState !== 'visible') {\n            return;\n        }\n        this.setToRedraw();\n    }\n}\n\nMap.registerRenderer('canvas', MapCanvasRenderer);\n\nMap.mergeOptions({\n    'fog' : true,\n    'fogColor' : [233, 233, 233]\n});\n\nexport default MapCanvasRenderer;\n","import Marker from '../../geometry/Marker';\nimport Ellipse from '../../geometry/Ellipse';\nimport Circle from '../../geometry/Circle';\nimport Sector from '../../geometry/Sector';\nimport Rectangle from '../../geometry/Rectangle';\nimport LineString from '../../geometry/LineString';\nimport Polygon from '../../geometry/Polygon';\n\n// 有中心点的图形的共同方法\nconst CenterPointRenderer = {\n    _getRenderPoints() {\n        return [[this._getCenter2DPoint(this.getMap().getGLZoom())], null];\n    }\n};\n\n/**\n * 获取symbolizer所需的数据\n */\nMarker.include(CenterPointRenderer);\n\nEllipse.include(CenterPointRenderer);\n\nCircle.include(CenterPointRenderer);\n//----------------------------------------------------\nSector.include(CenterPointRenderer);\n//----------------------------------------------------\nRectangle.include({\n    _getRenderPoints(placement) {\n        const map = this.getMap();\n        if (placement === 'vertex') {\n            const shell = this._trimRing(this.getShell());\n            const points = [];\n            for (let i = 0, len = shell.length; i < len; i++) {\n                points.push(map.coordToPoint(shell[i], map.getGLZoom()));\n            }\n            return [points, null];\n        } else {\n            const c = map.coordToPoint(this.getCenter(), map.getGLZoom());\n            return [\n                [c], null\n            ];\n        }\n    }\n});\n\n//----------------------------------------------------\nconst PolyRenderer = {\n    _getRenderPoints(placement) {\n        const map = this.getMap();\n        const glZoom = map.getGLZoom();\n        let points, rotations = null;\n        if (placement === 'point') {\n            points = this._getPath2DPoints(this._getPrjCoordinates(), false, glZoom);\n            if (points && points.length > 0 && Array.isArray(points[0])) {\n                //anti-meridian\n                points = points[0].concat(points[1]);\n            }\n        } else if (placement === 'vertex') {\n            points = this._getPath2DPoints(this._getPrjCoordinates(), false, glZoom);\n            rotations = [];\n            if (points && points.length > 0 && Array.isArray(points[0])) {\n                for (let i = 0, l = points.length; i < l; i++) {\n                    for (let ii = 0, ll = points[i].length; ii < ll; ii++) {\n                        if (ii === 0) {\n                            rotations.push([points[i][ii], points[i][ii + 1]]);\n                        } else {\n                            rotations.push([points[i][ii - 1], points[i][ii]]);\n                        }\n                    }\n                }\n                points = points[0].concat(points[1]);\n            } else {\n                for (let i = 0, l = points.length; i < l; i++) {\n                    if (i === 0) {\n                        rotations.push([points[i], points[i + 1]]);\n                    } else {\n                        rotations.push([points[i - 1], points[i]]);\n                    }\n                }\n            }\n        } else if (placement === 'line') {\n            points = [];\n            rotations = [];\n            const vertice = this._getPath2DPoints(this._getPrjCoordinates(), false, glZoom),\n                isSplitted =  vertice.length > 0 && Array.isArray(vertice[0]);\n            if (isSplitted) {\n                //anti-meridian splitted\n                let ring;\n                for (let i = 1, l = vertice.length; i < l; i++) {\n                    ring = vertice[i];\n                    if (this instanceof Polygon && ring.length > 0 && !ring[0].equals(ring[ring.length - 1])) {\n                        ring.push(ring[0]);\n                    }\n                    for (let ii = 1, ll = ring.length; ii < ll; ii++) {\n                        points.push(ring[ii].add(ring[ii - 1])._multi(0.5));\n                        rotations.push([ring[ii - 1], ring[ii]]);\n                    }\n                }\n            } else {\n                if (this instanceof Polygon && vertice.length > 0 && !vertice[0].equals(vertice[vertice.length - 1])) {\n                    vertice.push(vertice[0]);\n                }\n                for (let i = 1, l = vertice.length; i < l; i++) {\n                    points.push(vertice[i].add(vertice[i - 1])._multi(0.5));\n                    rotations.push([vertice[i - 1], vertice[i]]);\n                }\n            }\n\n        } else if (placement === 'vertex-first') {\n            const coords = this._getPrjCoordinates();\n            points = coords.length ? [map._prjToPoint(coords[0], glZoom)] : [];\n            rotations = coords.length ? [[map._prjToPoint(coords[0], glZoom), map._prjToPoint(coords[1], glZoom)]] : [];\n        } else if (placement === 'vertex-last') {\n            const coords = this._getPrjCoordinates();\n            const l = coords.length;\n            points = l ? [map._prjToPoint(coords[l - 1], glZoom)] : [];\n            const current = l - 1,\n                previous = l > 1 ? l - 2 : l - 1;\n            rotations = l ? [[map._prjToPoint(coords[previous], glZoom), map._prjToPoint(coords[current], glZoom)]] : [];\n        } else {\n            const pcenter = this._getProjection().project(this.getCenter());\n            points = [map._prjToPoint(pcenter, glZoom)];\n        }\n        return [points, rotations];\n    }\n};\n\nLineString.include(PolyRenderer);\n\nPolygon.include(PolyRenderer);\n","import { pushIn, isNumber } from '../../core/util';\nimport Size from '../../geo/Size';\nimport Point from '../../geo/Point';\nimport Canvas from '../../core/Canvas';\nimport Geometry from '../../geometry/Geometry';\nimport Ellipse from '../../geometry/Ellipse';\nimport Circle from '../../geometry/Circle';\nimport Sector from '../../geometry/Sector';\nimport Rectangle from '../../geometry/Rectangle';\nimport Path from '../../geometry/Path';\nimport LineString from '../../geometry/LineString';\nimport Polygon from '../../geometry/Polygon';\n\nGeometry.include({\n    _redrawWhenPitch: () => false,\n\n    _redrawWhenRotate: () => false\n});\n\nconst el = {\n    _redrawWhenPitch: () => true,\n\n    _redrawWhenRotate: function () {\n        return (this instanceof Ellipse) || (this instanceof Sector);\n    },\n\n    _paintAsPath: function () {\n        const map = this.getMap();\n        const altitude = this._getPainter().getAltitude();\n        // when map is tilting, draw the circle/ellipse as a polygon by vertexes.\n        return altitude > 0 || map.getPitch() || ((this instanceof Ellipse) && map.getBearing());\n    },\n\n    _getPaintParams() {\n        const map = this.getMap();\n        if (this._paintAsPath()) {\n            return Polygon.prototype._getPaintParams.call(this, true);\n        }\n        const pcenter = this._getPrjCoordinates();\n        const pt = map._prjToPoint(pcenter, map.getGLZoom());\n        const size = this._getRenderSize();\n        return [pt, size['width'], size['height']];\n    },\n\n    _paintOn: function () {\n        if (this._paintAsPath()) {\n            return Canvas.polygon.apply(Canvas, arguments);\n        } else {\n            return Canvas.ellipse.apply(Canvas, arguments);\n        }\n    },\n\n    _getRenderSize() {\n        const map = this.getMap(),\n            z = map.getGLZoom();\n        const prjExtent = this._getPrjExtent();\n        const pmin = map._prjToPoint(prjExtent.getMin(), z),\n            pmax = map._prjToPoint(prjExtent.getMax(), z);\n        return new Size(Math.abs(pmax.x - pmin.x) / 2, Math.abs(pmax.y - pmin.y) / 2);\n    }\n};\n\nEllipse.include(el);\n\nCircle.include(el);\n//----------------------------------------------------\nRectangle.include({\n    _getPaintParams() {\n        const map = this.getMap();\n        const pointZoom = map.getGLZoom();\n        const shell = this._getPrjShell();\n        const points = this._getPath2DPoints(shell, false, pointZoom);\n        return [points];\n    },\n\n    _paintOn: Canvas.polygon\n});\n//----------------------------------------------------\nSector.include(el, {\n    _redrawWhenPitch: () => true,\n\n    _getPaintParams() {\n        if (this._paintAsPath()) {\n            return Polygon.prototype._getPaintParams.call(this, true);\n        }\n        const map = this.getMap();\n        const pt = map._prjToPoint(this._getPrjCoordinates(), map.getGLZoom());\n        const size = this._getRenderSize();\n        return [pt, size['width'],\n            [this.getStartAngle(), this.getEndAngle()]\n        ];\n    },\n\n    _paintOn: function () {\n        if (this._paintAsPath()) {\n            return Canvas.polygon.apply(Canvas, arguments);\n        } else {\n            const r = this.getMap().getBearing();\n            const args = arguments;\n            if (r) {\n                args[3] = args[3].slice(0);\n                args[3][0] += r;\n                args[3][1] += r;\n            }\n            return Canvas.sector.apply(Canvas, args);\n        }\n    }\n\n});\n//----------------------------------------------------\nPath.include({\n    _paintAsPath: () => true\n});\n\n\nLineString.include({\n\n    arrowStyles: {\n        'classic': [3, 4]\n    },\n\n    _getArrowShape(prePoint, point, lineWidth, arrowStyle, tolerance) {\n        if (!tolerance) {\n            tolerance = 0;\n        }\n        const width = lineWidth * arrowStyle[0],\n            height = lineWidth * arrowStyle[1] + tolerance,\n            hw = width / 2 + tolerance;\n\n        let normal;\n        if (point.nextCtrlPoint || point.prevCtrlPoint) {\n            // use control points to caculate normal if it's a bezier curve\n            if (point.prevCtrlPoint) {\n                normal = point.sub(new Point(point.prevCtrlPoint));\n            } else {\n                normal = point.sub(new Point(point.nextCtrlPoint));\n            }\n        } else {\n            normal = point.sub(prePoint);\n        }\n        normal._unit();\n        const p1 = point.sub(normal.multi(height));\n        normal._perp();\n        const p0 = p1.add(normal.multi(hw));\n        normal._multi(-1);\n        const p2 = p1.add(normal.multi(hw));\n        return [p0, point, p2, p0];\n    },\n\n    _getPaintParams() {\n        const prjVertexes = this._getPrjCoordinates();\n        const points = this._getPath2DPoints(prjVertexes, false, this.getMap().getGLZoom());\n        return [points];\n    },\n\n    _paintOn(ctx, points, lineOpacity, fillOpacity, dasharray) {\n        if (this.options['smoothness']) {\n            Canvas.paintSmoothLine(ctx, points, lineOpacity, this.options['smoothness'], false, this._animIdx, this._animTailRatio);\n        } else {\n            Canvas.path(ctx, points, lineOpacity, null, dasharray);\n        }\n        this._paintArrow(ctx, points, lineOpacity);\n    },\n\n    _getArrowPlacement() {\n        return this.options['arrowPlacement'];\n    },\n\n    _getArrowStyle() {\n        const arrowStyle = this.options['arrowStyle'];\n        if (arrowStyle) {\n            return Array.isArray(arrowStyle) ? arrowStyle : this.arrowStyles[arrowStyle];\n        }\n        return null;\n    },\n\n    _getArrows(points, lineWidth, tolerance) {\n        const arrowStyle = this._getArrowStyle();\n        if (!arrowStyle || points.length < 2) {\n            return [];\n        }\n        const isSplitted = points.length > 0 && Array.isArray(points[0]);\n        const segments = isSplitted ? points : [points];\n        const placement = this._getArrowPlacement();\n        const arrows = [];\n        const map = this.getMap(),\n            first = map.coordToContainerPoint(this.getFirstCoordinate()),\n            last = map.coordToContainerPoint(this.getLastCoordinate());\n        for (let i = segments.length - 1; i >= 0; i--) {\n            if (placement === 'vertex-first' || placement === 'vertex-firstlast' && segments[i][0].closeTo(first, 0.01)) {\n                arrows.push(this._getArrowShape(segments[i][1], segments[i][0], lineWidth, arrowStyle, tolerance));\n            }\n            if (placement === 'vertex-last' || placement === 'vertex-firstlast' && segments[i][segments[i].length - 1].closeTo(last, 0.01)) {\n                arrows.push(this._getArrowShape(segments[i][segments[i].length - 2], segments[i][segments[i].length - 1], lineWidth, arrowStyle, tolerance));\n            } else if (placement === 'point') {\n                this._getArrowPoints(arrows, segments[i], lineWidth, arrowStyle, tolerance);\n            }\n        }\n        return arrows;\n    },\n\n    _getArrowPoints(arrows, segments, lineWidth, arrowStyle, tolerance) {\n        for (let ii = 0, ll = segments.length - 1; ii < ll; ii++) {\n            arrows.push(this._getArrowShape(segments[ii], segments[ii + 1], lineWidth, arrowStyle, tolerance));\n        }\n    },\n\n    _paintArrow(ctx, points, lineOpacity) {\n        let lineWidth = this._getInternalSymbol()['lineWidth'];\n        if (!isNumber(lineWidth) || lineWidth < 3) {\n            lineWidth = 3;\n        }\n        const arrows = this._getArrows(points, lineWidth);\n        if (!arrows.length) {\n            return;\n        }\n        if (ctx.setLineDash) {\n            //remove line dash effect if any\n            ctx.setLineDash([]);\n        }\n        for (let i = arrows.length - 1; i >= 0; i--) {\n            ctx.fillStyle = ctx.strokeStyle;\n            Canvas.polygon(ctx, arrows[i], lineOpacity, lineOpacity);\n        }\n    }\n});\n\nPolygon.include({\n    _getPaintParams(disableSimplify) {\n        const maxZoom = this.getMap().getGLZoom();\n        const prjVertexes = this._getPrjShell();\n        let points = this._getPath2DPoints(prjVertexes, disableSimplify, maxZoom);\n        //splitted by anti-meridian\n        const isSplitted = points.length > 0 && Array.isArray(points[0]);\n        if (isSplitted) {\n            points = [\n                [points[0]],\n                [points[1]]\n            ];\n        }\n        const prjHoles = this._getPrjHoles();\n        const holePoints = [];\n        if (prjHoles && prjHoles.length > 0) {\n            //outer ring  simplify result;\n            const simplified = this._simplified;\n            for (let i = 0; i < prjHoles.length; i++) {\n                const hole = this._getPath2DPoints(prjHoles[i], disableSimplify, maxZoom);\n                if (Array.isArray(hole) && isSplitted) {\n                    if (Array.isArray(hole[0])) {\n                        points[0].push(hole[0]);\n                        points[1].push(hole[1]);\n                    } else {\n                        points[0].push(hole);\n                    }\n                } else {\n                    holePoints.push(hole);\n                }\n            }\n            // if outer ring  simplify==true , Ignore inner ring  simplify result\n            if (simplified) {\n                this._simplified = simplified;\n            }\n        }\n        if (!isSplitted) {\n            points = [points];\n            pushIn(points, holePoints);\n        }\n        return [points];\n    },\n\n    _paintOn(ctx, points, lineOpacity, fillOpacity, dasharray) {\n        Canvas.polygon(ctx, points, lineOpacity, fillOpacity, dasharray, this.options['smoothness']);\n    }\n});\n\n","import { version } from '../package.json';\nexport * from './core/Constants';\nexport { default as Browser } from './core/Browser';\nimport * as Util from './core/util';\nimport * as DomUtil from './core/util/dom';\nimport * as StringUtil from './core/util/strings';\nimport * as MapboxUtil from './core/mapbox';\nexport { Util, DomUtil, StringUtil, MapboxUtil };\nexport { default as Ajax } from './core/Ajax';\nexport { default as Canvas } from './core/Canvas';\nexport { default as Promise } from './core/Promise';\n\n// core classes\nexport { default as Class } from './core/Class';\nexport { default as Eventable } from './core/Eventable';\nexport { default as JSONAble } from './core/JSONAble';\n\nexport { default as Handlerable } from './handler/Handlerable';\nexport { default as Handler } from './handler/Handler';\nexport { default as DragHandler } from './handler/Drag';\n\n// geo classes\nexport * from './geo';\n\nimport { Map } from './map';\nMap.VERSION = version;\nexport { Map };\n\nexport { MapTool, DrawTool, AreaTool, DistanceTool } from './map/tool';\nexport { default as SpatialReference } from './map/spatial-reference/SpatialReference';\nimport './map/spatial-reference/SpatialReference.Arc';\n\n/** @namespace ui */\nimport * as ui from './ui';\n/** @namespace control */\nimport * as control from './control';\nexport { ui, control };\n\nexport * from './layer';\n\nexport * from './geometry';\n\nimport './geometry/editor/GeometryEditor';\nimport './geometry/editor/TextEditable';\n\nimport './geometry/ext/Geometry.Animation';\nimport './geometry/ext/Geometry.Drag';\nimport './geometry/ext/Geometry.Edit';\nimport './geometry/ext/Geometry.Events';\nimport './geometry/ext/Geometry.InfoWindow';\n\n/**\n * @namespace renderer\n */\n// import layer renderers\nimport * as renderer from './renderer';\nexport { renderer };\n// import geometry renderers\nimport './renderer/geometry';\nimport * as symbolizer from './renderer/geometry/symbolizers';\n/** @namespace animation */\nimport * as animation from './core/Animation';\nexport { symbolizer, animation };\n"],"names":["INTERNAL_LAYER_PREFIX","GEOMETRY_COLLECTION_TYPES","GEOJSON_TYPES","concat","RESOURCE_PROPERTIES","RESOURCE_SIZE_PROPERTIES","NUMERICAL_PROPERTIES","COLOR_PROPERTIES","now","Date","extend","dest","i","arguments","length","src","k","isNil","obj","isNumber","val","isNaN","isInteger","n","isObject","isString","constructor","String","isFunction","Function","hasOwnProperty","Object","prototype","hasOwn","key","call","join","arr","seperator","Array","pi","Math","PI","toRadian","d","toDegree","r","IS_NODE","toString","process","versions","requestAnimFrame","cancelAnimFrame","fn","setTimeout","clearTimeout","requestFn","cancelFn","timeToCall","timeoutDefer","getPrefixed","name","window","id","isSVG","url","prefix","slice","loadImage","img","imgDesc","node","uid","UID","GUID","parseJSON","str","JSON","parse","pushIn","ii","ll","push","removeFromArray","array","indexOf","splice","forEachCoord","context","isArray","result","p","pp","len","getValueOrDefault","v","undefined","sign","x","Number","log2","log","LOG2E","rounded","round","abs","interpolate","a","b","t","wrap","min","max","w","clamp","isArrayHasData","isURL","head","cssUrlReWithQuote","cssUrlRe","isCssUrl","test","extractCssUrl","matches","exec","b64chrs","btoa","input","output","block","charCode","idx","map","charAt","charCodeAt","Error","b64toBlob","b64Data","contentType","byteCharacters","atob","arraybuffer","ArrayBuffer","view","Uint8Array","blob","Blob","type","computeDegree","x0","y0","x1","y1","dx","dy","atan2","emptyImageUrl","equalMapView","obj1","obj2","approx","expected","delta","flash","interval","count","cb","me","_flashTimeout","flashGeo","show","hide","_defaults","defaults","keys","getOwnPropertyNames","value","getOwnPropertyDescriptor","configurable","defineProperty","types","createFilter","filter","compile","op","compileComparisonOp","compileLogicalOp","compileNegation","compileInOp","compileHasOp","compilePropertyReference","property","substring","stringify","checkType","left","right","expressions","values","sort","compare","expression","getFilterFeature","geometry","json","_toJSON","g","compileStyle","styles","compiled","createFunction","parameters","defaultType","fun","isFunctionDefinition","zoomAndFeatureDependent","stops","featureDependent","zoomDependent","innerFun","evaluateExponentialFunction","evaluateIntervalFunction","evaluateCategoricalFunction","evaluateIdentityFunction","featureFunctions","featureFunctionStops","s","stop","zoom","z","feature","base","coalesce","c","inputLower","inputUpper","outputLower","outputUpper","evaluatedLower","apply","evaluatedUpper","interpolateArray","interpolateNumber","difference","progress","ratio","pow","hasFunctionDefinition","interpolated","piecewiseConstant","loadFunctionTypes","argFn","hit","multResult","loaded","props","buildFn","get","set","enumerable","getFunctionTypeResources","res","l","translateToSVGStyles","getMarkerPathBase64","symbol","width","height","svgStyles","pathes","path","pathesToRender","svg","strPath","b64","getExternalResources","toAbsolute","symbols","resources","resSizeProp","h","convertResourceUrl","iii","_convertUrlToAbsolute","embed","_absolute","location","href","relative","stack","split","parts","pop","isGradient","getGradientStamp","getSymbolStamp","lowerSymbolOpacity","_symbol","_ratio","lower","extendSymbol","sources","args","Browser","ua","navigator","userAgent","toLowerCase","doc","document","documentElement","ie","webkit","phantomjs","android23","search","chrome","gecko","opera","mobile","orientation","msPointer","PointerEvent","MSPointerEvent","pointer","pointerEnabled","ie3d","style","webkit3d","WebKitCSSMatrix","gecko3d","opera12","any3d","chromeVersion","match","touch","DocumentTouch","webgl","canvas","createElement","gl","getContext","WebGLRenderingContext","err","devicePixelRatio","screen","deviceXDPI","logicalXDPI","ielt9","addEventListener","edge","android","safari","mobileWebkit","mobileWebkit3d","mobileOpera","mobileGecko","retina","language","browserLanguage","ie9","documentMode","ie10","Position","y","_isNaN","_abs","_round","_ceil","ceil","_floor","floor","copy","_add","add","nx","ny","_sub","_substract","sub","substract","multi","_multi","div","_div","equals","isZero","toArray","toFixed","toJSON","Point","closeTo","distanceTo","point","sqrt","mag","unit","_unit","perp","_perp","angleWith","angleWithSep","_rotate","angle","cos","sin","rotate","Size","size","toPoint","trim","replace","specialPattern","escapeSpecialChars","splitWords","chr","rulerCtx","stringWidth","text","font","measureText","fontHeight","stringLength","getFontHeight","domRuler","getDomRuler","innerHTML","clientHeight","removeDomNode","splitContent","content","wrapWidth","textWidth","chrWidth","minChrCount","testStr","prew","contentExpRe","replaceVariable","getAlignPoint","horizontalAlignment","verticalAlignment","alignW","alignH","DEFAULT_FONT","getFont","splitTextToRow","lineSpacing","textHeight","wrapChar","textRows","actualWidth","texts","tWidth","contents","rowNum","textSize","first","testProp","TRANSFORM","TRANSFORMORIGIN","TRANSITION","CSSFILTER","createEl","tagName","className","el","setClass","createElOn","container","setStyle","appendChild","parentNode","removeChild","addDomEvent","typeArr","handler","eventHandler","e","event","listensDomEvent","removeDomEvent","callback","doRemove","removeEventListener","handlers","j","jlen","hitHandler","preventDefault","returnValue","stopPropagation","cancelBubble","preventSelection","dom","onselectstart","ondragstart","setAttribute","offsetDom","offset","setTransform","top","computeDomPosition","getComputedStyle","padding","parseInt","rect","getBoundingClientRect","offsetWidth","offsetHeight","scaleX","scaleY","__position","getEventContainerPoint","ev","domPos","clientX","clientLeft","clientY","clientTop","endsWith","suffix","strCss","cssText","hasClass","classList","contains","getClass","RegExp","addClass","classes","baseVal","setOpacity","opacity","pos","setTransformMatrix","m","removeTransform","isHTML","measureDom","parentTag","ruler","clientWidth","tag","span","body","on","off","Ajax","jsonp","script","data","getElementsByTagName","options","client","_getClient","open","headers","setRequestHeader","withCredentials","credentials","responseType","send","post","postData","_wrapCallback","readyState","status","response","byteLength","cacheControl","getResponseHeader","expires","responseText","statusText","XMLHttpRequest","ActiveXObject","onreadystatechange","getArrayBuffer","getImage","imgData","onerror","URL","webkitURL","onload","revokeObjectURL","createObjectURL","getJSON","resp","DEFAULT_STROKE_COLOR","DEFAULT_FILL_COLOR","DEFAULT_TEXT_COLOR","hitTesting","TEMP_CANVAS","Canvas","setHitTesting","testing","createCanvas","canvasClass","prepareCanvasFont","ctx","textBaseline","fill","fillStyle","getRgba","prepareCanvas","strokeWidth","lineWidth","strokeColor","strokeStyle","isImageUrl","patternOffset","_setStrokePattern","_createGradient","lineJoin","lineCap","setLineDash","fillImgUrl","extractImageUrl","fillTexture","Image","image","console","warn","createPattern","extent","gradient","places","getMin","getMax","getWidth","getHeight","createLinearGradient","getCenter","createRadialGradient","forEach","addColorStop","strokePattern","linePatternOffset","imgUrl","imageTexture","imageRes","patternCanvas","addResource","clearRect","x2","y2","_drawn","fillCanvas","fillOpacity","isPattern","_isPattern","alpha","globalAlpha","translate","color","drawImage","error","pt","textDesc","_textOnMultiRow","splitTextSize","ptAlign","lineHeight","basePoint","maxHeight","rowAlign","_textOnLine","textHaloRadius","textHaloFill","textHaloAlpha","drawHalo","gco","shadowBlur","shadowOffsetX","shadowOffsetY","miterLimit","strokeText","globalCompositeOperation","fillText","rgba","_stroke","strokeOpacity","stroke","_path","points","lineDashArray","lineOpacity","ignoreStrokePattern","fillWithPattern","p1","p2","degree","save","restore","isDashed","isPatternLine","prePoint","nextPoint","lineTo","beginPath","moveTo","drawDashLine","_multiClip","polygon","smoothness","isMultiClip","fillFirst","savedCtx","copyProperties","_ring","paintSmoothLine","closePath","ring","ignorePattern","smoothValue","close","tailIdx","tailRatio","t0","t1","bx1","by1","bx2","by2","u0","u1","qxa","qxb","qxc","qxd","qya","qyb","qyc","qyd","xb","xc","xd","yb","yc","yd","getCubicControlPoints","x3","y3","xc1","yc1","xc2","yc2","xc3","yc3","len1","len2","len3","k1","k2","xm1","ym1","xm2","ym2","ctrl1X","ctrl1Y","ctrl2X","ctrl2Y","ctrlPoints","preCtrlPoints","bezierCurveTo","lastPoint","prevCtrlPoint","nextCtrlPoint","_arcBetween","dist","p1p2","asin","cp2","da","cx","cy","startAngle","endAngle","arc","_lineTo","bezierCurveAndFill","start","_bezierCurveTo","p3","ellipse","bezierEllipse","ox","oy","rectangle","sector","angles","rad","radius","sDeg","eDeg","drawCross","target","startPoint","endPoint","dashArray","fromX","fromY","toX","toY","pattern","lt","gt","capmin","capmax","checkX","thereYet","cap","checkY","offsetX","offsetY","dash","ang","lineDashOffset","shadowColor","u","f","o","MutationObserver","nextTick","setImmediate","observe","attributes","TypeError","resolve","reject","state","then","handled","suppressUncaughtRejectionError","timeout","all","module","exports","define","amd","Zousan","soon","global","this","promise","Promise","Eventable","Base","eventsOn","_switch","_eventMap","eventTypes","evtType","handlerChain","once","_wrapOnceHandler","evetTypes","eventsOff","eventType","listeners","wrapKey","jl","listener","listens","getListeningEvents","copyEventListeners","eventMap","fire","_eventParent","_fire","called","onceHandler","to","eventKeys","_clearListeners","_clearAllListeners","_setEventParent","parent","param","queue","bubble","passed","Handler","enable","_enabled","addHooks","disable","removeHooks","enabled","remove","Class","setOptions","callInitHooks","proto","getPrototypeOf","_visitInitHooks","create","config","conf","onConfig","_initHooksCalled","parentProto","hooks","_initHooks","addInitHook","init","include","mergeOptions","registeredTypes","registerJSONType","getJSONClass","getJSONType","_jsonType","clazz","addHandler","handlerClass","_handlers","removeHandler","_clearHandlers","START_EVENTS","MOVE_EVENTS","mousedown","touchstart","pointerdown","MSPointerDown","END_EVENTS","DragHandler","_onMouseDown","onMouseDown","_offEvents","button","touches","setCapture","captureEvents","MOUSEMOVE","MOUSEUP","moved","actual","startPos","onMouseMove","onMouseUp","interupted","newPos","changedTouches","Coordinate","toNumberArrays","coordinates","coord","toCoordinates","child","CRS","properties","createProj4","proj","fromProjectionCode","code","toUpperCase","WGS84","EPSG4326","EPSG3857","IDENTITY","CGCS2000","EPSG4490","BD09LL","GCJ02","TEMP_POINT0","TEMP_COORD0","TEMP_COORD1","MINMAX","TEMP_EXTENT","TEMP_COMBINE","Extent","p4","_clazz","unproject","projection","_dirty","_initialize","xmin","xmax","ymin","ymax","_scale","isValid","ext2","intersects","_project","rxmin","rymin","rxmax","rymax","within","pxmin","pxmax","pymin","pymax","project","getSize","__combine","inited","_combine","ext","combine","intersection","expand","distance","_expand","convertTo","out","minmax","projectCoords","PointExtent","Transformation","matrix","transform","scale","untransform","isSphere","coords","circum","getCircum","getSphereExtent","sx","sy","wrapX","wrapY","pre","current","prj","unprojectCoords","projCoords","sphere","isOutSphere","pcoord","wrapCoord","wrapped","measureLength","c1","c2","measureLenBetween","measureArea","area","locate","xDist","yDist","_locate","pivot","tmp","Common","Sphere","ry","rx","initialAngle","rhumbBearing","finalAngle","calculateRhumbDestination","end","bear360","calculateRhumbBearing","bear180","from","phi1","phi2","deltaLambda","deltaPsi","tan","theta","origin","bearing","lambda1","DeltaPhi","DeltaPsi","q","DeltaLambda","lambda2","WGS84Sphere","BaiduSphere","DEFAULT","measurers","registerMeasurer","measure","Identity","Measurer","getInstance","mName","metersPerDegree","maxLatitude","lnglat","lng","lat","pLnglat","atan","exp","PROJ4326","convertLL2MC","convertMC2LL","EARTHRADIUS","MCBAND","LLBAND","MC2LL","LL2MC","cB","cE","cD","T","convertor","cC","getLoop","getRange","toRadians","toDegrees","Infinity","registerRenderer","_rendererClasses","getRendererClass","CanvasRenderer","layer","_painted","_drawTime","setToRedraw","render","framestamp","prepareRender","getMap","isVisible","ResourceCache","checkResources","_loadingResource","loadResources","_tryToDraw","testIfNeedRedraw","_toRedraw","isInteracting","drawOnInteracting","needToRedraw","getPitch","isMoving","isZooming","isRotating","onSkipDrawOnInteracting","isLoadingResource","isRenderComplete","_renderComplete","mustRenderOnInteracting","setCanvasUpdated","_canvasUpdated","isCanvasUpdated","onRemove","southWest","canvasExtent2D","_extent2D","onAdd","getCanvasImage","_renderZoom","getZoom","isBlank","isEmpty","containerPoint","_pointToContainerPoint","clear","clearCanvas","setZIndex","hitDetect","_errorThrown","getDevicePixelRatio","getImageData","resourceUrls","promises","cache","isResourceLoaded","_promiseResource","_get2DExtent","_containerPointToPoint","_canvas","Canvas2D","CanvasClass","onCanvasCreate","createContext","dpr","resetCanvasTransform","resizeCanvas","canvasSize","_maskExtent","mask","getMask","maskExtent2D","_getPainter","get2DExtent","clipCanvas","old","getGeometries","masks","_mask","painter","paint","clip","getViewExtent","completeRender","getEvents","onZoomStart","onZooming","onZoomEnd","onResize","onMoveStart","onMoving","onMoveEnd","onDragRotateStart","onDragRotating","onDragRotateEnd","onSpatialReferenceChange","getDrawTime","_drawAndRecord","painted","draw","getId","crossOrigin","_cacheResource","onabort","markErrorResource","_errors","checkSVG","_getImgUrl","merge","Layer","setId","zIndex","load","onLoad","_initRenderer","getZIndex","_renderer","isCanvasRender","onLoadEnd","_id","addTo","addLayer","_zIndex","_sortLayersByZIndex","getMinZoom","minZoom","getMaxZoom","maxZoom","getOpacity","renderer","_getRenderer","getProjection","bringToFront","layers","_getLayerList","topLayer","bringToBack","bottomLayer","getRenderer","removeLayer","setMask","_isVectorMarker","updateSymbol","setSymbol","_bindLayer","removeMask","isLoaded","_loaded","_bindMap","_switchEvents","_doRemove","emitter","_layers","_getMask2DExtent","JSONAble","Renderable","_onLayerEvent","DefaultSpatialReference","resolutions","SpatialReference","_initSpatialRef","getProjectionInstance","prjName","projections","sp1","sp2","f1","fullExtent","f2","bottom","r1","r2","_projection","defaultSpatialRef","isEPSG","_resolutions","_fullExtent","_transformation","getResolutions","getResolution","next","getFullExtent","getTransformation","getZoomDirection","TEMP_POINT","Map","opts","center","baseLayer","VERSION","writable","_initContainer","_panels","_baseLayer","_zoomLevel","_center","setSpatialReference","_mapViewPoint","_updateMapSize","_getContainerDomSize","setBaseLayer","_Load","addOnLoadHook","_onLoadHooks","getContainer","_containerDOM","getSpatialReference","_spatialReference","ref","oldRef","_updateSpatialReference","_resetMapStatus","_fireEvent","setCursor","cursor","_cursor","_trySetCursor","resetCursor","_prjCenter","setCenter","_verifyExtent","_pcenter","_setPrjCenter","_parseEventFromCoord","getContainerExtent","visualHeight","pitch","maxVisualPitch","_getVisualHeight","visualDistance","getExtent","_pointToExtent","getProjExtent","extent2D","_pointToPrj","getPrjExtent","getMaxExtent","setMaxExtent","maxExt","panTo","getZoomForScale","fromZoom","isFraction","_getResolution","targetRes","scaleZoom","getZoomFromRes","_getResolutions","minRes","maxRes","gap","setZoom","_zoomAnimation","_zoom","getMaxNativeZoom","setMaxZoom","viewMaxZoom","setMinZoom","viewMinZoom","getGLZoom","getGLScale","zoomIn","zoomOut","_zooming","setCenterAndZoom","animation","getFitZoom","containerExtent","coordToContainerPoint","getView","getBearing","setView","setPitch","setBearing","getScale","fitExtent","zoomOffset","step","animateTo","getBaseLayer","isChange","onbaseLayerload","removeBaseLayer","getLayers","_getLayers","getLayer","_layerCache","mapLayers","removed","_removeLayer","sortLayers","layersToOrder","minZ","MAX_VALUE","toDataURL","mimeType","file","dataURL","imgURL","dlLink","download","click","coordinateToPoint","coordinate","prjCoord","_prjToPoint","coordToPoint","pointToCoordinate","pointToCoord","coordinateToViewPoint","_prjToViewPoint","coordToViewPoint","viewPointToCoordinate","viewPoint","_viewPointToPrj","viewPointToCoord","coordinateToContainerPoint","pCoordinate","_prjToContainerPoint","containerPointToCoordinate","_containerPointToPrj","containerPointToCoord","containerPointToViewPoint","getViewPoint","viewPointToContainerPoint","containerToExtent","checkSize","justStart","_initTime","watched","oldHeight","oldWidth","resizeOffset","_offsetCenterByPixel","_mapViewCoord","_getPrjCenter","hided","_noEvent","distanceToPixel","p0","distanceToPoint","pixelToDistance","fullExt","pointToDistance","locateByPoint","px","py","getMainPanel","getPanels","isRemoved","_removeDomEvents","_moving","_originCenter","_parseEvent","_dragRotating","isDragRotating","getElementById","childNodes","_priorityCursor","_setCursorToPanel","_setPriorityCursor","hasCursor","panel","cached","_mapExtent2D","_mapGlExtent2D","cExtent","min2d","max2d","minx","maxx","miny","maxy","layerList","index","_order","eventName","_loadAllLayers","_callOnLoadHooks","loadLayer","_eachLayer","layerLists","_calcMatrices","resetContainer","containerDOM","mSize","updateMapSize","pcenter","_setPrjCoordAtContainerPoint","pixel","pCenter","offsetPlatform","_getViewPointFrameOffset","panelOffset","_resetMapViewPoint","_mapRes","_mapGlRes","pCoord","_pointToPoint","_pointToPointAtZoom","_containerPointToViewPoint","_viewPointToPoint","_pointToViewPoint","Handlerable","MapDoubleClickZoomHandler","_onDoubleClick","oldZoom","MapDragHandler","mapWrapper","_dragHandler","_cancelOn","bind","_onDragStart","_onDragging","_onDragEnd","domEvent","_ignore","_ignoreEvent","startDragTime","_mode","ctrlKey","_stopAnim","_animPlayer","_moveStart","_rotateStart","_isEventOutMap","_rotating","_moveEnd","_rotateEnd","startBearing","_start","preX","preY","startX","startY","_getActualEvent","startPrjCoord","mx","my","_clear","panBy","_rotateMode","_db","prePitch","preBearing","db","clipLine","bounds","noCut","segment","clipSegment","_lastCode","useLastCode","codeA","_getBitCode","codeB","codeOut","newCode","_getEdgeIntersection","clipPolygon","edges","clippedPoints","_code","withInEllipse","southeast","tolerance","xfocus","Symbolizer","getPainter","testColor","prop","CanvasSymbolizer","_prepareContext","isHitTesting","_defineStyle","getProperties","setProp","a0","a1","PointSymbolizer","glZoom","renderPoints","_getRenderPoints","_rotateExtent","fixedExtent","placement","isSpriting","getPlacement","getRenderPoints","_getRenderContainerPoints","ignoreAltitude","dxdy","getDxDy","cpoints","_pointContainerPoints","flat","_getRotationAt","getRotation","rotations","isTransforming","rotation","VectorMarkerSymbolizer","_dynamic","strokeAndFill","translateLineAndFill","symbolize","cookedPoints","_drawMarkers","_drawMarkersWithCache","_drawVectorMarker","stamp","_stampSymbol","_createMarkerImage","anchor","_getAnchor","_calMarkerSize","_size","shadow","_getCacheImageAnchor","_stamp","margin","markerType","_getGraidentExtent","getFixedExtent","vectorArray","_getVectorPoints","gradientExtent","hLineWidth","alignPoint","ha","va","hh","hw","v0","v1","v2","v3","extWidth","DebugSymbolizer","outline","cross","ImageMarkerSymbolizer","_getImage","_url","removeCache","replaceColor_","markerReplaceColor","putImageData","StrokeAndFillSymbolizer","paintParams","_getPaintParams","checkGradient","isPath","isSplitted","params","_paintOn","_getPrjExtent","_extMin","_extMax","_pxExtent","getPaintParams","lineColor","grad","CACHE_KEY","TextMarkerSymbolizer","textContent","_cacheKey","genCacheKey","_descText","_measureText","_loadFromCache","_storeToCache","active","desc","VectorPathMarkerSymbolizer","defaultSymbol","polygonFill","polygonOpacity","DrawAltitudeSymbolizer","_getStyle","groundPoints","_drawLineAltitude","groundPoint","_drawMarkerAltitude","_drawLine","registerSymbolizers","Symbolizers","testCanvas","TEMP_PAINT_EXTENT","TEMP_FIXED_EXTENT","TEMP_CLIP_EXTENT0","TEMP_CLIP_EXTENT1","Painter","symbolizers","_createSymbolizers","_altAtGLZoom","_getGeometryAltitude","geoSymbol","getSymbol","regSymbolizers","symbolizer","_hasPoint","getType","_debugSymbolizer","hasPoint","_renderPoints","pitched","rotated","_cachedParams","paintAsPath","_paintAsPath","_unsimpledParams","_res","_pitched","_redrawWhenPitch","_rotated","_redrawWhenRotate","_simplified","zoomScale","tr","mapExtent","cPoints","_hitPoint","disableClip","pointPlacement","_aboveCamera","containerOffset","pointContainerPoint","alt","altitude","getAltitude","clipped","_clip","clipPoints","cring","cc","cameraLookAt","cameraPosition","glExtent2D","_glScale","getShell","getHoles","part","_interpolateSegAlt","clipSegs","orig","segsWithAlt","interpolateAlt","cp","_getInternalSymbol","minAltitude","getMinAltitude","frustumAlt","getFrustumAltitude","_beforePaint","contexts","_prepareShadow","_afterPaint","getSprite","_spriting","_sprite","markerExtent","bak","hitTest","_eachSymbolizer","_verifyProjection","_fixedExtent","fixedExt","glScale","maxAltitude","getMaxAltitude","extent2","groundExtent","change","repaint","refreshSymbol","_removeSymbolizers","_paintParams","propAlt","_getAltitudeProperty","_propAlt","MIN_VALUE","_meterToPoint","layerOpts","_getProjection","_projCode","textcache","w0","w1","CollectionPainter","_eachPainter","geometries","Geometry","setProperties","getFirstCoordinate","getCoordinates","getLastCoordinate","fitview","addGeometry","_layer","oldId","_getParent","_repaint","_prepareSymbol","onSymbolChanged","_getSymbol","_computeCenter","_getMeasurer","prjExt","_computeExtent","containsPoint","_containsPoint","_hitTestTolerance","onHide","setZIndexSilently","getGeoMaxZIndex","topZ","getGeoMinZIndex","bottomZ","translated","setCoordinates","ret","fromJSON","_unbind","toGeoJSONGeometry","gJson","_exportGeoJSONGeometry","toGeoJSON","geoJSON","_exportProperties","other","_exportGraphicOptions","getLength","_computeGeodesicLength","getArea","_computeGeodesicArea","measurer","_getConnectPoints","_initOptions","_clearCache","_clearProjection","cookedSymbols","_checkAndCopySymbol","_setExternSymbol","_externSymbol","_extent","_computePrjExtent","finish","_unbindMenu","_unbindInfoWindow","isEditing","endEdit","_removePainter","onRemoveGeometry","_internalId","_getInternalId","_setInternalId","_getExternalResources","_painter","_paint","closeMenu","closeInfoWindow","onShapeChanged","onPositionChanged","needRepaint","_setParent","_parent","_onGeometryEvent","_infoWinOptions","geoProperties","EVENTS","MapGeometryEventsHandler","allLayers","_identifyGeometryEvents","identify","oneMoreEvent","_mouseDownTime","downTime","time","geometryCursorStyle","identifyOptions","eventToFire","_getEventTypeToFire","fireGeometryEvent","_queryIdentifyTimeout","propagation","geoMap","geo","iid","_onEvent","_prevOverGeos","geomap","oldTargets","geos","oldTarget","oldTargetId","wheelZoomDelta","defaultZoomRate","wheelZoomRate","maxScalePerFrame","MapScrollWheelZoomHandler","_thisScrollZoom","_scrollZoom","_wheelZoomRate","_defaultZoomRate","_delta","_onWheelScroll","evt","_checkZoomOrigin","_trackPadSuspect","_ensureTrackpad","_seamless","_interval","deltaMode","WheelEvent","DOM_DELTA_LINE","deltaY","shiftKey","_lastWheelEvent","_zoomOrigin","_active","callInNextFrame","zoomRate","targetZoom","_timeout","_requesting","levelValue","wheelDelta","detail","nextZoom","_checkZoom","_origin","_startZoom","duration","frame","playState","MapTouchZoomHandler","_onTouchStart","_startP1","_startP2","_startDist","_startVector","_startBearing","_onTouchMove","_onTouchEnd","d1","d2","vector","mode","_startTouching","_Origin","Easing","inAndOut","linear","upAndDown","Frame","Player","onFrame","_animation","_onFrame","ready","finished","Animation","speed","_resolveStyles","resolveChild","resolveVal","isChild","childStyles","framing","easing","dStyles","startStyles","destStyles","deltaStyles","_startStyles","_dStyles","children","elapsed","_requestAnimFrame","_frameQueue","_a","_animationFrameId","_frameFn","_run","running","animate","_prepare","_framer","play","currentTime","startTime","_playStartTime","pause","cancel","reverse","getSqDist","getSqSegDist","simplifyRadialDist","sqTolerance","prevPoint","newPoints","simplifyDPStep","last","simplified","maxSqDist","sqDist","simplifyDouglasPeucker","simplify","highestQuality","Path","getOutline","Polygon","animateShow","_showPlayer","_animIdx","_animLenSoFar","isPolygon","animCoords","_aniShowCenter","player","currentCoord","_drawAnimShowFrame","_animTailRatio","targetLength","segLen","computeLength","targetCoord","_getCenterInExtent","clipFn","meExtent","sumx","sumy","counter","_getPath2DPoints","prjCoords","disableSimplify","isSimplify","_shouldSimplify","isMulti","hasAltitude","_setPrjCoordinates","prjPoints","_prjCoords","_getPrjCoordinates","_projectCoords","_coordinates","_updateCache","_unprojectCoords","shell","rings","hasHoles","_coords2Extent","_getPrjHoles","_get2DLength","vertexes","JSON_TYPE","_holes","_projectRings","_trimRing","holes","_copyAndCloseRing","getCenterInExtent","_prjHoles","_cleanRing","_checkRing","isClose","_getPrjShell","_prjShell","_getCenter2DPoint","Marker","_canEdit","computeExtent","_getSprite","CenterMixin","LineString","GeometryCollection","setGeometries","_geometries","_checkGeometries","_bindGeometriesToLayer","selected","isFn","is","invalidGeoError","_checkGeo","sumX","sumY","anchors","startEdit","_originalSymbol","_draggbleBeforeEdit","_editing","geoExtent","MultiGeometry","geoType","GeometryType","_initData","MultiPoint","findClosest","MultiPath","MultiLineString","MultiPolygon","GeoJSON","toGeometry","resultGeos","_convert","resultGeo","features","mGeos","Circle","circle","_radius","getRadius","setRadius","numberOfPoints","vertex","se","_getMinMax","pminmax","Ellipse","setWidth","setHeight","deg","pps","longer","Rectangle","_width","_height","nw","fExt","_pnw","pnw","sphereExtent","_getSouthEast","prjs","Sector","getStartAngle","setStartAngle","getEndAngle","setEndAngle","pc","sAngle","eAngle","between","Curve","_arc","Canvas2d","ctrlPoint","_quadraticCurve","quadraticCurveTo","_bezierCurve","_getCurveArrowPoints","arrows","segments","arrowStyle","_getArrowShape","ArcCurve","_paintArrow","CubicBezierCurve","curve","_getArrowPoints","QuadBezierCurve","defaultBoxSymbol","TextMarker","getContent","_content","setContent","_refresh","_refreshing","_parseSymbol","setTextStyle","getTextStyle","setTextSymbol","setBoxStyle","getBoxStyle","setBoxSymbol","_getTextSize","_getDefaultTextSymbol","_getDefaultBoxSymbol","_getDefaultPadding","TextBox","boxSymbol","textStyle","getBoxSymbol","textBox","maxWidth","hAlign","vAlign","textSymbol","Label","boxStyle","getTextSymbol","label","sizes","_getBoxSize","boxSize","textAlignPoint","Connectable","_hasConnectors","__connectors","_getConnectors","getConnectSource","_connSource","setConnectSource","_connTarget","getConnectTarget","setConnectTarget","_updateCoordinates","_registerEvents","srcPoints","targetPoints","minDist","oldCoordinates","_showConnect","trigger","showOn","ConnectorLine","ArcConnectorLine","OverlayLayer","_maxZIndex","_minZIndex","_initCache","getGeometryById","_geoMap","_geoList","filtered","getFirstGeometry","getLastGeometry","getCount","copyOnWrite","fitView","_toSort","onGeometryAdd","_updateZIndex","geoId","internalId","onAddGeometry","removeGeometry","_clearing","onGeometryRemove","_findInList","_hitGeos","hits","_getArrowStyle","_sortGeometries","_compare","low","high","middle","_onGeometryIdChange","_onGeometryZIndexChange","_onGeometryPositionChange","_onGeometryShapeChange","_onGeometrySymbolChange","_onGeometryShow","_onGeometryHide","_onGeometryPropertiesChange","onGeometryZIndexChange","onGeometryPositionChange","onGeometryShapeChange","onGeometrySymbolChange","onGeometryShow","onGeometryHide","onGeometryPropertiesChange","VectorLayer","getStyle","_style","_cookedStyles","_styleGeometry","removeStyle","profile","clipExtent","geoJSONs","geoExt","MapTool","_map","onEnable","onDisable","isEnabled","events","registeredMode","DrawTool","registerMode","modeAction","getRegisterMode","_checkMode","_events","_firstClickHandler","_mouseMoveHandler","_doubleClickHandler","_mouseDownHandler","_mouseUpHandler","getMode","setMode","_geometry","_clearStage","_restoreMapCfg","_saveMapCfg","getCurrentGeometry","_drawToolLayer","_getDrawLayer","_loadResources","_mapAutoPanAtEdge","autoPanAtEdge","endDraw","undo","_getRegisterMode","action","_shouldRecordHistory","_historyPointer","_clickCoords","update","redo","actions","_mapDoubleClickZoom","_mapDraggable","_createGeometry","drawTool","_addGeometryToStage","_getMouseContainerPoint","_isValidContainerPoint","clickCoords","drawLayer","_ending","mapSize","drawLayerId","drawToolLayer","MapBoxZoomHander","_boxZoom","markerWidth","markerHeight","PANOFFSET","MapAutoPanAtEdgeHandler","_onMouseMove","equalView","view1","view2","currView","empty","zoomOrigin","preView","framer","_interupted","_endAnim","_startAnim","isAnimating","_animRotating","endCoord","_registerDomEvents","_handleDOMEvent","mimicClick","_fireDOMEvent","_clickTime","control","srcElement","preTarget","actualEvent","eventPos","eventParam","isFullScreen","webkitIsFullScreen","mozFullScreen","msFullscreenElement","fullscreenElement","requestFullScreen","_requestFullScreen","cancelFullScreen","_cancelFullScreen","mozRequestFullScreen","webkitRequestFullScreen","msRequestFullScreen","availWidth","availHeight","newWin","opener","mozCancelFullScreen","webkitCancelFullScreen","_panAnimation","setInfoWindow","layerJSON","layerType","extraLayerOptions","layersJSON","exportOption","layerJSONs","coord1","coord2","computeGeometryLength","computeGeometryArea","reqLayers","layerHits","_frameZoom","startScale","_startZoomAnim","endScale","_startZoomVal","_startZoomCoord","frameZoom","_zoomTo","fromRes","originOffset","startZoomVal","perspective","fovy","aspect","near","far","nf","a00","a01","a02","a03","a10","a11","a12","a13","a20","a21","a22","a23","rotateX","rotateZ","multiply","a30","a31","a32","a33","b0","b1","b2","b3","invert","b00","b01","b02","b03","b04","b05","b06","b07","b08","b09","b10","b11","det","identity","subtract","normalize","dot","ax","ay","az","bx","by","bz","applyMatrix","matrixToQuaternion","te","m11","m12","m13","m21","m22","m23","m31","m32","m33","trace","quaternionToMatrix","z2","xx","xy","xz","yy","yz","zz","wx","wy","wz","setPosition","lookAt","eye","up","RADIAN","DEFAULT_FOV","TEMP_COORD","getFov","_fov","setFov","fov","_renderLayers","_angle","_pitch","_frustumAltitude","_calcFrustumAltitude","cameraAlt","_projIfBehindCamera","cameraForward","projViewMatrix","w2","h2","centerPoint","vectorFromCam","position","cameraPos","camForward","camNormDot","coord0","projViewMatrixInverse","z0","z1","m0","createMat4","m1","maxScale","farZ","_getFovRatio","projMatrix","mat4","worldMatrix","_getCameraWorldMatrix","viewMatrix","domCssMatrix","_calcDomMatrix","minusY","cameraToCenterDistance","targetZ","center2D","cz","cameraUp","cameraWorldMatrix","_onViewChange","_viewHistory","_viewHistoryPointer","_getCurrentView","_fireViewChange","zoomToPreviousView","hasPreviousView","_zoomToView","zoomToNextView","hasNextView","getViewHistory","DistanceTool","_afterEnable","_afterDisable","_measureLayers","_lastMeasure","_lastVertex","getMeasureLayers","getLastMeasure","_measure","toMeasure","units","_registerMeasureEvents","_msOnDrawStart","_msOnDrawVertex","_msOnMouseMove","_msOnDrawEnd","layerId","markerLayerId","_measureLineLayer","_measureMarkerLayer","startLabel","ms","_msGetCoordsToMeasure","_tailMarker","_tailLabel","vertexLabel","_clearTailMarker","_addClearMarker","dxSymbol","endMarker","measureLineLayer","measureMarkerLayer","AreaTool","sqmi","vertexMarker","endLabel","_firstClick","firstClick","pSymbol","marker","arcConf","tileInfo","tileSize","lods","tileSystem","loadArcgis","spatialRef","UIComponent","owner","_owner","_mapEventsOn","_switchMapEvents","_coordinate","visible","_getUIContainer","_removePrevDOM","__uiDOM","buildOn","_measureSize","_singleton","_uiDomKey","_setPosition","anim","_getAnimation","ok","fade","getTransformOrigin","_toCSSTranslate","_pos","display","_autoPan","transition","getDOM","getOwner","getPosition","_getViewPoint","getOffset","animations","trimed","mapWidth","mapHeight","onDomRemove","eventsToStop","_getClassName","_getDefaultEvents","ownerEvents","_getOwnerEvents","onEvent","positionchange","getOwnerEvents","_updatePosition","domEvents","UIMarker","_markerCoord","_registerDOMEvents","_removeDOMEvents","isDragging","_onDomEvents","UIMarkerDragHandler","_startDrag","_endDrag","_lastCoord","_lastPoint","_prepareDragHandler","_dragging","_isDragging","coordOffset","pointOffset","InfoWindow","getInfoWindow","removeInfoWindow","_infoWindow","setTitle","title","getTitle","_getWindowWidth","msgContent","querySelector","_onCloseBtnClick","closeBtn","markerSize","fixExtent","_onAutoOpen","defaultWidth","ToolTip","onMouseOut","cssName","onMouseOver","defaultOptions","Menu","_menu","removeMenu","setItems","items","getItems","_getMenuWidth","menuItems","_createMenuItemDom","ul","onMenuClick","_callback","item","itemDOM","itemTitle","Menuable","setMenu","_menuOptions","_defaultOpenMenu","openMenu","_bindMenu","setMenuItems","getMenuItems","Control","controlContainer","__ctrlContainer","_controlDom","_parse","getContainerPoint","positions","addControl","removeControl","layerEvents","Attribution","_attributionContainer","_update","attributions","attributionControl","LayerSwitcher","_show","_hide","_createPanel","toElement","relatedTarget","elm","baseLayers","li","_isExcluded","_renderLayer","excludeLayers","isBase","checked","onchange","layerSwitcherControl","Overview","mapContainer","_createOverview","_updateBaseLayer","_onButtonClick","_updateButtonText","_overview","_perspective","maxmize","minimize","getOverviewMap","_getOverviewZoom","_getPerspectiveCoords","level","showIndex","overviewControl","Panel","closeButton","onclick","panelContent","draggable","_startPos","_startPosition","startPosition","Scale","_scaleContainer","_addScales","css","_mScale","_iScale","maxMeters","_updateScales","_updateMetric","_updateImperial","meters","_getRoundNum","_updateScale","maxFeet","maxMiles","miles","feet","num","pow10","scaleControl","Toolbar","onButtonClick","childIndex","targetDom","_getItems","textAlign","itemSize","dropMenu","_createDropMenu","menuDom","menuUL","liWidth","UNIT","Zoom","levelDOM","_levelDOM","zoomDOM","zoomInButton","_zoomInButton","box","reading","_sliderBox","_sliderRuler","_sliderReading","_sliderDot","zoomOutButton","_zoomOutButton","_onZoomInClick","_onZoomOutClick","_onClickRuler","dotDragger","totalRange","zoomRange","_updateText","_onDotDragstart","_onDotDrag","zoomControl","TileSystem","getDefault","semiCircum","TileConfig","prepareTileInfo","_xScale","_yScale","transformation","_getTileNum","tileX","tileY","getTileIndex","tileIndex","getNeighorTileIndex","repeatWorld","idy","_getTileFullIndex","nwIndex","seIndex","getTilePrjNW","getTilePrjSE","getTilePrjExtent","URL_PATTERN","TEMP_POINT1","TEMP_POINT2","TEMP_POINT3","TEMP_POINT_EXTENT","TileLayer","getTileSize","getTiles","parentLayer","parentRenderer","tileGrids","minPitchToCascade","tileZoom","_getTileZoom","currentTiles","_getTiles","tiles","extent0","extent1","parentTiles","getTileUrl","urlTemplate","domain","subdomains","_sr","maskID","_getTileOffset","hasOffset","emptyGrid","tileConfig","_getTileConfig","sr","mapSR","extent2d","innerExtent2D","_getInnerExtent","offsetExtent2D","maskExtent","prjCenter","pmin","pmax","centerTile","ltTile","rbTile","leftVisitEnd","rightVisitEnd","hasCachedInfo","tileId","_getTileId","isTileCachedOrLoading","info","point0","_unproject","pse","tileExtent","_isTileInExtent","ch","cw","mapProjection","_initTileConfig","_defaultTileConfig","_tileConfig","_convertPointCallback","convertPoint","_coordTileZoom","_onSpatialReferenceChange","GroupTileLayer","_checkChildren","layerMap","_groupChildren","childGrid","getChildLayer","_onLayerShowHide","ids","crs","uppercase","detectRetina","defaultWmsParams","service","request","format","transparent","version","WMSTileLayer","wmsParams","_wmsVersion","parseFloat","projectionKey","bbox","getParamString","existingUrl","encodeURIComponent","CanvasTileLayer","drawTile","createGLContext","names","compileShader","source","shader","createShader","shaderSource","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","deleteShader","createProgram","vert","frag","vertexShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","program","attachShader","linkProgram","enableVertexAttrib","FSIZE","Float32Array","BYTES_PER_ELEMENT","STRIDE","attr","getAttribLocation","vertexAttribPointer","enableVertexAttribArray","shaders","arr16","ImageGLRenderable","renderable","drawGLImage","loadTexture","uMatrix","uniformMatrix4fv","uniform1f","glBuffer","saveImageBuffer","bufferTileData","bindBuffer","ARRAY_BUFFER","drawArrays","TRIANGLE_STRIP","buffer","loadImageBuffer","set12","drawTinImage","vertices","texCoords","indices","posBuffer","bufferData","DYNAMIC_DRAW","texBuffer","ELEMENT_ARRAY_BUFFER","Uint16Array","drawElements","TRIANGLES","UNSIGNED_SHORT","createCanvas2","canvas2","clearColor","DEPTH_TEST","STENCIL_TEST","BLEND","blendFunc","ONE","ONE_MINUS_SRC_ALPHA","useProgram","createBuffer","STATIC_DRAW","enableSampler","activeTexture","pixelStorei","UNPACK_PREMULTIPLY_ALPHA_WEBGL","indicesBuffer","resizeGLCanvas","viewport","clearGLCanvas","COLOR_BUFFER_BIT","STENCIL_BUFFER_BIT","disposeImage","texture","saveTexture","_createTexture","getTexture","createTexture","bindTexture","TEXTURE_2D","texParameteri","TEXTURE_MIN_FILTER","LINEAR","TEXTURE_MAG_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","texImage2D","RGBA","UNSIGNED_BYTE","generateMipmap","_textures","textures","getImageBuffer","_imageBuffers","imageBuffers","createImageBuffer","removeGLCanvas","_buffers","deleteBuffer","deleteTexture","deleteProgram","uniforms","_initUniforms","sampler","texIdx","uSampler","_getUniform","uniform1i","uniform","uniformName","getUniformLocation","a2","a3","a4","a5","a6","a7","a8","a9","ImageLayer","images","_images","_prepareImages","setImages","getImages","_imageData","refreshImages","EMPTY_ARRAY","ImageLayerCanvasRenderer","isDrawable","_imageLoaded","urls","unloaded","retireImage","_drawImages","_drawImage","ImageLayerGLRenderer","CanvasLayerRenderer","getPrepareParams","getDrawParams","prepareDrawContext","_drawLayer","_drawLayerOnInteracting","canvasImg","bufferContext","prevent","doubleBuffer","_drawContext","_predrawed","ensureParams","prepareToDraw","_prepareDrawParams","CanvasLayer","redraw","isPlaying","requestMapToRender","ParticleLayer","getParticles","_shouldClear","fillRect","_fillCanvas","trail","EDIT_STAGE_LAYER_PREFIX","createHandleSymbol","GeometryEditor","prepare","_prepareEditStageLayer","stageId","shadowId","_editStageLayer","_shadowLayer","editing","_geometryDraggble","_shadow","_switchGeometryEvents","_createOrRefreshOutline","_addListener","_createCenterHandle","_onMarkerDragEnd","createMarkerEditor","createCircleEditor","createEllipseOrRectEditor","createPolygonEditor","_history","_editOutline","_refreshHooks","_getGeometryEvents","_onGeoSymbolChange","_exeAndReset","oper","_addRefreshHook","handle","createHandle","onDown","onMove","onUp","_createHandleInstance","onHandleDragstart","onHandleDragging","_hideContext","onHandleDragEnd","onHandleRemove","onRefresh","_createResizeHandles","blackList","onHandleMove","onHandleUp","cursors","axis","getResizeAnchors","resizeHandles","anchorIndexes","handleSymbol","fnLocateHandles","pExt","isBlack","some","ele","_index","handleViewPoint","_updating","geometryToEdit","_recordHistory","getUpdates","resizeAbilities","aspectRatio","newCoordinates","_updateCoordFromShadow","mirrorHandle","mirrorViewPoint","viewCenter","wh","ability","updates","isRect","mouseViewPoint","pointSub","targetPoint","mirror","absSub","verticeLimit","propertyOfVertexRefreshFn","propertyOfVertexIndex","vertexHandles","newVertexHandles","getVertexCoordinates","getVertexPrjCoordinates","onVertexAddOrRemove","removeVertex","prjCoordinates","nextIndex","createNewVertexHandle","moveVertexHandle","vertice","nVertex","pVertex","createVertexHandle","vertexCoordinates","nextVertex","vertexIndex","refreshVertex","_eventListeners","method","_exeHistory","ignoreRecord","updating","record","history","TextEditable","startEditText","endEditText","_prepareEditor","_textEditor","html","innerText","_editUIMarker","onkeyup","isEditingText","getTextEditor","editContainer","_createEditor","_getEditorOffset","_setCursorToLast","labelSize","textColor","spacing","editor","contentEditable","keyCode","range","getSelection","focus","selectAllChildren","collapseToEnd","selection","createRange","moveToElementText","collapse","select","stylesToAnimate","_prepareAnimationStyles","preTranslate","isFocusing","_animationStarted","fnName","toTranslate","dSymbol","_fireAnimateEvent","symbolToAnimate","symbolInStyles","sp","DRAG_STAGE_LAYER_ID","GeometryDragHandler","_prepareDragStageLayer","_prepareShadowConnectors","_dragStageLayer","shadowConnectors","connectors","targetConn","connOptions","connSymbol","conn","_shadowConnectors","_onTargetUpdated","enableAltitude","altitudeProperty","_correctCoord","_startParam","_moved","_updateTargetAndRemoveShadow","_editor","redoEdit","undoEdit","_getEventParams","_bindInfoWindow","openInfoWindow","LRUCache","reset","order","has","removedData","getAndRemove","setMaxSize","TileLayerCanvasRenderer","tilesInView","tilesLoading","_parentTiles","_childTiles","tileCache","LruCache","deleteTile","getCurrentTileZoom","_tileZoom","mask2DExtent","loadingCount","loading","checkedTiles","parentKeys","childTiles","childKeys","placeholders","placeholderKeys","tileQueue","preLoadingCount","_markTiles","loadingLimit","_getLoadLimit","_tileOffset","tileGrid","allTiles","placeholder","_generatePlaceHolder","tile","_getCachedTile","tileLoading","_isLoadingTile","getTileOpacity","hitLimit","dupKey","parentTile","_findParentTile","_findChildTiles","_drawTiles","loadTileQueue","_retireTiles","t2","onDrawTileStart","_drawTileAndCache","_drawTileOffset","writeZoomStencil","started","startZoomStencilTest","resumeZoomStencilTest","pauseZoomStencilTest","endZoomStencilTest","onDrawTileEnd","_clipByPitch","tileImage","loadTile","loadTime","onTileLoad","onTileError","loadTileImage","abortTileLoading","falseFn","_addTileToCache","onerrorTick","tileRetryCount","transformed","xyz","_getLayerOfTile","zoomDiff","_findChildTilesAt","childZoom","dmin","dmax","ex","ey","diff","_tilePlaceHolder","force","defaultPlaceholder","TileLayerGLRenderer","_gl","_bindGLBuffer","stencilFunc","ALWAYS","stencilOp","KEEP","REPLACE","EQUAL","tileCanvas","GLRenderer","OverlayLayerRenderer","_geosToCheck","_resourceChecked","_addGeoToCheckRes","VectorLayerRenderer","drawGeos","_geosToDraw","_updateDisplayExtent","_displayExtent","forEachGeo","checkGeo","OverlayLayerCanvasRenderer","MapRenderer","_handlerQueue","executeFrameCallbacks","front","panels","back","_frameLoop","MapCanvasRenderer","_containerIsCanvas","_loopTime","initContainer","renderFrame","updateMapDOM","_getAllLayerToRender","drawLayers","drawLayerCanvas","_recordView","_mapview","_getMapView","_spatialRefChanged","_fireLayerLoadEvents","canvasIds","updatedIds","fps","timeLimit","layerLimit","isCanvas","needsRedraw","_checkLayerRedraw","setLayerCanvasUpdated","transformMatrix","__zoomTransformMatrix","_zoomMatrix","_drawCanvasLayerOnInteracting","_eventParam","preCanvasIds","_canvasIds","preUpdatedIds","_updatedIds","isLayerCanvasUpdated","sep","isSpatialReferenceChanged","isViewChanged","drawTime","inTime","_updateCanvasSize","interacting","limit","baseLayerImage","layerImage","_getLayerImage","_drawLayerCanvasImage","_drawFog","_drawCenterCross","_onVisibilitychange","_resizeInterval","clearInterval","_cancelFrameLoop","createContainer","enableSelect","POSITION0","mapAllLayers","backStatic","backLayer","canvasContainer","frontStatic","frontLayer","ui","previous","_animationFrame","canvasImage","imgOp","fogThickness","landscape","_checkSize","_setCheckSizeInterval","_checkSizeInterval","setInterval","_onMapMouseMove","_hitDetectFrame","_getCanvasLayers","visibilityState","CenterPointRenderer","PolyRenderer","_getRenderSize","prjExtent","pointZoom","arrowStyles","normal","prjVertexes","dasharray","_getArrowPlacement","_getArrows","prjHoles","holePoints","hole"],"mappings":"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"}